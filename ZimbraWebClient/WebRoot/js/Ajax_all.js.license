
/* Copyright (C) 2005-2009 Zimbra Inc. http://www.zimbra.com/ */
if(AjxPackage.define("Ajax")){
if(AjxPackage.define("ajax.core.AjxCore")){
AjxCore=function(){};
AjxCore._objectIds=[null];
AjxCore.assignId=function(e){
var t=AjxCore._objectIds.length;
AjxCore._objectIds[t]=e;
return t
};
AjxCore.unassignId=function(e){
AjxCore._objectIds[e]=null
};
AjxCore.objectWithId=function(e){
return AjxCore._objectIds[e]
};
AjxCore.addListener=function(a,e,t){
a=AjxCore._getEventSource(a);
var i=AjxCore._getListenerStruct(a,e,true);
i.list[i.list.length]=t
};
AjxCore.setEventHandler=function(a,e,t){
a=AjxCore._getEventSource(a);
var i=AjxCore._getListenerStruct(a,e,true);
i.single=t
};
AjxCore.removeListener=function(n,t,o){
n=AjxCore._getEventSource(n);
var s=AjxCore._getListenerStruct(n,t);
if(s){
var r=s.list;
var e=r.length;
for(var a=0;
a<e;
a++){
if(r[a]==o){
r[a]=null
}}}};
AjxCore.removeAllListeners=function(o,t){
o=AjxCore._getEventSource(o);
var n=AjxCore._getListenerStruct(o,t);
if(n){
var s=n.list;
var e=s.length;
for(var a=0;
a<e;
a++){
s[a]=null
}}
AjxCore.unassignId(n.id)
};
AjxCore.notifyListeners=function(a,e,t){
a=AjxCore._getEventSource(a);
var i=AjxCore._getListenerStruct(a,e);
if(i){
a[e](t)
}};
AjxCore._getEventSource=function(e){
if(typeof(e)=="string"){
e=document.getElementById(e)
}
return e
};
AjxCore.getListenerStruct=function(t,e){
return AjxCore._getListenerStruct(t,e)
};
AjxCore._getListenerStruct=function(a,e,t){
var i=null;
if(a[e]){
var o=a[e]._lsListenerStructId;
i=AjxCore.objectWithId(o)
}else{
if(t){
i=AjxCore._setupListener(a,e)
}}
return i
};
AjxCore._setupListener=function(a,e,o){
var i=new Object();
i.list=new Array();
i.single=null;
var o=i.id=AjxCore.assignId(i);
var t=AjxCore._createListenerClosure(o);
a[e]=t;
a[e]._lsListenerStructId=o;
return i
};
AjxCore._createListenerClosure=function(id){
var closure=function(arg1){
var listenerStruct=AjxCore.objectWithId(id);
var listenerList=listenerStruct.list;
var len=listenerList.length;
for(var i=0;
i<len;
i++){
var callback=listenerList[i];
if(callback){
if(typeof(callback)=="string"){
eval(callback)
}else{
if(callback.handleEvent){
callback.handleEvent(arg1,this)
}else{
callback(arg1,this)
}}}}
if(listenerStruct.single){
var callback=listenerStruct.single;
if(typeof(callback)=="string"){
eval(callback)
}else{
return callback.handleEvent?callback.handleEvent(arg1,this):callback(arg1,this)
}}};
return closure
};
AjxCore.addOnloadListener=function(e){
if(window.onload&&(!window.onload._lsListenerStructId)){
var t=window.onload;
window.onload=null;
AjxCore.addListener(window,"onload",t)
}
AjxCore.addListener(window,"onload",e)
};
AjxCore.addOnunloadListener=function(e){
if(window.onunload&&(!window.onunload._lsListenerStructId)){
var t=window.onunload;
window.onunload=null;
AjxCore.addListener(window,"onunload",t)
}
AjxCore.addListener(window,"onunload",e)
}
}
if(AjxPackage.define("ajax.util.AjxUtil")){
AjxUtil=function(){};
AjxUtil.FLOAT_RE=/^[+\-]?((\d+(\.\d*)?)|((\d*\.)?\d+))([eE][+\-]?\d+)?$/;
AjxUtil.NOTFLOAT_RE=/[^\d\.]/;
AjxUtil.NOTINT_RE=/[^0-9]+/;
AjxUtil.LIFETIME_FIELD=/^([0-9])+([dhms]|ms)?$/;
AjxUtil.INT_RE=/^\-?(0|[1-9]\d*)$/;
AjxUtil.isSpecified=function(e){
return((e!==void 0)&&(e!==null))
};
AjxUtil.isUndefined=function(e){
return(e===void 0)
};
AjxUtil.isNull=function(e){
return(e===null)
};
AjxUtil.isBoolean=function(e){
return(typeof(e)==="boolean")
};
AjxUtil.isString=function(e){
return(typeof(e)==="string")
};
AjxUtil.isNumber=function(e){
return(typeof(e)==="number")
};
AjxUtil.isObject=function(e){
return((typeof(e)==="object")&&(e!==null))
};
AjxUtil.isArray=function(e){
return AjxUtil.isInstance(e,Array)
};
AjxUtil.isArrayLike=function(e){
return typeof e!=="string"&&typeof e.length==="number"
};
AjxUtil.isFunction=function(e){
return(typeof(e)==="function")
};
AjxUtil.isDate=function(e){
return AjxUtil.isInstance(e,Date)
};
AjxUtil.isLifeTime=function(e){
return AjxUtil.LIFETIME_FIELD.test(e)
};
AjxUtil.isNumeric=function(e){
return(!isNaN(parseFloat(e))&&AjxUtil.FLOAT_RE.test(e)&&!AjxUtil.NOTFLOAT_RE.test(e))
};
AjxUtil.isInt=function(e){
return AjxUtil.INT_RE.test(e)
};
AjxUtil.isPositiveInt=function(e){
return AjxUtil.isInt(e)&&parseInt(e,10)>0
};
AjxUtil.isLong=AjxUtil.isInt;
AjxUtil.isNonNegativeLong=function(e){
return AjxUtil.isLong(e)&&parseInt(e,10)>=0
};
AjxUtil.isEmpty=function(e){
return(AjxUtil.isNull(e)||AjxUtil.isUndefined(e)||(e==="")||(AjxUtil.isArray(e)&&(e.length==0)))
};
AjxUtil.IPv4_ADDRESS_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?$/;
AjxUtil.IPv4_ADDRESS_WITH_PORT_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?:\d{1,5}$/;
AjxUtil.IPv6_ADDRESS_RE=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|(?:%[-\w.~]+)?$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})(?:%[-\w.~]+)?$/i;
AjxUtil.IPv6_ADDRESS_WITH_PORT_RE=new RegExp(AjxUtil.IPv6_ADDRESS_RE.source.replace("^","^\\[").replace("$","\\]:\\d{1,5}$"),"i");
AjxUtil.SUBNET_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?\/\d{1,2}$/;
AjxUtil.DOMAIN_NAME_SHORT_RE=/^[A-Za-z0-9\-]{2,}$/;
AjxUtil.DOMAIN_NAME_FULL_RE=/^[A-Za-z0-9\-]{1,}(\.[A-Za-z0-9\-]{2,}){1,}$/;
AjxUtil.HOST_NAME_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{1,})*(\.[A-Za-z0-9\-]{2,})*$/;
AjxUtil.HOST_NAME_WITH_PORT_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})*:([0-9])+$/;
AjxUtil.EMAIL_SHORT_RE=/^[^@\s]+$/;
AjxUtil.EMAIL_FULL_RE=/^[^@\s]+@[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})+$/;
AjxUtil.FULL_URL_RE=/^[A-Za-z0-9]{2,}:\/\/[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)*(:([0-9])+)?(\/[\w\.\|\^\*\[\]\{\}\(\)\-<>~,'#_;@:!%]+)*(\/)?(\?[\w\.\|\^\*\+\[\]\{\}\(\)\-<>~,'#_;@:!%&=]*)?$/;
AjxUtil.IP_FULL_URL_RE=/^[A-Za-z0-9]{2,}:\/\/\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?(:([0-9])+)?(\/[\w\.\|\^\*\[\]\{\}\(\)\-<>~,'#_;@:!%]+)*(\/)?(\?[\w\.\|\^\*\+\[\]\{\}\(\)\-<>~,'#_;@:!%&=]*)?$/;
AjxUtil.SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)*(:([0-9])+)?$/;
AjxUtil.IP_SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?(:([0-9])+)?$/;
AjxUtil.isHostName=function(e){
return AjxUtil.HOST_NAME_RE.test(e)
};
AjxUtil.isDomainName=function(t,e){
return e?AjxUtil.DOMAIN_NAME_SHORT_RE.test(t):AjxUtil.DOMAIN_NAME_FULL_RE.test(t)
};
AjxUtil.isEmailAddress=function(t,e){
return e?AjxUtil.EMAIL_SHORT_RE.test(t):AjxUtil.EMAIL_FULL_RE.test(t)
};
AjxUtil.isValidEmailNonReg=function(e){
return((e.indexOf("@")>0)&&(e.lastIndexOf("@")==e.indexOf("@"))&&(e.indexOf(".@")<0))
};
AjxUtil.isHash=function(e){
var t=e&&e.toString?e.toString():Object.prototype.toString.call(e);
return AjxUtil.isObject(e)&&t==="[object Object]"
};
AjxUtil.SIZE_GIGABYTES="GB";
AjxUtil.SIZE_MEGABYTES="MB";
AjxUtil.SIZE_KILOBYTES="KB";
AjxUtil.SIZE_BYTES="B";
AjxUtil.formatSize=function(o,i,n){
if(i==null){
i=true
}
if(n==null){
n=20
}
var t=AjxMsg.sizeBytes;
var a=AjxMsg.SIZE_BYTES;
if(o>=1073741824){
t=AjxMsg.sizeGigaBytes;
a=AjxUtil.SIZE_GIGABYTES
}else{
if(o>=1048576){
t=AjxMsg.sizeMegaBytes;
a=AjxUtil.SIZE_MEGABYTES
}else{
if(o>1023){
t=AjxMsg.sizeKiloBytes;
a=AjxUtil.SIZE_KILOBYTES
}}}
var e=AjxUtil.formatSizeForUnits(o,a,i,n);
return AjxMessageFormat.format(AjxMsg.formatSizeAndUnits,[e,t])
};
AjxUtil.formatSizeForUnits=function(n,a,t,r){
if(a==null){
a=AjxUtil.SIZE_BYTES
}
if(t==null){
t=true
}
if(r==null){
r=20
}
switch(a){
case AjxUtil.SIZE_GIGABYTES:n/=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:n/=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:n/=1024;
break
}
var e=I18nMsg.numberSeparatorDecimal!=""?I18nMsg.numberSeparatorDecimal:".";
var s=I18nMsg.formatNumber.replace(/\..*$/,"");
s=s.replace(/,/,"");
if(!t&&r){
s=s+=e;
for(var o=0;
o<r;
o++){
s+="#"
}}
return AjxNumberFormat.format(s,n)
};
AjxUtil.parseSize=function(t,i){
if(typeof t!=_STRING_){
t=t.toString()
}
var o=parseFloat(t.replace(/^\s*/,""));
var a=/[GMK]?B$/i;
var e=a.exec(t);
if(e){
i=e[0].toUpperCase()
}
switch(i){
case AjxUtil.SIZE_GIGABYTES:o*=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:o*=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:o*=1024;
break
}
return o
};
AjxUtil.isInstance=function(e,t){
return !!(e&&e.constructor&&(e.constructor===t))
};
AjxUtil.assert=function(e,t){
if(!e&&AjxUtil.onassert){
AjxUtil.onassert(t)
}};
AjxUtil.onassert=function(t){
var l=new Object();
l.message=t;
var c=new Array();
if(AjxEnv.isIE5_5up){
var o=arguments.callee.caller;
var n=0;
while(o&&n++<20){
c[c.length]=o;
o=o.caller
}}else{
try{
var o=arguments.callee.caller;
while(o){
c[c.length]=o;
if(c.length>2){
break
}
o=o.caller
}}
catch(h){}}
l.stack=c;
var r="";
var a=170;
for(var n=1;
n<c.length;
n++){
if(n>1){
r+="\n"
}
if(n<11){
var s=c[n].toString();
if(s.length>a){
s=s.substr(0,a)+"...";
s=s.replace(/\n/g,"")
}
r+=n+": "+s
}else{
r+="("+(c.length-11)+" frames follow)";
break
}}
alert("assertion:\n\n"+t+"\n\n---- Call Stack ---\n"+r);
throw l
};
AjxUtil.ELEMENT_NODE=1;
AjxUtil.TEXT_NODE=3;
AjxUtil.DOCUMENT_NODE=9;
AjxUtil.getInnerText=function(e){
if(AjxEnv.isIE){
return e.innerText
}
function t(s){
if(s){
if(s.nodeType==3){
return s.data
}
if(s.nodeType==1){
if(/^br$/i.test(s.tagName)){
return"\r\n"
}
var o="";
for(var a=s.firstChild;
a;
a=a.nextSibling){
o+=t(a)
}
return o
}}
return""
}
return t(e)
};
AjxUtil.createProxy=function(a,s){
var o;
var t=function(){};
t.prototype=a;
if(a instanceof Array){
o=new Array();
var i=a.length;
for(var e=0;
e<i;
e++){
o[e]=a[e]
}}else{
o=new t
}
if(s){
for(var n in a){
if(typeof a[n]=="object"&&a[n]!==null){
o[n]=AjxUtil.createProxy(a[n],s-1)
}}}
o._object_=a;
return o
};
AjxUtil.unProxy=function(t){
var e=t&&t._object_;
if(e){
for(var a in t){
if(t.hasOwnProperty(a)&&a!="_object_"){
e[a]=t[a]
}}
return e
}
return null
};
AjxUtil.collapseList=function(a){
var t=[];
for(var e=0;
e<a.length;
e++){
if(a[e]){
t.push(a[e])
}}
return t
};
AjxUtil.arrayAsHash=function(r,o){
r=AjxUtil.toArray(r);
var s={};
var a=typeof o=="function"&&o;
var n=o||true;
for(var t=0;
t<r.length;
t++){
var e=r[t];
s[e]=a?a(e,s,t,r):n
}
return s
};
AjxUtil.arrayAdd=function(a,t,e){
a=a||[];
if(e==null||e<0||e>=a.length){
a.push(t)
}else{
a.splice(e,0,t)
}};
AjxUtil.arrayRemove=function(a,t){
if(a){
for(var e=0;
e<a.length;
e++){
if(a[e]==t){
a.splice(e,1);
return true
}}}
return false
};
AjxUtil.indexOf=function(n,t,e){
if(n){
for(var a=0;
a<n.length;
a++){
var o=n[a];
if((e&&o===t)||(!e&&o==t)){
return a
}}}
return -1
};
AjxUtil.arrayContains=function(a,t,e){
return AjxUtil.indexOf(a,t,e)!=-1
};
AjxUtil.keys=function(t,e){
var a=[];
for(var i in t){
if(e&&!e(i,t)){
continue
}
a.push(i)
}
return a
};
AjxUtil.values=function(a,t){
var e=[];
for(var i in a){
if(t&&!t(i,a)){
continue
}
e.push(a[i])
}
return e
};
AjxUtil.valueHash=function(n,a){
var i=Object.prototype.hasOwnProperty.bind(n);
var o={};
for(var t in n){
var e=n[t];
if(!i(t)||(a&&!a(t,n))){
continue
}
o[e]=t
}
return o
};
AjxUtil.backMap=AjxUtil.valueHash;
AjxUtil.foreach=function(n,o){
if(!o||!n){
return
}
if(AjxUtil.isArrayLike(n)){
var s=n;
for(var t=0;
t<s.length;
t++){
o(s[t],t)
}}else{
var a=Object.prototype.hasOwnProperty.bind(n);
for(var e in n){
if(a(e)){
o(n[e],e)
}}}};
AjxUtil.map=function(o,a){
if(!o){
return[]
}
var e=new Array(o.length);
for(var t=0;
t<o.length;
t++){
e[t]=a?a(o[t],t):o[t]
}
return e
};
AjxUtil.uniq=function(a){
if(!a){
return[]
}
var e={};
for(var t=0;
t<a.length;
t++){
e[a[t]]=true
}
return AjxUtil.keys(e)
};
AjxUtil.dedup=function(n,t){
if(!n){
return[]
}
if(!t){
t=function(i){
return i
}
}
var e={};
for(var o=0;
o<n.length;
o++){
var a=t(n[o]);
if(a!==undefined&&e[a]){
n.splice(o,1);
o-=1
}
e[a]=true
}};
AjxUtil.concat=function(t){
var a=[];
for(var e=0;
e<arguments.length;
e++){
a.push.apply(a,arguments[e])
}
return a
};
AjxUtil.union=function(e){
var t=[];
return AjxUtil.uniq(t.concat.apply(t,arguments))
};
AjxUtil.intersection=function(t){
var i=AjxUtil.concat.apply(this,arguments);
var e=AjxUtil.arrayAsHash(i,AjxUtil.__intersection_count);
for(var a in e){
if(e[a]==1){
delete e[a]
}}
return AjxUtil.keys(e)
};
AjxUtil.__intersection_count=function(t,a,e,i){
return a[t]!=null?a[t]+1:1
};
AjxUtil.complement=function(i,t){
var a=AjxUtil.arrayAsHash(i);
var e=AjxUtil.arrayAsHash(t);
for(var o in e){
if(o in a){
delete e[o]
}}
return AjxUtil.keys(e)
};
AjxUtil.filter=function(o,a,t){
var e=[];
if(o==null){
return e
}
var i=Array.prototype.filter;
if(i&&o.filter===i){
return o.filter(a,t)
}
AjxUtil.foreach(o,function(s,n){
if(a.call(t,s,n)){
e.push(s)
}}
);
return e
};
AjxUtil.getFirstElement=function(o,i,a,t){
for(var n=o.firstChild;
n;
n=n.nextSibling){
if(n.nodeType!=AjxUtil.ELEMENT_NODE){
continue
}
if(i&&n.nodeName!=i){
continue
}
if(a){
var e=n.getAttributeNode(a);
if(e.nodeName!=a){
continue
}
if(t&&e.nodeValue!=t){
continue
}}
return n
}
return null
};
AjxUtil.formatUrl=function(s){
s=s||{};
var a=[];
var o=0;
if(!s.relative){
var n=s.protocol||location.protocol;
if(n.indexOf(":")==-1){
n=n+":"
}
a[o++]=n;
a[o++]="//";
a[o++]=s.host||location.hostname;
var t=Number(s.port||location.port);
if(t&&((n==ZmSetting.PROTO_HTTP&&t!=ZmSetting.HTTP_DEFAULT_PORT)||(n==ZmSetting.PROTO_HTTPS&&t!=ZmSetting.HTTPS_DEFAULT_PORT))){
a[o++]=":";
a[o++]=t
}}
a[o++]=s.path||location.pathname;
var e="";
if(s.qsArgs){
e=AjxStringUtil.queryStringSet(s.qsArgs,s.qsReset)
}else{
e=s.qsReset?"":location.search
}
a[o++]=e;
return a.join("")
};
AjxUtil.byNumber=function(t,e){
return Number(t)-Number(e)
};
AjxUtil.byStringProp=function(i,t,e){
return t[i].localeCompare(e[i])
};
AjxUtil.arraySize=function(t){
var i=0;
for(var o in t){
if(t.hasOwnProperty(o)){
i++
}}
return i
};
AjxUtil.mergeArrays=function(h,n,e){
if(!e){
e=AjxUtil.__mergeArrays_orderfunc
}
var l=[];
var o=h.length;
for(var t=0;
t<o;
t++){
l.push(h[t])
}
var s=[];
var a=n.length;
for(var t=0;
t<a;
t++){
s.push(n[t])
}
var r=[];
while(l.length>0&&s.length>0){
if(e(l[0],r[r.length-1])==0){
l.shift();
continue
}
if(e(s[0],r[r.length-1])==0){
s.shift();
continue
}
if(e(l[0],s[0])<0){
r.push(l.shift())
}else{
if(e(l[0],s[0])==0){
r.push(l.shift());
s.shift()
}else{
r.push(s.shift())
}}}
while(l.length>0){
if(e(l[0],r[r.length-1])==0){
l.shift();
continue
}
r.push(l.shift())
}
while(s.length>0){
if(e(s[0],r[r.length-1])==0){
s.shift();
continue
}
r.push(s.shift())
}
return r
};
AjxUtil.__mergeArrays_orderfunc=function(t,e){
if(t>e){
return 1
}
if(t<e){
return -1
}
if(t==e){
return 0
}};
AjxUtil.arraySubtract=function(h,n,e){
if(!e){
e=function(c,i){
if(c>i){
return 1
}
if(c<i){
return -1
}
if(c==i){
return 0
}}
}
var l=[];
var o=h.length;
for(var t=0;
t<o;
t++){
l.push(h[t])
}
var s=[];
var a=n.length;
for(var t=0;
t<a;
t++){
s.push(n[t])
}
s.sort(e);
l.sort(e);
var r=[];
while(l.length>0&&s.length>0){
if(e(l[0],s[0])==0){
l.shift();
s.shift();
continue
}
if(e(l[0],s[0])<0){
r.push(l.shift());
continue
}
if(e(l[0],s[0])>0){
s.shift();
continue
}}
while(l.length>0){
r.push(l.shift())
}
return r
};
AjxUtil.arraySubstract=AjxUtil.arraySubtract;
AjxUtil.getHashKeys=function(a){
var t=[];
for(var e in a){
t.push(e)
}
t.sort();
return t
};
AjxUtil.arrayCompare=function(t,e){
if((!t||!e)&&(t!=e)){
return false
}
if(t.length!=e.length){
return false
}
for(var a=0;
a<t.length;
a++){
if(t[a]!=e[a]){
return false
}}
return true
};
AjxUtil.hashCompare=function(r,s){
var a=AjxUtil.getHashKeys(r);
var t=AjxUtil.getHashKeys(s);
if(!AjxUtil.arrayCompare(a,t)){
return false
}
for(var n=0,e=a.length;
n<e;
n++){
var o=a[n];
if(r[o]!=s[o]){
return false
}}
return true
};
AjxUtil.hashCopy=function(i,a,e){
a=a&&AjxUtil.arrayAsHash(a);
e=e&&AjxUtil.arrayAsHash(e);
var o={};
for(var t in i){
if((!a||!a[t])&&(!e||e[t])){
o[t]=i[t]
}}
return o
};
AjxUtil.hashUpdate=function(n,o,t,i,e){
i=i&&AjxUtil.arrayAsHash(i);
e=e&&AjxUtil.arrayAsHash(e);
for(var a in o){
if((t||!(a in n))&&(!i||!i[a])&&(!e||e[a])){
n[a]=o[a]
}}};
AjxUtil.isArray1=function(e){
return !!(e&&(e.length!=null)&&e.splice&&e.slice)
};
AjxUtil.toArray=function(t){
if(!t){
return[]
}else{
if(AjxUtil.isArray1(t)){
return t
}else{
if(AjxUtil.isArrayLike(t)){
try{
return Array.prototype.slice.call(t)
}
catch(a){
return AjxUtil.map(t)
}}else{
if(t.isAjxVector){
return t.getArray()
}else{
return[t]
}}}}};
AjxUtil.get=function(e){
for(var t=1;
e&&t<arguments.length;
t++){
e=e[arguments[t]]
}
return e
};
AjxUtil.convertToEntities=function(s){
var e="";
var n=0;
if(!s||!(n=s.length)){
return s
}
for(var o=0;
o<n;
o++){
var t=s.charCodeAt(o);
if((t>127)||(t==34)){
var a=t.toString(10);
while(a.length<4){
a="0"+a
}
e+="&#"+a+";"
}else{
e+=s.charAt(o)
}}
return e
};
AjxUtil.getClassAttr=function(t){
var e=[];
if(t&&t.length>0){
t=AjxUtil.uniq(t);
return["class='",t.join(" "),"'"].join("")
}
return""
};
AjxUtil.dataURItoBlob=function(s){
if(!(s&&typeof window.atob==="function"&&typeof window.Blob==="function")){
return
}
var l=s.split(",");
if(l.length===2){
if(l[0].indexOf("base64")===-1){
return
}
try{
var n=window.atob(l[1])
}
catch(h){
return
}
if(!n){
return
}
var o=l[0].split(":");
if(!o[1]){
return
}
o=o[1].split(";")[0];
if(o){
var t=n.length,c=new ArrayBuffer(t),a=new Uint8Array(c);
for(var r=0;
r<t;
r++){
a[r]=n.charCodeAt(r)
}
return new Blob([c],{
type:o}
)
}}};
AjxUtil.reduce=function(r,s,o){
var i=Array.prototype.reduce;
if(i){
return i.call(r,s,o)
}else{
if(r===null||"undefined"===typeof r){
throw new TypeError("AjxUtil.reduce called on null or undefined")
}
if("function"!==typeof s){
throw new TypeError(s+" is not a function")
}
var e,a,t=r.length>>>0,n=false;
if(1<arguments.length){
a=o;
n=true
}
for(e=0;
t>e;
++e){
if(r.hasOwnProperty(e)){
if(n){
a=s(a,r[e],e,r)
}else{
a=r[e];
n=true
}}}
if(!n){
throw new TypeError("Reduce of empty array with no initial value")
}
return a
}};
AjxUtil.getBrightness=function(t){
var i,a,e;
if(t&&t.length===7&&t.indexOf("#")===0){
t=t.substr(1)
}else{
return null
}
i=parseInt(t.substr(0,2),16);
a=parseInt(t.substr(2,2),16);
e=parseInt(t.substr(4,2),16);
return Math.sqrt(i*i*0.299+a*a*0.587+e*e*0.114)
};
AjxUtil.getForegroundColor=function(e){
var t=AjxUtil.getBrightness(e);
return(t!=null&&t<130)?"white":"black"
}
}
if(AjxPackage.define("ajax.core.AjxException")){
AjxException=function(a,t,i,e){
if(arguments.length==0){
return
}
this.msg=a;
this.code=t;
this.method=i;
this.detail=e
};
AjxException.prototype.toString=function(){
return"AjxException"
};
AjxException.prototype.dump=function(){
return"AjxException: msg="+this.msg+" code="+this.code+" method="+this.method+" detail="+this.detail
};
AjxException.INVALIDPARENT="AjxException.INVALIDPARENT";
AjxException.INVALID_OP="AjxException.INVALID_OP";
AjxException.INTERNAL_ERROR="AjxException.INTERNAL_ERROR";
AjxException.INVALID_PARAM="AjxException.INVALID_PARAM";
AjxException.UNIMPLEMENTED_METHOD="AjxException.UNIMPLEMENTED_METHOD";
AjxException.NETWORK_ERROR="AjxException.NETWORK_ERROR";
AjxException.OUT_OF_RPC_CACHE="AjxException.OUT_OF_RPC_CACHE";
AjxException.UNSUPPORTED="AjxException.UNSUPPORTED";
AjxException.UNKNOWN_ERROR="AjxException.UNKNOWN_ERROR";
AjxException.CANCELED="AjxException.CANCELED";
AjxException.defaultScriptErrorHandler=function(e){
alert(e)
};
AjxException.setScriptErrorHandler=function(e){
AjxException.scriptErrorHandler=e
};
AjxException.reportScriptError=function(e){
if(AjxException.reportScriptErrors&&AjxException.scriptErrorHandler&&!(e instanceof AjxException)){
AjxException.scriptErrorHandler(e)
}
throw e
};
AjxException.reportScriptErrors=false;
AjxException.scriptErrorHandler=AjxException.defaultScriptErrorHandler
}
if(AjxPackage.define("ajax.util.AjxCookie")){
AjxCookie=function(){};
AjxCookie.prototype.toString=function(){
return"AjxCookie"
};
AjxCookie.getCookie=function(h,t){
var l=t+"=";
var o=l.length;
var r=h.cookie.length;
var a=h.cookie;
var s=0;
while(s<r){
var n=s+o;
if(a.substring(s,n)==l){
var e=a.indexOf(";",n);
if(e==-1){
e=a.length
}
return unescape(a.substring(n,e))
}
s=a.indexOf(" ",s)+1;
if(s==0){
break
}}
return null
};
AjxCookie.setCookie=function(s,t,i,e,n,a,o){
s.cookie=t+"="+escape(i)+((e)?"; expires="+e.toGMTString():"")+((n)?"; path="+n:"")+((a)?"; domain="+a:"")+((o)?"; secure":"")
};
AjxCookie.deleteCookie=function(i,e,a,t){
i.cookie=e+"="+((a)?"; path="+a:"")+((t)?"; domain="+t:"")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT"
};
AjxCookie.areCookiesEnabled=function(i){
var e="ZM_COOKIE_TEST";
var a="Zimbra";
AjxCookie.setCookie(i,e,a);
var t=AjxCookie.getCookie(i,e);
AjxCookie.deleteCookie(i,e);
return t==a
}
}
if(AjxPackage.define("ajax.soap.AjxSoapException")){
AjxSoapException=function(a,t,i,e){
AjxException.call(this,a,t,i,e)
};
AjxSoapException.prototype.toString=function(){
return"AjxSoapException"
};
AjxSoapException.prototype=new AjxException;
AjxSoapException.prototype.constructor=AjxSoapException;
AjxSoapException.INTERNAL_ERROR="INTERNAL_ERROR";
AjxSoapException.INVALID_PDU="INVALID_PDU";
AjxSoapException.ELEMENT_EXISTS="ELEMENT_EXISTS"
}
if(AjxPackage.define("ajax.soap.AjxSoapFault")){
AjxSoapFault=function(t){
if(arguments.length==0){
return
}
var r=t.prefix;
var s=r+":Code";
var n=r+":Reason";
var a=r+":Detail";
var h=t.childNodes.length;
for(var o=0;
o<h;
o++){
var e=t.childNodes[o];
if(e.nodeName==s){
var l=e.firstChild.firstChild.nodeValue;
if(l==(r+":VersionMismatch")){
this.faultCode=AjxSoapFault.VERSION_MISMATCH
}else{
if(l==(r+":MustUnderstand")){
this.faultCode=AjxSoapFault.MUST_UNDERSTAND
}else{
if(l==(r+":DataEncodingUnknown")){
this.faultCode=AjxSoapFault.DATA_ENCODING_UNKNOWN
}else{
if(l==(r+":Sender")){
this.faultCode=AjxSoapFault.SENDER
}else{
if(l==(r+":Receiver")){
this.faultCode=AjxSoapFault.RECEIVER
}else{
this.faultCode=AjxSoapFault.UNKNOWN
}}}}}}else{
if(e.nodeName==n){
this.reason=e.firstChild.firstChild.nodeValue
}else{
if(e.nodeName==a){
this.errorCode=e.firstChild.firstChild.firstChild.nodeValue
}}}}};
AjxSoapFault.prototype.toString=function(){
return"AjxSoapFault"
};
AjxSoapFault.SENDER=-1;
AjxSoapFault.RECEIVER=-2;
AjxSoapFault.VERSION_MISMATCH=-3;
AjxSoapFault.MUST_UNDERSTAND=-4;
AjxSoapFault.DATA_ENCODING_UNKNOWN=-5;
AjxSoapFault.UNKNOWN=-6
}
if(AjxPackage.define("ajax.soap.AjxSoapDoc")){
AjxSoapDoc=function(){
this._soapURI=AjxSoapDoc._SOAP_URI
};
AjxSoapDoc.prototype.isAjxSoapDoc=true;
AjxSoapDoc.prototype.toString=function(){
return"AjxSoapDoc"
};
AjxSoapDoc._SOAP_URI="http://www.w3.org/2003/05/soap-envelope";
AjxSoapDoc._XMLNS_URI="http://www.w3.org/2000/xmlns";
AjxSoapDoc.create=function(e,a,r,s){
var n=new AjxSoapDoc();
n._xmlDoc=AjxXmlDoc.create();
var o=n._xmlDoc.getDoc();
if(!s){
s=AjxSoapDoc._SOAP_URI
}
n._soapURI=s;
var t=o.createElementNS&&!AjxEnv.isSafari;
var i=t?o.createElementNS(s,"soap:Envelope"):o.createElement("soap:Envelope");
if(!t){
i.setAttribute("xmlns:soap",s)
}
o.appendChild(i);
var h=t?o.createElementNS(s,"soap:Body"):o.createElement("soap:Body");
i.appendChild(h);
n._methodEl=a&&t?o.createElementNS(a,e):o.createElement(e);
if(a!=null&&!t){
if(r==null){
n._methodEl.setAttribute("xmlns",a)
}else{
n._methodEl.setAttribute("xmlns:"+r,a)
}}
h.appendChild(n._methodEl);
return n
};
AjxSoapDoc.createFromDom=function(t){
var e=new AjxSoapDoc();
e._xmlDoc=AjxXmlDoc.createFromDom(t);
e._methodEl=e._check(e._xmlDoc);
return e
};
AjxSoapDoc.createFromXml=function(e){
var t=new AjxSoapDoc();
t._xmlDoc=AjxXmlDoc.createFromXml(e);
t._methodEl=t._check(t._xmlDoc);
return t
};
AjxSoapDoc.element2FaultObj=function(t){
var e=t.firstChild;
if(!AjxEnv.isSafari){
if(e!=null&&e.namespaceURI!=AjxSoapDoc._SOAP_URI||e.nodeName!=(t.prefix+":Fault")){
return null
}}else{
if(e!=null&&e.nodeName!=(t.prefix+":Fault")){
return null
}}
return new AjxSoapFault(e)
};
AjxSoapDoc.prototype.setMethodAttribute=function(e,t){
this._methodEl.setAttribute(e,t)
};
AjxSoapDoc.prototype.set=function(t,l,c,n){
var h=this.getDoc();
var e=h.createElementNS&&!AjxEnv.isSafari;
var a=t?(n&&e?h.createElementNS(n,t):h.createElement(t)):h.createDocumentFragment();
if((n!==undefined)&&(n!==null)&&!e){
a.setAttribute("xmlns",n)
}
if(l!=null){
if(typeof l=="object"){
for(var r in l){
var o=l[r];
if(r.charAt(0)=="!"){
a.setAttribute(r.substr(1),o)
}else{
if(o instanceof Array){
for(var s=0;
s<o.length;
++s){
this.set(r,o[s],a)
}}else{
this.set(r,o,a)
}}}}else{
a.appendChild(h.createTextNode(l))
}}
if(!c){
c=this._methodEl
}
return c.appendChild(a)
};
AjxSoapDoc.prototype.getMethod=function(){
return this._methodEl
};
AjxSoapDoc.prototype.createHeaderElement=function(){
var a=this._xmlDoc.getDoc();
var t=a.firstChild;
var i=this.getHeader();
if(i!=null){
throw new AjxSoapException("SOAP header already exists",AjxSoapException.ELEMENT_EXISTS,"AjxSoapDoc.prototype.createHeaderElement")
}
var e=a.createElementNS&&!AjxEnv.isSafari;
i=e?a.createElementNS(this._soapURI,"soap:Header"):a.createElement("soap:Header");
t.insertBefore(i,t.firstChild);
return i
};
AjxSoapDoc.prototype.getHeader=function(){
var t=this._xmlDoc.getDoc();
var e=!t.getElementsByTagNameNS?(t.getElementsByTagName(t.firstChild.prefix+":Header")):(t.getElementsByTagNameNS(this._soapURI,"Header"));
return e?e[0]:null
};
AjxSoapDoc.prototype.getBody=function(){
var t=this._xmlDoc.getDoc();
var e=!t.getElementsByTagNameNS?(t.getElementsByTagName(t.firstChild.prefix+":Body")):(t.getElementsByTagNameNS(this._soapURI,"Body"));
return e?e[0]:null
};
AjxSoapDoc.prototype.getByTagName=function(t){
if(t.indexOf(":")==-1){
t="soap:"+t
}
var e=this.getDoc().getElementsByTagName(t);
if(e.length==1){
return e[0]
}else{
if(e.length>0){
return e
}else{
return null
}}};
AjxSoapDoc.prototype.ensureHeader=function(){
return(this.getHeader()||this.createHeaderElement())
};
AjxSoapDoc.prototype.getDoc=function(){
return this._xmlDoc.getDoc()
};
AjxSoapDoc.prototype.adoptNode=function(t){
if(AjxEnv.isFirefox3up||!AjxEnv.isFirefox){
try{
var a=this.getDoc();
if(a.adoptNode){
return a.adoptNode(t,true)
}}
catch(e){}}
return t.parentNode.removeChild(t)
};
AjxSoapDoc.prototype.getXml=function(){
return this._xmlDoc.getXml()
};
AjxSoapDoc.prototype._check=function(t){
var a=t.getDoc();
if(a.childNodes.length!=1){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:1")
}
var e=a.firstChild;
if(!AjxEnv.isSafari){
if(e.namespaceURI!=AjxSoapDoc._SOAP_URI||e.nodeName!=(e.prefix+":Envelope")||(e.childNodes.length<1||e.childNodes.length>2)){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}else{
if(e.nodeName!=(e.prefix+":Envelope")){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}}
}
if(AjxPackage.define("ajax.net.AjxRpcRequest")){
AjxRpcRequest=function(e){
if(!AjxRpcRequest.__inited){
AjxRpcRequest.__init()
}
this.id=e;
this.__httpReq=AjxRpcRequest.__msxmlVers?(new ActiveXObject(AjxRpcRequest.__msxmlVers)):(new XMLHttpRequest())
};
AjxRpcRequest.prototype.isAjxRpcRequest=true;
AjxRpcRequest.prototype.toString=function(){
return"AjxRpcRequest"
};
AjxRpcRequest.TIMEDOUT=-1000;
AjxRpcRequest.HTTP_GET="get";
AjxRpcRequest.HTTP_POST="post";
AjxRpcRequest.HTTP_PUT="put";
AjxRpcRequest.HTTP_DELETE="delete";
AjxRpcRequest.__inited=false;
AjxRpcRequest.__msxmlVers=null;
AjxRpcRequest.prototype.invoke=function(n,o,h,d,e,l){
var t=(d!=null);
this.methodName=o||"";
var a=AjxRpcRequest.HTTP_POST;
if(e){
a=e===true?AjxRpcRequest.HTTP_GET:e
}
if(window.csrfToken&&(a===AjxRpcRequest.HTTP_POST||a===AjxRpcRequest.HTTP_PUT||a===AjxRpcRequest.HTTP_DELETE)){
h=h||{};
h["X-Zimbra-Csrf-Token"]=window.csrfToken
}
this.__httpReq.open(a,o,t);
if(t){
if(l){
var s=new AjxTimedAction(this,this.__handleTimeout,[d]);
d._timedActionId=AjxTimedAction.scheduleAction(s,l)
}
var c=this;
this.__httpReq.onreadystatechange=function(i){
if(window.AjxRpcRequest){
AjxRpcRequest.__handleResponse(c,d)
}}
}else{
this.__httpReq.onreadystatechange=function(i){}
}
if(h){
for(var r in h){
if(h.hasOwnProperty(r)){
this.__httpReq.setRequestHeader(r,h[r])
}}}
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" RPC send: "+this.id);
this.__httpReq.send(n);
if(t){
return this.id
}else{
if(this.__httpReq.status==200||this.__httpReq.status==201){
return{
text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:true}
}else{
return{
text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:false,status:this.__httpReq.status}
}}};
AjxRpcRequest.prototype.cancel=function(){
AjxRpc.freeRpcCtxt(this);
if(AjxEnv.isFirefox3_5up){
this.__httpReq.onreadystatechange=function(){}
}
this.__httpReq.abort()
};
AjxRpcRequest.prototype.__handleTimeout=function(e){
this.cancel();
e.run({
text:null,xml:null,success:false,status:AjxRpcRequest.TIMEDOUT}
)
};
AjxRpcRequest.__handleResponse=function(a,i){
try{
if(!a||!a.__httpReq){
a.cancel();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Async RPC request: Lost request object!!!");
i.run({
text:null,xml:null,success:false,status:500}
);
AjxRpc.freeRpcCtxt(a);
return
}
if(a.__httpReq.readyState==4){
if(i._timedActionId!==null){
AjxTimedAction.cancelAction(i._timedActionId)
}
var e=500;
try{
e=a.__httpReq.status
}
catch(t){}
if(e==200||e==201){
i.run({
text:a.__httpReq.responseText,xml:a.__httpReq.responseXML,success:true,reqId:a.id}
)
}else{
i.run({
text:a.__httpReq.responseText,xml:a.__httpReq.responseXML,success:false,status:e,reqId:a.id}
)
}
AjxRpc.freeRpcCtxt(a)
}}
catch(t){
if(window.AjxException){
AjxException.reportScriptError(t)
}}};
AjxRpcRequest.__init=function(){
if(!window.XMLHttpRequest&&window.ActiveXObject){
var t=["MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];
for(var o=0;
o<t.length;
o++){
try{
var e=new ActiveXObject(t[o]);
AjxRpcRequest.__msxmlVers=t[o];
break
}
catch(a){}}
if(!AjxRpcRequest.__msxmlVers){
throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxRpc._init")
}}
AjxRpcRequest.__inited=true
}
}
if(AjxPackage.define("ajax.net.AjxRpc")){
AjxRpc=function(){};
AjxRpc.__rpcCache=[];
AjxRpc.__rpcOutstanding={};
AjxRpc.__RPC_CACHE_MAX=50;
AjxRpc.__RPC_ID=0;
AjxRpc.__RPC_IN_USE=0;
AjxRpc.__RPC_HIGH_WATER=0;
AjxRpc.__RPC_REAP_AGE=300000;
AjxRpc.__RPC_REAP_INTERVAL=1800000;
AjxRpc.invoke=function(i,a,s,c,e,l){
var t=(c!=null);
var n=AjxRpc.__getFreeRpcCtxt();
try{
var o=n.invoke(i,a,s,c,e,l)
}
catch(r){
var h=new AjxException();
h.method="AjxRpc.prototype._invoke";
if(r instanceof Error){
h.detail=r.message;
h.code=AjxException.NETWORK_ERROR;
h.msg="Network error"
}else{
if(r.code==101){
h.detail=r.message;
h.code=AjxException.NETWORK_ERROR;
h.msg="Network error"
}else{
h.detail=r.toString();
h.code=AjxException.UNKNOWN_ERROR;
h.msg="Unknown Error"
}}
AjxRpc.freeRpcCtxt(n);
throw h
}
if(!t){
AjxRpc.freeRpcCtxt(n)
}
return o
};
AjxRpc.freeRpcCtxt=function(e){
if(AjxRpc.__rpcOutstanding[e.id]){
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" --- freeing rpcCtxt "+e.id);
AjxRpc.__rpcCache.push(e);
delete AjxRpc.__rpcOutstanding[e.id];
AjxRpc.__RPC_IN_USE--
}};
AjxRpc.removeRpcCtxt=function(e){
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" REMOVE rpcCtxt "+e.id);
if(AjxRpc.__rpcOutstanding[e.id]){
delete AjxRpc.__rpcOutstanding[e.id];
AjxRpc.__RPC_IN_USE--
}
AjxUtil.arrayRemove(AjxRpc.__rpcCache,e)
};
AjxRpc.getRpcRequestById=function(e){
return(AjxRpc.__rpcOutstanding[e])
};
AjxRpc.__getFreeRpcCtxt=function(){
var e;
if(AjxRpc.__rpcCache.length>0){
e=AjxRpc.__rpcCache.pop();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" reusing RPC ID "+e.id)
}else{
if(AjxRpc.__RPC_IN_USE<AjxRpc.__RPC_CACHE_MAX){
var n="__RpcCtxt_"+AjxRpc.__RPC_ID;
e=new AjxRpcRequest(n);
AjxRpc.__RPC_ID++;
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Created RPC "+n)
}else{
e=AjxRpc.__reap();
if(!e){
var o=[];
for(var t in AjxRpc.__rpcOutstanding){
var e=AjxRpc.__rpcOutstanding[t];
o.push(e.methodName)
}
var a=o.join("<br>")+"<br>";
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Out of RPC cache!!! Outstanding requests: "+a);
throw new AjxException("Out of RPC cache",AjxException.OUT_OF_RPC_CACHE,"AjxRpc.__getFreeRpcCtxt",a)
}}}
AjxRpc.__rpcOutstanding[e.id]=e;
AjxRpc.__RPC_IN_USE++;
if(AjxRpc.__RPC_IN_USE>AjxRpc.__RPC_HIGH_WATER){
AjxRpc.__RPC_HIGH_WATER=AjxRpc.__RPC_IN_USE;
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" High water mark: "+AjxRpc.__RPC_HIGH_WATER)
}
e.timestamp=(new Date()).getTime();
return e
};
AjxRpc.__reap=function(a){
var e;
var o=(new Date()).getTime();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Running RPC context reaper");
for(var t in AjxRpc.__rpcOutstanding){
e=AjxRpc.__rpcOutstanding[t];
if((e.timestamp+AjxRpc.__RPC_REAP_AGE)<o){
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" AjxRpc.__reap: cleared RPC context "+e.id);
e.cancel();
delete AjxRpc.__rpcOutstanding[t];
AjxRpc.__RPC_IN_USE--;
if(!a){
return e
}}}
return null
};
window.setInterval(AjxRpc.__reap.bind(null,true),AjxRpc.__RPC_REAP_INTERVAL)
}
if(AjxPackage.define("ajax.util.AjxVector")){
AjxVector=function(e){
this._array=e||[]
};
AjxVector.prototype.isAjxVector=true;
AjxVector.prototype.toString=function(n,t){
if(t!==true){
return this._array.join(n)
}
var o=new Array();
for(var s=0;
s<this._array.length;
s++){
var e=this._array[s];
if(e!=undefined&&e!=null&&e!=""){
o.push(e)
}}
return o.join(n)
};
AjxVector.fromArray=function(t){
var e=new AjxVector();
if(AjxUtil.isArray1(t)){
e._array=t
}
return e
};
AjxVector.prototype.size=function(){
return this._array.length
};
AjxVector.prototype.add=function(a,e,t){
if(t&&this.contains(a)){
return
}
AjxUtil.arrayAdd(this._array,a,e)
};
AjxVector.prototype.addList=function(a){
if(!a){
return
}
if(a.length){
this._array=this._array.concat(a)
}else{
if(a.size&&a.size()){
if(AjxEnv.isIE&&(!(a._array instanceof Array))){
var t=[];
for(var e=0;
e<a._array.length;
e++){
t.push(a._array[e])
}
a._array=t
}
this._array=this._array.concat(a._array)
}}};
AjxVector.prototype.remove=function(e){
return AjxUtil.arrayRemove(this._array,e)
};
AjxVector.prototype.removeAt=function(t){
if(t>=this._array.length||t<0){
return null
}
var a=this._array.splice(t,1);
var e=null;
if(a){
e=a[0]
}
return e
};
AjxVector.prototype.removeAll=function(){
for(var e=0;
e<this._array.length;
e++){
this._array[e]=null
}
this._array.length=0
};
AjxVector.prototype.removeLast=function(){
return this._array.length>0?this._array.pop():null
};
AjxVector.prototype.reverse=function(){
this._array.reverse()
};
AjxVector.prototype.replace=function(a,t){
var e=this._array[a];
this._array[a]=t;
return e
};
AjxVector.prototype.replaceObject=function(a,e){
for(var t=0;
t<this._array.length;
t++){
if(this._array[t]==a){
this._array[t]=e;
return a
}}
return null
};
AjxVector.prototype.indexOf=function(a,t){
if(a==null){
return -1
}
a=t?t.call(a):a;
for(var e=0;
e<this._array.length;
e++){
var n=this._array[e],o=t?t.call(n):n;
if(o===a){
return e
}}
return -1
};
AjxVector.prototype.indexOfLike=AjxVector.prototype.indexOf;
AjxVector.prototype.lastIndexOf=function(a,t){
if(a==null){
return -1
}
a=t?t.call(a):a;
for(var e=this._array.length-1;
e>=0;
e--){
var n=this._array[e],o=t?t.call(n):n;
if(n===a){
return e
}}
return -1
};
AjxVector.prototype.lastIndexOfLike=AjxVector.prototype.lastIndexOf;
AjxVector.prototype.lastIndexOfLike=function(o,a){
var t=a.call(o);
for(var e=this._array.length-1;
e>=0;
e--){
var n=a.call(this._array[e]);
if(n==t){
return e
}}
return -1
};
AjxVector.prototype.clone=function(){
var e=new AjxVector();
e.addList(this);
return e
};
AjxVector.prototype.contains=function(e){
return AjxUtil.arrayContains(this._array,e)
};
AjxVector.prototype.containsLike=function(o,a){
var t=a.call(o);
for(var e=0;
e<this._array.length;
e++){
var n=a.call(this._array[e]);
if(n==t){
return true
}}
return false
};
AjxVector.prototype.get=function(e){
return e>=this._array.length||e<0?null:this._array[e]
};
AjxVector.prototype.getArray=function(){
return this._array
};
AjxVector.prototype.getLast=function(){
return this._array.length==0?null:this._array[this._array.length-1]
};
AjxVector.prototype.getNext=function(t){
var e=this.indexOf(t);
if(e==-1){
return null
}
return this.get(++e)
};
AjxVector.prototype.getPrev=function(t){
var e=this.indexOf(t);
if(e==-1){
return null
}
return this.get(--e)
};
AjxVector.prototype.sort=function(e){
if(!e){
e=AjxVector._defaultArrayComparator
}
this._array.sort(e)
};
AjxVector.prototype.binarySearch=function(s,r){
if(!r){
r=AjxVector._defaultArrayComparator
}
var a=0;
var e=this._array;
var o=e.length-1;
while(true){
if(o<a){
return -1
}
var n=Math.floor((a+o)/2);
var t=r(s,e[n]);
if(t<0){
o=n-1
}else{
if(t>0){
a=n+1
}else{
return n
}}}};
AjxVector.prototype.merge=function(n,o){
if(n<0){
return
}
var s=o instanceof AjxVector?o.getArray():o;
var e=this._array.length<(n+s.length)?this._array.length:n+s.length;
if(n<this._array.length){
var a=0;
for(var t=n;
t<e;
t++){
this._array[t]=s[a++]
}
if(a<s.length){
this._array=this._array.concat(s.slice(a))
}}else{
this._array=this._array.concat(s)
}};
AjxVector._defaultArrayComparator=function(t,e){
return t<e?-1:(t>e?1:0)
};
AjxVector.prototype.foreach=function(o,n){
var e=this.size(),t=0,a;
if(typeof o=="function"){
while(--e>=0){
o.call(n,this.get(t),t++)
}}else{
while(--e>=0){
a=this.get(t++);
if(a!=null){
a[o].call(a)
}}}};
AjxVector.prototype.map=function(n,s){
var e=[],t=this.size(),o;
if(typeof n=="function"){
while(--t>=0){
e[t]=n.call(s,this.get(t),t)
}}else{
if(n instanceof AjxCallback){
while(--t>=0){
e[t]=n.run(this.get(t),t)
}}else{
while(--t>=0){
o=this.get(t);
if(o!=null){
if(typeof o[n]=="function"){
e.unshift(o[n].call(o))
}else{
e.unshift(o[n])
}}}}}
return AjxVector.fromArray(e)
};
AjxVector.prototype.filter=function(t,e){
return AjxVector.fromArray(AjxUtil.filter(this._array,t,e))
};
AjxVector.prototype.join=function(e){
return this._array.join(e)
};
AjxVector.prototype.some=function(e,t){
return this._array.some(e,t)
};
AjxVector.prototype.sub=function(s,r){
var t=[],e=this.size(),o=0,n;
while(--e>=0){
n=this.get(o++);
if(!s.call(r,n,o)){
t.push(n)
}}
return AjxVector.fromArray(t)
};
AjxVector.prototype.slice=function(t,e){
return AjxVector.fromArray(this._array.slice(t,e))
}
}
if(AjxPackage.define("ajax.util.AjxStringUtil")){
AjxStringUtil=function(){};
AjxStringUtil.TRIM_RE=/^\s+|\s+$/g;
AjxStringUtil.COMPRESS_RE=/\s+/g;
AjxStringUtil.ELLIPSIS=" ... ";
AjxStringUtil.ELLIPSIS_NO_SPACE="...";
AjxStringUtil.LIST_SEP=", ";
AjxStringUtil.CRLF="\r\n";
AjxStringUtil.CRLF2="\r\n\r\n";
AjxStringUtil.CRLF_HTML="<br>";
AjxStringUtil.CRLF2_HTML="<div><br></div><div><br></div>";
AjxStringUtil.IMG_SRC_CID_REGEX=/<img([^>]*)\ssrc=["']cid:/gi;
AjxStringUtil.makeString=function(e){
return e?String(e):""
};
AjxStringUtil.capitalize=function(e){
return e&&e.length>0?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""
};
AjxStringUtil.capitalizeFirstLetter=function(e){
return e&&e.length>0?e.charAt(0).toUpperCase()+e.substr(1):""
};
AjxStringUtil.capitalizeWords=function(e){
return e?AjxUtil.map(e.split(/\s+/g),AjxStringUtil.capitalizeFirstLetter).join(" "):""
};
AjxStringUtil.toMixed=function(s,e,o){
if(!s||(typeof s!="string")){
return""
}
e=e||/\s+/;
var a=s.split(e);
var n=[];
n.push(o?a[0].toLowerCase():a[0].substring(0,1).toUpperCase()+a[0].substring(1).toLowerCase());
for(var t=1;
t<a.length;
t++){
n.push(a[t].substring(0,1).toUpperCase()+a[t].substring(1).toLowerCase())
}
return n.join("")
};
AjxStringUtil.fromMixed=function(t,e){
e=["$1",e||" ","$2"].join("");
return AjxStringUtil.trim(t.replace(/([a-z])([A-Z]+)/g,e))
};
AjxStringUtil.trim=function(o,e,i){
if(!o){
return""
}
var a=AjxStringUtil.TRIM_RE;
var t=AjxStringUtil.COMPRESS_RE;
if(i){
a=new RegExp("^"+i+"+|"+i+"+$","g");
t=new RegExp(i+"+","g")
}else{
i=" "
}
o=o.replace(a,"");
if(e){
o=o.replace(t,i)
}
return o
};
AjxStringUtil.repeat=function(o,e){
var a="";
for(var t=0;
t<e;
t++){
a+=o
}
return a
};
AjxStringUtil.getUnitsFromSizeString=function(t){
var a="px";
if(typeof(t)=="string"){
var e=Number(parseInt(t,10)).toString();
if(t.length>e.length){
a=t.substr(e.length,(t.length-e.length));
if(!(a=="em"||a=="ex"||a=="px"||a=="in"||a=="cm"==a=="mm"||a=="pt"||a=="pc"||a=="%")){
a="px"
}}}
return a
};
AjxStringUtil.split=function(l,o){
if(!l){
return[]
}
var s=0;
o=o?o:",";
var u=new Object();
if(typeof o=="string"){
u[o]=1
}else{
for(s=0;
s<o.length;
s++){
u[o[s]]=1
}}
var e=false;
var a=0;
var t=0;
var d;
var r=[];
var n=0;
for(s=0;
s<l.length;
s++){
var h=l.charAt(s);
if(h=='"'){
e=!e
}else{
if(h=="("){
a++
}else{
if(h==")"){
a--
}else{
if(u[h]){
if(!e&&!a){
d=l.substring(t,s);
r[n++]=d;
t=s+1
}}}}}}
d=l.substring(t,l.length);
r[n++]=d;
return r
};
AjxStringUtil.SPACE_WORD_RE=new RegExp("\\s*\\S+","g");
AjxStringUtil.splitKeepLeadingWhitespace=function(t){
var a=[],e;
while(e=AjxStringUtil.SPACE_WORD_RE.exec(t)){
a.push(e[0])
}
return a
};
AjxStringUtil.WRAP_LENGTH=80;
AjxStringUtil.HDR_WRAP_LENGTH=120;
AjxStringUtil.MAX_HTMLNODE_COUNT=250;
AjxStringUtil.HTML_QUOTE_COLOR="#1010FF";
AjxStringUtil.HTML_QUOTE_STYLE="color:#000;font-weight:normal;font-style:normal;text-decoration:none;font-family:Helvetica,Arial,sans-serif;font-size:12pt;";
AjxStringUtil.HTML_QUOTE_PREFIX_PRE='<blockquote style="border-left:2px solid '+AjxStringUtil.HTML_QUOTE_COLOR+";margin-left:5px;padding-left:5px;"+AjxStringUtil.HTML_QUOTE_STYLE+'">';
AjxStringUtil.HTML_QUOTE_PREFIX_POST="</blockquote>";
AjxStringUtil.HTML_QUOTE_NONPREFIX_PRE='<div style="'+AjxStringUtil.HTML_QUOTE_STYLE+'">';
AjxStringUtil.HTML_QUOTE_NONPREFIX_POST="</div><br/>";
AjxStringUtil.wordWrap=function(D){
if(!(D&&D.text)){
return""
}
var p=D.text;
var g=D.before||"";
var t=D.after||"";
var a=D.isFlowed;
if(D.htmlMode){
g=D.before||(D.prefix?AjxStringUtil.HTML_QUOTE_PREFIX_PRE:AjxStringUtil.HTML_QUOTE_NONPREFIX_PRE);
t=D.after||(D.prefix?AjxStringUtil.HTML_QUOTE_PREFIX_POST:AjxStringUtil.HTML_QUOTE_NONPREFIX_POST);
return[g,p,t].join("")
}
var T=D.len||(D.isHeaders?AjxStringUtil.HDR_WRAP_LENGTH:AjxStringUtil.WRAP_LENGTH);
var S=D.prefix||"";
var s="\n";
var e=p.split(AjxStringUtil.SPLIT_RE);
var v=[];
for(var q=0,C=e.length;
q<C;
q++){
var u=e[q];
var x=u.match(/^([\s>\|]+)/);
var j=x?x[1]:"";
if(j){
u=u.substr(j.length)
}
if(AjxStringUtil._NON_WHITESPACE.test(u)){
var h=AjxStringUtil.splitKeepLeadingWhitespace(u);
if(h&&h[0]&&h[0].length){
var k=AjxStringUtil.MSG_SEP_RE.test(u)||AjxStringUtil.COLON_RE.test(u)||AjxStringUtil.HDR_RE.test(u)||D.isHeaders||AjxStringUtil.SIG_RE.test(u);
var y=D.preserveReturns;
if(a){
var x=u.match(/( +)$/);
if(x){
h[h.length-1]+=x[1];
y=false
}else{
y=true
}}
for(var d=0,f=h.length;
d<f;
d++){
v.push({
w:h[d],prefix:j,mustStart:(d===0)&&k,mustEnd:(d===f-1)&&y}
)
}}}else{
v.push({
para:true,prefix:j}
)
}}
var c="",n=0,h=[],r=null;
for(var z=0,O=v.length;
z<O;
z++){
var A=v[z];
var d=A.w,j=A.prefix;
var o=!S?"":r?S:S+" ";
var W=(r===null)?0:r.length;
W=0;
var B=o+(r||"");
if(A.para){
if(h.length){
c+=B+h.join("").replace(/^ +/,"")+s
}
if(z<v.length-1){
r=j;
o=!S?"":r?S:S+" ";
B=o+(r||"");
c+=B+s
}
h=[];
n=0;
r=null
}else{
if((W+n+d.length<=T)&&(j===r||r===null)&&!A.mustStart){
h.push(d);
n+=d.length;
r=j;
if(A.mustEnd&&v[z+1]){
v[z+1].mustStart=true
}}else{
if(h.length){
c+=B+h.join("").replace(/^ +/,"")+s
}
h=[d];
n=d.length;
r=j;
if(A.mustEnd&&v[z+1]){
v[z+1].mustStart=true
}}}}
if(h.length){
var o=!S?"":h[0].prefix?S:S+" ";
var B=o+(r||"");
c+=B+h.join("").replace(/^ /,"")+s
}
return[g,c,t].join("")
};
AjxStringUtil.quoteText=function(i){
if(!(i&&i.text)){
return""
}
var h=i.text;
var r=i.before||"",e=i.after||"";
if(i.htmlMode||!i.pre){
return[r,h,e].join("")
}
var n=i.len||80;
var a=i.pre||"";
var s="\n";
h=AjxStringUtil.trim(h);
h=h.replace(/\n\r/g,s);
var u=h.split(s);
var d=[];
for(var t=0,o=u.length;
t<o;
t++){
var c=AjxStringUtil.trim(u[t]);
d.push(a+c+s)
}
return r+d.join("")+e
};
AjxStringUtil.SHIFT_CHAR={
48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};
AjxStringUtil.shiftChar=function(e,t){
return t?AjxStringUtil.SHIFT_CHAR[e]||String.fromCharCode(e):String.fromCharCode(e)
};
AjxStringUtil.diffPoint=function(o,a){
if(!(o&&a)){
return 0
}
var e=Math.min(o.length,a.length);
var t=0;
while(t<e&&(o.charAt(t)==a.charAt(t))){
t++
}
return t
};
AjxStringUtil.resolve=function(t,e){
return AjxMessageFormat.format(t,e)
};
AjxStringUtil.urlEncode=function(t){
if(!t){
return""
}
var e=window.encodeURL||window.encodeURI;
return e(t)
};
AjxStringUtil.urlComponentEncode=function(t){
if(!t){
return""
}
var e=window.encodeURLComponent||window.encodeURIComponent;
return e(t)
};
AjxStringUtil.urlDecode=function(i){
if(!i){
return""
}
var t=window.decodeURL||window.decodeURI;
try{
return t(i)
}
catch(a){
return""
}};
AjxStringUtil.urlComponentDecode=function(o){
if(!o){
return""
}
var a=window.decodeURLComponent||window.decodeURIComponent;
var t;
try{
t=a(o)
}
catch(i){
t=unescape(o)
}
return t||o
};
AjxStringUtil.ENCODE_MAP={
">":"&gt;","<":"&lt;","&":"&amp;"};
AjxStringUtil.htmlEncode=function(t,e){
if(!t){
return""
}
if(typeof(t)!="string"){
t=t.toString?t.toString():""
}
if(!AjxEnv.isSafari||AjxEnv.isSafariNightly){
if(e){
return t.replace(/[<>&]/g,function(a){
return AjxStringUtil.ENCODE_MAP[a]
}
).replace(/  /g," &nbsp;")
}else{
return t.replace(/[<>&]/g,function(a){
return AjxStringUtil.ENCODE_MAP[a]
}
)
}}else{
if(e){
return t.replace(/[&]/g,"&amp;").replace(/  /g," &nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}else{
return t.replace(/[&]/g,"&amp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}}};
AjxStringUtil.encodeQuotes=function(e){
return e.replace(/"/g,"&quot;").replace(/'/g,"&#39;")
};
AjxStringUtil.htmlDecode=function(t,e){
if(e){
t=t.replace(/&nbsp;/g," ")
}
return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")
};
AjxStringUtil.__jsEscapeChar=function(t){
var e=t.charCodeAt(0).toString(16);
if(e.length==1){
return"\\u000"+e
}else{
if(e.length==2){
return"\\u00"+e
}else{
if(e.length==3){
return"\\u0"+e
}else{
if(e.length==4){
return"\\u"+e
}}}}
DBG.println(AjxDebug.NONE,"unexpected condition in AjxStringUtil.__jsEscapeChar -- code point 0x"+e+" doesn't fit in 16 bits")
};
AjxStringUtil.jsEncode=function(e){
return e.replace(/[^\u0020-\u007e]/g,AjxStringUtil.__jsEscapeChar)
};
AjxStringUtil.stripTags=function(t,e){
if(typeof t!=="string"){
return""
}
if(e){
t=t.replace(/(<(\w+)[^>]*>).*(<\/\2[^>]*>)/,"$1$3")
}
return t.replace(/<\/?[^>]+>/gi,"")
};
AjxStringUtil.convertToHtml=function(h,a,t,r){
t=t||"<blockquote>";
r=r||"</blockquote>";
if(!h){
return""
}
h=AjxStringUtil.htmlEncode(h);
if(a){
var o=/^(>|&gt;|\|\s+)/;
var c=h.split(/\r?\n/);
var e=0;
for(var n=0;
n<c.length;
n++){
var l=c[n];
if(l.length>0){
var s=0;
while(l.match(o)){
l=l.replace(o,"");
s++
}
while(s>e){
l=t+l;
e++
}
while(s<e){
c[n-1]=c[n-1]+r;
e--
}}
c[n]=l
}
while(e>0){
c.push(r);
e--
}
h=c.join("\n")
}
h=h.replace(/  /mg," &nbsp;").replace(/^ /mg,"&nbsp;").replace(/\t/mg,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\r?\n/mg,"<br>");
return h
};
AjxStringUtil.SPACE_ENCODE_MAP={
" ":"&nbsp;",">":"&gt;","<":"&lt;","&":"&amp;","\n":"<br>"};
AjxStringUtil.htmlEncodeSpace=function(e){
if(!e){
return""
}
return e.replace(/[&]/g,"&amp;").replace(/ /g,"&nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
};
AjxStringUtil.htmlRubyEncode=function(e,t){
if(e&&t){
return["<ruby>","<rb>",AjxStringUtil.htmlEncode(e),"</rb> ","<rp>(</rp><rt>",AjxStringUtil.htmlEncode(t),"</rt><rp>)</rp>","</ruby>"].join("")
}
return AjxStringUtil.htmlEncode(e||t||"")
};
AjxStringUtil.nl2br=function(e){
if(!e){
return""
}
return e.replace(/^ /mg,"&nbsp;").replace(/\t/mg,"<span style='white-space:pre'>\t</span>").replace(/\n/g,"<br>")
};
AjxStringUtil.xmlEncode=function(e){
if(e){
e=""+e;
return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")
}
return""
};
AjxStringUtil.xmlDecode=function(e){
return e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<"):""
};
AjxStringUtil.xmlAttrEncode=function(e){
return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&apos;"):""
};
AjxStringUtil.xmlAttrDecode=function(e){
return e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&apos;/g,"'"):""
};
AjxStringUtil.__RE_META={
" ":" ","\n":"\\n","\r":"\\r","\t":"\\t"};
AjxStringUtil.__reMetaEscape=function(t,e){
return AjxStringUtil.__RE_META[e]||"\\"+e
};
AjxStringUtil.regExEscape=function(e){
return e.replace(/(\W)/g,AjxStringUtil.__reMetaEscape)
};
AjxStringUtil._calcDIV=null;
AjxStringUtil.calcDIV=function(){
if(AjxStringUtil._calcDIV==null){
AjxStringUtil._calcDIV=document.createElement("div");
AjxStringUtil._calcDIV.style.zIndex=0;
AjxStringUtil._calcDIV.style.position=DwtControl.ABSOLUTE_STYLE;
AjxStringUtil._calcDIV.style.visibility="hidden";
document.body.appendChild(AjxStringUtil._calcDIV)
}
return AjxStringUtil._calcDIV
};
AjxStringUtil.clip=function(e,s,n){
var o=AjxStringUtil.calcDIV();
if(arguments.length==3){
o.className=n
}
o.innerHTML=e;
if(o.offsetWidth<=s){
return e
}
for(var a=e.length-1;
a>0;
a--){
var t=e.substr(0,a);
o.innerHTML=t+AjxStringUtil.ELLIPSIS;
if(o.offsetWidth<=s){
return t+AjxStringUtil.ELLIPSIS
}}
return e
};
AjxStringUtil.clipByLength=function(a,t){
var e=a.length;
return(e<=t)?a:[a.substr(0,t/2),"...",a.substring(e-((t/2)-3),e)].join("")
};
AjxStringUtil.wrap=function(n,s,r){
var u=AjxStringUtil.calcDIV();
if(arguments.length==3){
u.className=r
}
var h="";
var o="";
var e=n.split("/n");
for(var i=0;
i<e.length;
i++){
if(i!=0){
h+=o+"<br>";
o=""
}
htmlRows=e[i].split("<br>");
for(var c=0;
c<htmlRows.length;
c++){
if(c!=0){
h+=o+"<br>";
o=""
}
words=htmlRows[c].split(" ");
var d=0;
while(d<words.length){
u.innerHTML=o+" "+words[d];
var a=u.offsetWidth;
if(a>s){
u.innerHTML=words[d];
a=a-u.offsetWidth;
if((a>=s)||(u.offsetWidth<=s)){
h+=o+"<br>";
o=""
}else{
var l=true;
var t=0;
while(l){
t++;
u.innerHTML=o+" "+words[d].substring(0,t);
l=(u.offsetWidth<=s)
}
t--;
h+=o+words[d].substring(0,t)+"<br>";
words[d]=words[d].substr(t);
o=""
}}else{
o+=" "+words[d];
d++
}}}}
h+=o;
return h
};
AjxStringUtil.MSG_SEP_RE=new RegExp("^\\s*--+\\s*("+AjxMsg.origMsg+"|"+AjxMsg.forwardedMessage+")\\s*--+","i");
AjxStringUtil.SIG_RE=/^(- ?-+)|(__+)\r?$/;
AjxStringUtil.SPLIT_RE=/\r\n|\r|\n/;
AjxStringUtil.HDR_RE=/^\s*\w+:/;
AjxStringUtil.COLON_RE=/\S+:$/;
AjxStringUtil._NO_LIST=0;
AjxStringUtil._ORDERED_LIST=1;
AjxStringUtil._UNORDERED_LIST=2;
AjxStringUtil._INDENT="    ";
AjxStringUtil._NON_WHITESPACE=/\S+/;
AjxStringUtil._LF=/\n/;
AjxStringUtil.convertHtml2Text=function(i,n,o){
if(!i){
return""
}
if(n&&AjxUtil.isFunction(n._before)){
i=n._before(i)
}
if(typeof i=="string"){
var s=document.createElement("SPAN");
s.innerHTML=i;
i=s
}
var r=[];
var a=0;
var t={};
AjxStringUtil._traverse(i,r,a,AjxStringUtil._NO_LIST,0,0,t,n,o);
var e=r.join("");
if(n&&AjxUtil.isFunction(n._after)){
e=n._after(e)
}
return e
};
AjxStringUtil._traverse=function(e,f,d,l,r,n,s,c,u){
var h=e.nodeName.toLowerCase();
var p=null;
if(c&&c[h]){
p=c[h](e,s)
}
if(p!=null){
f[d++]=p
}else{
if(h=="#text"){
if(e.nodeValue.search(AjxStringUtil._NON_WHITESPACE)!=-1){
if(s.lastNode=="ol"||s.lastNode=="ul"){
f[d++]="\n"
}
if(s.isPreformatted){
f[d++]=AjxStringUtil.trim(e.nodeValue)+" "
}else{
f[d++]=AjxStringUtil.trim(e.nodeValue.replace(AjxStringUtil._LF," "),true)+" "
}}}else{
if(h=="p"){
f[d++]=u?"\n":"\n\n"
}else{
if(h==="a"){
if(e.href){
f[d++]="[ ";
f[d++]=e.href;
if(e.textContent){
f[d++]=" | ";
f[d++]=e.textContent
}
f[d++]=" ] ";
return d
}}else{
if(l==AjxStringUtil._NO_LIST&&(h=="br"||h=="hr")){
f[d++]="\n"
}else{
if(h=="ol"||h=="ul"){
f[d++]="\n";
if(e.parentNode.nodeName.toLowerCase()!="li"&&s.lastNode!="br"&&s.lastNode!="hr"){
f[d++]="\n"
}
l=(h=="ol")?AjxStringUtil._ORDERED_LIST:AjxStringUtil._UNORDERED_LIST;
r++;
n=0
}else{
if(h=="li"){
for(var a=0;
a<r;
a++){
f[d++]=AjxStringUtil._INDENT
}
if(l==AjxStringUtil._ORDERED_LIST){
f[d++]=n+". "
}else{
f[d++]="\u002A "
}}else{
if(h=="tr"&&e.parentNode.firstChild!=e){
f[d++]="\n"
}else{
if(h=="td"&&e.parentNode.firstChild!=e){
f[d++]="\t"
}else{
if(h=="div"||h=="address"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}}else{
if(h=="blockquote"){
f[d++]="\n\n"
}else{
if(h=="pre"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}
s.isPreformatted=true
}else{
if(h=="#comment"||h=="script"||h=="select"||h=="style"){
return d
}}}}}}}}}}}}}
var m=e.childNodes;
var o=m.length;
for(var a=0;
a<o;
a++){
var t=m[a];
if(t.nodeType==1&&t.tagName.toLowerCase()=="li"){
n++
}
d=AjxStringUtil._traverse(t,f,d,l,r,n,s,c,u)
}
if(c&&c["/"+h]){
f[d++]=c["/"+h](e)
}
if(h=="h1"||h=="h2"||h=="h3"||h=="h4"||h=="h5"||h=="h6"||h=="div"||h=="address"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}
s.list=false
}else{
if(h=="pre"){
if(d&&f[d-1]!=="\n"){
f[d++]="\n"
}
s.isPreformatted=false
}else{
if(h=="li"){
if(!s.list){
f[d++]="\n"
}
s.list=false
}else{
if(h=="ol"||h=="ul"){
s.list=true
}else{
if(h!="#text"){
s.list=false
}}}}}
s.lastNode=h;
return d
};
AjxStringUtil.queryStringSet=function(r,l){
var h=l?"":location.search;
if(h.indexOf("?")==0){
h=h.substr(1)
}
var s=h.split("&");
var a={};
for(var o=0;
o<s.length;
o++){
var n=s[o].split("=");
a[n[0]]=n[1]
}
for(var e in r){
a[e]=r[e]
}
var t=[];
var o=0;
for(var e in a){
if(e){
t[o++]=[e,a[e]].join("=")
}}
return"?"+t.join("&")
};
AjxStringUtil.queryStringRemove=function(e,a){
e=e?e:"";
if(e.indexOf("?")==0){
e=e.substr(1)
}
var n=e.split("&");
var t=[];
for(var o=0;
o<n.length;
o++){
if(n[o].indexOf(a)!=0){
t.push(n[o])
}}
return"?"+t.join("&")
};
AjxStringUtil.getAsString=function(e){
return !e?"":(typeof(e)=="object")?e.toString():e
};
AjxStringUtil.isWhitespace=function(e){
return(e.charCodeAt(0)<=32)
};
AjxStringUtil.isDigit=function(t){
var e=t.charCodeAt(0);
return(e>=48&&e<=57)
};
AjxStringUtil.compareRight=function(o,t){
var n=0;
var r=0;
var s=0;
var i;
var e;
for(;
(r<o.length||s<t.length);
r++,s++){
i=o.charAt(r);
e=t.charAt(s);
if(!AjxStringUtil.isDigit(i)&&!AjxStringUtil.isDigit(e)){
return n
}else{
if(!AjxStringUtil.isDigit(i)){
return -1
}else{
if(!AjxStringUtil.isDigit(e)){
return +1
}else{
if(i<e){
if(n==0){
n=-1
}}else{
if(i>e){
if(n==0){
n=+1
}}}}}}}};
AjxStringUtil.natCompare=function(h,r){
var s=0,o=0;
var t=0,e=0;
var n,i;
while(s<h.length||o<r.length){
t=e=0;
n=h.charAt(s);
i=r.charAt(o);
while(AjxStringUtil.isWhitespace(n)||n=="0"){
t=(n=="0")?(t+1):0;
n=h.charAt(++s)
}
while(AjxStringUtil.isWhitespace(i)||i=="0"){
e=(i=="0")?(e+1):0;
i=r.charAt(++o)
}
if(AjxStringUtil.isDigit(n)&&AjxStringUtil.isDigit(i)){
var l=AjxStringUtil.compareRight(h.substring(s),r.substring(o));
if(l&&l!=0){
return l
}}
if(n==0&&i==0){
return t-e
}
if(n<i){
return -1
}else{
if(n>i){
return +1
}}
++s;
++o
}};
AjxStringUtil.clipFile=function(o,e){
var t=o.lastIndexOf(".");
if(t<=0){
t=o.length
}
if(t<=e){
return o
}
var i=o.slice(0,t);
var a=o.slice(t);
return[i.slice(0,e/2),AjxMsg.ellipsis,i.slice(-Math.ceil(e/2)+AjxMsg.ellipsis.length),a].join("")
};
AjxStringUtil.URL_PARSE_RE=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)?((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?");
AjxStringUtil.parseURL=function(a){
var n=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"];
var o=AjxStringUtil.URL_PARSE_RE.exec(a);
var t={};
for(var e=0;
e<n.length;
e++){
t[n[e]]=(o[e]?o[e]:"")
}
if(t.directoryPath.length>0){
t.directoryPath=t.directoryPath.replace(/\/?$/,"/")
}
return t
};
AjxStringUtil.parseMailtoLink=function(a){
var t={};
if(!a){
return t
}
if(a.toLowerCase().indexOf("mailto:")===-1){
t.to=a;
return t
}
var e=a.match(/\bsubject=([^&]+)/i);
t.subject=e?decodeURIComponent(e[1]):null;
e=a.match(/\bto\:([^&]+)/);
if(!e){
e=a.match(/\bmailto\:([^\?]+)/i)
}
t.to=e?decodeURIComponent(e[1]):null;
e=a.match(/\bbody=([^&]+)/i);
t.body=e?decodeURIComponent(e[1]):null;
return t
};
AjxStringUtil.parseQueryString=function(n){
var h=n||(""+window.location);
var l=h.indexOf("?");
var s=(l===-1)?h:h.substring(l+1);
s=s.replace(/#.*$/,"");
var o=s.split("&");
var e={}
,t,c,r;
for(var a=0;
a<o.length;
a++){
t=o[a].split("=");
c=decodeURIComponent(t[0]),r=t[1]?decodeURIComponent(t[1]):true;
e[c]=r
}
return e
};
AjxStringUtil.prettyPrint=function(i,a,e,t){
AjxStringUtil._visited=new AjxVector();
var o=AjxStringUtil._prettyPrint(i,a,e,t);
AjxStringUtil._visited=null;
return o
};
AjxStringUtil._visited=null;
AjxStringUtil._prettyPrint=function(r,t,y,a){
var d=0;
var o=false;
var u=false;
if(arguments.length>4){
d=arguments[4];
o=arguments[5];
u=arguments[6]
}
if(AjxUtil.isObject(r)){
var p=r.toString?r.toString():"";
if(a&&p&&a[p]){
return"["+p+"]"
}
if(AjxStringUtil._visited.contains(r)){
return"[visited object]"
}else{
AjxStringUtil._visited.add(r)
}}
var s=AjxStringUtil.repeat(" ",d);
var h="";
if(r===undefined){
h+="[undefined]"
}else{
if(r===null){
h+="[null]"
}else{
if(AjxUtil.isBoolean(r)){
h+=r?"true":"false"
}else{
if(AjxUtil.isString(r)){
h+='"'+AjxStringUtil._escapeForHTML(r)+'"'
}else{
if(AjxUtil.isNumber(r)){
h+=r
}else{
if(AjxUtil.isObject(r)){
var n=AjxUtil.isArray(r)||AjxUtil.isArray1(r);
if(u){
h+=n?"[Array]":r.toString()
}else{
u=!t;
var l=new Array();
for(var m in r){
if(r.hasOwnProperty(m)){
l.push(m)
}}
if(n){
l.sort(function(v,i){
return v-i
}
)
}else{
l.sort()
}
if(o){
h+=n?"[":"{"
}
var f=l.length;
for(var m=0;
m<f;
m++){
var w=l[m];
var g=r[w];
var c=null;
if(g==window||g==document||(!AjxEnv.isIE&&g instanceof Node)){
c=g.toString()
}
if((typeof(g)=="function")){
if(y){
c="[function]"
}else{
continue
}}
if(m>0){
h+=","
}
h+="\n"+s;
var e;
if(n){
e="// ["+w+"]:\n"+s
}else{
e=w+": "
}
if(a&&a[w]){
h+=e+"["+w+"]"
}else{
if(c!=null){
h+=e+c
}else{
h+=e+AjxStringUtil._prettyPrint(g,t,y,a,d+2,true,u)
}}}
if(m>0){
h+="\n"+AjxStringUtil.repeat(" ",d-1)
}
if(o){
h+=n?"]":"}"
}}}}}}}}
return h
};
AjxStringUtil._escapeForHTML=function(t){
if(typeof(t)!="string"){
return t
}
var e=t;
e=e.replace(/\&/g,"&amp;");
e=e.replace(/\</g,"&lt;");
e=e.replace(/\>/g,"&gt;");
e=e.replace(/\"/g,"&quot;");
e=e.replace(/\xA0/g,"&nbsp;");
return e
};
AjxStringUtil._testSpan=null;
AjxStringUtil._testSpanBold=null;
AjxStringUtil.WIDTH={};
AjxStringUtil.WIDTH_BOLD={};
AjxStringUtil.MAX_CACHE=1000;
AjxStringUtil._cacheSize=0;
AjxStringUtil.getWidth=function(o,i,h){
if(!AjxStringUtil._testSpan){
var a=AjxStringUtil._testSpan=document.createElement("SPAN");
var t=AjxStringUtil._testSpanBold=document.createElement("SPAN");
a.style.position=t.style.position=Dwt.ABSOLUTE_STYLE;
var l=DwtShell.getShell(window).getHtmlElement();
l.appendChild(a);
l.appendChild(t);
Dwt.setLocation(a,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
Dwt.setLocation(t,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
t.style.fontWeight="bold"
}
if(AjxUtil.isString(h)){
h=DwtCssStyle.asPixelCount(h)
}
var n=""+(h||0);
var e=i?AjxStringUtil.WIDTH_BOLD:AjxStringUtil.WIDTH;
if(e[o]&&e[o][n]){
return e[o][n]
}
if(AjxStringUtil._cacheSize>=AjxStringUtil.MAX_CACHE){
AjxStringUtil.WIDTH={};
AjxStringUtil.WIDTH_BOLD={};
AjxStringUtil._cacheSize=0
}
var r=i?AjxStringUtil._testSpanBold:AjxStringUtil._testSpan;
r.innerHTML=o;
r.style.fontSize=h?(h+"px"):null;
if(!e[o]){
e[o]={}
}
var s=e[o][n]=Dwt.getSize(r).x;
AjxStringUtil._cacheSize++;
return s
};
AjxStringUtil.fitString=function(o,t){
var a=AjxStringUtil.getWidth(o);
if(a<t){
return o
}
var e=AjxStringUtil.ELLIPSIS_NO_SPACE,i=AjxStringUtil.getWidth(e);
while(o.length>0){
if(AjxStringUtil.getWidth(o)+i<t){
return o+e
}else{
o=o.substring(0,o.length-1)
}}
return""
};
AjxStringUtil.fixCrossDomainReference=function(t,i,a){
var n=AjxStringUtil.parseURL(t);
if(n.authority==window.location.host){
return t
}
if((i&&t.indexOf(i)>=0)||!i){
if(a){
t=n.path
}else{
var o=n.protocol+"://"+n.authority;
var e=window.location.protocol+"//"+window.location.host;
t=t.replace(o,e)
}}
return t
};
AjxStringUtil._dummyDiv=document.createElement("DIV");
AjxStringUtil.htmlPlatformIndependent=function(t){
var a=AjxStringUtil._dummyDiv;
a.innerHTML=t;
var e=a.innerHTML;
a.innerHTML="";
return e
};
AjxStringUtil.equalsHtmlPlatformIndependent=function(t,e){
return AjxStringUtil.htmlPlatformIndependent(t)==AjxStringUtil.htmlPlatformIndependent(e)
};
AjxStringUtil.ORIG_UNKNOWN="UNKNOWN";
AjxStringUtil.ORIG_QUOTED="QUOTED";
AjxStringUtil.ORIG_SEP_STRONG="SEP_STRONG";
AjxStringUtil.ORIG_SEP_WEAK="SEP_WEAK";
AjxStringUtil.ORIG_WROTE_STRONG="WROTE_STRONG";
AjxStringUtil.ORIG_WROTE_WEAK="WROTE_WEAK";
AjxStringUtil.ORIG_HEADER="HEADER";
AjxStringUtil.ORIG_LINE="LINE";
AjxStringUtil.ORIG_SIG_SEP="SIG_SEP";
AjxStringUtil.MSG_REGEXES=[{
type:AjxStringUtil.ORIG_QUOTED,regex:/^\s*(>|\|)/}
,{
type:AjxStringUtil.ORIG_SEP_STRONG,regex:new RegExp("^\\s*--+\\s*("+AjxMsg.origMsg+"|"+AjxMsg.forwardedMessage+"|"+AjxMsg.origAppt+")\\s*--+\\s*$","i")}
,{
type:AjxStringUtil.ORIG_SEP_STRONG,regex:new RegExp("^"+AjxMsg.forwardedMessage1+"$","i")}
,{
type:AjxStringUtil.ORIG_HEADER,regex:new RegExp("^\\s*("+[AjxMsg.from,AjxMsg.to,AjxMsg.subject,AjxMsg.date,AjxMsg.sent,AjxMsg.cc].join("|")+")")}
,{
type:AjxStringUtil.ORIG_LINE,regex:/^\s*_{5,}\s*$/}
];
AjxStringUtil.HTML_SEP_ID="zwchr";
AjxStringUtil.ORIG_EMAIL_RE=/[^@\s]+@[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})+/;
AjxStringUtil.ORIG_DATE_RE=/\d+\s*(\/|\-|, )20\d\d/;
AjxStringUtil.ORIG_INTRO_RE=new RegExp("^(-{2,}|"+AjxMsg.on+"\\s+)","i");
AjxStringUtil._writeToTestIframeDoc=function(t){
var a;
if(!AjxStringUtil.__curIframeId){
a=document.createElement("IFRAME");
AjxStringUtil.__curIframeId=a.id=Dwt.getNextId();
Dwt.setPosition(a,Dwt.ABSOLUTE_STYLE);
Dwt.setLocation(a,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
a.setAttribute("aria-hidden",true);
document.body.appendChild(a)
}else{
a=document.getElementById(AjxStringUtil.__curIframeId)
}
var e=Dwt.getIframeDoc(a);
t=t&&t.replace(AjxStringUtil.IMG_SRC_CID_REGEX,'<img $1 pnsrc="cid:');
e.open();
e.write(t);
e.close();
return e.childNodes[0]
};
AjxStringUtil._removeTestIframeDoc=function(){
if(AjxEnv.isFirefox){
var e=document.getElementById(AjxStringUtil.__curIframeId);
if(e){
e.parentNode.removeChild(e)
}
AjxStringUtil.__curIframeId=null
}};
AjxStringUtil.getOriginalContent=function(m,u){
if(!m){
return""
}
if(u){
return AjxStringUtil._getOriginalHtmlContent(m)
}
var p=[];
var e=m.split(AjxStringUtil.SPLIT_RE);
var o,d=[],s={}
,r,y,f=false;
for(var v=0;
v<e.length;
v++){
var c=e[v];
var k=AjxStringUtil.trim(c);
if(!AjxStringUtil._NON_WHITESPACE.test(k)){
d.push(c);
continue
}
if((k.indexOf("| DO NOT REPLY")===0)&&(e[v+2].indexOf("bugzilla")!==-1)){
f=true
}
var a=AjxStringUtil._getLineType(k);
if(a===AjxStringUtil.ORIG_QUOTED){
a=f?AjxStringUtil.ORIG_UNKNOWN:a
}else{
f=false
}
var z=e[v+1];
var r=false;
if(z&&(a===AjxStringUtil.ORIG_UNKNOWN)&&AjxStringUtil.ORIG_INTRO_RE.test(k)&&z.match(/\w+:$/)){
k=[k,z].join(" ");
a=AjxStringUtil._getLineType(k);
r=true
}
if(a===AjxStringUtil.ORIG_LINE){
var w=v+1;
z=e[w];
while(!AjxStringUtil._NON_WHITESPACE.test(z)&&w<e.length){
z=e[++w]
}
var g=z&&AjxStringUtil._getLineType(z);
if(g===AjxStringUtil.ORIG_HEADER){
a=AjxStringUtil.ORIG_HEADER
}else{
a=AjxStringUtil.ORIG_UNKNOWN
}}
if(o){
if(o!==a){
p.push({
type:o,block:d}
);
y=(o===AjxStringUtil.ORIG_UNKNOWN)?d:y;
s[o]=s[o]?s[o]+1:1;
d=[];
o=a
}}else{
o=a
}
if(r&&(a===AjxStringUtil.ORIG_WROTE_WEAK||a===AjxStringUtil.ORIG_WROTE_STRONG)){
d.push(c);
d.push(z);
v++;
r=false
}else{
d.push(c)
}}
if(d.length){
p.push({
type:o,block:d}
);
y=(o===AjxStringUtil.ORIG_UNKNOWN)?d:y;
s[o]=s[o]?s[o]+1:1
}
var n=p[0],q=p[1];
if(n&&n.type===AjxStringUtil.ORIG_UNKNOWN&&q&&(q.type===AjxStringUtil.ORIG_HEADER||q.type===AjxStringUtil.ORIG_WROTE_STRONG)){
var T=AjxStringUtil._getTextFromBlock(n.block);
if(T){
var x=p[2];
if(x&&x.type===AjxStringUtil.ORIG_UNKNOWN){
var t=AjxStringUtil._getTextFromBlock(x.block);
if(t&&t.indexOf(ZmItem.NOTES_SEPARATOR)!==-1){
return T+t
}}
return T
}}
var T=AjxStringUtil._checkInlineWrote(s,p,false);
if(T){
return T
}
if(s[AjxStringUtil.ORIG_UNKNOWN]===1&&s[AjxStringUtil.ORIG_QUOTED]>0){
var T=AjxStringUtil._getTextFromBlock(y);
if(T){
return T
}}
if(s[AjxStringUtil.ORIG_SEP_STRONG]>0){
var h=[];
for(var v=0;
v<p.length;
v++){
var l=p[v];
if(l.type===AjxStringUtil.ORIG_SEP_STRONG){
break
}
h=h.concat(l.block)
}
var T=AjxStringUtil._getTextFromBlock(h);
if(T){
return T
}}
return m
};
AjxStringUtil._getLineType=function(o){
var n=AjxStringUtil.ORIG_UNKNOWN;
for(var a=0;
a<AjxStringUtil.MSG_REGEXES.length;
a++){
var i=AjxStringUtil.MSG_REGEXES[a];
var s=i.regex;
if(s.test(o.toLowerCase())){
if(i.type==AjxStringUtil.ORIG_QUOTED&&/^\s*\|.*\|\s*$/.test(o)){
continue
}
n=i.type;
break
}}
if(n===AjxStringUtil.ORIG_UNKNOWN){
var t=o.match(/(\w+):$/);
var e=t&&t[1]&&t[1].toLowerCase();
if(e){
var r=0;
r=r+(e===AjxMsg.wrote)?5:(e===AjxMsg.changed)?0:2;
if(AjxStringUtil.ORIG_EMAIL_RE.test(o)){
r+=4
}
if(AjxStringUtil.ORIG_DATE_RE.test(o)){
r+=3
}
var h=new RegExp("^(--|"+AjxMsg.on+")","i");
if(AjxStringUtil.ORIG_INTRO_RE.test(o)){
r+=1
}
if(r>=7){
n=AjxStringUtil.ORIG_WROTE_STRONG
}else{
if(r>=5){
n=AjxStringUtil.ORIG_WROTE_WEAK
}}}}
return n
};
AjxStringUtil._getTextFromBlock=function(t){
if(!(t&&t.length)){
return null
}
var e=t.join("\n")+"\n";
e=e.replace(/\s+$/,"\n");
return(AjxStringUtil._NON_WHITESPACE.test(e))?e:null
};
AjxStringUtil.SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;
AjxStringUtil.IGNORE_NODE_LIST=["#comment","br","script","select","style"];
AjxStringUtil.IGNORE_NODE=AjxUtil.arrayAsHash(AjxStringUtil.IGNORE_NODE_LIST);
AjxStringUtil._getOriginalHtmlContent=function(c){
var s=AjxStringUtil._writeToTestIframeDoc(c);
while(AjxStringUtil.SCRIPT_REGEX.test(c)){
c=c.replace(AjxStringUtil.SCRIPT_REGEX,"")
}
var d=false,w=[];
AjxStringUtil._flatten(s,w);
var r=w.length,y,f=[],n={}
,t,m,e,o,a,l;
for(y=0;
y<r;
y++){
t=w[y];
if(t.nodeType===AjxUtil.ELEMENT_NODE){
t.normalize()
}
e=t.nodeName.toLowerCase();
o=AjxStringUtil._checkNode(w[y]);
if(o===AjxStringUtil.ORIG_UNKNOWN&&t.nodeName==="#text"&&(AjxStringUtil.ORIG_DATE_RE.test(t.nodeValue)||AjxStringUtil.ORIG_INTRO_RE.test(t.nodeValue))){
var p=t.nodeValue;
for(var g=1;
g<10;
g++){
var u=w[y+g];
if(u&&u.nodeName==="#text"){
p+=u.nodeValue;
if(/:$/.test(p)){
o=AjxStringUtil._getLineType(AjxStringUtil.trim(p));
if(o===AjxStringUtil.ORIG_WROTE_STRONG){
y=y+g;
break
}}}}}
if(o!==null){
f.push({
type:o,node:t,nodeName:e}
);
n[o]=n[o]?n[o]+1:1;
if(o===AjxStringUtil.ORIG_SEP_STRONG||o===AjxStringUtil.ORIG_WROTE_STRONG){
l=t;
d=true;
break
}
if(o===AjxStringUtil.ORIG_HEADER&&a===AjxStringUtil.ORIG_LINE){
l=m;
d=true;
break
}
m=t;
a=o
}}
if(l){
AjxStringUtil._prune(l,true)
}
var h=d&&s.textContent?"<html>"+s.innerHTML+"</html>":c;
AjxStringUtil._removeTestIframeDoc();
return h
};
AjxStringUtil._flatten=function(a,o){
var n=a&&a.nodeName.toLowerCase();
if(AjxStringUtil.IGNORE_NODE[n]){
return
}
o.push(a);
var t=a.childNodes||[];
for(var e=0;
e<t.length;
e++){
this._flatten(t[e],o)
}};
AjxStringUtil._prune=function(t,e){
var a=t&&t.parentNode;
while(a&&a.lastChild&&a.lastChild!==t){
a.removeChild(a.lastChild)
}
if(e&&a&&a.lastChild===t){
a.removeChild(a.lastChild)
}
var i=a&&a.nodeName.toLowerCase();
if(a&&i!=="body"&&i!=="html"){
AjxStringUtil._prune(a,false)
}};
AjxStringUtil._checkNode=function(t){
if(!t){
return null
}
var o=t.nodeName.toLowerCase();
var e=null;
if(o==="#text"){
var a=AjxStringUtil.trim(t.nodeValue);
if(AjxStringUtil._NON_WHITESPACE.test(a)){
e=AjxStringUtil._getLineType(a)
}}else{
if(o==="hr"){
if(t.id===AjxStringUtil.HTML_SEP_ID||(t.size==="2"&&t.width==="100%"&&t.align==="center")){
e=AjxStringUtil.ORIG_SEP_STRONG
}else{
e=AjxStringUtil.ORIG_LINE
}}else{
if(o==="pre"){
e=AjxStringUtil._checkNodeContent(t)
}else{
if(o==="div"){
if(t.className==="OutlookMessageHeader"||t.className==="gmail_quote"){
e=AjxStringUtil.ORIG_SEP_STRONG
}else{
if(t.style.borderTop){
var i=DwtCssStyle.getComputedStyleObject(t);
if(i&&i.borderTopWidth&&parseInt(i.borderTopWidth)===1&&i.borderTopColor){
e=AjxStringUtil.ORIG_SEP_STRONG
}}}
e=e||AjxStringUtil._checkNodeContent(t)
}else{
if(o==="span"){
e=e||AjxStringUtil._checkNodeContent(t)
}else{
if(o==="img"){
e=AjxStringUtil.ORIG_UNKNOWN
}else{
if(o==="blockquote"){
e=AjxStringUtil.ORIG_QUOTED
}}}}}}}
return e
};
AjxStringUtil._checkNodeContent=function(a){
var t=a.textContent||"";
if(!AjxStringUtil._NON_WHITESPACE.test(t)||t.length>200){
return null
}
var e=AjxStringUtil._getLineType(t);
return(e===AjxStringUtil.ORIG_SEP_STRONG||e===AjxStringUtil.ORIG_WROTE_STRONG)?e:null
};
AjxStringUtil.checkForCleanHtml=function(a,o,n){
var s=AjxStringUtil._writeToTestIframeDoc(a);
var t={
allowedTags:AjxUtil.arrayAsHash(o),untrustedAttrs:n||[]};
AjxStringUtil._traverseCleanHtml(s,t);
var e="<html>"+s.innerHTML+"</html>";
var i=Math.max(s.scrollWidth,s.lastChild.scrollWidth);
AjxStringUtil._removeTestIframeDoc();
return{
html:e,width:i,useIframe:t.fail}
};
AjxStringUtil._traverseCleanHtml=function(o,d){
var t=true;
var m=o.nodeName.toLowerCase();
if(m==="style"&&o.innerHTML==="p { margin: 0; }"){
o.doDelete=true
}else{
if(m==="title"&&!o.innerHTML){}else{
if(d.allowedTags[m]){
if(o.style){
var a=o.style&&o.style.cssText;
a=a.toLowerCase();
if(!AjxStringUtil._checkStyle(a)){
t=false
}
o.style.cssText=AjxStringUtil._fixStyle(a)
}
if(o.removeAttribute&&o.attributes&&o.attributes.length){
for(var s=0;
s<d.untrustedAttrs.length;
s++){
if(o.hasAttribute(d.untrustedAttrs[s])){
t=false
}}
for(var s=0,f=o.attributes,n=f.length;
s<n;
s++){
var c=f.item(s);
if(!c){
continue
}
var u=c.nodeName&&c.nodeName.toLowerCase();
if(u&&u.indexOf("on")===0){
o.removeAttribute(u);
continue
}
var r=c.nodeValue&&String(c.nodeValue);
if(r){
r=r.toLowerCase();
if(m==="table"&&(u==="cellpadding"||u==="cellspacing"||u==="border")&&r!=="0"){
t=false
}}}}}else{
t=false
}}}
for(var s=0,h=o.childNodes.length;
s<h;
s++){
var e=o.childNodes[s];
AjxStringUtil._traverseCleanHtml(e,d)
}
for(var s=o.childNodes.length-1;
s>=0;
s--){
var e=o.childNodes[s];
if(e.doDelete){
o.removeChild(e)
}}
if(!t){
d.fail=true
}};
AjxStringUtil._checkStyle=function(e){
if(e.match(/\bposition\s*:\s*absolute[^;]*;?/)){
return false
}
if(e.match(/\bfont-[^;]*;?/)){
return false
}
return true
};
AjxStringUtil._fixStyle=function(e){
e=e.replace(/\bmargin-?(top|left|right|bottom)?\s*:[^;]*-\d+[^;]*;?/gi,"");
e=e.replace(/\bpadding-?(top|left|right|bottom)?\s*:[^;]*-\d+[^;]*;?/gi,"");
e=e.replace(/\bposition\s*:\s*(absolute|fixed)[^;]*;?/,"");
return e
};
AjxStringUtil._checkInlineWrote=function(r,n){
if(r[AjxStringUtil.ORIG_WROTE_STRONG]>0){
var c,a=false,e={};
for(var s=0;
s<n.length;
s++){
var d=n[s],h=d.type;
if(h===AjxStringUtil.ORIG_WROTE_STRONG){
a=true
}else{
if(h===AjxStringUtil.ORIG_UNKNOWN&&!a){
if(c){
return null
}else{
c=d.block
}}else{
if(a){
e[h]=true
}}}}
var l=(e[AjxStringUtil.ORIG_UNKNOWN]&&e[AjxStringUtil.ORIG_QUOTED]);
var t=(r[AjxStringUtil.ORIG_UNKNOWN]===2&&n[n.length-1].type===AjxStringUtil.ORIG_UNKNOWN);
if(c&&(!l||t)){
var o=AjxStringUtil._getTextFromBlock(c);
if(o){
return o
}}}};
AjxStringUtil.trimHtml=function(i){
if(!i){
return""
}
var a=i;
a=a.replace(AjxStringUtil.DOC_TAG_REGEX,"");
a=a.replace(/<div><br ?\/?><\/div>/gi,"<br>");
var t=0;
while(a.length!==t&&(/^<br ?\/?>/i.test(a)||/<br ?\/?>$/i.test(a))){
t=a.length;
a=a.replace(/^<br ?\/?>/i,"").replace(/<br ?\/?>$/i,"")
}
var e=a&&a.match(/((<br ?\/?>)+)((<\/\w+>)+)$/i);
if(e&&e.length){
var o=new RegExp(e[1]+e[3]+"$","i");
a=a.replace(o,e[3])
}
a=a.replace(/(<div><\/div>)+/gi,"");
return AjxStringUtil.trim(a)
};
AjxStringUtil.DOC_TAG_REGEX=/<\/?(html|head|body)>/gi;
AjxStringUtil.defangHtmlContent=function(n){
var l=AjxStringUtil._writeToTestIframeDoc(n);
var h=l.getElementsByTagName("img");
if(h&&h.length){
var e;
var r;
var a;
for(var o=0;
o<h.length;
o++){
e=h[o];
r=e.getAttribute("dfsrc");
if(r&&(r!=="#")){
e.setAttribute("src",r)
}else{
a=e.getAttribute("pnsrc");
if(a&&(a!=="#")){
e.setAttribute("src",a)
}}
e.removeAttribute("dfsrc")
}}
var s="";
var t=l.childNodes;
for(var o=0;
o<t.length;
o++){
if(t[o].tagName&&(t[o].tagName.toLowerCase()==="body")){
s=t[o].innerHTML;
break
}}
AjxStringUtil._removeTestIframeDoc();
return s
}
}
if(AjxPackage.define("ajax.debug.AjxDebug")){
AjxDebug=function(e){
if(arguments.length==0){
e={}
}else{
if(typeof arguments[0]=="number"){
e={
level:arguments[0],name:arguments[1],showTime:arguments[2]}
}}
this._showTime=e.showTime;
this._target=e.target||AjxDebug.TGT_WINDOW;
this._showTiming=false;
this._startTimePt=this._lastTimePt=0;
this._dbgWindowInited=false;
this._msgQueue=[];
this._isPrevWinOpen=false;
this.setDebugLevel(e.level)
};
AjxDebug.prototype.toString=function(){
return"AjxDebug"
};
AjxDebug.prototype.isAjxDebug=true;
AjxDebug.NONE=0;
AjxDebug.DBG1=1;
AjxDebug.DBG2=2;
AjxDebug.DBG3=3;
AjxDebug.TGT_WINDOW="window";
AjxDebug.TGT_CONSOLE="console";
AjxDebug.BUFFER={};
AjxDebug.BUFFER_MAX={};
AjxDebug.DEFAULT_TYPE="debug";
AjxDebug.RPC="rpc";
AjxDebug.NOTIFY="notify";
AjxDebug.EXCEPTION="exception";
AjxDebug.CALENDAR="calendar";
AjxDebug.REPLY="reply";
AjxDebug.SCROLL="scroll";
AjxDebug.BAD_JSON="bad_json";
AjxDebug.PREFS="prefs";
AjxDebug.PROGRESS="progress";
AjxDebug.REMINDER="reminder";
AjxDebug.OFFLINE="offline";
AjxDebug.TAG_ICON="tagIcon";
AjxDebug.DATA_URI="dataUri";
AjxDebug.MSG_DISPLAY="msgDisplay";
AjxDebug.ZIMLET="zimlet";
AjxDebug.KEYBOARD="kbnav";
AjxDebug.FOCUS="focus";
AjxDebug.FOCUS1="focus1";
AjxDebug.ACCESSIBILITY="a11y";
AjxDebug.DRAFT="draft";
AjxDebug.BUFFER_MAX[AjxDebug.DEFAULT_TYPE]=0;
AjxDebug.BUFFER_MAX[AjxDebug.RPC]=200;
AjxDebug.BUFFER_MAX[AjxDebug.NOTIFY]=400;
AjxDebug.BUFFER_MAX[AjxDebug.EXCEPTION]=100;
AjxDebug.BUFFER_MAX[AjxDebug.CALENDAR]=400;
AjxDebug.BUFFER_MAX[AjxDebug.REPLY]=400;
AjxDebug.BUFFER_MAX[AjxDebug.SCROLL]=100;
AjxDebug.BUFFER_MAX[AjxDebug.BAD_JSON]=200;
AjxDebug.BUFFER_MAX[AjxDebug.PREFS]=200;
AjxDebug.BUFFER_MAX[AjxDebug.REMINDER]=200;
AjxDebug.BUFFER_MAX[AjxDebug.OFFLINE]=400;
AjxDebug.BUFFER_MAX[AjxDebug.TAG_ICON]=200;
AjxDebug.BUFFER_MAX[AjxDebug.PROGRESS]=200;
AjxDebug.BUFFER_MAX[AjxDebug.DATA_URI]=200;
AjxDebug.BUFFER_MAX[AjxDebug.MSG_DISPLAY]=200;
AjxDebug.BUFFER_MAX[AjxDebug.ZIMLET]=200;
AjxDebug.BUFFER_MAX[AjxDebug.KEYBOARD]=null;
AjxDebug.BUFFER_MAX[AjxDebug.FOCUS]=null;
AjxDebug.BUFFER_MAX[AjxDebug.ACCESSIBILITY]=null;
AjxDebug.BUFFER_MAX[AjxDebug.DRAFT]=200;
AjxDebug.MAX_OUT=25000;
AjxDebug._CONTENT_FRAME_ID="AjxDebug_CF";
AjxDebug._LINK_FRAME_ID="AjxDebug_LF";
AjxDebug._BOTTOM_FRAME_ID="AjxDebug_BFI";
AjxDebug._BOTTOM_FRAME_NAME="AjxDebug_BFN";
AjxDebug.prototype.setTitle=function(e){
if(this._document&&!AjxEnv.isIE){
this._document.title=e
}};
AjxDebug.prototype.setDebugLevel=function(e){
this._level=parseInt(e)||e;
this._enable(this._level!=AjxDebug.NONE)
};
AjxDebug.prototype.getDebugLevel=function(){
return this._level
};
AjxDebug.prototype.println=function(n,o,i){
if(!this._isWriteable()){
return
}
try{
var e=this._handleArgs(arguments);
if(!e){
return
}
o=e.args.join("");
var a=(this._target!=AjxDebug.TGT_CONSOLE)?"<br>":"";
this._add({
msg:this._timestamp()+o+a,linkName:e.linkName,level:n}
)
}
catch(t){}};
AjxDebug.prototype.isDisabled=function(){
return !this._enabled
};
AjxDebug.prototype.dumpObj=function(o,a,t,i){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
a=e.args[0];
if(!a){
return
}
t=e.args[1];
this._add({
obj:a,linkName:e.linkName,showFuncs:t,level:o}
)
};
AjxDebug.prototype.printRaw=function(i,a,t){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
this._add({
obj:e.args[0],isRaw:true,linkName:e.linkName,level:i}
)
};
AjxDebug.prototype.printXML=function(i,a,t){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
a=e.args[0];
if(!a){
return
}
if(a.length>AjxDebug.MAX_OUT){
this.printRaw(a);
return
}
this._add({
obj:a,isXml:true,linkName:e.linkName,level:i}
)
};
AjxDebug.prototype.display=function(i,a,t){
if(!this._isWriteable()){
return
}
var e=this._handleArgs(arguments);
if(!e){
return
}
a=e.args[0];
a=a.replace(/\r?\n/g,"[crlf]");
a=a.replace(/ /g,"[space]");
a=a.replace(/\t/g,"[tab]");
this.printRaw(i,a,t)
};
AjxDebug.prototype.showTiming=function(t,o){
this._showTiming=t;
if(t){
this._enable(true)
}
var a=t?"on":"off";
var i="Turning timing info "+a;
if(o){
i=i+": "+o
}
var e=new DebugMessage({
msg:i}
);
this._addMessage(e);
this._startTimePt=this._lastTimePt=new Date().getTime()
};
AjxDebug.prototype.timePt=function(r,a){
if(!this._showTiming||!this._isWriteable()){
return
}
if(a){
this._startTimePt=this._lastTimePt=new Date().getTime()
}
var o=new Date().getTime();
var e=o-this._startTimePt;
var t=o-this._lastTimePt;
this._lastTimePt=o;
var i=a?"<br/>":"";
r=r?" "+r:"";
var s=[i,"[",e," / ",t,"]",r].join("");
var n="<div>"+s+"</div>";
this._addMessage(new DebugMessage({
msg:n}
));
return t
};
AjxDebug.prototype.getContentFrame=function(){
if(this._contentFrame){
return this._contentFrame
}
if(this._debugWindow&&this._debugWindow.document){
return this._debugWindow.document.getElementById(AjxDebug._CONTENT_FRAME_ID)
}
return null
};
AjxDebug.prototype.getLinkFrame=function(e){
if(this._linkFrame){
return this._linkFrame
}
if(this._debugWindow&&this._debugWindow.document){
return this._debugWindow.document.getElementById(AjxDebug._LINK_FRAME_ID)
}
if(!e){
this._openDebugWindow();
return this.getLinkFrame(true)
}
return null
};
AjxDebug.prototype._enable=function(e){
this._enabled=e;
if(this._target==AjxDebug.TGT_WINDOW){
if(e){
if(!this._dbgName){
this._dbgName="AjxDebugWin_"+location.hostname.replace(/\./g,"_")
}
if(this._debugWindow==null||this._debugWindow.closed){
this._openDebugWindow()
}}else{
if(this._debugWindow){
this._debugWindow.close();
this._debugWindow=null
}}}};
AjxDebug.prototype._isWriteable=function(){
if(this.isDisabled()){
return false
}
if(this._target==AjxDebug.TGT_WINDOW){
try{
return(!this._isPaused&&this._debugWindow&&!this._debugWindow.closed)
}
catch(e){
return false
}}
return true
};
AjxDebug.prototype._getHtmlForObject=function(o,n){
n=n||{};
var a=[];
var t=0;
if(o===undefined){
a[t++]="<span>Undefined</span>"
}else{
if(o===null){
a[t++]="<span>NULL</span>"
}else{
if(AjxUtil.isBoolean(o)){
a[t++]="<span>"+o+"</span>"
}else{
if(AjxUtil.isNumber(o)){
a[t++]="<span>"+o+"</span>"
}else{
if(n.isRaw){
a[t++]=this._timestamp();
a[t++]="<textarea rows='25' style='width:100%' readonly='true'>";
a[t++]=o;
a[t++]="</textarea><p></p>"
}else{
if(n.isXml){
var e=new AjxDebugXmlDocument;
var i=e.create();
if(i&&("loadXML" in i)){
i.loadXML(o);
a[t++]="<div style='border-width:2px; border-style:inset; width:100%; height:300px; overflow:auto'>";
a[t++]=this._createXmlTree(i,0,{
authToken:true}
);
a[t++]="</div>"
}else{
a[t++]="<span>Unable to create XmlDocument to show XML</span>"
}}else{
a[t++]="<div style='border-width:2px; border-style:inset; width:100%; height:300px; overflow:auto'><pre>";
a[t++]=this._dump(o,true,n.showFuncs,{
ZmAppCtxt:true,authToken:true}
);
a[t++]="</div></pre>"
}}}}}}
return a.join("")
};
AjxDebug.prototype._dump=function(i,a,e,t){
return AjxStringUtil.prettyPrint(i,a,e,t)
};
AjxDebug.prototype._handleArgs=function(n){
if(this._level==AjxDebug.NONE||this._showTiming||n.length==0){
return
}
var e=new Array(n.length);
for(var a=0;
a<n.length;
a++){
e[a]=n[a]
}
var l={
args:null,linkName:null};
var r=e.length;
if(e.length>1){
var h=e[e.length-1];
if(h&&h.indexOf&&(h.indexOf("DebugWarn")!=-1||((h.indexOf(" ")==-1)&&(/Request|Response$/.test(h))))){
l.linkName=h;
e.pop()
}}
var s=null;
var t=e[0];
var o=(typeof t=="number"||((r>1)&&t.length<=8&&/^[a-z0-9]+$/.test(t)));
if(o){
s=t;
e.shift()
}
if(s&&(AjxDebug.BUFFER_MAX[s]==null)){
if(typeof this._level=="number"){
if(typeof s!="number"||(s>this._level)){
return
}}else{
if(s!=this._level){
return
}}}
l.args=e;
return l
};
AjxDebug.prototype._openDebugWindow=function(i){
var t=AjxEnv.isIE?"_blank":this._dbgName;
this._debugWindow=window.open("",t,"width=600,height=400,resizable=yes,scrollbars=yes");
if(this._debugWindow==null){
this._enabled=false;
return
}
this._enabled=true;
this._isPrevWinOpen=this._debugWindow.debug;
this._debugWindow.debug=true;
try{
this._document=this._debugWindow.document;
this.setTitle("Debug");
if(!this._isPrevWinOpen){
this._document.write("<html>","<head>","<script>","function blank() {return [","'<html><head><style type=\"text/css\">',","'P, TD, DIV, SPAN, SELECT, INPUT, TEXTAREA, BUTTON {',","'font-family: Tahoma, Arial, Helvetica, sans-serif;',","'font-size:11px;}',","'.Content {display:block;margin:0.25em 0em;}',","'.Link {cursor: pointer;color:blue;text-decoration:underline;white-space:nowrap;width:100%;}',","'.DebugWarn {color:red;font-weight:bold;}',","'.Run {color:black; background-color:red;width:100%;font-size:18px;font-weight:bold;}',","'.RunLink {display:block;color:black;background-color:red;font-weight:bold;white-space:nowrap;width:100%;}',","'</style></head><body></body></html>'].join(\"\");}","<\/script>","</head>","<frameset cols='125, *'>","<frameset rows='*,40'>","<frame name='",AjxDebug._LINK_FRAME_ID,"' id='",AjxDebug._LINK_FRAME_ID,"' src='javascript:parent.parent.blank();'>","<frame name='",AjxDebug._BOTTOM_FRAME_NAME,"' id='",AjxDebug._BOTTOM_FRAME_ID,"' src='javascript:parent.parent.blank();' scrolling=no frameborder=0>","</frameset>","<frame name='",AjxDebug._CONTENT_FRAME_ID,"' id='",AjxDebug._CONTENT_FRAME_ID,"' src='javascript:parent.blank();'>","</frameset>","</html>");
this._document.close();
var e=new AjxTimedAction(this,AjxDebug.prototype._finishInitWindow);
AjxTimedAction.scheduleAction(e,2500)
}else{
this._finishInitWindow();
this._contentFrame=this._document.getElementById(AjxDebug._CONTENT_FRAME_ID);
this._linkFrame=this._document.getElementById(AjxDebug._LINK_FRAME_ID);
this._createLinkNContent("RunLink","NEW RUN","Run","NEW RUN");
this._attachHandlers();
this._dbgWindowInited=true;
this._showMessages()
}}
catch(a){
if(this._debugWindow){
this._debugWindow.close()
}
this._openDebugWindow(true)
}};
AjxDebug.prototype._finishInitWindow=function(){
try{
this._contentFrame=this._debugWindow.document.getElementById(AjxDebug._CONTENT_FRAME_ID);
this._linkFrame=this._debugWindow.document.getElementById(AjxDebug._LINK_FRAME_ID);
var n=this._debugWindow.document.getElementById(AjxDebug._BOTTOM_FRAME_ID);
var o=n.contentWindow.document;
var a=[];
var t=0;
a[t++]="<table><tr><td><button id='";
a[t++]=AjxDebug._BOTTOM_FRAME_ID;
a[t++]="_clear'>Clear</button></td><td><button id='";
a[t++]=AjxDebug._BOTTOM_FRAME_ID;
a[t++]="_pause'>Pause</button></td></tr></table>";
if(o.body){
o.body.innerHTML=a.join("")
}}
catch(e){}
if(o){
this._clearBtn=o.getElementById(AjxDebug._BOTTOM_FRAME_ID+"_clear");
this._pauseBtn=o.getElementById(AjxDebug._BOTTOM_FRAME_ID+"_pause")
}
this._attachHandlers();
this._dbgWindowInited=true;
this._showMessages()
};
AjxDebug.prototype._attachHandlers=function(){
var e=AjxCallback.simpleClosure(this._unloadHandler,this);
if(this._debugWindow.attachEvent){
this._unloadHandler=e;
this._debugWindow.attachEvent("onunload",e)
}else{
this._debugWindow.onunload=e
}
if(this._clearBtn){
this._clearBtn.onclick=AjxCallback.simpleClosure(this._clear,this)
}
if(this._pauseBtn){
this._pauseBtn.onclick=AjxCallback.simpleClosure(this._pause,this)
}};
AjxDebug.prototype._scrollToBottom=function(){
var t=this.getContentFrame();
var e=t?t.contentWindow.document.body:null;
var i=this.getLinkFrame();
var a=i?i.contentWindow.document.body:null;
if(e&&a){
e.scrollTop=e.scrollHeight;
a.scrollTop=a.scrollHeight
}};
AjxDebug.prototype._timestamp=function(){
return this._showTime?this._getTimeStamp()+": ":""
};
AjxDebug.prototype.setShowTimestamps=function(e){
this._showTime=e
};
AjxDebug.prototype._createXmlTree=function(o,a,e){
if(o==null){
return""
}
var h="";
var r;
switch(o.nodeType){
case 1:h+="<div style='color: blue; padding-left: 16px;'>&lt;<span style='color: DarkRed;'>"+o.nodeName+"</span>";
if(e&&e[o.nodeName]){
return h+"/&gt;</div>"
}
var l=o.attributes;
r=l.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlAttribute(l[n])
}
if(!o.hasChildNodes()){
return h+"/&gt;</div>"
}
h+="&gt;<br />";
var s=o.childNodes;
r=s.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlTree(s[n],a+3,e)
}
h+="&lt;/<span style='color: DarkRed;'>"+o.nodeName+"</span>&gt;</div>";
break;
case 9:var s=o.childNodes;
r=s.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlTree(s[n],a,e)
}
break;
case 3:if(!/^\s*$/.test(o.nodeValue)){
var t=o.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");
h+="<span style='color: WindowText; padding-left: 16px;'>"+t+"</span><br />"
}
break;
case 7:h+="&lt;?"+o.nodeName;
var l=o.attributes;
r=l.length;
for(var n=0;
n<r;
n++){
h+=this._createXmlAttribute(l[n])
}
h+="?&gt;<br />";
break;
case 4:h="<div style=''>&lt;![CDATA[<span style='color: WindowText; font-family: \"Courier New\"; white-space: pre; display: block; border-left: 1px solid Gray; padding-left: 16px;'>"+o.nodeValue+"</span>]]></div>";
break;
case 8:h="<div style='color: blue; padding-left: 16px;'>&lt;!--<span style='white-space: pre; font-family: \"Courier New\"; color: Gray; display: block;'>"+o.nodeValue+"</span>--></div>";
break;
case 10:h="<div style='color: blue; padding-left: 16px'>&lt;!DOCTYPE "+o.name;
if(o.publicId){
h+=' PUBLIC "'+o.publicId+'"';
if(o.systemId){
h+=' "'+o.systemId+'"'
}}else{
if(o.systemId){
h+=' SYSTEM "'+o.systemId+'"'
}}
h+="&gt;</div>";
break;
default:this._inspect(o)
}
return h
};
AjxDebug.prototype._createXmlAttribute=function(e){
return[" <span style='color: red'>",e.nodeName,"</span><span style='color: blue'>=\"",e.nodeValue,'"</span>'].join("")
};
AjxDebug.prototype._inspect=function(t){
var a="";
for(var e in t){
a+="obj."+e+" = "+t[e]+"\n"
}
window.alert(a)
};
AjxDebug.prototype._add=function(e){
e.extraHtml=e.obj&&this._getHtmlForObject(e.obj,e);
this._addMessage(new DebugMessage(e))
};
AjxDebug.prototype._addMessage=function(e){
this._msgQueue.push(e);
this._showMessages()
};
AjxDebug.prototype._showMessages=function(){
switch(this._target){
case AjxDebug.TGT_WINDOW:this._showMessagesInWindow();
break;
case AjxDebug.TGT_CONSOLE:this._showMessagesInConsole()
}
this._addMessagesToBuffer();
this._msgQueue=[]
};
AjxDebug.prototype._showMessagesInWindow=function(){
if(!this._dbgWindowInited){
return
}
try{
if(this._msgQueue.length>0){
var e=this.getContentFrame();
var o=this.getLinkFrame();
if(!e||!o){
return
}
var c=e.contentWindow.document;
var r=o.contentWindow.document;
var t=new Date();
for(var n=0,s=this._msgQueue.length;
n<s;
++n){
var a=this._msgQueue[n];
var d=a.linkName;
var l=[a.message,a.extraHtml].join("");
this._createLinkNContent("Link",d,"Content",l,t)
}}
this._scrollToBottom()
}
catch(h){}};
AjxDebug.prototype._addMessagesToBuffer=function(){
var a=(this._target==AjxDebug.TGT_CONSOLE)?"<br>":"";
for(var t=0,e=this._msgQueue.length;
t<e;
++t){
var o=this._msgQueue[t];
AjxDebug._addMessageToBuffer(o.type,o.message+o.extraHtml+a)
}};
AjxDebug._addMessageToBuffer=function(a,i){
a=a||AjxDebug.DEFAULT_TYPE;
var e=AjxDebug.BUFFER_MAX[a];
if(e>0){
var t=AjxDebug.BUFFER[a]=AjxDebug.BUFFER[a]||[];
while(t.length>=e){
t.shift()
}
t.push(i)
}};
AjxDebug.prototype._showMessagesInConsole=function(){
if(!window.console){
return
}
var t=new Date();
for(var a=0,e=this._msgQueue.length;
a<e;
++a){
var o=this._msgQueue[a];
if(window.console&&window.console.log){
window.console.log(AjxStringUtil.stripTags(o.message+o.extraHtml))
}}};
AjxDebug.prototype._getTimeStamp=function(e){
if(!AjxDebug._timestampFormatter){
AjxDebug._timestampFormatter=new AjxDateFormat("HH:mm:ss.SSS")
}
e=e||new Date();
return AjxStringUtil.htmlEncode(AjxDebug._timestampFormatter.format(e),true)
};
AjxDebug.prototype._createLinkNContent=function(s,u,i,h,a){
var o=this.getLinkFrame();
if(!o){
return
}
a=a||new Date();
var n=["[",this._getTimeStamp(a),"]"].join("");
var t="Lnk_"+a.getTime();
if(u){
var r=o.contentWindow.document;
var d=r.createElement("DIV");
d.className=s;
d.innerHTML=[u,n].join(" - ");
d._targetId=t;
d._dbg=this;
d.onclick=AjxDebug._linkClicked;
var c=r.body;
c.appendChild(d)
}
var l=this.getContentFrame().contentWindow.document;
var e=l.createElement("DIV");
e.className=i;
e.id=t;
e.innerHTML=h;
l.body.appendChild(e);
this._scrollToBottom()
};
AjxDebug._linkClicked=function(){
var t=this._dbg.getContentFrame();
var e=t.contentWindow.document.getElementById(this._targetId);
var a=0;
while(e){
a+=e.offsetTop;
e=e.offsetParent
}
t.contentWindow.scrollTo(0,a)
};
AjxDebug.prototype._clear=function(){
this.getContentFrame().contentWindow.document.body.innerHTML="";
this.getLinkFrame().contentWindow.document.body.innerHTML=""
};
AjxDebug.prototype._pause=function(){
this._isPaused=!this._isPaused;
this._pauseBtn.innerHTML=this._isPaused?"Resume":"Pause"
};
AjxDebug.prototype._unloadHandler=function(){
if(!this._debugWindow){
return
}
if(this._debugWindow.detachEvent){
this._debugWindow.detachEvent("onunload",this._unloadHandler)
}else{
this._debugWindow.onunload=null
}};
AjxDebug.println=function(e,t){
AjxDebug._addMessageToBuffer(e,t+"<br>")
};
AjxDebug.dumpObj=function(e,t){
AjxDebug._addMessageToBuffer(e,"<pre>"+AjxStringUtil.prettyPrint(t,true)+"</pre>")
};
AjxDebug.logSoapMessage=function(o){
if(o.methodNameStr=="NoOpRequest"||o.methodNameStr=="NoOpResponse"){
return
}
var t=AjxDebug._getTimeStamp();
var i=["<b>",o.methodNameStr,o.asyncMode?"":" (SYNCHRONOUS)"," - ",t,"</b>"].join("");
for(var e in AjxDebug.BUFFER){
if(e==AjxDebug.DEFAULT_TYPE){
continue
}
AjxDebug.println(e,i)
}
if(window.DBG){
var a=o.methodNameStr;
if(!o.asyncMode){
a="<span class='DebugWarn'>SYNCHRONOUS </span>"+a
}
window.DBG.println(window.DBG._level,i,a)
}};
AjxDebug._getTimeStamp=function(e){
return AjxDebug.prototype._getTimeStamp.apply(null,arguments)
};
AjxDebug.getDebugLog=function(t){
t=t||AjxDebug.DEFAULT_TYPE;
var e=AjxDebug.BUFFER[t];
return e?e.join(""):""
};
DebugMessage=function(e){
e=e||{};
this.message=e.msg||"";
this.type=e.type||null;
this.category=e.category||"";
this.time=e.time||(new Date().getTime());
this.extraHtml=e.extraHtml||"";
this.linkName=e.linkName;
this.type=(e.level&&typeof(e.level)=="string")?e.level:AjxDebug.DEFAULT_TYPE
}
}
if(AjxPackage.define("ajax.debug.AjxDebugXmlDocument")){
AjxDebugXmlDocument=function(){};
getDomDocumentPrefix=function(){
if(getDomDocumentPrefix.prefix){
return getDomDocumentPrefix.prefix
}
var n=["MSXML2","Microsoft","MSXML","MSXML3"];
var s;
var e=n.length;
for(var a=0;
a<e;
a++){
try{
s=new ActiveXObject(n[a]+".DomDocument");
return getDomDocumentPrefix.prefix=n[a]
}
catch(t){}}
throw new Error("Could not find an installed XML parser")
};
AjxDebugXmlDocument.prototype.create=function(){
try{
if(document.implementation&&document.implementation.createDocument){
var t=document.implementation.createDocument("","",null);
if(t.readyState==null){
t.readyState=1;
t.addEventListener("load",function(){
t.readyState=4;
if(typeof t.onreadystatechange=="function"){
t.onreadystatechange()
}}
,false)
}
return t
}
if(window.ActiveXObject){
return new ActiveXObject(getDomDocumentPrefix()+".DomDocument")
}}
catch(e){}
throw new Error("Your browser does not support XmlDocument objects")
};
if(window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__){
if(AjxEnv.isSafari){
Document.prototype.loadXML=function(a){
var o=(new DOMParser()).parseFromString(a,"text/xml");
while(this.hasChildNodes()){
this.removeChild(this.lastChild)
}
var e=o.childNodes.length;
for(var t=0;
t<e;
t++){
this.appendChild(this.importNode(o.childNodes[t],true))
}};
Document.prototype.__defineGetter__("xml",function(){
return(new XMLSerializer()).serializeToString(this)
}
)
}else{
AjxDebugXmlDocument.prototype.loadXML=function(a){
var o=(new DOMParser()).parseFromString(a,"text/xml");
while(this.hasChildNodes()){
this.removeChild(this.lastChild)
}
var e=o.childNodes.length;
for(var t=0;
t<e;
t++){
this.appendChild(this.importNode(o.childNodes[t],true))
}};
AjxDebugXmlDocument.prototype.__defineGetter__("xml",function(){
return(new XMLSerializer()).serializeToString(this)
}
)
}}}
if(AjxPackage.define("ajax.xml.AjxXmlDoc")){
AjxXmlDoc=function(){
if(!AjxXmlDoc._inited){
AjxXmlDoc._init()
}};
AjxXmlDoc.prototype.isAjxXmlDoc=true;
AjxXmlDoc.prototype.toString=function(){
return"AjxXmlDoc"
};
AjxXmlDoc.INVALID_CHARS_RE=/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/g;
AjxXmlDoc.REC_AVOID_CHARS_RE=/[\u007F-\u0084\u0086-\u009F\uFDD0-\uFDDF]/g;
AjxXmlDoc._inited=false;
AjxXmlDoc._msxmlVers=null;
AjxXmlDoc._useDOM=Boolean(document.implementation&&document.implementation.createDocument);
AjxXmlDoc._useActiveX=!AjxXmlDoc._useDOM&&Boolean(window.ActiveXObject);
AjxXmlDoc.create=function(){
var t=new AjxXmlDoc();
var e=null;
if(AjxXmlDoc._useActiveX){
e=new ActiveXObject(AjxXmlDoc._msxmlVers);
e.async=true;
if(AjxXmlDoc._msxmlVers=="MSXML2.DOMDocument.4.0"){
e.setProperty("SelectionLanguage","XPath");
e.setProperty("SelectionNamespaces","xmlns:zimbra='urn:zimbra' xmlns:mail='urn:zimbraMail' xmlns:account='urn:zimbraAccount'")
}}else{
if(AjxXmlDoc._useDOM){
e=document.implementation.createDocument("","",null)
}else{
throw new AjxException("Unable to create new Doc",AjxException.INTERNAL_ERROR,"AjxXmlDoc.create")
}}
t._doc=e;
return t
};
AjxXmlDoc.createFromDom=function(t){
var e=new AjxXmlDoc();
e._doc=t;
return e
};
AjxXmlDoc.createFromXml=function(e){
var t=AjxXmlDoc.create();
t.loadFromString(e);
return t
};
AjxXmlDoc.replaceInvalidChars=function(e){
AjxXmlDoc.INVALID_CHARS_RE.lastIndex=0;
return e.replace(AjxXmlDoc.INVALID_CHARS_RE,"?")
};
AjxXmlDoc.getXml=function(a){
if(!a){
return""
}
var t=a.xml;
if(!t){
var e=new XMLSerializer();
t=e.serializeToString(a)
}
return AjxXmlDoc.replaceInvalidChars(t)
};
AjxXmlDoc.prototype.getDoc=function(){
return this._doc
};
AjxXmlDoc.prototype.loadFromString=function(t){
var e=this._doc;
e.loadXML(t);
if(AjxXmlDoc._useActiveX){
if(e.parseError.errorCode!=0){
throw new AjxException(e.parseError.reason,AjxException.INVALID_PARAM,"AjxXmlDoc.loadFromString")
}}};
AjxXmlDoc.prototype.loadFromUrl=function(e){
if(AjxEnv.isChrome||AjxEnv.isSafari){
var t=new window.XMLHttpRequest();
t.open("GET",e,false);
t.send(null);
var a=t.responseXML;
this._doc=a
}else{
this._doc.load(e)
}};
AjxXmlDoc.prototype.toJSObject=function(a,t,e){
_node=function(){
this.__msh_content=""
};
_node.prototype.toString=function(){
return this.__msh_content
};
rec=function(l,c){
var r={}
,h,d;
for(l=l.firstChild;
l;
l=l.nextSibling){
if(l.nodeType==1){
h=l.tagName;
if(a){
h=h.replace(/^.*?:/,"")
}
if(t){
h=h.toLowerCase()
}
d=new _node();
if(r[h]){
if(r[h]==1){
c[h]=[c[h]];
r[h]=2
}
c[h].push(d)
}else{
c[h]=d;
r[h]=1
}
if(e){
if(l.attributes&&l.attributes.length){
for(var s=0;
s<l.attributes.length;
s++){
attr=l.attributes[s];
d[attr.name]=AjxUtil.isNumeric(attr.value)?attr.value:String(attr.value)
}}}
rec(l,d)
}else{
if(l.nodeType==3){
c.__msh_content+=l.nodeValue
}}}};
var i=new _node();
rec(this._doc.documentElement,i);
return i
};
AjxXmlDoc.prototype.getElementsByTagNameNS=function(t,e){
var a=this.getDoc();
return !a.getElementsByTagNameNS?a.getElementsByTagName(t+":"+e):a.getElementsByTagNameNS(t,e)
};
AjxXmlDoc.prototype.getFirstElementByTagNameNS=function(t,e){
return this.getElementsByTagNameNS(t,e)[0]
};
AjxXmlDoc.prototype.getElementsByTagName=function(e){
var t=this.getDoc();
return t.getElementsByTagName(e)
};
AjxXmlDoc._init=function(){
if(AjxXmlDoc._useActiveX){
var e=["MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XmlDom"];
for(var a=0;
a<e.length;
a++){
try{
new ActiveXObject(e[a]);
AjxXmlDoc._msxmlVers=e[a];
break
}
catch(t){}}
if(!AjxXmlDoc._msxmlVers){
throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxXmlDoc._init")
}}else{
if(!Document.prototype.loadXML){
Document.prototype.loadXML=function(l){
var h=new DOMParser();
var n=h.parseFromString(l,"text/xml");
while(this.hasChildNodes()){
this.removeChild(this.lastChild)
}
var o=n.childNodes.length;
for(var s=0;
s<o;
s++){
var r=this.importNode(n.childNodes[s],true);
this.appendChild(r)
}};
if(AjxEnv.isNav){
_NodeGetXml=function(){
var i=new XMLSerializer();
return i.serializeToString(this)
};
Node.prototype.__defineGetter__("xml",_NodeGetXml)
}}}
AjxXmlDoc._inited=true
};
AjxXmlDoc.prototype.set=function(e,i,t){
var o=this._doc.createElement(e);
if(i!=null){
var a=this._doc.createTextNode("");
o.appendChild(a);
a.nodeValue=i
}
if(t==null){
this.root.appendChild(o)
}else{
t.appendChild(o)
}
return o
};
AjxXmlDoc.prototype.getXml=function(){
return AjxXmlDoc.getXml(this.getDoc())
};
AjxXmlDoc.prototype.getDocXml=AjxXmlDoc.prototype.getXml;
AjxXmlDoc.createRoot=function(a){
var e=AjxXmlDoc.create();
var t=e.getDoc();
e.root=t.createElement(a);
t.appendChild(e.root);
return e
};
AjxXmlDoc.createElement=function(t,i){
var e=AjxXmlDoc.create();
var o=e.getDoc();
e.root=o.createElement(t);
if(i!=null){
var a=o.createTextNode("");
e.root.appendChild(a);
a.nodeValue=i
}
o.appendChild(e.root);
return e
};
AjxXmlDoc.prototype.appendChild=function(e){
if(this._doc!=e._doc&&(AjxEnv.isChrome||AjxEnv.isSafari)){
this.root.appendChild(this.getDoc().importNode(e.root,true))
}else{
this.root.appendChild(e.root)
}}
}
if(AjxPackage.define("ajax.xml.AjxSerializer")){
AjxSerializer=function(){
if(arguments.length==0){
return
}};
AjxSerializer.prototype.serialize=function(e){
throw"NOT IMPLEMENTED"
};
AjxJsonSerializer=function(e){
AjxSerializer.call(this,null);
this._minimize=Boolean(e)
};
AjxJsonSerializer.prototype=new AjxSerializer;
AjxJsonSerializer.prototype.constructor=AjxJsonSerializer;
AjxJsonSerializer.E_ATTRS="_attrs";
AjxJsonSerializer.A_CONTENT="_content";
AjxJsonSerializer.A_NAMESPACE="_jsns";
AjxJsonSerializer.prototype.serialize=function(r){
var t={};
var f=0;
var d=null;
for(var o=r.firstChild;
o;
o=o.nextSibling){
var u=o.nodeType;
if(u==1){
var e=o.nodeName;
if(!t[e]){
t[e]=[];
f++
}
t[e].push(o);
continue
}
if(u==3||u==4){
if(!d){
d=[]
}
d.push(o.nodeValue);
continue
}}
var g={};
var s=0;
if(r.attributes){
for(var l=0;
l<r.attributes.length;
l++){
var c=r.attributes[l];
var e=c.nodeName;
var p=this.quote(c.nodeValue);
if(t[e]){
g[e]=p;
s++
}else{
t[e]=p;
f++
}}}
d=d&&d.join("");
if(d&&d.match(/^\s*$/)){
d=null
}
if(d){
d=this.quote(d);
if(s==0&&f==0){
return d
}}
if(d==null&&f==0&&s==0){
return"{}"
}
var m=["{"];
if(d){
m.push(this.quote(AjxJsonSerializer.A_CONTENT),":",d);
if(s>0||f>0){
m.push(",")
}}
if(s>0){
m.push(this.quote(AjxJsonSerializer.E_ATTRS),": { ");
var l=0;
for(var e in g){
if(l>0){
m.push(",")
}
m.push(this.quote(e),":",g[e]);
l++
}
m.push("}");
if(f>0){
m.push(", ")
}}
var h=0;
for(var e in t){
if(h>0){
m.push(",")
}
var n=t[e];
if(typeof n=="string"){
m.push(this.quote(e),":",n);
h++;
continue
}
m.push(this.quote(e),":");
if(!this._minimize||n.length>1){
m.push("[")
}
for(var l=0;
l<n.length;
l++){
if(l>0){
m.push(",")
}
m.push(this.serialize(n[l]))
}
if(!this._minimize||n.length>1){
m.push("]")
}
h++
}
m.push("}");
return m.join("")
};
AjxJsonSerializer.prototype.quote=function(e){
return['"',this.escape(e),'"'].join("")
};
AjxJsonSerializer.prototype.escape=function(e){
return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n")
}
}
if(AjxPackage.define("ajax.core.AjxImg")){
AjxImg=function(){};
AjxImg.prototype=new Object;
AjxImg.prototype.constructor=null;
AjxImg._VIEWPORT_ID="AjxImg_VP";
AjxImg.DISABLED=true;
AjxImg.RE_COLOR=/^(.*?),color=(.*)$/;
AjxImg.setImage=function(h,u,f,r,a,g){
if(!h){
return
}
a=a||[];
var d=u;
var o,t=u&&u.match(AjxImg.RE_COLOR);
if(t){
u=t&&t[1];
o=t&&t[2]
}
var c=AjxImg.getClassForImage(u,r);
if(f){
a.push(c);
h.className=a.join(" ");
return
}
var e=h.firstChild&&h.firstChild.id;
var p=c+"Overlay";
var l=c+"Mask";
if(o&&window.AjxImgData&&AjxImgData[p]&&AjxImgData[l]){
o=(o.match(/^\d$/)?ZmOrganizer.COLOR_VALUES[o]:o)||ZmOrganizer.COLOR_VALUES[ZmOrganizer.ORG_DEFAULT_COLOR];
h.innerHTML=AjxImg.getImageHtml({
imageName:d,attrStr:e?"id='"+e+"'":null,altText:g,disabled:r}
);
return
}
if(h.firstChild==null||h.firstChild.nodeName.toLowerCase()!="div"){
var s=[],n=0;
s[n++]="<div ";
if(e){
s[n++]=" id='";
s[n++]=e;
s[n++]="' "
}
if(c){
a.push(c)
}
s[n++]=AjxUtil.getClassAttr(a);
s[n++]=">";
if(g){
s[n++]="<div class='ScreenReaderOnly'>";
s[n++]=AjxStringUtil.htmlEncode(g);
s[n++]="</div>"
}
s[n++]="</div>";
h.innerHTML=s.join("");
return
}else{
if(AjxEnv.isIE&&!AjxEnv.isIE9up){
h.firstChild.innerHTML=""
}}
if(c){
a.push(c)
}
h.firstChild.className=a.join(" ")
};
AjxImg.setDisabledImage=function(a,i,e,t){
return AjxImg.setImage(a,i,e,true,t)
};
AjxImg.getClassForImage=function(a,t){
var e=a?"Img"+a:"";
if(t){
e+=" ZDisabledImage"
}
return e
};
AjxImg.getImageClass=function(e){
return e.firstChild?e.firstChild.className:e.className
};
AjxImg.getImageElement=function(e){
return e.firstChild?e.firstChild:e
};
AjxImg.getParentElement=function(e){
return e.parentNode
};
AjxImg.GET_IMAGE_HTML_PARAMS=["imageName","styles","attrStr","wrapInTable","disabled","classes","altText"];
AjxImg.getImageHtml=function(){
var D=Dwt.getParams(arguments,AjxImg.GET_IMAGE_HTML_PARAMS);
var O=D.imageName;
var r=D.styles||"";
var d=r?" style='"+r+"'":"";
var f=D.attrStr?" "+D.attrStr:"";
var o=D.disabled;
var C=D.classes||[];
var n=D.altText;
var y=D.wrapInTable?"<table style='display:inline' cellpadding=0 cellspacing=0 border=0><tr><td align=center valign=bottom>":"";
var l="";
var z=D.wrapInTable?"</td></tr></table>":"";
if(O){
var q,v=O.match(AjxImg.RE_COLOR);
if(v){
O=v&&v[1];
q=v&&v[2]
}
var a=AjxImg.getClassForImage(O,o);
var B=a+"Overlay";
var u=a+"Mask";
if(q&&window.AjxImgData&&AjxImgData[B]&&AjxImgData[u]){
q=(q.match(/^\d$/)?ZmOrganizer.COLOR_VALUES[q]:q)||ZmOrganizer.COLOR_VALUES[ZmOrganizer.ORG_DEFAULT_COLOR];
var A=AjxImgData[B],j=AjxImgData[u];
if(n){
f+=" alt='"+AjxStringUtil.encodeQuotes(n)+"'"
}
if(AjxEnv.isIE&&!AjxEnv.isIE9up){
var g=["width:",A.w,"px;","height:",A.h,"px;"].join("");
var e=["top:",j.t,";","left:",j.l,";"].join("");
var W=["clip:rect(",(-1*j.t)-1,"px,",A.w-1,"px,",(j.t*-1)+A.h-1,"px,",A.l,"px);"].join("");
var h="filter:mask(color="+q+");";
l=["<div class='IEImage' style='display:inline-block;zoom:1;position:relative;overflow:hidden;",g,r,"' ",f,">","<div class='IEImageMask' style='position:absolute;top:0px;left:0px;",g,"'>","<img src='",j.ief,"?v=",window.cacheKillerVersion,"' border=0 style='position:absolute;",e,h,"'>","</div>","<div class='IEImageOverlay ",B,"' style='",g,"position:absolute;top:0;left:0;'></div>","</div>"].join("")
}else{
if(!A[q]){
var w=A.w,p=A.h;
var i=document.createElement("CANVAS");
i.width=w;
i.height=p;
var k=i.getContext("2d");
k.save();
k.clearRect(0,0,w,p);
k.save();
var x=f;
if(!x){
x=Dwt.getNextId("CANVAS_IMG_");
f=" id='"+x+"'"
}else{
var s=f.match(/id=[\"\']([^\"\']+)[\"\']+/);
if(s&&s.length>1){
x=s[1]
}
AjxDebug.println(AjxDebug.TAG_ICON,"imgId = "+x)
}
var t=document.getElementById(u);
var T=document.getElementById(B);
if(!t.complete||!T.complete){
AjxDebug.println(AjxDebug.TAG_ICON,"mask status = "+t.complete+" for "+x);
AjxDebug.println(AjxDebug.TAG_ICON,"overlay status = "+T.complete+" for "+x);
var c=new Image();
c.onload=function(){
AjxDebug.println(AjxDebug.TAG_ICON,"mask image loaded");
var m=new Image();
m.onload=function(){
AjxImg._drawCanvasImage(k,c,m,j,A,q,w,p);
AjxDebug.println(AjxDebug.TAG_ICON,"overlay image loaded");
var S=document.getElementById(x);
if(S){
AjxDebug.println(AjxDebug.TAG_ICON,"element found for id = "+x);
S.src=i.toDataURL();
A[q]=i.toDataURL()
}else{
AjxDebug.println(AjxDebug.TAG_ICON,"no element found for id = "+x)
}};
m.src=document.getElementById(B).src
};
c.src=document.getElementById(u).src
}else{
AjxImg._drawCanvasImage(k,t,T,j,A,q,w,p);
A[q]=i.toDataURL()
}}
l=["<img src='",A[q],"'"," border=0 ",AjxUtil.getClassAttr(C),d,f,">"].join("")
}}else{
C.push("Img"+O);
l=["<div ",AjxUtil.getClassAttr(C),d,f,">"];
if(n){
l.push("<span class='ScreenReaderOnly'>",AjxStringUtil.htmlEncode(n),"</span>")
}
l.push("</div>");
l=l.join("")
}}else{
l=["<div",d,f,">"];
if(n){
l.push("<span class='ScreenReaderOnly'>",AjxStringUtil.htmlEncode(n),"</span>")
}
l.push("</div>");
l=l.join("")
}
return y||z?[y,l,z].join(""):l
};
AjxImg.getImageSpanHtml=function(o,n,t,a,e){
e=e||"inlineIcon";
var i=["<span style='white-space:nowrap'>","<span class='",e,"'>",AjxImg.getImageHtml(o,n,t),(a||""),"</span>","</span>"];
return i.join("")
};
AjxImg._drawCanvasImage=function(a,s,r,t,o,i,n,e){
a.drawImage(s,t.l,t.t);
a.globalCompositeOperation="source-out";
a.fillStyle=i;
a.fillRect(0,0,n,e);
a.restore();
a.drawImage(r,o.l,o.t);
a.restore()
}
}
if(AjxPackage.define("ajax.core.AjxColor")){
AjxColor=function(a,t,e){
if(arguments.length==0){
return
}
this.r=a;
this.g=t;
this.b=e
};
AjxColor.prototype.toString=function(){
return AjxColor.color(this.r,this.g,this.b)
};
AjxColor.components=function(t){
var e=AjxColor.__RE.exec(t);
return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null
};
AjxColor.color=function(a,t,e){
return["#",AjxColor.__pad(Number(Math.round(a)).toString(16),2),AjxColor.__pad(Number(Math.round(t)).toString(16),2),AjxColor.__pad(Number(Math.round(e)).toString(16),2)].join("")
};
AjxColor.lighten=function(e,a){
var t=AjxColor.components(e);
return t?AjxColor.color(AjxColor.__lighten(t[0],a),AjxColor.__lighten(t[1],a),AjxColor.__lighten(t[2],a)):""
};
AjxColor.darken=function(e,a){
var t=AjxColor.components(e);
return t?AjxColor.color(AjxColor.__darken(t[0],a),AjxColor.__darken(t[1],a),AjxColor.__darken(t[2],a)):""
};
AjxColor.deepen=function(e,a){
var s=AjxColor.components(e);
var t=0;
for(var o=1;
o<s.length;
o++){
if(s[o]>s[t]){
t=o
}}
for(var o=0;
o<s.length;
o++){
var n=s[t]?(s[o]/s[t]):1;
s[o]=Math.floor(s[o]*n*(a||1))
}
return AjxColor.color(s[0],s[1],s[2])
};
AjxColor.__RE=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i;
AjxColor.__pad=function(n,a,o){
if(!o){
o="0"
}
var t=String(n);
for(var e=t.length;
e<a;
e++){
t=o+t
}
return t
};
AjxColor.__lighten=function(e,t){
return Math.max(0,Math.min(255,e+(255-e)*t))
};
AjxColor.__darken=function(e,t){
return Math.max(0,Math.min(255,e+(1-e)*t))
}
}
if(AjxPackage.define("ajax.events.AjxEvent")){
AjxEvent=function(){
this.data=null
};
AjxEvent.HISTORY="HISTORY";
AjxEvent.prototype.toString=function(){
return"AjxEvent"
}
}
if(AjxPackage.define("ajax.events.AjxEventMgr")){
AjxEventMgr=function(){
this._listeners=new Object()
};
AjxEventMgr.prototype.toString=function(){
return"AjxEventMgr"
};
AjxEventMgr.prototype.addListener=function(t,a,e){
var i=this._listeners[t];
if(i==null){
i=this._listeners[t]=new AjxVector()
}
if(!i.contains(a)){
if(this._notifyingListeners){
i=this._listeners[t]=i.clone()
}
i.add(a,e);
return true
}
return false
};
AjxEventMgr.prototype.notifyListeners=function(o,r){
this._notifyingListeners=true;
var l=this._listeners[o];
if(l!=null){
var e=l.getArray();
var n=l.size();
var h=null;
var d=null;
for(var t=0;
t<n;
t++){
d=e[t];
if(!(d&&((d instanceof AjxListener)||(typeof d=="function")))){
continue
}
h=d.handleEvent?d.handleEvent(r):d(r);
if(h===false){
break
}}}
this._notifyingListeners=false;
return h
};
AjxEventMgr.prototype.isListenerRegistered=function(e){
var t=this._listeners[e];
return(t!=null&&t.size()>0)
};
AjxEventMgr.prototype.removeListener=function(e,t){
var a=this._listeners[e];
if(a!=null){
if(this._notifyingListeners){
a=this._listeners[e]=a.clone()
}
a.remove(t);
return true
}
return false
};
AjxEventMgr.prototype.removeAll=function(e){
var t=this._listeners[e];
if(t!=null){
if(this._notifyingListeners){
t=this._listeners[e]=t.clone()
}
t.removeAll();
return true
}
return false
};
AjxEventMgr.prototype.clearAllEvents=function(){
var t=this._listeners;
for(var e in t){
this.removeAll(e)
}}
}
if(AjxPackage.define("ajax.util.AjxTimedAction")){
AjxTimedAction=function(a,t,e){
AjxCallback.call(this,a,t,e);
this._tid=-1;
this._id=-1;
this._runResult=null
};
AjxTimedAction.prototype=new AjxCallback();
AjxTimedAction.prototype.constructor=AjxTimedAction;
AjxTimedAction.MAX_TIMEOUT=20*24*60*60*1000;
AjxTimedAction.prototype.toString=function(){
return"AjxTimedAction"
};
AjxTimedAction.prototype.getRunResult=function(){
return this._runResult
};
AjxTimedAction._pendingActions={};
AjxTimedAction._nextActionId=1;
AjxTimedAction.scheduleAction=function(a,t){
if(!a){
return
}
if(a._tid&&a._tid!=-1){
AjxTimedAction.cancelAction(a._id)
}
t=t||0;
if(t>AjxTimedAction.MAX_TIMEOUT){
if(window.DBG){}
t=AjxTimedAction.MAX_TIMEOUT
}
var i=a._id=AjxTimedAction._nextActionId++;
AjxTimedAction._pendingActions[i]=a;
var e="AjxTimedAction._exec("+i+")";
a._tid=window.setTimeout(e,t);
return a._id
};
AjxTimedAction.cancelAction=function(t){
var e=AjxTimedAction._pendingActions[t];
if(e){
window.clearTimeout(e._tid);
delete AjxTimedAction._pendingActions[t];
delete e._tid
}};
AjxTimedAction._exec=function(a){
try{
var t=AjxTimedAction._pendingActions[a];
if(t){
delete AjxTimedAction._pendingActions[a];
delete t._tid;
t._runResult=t.run()
}}
catch(e){
AjxException.reportScriptError(e)
}}
}
if(AjxPackage.define("ajax.net.AjxInclude")){
AjxInclude=function(i,n,o,a){
var t=document.getElementsByTagName("head")[0];
function e(s){
if(AjxEnv.isIE&&s&&!/loaded|complete/.test(s.readyState)){
return
}
if(s){
s[AjxInclude.eventName]=null
}
window.status="";
if(i.length>0){
var r=i.shift();
var l=typeof r=="string"?r:r.src;
var d=l;
if(!/^((https?|ftps?):\x2f\x2f|\x2f)/.test(l)){
if(n){
l=n+l
}
if(cacheKillerVersion){
l+="?v="+cacheKillerVersion
}}else{
if(a&&l.indexOf("/")!=0){
l=a+AjxStringUtil.urlEncode(l)
}}
var s=document.createElement("script");
var h=AjxCallback.simpleClosure(e,null,s);
if(s.attachEvent){
s.attachEvent("onreadystatechange",h);
s.attachEvent("onerror",h)
}else{
if(s.addEventListener){
s.addEventListener("load",h,true);
s.addEventListener("error",h,true)
}}
s.type="text/javascript";
s.src=l;
window.status="Loading script: "+d;
var c=null;
if(r.id){
s.id=r.id;
c=document.getElementById(r.id)
}
if(c){
c.parentNode.replaceChild(s,c)
}else{
t.appendChild(s)
}}else{
if(i.length==0){
s=null;
t=null;
if(o){
o.run()
}}}}
e(null)
}
}
if(AjxPackage.define("ajax.events.AjxListener")){
AjxListener=function(t,a,e){
AjxCallback.call(this,t,a,e)
};
AjxListener.prototype=new AjxCallback();
AjxListener.prototype.constructor=AjxListener;
AjxListener.prototype.isAjxListener=true;
AjxListener.prototype.toString=function(){
return"AjxListener"
};
AjxListener.prototype.handleEvent=function(e){
return this.run(e)
}
}
if(AjxPackage.define("ajax.util.AjxText")){
AjxFormat=function(e){
if(arguments.length==0){
return
}
this._pattern=e;
this._segments=[]
};
AjxFormat.prototype.toString=function(){
var t=[];
t.push('pattern="',this._pattern,'"');
if(this._segments.length>0){
t.push(", segments={ ");
for(var e=0;
e<this._segments.length;
e++){
if(e>0){
t.push(", ")
}
t.push(String(this._segments[e]))
}
t.push(" }")
}
return t.join("")
};
AjxFormat.initialize=function(){
AjxDateFormat.initialize();
AjxNumberFormat.initialize()
};
AjxFormat.prototype.format=function(e){
var a=[];
for(var t=0;
t<this._segments.length;
t++){
a.push(this._segments[t].format(e))
}
return a.join("")
};
AjxFormat.prototype.parse=function(o){
var t=this._createParseObject();
var e=0;
for(var a=0;
a<this._segments.length;
a++){
var n=this._segments[a];
e=n.parse(t,o,e)
}
if(e<o.length){
throw new AjxFormat.ParsingException(this,null,"input too long")
}
return t
};
AjxFormat.prototype.getSegments=function(){
return this._segments
};
AjxFormat.prototype.toPattern=function(){
return this._pattern
};
AjxFormat.prototype.clone=function(){
return new this.constructor(this._pattern)
};
AjxFormat.prototype._createParseObject=function(e){
throw new AjxFormat.ParsingException(this,null,"not implemented")
};
AjxFormat._zeroPad=function(n,r,t,h){
n=typeof n=="string"?n:String(n);
if(n.length>=r){
return n
}
t=t||"0";
var e=[];
for(var o=n.length;
o<r;
o++){
e.push(t)
}
e[h?"unshift":"push"](n);
return e.join("")
};
AjxFormat.FormatException=function(t,e){
this._format=t;
this._message=e
};
AjxFormat.FormatException.prototype.toString=function(){
return this._message
};
AjxFormat.FormattingException=function(a,t,e){
AjxFormat.FormatException.call(this,a,e);
this._segment=t
};
AjxFormat.FormattingException.prototype=new AjxFormat.FormatException;
AjxFormat.FormattingException.prototype.constructor=AjxFormat.FormattingException;
AjxFormat.ParsingException=function(a,t,e){
AjxFormat.FormatException.call(this,a,e);
this._segment=t
};
AjxFormat.ParsingException.prototype=new AjxFormat.FormatException;
AjxFormat.ParsingException.prototype.constructor=AjxFormat.ParsingException;
AjxFormat.Segment=function(t,e){
if(arguments.length==0){
return
}
this._parent=t;
this._s=e
};
AjxFormat.Segment.prototype.toString=function(){
return'segment: "'+this._s+'"'
};
AjxFormat.Segment.prototype.format=function(e){
return this._s
};
AjxFormat.Segment.prototype.parse=function(a,t,e){
throw new AjxFormat.ParsingException(this._parent,this,"not implemented")
};
AjxFormat.Segment.prototype.getFormat=function(){
return this._parent
};
AjxFormat.Segment.prototype.toSubPattern=function(){
return this._s
};
AjxFormat.Segment.prototype._getFixedLength=function(){
var e;
if(this._index+1<this._parent._segments.length){
var t=this._parent._segments[this._index+1];
if(!(t instanceof AjxFormat.TextSegment)){
e=this._s.length
}}
return e
};
AjxFormat.Segment._parseLiteral=function(o,a,e){
if(a.length-e<o.length){
throw new AjxFormat.ParsingException(this._parent,this,"input too short")
}
for(var t=0;
t<o.length;
t++){
if(o.charAt(t)!=a.charAt(e+t)){
throw new AjxFormat.ParsingException(this._parent,this,"input doesn't match")
}}
return e+o.length
};
AjxFormat.Segment._parseLiterals=function(a,h,u,t,p,l){
for(var r=0;
r<t.length;
r++){
try{
var m=t[r];
var n=AjxFormat.Segment._parseLiteral(m,p,l);
if(h){
var d=a||window;
if(typeof h=="function"){
h.call(d,r+u)
}else{
d[h]=r+u
}}
return n
}
catch(c){}}
return -1
};
AjxFormat.Segment._parseInt=function(t,n,p,g,r,e,u){
var h=e||g.length-r;
var d=r;
for(var a=0;
a<h;
a++){
if(!g.charAt(r++).match(/\d/)){
r--;
break
}}
var c=r;
if(d==c){
throw new AjxFormat.ParsingException(this._parent,this,"number not present")
}
if(e&&c-d!=e){
throw new AjxFormat.ParsingException(this._parent,this,"number too short")
}
var m=parseInt(g.substring(d,c),u||10);
if(n){
var l=t||window;
if(typeof n=="function"){
n.call(l,m+p)
}else{
l[n]=m+p
}}
return c
};
AjxDateFormat=function(s){
if(arguments.length==0){
return
}
AjxFormat.call(this,s);
if(s==null){
return
}
if(typeof s=="number"){
switch(s){
case AjxDateFormat.SHORT:s=I18nMsg.formatDateShort;
break;
case AjxDateFormat.MEDIUM:s=I18nMsg.formatDateMedium;
break;
case AjxDateFormat.LONG:s=I18nMsg.formatDateLong;
break;
case AjxDateFormat.FULL:s=I18nMsg.formatDateFull;
break;
case AjxDateFormat.NUMBER:s=I18nMsg.formatDateNumber;
break
}}
for(var a=0;
a<s.length;
a++){
var h=s.charAt(a);
if(h=="'"){
var t=a+1;
for(a++;
a<s.length;
a++){
var h=s.charAt(a);
if(h=="'"){
if(a+1<s.length&&s.charAt(a+1)=="'"){
s=s.substr(0,a)+s.substr(a+1)
}else{
break
}}}
var e=a;
var n=new AjxFormat.TextSegment(this,s.substring(t,e));
this._segments.push(n);
continue
}
var t=a;
while(a<s.length){
h=s.charAt(a);
if(AjxDateFormat._META_CHARS.indexOf(h)!=-1||h=="'"){
break
}
a++
}
var e=a;
if(t!=e){
var n=new AjxFormat.TextSegment(this,s.substring(t,e));
this._segments.push(n);
a--;
continue
}
var t=a;
while(++a<s.length){
if(s.charAt(a)!=h){
break
}}
var e=a--;
var o=e-t;
var r=s.substr(t,o);
var n=null;
switch(h){
case"G":n=new AjxDateFormat.EraSegment(this,r);
break;
case"y":n=new AjxDateFormat.YearSegment(this,r);
break;
case"M":n=new AjxDateFormat.MonthSegment(this,r);
break;
case"w":n=new AjxDateFormat.WeekSegment(this,r);
break;
case"W":n=new AjxDateFormat.WeekSegment(this,r);
break;
case"D":n=new AjxDateFormat.DaySegment(this,r);
break;
case"d":n=new AjxDateFormat.DaySegment(this,r);
break;
case"F":n=new AjxDateFormat.WeekdaySegment(this,r);
break;
case"E":n=new AjxDateFormat.WeekdaySegment(this,r);
break;
case"a":n=new AjxDateFormat.AmPmSegment(this,r);
break;
case"H":n=new AjxDateFormat.HourSegment(this,r);
break;
case"k":n=new AjxDateFormat.HourSegment(this,r);
break;
case"K":n=new AjxDateFormat.HourSegment(this,r);
break;
case"h":n=new AjxDateFormat.HourSegment(this,r);
break;
case"m":n=new AjxDateFormat.MinuteSegment(this,r);
break;
case"s":n=new AjxDateFormat.SecondSegment(this,r);
break;
case"S":n=new AjxDateFormat.SecondSegment(this,r);
break;
case"z":n=new AjxDateFormat.TimezoneSegment(this,r);
break;
case"Z":n=new AjxDateFormat.TimezoneSegment(this,r);
break
}
if(n!=null){
n._index=this._segments.length;
this._segments.push(n)
}}};
AjxDateFormat.prototype=new AjxFormat;
AjxDateFormat.prototype.constructor=AjxDateFormat;
AjxDateFormat.prototype.toString=function(){
return"[AjxDateFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxDateFormat.SHORT=0;
AjxDateFormat.MEDIUM=1;
AjxDateFormat.LONG=2;
AjxDateFormat.FULL=3;
AjxDateFormat.DEFAULT=AjxDateFormat.MEDIUM;
AjxDateFormat._META_CHARS="GyMwWDdFEaHkKhmsSzZ";
AjxDateFormat.NUMBER=4;
AjxDateFormat.getDateInstance=function(e){
e=e!=null?e:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._DATE_FORMATTERS[e]){
AjxDateFormat._DATE_FORMATTERS[e]=new AjxDateFormat(AjxDateFormat._dateFormats[e])
}
return AjxDateFormat._DATE_FORMATTERS[e]
};
AjxDateFormat.getTimeInstance=function(e){
e=e!=null?e:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._TIME_FORMATTERS[e]){
AjxDateFormat._TIME_FORMATTERS[e]=new AjxDateFormat(AjxDateFormat._timeFormats[e])
}
return AjxDateFormat._TIME_FORMATTERS[e]
};
AjxDateFormat.getDateTimeInstance=function(e,t){
e=e!=null?e:AjxDateFormat.DEFAULT;
t=t!=null?t:AjxDateFormat.DEFAULT;
var i=e*10+t;
if(!AjxDateFormat._DATETIME_FORMATTERS[i]){
var o=I18nMsg.formatDateTime;
var n=[AjxDateFormat._dateFormats[e],AjxDateFormat._timeFormats[t]];
var a=AjxMessageFormat.format(o,n);
AjxDateFormat._DATETIME_FORMATTERS[i]=new AjxDateFormat(a)
}
return AjxDateFormat._DATETIME_FORMATTERS[i]
};
AjxDateFormat.format=function(t,e){
return new AjxDateFormat(t).format(e)
};
AjxDateFormat.parse=function(t,e){
return new AjxDateFormat(t).parse(e)
};
AjxDateFormat.initialize=function(){
AjxDateFormat._dateFormats=[I18nMsg.formatDateShort,I18nMsg.formatDateMedium,I18nMsg.formatDateLong,I18nMsg.formatDateFull,I18nMsg.formatDateNumber];
AjxDateFormat._timeFormats=[I18nMsg.formatTimeShort,I18nMsg.formatTimeMedium,I18nMsg.formatTimeLong,I18nMsg.formatTimeFull];
AjxDateFormat._timeParsers=[];
for(var t=1,e;
e=I18nMsg["parseTime"+t];
t++){
AjxDateFormat._timeParsers.push(new RegExp(e,"i"))
}
AjxDateFormat._DATE_FORMATTERS={};
AjxDateFormat._TIME_FORMATTERS={};
AjxDateFormat._DATETIME_FORMATTERS={};
AjxDateFormat.MonthSegment.initialize();
AjxDateFormat.WeekdaySegment.initialize()
};
AjxDateFormat.parseTime=function(r){
for(var s=0;
s<AjxDateFormat._timeParsers.length;
s++){
var e=AjxDateFormat._timeParsers[s].exec(r);
if(e){
var a=parseInt(e[1],10)||0;
var n=parseInt(e[2],10)||0;
var o=e[3];
if(o){
var t=I18nMsg.parseTimePMChars;
if(a==12){
a=0
}
if(t.indexOf(o)!=-1){
a+=12
}}
if(a<24&&n<60){
date=new Date();
date.setHours(a);
date.setMinutes(n);
date.setSeconds(0);
return date
}}}};
AjxDateFormat.prototype.parse=function(o){
var i=null;
try{
i=AjxFormat.prototype.parse.call(this,o);
var a=new Date(0,0,2,0,0,0,0);
if(i.year!=null){
a.setFullYear(i.year)
}
if(i.month!=null){
a.setMonth(i.month)
}
a.setDate(1);
if(i.dayofmonth!=null){
a.setDate(i.dayofmonth)
}else{
if(i.dayofyear!=null){
a.setMonth(0,i.dayofyear)
}}
if(i.hours!=null){
a.setHours(i.hours)
}
if(i.minutes!=null){
a.setMinutes(i.minutes)
}
if(i.seconds!=null){
a.setSeconds(i.seconds)
}
if(i.milliseconds!=null){
a.setMilliseconds(i.milliseconds)
}
if(i.ampm!=null){
var t=a.getHours();
if(t==12&&i.ampm==0){
t=0
}else{
if(t!=12&&i.ampm==1){
t+=12
}}
a.setHours(t)
}
if(i.timezone!=null){
a.setMinutes(a.getMinutes()-i.timezone)
}
if(isNaN(a.getTime())){
return null
}
i=a
}
catch(n){}
return i
};
AjxDateFormat.prototype._createParseObject=function(){
return{
year:null,month:null,dayofmonth:null,dayofyear:null,hours:null,minutes:null,seconds:null,milliseconds:null,ampm:null,era:null,timezone:null}
};
AjxFormat.TextSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxFormat.TextSegment.prototype=new AjxFormat.Segment;
AjxFormat.TextSegment.prototype.constructor=AjxFormat.TextSegment;
AjxFormat.TextSegment.prototype.toString=function(){
return'text: "'+this._s+'"'
};
AjxFormat.TextSegment.prototype.parse=function(a,t,e){
return AjxFormat.Segment._parseLiteral(this._s,t,e)
};
AjxDateFormat.DateSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.DateSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.DateSegment.prototype.constructor=AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.EraSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment.prototype.constructor=AjxDateFormat.EraSegment;
AjxDateFormat.EraSegment.prototype.toString=function(){
return'dateEra: "'+this._s+'"'
};
AjxDateFormat.EraSegment.prototype.format=function(e){
return I18nMsg.eraAD
};
AjxDateFormat.YearSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.YearSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.YearSegment.prototype.constructor=AjxDateFormat.YearSegment;
AjxDateFormat.YearSegment.prototype.toString=function(){
return'dateYear: "'+this._s+'"'
};
AjxDateFormat.YearSegment.prototype.format=function(e){
var t=String(e.getFullYear());
return this._s.length<4?t.substr(t.length-2):AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.YearSegment.prototype.parse=function(a,l,o){
var e=this._getFixedLength();
var t=AjxFormat.Segment._parseInt(a,"year",0,l,o,e);
if(t-o==2){
if(!AjxDateFormat._2digitStartYear){
AjxDateFormat._2digitStartYear=parseInt(AjxMsg.dateParsing2DigitStartYear)
}
var r=AjxDateFormat._2digitStartYear;
var h=parseInt(l.substr(o,2),10);
var i=(Math.floor(r/100)+(h<(r%100)?1:0))*100;
var n=i+h;
a.year=n
}
return t
};
AjxDateFormat.MonthSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.MonthSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.MonthSegment.prototype.constructor=AjxDateFormat.MonthSegment;
AjxDateFormat.MonthSegment.prototype.toString=function(){
return'dateMonth: "'+this._s+'"'
};
AjxDateFormat.MonthSegment.initialize=function(){
AjxDateFormat.MonthSegment.MONTHS={};
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT]=[AjxMsg.monthJanShort,AjxMsg.monthFebShort,AjxMsg.monthMarShort,AjxMsg.monthAprShort,AjxMsg.monthMayShort,AjxMsg.monthJunShort,AjxMsg.monthJulShort,AjxMsg.monthAugShort,AjxMsg.monthSepShort,AjxMsg.monthOctShort,AjxMsg.monthNovShort,AjxMsg.monthDecShort];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM]=[I18nMsg.monthJanMedium,I18nMsg.monthFebMedium,I18nMsg.monthMarMedium,I18nMsg.monthAprMedium,I18nMsg.monthMayMedium,I18nMsg.monthJunMedium,I18nMsg.monthJulMedium,I18nMsg.monthAugMedium,I18nMsg.monthSepMedium,I18nMsg.monthOctMedium,I18nMsg.monthNovMedium,I18nMsg.monthDecMedium];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG]=[I18nMsg.monthJanLong,I18nMsg.monthFebLong,I18nMsg.monthMarLong,I18nMsg.monthAprLong,I18nMsg.monthMayLong,I18nMsg.monthJunLong,I18nMsg.monthJulLong,I18nMsg.monthAugLong,I18nMsg.monthSepLong,I18nMsg.monthOctLong,I18nMsg.monthNovLong,I18nMsg.monthDecLong]
};
AjxDateFormat.MonthSegment.prototype.format=function(e){
var t=e.getMonth();
switch(this._s.length){
case 1:return String(t+1);
case 2:return AjxFormat._zeroPad(t+1,2);
case 3:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM][t];
case 5:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT][t]
}
return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG][t]
};
AjxDateFormat.MonthSegment.prototype.parse=function(a,o,t){
var e;
switch(this._s.length){
case 3:e=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM];
case 4:e=e||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG];
case 5:e=e||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT];
var i=AjxFormat.Segment._parseLiterals(a,"month",0,e,o,t);
if(i==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
return i
}
var n=this._getFixedLength();
return AjxFormat.Segment._parseInt(a,"month",-1,o,t,n)
};
AjxDateFormat.WeekSegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.WeekSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekSegment.prototype.constructor=AjxDateFormat.WeekSegment;
AjxDateFormat.WeekSegment.prototype.toString=function(){
return'weekMonth: "'+this._s+'"'
};
AjxDateFormat.WeekSegment.prototype.format=function(t){
var i=t.getYear();
var n=t.getMonth();
var e=t.getDate();
var s=/w/.test(this._s);
var o=new Date(i,s?0:n,1);
var a=0;
while(true){
a++;
if(o.getMonth()>n||(o.getMonth()==n&&o.getDate()>=e)){
break
}
o.setDate(o.getDate()+7)
}
return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.WeekSegment.prototype.parse=function(t,a,e){
var i=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,a,e,i)
};
AjxDateFormat.DaySegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.DaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.DaySegment.prototype.constructor=AjxDateFormat.DaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){
return'dateDay: "'+this._s+'"'
};
AjxDateFormat.DaySegment.prototype.format=function(t){
var o=t.getMonth();
var e=t.getDate();
if(/D/.test(this._s)&&o>0){
var a=t.getYear();
do{
var i=new Date(a,o,1);
i.setDate(0);
e+=i.getDate();
o--
}
while(o>0)
}
return AjxFormat._zeroPad(e,this._s.length)
};
AjxDateFormat.DaySegment.prototype.parse=function(t,o,e){
var n=this._getFixedLength();
var i=function(s){
if(s>AjxDateUtil.MAX_DAYS_PER_MONTH){
throw new AjxFormat.ParsingException(this._parent,this,"number too long")
}else{
t.dayofmonth=s
}};
var a=/D/.test(this._s)?"dayofyear":i;
return AjxFormat.Segment._parseInt(t,a,0,o,e,n)
};
AjxDateFormat.WeekdaySegment=function(t,e){
if(arguments.length==0){
return
}
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.WeekdaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekdaySegment.prototype.constructor=AjxDateFormat.WeekdaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){
return'dateDay: "'+this._s+'"'
};
AjxDateFormat.WeekdaySegment.initialize=function(){
AjxDateFormat.WeekdaySegment.WEEKDAYS={};
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT]=[AjxMsg.weekdaySunShort,AjxMsg.weekdayMonShort,AjxMsg.weekdayTueShort,AjxMsg.weekdayWedShort,AjxMsg.weekdayThuShort,AjxMsg.weekdayFriShort,AjxMsg.weekdaySatShort];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM]=[I18nMsg.weekdaySunMedium,I18nMsg.weekdayMonMedium,I18nMsg.weekdayTueMedium,I18nMsg.weekdayWedMedium,I18nMsg.weekdayThuMedium,I18nMsg.weekdayFriMedium,I18nMsg.weekdaySatMedium];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG]=[I18nMsg.weekdaySunLong,I18nMsg.weekdayMonLong,I18nMsg.weekdayTueLong,I18nMsg.weekdayWedLong,I18nMsg.weekdayThuLong,I18nMsg.weekdayFriLong,I18nMsg.weekdaySatLong]
};
AjxDateFormat.WeekdaySegment.prototype.format=function(e){
var a=e.getDay();
if(/E/.test(this._s)){
var t;
switch(this._s.length){
case 4:t=AjxDateFormat.LONG;
break;
case 5:t=AjxDateFormat.SHORT;
break;
default:t=AjxDateFormat.MEDIUM
}
return AjxDateFormat.WeekdaySegment.WEEKDAYS[t][a]
}
return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.WeekdaySegment.prototype.parse=function(a,o,t){
var e;
switch(this._s.length){
case 3:e=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM];
case 4:e=e||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG];
case 5:e=e||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT];
var i=AjxFormat.Segment._parseLiterals(null,null,0,e,o,t);
if(i==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
return i
}
var n=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,o,t,n)
};
AjxDateFormat.TimeSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.TimeSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.TimeSegment.prototype.constructor=AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.HourSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment.prototype.constructor=AjxDateFormat.HourSegment;
AjxDateFormat.HourSegment.prototype.toString=function(){
return'timeHour: "'+this._s+'"'
};
AjxDateFormat.HourSegment.prototype.format=function(t){
var e=t.getHours();
if(e>12&&/[hK]/.test(this._s)){
e-=12
}else{
if(e==0&&/[h]/.test(this._s)){
e=12
}else{
if(e===12&&/K/.test(this._s)){
e=0
}else{
if(e===0&&/k/.test(this._s)){
e=24
}}}}
return AjxFormat._zeroPad(e,this._s.length)
};
AjxDateFormat.HourSegment.prototype.parse=function(t,a,e){
var i=this._getFixedLength();
return AjxFormat.Segment._parseInt(t,"hours",0,a,e,i)
};
AjxDateFormat.MinuteSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.MinuteSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.MinuteSegment.prototype.constructor=AjxDateFormat.MinuteSegment;
AjxDateFormat.MinuteSegment.prototype.toString=function(){
return'timeMinute: "'+this._s+'"'
};
AjxDateFormat.MinuteSegment.prototype.format=function(e){
var t=e.getMinutes();
return AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.MinuteSegment.prototype.parse=function(t,a,e){
var i=this._getFixedLength();
return AjxFormat.Segment._parseInt(t,"minutes",0,a,e,i)
};
AjxDateFormat.SecondSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.SecondSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.SecondSegment.prototype.constructor=AjxDateFormat.SecondSegment;
AjxDateFormat.SecondSegment.prototype.toString=function(){
return'timeSecond: "'+this._s+'"'
};
AjxDateFormat.SecondSegment.prototype.format=function(e){
var t=/s/.test(this._s)?e.getSeconds():e.getMilliseconds();
return AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.SecondSegment.prototype.parse=function(a,o,t){
var e=/s/.test(this._s);
var i=e?"seconds":"milliseconds";
var n=e?this._getFixedLength():0;
return AjxFormat.Segment._parseInt(a,i,0,o,t,n)
};
AjxDateFormat.AmPmSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.AmPmSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.AmPmSegment.prototype.constructor=AjxDateFormat.AmPmSegment;
AjxDateFormat.AmPmSegment.prototype.toString=function(){
return'timeAmPm: "'+this._s+'"'
};
AjxDateFormat.AmPmSegment.prototype.format=function(t){
var e=t.getHours();
return e<12?I18nMsg.periodAm:I18nMsg.periodPm
};
AjxDateFormat.AmPmSegment.prototype.parse=function(t,i,e){
var o=[I18nMsg.periodAm.toLowerCase(),I18nMsg.periodPm.toLowerCase(),I18nMsg.periodAm.toUpperCase(),I18nMsg.periodPm.toUpperCase()];
var a=AjxFormat.Segment._parseLiterals(t,"ampm",0,o,i,e);
if(a==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
t.ampm=t.ampm%2;
return a
};
AjxDateFormat.TimezoneSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.TimezoneSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.TimezoneSegment.prototype.constructor=AjxDateFormat.TimezoneSegment;
AjxDateFormat.TimezoneSegment.prototype.toString=function(){
return'timeTimezone: "'+this._s+'"'
};
AjxDateFormat.TimezoneSegment.prototype.format=function(t){
var e=t.timezone||AjxTimezone.DEFAULT;
if(/Z/.test(this._s)){
return AjxTimezone.getShortName(e)
}
return this._s.length<4?AjxTimezone.getMediumName(e):AjxTimezone.getLongName(e)
};
AjxMessageFormat=function(s){
if(arguments.length==0){
return
}
AjxFormat.call(this,s);
if(s==null){
return
}
for(var t=0;
t<s.length;
t++){
var r=s.charAt(t);
if(r=="'"){
if(t+1<s.length&&s.charAt(t+1)=="'"){
var a=new AjxFormat.TextSegment(this,"'");
this._segments.push(a);
t++;
continue
}
var h=t+1;
for(t++;
t<s.length;
t++){
var r=s.charAt(t);
if(r=="'"){
if(t+1<s.length&&s.charAt(t+1)=="'"){
s=s.substr(0,t)+s.substr(t+1)
}else{
break
}}}
var n=t;
var a=new AjxFormat.TextSegment(this,s.substring(h,n));
this._segments.push(a);
continue
}
var h=t;
while(t<s.length){
r=s.charAt(t);
if(r=="{"||r=="'"){
break
}
t++
}
var n=t;
if(h!=n){
var a=new AjxFormat.TextSegment(this,s.substring(h,n));
this._segments.push(a);
t--;
continue
}
var h=t+1;
var e=0;
while(++t<s.length){
var r=s.charAt(t);
if(r=="{"){
e++
}else{
if(r=="}"){
if(e==0){
break
}
e--
}}}
var n=t;
var o=n-h;
var l=s.substr(h,o);
var a=new AjxMessageFormat.MessageSegment(this,l);
if(a!=null){
this._segments.push(a)
}}};
AjxMessageFormat.prototype=new AjxFormat;
AjxMessageFormat.prototype.constructor=AjxMessageFormat;
AjxMessageFormat.prototype.toString=function(){
return"[AjxMessageFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxMessageFormat.format=function(e,t){
return new AjxMessageFormat(e).format(t)
};
AjxMessageFormat.prototype.format=function(e){
if(!(e instanceof Array)){
e=[e]
}
return AjxFormat.prototype.format.call(this,e)
};
AjxMessageFormat.prototype.getFormats=function(){
var e=[];
for(var t=0;
t<this._segments.length;
t++){
var a=this._segments[t];
if(a instanceof AjxMessageFormat.MessageSegment){
e.push(a.getSegmentFormat())
}}
return e
};
AjxMessageFormat.prototype.getFormatsByArgumentIndex=function(){
var e=[];
for(var t=0;
t<this._segments.length;
t++){
var a=this._segments[t];
if(a instanceof AjxMessageFormat.MessageSegment){
e[a.getIndex()]=a.getSegmentFormat()
}}
return e
};
AjxMessageFormat.MessageSegment=function(i,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,i,e);
var a=AjxMessageFormat.MessageSegment._split(e,",");
this._index=Number(a[0]);
this._type=a[1]||"string";
this._style=a[2];
if(this._type=="list"){
this._isList=true;
this._type=a[2]||"string";
this._style=a[3]
}
switch(this._type){
case"number":switch(this._style){
case"integer":this._formatter=AjxNumberFormat.getIntegerInstance();
break;
case"currency":this._formatter=AjxNumberFormat.getCurrencyInstance();
break;
case"percent":this._formatter=AjxNumberFormat.getPercentInstance();
break;
default:this._formatter=this._style==null?AjxNumberFormat.getInstance():new AjxNumberFormat(this._style)
}
break;
case"date":case"time":var t=this._type=="date"?AjxDateFormat.getDateInstance:AjxDateFormat.getTimeInstance;
switch(this._style){
case"short":this._formatter=t(AjxDateFormat.SHORT);
break;
case"medium":this._formatter=t(AjxDateFormat.MEDIUM);
break;
case"long":this._formatter=t(AjxDateFormat.LONG);
break;
case"full":this._formatter=t(AjxDateFormat.FULL);
break;
default:this._formatter=this._style==null?t(AjxDateFormat.DEFAULT):new AjxDateFormat(this._style)
}
break;
case"choice":this._formatter=new AjxChoiceFormat(this._style);
break
}
if(this._isList){
this._formatter=new AjxListFormat(this._formatter)
}};
AjxMessageFormat.MessageSegment.prototype=new AjxFormat.Segment;
AjxMessageFormat.MessageSegment.prototype.constructor=AjxMessageFormat.MessageSegment;
AjxMessageFormat.MessageSegment.prototype.toString=function(){
var e=['message: "',this._s,'", index: ',this._index];
if(this._isList){
e.push(", list: ",this._isList)
}
if(this._type){
e.push(", type: ",this._type)
}
if(this._style){
e.push(", style: ",this._style)
}
if(this._formatter){
e.push(", formatter: ",this._formatter.toString())
}
return e.join("")
};
AjxMessageFormat.MessageSegment.prototype._isList=false;
AjxMessageFormat.MessageSegment.prototype.format=function(t){
var e=t[this._index];
if(this._formatter instanceof AjxChoiceFormat){
return this._formatter.format(t,this._index)
}
return this._formatter?this._formatter.format(e):String(e)
};
AjxMessageFormat.MessageSegment.prototype.getIndex=function(){
return this._index
};
AjxMessageFormat.MessageSegment.prototype.getType=function(){
return this._type
};
AjxMessageFormat.MessageSegment.prototype.getStyle=function(){
return this._style
};
AjxMessageFormat.MessageSegment.prototype.getSegmentFormat=function(){
return this._formatter
};
AjxMessageFormat.MessageSegment._split=function(i,e){
var o=[];
var a=0;
var t;
var n=0;
for(t=0;
t<i.length;
t++){
var r=i.charAt(t);
if(r=="{"){
n++
}else{
if(r=="}"){
n--
}else{
if(r==e&&n==0){
o.push(i.substring(a,t));
a=t+1
}}}}
if(t>a){
o.push(i.substring(a,t))
}
return o
};
AjxNumberFormat=function(g,y){
if(arguments.length==0){
return
}
AjxFormat.call(this,g);
if(!g){
return
}
var a=g.split(/;/);
var g=a[0];
var f=0;
var u=this.__parseStatic(g,f);
f=u.offset;
var s=u.text!="";
if(s){
this._segments.push(new AjxFormat.TextSegment(this,u.text))
}
var r=f;
while(f<g.length&&AjxNumberFormat._META_CHARS.indexOf(g.charAt(f))!=-1){
f++
}
var n=f;
var t=g.substring(r,n);
var w=t.indexOf("E");
var c=w!=-1?t.substring(w+1):null;
if(c){
t=t.substring(0,w);
this._showExponent=true
}
var d=t.indexOf(I18nMsg.numberSeparatorDecimal!=""?I18nMsg.numberSeparatorDecimal:".");
var v=d!=-1?t.substring(0,d):t;
if(v){
var k=v.lastIndexOf(I18nMsg.numberSeparatorGrouping!=""?I18nMsg.numberSeparatorGrouping:",");
if(k!=-1){
this._groupingOffset=v.length-k-1
}
v=v.replace(/[^#0]/g,"");
var l=v.indexOf("0");
if(l!=-1){
this._minIntDigits=v.length-l
}
this._maxIntDigits=v.length
}
var p=d!=-1?t.substring(d+1):null;
if(p){
var l=p.lastIndexOf("0");
if(l!=-1){
this._minFracDigits=l+1
}
this._maxFracDigits=p.replace(/[^#0]/g,"").length
}
this._segments.push(new AjxNumberFormat.NumberSegment(this,t));
var u=this.__parseStatic(g,f);
f=u.offset;
if(u.text!=""){
this._segments.push(new AjxFormat.TextSegment(this,u.text))
}
if(y){
return
}
if(a.length>1){
var g=a[1];
this._negativeFormatter=new AjxNumberFormat(g,true)
}else{
var m=new AjxNumberFormat("");
m._segments=m._segments.concat(this._segments);
var h=s?1:0;
var o=new AjxFormat.TextSegment(m,I18nMsg.numberSignMinus);
m._segments.splice(h,0,o);
this._negativeFormatter=m
}};
AjxNumberFormat.prototype=new AjxFormat;
AjxNumberFormat.prototype.constructor=AjxNumberFormat;
AjxNumberFormat.prototype.toString=function(){
var e=["[AjxNumberFormat: ","formatter=",AjxFormat.prototype.toString.call(this)];
if(this._negativeFormatter){
e.push(", negativeFormatter=",this._negativeFormatter.toString())
}
e.push("]");
return e.join("")
};
AjxNumberFormat._NUMBER="number";
AjxNumberFormat._INTEGER="integer";
AjxNumberFormat._CURRENCY="currency";
AjxNumberFormat._PERCENT="percent";
AjxNumberFormat._META_CHARS="0#.,E";
AjxNumberFormat.prototype._groupingOffset=Number.MAX_VALUE;
AjxNumberFormat.prototype._minIntDigits=1;
AjxNumberFormat.prototype._isCurrency=false;
AjxNumberFormat.prototype._isPercent=false;
AjxNumberFormat.prototype._isPerMille=false;
AjxNumberFormat.prototype._showExponent=false;
AjxNumberFormat.getInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]=new AjxNumberFormat(I18nMsg.formatNumber)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]
};
AjxNumberFormat.getNumberInstance=AjxNumberFormat.getInstance;
AjxNumberFormat.getCurrencyInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]=new AjxNumberFormat(I18nMsg.formatNumberCurrency)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]
};
AjxNumberFormat.getIntegerInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]=new AjxNumberFormat(I18nMsg.formatNumberInteger)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]
};
AjxNumberFormat.getPercentInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]=new AjxNumberFormat(I18nMsg.formatNumberPercent)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]
};
AjxNumberFormat.format=function(t,e){
return new AjxNumberFormat(t).format(e)
};
AjxNumberFormat.initialize=function(){
AjxNumberFormat._FORMATTERS={}
};
AjxNumberFormat.prototype.format=function(e){
if(e<0&&this._negativeFormatter){
return this._negativeFormatter.format(e)
}
return AjxFormat.prototype.format.call(this,e)
};
AjxNumberFormat.prototype.__parseStatic=function(a,t){
var o=[];
while(t<a.length){
var r=a.charAt(t++);
if(AjxNumberFormat._META_CHARS.indexOf(r)!=-1){
t--;
break
}
switch(r){
case"'":var n=t;
while(t<a.length&&a.charAt(t++)!="'"){}
var e=t;
r=e-n==0?"'":a.substring(n,e);
break;
case"%":r=I18nMsg.numberSignPercent;
this._isPercent=true;
break;
case"\u2030":r=I18nMsg.numberSignPerMill;
this._isPerMille=true;
break;
case"\u00a4":r=a.charAt(t)=="\u00a4"?I18nMsg.currencyCode:I18nMsg.currencySymbol;
this._isCurrency=true;
break
}
o.push(r)
}
return{
text:o.join(""),offset:t}
};
AjxNumberFormat.NumberSegment=function(t,e){
if(arguments.length==0){
return
}
AjxFormat.Segment.call(this,t,e)
};
AjxNumberFormat.NumberSegment.prototype=new AjxFormat.Segment;
AjxNumberFormat.NumberSegment.prototype.constructor=AjxNumberFormat.NumberSegment;
AjxNumberFormat.NumberSegment.prototype.toString=function(){
return'number: "'+this._s+'"'
};
AjxNumberFormat.NumberSegment.prototype.format=function(t){
if(isNaN(t)){
return I18nMsg.numberNaN
}
if(t===Number.NEGATIVE_INFINITY||t===Number.POSITIVE_INFINITY){
return I18nMsg.numberInfinity
}
if(typeof t!="number"){
t=Number(t)
}
t=Math.abs(t);
if(this._parent._isPercent){
t*=100
}else{
if(this._parent._isPerMille){
t*=1000
}}
var e=this._parent._showExponent?t.toExponential(this._parent._maxFracDigits).toUpperCase().replace(/E\+/,"E"):t.toFixed(this._parent._maxFracDigits||0);
e=this._normalize(e);
return e
};
AjxNumberFormat.NumberSegment.prototype._normalize=function(r){
var o=r.split(/[\.Ee]/);
var h=o.shift();
if(h.length<this._parent._minIntDigits){
h=AjxFormat._zeroPad(h,this._parent._minIntDigits,I18nMsg.numberZero)
}
if(h.length>this._parent._groupingOffset){
var t=[];
var n=h.length-this._parent._groupingOffset;
while(n>0){
t.unshift(h.substr(n,this._parent._groupingOffset));
t.unshift(I18nMsg.numberSeparatorGrouping);
n-=this._parent._groupingOffset
}
t.unshift(h.substring(0,n+this._parent._groupingOffset));
h=t.join("")
}
var l="0";
var c;
if(r.match(/\./)){
l=o.shift()
}else{
if(r.match(/\e/)||r.match(/\E/)){
c=o.shift()
}}
l=l.replace(/0+$/,"");
if(l.length<this._parent._minFracDigits){
l=AjxFormat._zeroPad(l,this._parent._minFracDigits,I18nMsg.numberZero,true)
}
var t=[h];
if(l.length>0){
var e=this._parent._isCurrency?I18nMsg.numberSeparatorMoneyDecimal:I18nMsg.numberSeparatorDecimal;
t.push(e,l)
}
if(c){
t.push("E",c.replace(/^\+/,""))
}
return t.join("")
};
AjxChoiceFormat=function(s){
if(arguments.length==0){
return
}
AjxFormat.call(this,s);
if(s==null){
return
}
var l=s.split("|");
if(arguments.length==1){
this._limits=new Array(l.length);
this._lessThan=new Array(l.length);
this._formats=new Array(l.length);
var r=new RegExp("^([^#<\u2264]+)([#<\u2264])(.*)$");
for(var a=0;
a<l.length;
a++){
var t=l[a];
var o=r.exec(t);
var e=o[1];
var n=o[2];
var h=o[3];
if(e=="\u221E"){
this._limits[a]=Number.POSITIVE_INFINITY
}else{
if(e=="-\u221E"){
this._limits[a]=Number.NEGATIVE_INFINITY
}else{
this._limits[a]=parseFloat(e)
}}
this._lessThan[a]=n=="#"||n=="\u2264";
this._formats[a]=new AjxMessageFormat(h)
}}else{
this._limits=arguments[0];
this._lessThan=new Array(arguments[0].length);
this._formats=arguments[1];
this._pattern=[];
for(var a=0;
a<this._formats.length;
a++){
if(a>0){
this._pattern.push("|")
}
this._pattern.push(this._limits[a],"#",this._formats[a]);
this._lessThan[a]=false;
this._formats[a]=new AjxMessageFormat(this._formats[a])
}
this._pattern=this._pattern.join("")
}};
AjxChoiceFormat.prototype=new AjxFormat;
AjxChoiceFormat.prototype.constructor=AjxChoiceFormat;
AjxChoiceFormat.prototype.toString=function(){
return["[AjxChoiceFormat: ","limits={ ",this._limits.join(", ")," }, ","formats={ ",this._formats.join(", ")," }, ","lessThan={ ",this._lessThan.join(", ")," }]"].join("")
};
AjxChoiceFormat.prototype.getLimits=function(){
return this._limits
};
AjxChoiceFormat.prototype.getFormats=function(){
return this._formats
};
AjxChoiceFormat.prototype.format=function(e,n){
var o=e instanceof Array?e[n]:e;
var l;
if(isNaN(o)||o<this._limits[0]){
l=this._formats[0]
}else{
for(var t=0;
t<this._limits.length-1;
t++){
var h=this._limits[t];
var r=this._limits[t+1];
var c=o>=h;
var s=this._lessThan[t+1]?o<r:o<=r;
if(c&&s){
l=this._formats[t];
break
}}
if(!l){
l=this._formats[this._formats.length-1]
}}
return l.format(e)
};
AjxListFormat=function(t,i,a,e){
AjxFormat.call(this,t?t.toPattern():"");
this._formatter=t;
this._separator=i||AjxMsg.listSeparator;
this._lastSeparator=a||AjxMsg.listSeparatorLast;
this._twoSeparator=e||AjxMsg.listSeparatorTwo
};
AjxListFormat.prototype=new AjxFormat;
AjxListFormat.prototype.constructor=AjxListFormat;
AjxListFormat.prototype.format=function(n){
n=n instanceof Array?n:[n];
var o=[];
var e=n.length;
for(var t=0;
t<e;
t++){
if(t>0){
o.push((t<e-1)?this._separator:(e==2)?this._twoSeparator:this._lastSeparator)
}
var a=n[t];
o.push(this._formatter?this._formatter.format(a):String(a))
}
return o.join("")
};
AjxFormat.initialize()
}
if(AjxPackage.define("ajax.util.AjxDateUtil")){
AjxDateUtil=function(){};
AjxDateUtil.YEAR=1;
AjxDateUtil.MONTH=2;
AjxDateUtil.WEEK=3;
AjxDateUtil.DAY=4;
AjxDateUtil.TWO_WEEKS=5;
AjxDateUtil.MSEC_PER_MINUTE=60000;
AjxDateUtil.MSEC_PER_FIFTEEN_MINUTES=900000;
AjxDateUtil.MSEC_PER_HALF_HOUR=1800000;
AjxDateUtil.MSEC_PER_HOUR=3600000;
AjxDateUtil.MSEC_PER_DAY=24*AjxDateUtil.MSEC_PER_HOUR;
AjxDateUtil.MINUTES_PER_DAY=60*24;
AjxDateUtil.SECONDS_PER_DAY=60*60*24;
AjxDateUtil.DAYS_PER_WEEK=7;
AjxDateUtil.WEEKDAY_SHORT=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT];
AjxDateUtil.WEEKDAY_MEDIUM=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM];
AjxDateUtil.WEEKDAY_LONG=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG];
AjxDateUtil.MONTH_SHORT=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT];
AjxDateUtil.MONTH_MEDIUM=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM];
AjxDateUtil.MONTH_LONG=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG];
AjxDateUtil._daysPerMonth={
0:31,1:29,2:31,3:30,4:31,5:30,6:31,7:31,8:30,9:31,10:30,11:31};
AjxDateUtil.MAX_DAYS_PER_MONTH=31;
AjxDateUtil.WEEK_ONE_JAN_DATE=1;
AjxDateUtil._init=function(){
AjxDateUtil._dateFormat=AjxDateFormat.getDateInstance(AjxDateFormat.SHORT).clone();
var e=AjxDateUtil._dateFormat.getSegments();
for(var t=0;
t<e.length;
t++){
if(e[t] instanceof AjxDateFormat.YearSegment){
e[t]=new AjxDateFormat.YearSegment(AjxDateUtil._dateFormat,"yyyy")
}}
AjxDateUtil._dateTimeFormat=new AjxDateFormat(AjxDateUtil._dateFormat.toPattern()+" "+AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT));
AjxDateUtil._dateFormatNoYear=new AjxDateFormat(AjxMsg.formatDateMediumNoYear)
};
AjxDateUtil._init();
AjxDateUtil.validDate=function(o,e,i){
var t=new Date(o,e,i);
var a=o>999?t.getFullYear():t.getYear();
return t.getMonth()==e&&t.getDate()==i&&a==o
};
AjxDateUtil.daysInMonth=function(a,e){
var t=new Date(a,e,1,12);
t.setMonth(t.getMonth()+1);
t.setDate(t.getDate()-1);
return t.getDate()
};
AjxDateUtil.isLeapYear=function(e){
return(new Date(e,1,29)).getMonth()==1
};
AjxDateUtil.isLocale24Hour=function(){
var t=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
var e=t._segments.length;
for(var a=0;
a<e;
a++){
if(t._segments[a]._s=="a"){
return false
}}
return true
};
AjxDateUtil.roll=function(t,a,o){
var i=t.getDate();
if(a==AjxDateUtil.MONTH){
t.setDate(1);
t.setMonth(t.getMonth()+o);
var e=AjxDateUtil.daysInMonth(t.getFullYear(),t.getMonth());
t.setDate(Math.min(i,e))
}else{
if(a==AjxDateUtil.YEAR){
t.setDate(1);
t.setFullYear(t.getFullYear()+o);
var e=AjxDateUtil.daysInMonth(t.getFullYear(),t.getMonth());
t.setDate(Math.min(i,e))
}else{
if(a==AjxDateUtil.WEEK){
t.setDate(t.getDate()+7*o)
}else{
if(a==AjxDateUtil.DAY){
t.setDate(t.getDate()+o)
}else{
if(a==AjxDateUtil.TWO_WEEKS){
t.setDate(t.getDate()+14*o)
}else{
return t
}}}}}
return t
};
AjxDateUtil.isDayShifted=function(e){
var t=new Date(e.getTime());
t.setDate(t.getDate()+1);
t.setHours(0,0,0,0);
return t.getTime()==e.getTime()
};
AjxDateUtil.rollToNextDay=function(e){
e.setHours(0,0,0,0);
e.setTime(e.getTime()+AjxDateUtil.MSEC_PER_DAY)
};
AjxDateUtil.computeDateDelta=function(e){
var t=(new Date()).getTime()-e;
var a=AjxDateUtil.computeDuration(t);
return a?(a+" "+AjxMsg.ago):null
};
AjxDateUtil.agoTime=function(e){
var t=(new Date()).getTime()-e;
var a=AjxDateUtil.computeDuration(t,false,true);
return a?(a+" "+AjxMsg.ago):null
};
AjxDateUtil.computeDuration=function(a,l,n){
if(a<0){
return null
}
var o=Math.floor(a/(AjxDateUtil.MSEC_PER_DAY*365));
if(o!=0){
a-=o*AjxDateUtil.MSEC_PER_DAY*365
}
var t=Math.floor(a/(AjxDateUtil.MSEC_PER_DAY*30.42));
if(t>0){
a-=Math.floor(t*AjxDateUtil.MSEC_PER_DAY*30.42)
}
var h=Math.floor(a/AjxDateUtil.MSEC_PER_DAY);
if(h>0){
a-=h*AjxDateUtil.MSEC_PER_DAY
}
var s=Math.floor(a/AjxDateUtil.MSEC_PER_HOUR);
if(s>0){
a-=s*AjxDateUtil.MSEC_PER_HOUR
}
var e=Math.floor(a/60000);
if(e>0){
a-=e*60000
}
var i=Math.floor(a/1000);
var r=l?AjxDurationFormatConcise:AjxDurationFormatVerbose;
if(o>0){
return n?r.formatYears(o):r.formatYears(o,t)
}else{
if(t>0){
return n?r.formatMonths(t):r.formatMonths(t,h)
}else{
if(h>0){
return n?r.formatDays(h):r.formatDays(h,s)
}else{
if(s>0){
return n?r.formatHours(s):r.formatHours(s,e)
}else{
if(e>0){
return n?r.formatMinutes(e):r.formatMinutes(e,i)
}else{
return r.formatSeconds(i)
}}}}}};
AjxDateUtil.simpleComputeDateStr=function(t,a){
var e=AjxDateUtil._dateFormat.format(t);
return a?a+e:e
};
AjxDateUtil.simpleParseDateStr=function(e){
return AjxDateUtil._dateFormat.parse(e)
};
AjxDateUtil.simpleComputeDateTimeStr=function(t,a){
var e=AjxDateUtil._dateTimeFormat.format(t);
return a?a+e:e
};
AjxDateUtil.simpleParseDateTimeStr=function(e){
return AjxDateUtil._dateTimeFormat.parse(e)
};
AjxDateUtil.longComputeDateStr=function(e){
var t=AjxDateFormat.getDateInstance(AjxDateFormat.FULL);
return t.format(e)
};
AjxDateUtil.computeDateStr=function(a,t){
if(t==null){
return""
}
var e=new Date(t);
if(a.getTime()-t<AjxDateUtil.MSEC_PER_DAY&&a.getDay()==e.getDay()){
return AjxDateUtil.computeTimeString(e)
}
if(a.getFullYear()==e.getFullYear()){
return AjxDateUtil._dateFormatNoYear.format(e)
}
return AjxDateUtil.simpleComputeDateStr(e)
};
AjxDateUtil.computeDateStrNoYear=function(e){
return AjxDateUtil._dateFormatNoYear.format(e)
};
AjxDateUtil.computeWordyDateStr=function(a,t){
if(t==null){
return""
}
var e=new Date(t);
if(a.getTime()-t<AjxDateUtil.MSEC_PER_DAY&&a.getDay()==e.getDay()){
if(!AjxDateUtil._wordyDateToday){
AjxDateUtil._wordyDateToday=new AjxDateFormat(AjxMsg.formatWordyDateToday)
}
return AjxDateUtil._wordyDateToday.format(e)
}else{
if((a.getTime()-t)<(2*AjxDateUtil.MSEC_PER_DAY)&&(a.getDay()-1)==e.getDay()){
if(!AjxDateUtil._wordyDateYesterday){
AjxDateUtil._wordyDateYesterday=new AjxDateFormat(AjxMsg.formatWordyDateYesterday)
}
return AjxDateUtil._wordyDateYesterday.format(e)
}else{
if(!AjxDateUtil._wordyDate){
AjxDateUtil._wordyDate=new AjxDateFormat(AjxMsg.formatWordyDate)
}
return AjxDateUtil._wordyDate.format(e)
}}};
AjxDateUtil.isValidSimpleDateStr=function(a){
if(!a){
return false
}
var t=AjxDateUtil.getSimpleDateFormat().parse(a);
if(!t){
return false
}
var e=AjxDateUtil.simpleComputeDateStr(t);
return(a==e)
};
AjxDateUtil.computeTimeString=function(e){
var t=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
return t.format(e)
};
AjxDateUtil.computeDateTimeString=function(e){
var t=AjxDateFormat.getDateTimeInstance(AjxDateFormat.LONG);
return t.format(e)
};
AjxDateUtil._getHoursStr=function(t,a,e){
var i=t.getHours();
if(!e){
i%=12;
if(i==0){
i=12
}}
return a?AjxDateUtil._pad(i):i
};
AjxDateUtil._getMinutesStr=function(e){
return AjxDateUtil._pad(e.getMinutes())
};
AjxDateUtil._getSecondsStr=function(e){
return AjxDateUtil._pad(e.getSeconds())
};
AjxDateUtil._getAMPM=function(t,a){
var e=t.getHours();
return(e<12)?(a?"AM":"am"):(a?"PM":"pm")
};
AjxDateUtil._getMonthName=function(e,t){
return t?AjxDateUtil.MONTH_MEDIUM[e.getMonth()]:AjxDateUtil.MONTH_LONG[e.getMonth()]
};
AjxDateUtil._getMonth=function(e,a){
var t=e.getMonth()+1;
if(a){
return AjxDateUtil._pad(t)
}else{
return t
}};
AjxDateUtil._getDate=function(e,t){
var a=e.getDate();
return t?AjxDateUtil._pad(a):a
};
AjxDateUtil._getWeekday=function(e){
var t=e.getDay();
return AjxDateUtil.WEEKDAY_LONG[t]
};
AjxDateUtil._getWeekdayMedium=function(e){
var t=e.getDay();
return AjxDateUtil.WEEKDAY_MEDIUM[t]
};
AjxDateUtil._getFullYear=function(e){
return e.getFullYear()
};
AjxDateUtil.getFirstDayOfWeek=function(i,e){
e=e||0;
var t=i.getDay();
var a=(t-e+7)%7;
i.setDate(i.getDate()-a);
return i
};
AjxDateUtil.getLastDayOfWeek=function(i,e){
e=e||0;
var t=i.getDay();
var a=(t-e+7)%7;
i.setDate(i.getDate()-a+6);
i.setHours(23,59,59,999);
return i
};
AjxDateUtil.getWeekNumber=function(p,l,x,w){
l=l||0;
x=x||AjxDateUtil.WEEK_ONE_JAN_DATE;
p=p||new Date();
p.setHours(12,0,0,0);
var o=p,k,r;
if(o.getDay()===l){
k=o
}else{
k=AjxDateUtil.getFirstDayOfWeek(o,l)
}
var d=k.getFullYear(),h=k.getTime();
r=new Date(k.getTime()+6*AjxDateUtil.MSEC_PER_DAY);
var e;
if(!w){
if(d!==r.getFullYear()&&r.getDate()>=x){
e=1
}else{
var n=(new Date(d,0,x));
n.setHours(12,0,0,0);
var i=AjxDateUtil.getFirstDayOfWeek(n,l);
var m=Math.round((o.getTime()-i.getTime())/AjxDateUtil.MSEC_PER_DAY);
var t=m%7;
var v=(m-t)/7;
e=v+1
}
return e
}else{
var g=new Date(p.getFullYear(),0,1);
var u=g.getDay()-1;
u=(u>=0?u:u+7);
var a=Math.floor((p.getTime()-g.getTime()-(p.getTimezoneOffset()-g.getTimezoneOffset())*60000)/AjxDateUtil.MSEC_PER_DAY)+1;
if(u<4){
e=Math.floor((a+u-1)/7)+1;
if(e>52){
var y=new Date(p.getFullYear()+1,0,1);
var f=y.getDay()-1;
f=f>=0?f:f+7;
e=f<4?1:53
}}else{
e=Math.floor((a+u-1)/7);
if(e==0){
var s=new Date(p.getFullYear()-1,0,1);
var c=s.getDay()-1;
c=(c>=0?c:c+7);
e=(c==3||(AjxDateUtil.isLeapYear(s.getFullYear())&&c==2))?53:52
}}
return e
}};
AjxDateUtil.getTimeStr=function(e,a){
var t=a;
t=t.replace(/%d/g,AjxDateUtil._getDate(e,true));
t=t.replace(/%D/g,AjxDateUtil._getDate(e,false));
t=t.replace(/%w/g,AjxDateUtil._getWeekday(e));
t=t.replace(/%M/g,AjxDateUtil._getMonthName(e));
t=t.replace(/%t/g,AjxDateUtil._getMonthName(e,true));
t=t.replace(/%n/g,AjxDateUtil._getMonth(e,true));
t=t.replace(/%Y/g,AjxDateUtil._getFullYear(e));
t=t.replace(/%h/g,AjxDateUtil._getHoursStr(e,false,false));
t=t.replace(/%H/g,AjxDateUtil._getHoursStr(e,true,false));
t=t.replace(/%m/g,AjxDateUtil._getMinutesStr(e));
t=t.replace(/%s/g,AjxDateUtil._getSecondsStr(e));
t=t.replace(/%P/g,AjxDateUtil._getAMPM(e,true));
t=t.replace(/%p/g,AjxDateUtil._getAMPM(e,false));
return t
};
AjxDateUtil.getRoundedMins=function(e,a){
var t=e.getMinutes();
if(t!=0&&a){
t=(Math.ceil((t/a)))*a
}
return t
};
AjxDateUtil.roundTimeMins=function(t,i){
var a=t.getMinutes();
var e=t.getHours();
if(a!=0&&i){
a=(Math.ceil((a/i)))*i;
if(a==60){
a=0;
e++
}
t.setMinutes(a);
t.setHours(e)
}
return t
};
AjxDateUtil.isInRange=function(i,t,a,e){
return(i<e&&t>a)
};
AjxDateUtil.getSimpleDateFormat=function(){
return AjxDateUtil._dateFormat
};
AjxDateUtil.getServerDate=function(e){
if(!AjxDateUtil._serverDateFormatter){
AjxDateUtil._serverDateFormatter=new AjxDateFormat("yyyyMMdd")
}
return AjxDateUtil._serverDateFormatter.format(e)
};
AjxDateUtil.getServerDateTime=function(t,i){
var e=t;
var a=null;
if(i){
if(!AjxDateUtil._serverDateTimeFormatterUTC){
AjxDateUtil._serverDateTimeFormatterUTC=new AjxDateFormat("yyyyMMdd'T'HHmmss'Z'")
}
a=AjxDateUtil._serverDateTimeFormatterUTC;
e=new Date(t.getTime());
e.setMinutes(e.getMinutes()+e.getTimezoneOffset())
}else{
if(!AjxDateUtil._serverDateTimeFormatter){
AjxDateUtil._serverDateTimeFormatter=new AjxDateFormat("yyyyMMdd'T'HHmmss")
}
a=AjxDateUtil._serverDateTimeFormatter
}
return a.format(e)
};
AjxDateUtil.parseServerTime=function(o,e,i){
if(o.charAt(8)=="T"){
var a=parseInt(o.substr(9,2),10);
var n=parseInt(o.substr(11,2),10);
var t=parseInt(o.substr(13,2),10);
if(!i&&o.charAt(15)=="Z"){
n+=AjxTimezone.getOffset(AjxTimezone.DEFAULT,e)
}
e.setHours(a,n,t,0)
}
return e
};
AjxDateUtil.parseISO8601Date=function(o){
var t=AjxDateUtil.__ISO8601_formats;
if(!t){
t=AjxDateUtil.__ISO8601_formats=[new AjxDateUtil.TZDFormat("yyyy-MM-dd'T'HH:mm:ss.SZ"),new AjxDateUtil.TZDFormat("yyyy-MM-dd'T'HH:mm:ssZ"),new AjxDateUtil.TZDFormat("yyyy-MM-dd'T'HH:mmZ"),new AjxDateFormat("yyyy-MM-dd"),new AjxDateFormat("yyyy-MM"),new AjxDateFormat("yyyy")]
}
for(var a=0;
a<t.length;
a++){
var e=t[a].parse(o);
if(e){
return e
}}
return null
};
AjxDateUtil.TZDFormat=function(o){
if(arguments.length==0){
return
}
AjxDateFormat.apply(this,arguments);
var e=this._segments||[];
for(var t=0;
t<e.length;
t++){
var a=e[t];
if(a instanceof AjxDateFormat.TimezoneSegment){
e[t]=new AjxDateUtil.TZDSegment(a.toSubPattern())
}}};
AjxDateUtil.TZDFormat.prototype=new AjxDateFormat;
AjxDateUtil.TZDFormat.prototype.constructor=AjxDateUtil.TZDFormat;
AjxDateUtil.TZDFormat.prototype.toString=function(){
return"TZDFormat"
};
AjxDateUtil.TZDSegment=function(e){
if(arguments.length==0){
return
}
AjxDateFormat.TimezoneSegment.apply(this,arguments)
};
AjxDateUtil.TZDSegment.prototype=new AjxDateFormat.TimezoneSegment;
AjxDateUtil.TZDSegment.prototype.constructor=AjxDateUtil.TZDSegment;
AjxDateUtil.TZDSegment.prototype.toString=function(){
return"TZDSegment"
};
AjxDateUtil.TZDSegment.prototype.parse=function(l,n,a){
var e=/^(Z)|^(\+|\-)(\d\d):(\d\d)/.exec(n.substr(a));
if(e){
var h=new Date().getTimezoneOffset();
if(e[1]){
l.timezone=h
}else{
var t=parseInt(e[3],10),r=parseInt(e[4],10);
l.timezone=t*60+r;
if(e[2]!="-"){
l.timezone*=-1
}
l.timezone-=h
}}
return a+(e?e[0].length:0)
};
AjxDateUtil.parseServerDateTime=function(a,t){
if(a==null){
return null
}
var i=new Date();
var n=parseInt(a.substr(0,4),10);
var o=parseInt(a.substr(4,2),10);
var e=parseInt(a.substr(6,2),10);
i.setFullYear(n);
i.setMonth(o-1);
i.setMonth(o-1);
i.setDate(e);
AjxDateUtil.parseServerTime(a,i,t);
return i
};
AjxDateUtil._pad=function(e){
return e<10?("0"+e):e
};
AjxDateUtil.getYearStr=function(e){
e=e||new Date();
return e.getFullYear()+""
};
AjxDurationFormatVerbose=function(){};
AjxDurationFormatVerbose.formatYears=function(a,e){
var t=a+" ";
t+=(a>1)?AjxMsg.years:AjxMsg.year;
if(a<=3&&e>0){
t+=" "+e;
t+=" "+((e>1)?AjxMsg.months:AjxMsg.months)
}
return t
};
AjxDurationFormatVerbose.formatMonths=function(e,a){
var t=e+" ";
t+=(e>1)?AjxMsg.months:AjxMsg.month;
if(e<=3&&a>0){
t+=" "+a;
t+=" "+((a>1)?AjxMsg.days:AjxMsg.day)
}
return t
};
AjxDurationFormatVerbose.formatDays=function(a,e){
var t=a+" ";
t+=(a>1)?AjxMsg.days:AjxMsg.day;
if(a<=2&&e>0){
t+=" "+e;
t+=" "+((e>1)?AjxMsg.hours:AjxMsg.hour)
}
return t
};
AjxDurationFormatVerbose.formatHours=function(e,a){
var t=e+" ";
t+=(e>1)?AjxMsg.hours:AjxMsg.hour;
if(e<5&&a>0){
t+=" "+a;
t+=" "+((a>1)?AjxMsg.minutes:AjxMsg.minute)
}
return t
};
AjxDurationFormatVerbose.formatMinutes=function(a,t){
var e=a+" ";
e+=((a>1)?AjxMsg.minutes:AjxMsg.minute);
if(a<5&&t>0){
e+=" "+t;
e+=" "+((t>1)?AjxMsg.seconds:AjxMsg.second)
}
return e
};
AjxDurationFormatVerbose.formatSeconds=function(e){
return(e+" "+((e>1)?AjxMsg.seconds:AjxMsg.second))
};
AjxDurationFormatConcise=function(){};
AjxDurationFormatConcise.formatYears=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatMonths=function(e,t){
return this._format(e,t)
};
AjxDurationFormatConcise.formatDays=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatHours=function(e,t){
return this._format(e,t)
};
AjxDurationFormatConcise.formatMinutes=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatSeconds=function(e){
return this._format(0,e)
};
AjxDurationFormatConcise._format=function(o,t){
var n=0;
var e=[];
e[n++]=o;
e[n++]=":";
if(t<10){
e[n++]="0"
}
e[n++]=t;
return e.join("")
};
AjxDateUtil.SUNDAY=0;
AjxDateUtil.MONDAY=1;
AjxDateUtil.TUESDAY=2;
AjxDateUtil.WEDNESDAY=3;
AjxDateUtil.THURSDAY=4;
AjxDateUtil.FRIDAY=5;
AjxDateUtil.SATURDAY=6;
AjxDateUtil.getDateForNextDay=function(t,n,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForNextWeekday(a,n);
if(e<o-1){
a.setDate(a.getDate()+1)
}}
return a
};
AjxDateUtil.getDateForNextWorkWeekDay=function(t,o){
o=o?o:1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForNextWorkWeekday(a);
if(e<o-1){
a.setDate(a.getDate()+1)
}}
return a
};
AjxDateUtil.getDateForThisDay=function(e,a,t){
if(t<0){
return AjxDateUtil.getDateForPrevDay(e,a,-t)
}else{
return AjxDateUtil.getDateForNextDay(e,a,t)
}};
AjxDateUtil.getDateForThisWorkWeekDay=function(e,t){
if(t<0){
return AjxDateUtil.getDateForPrevWorkWeekDay(e,-t)
}else{
return AjxDateUtil.getDateForNextWorkWeekDay(e,t)
}};
AjxDateUtil.getDateForPrevDay=function(t,n,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForPrevWeekday(a,n);
if(e<o-1){
a.setDate(a.getDate()-1)
}}
return a
};
AjxDateUtil.getDateForPrevWorkWeekDay=function(t,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForPrevWorkWeekday(a);
if(e<o-1){
a.setDate(a.getDate()-1)
}}
return a
};
AjxDateUtil.dateLocal2GMT=function(c){
if(!c){
return""
}
var u,t,m,d,r,h;
u=parseInt(c.substr(0,4),10);
t=parseInt(c.substr(4,2),10);
m=parseInt(c.substr(6,2),10);
d=parseInt(c.substr(8,2),10);
r=parseInt(c.substr(10,2),10);
h=parseInt(c.substr(12,2),10);
var o=new Date(u,t-1,m,d,r,h,0);
u=o.getUTCFullYear();
t=o.getUTCMonth()+1;
m=o.getUTCDate();
d=o.getUTCHours();
r=o.getUTCMinutes();
h=o.getUTCSeconds();
var l=[u,t,m,d,r,h];
for(var s=l.length;
--s>0;
){
var e=l[s];
if(e<10){
l[s]="0"+e
}}
return(l.join("")+"Z")
};
AjxDateUtil.dateGMT2Local=function(c){
if(!c){
return""
}
var u,t,m,d,r,h;
u=parseInt(c.substr(0,4),10);
t=parseInt(c.substr(4,2),10);
m=parseInt(c.substr(6,2),10);
d=parseInt(c.substr(8,2),10);
r=parseInt(c.substr(10,2),10);
h=parseInt(c.substr(12,2),10);
var o=new Date();
o.setUTCMilliseconds(0);
o.setUTCSeconds(h);
o.setUTCMinutes(r);
o.setUTCHours(d);
o.setUTCDate(m);
o.setUTCMonth(t-1);
o.setUTCFullYear(u);
u=o.getFullYear();
t=o.getMonth()+1;
m=o.getDate();
d=o.getHours();
r=o.getMinutes();
h=o.getSeconds();
var l=[u,t,m,d,r,h];
for(var s=l.length;
--s>0;
){
var e=l[s];
if(e<10){
l[s]="0"+e
}}
return(l.join("")+"Z")
};
AjxDateUtil._getDateForNextWeekday=function(a,o){
var e=new Date(a);
var t=a.getDay();
if(t==o){
return e
}
var i=(o-t);
if(i>0){
e.setDate(a.getDate()+i)
}else{
e.setDate(a.getDate()+(7+i))
}
return e
};
AjxDateUtil._getDateForNextWorkWeekday=function(a){
var e=new Date(a);
var t=a.getDay();
if(t==AjxDateUtil.SUNDAY){
e.setDate(a.getDate()+1)
}else{
if(t==AjxDateUtil.SATURDAY){
e.setDate(a.getDate()+2)
}}
return e
};
AjxDateUtil._getDateForPrevWeekday=function(a,o){
var e=new Date(a);
var t=a.getDay();
if(t==o){
return e
}
var i=(t-o);
if(i>0){
e.setDate(a.getDate()-i)
}else{
e.setDate(a.getDate()-(7+i))
}
return e
};
AjxDateUtil._getDateForPrevWorkWeekday=function(a){
var e=new Date(a);
var t=a.getDay();
if(t==AjxDateUtil.SUNDAY){
e.setDate(a.getDate()-2)
}else{
if(t==AjxDateUtil.SATURDAY){
e.setDate(a.getDate()-1)
}}
return e
};
AjxDateUtil.calculate=function(u,n){
if(!AjxDateUtil.__calculate_initialized){
AjxDateUtil.__calculate_initialized=true;
AjxDateUtil.__calculate_init()
}
var e=n||new Date;
u=u.replace(/^\s*|\s*$/,"").replace(/\s*=\s*/g,"=").replace(/\s*,\s*/g,",");
var f=u.split(/\s+/g);
var g,r,o,h,d,c,p,t;
for(var l=0;
l<f.length;
l++){
g=f[l];
if(g.match(AjxDateUtil.RE_COMMENT)){
break
}
if(g.match(AjxDateUtil.RE_NOW)){
n=new Date(e.getTime());
continue
}
if(r=g.match(AjxDateUtil.RE_ADD_NUMBER)){
o=r[1];
h=AjxDateUtil.__calculate_parseInt(r[2]);
d=f[++l];
c=o=="+"?h:h*-1;
AjxDateUtil.__calculate_add(n,d,c);
continue
}
if(r=g.match(AjxDateUtil.RE_SET)){
AjxDateUtil.__calculate_set(n,r[1],r[2]);
continue
}
n=AjxDateFormat.parse("yyyyy-MM-dd",g);
if(!n&&(n=AjxDateFormat.parse("yyyy-MM-dd'T'hh:mm:ss'Z'",g))){
n.setMinutes(n.getMinutes()-n.getTimezoneOffset())
}
if(!n){
n=AjxDateFormat.parse("yyyy-MM-dd'T'HH:mm:ss",g)
}
if(!n){
throw'invalid date pattern: "'+g+'"'
}}
return n
};
AjxDateUtil.S_DAYNAME=[AjxMsg["calc.dayname.sunday"],AjxMsg["calc.dayname.monday"],AjxMsg["calc.dayname.tuesday"],AjxMsg["calc.dayname.wednesday"],AjxMsg["calc.dayname.thursday"],AjxMsg["calc.dayname.friday"],AjxMsg["calc.dayname.saturday"]].join("|");
AjxDateUtil.S_MONTHNAME=[AjxMsg["calc.monthname.january"],AjxMsg["calc.monthname.february"],AjxMsg["calc.monthname.march"],AjxMsg["calc.monthname.april"],AjxMsg["calc.monthname.may"],AjxMsg["calc.monthname.june"],AjxMsg["calc.monthname.july"],AjxMsg["calc.monthname.august"],AjxMsg["calc.monthname.september"],AjxMsg["calc.monthname.october"],AjxMsg["calc.monthname.november"],AjxMsg["calc.monthname.december"]].join("|");
AjxDateUtil.S_WEEKORD=[AjxMsg["calc.ordinal.first"],AjxMsg["calc.ordinal.second"],AjxMsg["calc.ordinal.third"],AjxMsg["calc.ordinal.fourth"],AjxMsg["calc.ordinal.fifth"],AjxMsg["calc.ordinal.last"]].join("|");
AjxDateUtil.WEEKORD_RE=[new RegExp("(first|"+AjxMsg["calc.ordinal.first"]+")","i"),new RegExp("(second|"+AjxMsg["calc.ordinal.second"]+")","i"),new RegExp("(third|"+AjxMsg["calc.ordinal.third"]+")","i"),new RegExp("(fourth|"+AjxMsg["calc.ordinal.fourth"]+")","i"),new RegExp("(last|"+AjxMsg["calc.ordinal.last"]+")","i")];
AjxMsg["calc.now"]="now";
AjxMsg["calc.date"]="date";
AjxMsg["calc.duration.year"]="year|years";
AjxMsg["calc.duration.month"]="mons|month|months";
AjxMsg["calc.duration.day"]="day|days";
AjxMsg["calc.duration.hour"]="hour|hours";
AjxMsg["calc.duration.minute"]="min|mins|minute|minutes";
AjxMsg["calc.duration.week"]="week";
AjxMsg["calc.duration.second"]="sec|secs|second|seconds";
AjxMsg["calc.duration.millisecond"]="milli|millis|millisecond|milliseconds";
AjxDateUtil.S_DURATION=[AjxMsg["calc.duration.year"],AjxMsg["calc.duration.month"],AjxMsg["calc.duration.week"],AjxMsg["calc.duration.day"],AjxMsg["calc.duration.hour"],AjxMsg["calc.duration.minute"],AjxMsg["calc.duration.second"],AjxMsg["calc.duration.millisecond"]].join("|");
AjxDateUtil.__calculate_init=function(){
AjxDateUtil.WEEKDAYS={};
var t=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];
for(var o=0;
o<t.length;
o++){
var n=AjxMsg["calc.dayname."+t[o]].split("|");
for(var a=0;
a<n.length;
a++){
AjxDateUtil.WEEKDAYS[n[a].toLowerCase()]=o
}}
AjxDateUtil.MONTHNAME2MONTHNUM={};
var e=["january","february","march","april","may","june","july","august","september","october","november","december"];
for(var o=0;
o<e.length;
o++){
var s=AjxMsg["calc.monthname."+e[o]].split("|");
for(var a=0;
a<s.length;
a++){
AjxDateUtil.MONTHNAME2MONTHNUM[s[a].toLowerCase()]=o
}}
AjxDateUtil.RE_YEAR=new RegExp("^("+AjxMsg["calc.duration.year"]+")$","i");
AjxDateUtil.RE_MONTH=new RegExp("^("+AjxMsg["calc.duration.month"]+")$","i");
AjxDateUtil.RE_WEEK=new RegExp("^("+AjxMsg["calc.duration.week"]+")$","i");
AjxDateUtil.RE_DAY=new RegExp("^("+AjxMsg["calc.duration.day"]+")$","i");
AjxDateUtil.RE_HOUR=new RegExp("^("+AjxMsg["calc.duration.hour"]+")$","i");
AjxDateUtil.RE_MINUTE=new RegExp("^("+AjxMsg["calc.duration.minute"]+")$","i");
AjxDateUtil.RE_SECOND=new RegExp("^("+AjxMsg["calc.duration.second"]+")$","i");
AjxDateUtil.RE_MILLISECOND=new RegExp("^("+AjxMsg["calc.duration.millisecond"]+")$","i");
AjxDateUtil.RE_DATE=new RegExp("^("+AjxMsg["calc.date"]+")$","i");
AjxDateUtil.RE_DAYNAME=new RegExp("^("+AjxDateUtil.S_DAYNAME+")$","i");
AjxDateUtil.RE_MONTHNAME=new RegExp("^("+AjxDateUtil.S_MONTHNAME+")$","i");
AjxDateUtil.RE_WEEKORD=new RegExp("^("+AjxDateUtil.S_WEEKORD+")$","i");
AjxDateUtil.RE_COMMENT=/^#/;
AjxDateUtil.RE_NOW=new RegExp("^("+AjxMsg["calc.now"]+")$","i");
AjxDateUtil.RE_ADD_NUMBER=new RegExp("^([+\\-])(\\d+)$","i");
AjxDateUtil.RE_SET=new RegExp("^("+AjxDateUtil.S_DURATION+"|"+AjxMsg["calc.date"]+")=(.*)$","i")
};
AjxDateUtil.__calculate_normalizeFullWidthDigit=function(t){
var e="0".charCodeAt(0)+t.charCodeAt(0)-"\uff10".charCodeAt(0);
return String.fromCharCode(e)
};
AjxDateUtil.__calculate_replaceFullWidthDigit=function(e,t){
return AjxDateUtil.__calculate_normalizeFullWidthDigit(t)
};
AjxDateUtil.__calculate_parseInt=function(e){
e=e.replace(/([\uFF10-\uFF19])/g,AjxDateUtil.__calculate_normalizeFullWidthDigit);
return parseInt(e,10)
};
AjxDateUtil.__calculate_add=function(a,o,i){
if(o.match(AjxDateUtil.RE_YEAR)){
a.setFullYear(a.getFullYear()+i);
return
}
if(o.match(AjxDateUtil.RE_MONTH)){
var n=a.getMonth();
a.setMonth(n+i);
if(Math.abs(n+i)%12!=a.getMonth()){
a.setDate(0)
}
return
}
if(o.match(AjxDateUtil.RE_WEEK)){
a.setDate(a.getDate()+i*7);
return
}
if(o.match(AjxDateUtil.RE_DAY)){
a.setDate(a.getDate()+i);
return
}
if(o.match(AjxDateUtil.RE_HOUR)){
a.setHours(a.getHours()+i);
return
}
if(o.match(AjxDateUtil.RE_MINUTE)){
a.setMinutes(a.getMinutes()+i);
return
}
if(o.match(AjxDateUtil.RE_SECOND)){
a.setSeconds(a.getSeconds()+i);
return
}
if(o.match(AjxDateUtil.RE_MILLISECOND)){
a.setMilliseconds(a.getMilliseconds()+i);
return
}
if(o.match(AjxDateUtil.RE_MONTHNAME)){
var e=AjxDateUtil.MONTHNAME2MONTHNUM[o.toLowerCase()];
if(e<a.getMonth()){
i+=i>0?0:1
}else{
if(e>a.getMonth()){
i+=i>0?-1:0
}}
a.setFullYear(a.getFullYear()+i,e,1);
return
}
if(o.match(AjxDateUtil.RE_DAYNAME)){
var t=AjxDateUtil.WEEKDAYS[o.toLowerCase()];
if(t<a.getDay()){
i+=i>0?0:1
}else{
if(t>a.getDay()){
i+=i>0?-1:0
}}
a.setDate(a.getDate()+(t-a.getDay())+7*i);
return
}
throw"unknown type: "+o
};
AjxDateUtil.__calculate_add_ordinal=function(){
throw"TODO: not implemented"
};
AjxDateUtil.__calculate_set=function(i,r,l){
var n=l.split(/,/);
if(n[0].indexOf("H")==0){
n[0]=parseInt(n[0].replace("H",""))+1988
}
if(r.match(AjxDateUtil.RE_YEAR)){
n[0]=AjxDateUtil.__calculate_fullYear(n[0]);
if(n[1]!=null){
n[1]=AjxDateUtil.__calculate_month(n[1])
}
if(n[2]!=null){
n[2]=parseInt(n[2],10)
}
i.setFullYear.apply(i,n);
return
}
if(r.match(AjxDateUtil.RE_MONTH)){
n[0]=AjxDateUtil.__calculate_month(n[0]);
if(n[1]!=null){
n[1]=parseInt(n[1],10)
}
i.setMonth.apply(i,n);
return
}
if(r.match(AjxDateUtil.RE_WEEK)){
var t=AjxDateUtil.__calculate_week(n[0]);
var h=n[1]?AjxDateUtil.__calculate_day(n[1]):i.getDay();
var o;
if(t!=-1){
var e=new Date(i.getFullYear(),i.getMonth(),1,12,0,0,0);
var a=e.getDay();
var c=a-h;
o=new Date(e.getTime());
o.setDate(1-c);
if(c>0){
o.setDate(o.getDate()+7)
}
o.setDate(o.getDate()+7*t)
}else{
var s=new Date(i.getFullYear(),i.getMonth()+1,0,12,0,0,0);
o=new Date(s.getTime());
o.setDate(o.getDate()-(o.getDay()-h));
if(o.getMonth()!=s.getMonth()){
o.setDate(o.getDate()-7)
}}
if(o&&(i.getMonth()==o.getMonth())){
i.setTime(o.getTime())
}
return
}
if(r.match(AjxDateUtil.RE_DATE)){
n[0]=parseInt(n[0],10);
i.setDate.apply(i,n);
return
}
if(r.match(AjxDateUtil.RE_HOUR)){
n[0]=parseInt(n[0],10);
if(n[1]!=null){
n[1]=parseInt(n[1],10)
}
if(n[2]!=null){
n[2]=parseInt(n[2],10)
}
if(n[3]!=null){
n[3]=parseInt(n[3],10)
}
i.setHours.apply(i,n);
return
}
if(r.match(AjxDateUtil.RE_MINUTE)){
n[0]=parseInt(n[0],10);
if(n[1]!=null){
n[1]=parseInt(n[1],10)
}
if(n[2]!=null){
n[2]=parseInt(n[2],10)
}
i.setMinutes.apply(i,n);
return
}
if(r.match(AjxDateUtil.RE_SECOND)){
n[0]=parseInt(n[0],10);
if(n[1]!=null){
n[1]=parseInt(n[1],10)
}
i.setSeconds.apply(i,n);
return
}
if(r.match(AjxDateUtil.RE_MILLISECOND)){
i.setMilliseconds.apply(i,n);
return
}
throw"unknown type: "+r
};
AjxDateUtil.__calculate_fullYear=function(t){
if(t.length==2){
var a=new Date;
a.setYear(parseInt(t,10));
var e=a.getFullYear();
if(e<=AjxMsg.dateParsing2DigitStartYear){
t=String(e+100)
}else{
t=String(e).substr(0,2)+t
}}
return parseInt(t,10)
};
AjxDateUtil.__calculate_month=function(t){
var e=AjxDateUtil.MONTHNAME2MONTHNUM[t.toLowerCase()];
return e!=null?e:parseInt(t,10)-1
};
AjxDateUtil.__calculate_week=function(t){
for(var e=0;
e<AjxDateUtil.WEEKORD_RE.length;
e++){
if(t.match(AjxDateUtil.WEEKORD_RE[e])){
if(e==AjxDateUtil.WEEKORD_RE.length-1){
return -1
}
return e
}}
return 0
};
AjxDateUtil.__calculate_day=function(t){
var e=AjxDateUtil.WEEKDAYS[t.toLowerCase()];
return e!=null?e:parseInt(t,10)
}
}
if(AjxPackage.define("ajax.util.AjxSelectionManager")){
AjxSelectionManager=function(e){
this._owner=e
};
AjxSelectionManager.SELECT_ONE_CLEAR_OTHERS=0;
AjxSelectionManager.TOGGLE_ONE_LEAVE_OTHERS=1;
AjxSelectionManager.SELECT_TO_ANCHOR=2;
AjxSelectionManager.DESELECT_ALL=3;
AjxSelectionManager.SELECT_ALL=4;
AjxSelectionManager.prototype.getItems=function(){
if(this._selectedItems==null){
this._selectedItems=this._createItemsCollection()
}
return this._selectedItems
};
AjxSelectionManager.prototype.getLength=function(){
return this.getItems().length
};
AjxSelectionManager.prototype.getAnchor=function(){
if(this._anchor==null){
var e=this.getItems();
if(e.length>0){
this._anchor=e[0]
}}
return this._anchor
};
AjxSelectionManager.prototype.getCursor=function(){
if(this._cursor==null){
this._cursor=this.getAnchor()
}
return this._cursor
};
AjxSelectionManager.prototype.isSelected=function(e){
return this.getItems().binarySearch(e)!=-1
};
AjxSelectionManager.prototype.selectOneItem=function(e){
this.select(e,AjxSelectionManager.SELECT_ONE_CLEAR_OTHERS)
};
AjxSelectionManager.prototype.toggleItem=function(e){
this.select(e,AjxSelectionManager.TOGGLE_ONE_LEAVE_OTHERS)
};
AjxSelectionManager.prototype.selectFromAnchorToItem=function(e){
this.select(e,AjxSelectionManager.SELECT_TO_ANCHOR)
};
AjxSelectionManager.prototype.deselectAll=function(){
this.select(null,AjxSelectionManager.DESELECT_ALL)
};
AjxSelectionManager.prototype.selectAll=function(){
this.select(null,AjxSelectionManager.SELECT_ALL)
};
AjxSelectionManager.prototype.select=function(f,s){
this._setAnchorAndCursor(f,s);
var m=this._selectedItems;
var n=(m==null)?0:m.length;
this._selectedItems=null;
this._selectedItems=this._createItemsCollection();
var e=this._owner.getItemCount();
var u=false;
var o=false;
var c=false;
for(var h=0;
h<e;
++h){
var l=this._owner.getItem(h);
var d=this._isItemOldSelection(l,m);
var t=d;
switch(s){
case AjxSelectionManager.SELECT_TO_ANCHOR:if(this._anchor==null){
this._anchor=l
}
var a=(l==this._anchor||l==f);
var r=false;
if(!c&&a){
c=true;
r=true
}
t=c;
if((!r||this._anchor==f)&&c&&a){
c=false
}
break;
case AjxSelectionManager.SELECT_ONE_CLEAR_OTHERS:t=(l==f);
break;
case AjxSelectionManager.TOGGLE_ONE_LEAVE_OTHERS:if(l==f){
t=!d
}
break;
case AjxSelectionManager.DESELECT_ALL:t=false;
break;
case AjxSelectionManager.SELECT_ALL:t=true;
break
}
if(t){
this._selectedItems.add(l);
u=(this._selectedItems.length>1)
}
if(t!=d){
if(this._owner.itemSelectionChanged!=null){
this._owner.itemSelectionChanged(l,h,t)
}
o=true
}}
o=o||(n!=this._selectedItems.length);
if(u){
this._selectedItems.sort()
}
if(o&&this._owner.selectionChanged!=null){
this._owner.selectionChanged(f)
}};
AjxSelectionManager.prototype.removeItem=function(t){
if(this._selectedItems){
var e=this._selectedItems.binarySearch(t);
if(e>-1){
this._selectedItems.removeAt(e)
}}};
AjxSelectionManager.prototype._createItemsCollection=function(){
return new AjxVector()
};
AjxSelectionManager.prototype._isItemOldSelection=function(t,i){
var e=false;
if(i){
var a=i.binarySearch(t);
if(a>-1){
i.removeAt(a)
}
e=(a!=-1)
}
return e
};
AjxSelectionManager.prototype._setAnchorAndCursor=function(e,t){
switch(t){
case AjxSelectionManager.SELECT_TO_ANCHOR:this._cursor=e;
break;
case AjxSelectionManager.SELECT_ONE_CLEAR_OTHERS:this._anchor=e;
this._cursor=e;
break;
case AjxSelectionManager.TOGGLE_ONE_LEAVE_OTHERS:this._anchor=e;
this._cursor=e;
break;
case AjxSelectionManager.DESELECT_ALL:this._anchor=null;
this._cursor=null;
break;
case AjxSelectionManager.SELECT_ALL:return
}}
}
if(AjxPackage.define("ajax.net.AjxPost")){
AjxPost=function(e){
this._callback=null;
this._iframeId=e
};
AjxPost._reqIds=0;
AjxPost._outStandingRequests=new Object();
AjxPost.SC_CONTINUE=100;
AjxPost.SC_OK=200;
AjxPost.SC_ACCEPTED=202;
AjxPost.SC_NO_CONTENT=204;
AjxPost.SC_BAD_REQUEST=400;
AjxPost.SC_UNAUTHORIZED=401;
AjxPost.SC_REQUEST_TIMEOUT=408;
AjxPost.SC_CONFLICT=409;
AjxPost.SC_REQUEST_ENTITY_TOO_LARGE=413;
AjxPost.SC_INTERNAL_SERVER_ERROR=500;
AjxPost.SC_BAD_GATEWAY=502;
AjxPost.SC_SERVICE_UNAVAILABLE=503;
AjxPost.prototype.execute=function(l,e,h){
var c=e.getElementsByTagName("input");
var o=new Array();
for(var a=0;
a<c.length;
a++){
var d=c[a];
if(d.type=="file"){
o.push(d);
continue
}
if(d.name&&d.name.match(/^filename\d+$/)){
d.parentNode.removeChild(d);
a--;
continue
}}
if(window.csrfToken){
this._addHiddenField(o[0],"csrfToken",window.csrfToken)
}
this._addHiddenFileNames(o);
e.target=this._iframeId;
this._callback=l;
var r=new AjxPostRequest(e);
var t=new AjxTimedAction(this,this._onFailure,[r.id]);
var s=h?h:5000;
AjxPost._outStandingRequests[r.id]=r;
try{
r.send(t,s)
}
catch(n){
if(AjxEnv.isIE){
if(n.number==-2147024891){
throw new AjxException(ZmMsg.uploadErrorAccessDenied,n.number)
}}
throw n
}};
AjxPost.prototype._addHiddenFileNames=function(t){
var e=0;
for(var o=0;
o<t.length;
o++){
var s=t[o];
if(s.files&&s.files.length>1){
var n=s.files,h=[];
for(var a=0;
a<n.length;
a++){
var r=n[a];
h.push(r.name||r.fileName)
}
this._addHiddenFileName(t[o],h.join("\n"),++e)
}else{
this._addHiddenFileName(t[o],t[o].value,++e)
}}};
AjxPost.prototype._addHiddenFileName=function(e,a,t){
this._addHiddenField(e,"filename"+(t),a)
};
AjxPost.prototype._addHiddenField=function(i,a,t){
var e=document.createElement("input");
e.type="hidden";
e.name=a;
e.value=t;
i.parentNode.insertBefore(e,i)
};
AjxPost.prototype._onFailure=function(t){
var e=AjxPost._outStandingRequests[t];
e.cancel();
delete AjxPost._outStandingRequests[t];
if(this._callback){
this._callback.run([404]);
this._callback=null
}};
AjxPost.prototype.loaded=function(e,a,i){
var t=AjxPost._outStandingRequests[a];
if(t&&!t.hasBeenCancelled()){
t.cancelTimeout()
}
delete AjxPost._outStandingRequests[a];
if(this._callback){
this._callback.run(e,i);
this._callback=null
}};
AjxPostRequest=function(t){
this.id=AjxPost._reqIds++;
this._cancelled=false;
this._form=t;
var e=t.elements.namedItem("requestId");
if(!e){
e=t.ownerDocument.createElement("input");
e.type="hidden";
e.name="requestId"
}
e.value=this.id;
t.appendChild(e)
};
AjxPostRequest.prototype.send=function(t,e){
this._form.submit()
};
AjxPostRequest.prototype.hasBeenCancelled=function(){
return this._cancelled
};
AjxPostRequest.prototype.cancelTimeout=function(){
AjxTimedAction.cancelAction(this._timeoutId)
};
AjxPostRequest.prototype.cancel=function(){
this._cancelled=true
}
}
if(AjxPackage.define("ajax.util.AjxBuffer")){
AjxBuffer=function(){
this.clear();
if(arguments.length>0){
arguments.join=this.buffer.join;
this.buffer[this.buffer.length]=arguments.join("")
}};
AjxBuffer.prototype.toString=function(){
return this.buffer.join("")
};
AjxBuffer.prototype.join=function(e){
if(e==null){
e=""
}
return this.buffer.join(e)
};
AjxBuffer.prototype.append=function(){
arguments.join=this.buffer.join;
this.buffer[this.buffer.length]=arguments.join("")
};
AjxBuffer.prototype.join=function(e){
return this.buffer.join(e)
};
AjxBuffer.prototype.set=function(e){
this.buffer=[e]
};
AjxBuffer.prototype.clear=function(){
this.buffer=[]
};
AjxBuffer.concat=function(){
arguments.join=Array.prototype.join;
return arguments.join("")
};
AjxBuffer.append=AjxBuffer.concat
}
if(AjxPackage.define("ajax.util.AjxTimezone")){
AjxTimezone=function(){};
AjxTimezone.convertTimezone=function(t,e,o){
if(e==o){
return t
}
var i=AjxTimezone.getOffset(o,t);
var a=AjxTimezone.getOffset(e,t);
return new Date(t.getTime()+(i-a)*60*1000)
};
AjxTimezone.getTransition=function(i,a){
var t=[a||new Date().getFullYear(),i.mon,1];
if(i.mday){
t[2]=i.mday
}else{
if(i.wkday){
var e=new Date(a,i.mon-1,1,i.hour,i.min,i.sec);
if(i.week==-1){
var n=new Date(new Date(e.getTime()).setMonth(i.mon,0));
var o=n.getDate();
var r=n.getDay()+1;
var s=r>=i.wkday?r-i.wkday:7-i.wkday-r;
t[2]=o-s
}else{
var r=e.getDay()+1;
var s=i.wkday==r?1:0;
t[2]=i.wkday+7*(i.week-s)-r+1
}}}
return t
};
AjxTimezone.createMDayTransition=function(e,a){
if(e instanceof Date){
a=a!=null?a:e.getTimezoneOffset();
e=[e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()]
}
var t={
offset:a,trans:e};
return AjxTimezone.addMDayTransition(t)
};
AjxTimezone.addMDayTransition=function(t){
var e=t.trans;
t.mon=e[1];
t.mday=e[2];
t.hour=e[3];
t.min=e[4];
t.sec=e[5];
return t
};
AjxTimezone.createWkDayTransition=function(e,a){
if(e instanceof Date){
a=a!=null?a:e.getTimezoneOffset();
e=[e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()]
}
var t={
offset:a,trans:e};
return AjxTimezone.addWkDayTransition(t)
};
AjxTimezone.addWkDayTransition=function(o){
var a=o.trans;
var i=a[1];
var r=a[2];
var t=Math.floor((r-1)/7);
var e=new Date(a[0],a[1]-1,a[2],12,0,0);
var s=new Date(new Date(e.getTime()).setMonth(i-1,0)).getDate();
var n=s-r<7;
o.mon=i;
o.week=n?-1:t+1;
o.wkday=e.getDay()+1;
o.hour=a[3];
o.min=a[4];
o.sec=a[5];
return o
};
AjxTimezone.createTransitionDate=function(o){
var e=new Date(AjxTimezoneData.TRANSITION_YEAR,o.mon-1,1,12,0,0);
if(o.mday){
e.setDate(o.mday)
}else{
if(o.week==-1){
e.setMonth(e.getMonth()+1,0);
for(var a=0;
a<7;
a++){
if(e.getDay()+1==o.wkday){
break
}
e.setDate(e.getDate()-1)
}}else{
for(var a=0;
a<7;
a++){
if(e.getDay()+1==o.wkday){
break
}
e.setDate(e.getDate()+1)
}
e.setDate(e.getDate()+7*(o.week-1))
}}
var t=[e.getFullYear(),e.getMonth()+1,e.getDate()];
return t
};
AjxTimezone.getZonePreferences=function(){
if(AjxTimezone._PREF_ZONE_DISPLAY){
var a=AjxTimezone._PREF_ZONE_DISPLAY.length;
var t=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(a!=t){
AjxTimezone._PREF_ZONE_DISPLAY=null
}}
if(!AjxTimezone._PREF_ZONE_DISPLAY){
AjxTimezone._PREF_ZONE_DISPLAY=[];
AjxTimezone.getAbbreviatedZoneChoices();
for(var e=0;
e<AjxTimezone._ABBR_ZONE_OPTIONS.length;
e++){
AjxTimezone._PREF_ZONE_DISPLAY.push(AjxTimezone._ABBR_ZONE_OPTIONS[e].displayValue)
}}
return AjxTimezone._PREF_ZONE_DISPLAY
};
AjxTimezone.getZonePreferencesOptions=function(){
if(AjxTimezone._PREF_ZONE_OPTIONS){
var a=AjxTimezone._PREF_ZONE_OPTIONS.length;
var t=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(a!=t){
AjxTimezone._PREF_ZONE_OPTIONS=null
}}
if(!AjxTimezone._PREF_ZONE_OPTIONS){
AjxTimezone._PREF_ZONE_OPTIONS=[];
AjxTimezone.getAbbreviatedZoneChoices();
for(var e=0;
e<AjxTimezone._ABBR_ZONE_OPTIONS.length;
e++){
AjxTimezone._PREF_ZONE_OPTIONS.push(AjxTimezone._ABBR_ZONE_OPTIONS[e].value)
}}
return AjxTimezone._PREF_ZONE_OPTIONS
};
AjxTimezone.getServerId=function(e){
return AjxTimezone._CLIENT2SERVER[e]||e
};
AjxTimezone.getClientId=function(e){
return AjxTimezone._SERVER2CLIENT[e]||e
};
AjxTimezone.getShortName=function(t){
var a=AjxTimezone.getRule(t);
if(a&&a.shortName){
return a.shortName
}
var e=["GMT",AjxTimezone._SHORT_NAMES[t]].join("");
if(a){
a.shortName=e
}
return e
};
AjxTimezone.getMediumName=function(e){
var a=AjxTimezone.getRule(e);
if(a&&a.mediumName){
return a.mediumName
}
var t=AjxMsg[e]||["(",AjxTimezone.getShortName(e),") ",e].join("");
if(a){
a.mediumName=t
}
return t
};
AjxTimezone.getLongName=AjxTimezone.getMediumName;
AjxTimezone.addRule=function(a){
var t=a.serverId;
var e=a.clientId;
AjxTimezone._CLIENT2SERVER[e]=t;
AjxTimezone._SERVER2CLIENT[t]=e;
AjxTimezone._SHORT_NAMES[e]=AjxTimezone._generateShortName(a.standard.offset);
AjxTimezone._CLIENT2RULE[e]=a;
var i=a.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
i.push(a)
};
AjxTimezone.getRule=function(e,o){
var c=AjxTimezone._CLIENT2RULE[e];
if(!c){
e=AjxTimezone._SERVER2CLIENT[e];
c=AjxTimezone._CLIENT2RULE[e]
}
if(!c&&o){
var l=["standard","daylight"];
var d=o.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
for(var s=0;
s<d.length;
s++){
c=d[s];
var u=true;
for(var n=0;
n<l.length;
n++){
var t=l[n];
var r=c[t];
if(!r){
continue
}
var h=false;
for(var a in o[t]){
if(o[t][a]!=r[a]){
u=false;
h=true;
break
}}
if(h){
break
}}
if(u){
return c
}}
return null
}
return c
};
AjxTimezone.getOffset=function(e,o){
var u=AjxTimezone.getRule(e||AjxTimezone.DEFAULT);
if(u&&u.daylight){
var c=o.getFullYear();
var s=u.standard,t=u.daylight;
var l=AjxTimezone.getTransition(s,c);
var f=AjxTimezone.getTransition(t,c);
var h=o.getMonth()+1,d=o.getDate();
var n=l[1],m=l[2];
var r=f[1],i=f[2];
var a=false;
if(r<n){
a=h>r&&h<n;
a=a||(h==r&&d>=i);
a=a||(h==n&&d<m)
}else{
a=h<n||h>r;
a=a||(h==r&&d>=i);
a=a||(h==n&&d<m)
}
return a?t.offset:s.offset
}
return u?u.standard.offset:-(new Date().getTimezoneOffset())
};
AjxTimezone.guessMachineTimezone=function(){
return AjxTimezone._guessMachineTimezone().clientId
};
AjxTimezone.getAbbreviatedZoneChoices=function(){
if(AjxTimezone._ABBR_ZONE_OPTIONS){
var o=AjxTimezone._ABBR_ZONE_OPTIONS.length;
var i=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(o!=i){
AjxTimezone._ABBR_ZONE_OPTIONS=null
}}
if(!AjxTimezone._ABBR_ZONE_OPTIONS){
AjxTimezone._ABBR_ZONE_OPTIONS=[];
for(var e in AjxTimezone._CLIENT2SERVER){
var n=AjxTimezone._CLIENT2RULE[e];
var t=n.serverId;
var a={
displayValue:AjxTimezone.getMediumName(e),value:t,standard:n.standard,serverId:t,clientId:e};
AjxTimezone._ABBR_ZONE_OPTIONS.push(a)
}
AjxTimezone._ABBR_ZONE_OPTIONS.sort(AjxTimezone._BY_OFFSET)
}
return AjxTimezone._ABBR_ZONE_OPTIONS
};
AjxTimezone.getMatchingTimezoneChoices=function(){
if(AjxTimezone._MATCHING_ZONE_OPTIONS){
var s=AjxTimezone._MATCHING_ZONE_OPTIONS.length;
var n=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(s!=n){
AjxTimezone._MATCHING_ZONE_OPTIONS=null
}}
if(!AjxTimezone._MATCHING_ZONE_OPTIONS){
AjxTimezone._MATCHING_ZONE_OPTIONS=[];
for(var a in AjxTimezone.MATCHING_RULES){
var r=AjxTimezone.MATCHING_RULES[a];
var e=r.clientId;
var t=r.serverId;
if(e==AjxTimezone.AUTO_DETECTED){
continue
}
var o={
displayValue:AjxTimezone.getMediumName(e),value:t,standard:r.standard,serverId:t,clientId:e};
AjxTimezone._MATCHING_ZONE_OPTIONS.push(o)
}
AjxTimezone._MATCHING_ZONE_OPTIONS.sort(AjxTimezone._BY_OFFSET)
}
return AjxTimezone._MATCHING_ZONE_OPTIONS
};
AjxTimezone._BY_OFFSET=function(a,t){
var o=a.standard.offset-t.standard.offset;
if(o==0){
var e=a.serverId;
var i=t.serverId;
if(e<i){
o=-1
}else{
if(e>i){
o=1
}}}
return o
};
AjxTimezone.GMT="Europe/London";
AjxTimezone.GMT_NO_DST="UTC";
AjxTimezone.AUTO_DETECTED="Auto-Detected";
AjxTimezone._CLIENT2SERVER={};
AjxTimezone._SERVER2CLIENT={};
AjxTimezone._SHORT_NAMES={};
AjxTimezone._CLIENT2RULE={};
AjxTimezone.STANDARD_RULES=[];
AjxTimezone.DAYLIGHT_RULES=[];
(function(){
for(var e=0;
e<AjxTimezoneData.TIMEZONE_RULES.length;
e++){
var t=AjxTimezoneData.TIMEZONE_RULES[e];
var a=t.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
a.push(t)
}}
)();
AjxTimezone._guessMachineTimezone=function(f){
var u=new Date(AjxTimezoneData.TRANSITION_YEAR,11,1,0,0,0);
var v=new Date(AjxTimezoneData.TRANSITION_YEAR,5,1,0,0,0);
var t=-u.getTimezoneOffset();
var g=-v.getTimezoneOffset();
AjxTimezone.MATCHING_RULES=[];
AjxTimezone.TIMEZONE_CONFLICT=false;
var c=[];
var s={};
var r=[];
var p=false;
if(g==t){
var m=AjxTimezone.STANDARD_RULES;
for(var y=0;
y<m.length;
++y){
var h=m[y];
if(h.standard.offset==g){
if(!s[h.serverId]){
c.push(h);
s[h.serverId]=true
}
AjxTimezone.MATCHING_RULES.push(h)
}}}else{
var m=AjxTimezone.DAYLIGHT_RULES;
var q=Math.max(t,g);
var k=Math.min(t,g);
var o=new Date();
var w=-o.getTimezoneOffset();
for(var y=0;
y<m.length;
++y){
var h=m[y];
if(h.standard.offset==k&&h.daylight.offset==q){
var l=h.standard.trans;
var d=h.daylight.trans;
var n=new Date(l[0],l[1]-1,l[2]-1);
var a=new Date(l[0],l[1]-1,l[2]+2);
var e=new Date(d[0],d[1]-1,d[2]-1);
var x=new Date(d[0],d[1]-1,d[2]+2);
if(-a.getTimezoneOffset()==k&&-x.getTimezoneOffset()==q&&-n.getTimezoneOffset()==q&&-e.getTimezoneOffset()==k){
if(!s[h.serverId]){
c.push(h);
s[h.serverId]=true
}
p=true
}}
if(h.standard.offset==w||h.daylight.offset==w){
AjxTimezone.MATCHING_RULES.push(h)
}}}
if((c.length>0)&&f!=null){
var m=c;
for(var y in m){
if(m[y].serverId==f){
return m[y]
}}}
if(c.length>0){
if(c.length>1){
c.sort(AjxTimezone.__BY_SCORE);
if(c[0].score!=c[1].score){
c.length=1
}}
AjxTimezone.TIMEZONE_CONFLICT=(c.length>1);
return c[0]
}
if((AjxTimezone.MATCHING_RULES.length>0)&&f!=null){
var m=AjxTimezone.MATCHING_RULES;
for(var y in m){
if(m[y].serverId==f){
return m[y]
}}}
return AjxTimezone._generateDefaultRule()
};
AjxTimezone.__BY_SCORE=function(t,e){
return e.score-t.score
};
AjxTimezone._generateDefaultRule=function(){
var l=0;
var a=1;
var i=2;
var s=3;
var o=4;
function c(m,u,v,k){
var p=u.getTime();
var w=new Date();
w.setTime(m.getTime());
var y=new Date();
y.setTime(w.getTime());
var x=m.getTimezoneOffset()*-1;
if(!k){
k={
clientId:AjxTimezone.AUTO_DETECTED,autoDetected:true}
}
while(w.getTime()<=p){
if(v==l){
w.setUTCMonth(w.getUTCMonth()+1)
}else{
if(v==a){
w.setUTCDate(w.getUTCDate()+1)
}else{
if(v==i){
w.setUTCHours(w.getUTCHours()+1)
}else{
if(v==s){
w.setUTCMinutes(w.getUTCMinutes()+1)
}else{
if(v==o){
w.setUTCSeconds(w.getUTCSeconds()+1)
}else{
return k
}}}}}
var f=w.getTimezoneOffset()*-1;
if(f!=x){
if(v<o){
k=c(y,w,v+1,k)
}else{
var q=new Date();
q.setUTCFullYear(y.getFullYear(),y.getMonth(),y.getDate());
q.setUTCHours(y.getHours(),y.getMinutes(),y.getSeconds()+1);
var g=k[x<f?"daylight":"standard"]={
offset:f,trans:[q.getUTCFullYear(),q.getUTCMonth()+1,q.getUTCDate(),q.getUTCHours(),q.getUTCMinutes(),q.getUTCSeconds()]};
AjxTimezone.addWkDayTransition(g);
return k
}}
y.setTime(w.getTime());
x=f
}
return k
}
var t=new Date();
var e=new Date();
var r=t.getFullYear();
t.setUTCFullYear(r,t.getMonth(),t.getDate()-1);
t.setUTCHours(0,0,0,0);
e.setTime(t.getTime());
e.setUTCFullYear(r+1,t.getMonth(),t.getDate()+1);
var h=c(t,e,l);
if(!h.daylight||!h.standard){
h.standard={
offset:t.getTimezoneOffset()*-1};
delete h.daylight
}
h.serverId=["(GMT",AjxTimezone._generateShortName(h.standard.offset,true),") ",AjxTimezone.AUTO_DETECTED].join("");
if(h.daylight&&h.daylight.offset<h.standard.offset){
var n=h.daylight;
h.daylight=h.standard;
h.standard=n
}
return h
};
AjxTimezone._generateShortName=function(n,o){
if(n==0){
return""
}
var t=n<0?"-":"+";
var a=Math.abs(n);
var e=Math.floor(a/60);
var i=a%60;
e=e<10?"0"+e:e;
i=i<10?"0"+i:i;
return[t,e,o?".":"",i].join("")
};
AjxTimezone.DEFAULT_RULE=AjxTimezone._guessMachineTimezone();
(function(){
AjxTimezoneData.TIMEZONE_RULES.sort(AjxTimezone._BY_OFFSET);
for(var e=0;
e<AjxTimezoneData.TIMEZONE_RULES.length;
e++){
var t=AjxTimezoneData.TIMEZONE_RULES[e];
AjxTimezone.addRule(t)
}}
)();
AjxTimezone.DEFAULT=AjxTimezone.getClientId(AjxTimezone.DEFAULT_RULE.serverId)
}
if(AjxPackage.define("ajax.xslt.AjxXslt")){
AjxXslt=function(){
var o=AjxXmlDoc.create();
if(AjxEnv.isIE){
var n=null;
var e=["MSXML2.FreeThreadedDOMDocument.5.0","MSXML2.FreeThreadedDOMDocument.3.0"];
for(var a=0;
a<e.length;
a++){
try{
n=new ActiveXObject(e[a]);
break
}
catch(t){}}
if(!n){
throw new AjxException("FreeThreadedDOMDocument",AjxException.UNSUPPORTED,"AjxXslt")
}
n.async=false;
o._doc=n
}
this._doc=o
};
AjxXslt.prototype.toString=function(){
return"AjxXslt"
};
AjxXslt.createFromUrl=function(e){
var t=new AjxXslt();
t.loadUrl(e);
return t
};
AjxXslt.createFromString=function(t){
var e=new AjxXslt();
e._doc.loadFromString(t);
e.createProcessor();
return e
};
AjxXslt.prototype.createProcessor=function(){
var s=this._doc.getDoc();
if(AjxEnv.isIE){
var n=s.parseError;
if(n.errorCode!=0){
throw new AjxException(n.reason,AjxException.INVALID_PARAM,"AjxXslt.createProcessor")
}
var e=null;
var t=["MSXML2.XSLTemplate.5.0","MSXML2.XSLTemplate.3.0"];
for(var o=0;
o<t.length;
o++){
try{
e=new ActiveXObject(t[o]);
break
}
catch(a){}}
if(!e){
throw new AjxException("XSLTemplate",AjxException.UNSUPPORTED,"AjxXslt.createProcessor")
}
this._processor=e;
if(this._processor){
this._processor.stylesheet=s
}}else{
this._processor=new XSLTProcessor();
if(this._processor){
this._processor.importStylesheet(s)
}}};
AjxXslt._finishedLoading=function(){
var e=this._xslt;
e.createProcessor()
};
AjxXslt.prototype.loadUrl=function(e){
var a=this._doc;
if(AjxEnv.isNav){
var t=a.getDoc();
t._xslt=this;
t.addEventListener("load",AjxXslt._finishedLoading,false)
}
a.loadFromUrl(e);
if(AjxEnv.isIE||AjxEnv.isChrome||AjxEnv.isSafari){
this.createProcessor()
}};
AjxXslt.prototype.transformToDom=function(a){
var e;
if(AjxEnv.isIE){
e=this.transformIE(a)
}else{
return this.transformNav(a)
}
var t=AjxXmlDoc.createFromXml(e);
return t.getDoc()
};
AjxXslt.prototype.transformToString=function(a){
var e;
if(AjxEnv.isIE){
return this.transformIE(a)
}else{
if(AjxEnv.isNav||AjxEnv.isChrome||AjxEnv.isSafari){
e=this.transformNav(a)
}else{
return a.documentElement.innerHTML
}}
if(!e||!e.documentElement){
throw new AjxException("XSL transformation failed.",AjxException.INVALID_PARAM,"AjxXslt.transformToString")
}
var t=e.documentElement;
if((t instanceof HTMLElement)||(t instanceof HTMLHtmlElement)){
return t.innerHTML
}else{
if(t instanceof Element){
return AjxXmlDoc.replaceInvalidChars(t.xml)
}}
return a.documentElement.innerHTML
};
AjxXslt.prototype.transformIE=function(t){
try{
var a=this._processor.createProcessor();
a.input=t;
a.transform();
return a.output
}
catch(e){
throw new AjxException(e.description,AjxException.INVALID_PARAM,"AjxXslt.transformIE")
}};
AjxXslt.prototype.transformNav=function(e){
if(!this._processor){
return""
}
return this._processor.transformToDocument(e)
};
AjxXslt.prototype.transformNav2=function(e){
this._fragment=document.implementation.createDocument("","",null);
if(!this._processor){
return""
}
return this._processor.transformToFragment(e,this._fragment)
}
}
if(AjxPackage.define("ajax.util.AjxSHA1")){
var AjxSHA1=function(){
var f=0;
var v="";
var a=8;
function l(k){
return h(o(w(k),k.length*a))
}
function r(k){
return u(o(w(k),k.length*a))
}
function i(k){
return g(o(w(k),k.length*a))
}
function t(k,x){
return h(n(k,x))
}
function s(k,x){
return u(n(k,x))
}
function d(k,x){
return g(n(k,x))
}
function e(){
return l("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"
}
function o(R,B){
R[B>>5]|=128<<(24-B%32);
R[((B+64>>9)<<4)+15]=B;
var H=Array(80);
var M=1732584193;
var F=-271733879;
var S=-1732584194;
var D=271733878;
var C=-1009589776;
for(var O=0;
O<R.length;
O+=16){
var W=M;
var A=F;
var T=S;
var z=D;
var k=C;
for(var q=0;
q<80;
q++){
if(q<16){
H[q]=R[O+q]
}else{
H[q]=m(H[q-3]^H[q-8]^H[q-14]^H[q-16],1)
}
var I=p(p(m(M,5),y(q,F,S,D)),p(p(C,H[q]),c(q)));
C=D;
D=S;
S=m(F,30);
F=M;
M=I
}
M=p(M,W);
F=p(F,A);
S=p(S,T);
D=p(D,z);
C=p(C,k)
}
return Array(M,F,S,D,C)
}
function y(x,k,j,q){
if(x<20){
return(k&j)|((~k)&q)
}
if(x<40){
return k^j^q
}
if(x<60){
return(k&j)|(k&q)|(j&q)
}
return k^j^q
}
function c(k){
return(k<20)?1518500249:(k<40)?1859775393:(k<60)?-1894007588:-899497514
}
function n(q,T){
var z=w(q);
if(z.length>16){
z=o(z,q.length*a)
}
var k=Array(16),j=Array(16);
for(var x=0;
x<16;
x++){
k[x]=z[x]^909522486;
j[x]=z[x]^1549556828
}
var O=o(k.concat(w(T)),512+T.length*a);
return o(j.concat(O),512+160)
}
function p(k,z){
var j=(k&65535)+(z&65535);
var q=(k>>16)+(z>>16)+(j>>16);
return(q<<16)|(j&65535)
}
function m(k,x){
return(k<<x)|(k>>>(32-x))
}
function w(j){
var q=Array();
var k=(1<<a)-1;
for(var x=0;
x<j.length*a;
x+=a){
q[x>>5]|=(j.charCodeAt(x/a)&k)<<(32-a-x%32)
}
return q
}
function g(q){
var j="";
var k=(1<<a)-1;
for(var x=0;
x<q.length*32;
x+=a){
j+=String.fromCharCode((q[x>>5]>>>(32-a-x%32))&k)
}
return j
}
function h(q){
var x=f?"0123456789ABCDEF":"0123456789abcdef";
var j="";
for(var k=0;
k<q.length*4;
k++){
j+=x.charAt((q[k>>2]>>((3-k%4)*8+4))&15)+x.charAt((q[k>>2]>>((3-k%4)*8))&15)
}
return j
}
function u(z){
var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
var O="";
for(var x=0;
x<z.length*4;
x+=3){
var T=(((z[x>>2]>>8*(3-x%4))&255)<<16)|(((z[x+1>>2]>>8*(3-(x+1)%4))&255)<<8)|((z[x+2>>2]>>8*(3-(x+2)%4))&255);
for(var k=0;
k<4;
k++){
if(x*8+k*6>z.length*32){
O+=v
}else{
O+=q.charAt((T>>6*(3-k))&63)
}}}
return O
}
this.hex_sha1=l;
this.b64_sha1=r;
this.str_sha1=i;
this.hex_hmac_sha1=t;
this.b64_hmac_sha1=s;
this.str_hmac_sha1=d;
this.sha1_vm_test=e
};
AjxSHA1=new AjxSHA1()
}
if(AjxPackage.define("ajax.util.AjxEmailAddress")){
AjxEmailAddress=function(t,o,a,i,n,e){
this.address=t;
this.name=this._setName(a);
this.dispName=i;
this.type=o||AjxEmailAddress.TO;
this.isGroup=n;
this.canExpand=e
};
AjxEmailAddress.prototype.isAjxEmailAddress=true;
AjxEmailAddress.customInvalidEmailPats=[];
AjxEmailAddress.FROM="FROM";
AjxEmailAddress.TO="TO";
AjxEmailAddress.CC="CC";
AjxEmailAddress.BCC="BCC";
AjxEmailAddress.REPLY_TO="REPLY_TO";
AjxEmailAddress.SENDER="SENDER";
AjxEmailAddress.READ_RECEIPT="READ_RECEIPT";
AjxEmailAddress.RESENT_FROM="RESENT_FROM";
AjxEmailAddress.TYPE_STRING={};
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.FROM]="from";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.TO]="to";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.CC]="cc";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.BCC]="bcc";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.REPLY_TO]="replyTo";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.SENDER]="sender";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.READ_RECEIPT]="readReceipt";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.RESENT_FROM]="resentFrom";
AjxEmailAddress.fromSoapType={};
AjxEmailAddress.fromSoapType.f=AjxEmailAddress.FROM;
AjxEmailAddress.fromSoapType.t=AjxEmailAddress.TO;
AjxEmailAddress.fromSoapType.c=AjxEmailAddress.CC;
AjxEmailAddress.fromSoapType.b=AjxEmailAddress.BCC;
AjxEmailAddress.fromSoapType.r=AjxEmailAddress.REPLY_TO;
AjxEmailAddress.fromSoapType.s=AjxEmailAddress.SENDER;
AjxEmailAddress.fromSoapType.n=AjxEmailAddress.READ_RECEIPT;
AjxEmailAddress.fromSoapType.rf=AjxEmailAddress.RESENT_FROM;
AjxEmailAddress.toSoapType={};
AjxEmailAddress.toSoapType[AjxEmailAddress.FROM]="f";
AjxEmailAddress.toSoapType[AjxEmailAddress.TO]="t";
AjxEmailAddress.toSoapType[AjxEmailAddress.CC]="c";
AjxEmailAddress.toSoapType[AjxEmailAddress.BCC]="b";
AjxEmailAddress.toSoapType[AjxEmailAddress.REPLY_TO]="r";
AjxEmailAddress.toSoapType[AjxEmailAddress.SENDER]="s";
AjxEmailAddress.toSoapType[AjxEmailAddress.READ_RECEIPT]="n";
AjxEmailAddress.SEPARATOR="; ";
AjxEmailAddress.DELIMS=[";",",","\n"," "];
AjxEmailAddress.IS_DELIM=AjxUtil.arrayAsHash(AjxEmailAddress.DELIMS);
AjxEmailAddress.addrAnglePat=/(\s*<(((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))>\s*)/;
AjxEmailAddress.addrOnlyPat=/^((((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*))))$/;
AjxEmailAddress.addrAngleQuotePat=/(\s*<'(((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))'>\s*)/;
AjxEmailAddress.addrPat=/(((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))/;
AjxEmailAddress.addrPat1=/(^|"|\s)(((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))/;
AjxEmailAddress.accountPat=/^([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)$/;
AjxEmailAddress.commentPat=/\((.*)\)/g;
AjxEmailAddress.phrasePat=/(((\s*[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\"\s]+\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))+)/;
AjxEmailAddress.boundAddrPat=/(\s*<?(((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F\u0080-\uFFFF()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))>?\s*)$/;
AjxEmailAddress.validateAddress=function(e){
e=AjxStringUtil.trim(e);
return AjxEmailAddress._prelimCheck(e)&&AjxEmailAddress.addrOnlyPat.test(e)
};
AjxEmailAddress.parse=function(s){
var r,t;
var s=AjxStringUtil.trim(s);
var o=AjxEmailAddress._prelimCheck(s);
if(!(o&&s.match(AjxEmailAddress.addrPat))){
return null
}
var n=s.match(AjxEmailAddress.addrAngleQuotePat)||s.match(AjxEmailAddress.addrAnglePat);
if(n&&n.length){
r=n[2];
s=s.replace(AjxEmailAddress.addrAnglePat,"")
}else{
n=s.match(AjxEmailAddress.addrPat1);
if(n&&n.length){
if(n[1]==='"'){
return null
}
var e=s.match(AjxEmailAddress.addrPat);
r=e&&e.length&&e[0]?AjxStringUtil.trim(e[0]):n[0];
s=s.replace(AjxEmailAddress.addrPat,"")
}}
if(!r||!AjxEmailAddress.validateAddress(r)){
return null
}
for(var a=0;
a<AjxEmailAddress.customInvalidEmailPats.length;
a++){
if(AjxEmailAddress.customInvalidEmailPats[a].test(r)){
return null
}}
if(s){
t=AjxStringUtil.trim(s);
t=t.replace(/\\"/g,"&quot;");
t=AjxStringUtil.trim(t,null,'"');
t=t.replace(/&quot;/g,'"')
}
return new AjxEmailAddress(r,null,t)
};
AjxEmailAddress.parseEmailString=function(a,d,u){
var n=new AjxVector();
var t=new AjxVector();
var m=new AjxVector();
var h=AjxEmailAddress.split(a);
for(var r=0;
r<h.length;
r++){
var l=AjxStringUtil.trim(h[r]);
if(l){
var c=AjxEmailAddress.parse(l);
if(!c&&!u){
var f=l;
var s=f.match(AjxEmailAddress.addrAnglePat);
if(s&&s.length){
var e=f.replace(AjxEmailAddress.addrAnglePat,"");
var o=['"',e,'" ',s[0]].join("");
c=AjxEmailAddress.parse(o);
if(c){
c.name=e
}}}
if(c){
c.type=d;
n.add(c);
m.add(c)
}else{
t.add(l);
m.add(new AjxEmailAddress(l))
}}}
return{
good:n,bad:t,all:m}
};
AjxEmailAddress.getValidAddresses=function(t,a,e){
return AjxEmailAddress.parseEmailString(t,a,e).good
};
AjxEmailAddress.isValid=function(e){
return AjxEmailAddress.parse(e)!=null
};
AjxEmailAddress._prelimCheck=function(a){
var e=a.indexOf("@");
var t=a.lastIndexOf(".");
return((e!=-1)&&(t!=-1)&&(t>e)&&(t!=a.length-1))
};
AjxEmailAddress.split=function(p){
p=AjxStringUtil.trim(p);
var f=[];
var g=0,u=0;
var y="",s="";
var r=false;
while(g<p.length){
var a=p.charAt(g);
if((a=='"'||a=="(")&&y!="\\"){
r=true;
s=a;
u=g;
g++;
while(r&&g<p.length){
var a=p.charAt(g);
if(((s=='"'&&a=='"')||(s=="("&&a==")"))&&(y!="\\")){
f.push({
start:u,end:g}
);
r=false
}
g++;
y=a
}}else{
g++
}
y=a
}
if(f.length){
AjxEmailAddress.IS_DELIM[" "]=false
}
u=0;
var d=[];
while(u<p.length){
var t=p.substring(u,p.length);
g=0;
var n=t.length;
while((n==t.length)&&(g<t.length)){
var a=t.charAt(g);
if(AjxEmailAddress.IS_DELIM[a]){
var o=false;
if(a!="\n"){
for(var l=0;
l<f.length;
l++){
var c=f[l];
var e=u+g;
o=(e>=c.start&&e<=c.end);
if(o){
break
}}}
if(!o){
var h=true;
var m=t.substring(0,g);
if(a==","||a==" "){
h=m.match(AjxEmailAddress.boundAddrPat)
}
if(h){
d.push(AjxStringUtil.trim(m));
n=g;
u+=m.length+1
}}
a=p.charAt(u);
while((u<p.length)&&AjxEmailAddress.IS_DELIM[a]){
u++;
a=p.charAt(u)
}
g++
}else{
g++
}}
if(n==t.length){
d.push(AjxStringUtil.trim(t));
u+=t.length+1
}}
AjxEmailAddress.IS_DELIM[" "]=true;
return d
};
AjxEmailAddress.prototype.toString=function(a,i){
if(this.name){
var t=this.name;
if(!a&&!i){
t=t.replace(/\\+"/g,'"');
t=t.replace(/"/g,'\\"')
}
var e=(a||i)?[t]:['"',t,'"'];
if(this.address&&!a){
e.push(" <",this.address,">")
}
return e.join("")
}else{
return this.address
}};
AjxEmailAddress.prototype.getAddress=function(){
return this.address
};
AjxEmailAddress.prototype.setAddress=function(e){
this.address=e
};
AjxEmailAddress.prototype.getType=function(){
return this.type
};
AjxEmailAddress.prototype.setType=function(e){
this.type=e
};
AjxEmailAddress.prototype.getTypeAsString=function(){
return AjxEmailAddress.TYPE_STRING[this.type]
};
AjxEmailAddress.prototype.getName=function(){
return this.name
};
AjxEmailAddress.prototype.getDispName=function(){
return this.dispName
};
AjxEmailAddress.prototype.getText=function(){
return this.getName()||this.getDispName()||this.getAddress()
};
AjxEmailAddress.prototype.clone=function(){
var e=new AjxEmailAddress(this.address,this.type,this.name,this.dispName,this.isGroup,this.canExpand);
e.icon=this.icon;
return e
};
AjxEmailAddress.copy=function(e){
var t=new AjxEmailAddress(e.address,e.type,e.name,e.dispName,e.isGroup,e.canExpand);
t.icon=e.icon;
return t
};
AjxEmailAddress.prototype._setName=function(e){
if(!e){
return""
}
if(e&&e.charAt(0)=="'"&&e.charAt(e.length-1)=="'"){
e=e.substring(1,e.length-1)
}
return e
};
AjxEmailAddress.sortCompareByAddress=function(i,t){
var e=i.getAddress()||"";
var o=t.getAddress()||"";
if(e.toLowerCase()>o.toLowerCase()){
return 1
}
if(e.toLowerCase()<o.toLowerCase()){
return -1
}
return 0
};
AjxEmailAddress.dedup=function(a){
var o=[],t={};
if(a&&a.length){
for(var e=0;
e<a.length;
e++){
var n=a[e];
if(!t[n.address]){
o.push(n)
}
t[n.address]=true
}}
return o
}
}
if(AjxPackage.define("ajax.util.AjxHistoryMgr")){
AjxHistoryMgr=function(){
this.currentLocation=null;
this.listener=null;
this.iframe=null;
this.ignoreLocationChange=null;
this.WAIT_TIME=AjxEnv.isIE?400:200;
this.currentWaitTime=0;
this.ieAtomicLocationChange=null;
this._eventMgr=new AjxEventMgr();
this._evt=new AjxEvent();
this._initialize()
};
AjxHistoryMgr.BLANK_FILE="blankHistory.html";
AjxHistoryMgr.IFRAME_ID="DhtmlHistoryFrame";
AjxHistoryMgr.prototype.addListener=function(e){
return this._eventMgr.addListener(AjxEvent.HISTORY,e)
};
AjxHistoryMgr.prototype.removeListener=function(e){
return this._eventMgr.removeListener(AjxEvent.HISTORY,e)
};
AjxHistoryMgr.prototype.add=function(a){
var e=this;
var t=function(){
if(e.currentWaitTime>0){
e.currentWaitTime=e.currentWaitTime-e.WAIT_TIME
}
a=e._removeHash(a);
if(AjxEnv.isIE){
if(document.getElementById(a)){
throw new DwtException("AjxHistoryMgr: location has same ID as DOM element")
}}
e.ignoreLocationChange=true;
this.ieAtomicLocationChange=true;
e.currentLocation=a;
window.location.hash=a;
if(AjxEnv.isIE){
e.iframe.src=AjxHistoryMgr.BLANK_FILE+"?"+a
}
this.ieAtomicLocationChange=false
};
window.setTimeout(t,this.currentWaitTime);
this.currentWaitTime=this.currentWaitTime+e.WAIT_TIME
};
AjxHistoryMgr.prototype.getCurrentLocation=function(){
return this._removeHash(window.location.hash)
};
AjxHistoryMgr.prototype._initialize=function(){
var e=this.getCurrentLocation();
this.currentLocation=e;
if(AjxEnv.isIE){
var n=[];
var o=0;
n[o++]="<iframe style='border: 0px; width: 1px; ";
n[o++]="height: 1px; position: absolute; bottom: 0px; ";
n[o++]="right: 0px; visibility: visible;' ";
n[o++]="id='"+AjxHistoryMgr.IFRAME_ID+"' ";
n[o++]="src='"+AjxHistoryMgr.BLANK_FILE+"?"+e+"'>";
n[o++]="</iframe>";
var s=document.createElement("div");
document.body.appendChild(s);
s.innerHTML=n.join("")
}
if(AjxEnv.isIE){
this.iframe=document.getElementById(AjxHistoryMgr.IFRAME_ID)
}
var t=this;
var a=function(){
t._checkLocation()
};
window.onhashchange=a
};
AjxHistoryMgr.prototype._checkLocation=function(){
if(!AjxEnv.isIE&&this.ignoreLocationChange){
this.ignoreLocationChange=false;
return
}
if(!AjxEnv.isIE&&this.ieAtomicLocationChange){
return
}
var e=this.getCurrentLocation();
if(e==this.currentLocation){
return
}
this.ieAtomicLocationChange=true;
if(AjxEnv.isIE&&this._getIFrameHash()!=e){
this.iframe.src=AjxHistoryMgr.BLANK_FILE+"?"+e
}else{
if(AjxEnv.isIE){
return
}}
this.currentLocation=e;
this.ieAtomicLocationChange=false;
this._evt.data=e;
this._eventMgr.notifyListeners(AjxEvent.HISTORY,this._evt)
};
AjxHistoryMgr.prototype._getIFrameHash=function(){
var e=document.getElementById(AjxHistoryMgr.IFRAME_ID);
var a=e.contentWindow.document;
var t=new String(a.location.search);
if(t.length==1&&t.charAt(0)=="?"){
t=""
}else{
if(t.length>=2&&t.charAt(0)=="?"){
t=t.substring(1)
}}
return t
};
AjxHistoryMgr.prototype._removeHash=function(e){
if(e==null||e==undefined){
return null
}else{
if(e==""){
return""
}else{
if(e.length==1&&e.charAt(0)=="#"){
return""
}else{
if(e.length>1&&e.charAt(0)=="#"){
return e.substring(1)
}else{
return e
}}}}};
AjxHistoryMgr.prototype.iframeLoaded=function(e){
if(this.ignoreLocationChange){
this.ignoreLocationChange=false;
return
}
var t=new String(e.search);
if(t.length==1&&t.charAt(0)=="?"){
t=""
}else{
if(t.length>=2&&t.charAt(0)=="?"){
t=t.substring(1)
}}
window.location.hash=t;
this._evt.data=t;
this._eventMgr.notifyListeners(AjxEvent.HISTORY,this._evt)
}
}
if(AjxPackage.define("ajax.dwt.core.Dwt")){
Dwt=function(){};
Dwt.STATIC_STYLE="static";
Dwt.ABSOLUTE_STYLE="absolute";
Dwt.RELATIVE_STYLE="relative";
Dwt.FIXED_STYLE="fixed";
Dwt.NO_REPEAT="no-repeat";
Dwt.REPEAT="repeat";
Dwt.REPEAT_X="repeat-x";
Dwt.REPEAT_Y="repeat-y";
Dwt.DISPLAY_INLINE="inline";
Dwt.DISPLAY_BLOCK="block";
Dwt.DISPLAY_NONE="none";
Dwt.DISPLAY_TABLE_ROW="table-row";
Dwt.DISPLAY_TABLE_CELL="table-cell";
Dwt.CLIP=1;
Dwt.VISIBLE=2;
Dwt.SCROLL=3;
Dwt.FIXED_SCROLL=4;
Dwt.SCROLL_Y=5;
Dwt.SCROLL_X=6;
Dwt.Z_HIDDEN=100;
Dwt.Z_CURTAIN=200;
Dwt.Z_VIEW=300;
Dwt.Z_MENU=500;
Dwt.Z_VEIL=600;
Dwt.Z_DIALOG=700;
Dwt.Z_DIALOG_MENU=750;
Dwt.Z_TOOLTIP=775;
Dwt.Z_DND=800;
Dwt.Z_BUSY=900;
Dwt.Z_TOAST=950;
Dwt.Z_SPLASH=1000;
Dwt.DEFAULT=-123456789;
Dwt.CLEAR=-20000;
Dwt.LOC_NOWHERE=-10000;
Dwt.DND_DROP_NONE=0;
Dwt.DND_DROP_COPY=1;
Dwt.DND_DROP_MOVE=2;
Dwt.SCROLLBAR_WIDTH=22;
Dwt.HTML="text/html";
Dwt.TEXT="text/plain";
Dwt.KEY_OBJECT="_object_";
Dwt.KEY_ID="_id_";
Dwt._Z_INC=1;
Dwt.__nextId={};
Dwt.getNextId=function(e){
e=e||"DWT";
if(!Dwt.__nextId[e]){
Dwt.__nextId[e]=1
}
return e+Dwt.__nextId[e]++
};
Dwt.getId=function(e,t){
return e?e.id||(e.id=Dwt.getNextId(t)):null
};
Dwt.associateElementWithObject=function(a,e,t){
a[t||"dwtObj"]=e.__internalId=AjxCore.assignId(e)
};
Dwt.disassociateElementFromObject=function(a,e,t){
if(a){
a.removeAttribute(t||"dwtObj")
}
if(e.__internalId){
AjxCore.unassignId(e.__internalId)
}};
Dwt.getObjectFromElement=function(t,e){
return AjxCore.objectWithId(t[e||"dwtObj"])
};
Dwt.getElement=function(e){
return(typeof(e)=="string")?document.getElementById(e):e
};
Dwt.findAncestor=function(a,t){
var e=Dwt.getAttr(a,t);
while(a&&(e==null||e=="")){
a=a.parentNode;
e=Dwt.getAttr(a,t)
}
return a
};
Dwt.isAncestor=function(t,e){
if(t==e){
return true
}
var a=e;
while(a){
a=a.parentNode;
if(a==t){
return true
}}
return false
};
Dwt.setHandler=function(a,t,e){
if(!(a=Dwt.getElement(a))){
return
}
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
Dwt.clearHandler(a,t)
}
a[t]=e;
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
a.addEventListener("DOMMouseScroll",e,true)
}};
Dwt.clearHandler=function(a,t){
if(!(a=Dwt.getElement(a))){
return
}
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
if(a[t]){
var e=a[t];
a.removeEventListener("DOMMouseScroll",e,true)
}}
a[t]=null
};
Dwt.getBackgroundRepeat=function(e){
if(!(e=Dwt.getElement(e))){
return
}
return DwtCssStyle.getProperty(e,"background-repeat")
};
Dwt.setBackgroundRepeat=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.backgroundRepeat=e
};
Dwt.getBounds=function(o,a){
if(!(o=Dwt.getElement(o))){
return null
}
var i=DwtPoint.tmp;
Dwt.getLocation(o,i);
var t=i.x;
var e=i.y;
Dwt.getSize(o,i);
if(!a){
return new DwtRectangle(t,e,i.x,i.y)
}else{
a.set(t,e,i.x,i.y);
return a
}};
Dwt.setBounds=function(i,t,o,a,e){
if(!(i=Dwt.getElement(i))){
return
}
Dwt.setLocation(i,t,o);
Dwt.setSize(i,a,e)
};
Dwt.getCursor=function(e){
if(!(e=Dwt.getElement(e))){
return""
}
return DwtCssStyle.getProperty(e,"cursor")
};
Dwt.setCursor=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.cursor=e
};
Dwt.getLocation=function(t,e){
if(!(t=Dwt.getElement(t))){
return null
}
e=e||new DwtPoint(0,0);
if(t.style.position==Dwt.ABSOLUTE_STYLE){
e.set(parseInt(DwtCssStyle.getProperty(t,"left")),parseInt(DwtCssStyle.getProperty(t,"top")));
return e
}
return Dwt.toWindow(t,0,0,null,null,e)
};
Dwt.setLocation=function(a,t,i){
if(!(a=Dwt.getElement(a))){
return
}
var e=DwtCssStyle.getProperty(a,"position");
if(e!=Dwt.ABSOLUTE_STYLE&&e!=Dwt.RELATIVE_STYLE&&e!=Dwt.FIXED_STYLE){
throw new DwtException("Static widgets may not be positioned",DwtException.INVALID_OP,"Dwt.setLocation")
}
if(t=Dwt.__checkPxVal(t)){
a.style.left=t
}
if(i=Dwt.__checkPxVal(i)){
a.style.top=i
}};
Dwt.getPosition=function(e){
if(!(e=Dwt.getElement(e))){
return
}
return e.style.position
};
Dwt.setPosition=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.position=e
};
Dwt.getScrollStyle=function(a){
if(!(a=Dwt.getElement(a))){
return""
}
var i=DwtCssStyle.getProperty(a,"overflow");
if(i=="hidden"){
return Dwt.CLIP
}
if(i=="auto"){
return Dwt.SCROLL
}
if(i=="scroll"){
return Dwt.FIXED_SCROLL
}
if(i==""){
var t=DwtCssStyle.getProperty(a,"overflowX");
var e=DwtCssStyle.getProperty(a,"overflowY");
if(t=="scroll"){
return Dwt.SCROLL_X
}
if(e=="scroll"){
return Dwt.SCROLL_Y
}}
return Dwt.VISIBLE
};
Dwt.setScrollStyle=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
if(e==Dwt.CLIP){
t.style.overflow="hidden"
}else{
if(e==Dwt.SCROLL){
t.style.overflow="auto"
}else{
if(e==Dwt.FIXED_SCROLL){
t.style.overflow="scroll"
}else{
if(e==Dwt.SCROLL_Y){
t.style.overflowX="hidden";
t.style.overflowY="auto"
}else{
if(e==Dwt.SCROLL_X){
t.style.overflowY="hidden";
t.style.overflowX="auto"
}else{
t.style.overflow="visible"
}}}}}};
Dwt.getSize=function(i,e,t){
if(!(i=Dwt.getElement(i))){
return
}
var a;
if(!e){
a=new DwtPoint(0,0)
}else{
a=e;
a.set(0,0)
}
if(!i){
return a
}
if(t){
if(i.style.width){
a.x=parseInt(i.style.width)
}
if(i.style.height){
a.y=parseInt(i.style.height)
}
return a
}
a.x=i.offsetWidth;
if(a.x!=null){
a.y=i.offsetHeight
}else{
if(i.clip&&i.clip.width!=null){
a.x=parseInt(i.clip.width);
a.y=parseInt(i.clip.height)
}else{
if(i.style&&i.style.pixelWidth!=null){
a.x=parseInt(i.style.pixelWidth);
a.y=parseInt(i.style.pixelHeight)
}}}
return a
};
Dwt.getOuterSize=function(o,e){
var i=Dwt.getSize(o,e);
if(i&&Dwt.getVisible(o)){
var a=Dwt.getMargins(o);
var t=Dwt.getInsets(o);
i.x+=a.left+a.right+t.left+t.right;
i.y+=a.top+a.bottom+t.top+t.bottom
}
return i
};
Dwt.setSize=function(a,t,e){
if(!(a=Dwt.getElement(a))){
return
}
if(!a.style){
return
}
if(t==Dwt.CLEAR){
a.style.width=null
}else{
if(t=Dwt.__checkPxVal(t,true)){
a.style.width=t
}}
if(e==Dwt.CLEAR){
a.style.height=null
}else{
if(e=Dwt.__checkPxVal(e,true)){
a.style.height=e
}}};
Dwt.getHtmlExtent=function(e){
var t=AjxStringUtil.calcDIV();
t.innerHTML=e;
return Dwt.getSize(t)
};
Dwt.toDocumentFragment=function(a,n){
var o=AjxStringUtil.calcDIV();
o.innerHTML=a;
var t=document.createDocumentFragment();
var e=n&&document.getElementById(n);
if(e){
t.appendChild(e)
}else{
for(var i=o.firstChild;
i;
i=o.firstChild){
t.appendChild(i)
}}
return t
};
Dwt.getAttr=function(a,e,t){
if(!t){
return a&&a.tagName?(a.getAttribute(e)||a[e]):null
}else{
while(a){
if(Dwt.getAttr(a,e)!=null){
return a
}
a=a.parentNode
}
return null
}};
Dwt.getVisible=function(t){
if(!(t=Dwt.getElement(t))){
return
}
var e=DwtCssStyle.getProperty(t,"display");
return(e!=Dwt.DISPLAY_NONE)
};
Dwt.setVisible=function(t,a){
if(!(t=Dwt.getElement(t))){
return
}
if(a){
if(t.nodeName.match(/tr/i)){
t.style.display=Dwt.DISPLAY_TABLE_ROW
}else{
if(t.nodeName.match(/td|th/i)){
t.style.display=Dwt.DISPLAY_TABLE_CELL
}else{
t.style.display=t.getAttribute("x-display")||Dwt.DISPLAY_BLOCK
}}}else{
var e=DwtCssStyle.getComputedStyleObject(t).display;
if(e!="none"){
t.setAttribute("x-display",e)
}
t.style.display=Dwt.DISPLAY_NONE
}};
Dwt.getVisibility=function(t){
if(!(t=Dwt.getElement(t))){
return
}
var e=DwtCssStyle.getProperty(t,"visibility");
return(e=="visible")
};
Dwt.setVisibility=function(e,t){
if(!(e=Dwt.getElement(e))){
return
}
e.style.visibility=t?"visible":"hidden"
};
Dwt.__MSIE_OPACITY_RE=/alpha\(opacity=(\d+)\)/;
Dwt.getOpacity=function(a){
if(!(a=Dwt.getElement(a))){
return
}
if(AjxEnv.isIE&&!AjxEnv.isIE9up){
var t=Dwt.getIEFilter(a,"alpha");
var e=Dwt.__MSIE_OPACITY_RE.exec(t)||[t,"100"];
return Number(e[1])
}
return Number(a.style.opacity||1)*100
};
Dwt.setOpacity=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
if(AjxEnv.isIE&&!AjxEnv.isIE9up){
var a=e<100?"alpha(opacity="+e+")":"";
Dwt.alterIEFilter(t,"alpha",a)
}else{
t.style.opacity=e/100
}};
Dwt.getZIndex=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
if(e){
while(t.style.zIndex===""&&t.parentNode){
t=t.parentNode
}
return t.style.zIndex
}
return DwtCssStyle.getProperty(t,"z-index")
};
Dwt.setZIndex=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.zIndex=e;
if(e<Dwt.Z_VIEW){
t.setAttribute("aria-hidden",true)
}else{
t.removeAttribute("aria-hidden")
}};
Dwt.getDisplay=function(e){
DwtCssStyle.getProperty(e,"display")
};
Dwt.setDisplay=function(t,e){
if(!(t=Dwt.getElement(t))){
return
}
t.style.display=e
};
Dwt.getWindowSize=function(e){
var t=(!e)?new DwtPoint(0,0):e;
if(window.innerWidth){
t.x=window.innerWidth;
t.y=window.innerHeight
}else{
if(AjxEnv.isIE6CSS){
t.x=document.body.parentElement.clientWidth;
t.y=document.body.parentElement.clientHeight
}else{
if(document.body&&document.body.clientWidth){
t.x=document.body.clientWidth;
t.y=document.body.clientHeight
}}}
return t
};
Dwt.toWindow=function(i,s,n,l,r,h){
var t;
if(!h){
t=new DwtPoint(s,n)
}else{
t=h;
t.set(s,n)
}
i=Dwt.getElement(i);
var e=i;
while(e&&e!=l){
t.x+=e.offsetLeft-e.scrollLeft;
t.y+=e.offsetTop;
if(!r){
var a=AjxEnv.isOpera?e.pageYOffset:e.scrollTop;
if(a){
t.y-=a
}
var o=e.parentNode;
while(o!=e.offsetParent&&o!=l){
a=AjxEnv.isOpera?o.pageYOffset:o.scrollTop;
if(a){
t.y-=a
}
o=o.parentNode
}}
e=e.offsetParent
}
return t
};
Dwt.getInsets=function(i){
if(!(i=Dwt.getElement(i))){
return
}
var t=DwtCssStyle.getComputedStyleObject(i);
var a=parseInt(t.borderLeftWidth)||0;
var r=parseInt(t.borderTopWidth)||0;
var h=parseInt(t.borderRightWidth)||0;
var n=parseInt(t.borderBottomWidth)||0;
var o=parseInt(t.paddingLeft)||0;
var l=parseInt(t.paddingTop)||0;
var e=parseInt(t.paddingRight)||0;
var s=parseInt(t.paddingBottom)||0;
return{
left:a+o,top:r+l,right:h+e,bottom:n+s}
};
Dwt.insetBounds=function(t,e){
if(!t){
return null
}
t.x+=e.left;
t.y+=e.top;
t.width-=e.left+e.right;
t.height-=e.top+e.bottom;
return t
};
Dwt.getInsetBounds=function(a){
if(!(a=Dwt.getElement(a))){
return
}
var t=Dwt.getBounds(a);
var e=Dwt.getInsets(a);
return Dwt.insetBounds(t,e)
};
Dwt.getMargins=function(t){
if(!(t=Dwt.getElement(t))){
return
}
var e=DwtCssStyle.getComputedStyleObject(t);
return{
left:parseInt(e.marginLeft)||0,top:parseInt(e.marginTop)||0,right:parseInt(e.marginRight)||0,bottom:parseInt(e.marginBottom)||0}
};
Dwt.getAncestors=function(a,e,t){
var i=[];
if(!e){
e=document.documentElement
}
if(t){
i.push(a)
}
while(a&&a!=e){
i.push(a.parentNode);
a=a.parentNode
}
if(i[i.length-1]!=e){
return null
}
return i
};
Dwt.setStatus=function(e){
window.status=e
};
Dwt.getTitle=function(){
return window.document.title
};
Dwt.setTitle=function(e){
window.document.title=e
};
Dwt.getIframeDoc=function(e){
if(e){
return AjxEnv.isIE?e.contentWindow.document:e.contentDocument
}
return null
};
Dwt.getIframeWindow=function(e){
return e.contentWindow
};
Dwt.parseHtmlFragment=function(o,a){
if(!Dwt._div){
Dwt._div=document.createElement("div")
}
if(a){
o="<table style='table-layout:fixed'>"+o+"</table>"
}
Dwt._div.innerHTML=o;
if(a){
var e=document.createDocumentFragment();
var n=Dwt._div.firstChild.rows;
for(var t=n.length-1;
t>=0;
t--){
e.appendChild(n[0])
}
return e.childNodes.length>1?e:e.firstChild
}
return Dwt._div.firstChild
};
Dwt.contains=function(a,t){
var i=false;
if(a.compareDocumentPosition){
var e=a.compareDocumentPosition(t);
if((e==(document.DOCUMENT_POSITION_CONTAINED_BY|document.DOCUMENT_POSITION_FOLLOWING))){
i=true
}}else{
if(a.contains){
i=a.contains(t)
}}
return i
};
Dwt.removeChildren=function(e){
while(e.hasChildNodes()){
e.removeChild(e.firstChild)
}};
Dwt.getCellIndex=function(t){
if(AjxEnv.isOpera){
if(t.tagName&&t.tagName.toLowerCase()=="td"){
var a=t.parentNode.cells;
var e=a.length;
for(var o=0;
o<e;
o++){
if(a[o]==t){
return o
}}}}else{
return t.cellIndex
}
return -1
};
Dwt.delClass=function(a,e,i){
if(a==null){
return
}
if(!e&&!i){
return
}
if(typeof e=="string"&&e.length){
e=Dwt._DELCLASS_CACHE[e]||(Dwt._DELCLASS_CACHE[e]=new RegExp("\\b"+e+"\\b","ig"))
}
var t=a.className||"";
t=t.replace(e," ");
t=AjxStringUtil.trim(t);
a.className=i?t+" "+i:t
};
Dwt._DELCLASS_CACHE={};
Dwt.addClass=function(e,t){
Dwt.delClass(e,t,t)
};
Dwt.condClass=function(i,o,t,e){
if(!!o){
if(e){
Dwt.delClass(i,e)
}
Dwt.addClass(i,t)
}else{
Dwt.delClass(i,t);
if(e){
Dwt.addClass(i,e)
}}};
Dwt.hasClass=function(t,e){
if(!t||!e){
return false
}
return t.className.match(new RegExp("\\b"+e+"\\b"))
};
Dwt.setSelectionRange=function(a,i,e){
if(a.setSelectionRange){
a.focus();
a.setSelectionRange(i,e)
}else{
if(a.createTextRange){
var t=a.createTextRange();
t.collapse(true);
t.moveStart("character",i);
t.moveEnd("character",e-i);
t.select()
}else{
if(a.select){
a.select()
}}}};
Dwt.getSelectionStart=function(i){
if(AjxUtil.isSpecified(i.selectionStart)){
return i.selectionStart
}else{
if(document.selection){
var a=document.selection.createRange();
var t=a.compareEndPoints("StartToEnd",a)==0;
if(!t){
a.collapse(true)
}
var e=a.getBookmark();
var o=i.createTextRange().getBookmark().charCodeAt(2);
return Math.max(e.charCodeAt(2)-o,0)
}}
return i.value.length
};
Dwt.getSelectionEnd=function(i){
if(AjxUtil.isSpecified(i.selectionEnd)){
return i.selectionEnd
}else{
if(document.selection){
var a=document.selection.createRange();
var t=a.compareEndPoints("StartToEnd",a)==0;
if(!t){
a.collapse(false)
}
var e=a.getBookmark();
var o=i.createTextRange().getBookmark().charCodeAt(2);
return Math.max(e.charCodeAt(2)-o,0)
}}
return i.value.length
};
Dwt.setSelectionText=function(t,o){
var n=Dwt.getSelectionStart(t);
var e=Dwt.getSelectionEnd(t);
var i=t.value;
var a=[i.substr(0,n),o,i.substr(e)].join("");
if(typeof t.setValue=="function"){
t.setValue(a)
}else{
t.value=a
}
Dwt.setSelectionRange(t,n,n+o.length)
};
Dwt.moveCursorToEnd=function(e){
Dwt.setSelectionRange(e,e.value.length,e.value.length)
};
Dwt.instanceOf=function(t,e){
if(typeof t=="string"){
return window[t]&&(t==e||window[t].prototype instanceof window[e])
}
return(window[e]&&t instanceof window[e])
};
Dwt.getParams=function(e,o){
if(!e||e.length===0||(e.length===1&&!e[0])){
return{}
}
if(e.length>1||!AjxUtil.isHash(e[0]._object_||e[0])){
var a={};
for(var t=0;
t<e.length;
t++){
a[o[t]]=e[t]
}
return a
}
if(e.length===1){
return e[0]
}
return{}
};
Dwt.__REM_RE=/^(-?[0-9]+(?:\.[0-9]*)?)rem$/;
Dwt.__checkPxVal=function(t,e){
if(t==Dwt.DEFAULT){
return false
}
if(isNaN(parseInt(t))){
return false
}
if(e&&t<0&&t!=Dwt.LOC_NOWHERE){
t=0
}
if(typeof(t)=="number"){
t=t+"px"
}
if(!AjxEnv.supportsCSS3RemUnits&&Dwt.__REM_RE.test(t)){
t=DwtCssStyle.asPixelCount(t)+"px"
}
return t
};
Dwt.byId=function(o,t){
if(!t){
return(typeof o=="string"?document.getElementById(o):o)
}
if(t==o||t.id==o){
return t
}
for(var e=0;
e<t.childNodes.length;
e++){
if(t.childNodes[e].nodeType==1){
var a=Dwt.byId(o,t.childNodes[e]);
if(a){
return a
}}}
return null
};
Dwt.byTag=function(t,e){
if(!e){
e=document
}
return AjxUtil.toArray(e.getElementsByTagName(t))
};
Dwt.byClassName=function(a,t){
if(!t){
t=document
}
var e;
if(t.getElementsByClassName){
e=t.getElementsByClassName(a)
}else{
e=t.querySelectorAll("."+a)
}
return AjxUtil.toArray(e)
};
Dwt.show=function(t){
var e=Dwt.byId(t);
if(e){
Dwt.setVisible(e,true)
}};
Dwt.hide=function(t){
var e=Dwt.byId(t);
if(e){
Dwt.setVisible(e,false)
}};
Dwt.setText=function(e,t){
e.appendChild(document.createTextNode(t))
};
Dwt.populateText=function(){
if(arguments.length==0){
return
}
var a,e=0,t=arguments.length;
while(e<t){
a=document.getElementById(arguments[e]);
if(a){
Dwt.setText(a,arguments[e+1])
}
e+=2
}};
Dwt.setInnerHtml=function(t,e){
t.innerHTML=e
};
Dwt.setFavIcon=function(r){
var e=null;
if(Dwt._favIconId){
e=document.getElementById(Dwt._favIconId)
}else{
var h=document.getElementsByTagName("head")[0];
var t=h.getElementsByTagName("link");
for(var o=0;
o<t.length;
o++){
var s=t[o];
if(s.rel.toUpperCase()=="SHORTCUT ICON"){
if(!s.id){
s.id=Dwt._favIconId=Dwt.getNextId()
}
e=s;
break
}}}
if(e){
e.href=r;
e.type="image/x-icon";
var n=e.parentNode;
n.removeChild(e);
n.appendChild(e)
}else{
var a=document.createElement("link");
a.id=Dwt._favIconId=Dwt.getNextId();
a.rel="SHORTCUT ICON";
a.href=r;
a.type="image/x-icon";
h=h||document.getElementsByTagName("head")[0];
h.appendChild(a)
}};
Dwt.enableDesignMode=function(a,e){
if(!AjxEnv.isIE){
a.designMode=e?"on":"off"
}else{
var t=a.body;
if(!t||t.contentEditable===undefined){
a.designMode=e?"on":"off"
}else{
t.contentEditable=e?true:false
}}};
Dwt.ffScrollbarCheck=function(a){
if(AjxEnv.isFirefox3_6up||AjxEnv.isDesktop2up){
var e=a.target;
if(e&&(e.clientHeight&&e.scrollHeight&&(e.clientHeight!=e.scrollHeight))||(e.clientWidth&&e.scrollWidth&&(e.clientWidth!=e.scrollWidth))){
a._dontCallPreventDefault=true;
a._stopPropagation=false;
a._returnValue=true;
return true
}}
return false
};
Dwt.selectText=function(t){
if(!t){
Dwt.deselectText();
return
}
if(document.selection){
var e=t.parentTextEdit.createTextRange();
e.moveToElementText(t);
e.select()
}else{
if(window.getSelection){
var e=document.createRange();
e.selectNode(t);
var a=window.getSelection();
a.addRange(e)
}}};
Dwt.deselectText=function(){
if(document.selection){
document.selection.empty()
}else{
if(window.getSelection){
window.getSelection().removeAllRanges()
}}};
Dwt.insertText=function(t,i){
if(!t||!i){
return
}
if(document.selection){
t.focus();
var a=document.selection.createRange();
a.text=i;
t.focus()
}else{
if(AjxUtil.isSpecified(t.selectionStart)){
var o=t.selectionStart,e=t.selectionEnd;
t.value=t.value.substring(0,o)+i+t.value.substring(e,t.value.length);
t.selectionStart=o+i.length;
t.selectionEnd=e+i.length
}else{
t.value+=i
}}};
Dwt.doOverlap=function(n,o){
if(!n||!o){
return false
}
var r=Dwt.getLocation(n),s=Dwt.getLocation(o);
var d=Dwt.getSize(n),c=Dwt.getSize(o);
var m=r.x,u=s.x,l=r.y,h=s.y;
var i=m+d.x,t=u+c.x;
var a=l+d.y,e=h+c.y;
return !(m>t||i<u||l>e||a<h)
};
Dwt.scrollIntoView=function(a,t){
if(!a||!t){
return
}
var e=Dwt.toWindow(a,0,0,null,null,DwtPoint.tmp).y;
var s=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y+t.scrollTop;
var n=e-s;
if(n<0){
t.scrollTop+=n
}else{
var o=Dwt.getSize(t,DwtPoint.tmp).y;
var i=Dwt.getSize(a,DwtPoint.tmp).y;
n=(e+i)-(s+o);
if(n>0){
t.scrollTop+=n
}}};
Dwt.setLoadingTime=function(a,e){
if(!window.isPerfMetric){
return
}
e=e||new Date();
a+="_loading";
var t=document.getElementById(a);
if(!t){
t=document.createElement("div");
t.id=a;
t.style.display="none";
document.body.appendChild(t)
}
t.innerHTML=e.getTime();
if(window.appDevMode){
console.profile(a)
}};
Dwt.setLoadedTime=function(a,e){
if(!window.isPerfMetric){
return
}
e=e||new Date();
a+="_loaded";
var t=document.getElementById(a);
if(!t){
t=document.createElement("div");
t.id=a;
t.style.display="none";
document.body.appendChild(t)
}
t.innerHTML=e.getTime();
if(window.appDevMode){
console.profileEnd()
}};
Dwt.printPerfMetric=function(){
$.each($('div[id*="_loaded"]'),function(a,n){
var e=$(n).attr("id");
var s=e.substring(0,e.indexOf("_"));
var t=$("#"+s+"_launched");
if(t&&t.length>0){
var i=$("#"+s+"_launched").html()
}else{
i=$("#"+s+"_loading").html()
}
var o="Load time for "+s+" is "+($(n).html()-i);
if(console){
console.log(o)
}}
)
};
Dwt.createLinearGradientCss=function(o,t,i){
var e=null;
var a=this.createLinearGradientInfo(o,t,i);
if(a.field){
e=a.field+":"+a.css+";"
}
return e
};
Dwt.createLinearGradientInfo=function(n,a,r){
var s;
var h={};
if(AjxEnv.isIE&&!AjxEnv.isIE9up){
s=(r=="v")?0:1;
h.field="filter";
h.name="DXImageTransform.Microsoft.Gradient";
h.css="progid:"+h.name+"(GradientType="+s+",startColorstr="+n+",endColorstr="+a+"); zoom:1;"
}else{
if(AjxEnv.isIE9){
var i={
x1:"0%",x2:r=="v"?"0%":"100%",y1:"0%",y2:r=="v"?"100%":"0%",startColor:n,endColor:a};
var e=AjxTemplate.expand("dwt.Widgets#SVGGradient",i);
h.field="background";
h.css=("url(data:image/svg+xml,"+escape(e.replace(/\s+/g," "))+")")
}else{
if(AjxEnv.isFirefox3_6up){
s=(r=="v")?"top":"left";
h.field="background";
h.css="-moz-linear-gradient("+s+","+n+", "+a+")"
}else{
if((AjxEnv.isSafari&&AjxEnv.isSafari5_1up)||AjxEnv.isChrome10up){
s=(r=="v")?"top":"left";
h.field="background";
h.css="-webkit-linear-gradient("+s+","+n+", "+a+")"
}else{
if((AjxEnv.isSafari&&AjxEnv.isSafari4up)||AjxEnv.isChrome2up){
var t="left top";
var o=(r=="v")?"left bottom":"right top";
h.field="background";
h.css="-webkit-gradient(linear, "+t+", "+o+", color-stop(0%, "+n+"), color-stop(100%, "+a+"))"
}else{
s=(r=="v")?"to bottom":"to right";
h.field="background";
h.css="linear-gradient("+s+","+n+", "+a+")"
}}}}}
return h
};
Dwt.setLinearGradient=function(o,i,e,a){
var t=Dwt.createLinearGradientInfo(i,e,a);
if(t.field=="filter"){
Dwt.alterIEFilter(o,t.name,t.css)
}else{
o.style[t.field]=t.css
}};
Dwt.alterIEFilter=function(s,t,o){
if(s.style.filter){
var n=false;
var a=s.style.filter.split(" ");
for(var e=0;
e<a.length;
e++){
if(a[e].indexOf(t)!=-1){
a[e]=o;
n=true;
break
}}
if(!n){
a[a.length]=o
}
s.style.filter=a.join(" ")
}else{
s.style.filter=o
}};
Dwt.getIEFilter=function(n,t){
var a="";
if(n.style.filter){
var o=n.style.filter.split(" ");
for(var e=0;
e<o.length;
e++){
if(o[e].indexOf(t)!=-1){
a=o[e];
break
}}}
return a
};
Dwt.getDescendant=function(a,n){
var t=null;
for(var e=0;
e<a.childNodes.length;
e++){
var o=a.childNodes[e];
if(o.id==n){
t=o
}else{
t=Dwt.getDescendant(o,n)
}
if(t!=null){
break
}}
return t
};
Dwt.getPreviousElementSibling=function(e){
var t=e.previousElementSibling;
if(t!==undefined){
return t
}
for(t=e.previousSibling;
t&&t.nodeType!==1;
t=t.previousSibling){}
return t
};
Dwt.getNextElementSibling=function(e){
var t=e.nextElementSibling;
if(t!==undefined){
return t
}
for(t=e.nextSibling;
t&&t.nodeType!==1;
t=t.nextSibling){}
return t
};
Dwt.getScrollbarSizes=function(i){
var o=Dwt.getInsets(i);
var e=DwtCssStyle.getComputedStyleObject(i);
var a=parseInt(e.borderLeftWidth)||0;
var s=parseInt(e.borderTopWidth)||0;
var h=parseInt(e.borderRightWidth)||0;
var n=parseInt(e.borderBottomWidth)||0;
var t=i.offsetWidth-i.clientWidth-a-h;
var r=i.offsetHeight-i.clientHeight-s-n;
return new DwtPoint(t,r)
}
}
if(AjxPackage.define("ajax.dwt.core.DwtId")){
DwtId=function(){};
DwtId.SEP="__";
DwtId.WIDGET_LIST_VIEW="zl";
DwtId.WIDGET_HDR="zlh";
DwtId.WIDGET_HDR_TABLE="zlht";
DwtId.WIDGET_HDR_ICON="zlhi";
DwtId.WIDGET_HDR_LABEL="zlhl";
DwtId.WIDGET_HDR_ARROW="zlha";
DwtId.WIDGET_HDR_SASH="zlhs";
DwtId.WIDGET_ITEM="zli";
DwtId.WIDGET_ITEM_ROW="zlir";
DwtId.WIDGET_ITEM_CELL="zlic";
DwtId.WIDGET_ITEM_FIELD="zlif";
DwtId.LIST_VIEW_HEADERS="headers";
DwtId.LIST_VIEW_ROWS="rows";
DwtId.IFRAME="iframe";
DwtId.DND_PLUS_ID="z__roundPlus";
DwtId.makeId=function(){
var a=[];
for(var t=0;
t<arguments.length;
t++){
var e=arguments[t];
if(e!=null&&e!=""){
a.push(e)
}}
return a.join(DwtId.SEP)
};
DwtId._makeId=DwtId.makeId;
DwtId.getListViewId=function(t,e){
return DwtId.makeId(DwtId.WIDGET_LIST_VIEW,t,e)
};
DwtId.getListViewHdrId=function(t,e,a){
return DwtId.makeId(t,e,a)
};
DwtId.getListViewItemId=function(t,e,i,a){
return DwtId.makeId(t,e,i,a)
};
DwtId.getIframeId=function(e){
return DwtId.makeId(e,DwtId.IFRAME)
}
}
if(AjxPackage.define("ajax.dwt.core.DwtException")){
DwtException=function(a,t,i,e){
if(arguments.length===0){
return
}
AjxException.call(this,a,t,i,e)
};
DwtException.prototype=new AjxException();
DwtException.prototype.constructor=DwtException;
DwtException.prototype.toString=function(){
return"DwtException"
};
DwtException.INVALIDPARENT=-1;
DwtException.INVALID_OP=-2;
DwtException.INTERNAL_ERROR=-3;
DwtException.INVALID_PARAM=-4
}
if(AjxPackage.define("ajax.dwt.core.DwtDraggable")){
DwtDraggable=function(){};
DwtDraggable.dragEl=null;
DwtDraggable.init=function(i,u,n,t,o,e,r,c,d,h,s,l,a){
i.onmousedown=DwtDraggable.__start;
i.__hMode=h?false:true;
i.__vMode=s?false:true;
i.__root=(u&&u!=null)?u:i;
if(i.__hMode&&isNaN(parseInt(i.__root.style.left))){
i.__root.style.left="0px"
}
if(i.__vMode&&isNaN(parseInt(i.__root.style.top))){
i.__root.style.top="0px"
}
if(!i.__hMode&&isNaN(parseInt(i.__root.style.right))){
i.__root.style.right="0px"
}
if(!i.__vMode&&isNaN(parseInt(i.__root.style.bottom))){
i.__root.style.bottom="0px"
}
i.__minX=(typeof n!="undefined")?n:null;
i.__minY=(typeof o!="undefined")?o:null;
i.__maxX=(typeof t!="undefined")?t:null;
i.__maxY=(typeof e!="undefined")?e:null;
i.__xMapper=l?l:null;
i.__yMapper=a?a:null;
i.__root.onDragStart=r;
i.__root.onDragEnd=d;
i.__root.onDrag=c
};
DwtDraggable.setDragBoundaries=function(t,e,i,o,a){
if(t!=null){
if(e!=null){
t.__minX=e
}
if(i!=null){
t.__maxX=i
}
if(o!=null){
t.__minY=o
}
if(a!=null){
t.__maxY=a
}}};
DwtDraggable.__start=function(i){
var a=DwtDraggable.dragEl=this;
i=DwtDraggable.__fixE(i);
var t=parseInt(a.__hMode?a.__root.style.left:a.__root.style.right);
var o=parseInt(a.__vMode?a.__root.style.top:a.__root.style.bottom);
if(a.__root.onDragStart){
a.__root.onDragStart.run([t,o])
}
a.__lastMouseX=i.clientX;
a.__lastMouseY=i.clientY;
if(a.__hMode){
if(a.__minX!=null){
a.__minMouseX=i.clientX-t+a.__minX
}
if(a.__maxX!=null){
a.__maxMouseX=a.__minMouseX+a.__maxX-a.__minX
}}else{
if(a.__minX!=null){
a.__maxMouseX=-a.__minX+i.clientX+t
}
if(a.__maxX!=null){
a.__minMouseX=-a.__maxX+i.clientX+t
}}
if(a.__vMode){
if(a.__minY!=null){
a.__minMouseY=i.clientY-o+a.__minY
}
if(a.__maxY!=null){
a.__maxMouseY=a.__minMouseY+a.__maxY-a.__minY
}}else{
if(a.__minY!=null){
a.__maxMouseY=-a.__minY+i.clientY+o
}
if(a.__maxY!=null){
a.__minMouseY=-a.__maxY+i.clientY+o
}}
document.onmousemove=DwtDraggable.__drag;
document.onmouseup=DwtDraggable.__end;
return false
};
DwtDraggable.__drag=function(s){
s=DwtDraggable.__fixE(s);
var i=DwtDraggable.dragEl;
var o=s.clientY;
var n=s.clientX;
var a=parseInt(i.__hMode?i.__root.style.left:i.__root.style.right);
var h=parseInt(i.__vMode?i.__root.style.top:i.__root.style.bottom);
var t,r;
if(!i.__xMapper){
if(i.__minX!=null){
n=i.__hMode?Math.max(n,i.__minMouseX):Math.min(n,i.__maxMouseX)
}
if(i.__maxX!=null){
n=i.__hMode?Math.min(n,i.__maxMouseX):Math.max(n,i.__minMouseX)
}
t=a+((n-i.__lastMouseX)*(i.__hMode?1:-1))
}else{
t=i.__xMapper(a,n)
}
if(!i.__yMapper){
if(i.__minY!=null){
o=i.__vMode?Math.max(o,i.__minMouseY):Math.min(o,i.__maxMouseY)
}
if(i.__maxY!=null){
o=i.__vMode?Math.min(o,i.__maxMouseY):Math.max(o,i.__minMouseY)
}
r=h+((o-i.__lastMouseY)*(i.__vMode?1:-1))
}else{
r=i.__yMapper(h,o)
}
DwtDraggable.dragEl.__root.style[i.__hMode?"left":"right"]=t+"px";
DwtDraggable.dragEl.__root.style[i.__vMode?"top":"bottom"]=r+"px";
DwtDraggable.dragEl.__lastMouseX=n;
DwtDraggable.dragEl.__lastMouseY=o;
if(DwtDraggable.dragEl.__root.onDrag){
DwtDraggable.dragEl.__root.onDrag.run([t,r])
}
return false
};
DwtDraggable.__end=function(){
document.onmousemove=null;
document.onmouseup=null;
if(DwtDraggable.dragEl.__root.onDragEnd){
DwtDraggable.dragEl.__root.onDragEnd.run([parseInt(DwtDraggable.dragEl.__root.style[DwtDraggable.dragEl.__hMode?"left":"right"]),parseInt(DwtDraggable.dragEl.__root.style[DwtDraggable.dragEl.__vMode?"top":"bottom"])])
}
DwtDraggable.dragEl=null
};
DwtDraggable.__fixE=function(t){
if(typeof t=="undefined"){
t=window.event
}
if(!AjxEnv.isWebKitBased){
if(typeof t.layerX=="undefined"){
t.layerX=t.offsetX
}
if(typeof t.layerY=="undefined"){
t.layerY=t.offsetY
}}
return t
}
}
if(AjxPackage.define("ajax.dwt.core.DwtDragTracker")){
DwtDragTracker=function(){};
DwtDragTracker.init=function(o,t,s,n,h,e,a){
var r=o._dragTrackerContext={};
var i=o.getHtmlElement();
if(t){
i.style.cursor=t
}
r.style=t;
r.threshX=(s>0)?s:1;
r.threshY=(n>0)?n:1;
r.data={
delta:{}
,userData:a};
r.captureObj=new DwtMouseEventCapture({
targetObj:o,mouseOverHdlr:DwtDragTracker._mouseOverHdlr,mouseDownHdlr:DwtDragTracker._mouseDownHdlr,mouseMoveHdlr:DwtDragTracker._mouseMoveHdlr,mouseUpHdlr:DwtDragTracker._mouseUpHdlr,mouseOutHdlr:DwtDragTracker._mouseOutHdlr}
);
o.setHandler(DwtEvent.ONMOUSEDOWN,DwtDragTracker._mouseDownHdlr);
o.setHandler(DwtEvent.ONMOUSEOVER,DwtDragTracker._mouseOverHdlr);
o.setHandler(DwtEvent.ONMOUSEOUT,DwtDragTracker._mouseOutHdlr);
r.callbackFunc=h;
r.callbackObj=e
};
DwtDragTracker.STYLE_NONE="auto";
DwtDragTracker.STYLE_MOVE="move";
DwtDragTracker.STYLE_RESIZE_NORTHWEST="nw-resize";
DwtDragTracker.STYLE_RESIZE_NORTH="n-resize";
DwtDragTracker.STYLE_RESIZE_NORTHEAST="ne-resize";
DwtDragTracker.STYLE_RESIZE_WEST="w-resize";
DwtDragTracker.STYLE_RESIZE_EAST="e-resize";
DwtDragTracker.STYLE_RESIZE_SOUTHWEST="sw-resize";
DwtDragTracker.STYLE_RESIZE_SOUTH="s-resize";
DwtDragTracker.STYLE_RESIZE_SOUTHEAST="se-resize";
DwtDragTracker.STATE_START=1;
DwtDragTracker.STATE_DRAGGING=2;
DwtDragTracker.STATE_END=3;
DwtDragTracker._mouseOverHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtDragTracker._mouseDownHdlr=function(a){
var t=DwtShell.mouseEvent;
t.setFromDhtmlEvent(a,true);
if(t.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(a,true,false);
return false
}
var i=t.dwtObj;
if(i&&i._dragTrackerContext){
var e=i._dragTrackerContext;
if(e.callbackFunc!=null){
e.oldCapture=DwtMouseEventCapture.getCaptureObj();
if(e.oldCapture){
e.oldCapture.release()
}
e.captureObj.capture();
e.data.startDoc={
x:t.docX,y:t.docY};
e.data.state=DwtDragTracker.STATE_START;
DwtDragTracker._doCallback(e,t)
}}
t._stopPropagation=true;
t._returnValue=false;
t.setToDhtmlEvent(a);
return false
};
DwtDragTracker._doCallback=function(e,t){
e.data.mouseEv=t;
if(e.callbackObj!=null){
e.callbackFunc.call(e.callbackObj,e.data)
}else{
e.callbackFunc(e.data)
}
e.data.mouseEv=null
};
DwtDragTracker._mouseMoveHdlr=function(a){
var t=DwtShell.mouseEvent;
t.setFromDhtmlEvent(a);
var o=DwtMouseEventCapture.getTargetObj();
var e=o._dragTrackerContext;
var i=e.data;
i.delta.x=t.docX-i.startDoc.x;
i.delta.y=t.docY-i.startDoc.y;
if(Math.abs(i.delta.x)>=e.threshX||Math.abs(i.delta.y)>=e.threshY){
i.prevState=i.state;
i.state=DwtDragTracker.STATE_DRAGGING;
DwtDragTracker._doCallback(e,t)
}
t._stopPropagation=true;
t._returnValue=false;
t.setToDhtmlEvent(a);
return false
};
DwtDragTracker._mouseUpHdlr=function(a){
var t=DwtShell.mouseEvent;
t.setFromDhtmlEvent(a);
if(t.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(a,true,false);
return false
}
var e=DwtMouseEventCapture.getTargetObj()._dragTrackerContext;
if(e){
if(e.callbackFunc!=null){
DwtMouseEventCapture.getCaptureObj().release()
}
if(e.oldCapture){
e.oldCapture.capture();
e.oldCapture=null
}
e.data.state=DwtDragTracker.STATE_END;
DwtDragTracker._doCallback(e,t)
}
t._stopPropagation=true;
t._returnValue=false;
t.setToDhtmlEvent(a);
return false
};
DwtDragTracker._mouseOutHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtCssStyle")){
DwtCssStyle=function(){};
DwtCssStyle.HOVER="hover";
DwtCssStyle.ACTIVE="active";
DwtCssStyle.SELECTED="selected";
DwtCssStyle.ALT_SELECTED="altSelected";
DwtCssStyle.DISABLED="disabled";
DwtCssStyle.FOCUSED="focused";
DwtCssStyle.ACTIONED="actioned";
DwtCssStyle.MATCHED="matched";
DwtCssStyle.DRAG_OVER="dragOver";
DwtCssStyle.DROPPABLE="droppable";
DwtCssStyle.NOT_DROPPABLE="notDroppable";
DwtCssStyle.DRAG_PROXY="dragProxy";
DwtCssStyle.LINUX="linux";
DwtCssStyle.getProperty=function(r,t){
var e;
if(r.ownerDocument==null){
for(var a=r.parentNode;
a.parentNode!=null;
a=a.parentNode){}
var s=a
}else{
var s=r.ownerDocument
}
if(s.defaultView&&s.defaultView.getComputedStyle){
var n=s.defaultView.getComputedStyle(r,"");
if(n&&n.length>0){
return n.getPropertyValue(t)
}}
var o=t.split("-");
var i=o.shift()+AjxUtil.map(o,AjxStringUtil.capitalize).join("");
if(r.currentStyle){
return r.currentStyle[i]
}else{
if(r.style){
return r.style[i]
}}};
DwtCssStyle.getComputedStyleObject=function(i){
if(i.ownerDocument==null){
for(var t=i.parentNode;
t.parentNode!=null;
t=t.parentNode){}
var a=t
}else{
var a=i.ownerDocument
}
if(a.defaultView){
var e=a.defaultView.getComputedStyle(i,null);
if(!e&&i.style){
i.style.display="";
e=a.defaultView.getComputedStyle(i,null)
}
return e||{}
}else{
if(i.currentStyle){
return i.currentStyle
}else{
if(i.style){
return i.style
}}}};
DwtCssStyle.removeProperty=function(t,a){
if(a instanceof Array){
for(var e=a.length;
--e>=0;
){
DwtCssStyle.removeProperty(t,a[e])
}}else{
if(AjxEnv.isIE){
t.style.removeAttribute(a,true)
}else{
a=a.replace(/([A-Z])/g,"-$1");
t.style.removeProperty(a)
}}};
DwtCssStyle.addRule=function(a,e,i,t){
if(a.addRule){
t=t||(a.rules.length);
a.addRule(e,i,t)
}else{
t=t||(a.cssRules.length);
a.insertRule(e+"{"+i+"}",t)
}
return t
};
DwtCssStyle.removeRule=function(t,e){
if(t.removeRule){
t.removeRule(e)
}else{
t.deleteRule(e)
}};
DwtCssStyle.__PIXEL_RE=/^(-?[0-9]+(?:\.[0-9]*)?)px$/;
DwtCssStyle.__DIMENSION_RE=/^(-?[0-9]+(?:\.[0-9]*)?)([a-z]*|%)$/;
DwtCssStyle.__NUMBER_RE=/^(-?[0-9]+(?:\.[0-9]*)?)+$/;
DwtCssStyle.__getRootFontSize=function(){
var e=DwtCssStyle.getProperty(document.documentElement,"font-size");
if(!DwtCssStyle.__PIXEL_RE.test(e)){
return -1
}
return parseInt(e)
};
DwtCssStyle.asPixelCount=function(o){
if(!o){
return -1
}
var i,a,t;
if(typeof o==="number"||DwtCssStyle.__NUMBER_RE.test(o)){
i=Number(o);
a="px"
}else{
if((t=DwtCssStyle.__DIMENSION_RE.exec(o))){
i=Number(t[1]);
a=t[2]
}else{
return -1
}}
switch(a){
case"rem":var e=DwtCssStyle.__getRootFontSize();
return e!==-1?i*e:-1;
case"mm":i/=10;
case"cm":i/=2.54;
case"in":i*=6;
case"pc":i*=12;
case"pt":i/=0.75;
case"px":return i;
case"ch":case"em":case"ex":return -1;
default:return -1
}}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtPoint")){
DwtPoint=function(e,t){
this.x=e||0;
this.y=t||0
};
DwtPoint.tmp=new DwtPoint(0,0);
DwtPoint.prototype.toString=function(){
return"DwtPoint"
};
DwtPoint.prototype.set=function(e,t){
this.x=e;
this.y=t
}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtRectangle")){
DwtRectangle=function(t,i,a,e){
this.x=t;
this.y=i;
this.width=a;
this.height=e
};
DwtRectangle.prototype.toString=function(){
return"DwtRectangle"
};
DwtRectangle.prototype.set=function(t,i,a,e){
this.x=t;
this.y=i
}
}
if(AjxPackage.define("ajax.dwt.events.DwtEvent")){
DwtEvent=function(e){
if(arguments.length==0){
return
}
this.dwtObj=null
};
DwtEvent.prototype.toString=function(){
return"DwtEvent"
};
DwtEvent.ONCHANGE="onchange";
DwtEvent.ONCLICK="onclick";
DwtEvent.ONCONTEXTMENU="oncontextmenu";
DwtEvent.ONDBLCLICK="ondblclick";
DwtEvent.ONFOCUS="onfocus";
DwtEvent.ONBLUR="onblur";
DwtEvent.ONKEYDOWN="onkeydown";
DwtEvent.ONKEYPRESS="onkeypress";
DwtEvent.ONKEYUP="onkeyup";
DwtEvent.ONMOUSEDOWN="onmousedown";
DwtEvent.ONMOUSEENTER="onmouseenter";
DwtEvent.ONMOUSELEAVE="onmouseleave";
DwtEvent.ONMOUSEMOVE="onmousemove";
DwtEvent.ONMOUSEOUT="onmouseout";
DwtEvent.ONMOUSEOVER="onmouseover";
DwtEvent.ONMOUSEUP="onmouseup";
DwtEvent.ONMOUSEWHEEL="onmousewheel";
DwtEvent.ONSELECTSTART="onselectstart";
DwtEvent.ONSCROLL="onscroll";
DwtEvent.ONPASTE="onpaste";
DwtEvent.ONCUT="oncut";
DwtEvent.ONINPUT="oninput";
DwtEvent.ACTION="ACTION";
DwtEvent.CONTROL="CONTROL";
DwtEvent.DATE_RANGE="DATE_RANGE";
DwtEvent.DISPOSE="DISPOSE";
DwtEvent.ENTER="ENTER";
DwtEvent.HOVEROVER="HOVEROVER";
DwtEvent.HOVEROUT="HOVEROUT";
DwtEvent.POPDOWN="POPDOWN";
DwtEvent.POPUP="POPUP";
DwtEvent.SELECTION="SELECTION";
DwtEvent.TREE="TREE";
DwtEvent.STATE_CHANGE="STATE_CHANGE";
DwtEvent.TAB="TAB";
DwtEvent.XFORMS_READY="xforms-ready";
DwtEvent.XFORMS_DISPLAY_UPDATED="xforms-display-updated";
DwtEvent.XFORMS_VALUE_CHANGED="xforms-value-changed";
DwtEvent.XFORMS_FORM_DIRTY_CHANGE="xforms-form-dirty-change";
DwtEvent.XFORMS_CHOICES_CHANGED="xforms-choices-changed";
DwtEvent.XFORMS_VALUE_ERROR="xforms-value-error";
DwtEvent.XFORMS_INSTANCE_CHANGED="xforms-instance-cahnged";
DwtEvent.KEY_EVENTS=[DwtEvent.ONKEYDOWN,DwtEvent.ONKEYPRESS,DwtEvent.ONKEYUP];
DwtEvent.MOUSE_EVENTS=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]
}
if(AjxPackage.define("ajax.dwt.events.DwtEventManager")){
DwtEventManager=function(){};
DwtEventManager._instance=new AjxEventMgr();
DwtEventManager._domEventToDwtMap={
ondblclick:DwtEvent.ONDBLCLICK,onmousedown:DwtEvent.ONMOUSEDOWN,onmouseup:DwtEvent.ONMOUSEUP,onmousemove:DwtEvent.ONMOUSEMOVE,onmouseout:DwtEvent.ONMOUSEOUT,onmouseover:DwtEvent.ONMOUSEOVER,onselectstart:DwtEvent.ONSELECTSTART,onchange:DwtEvent.ONCHANGE};
DwtEventManager.addListener=function(e,t){
DwtEventManager._instance.addListener(e,t)
};
DwtEventManager.notifyListeners=function(e,t){
DwtEventManager._instance.notifyListeners(e,t)
};
DwtEventManager.removeListener=function(e,t){
DwtEventManager._instance.removeListener(e,t)
}
}
if(AjxPackage.define("ajax.dwt.events.DwtDateRangeEvent")){
DwtDateRangeEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtDateRangeEvent.prototype=new DwtEvent;
DwtDateRangeEvent.prototype.constructor=DwtDateRangeEvent;
DwtDateRangeEvent.prototype.toString=function(){
return"DwtDateRangeEvent"
};
DwtDateRangeEvent.prototype.reset=function(){
this.start=null;
this.end=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtDisposeEvent")){
DwtDisposeEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true)
};
DwtDisposeEvent.prototype=new DwtEvent;
DwtDisposeEvent.prototype.constructor=DwtDisposeEvent;
DwtDisposeEvent.prototype.toString=function(){
return"DwtDisposeEvent"
}
}
if(AjxPackage.define("ajax.dwt.events.DwtUiEvent")){
DwtUiEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtUiEvent.prototype=new DwtEvent;
DwtUiEvent.prototype.constructor=DwtUiEvent;
DwtUiEvent.prototype.isDwtUiEvent=true;
DwtUiEvent.prototype.toString=function(){
return"DwtUiEvent"
};
DwtUiEvent.prototype.reset=function(){
this.dwtObj=null;
this.altKey=false;
this.ctrlKey=false;
this.metaKey=false;
this.shiftKey=false;
this.target=null;
this.type=null;
this.docX=-1;
this.docY=-1;
this.elementX=-1;
this.elementY=-1;
this.ersatz=false;
this._stopPropagation=false;
this._returnValue=true;
this._dontCallPreventDefault=false
};
DwtUiEvent.getEvent=function(t,a){
t=t||window.event;
if(t){
return t
}
if(a){
var e=(a.ownerDocument||a.document||a).parentWindow;
return e?e.event:null
}};
DwtUiEvent.getTarget=function(e,t){
e=DwtUiEvent.getEvent(e);
if(!e){
return null
}
if(!t){
if(e.target){
return(e.target.nodeType==3)?e.target.parentNode:e.target
}else{
if(e.srcElement){
return e.srcElement
}}}else{
if(e.relatedTarget){
return e.relatedTarget
}else{
if(e.toElement){
return e.toElement
}else{
if(e.fromElement){
return e.fromElement
}}}}
return null
};
DwtUiEvent.getTargetWithProp=function(t,n,o,i){
var a=DwtUiEvent.getTarget(t,o);
while(a){
var e=Dwt.getAttr(a,n);
if(e!=null&&e!==""&&(!i||(e==i))){
return a
}
a=a.parentNode
}
return null
};
DwtUiEvent.getTargetWithClass=function(t,e,i){
var a=DwtUiEvent.getTarget(t,i);
while(a&&a.nodeType===1){
if(Dwt.hasClass(a,e)){
return a
}
a=a.parentNode
}
return null
};
DwtUiEvent.getTargetWithProps=function(o,a){
var n=DwtUiEvent.getTarget(o);
while(n){
var t=true;
for(var e in a){
var s=Dwt.getAttr(n,a[e]);
if(s==null||s===""){
n=n.parentNode;
t=false;
break
}}
if(t){
return n
}}
return null
};
DwtUiEvent.copy=function(e,t){
e.altKey=t.altKey;
e.ctrlKey=t.ctrlKey;
e.metaKey=t.metaKey;
e.shiftKey=t.shiftKey;
e.target=t.target;
e.type=t.type;
e.dwtObj=t.dwtObj;
e.docX=t.docX;
e.docY=t.docY;
e.elementX=t.elementX;
e.elementY=t.elementY;
e.ersatz=t.ersatz;
e._stopPropagation=t._stopPropagation;
e._returnValue=t._returnValue
};
DwtUiEvent.prototype.setFromDhtmlEvent=function(t,a){
t=DwtUiEvent.getEvent(t);
if(!t){
return
}
this.altKey=t.altKey;
this.ctrlKey=t.ctrlKey;
this.metaKey=t.metaKey;
this.shiftKey=t.shiftKey;
this.type=t.type;
this.target=DwtUiEvent.getTarget(t);
this.dwtObj=(a===true)?DwtControl.getTargetControl(t):a;
if(t.pageX!=null){
this.docX=t.pageX;
this.docY=t.pageY
}else{
if(t.clientX!=null){
this.docX=t.clientX+document.body.scrollLeft-document.body.clientLeft;
this.docY=t.clientY+document.body.scrollTop-document.body.clientTop;
if(document.body.parentElement){
var e=document.body.parentElement;
this.docX+=e.scrollLeft-e.clientLeft;
this.docY+=e.scrollTop-e.clientTop
}}}
if(t.offsetX!=null){
this.elementX=t.offsetX;
this.elementY=t.offsetY
}else{
if(!AjxEnv.isWebKitBased&&t.layerX!=null){
this.elementX=t.layerX;
this.elementY=t.layerY
}else{
this.elementX=Dwt.DEFAULT;
this.elementY=Dwt.DEFAULT
}}
this.ersatz=false;
return t
};
DwtUiEvent.prototype.setToDhtmlEvent=function(e){
DwtUiEvent.setBehaviour(e,this._stopPropagation,this._returnValue,this._dontCallPreventDefault)
};
DwtUiEvent.setBehaviour=function(o,e,t,a){
var i=DwtUiEvent.getEvent(o);
DwtUiEvent.setDhtmlBehaviour(i,e,t,a)
};
DwtUiEvent.setDhtmlBehaviour=function(i,e,t,a){
i=DwtUiEvent.getEvent(i);
if(!i){
return
}
if(i.stopPropagation!=null){
if(e){
i.stopPropagation()
}
if(!t&&!a){
i.preventDefault()
}}else{
i.returnValue=t;
i.cancelBubble=e
}};
DwtUiEvent.getDwtObjFromEvent=function(e,a){
var t=DwtUiEvent.getTargetWithProp(e,"dwtObj",a);
return t?Dwt.getObjectFromElement(t):null
};
DwtUiEvent.getDwtObjWithProp=function(e,a){
var t=DwtUiEvent.getTargetWithProps(e,["dwtObj",a]);
return t?Dwt.getObjectFromElement(t):null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtControlEvent")){
DwtControlEvent=function(){
this.reset()
};
DwtControlEvent.prototype=new DwtEvent;
DwtControlEvent.prototype.constructor=DwtControlEvent;
DwtControlEvent.RESIZE=1;
DwtControlEvent.MOVE=2;
DwtControlEvent.STATE=4;
DwtControlEvent.prototype.toString=function(){
return"DwtControlEvent"
};
DwtControlEvent.prototype.reset=function(e){
this.oldX=Dwt.DEFAULT;
this.oldY=Dwt.DEFAULT;
this.oldWidth=Dwt.DEFAULT;
this.oldHeight=Dwt.DEFAULT;
this.oldState=null;
this.newX=Dwt.DEFAULT;
this.newY=Dwt.DEFAULT;
this.newWidth=Dwt.DEFAULT;
this.newHeight=Dwt.DEFAULT;
this.newState=null;
this.type=e||null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtFocusEvent")){
DwtFocusEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtFocusEvent.prototype=new DwtEvent;
DwtFocusEvent.prototype.constructor=DwtFocusEvent;
DwtFocusEvent.FOCUS=1;
DwtFocusEvent.BLUR=2;
DwtFocusEvent.prototype.toString=function(){
return"DwtFocusEvent"
};
DwtFocusEvent.prototype.reset=function(){
this.dwtObj=null;
this.state=DwtFocusEvent.FOCUS
}
}
if(AjxPackage.define("ajax.dwt.events.DwtKeyEvent")){
DwtKeyEvent=function(){
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtKeyEvent.prototype.toString=function(){
return"DwtKeyEvent"
};
DwtKeyEvent.prototype.isDwtKeyEvent=true;
DwtKeyEvent.KEY_END_OF_TEXT=3;
DwtKeyEvent.KEY_BACKSPACE=8;
DwtKeyEvent.KEY_TAB=9;
DwtKeyEvent.KEY_RETURN=13;
DwtKeyEvent.KEY_ENTER=DwtKeyEvent.KEY_RETURN;
DwtKeyEvent.KEY_ESCAPE=27;
DwtKeyEvent.KEY_SPACE=32;
DwtKeyEvent.KEY_ARROW_LEFT=37;
DwtKeyEvent.KEY_ARROW_UP=38;
DwtKeyEvent.KEY_ARROW_RIGHT=39;
DwtKeyEvent.KEY_ARROW_DOWN=40;
DwtKeyEvent.KEY_DELETE=46;
DwtKeyEvent.KEY_SEMICOLON=59;
DwtKeyEvent.KEY_SEMICOLON_1=186;
DwtKeyEvent.KEY_COMMA=188;
DwtKeyEvent.KEY_COMMAND=224;
DwtKeyEvent.IS_RETURN={};
DwtKeyEvent.IS_RETURN[DwtKeyEvent.KEY_END_OF_TEXT]=true;
DwtKeyEvent.IS_RETURN[DwtKeyEvent.KEY_RETURN]=true;
DwtKeyEvent.MAC_FF_CODE={};
DwtKeyEvent.MAC_FF_CODE["~"]=192;
DwtKeyEvent.MAC_FF_CODE["!"]=49;
DwtKeyEvent.MAC_FF_CODE["@"]=50;
DwtKeyEvent.MAC_FF_CODE["#"]=51;
DwtKeyEvent.MAC_FF_CODE["$"]=52;
DwtKeyEvent.MAC_FF_CODE["%"]=53;
DwtKeyEvent.MAC_FF_CODE["^"]=54;
DwtKeyEvent.MAC_FF_CODE["&"]=55;
DwtKeyEvent.MAC_FF_CODE["*"]=56;
DwtKeyEvent.MAC_FF_CODE["("]=57;
DwtKeyEvent.MAC_FF_CODE[")"]=48;
DwtKeyEvent.MAC_FF_CODE["-"]=189;
DwtKeyEvent.MAC_FF_CODE._=189;
DwtKeyEvent.MAC_FF_CODE["+"]=187;
DwtKeyEvent.MAC_FF_CODE["|"]=220;
DwtKeyEvent.MAC_FF_CODE[":"]=186;
DwtKeyEvent.MAC_FF_CODE["<"]=188;
DwtKeyEvent.MAC_FF_CODE[">"]=190;
DwtKeyEvent.MAC_FF_CODE["?"]=191;
DwtKeyEvent.prototype=new DwtUiEvent;
DwtKeyEvent.prototype.constructor=DwtKeyEvent;
DwtKeyEvent.isKeyEvent=function(e){
return e.type&&e.type.search(/^key/i)!=-1
};
DwtKeyEvent.isKeyPressEvent=function(e){
return(AjxEnv.isIE&&e.type=="keydown")||(e.type=="keypress")
};
DwtKeyEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.keyCode=0;
this.charCode=0
};
DwtKeyEvent.prototype.isCommand=function(e){
return AjxEnv.isMac&&this.metaKey||this.ctrlKey
};
DwtKeyEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
if(!e){
return
}
this.charCode=e.charCode||e.keyCode;
this.keyCode=e.keyCode
};
DwtKeyEvent.getCharCode=function(t){
t=DwtUiEvent.getEvent(t);
var e=AjxEnv.isSafari?t.keyCode:(t.charCode||t.keyCode);
if(e==0&&AjxEnv.isMac&&AjxEnv.isGeckoBased&&t.type=="keyup"&&DwtKeyEvent._geckoCode){
e=DwtKeyEvent._geckoCode;
DwtKeyEvent._geckoCode=null
}
return e
};
DwtKeyEvent.copy=function(e,t){
DwtUiEvent.copy(e,t);
e.charCode=t.charCode;
e.keyCode=t.keyCode
};
DwtKeyEvent.geckoCheck=function(t){
t=DwtUiEvent.getEvent(t);
if(t.type=="keypress"){
DwtKeyEvent._geckoCode=null;
if(AjxEnv.isMac&&AjxEnv.isGeckoBased){
var e=String.fromCharCode(t.charCode);
DwtKeyEvent._geckoCode=DwtKeyEvent.MAC_FF_CODE[e]
}}}
}
if(AjxPackage.define("ajax.dwt.events.DwtMouseEvent")){
DwtMouseEvent=function(){
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtMouseEvent.prototype=new DwtUiEvent;
DwtMouseEvent.prototype.constructor=DwtMouseEvent;
DwtMouseEvent.prototype.toString=function(){
return"DwtMouseEvent"
};
DwtMouseEvent.NONE=0;
DwtMouseEvent.LEFT=1;
DwtMouseEvent.MIDDLE=2;
DwtMouseEvent.RIGHT=3;
DwtMouseEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.button=0
};
DwtMouseEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
if(!e){
return
}
if(e.which){
switch(e.which){
case 1:this.button=DwtMouseEvent.LEFT;
break;
case 2:this.button=DwtMouseEvent.MIDDLE;
break;
case 3:this.button=DwtMouseEvent.RIGHT;
break;
default:this.button=DwtMouseEvent.NONE
}}else{
if(e.button){
if((e.button&1)!=0){
this.button=DwtMouseEvent.LEFT
}else{
if((e.button&2)!=0){
this.button=DwtMouseEvent.RIGHT
}else{
if((e.button&4)!=0){
this.button=DwtMouseEvent.MIDDLE
}else{
this.button=DwtMouseEvent.NONE
}}}}}
if(AjxEnv.isMac&&this.button){
if(this.ctrlKey&&(this.button==DwtMouseEvent.LEFT||this.button==DwtMouseEvent.RIGHT)){
this.button=DwtMouseEvent.RIGHT;
this.ctrlKey=false
}
if(this.altKey){
this.ctrlKey=true;
this.altKey=false
}}}
}
if(AjxPackage.define("ajax.dwt.events.DwtMouseEventCapture")){
DwtMouseEventCapture=function(e){
e=Dwt.getParams(arguments,DwtMouseEventCapture.PARAMS);
this.targetObj=e.targetObj;
this._id=e.id;
this._mouseOverHdlr=e.mouseOverHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseDownHdlr=e.mouseDownHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseMoveHdlr=e.mouseMoveHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseUpHdlr=e.mouseUpHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseOutHdlr=e.mouseOutHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseWheelHdlr=e.mouseWheelHdlr||DwtMouseEventCapture.emptyHdlr;
this._hardCapture=(e.hardCapture!==false);
this._supportsCapture=(document.body&&document.body.setCapture&&AjxEnv.isIE&&!AjxEnv.isIE9up)
};
DwtMouseEventCapture.PARAMS=["targetObj","id","mouseOverHdlr","mouseDownHdlr","mouseMoveHdlr","mouseUpHdlr","mouseOutHdlr","mouseWheelHdlr","hardCapture"];
DwtMouseEventCapture._capturing=false;
DwtMouseEventCapture.getCaptureObj=function(){
return window._mouseEventCaptureObj
};
DwtMouseEventCapture.getTargetObj=function(){
return window._mouseEventCaptureObj?window._mouseEventCaptureObj.targetObj:null
};
DwtMouseEventCapture.getId=function(){
return window._mouseEventCaptureObj?window._mouseEventCaptureObj._id:null
};
DwtMouseEventCapture.prototype.toString=function(){
return"DwtMouseEventCapture"
};
DwtMouseEventCapture.prototype.capturing=function(){
return DwtMouseEventCapture._capturing
};
DwtMouseEventCapture.prototype.capture=function(){
if(window._mouseEventCaptureObj){
window._mouseEventCaptureObj.release()
}
if(document.body!=null&&document.body.addEventListener!=null){
document.body.addEventListener("mouseover",this._mouseOverHdlr,true);
document.body.addEventListener("mousedown",this._mouseDownHdlr,true);
document.body.addEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.addEventListener("mouseup",this._mouseUpHdlr,true);
document.body.addEventListener("mouseout",this._mouseOutHdlr,true);
document.body.addEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{
this._savedMouseOverHdlr=document.onmouseover;
this._savedMouseDownHdlr=document.onmousedown;
this._savedMouseMoveHdlr=document.onmousemove;
this._savedMouseUpHdlr=document.onmouseup;
this._savedMouseOutHdlr=document.onmouseout;
this._savedMouseWheelHdlr=document.onmousewheel;
document.onmouseover=this._mouseOverHdlr;
document.onmousedown=this._mouseDownHdlr;
document.onmousemove=this._mouseMoveHdlr;
document.onmouseup=this._mouseUpHdlr;
document.onmouseout=this._mouseOutHdlr;
document.onmousewheel=this._mouseWheelHdlr
}
if(this._hardCapture&&this._supportsCapture){
document.body.setCapture(true)
}
window._mouseEventCaptureObj=this;
DwtMouseEventCapture._capturing=true
};
DwtMouseEventCapture.prototype.release=function(){
if(window._mouseEventCaptureObj==null){
return
}
var e=window._shellCaptureObj;
if(document.body&&document.body.addEventListener){
document.body.removeEventListener("mouseover",this._mouseOverHdlr,true);
document.body.removeEventListener("mousedown",this._mouseDownHdlr,true);
document.body.removeEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.removeEventListener("mouseup",this._mouseUpHdlr,true);
document.body.removeEventListener("mouseout",this._mouseOutHdlr,true);
document.body.removeEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{
document.onmouseover=this._savedMouseOverHdlr;
document.onmousedown=this._savedMouseDownHdlr;
document.onmousemove=this._savedMouseMoveHdlr;
document.onmouseup=this._savedMouseUpHdlr;
document.onmouseout=this._savedMouseOutHdlr;
document.onmousewheel=this._savedMouseWheelHdlr
}
if(this._hardCapture&&this._supportsCapture){
document.body.releaseCapture()
}
window._mouseEventCaptureObj=null;
DwtMouseEventCapture._capturing=false
};
DwtMouseEventCapture.emptyHdlr=function(t){
var a=DwtMouseEventCapture.getCaptureObj();
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(a._hardCapture){
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}else{
e._stopPropagation=false;
e._returnValue=true;
e.setToDhtmlEvent(t);
return true
}}
}
if(AjxPackage.define("ajax.dwt.events.DwtListViewActionEvent")){
DwtListViewActionEvent=function(){
DwtMouseEvent.call(this);
this.reset(true)
};
DwtListViewActionEvent.prototype=new DwtMouseEvent;
DwtListViewActionEvent.prototype.constructor=DwtListViewActionEvent;
DwtListViewActionEvent.prototype.toString=function(){
return"DwtListViewActionEvent"
};
DwtListViewActionEvent.prototype.reset=function(e){
if(!e){
DwtMouseEvent.prototype.reset.call(this)
}
this.field=null;
this.item=null;
this.detail=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtSelectionEvent")){
DwtSelectionEvent=function(e){
if(arguments.length==0){
return
}
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtSelectionEvent.prototype=new DwtUiEvent;
DwtSelectionEvent.prototype.constructor=DwtSelectionEvent;
DwtSelectionEvent.prototype.toString=function(){
return"DwtSelectionEvent"
};
DwtSelectionEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.button=0;
this.detail=null;
this.item=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtTreeEvent")){
DwtTreeEvent=function(){
DwtSelectionEvent.call(this,true)
};
DwtTreeEvent.prototype=new DwtSelectionEvent;
DwtTreeEvent.prototype.constructor=DwtTreeEvent;
DwtTreeEvent.prototype.toString=function(){
return"DwtTreeEvent"
};
DwtTreeEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtSelectionEvent.prototype.setFromDhtmlEvent.apply(this,arguments)
}
}
if(AjxPackage.define("ajax.dwt.events.DwtHoverEvent")){
DwtHoverEvent=function(i,a,t,e,o){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.type=i;
this.delay=a;
this.object=t;
this.x=e||-1;
this.y=o||-1
};
DwtHoverEvent.prototype=new DwtEvent;
DwtHoverEvent.prototype.constructor=DwtHoverEvent;
DwtHoverEvent.prototype.toString=function(){
return"DwtHoverEvent"
};
DwtHoverEvent.prototype.reset=function(){
this.type=0;
this.delay=0;
this.object=null;
this.x=-1;
this.y=-1
}
}
if(AjxPackage.define("ajax.dwt.events.DwtOutsideMouseEventMgr")){
DwtOutsideMouseEventMgr=function(){
this._reset();
this._mouseEventListener=DwtOutsideMouseEventMgr._mouseEventHdlr.bind();
DwtOutsideMouseEventMgr.INSTANCE=this;
this.id="DwtOutsideMouseEventMgr"
};
DwtOutsideMouseEventMgr.prototype.isDwtOutsideMouseEventMgr=true;
DwtOutsideMouseEventMgr.prototype.toString=function(){
return"DwtOutsideMouseEventMgr"
};
DwtOutsideMouseEventMgr.EVENTS=[DwtEvent.ONMOUSEDOWN];
DwtOutsideMouseEventMgr.EVENTS_HASH=AjxUtil.arrayAsHash(DwtOutsideMouseEventMgr.EVENTS);
DwtOutsideMouseEventMgr.prototype.startListening=function(o){
if(!(o&&o.outsideListener)){
return
}
var e=o.id;
if(!this._menuCapObj){
var a={
id:this.id,hardCapture:false,mouseDownHdlr:DwtOutsideMouseEventMgr._mouseEventHdlr};
this._menuCapObj=new DwtMouseEventCapture(a)
}
var s=o.elementId||(o.obj&&o.obj.getHTMLElId&&o.obj.getHTMLElId());
var t=this._byId[e];
if(t){
if(s){
t.elementIds.push(s)
}
return
}else{
t=this._byId[e]={
id:e,obj:o.obj,elementIds:[s],outsideListener:o.outsideListener}
}
if(this._numIds==0){
if(AjxEnv.isIE){
var r=DwtShell.getShell(window);
var l=DwtOutsideMouseEventMgr.EVENTS;
r._setEventHdlrs(l);
for(var n=0;
n<l.length;
n++){
var h=l[n];
r.addListener(h,this._mouseEventListener);
DwtEventManager.addListener(h,this._mouseEventListener)
}}
if(!AjxEnv.isIE&&!o.noWindowBlur){
this._savedWindowBlurHandler=window.onblur;
window.onblur=DwtOutsideMouseEventMgr._mouseEventHdlr
}
this._menuCapObj.capture();
this._capturing=true
}
this._numIds++
};
DwtOutsideMouseEventMgr.prototype.stopListening=function(o){
if(typeof o=="string"){
o={
id:o}
}
var e=o.id;
var a=this._byId[e];
if(!a){
return
}
var t=a.elementIds;
var s=o.elementId||(o.obj&&o.obj.getHTMLElId());
if(s){
AjxUtil.arrayRemove(t,s);
if(t.length>0){
return
}}
delete this._byId[e];
this._numIds--;
if(this._numIds==0){
if(AjxEnv.isIE){
var r=DwtShell.getShell(window);
var l=DwtOutsideMouseEventMgr.EVENTS;
r._setEventHdlrs(l,true);
for(var n=0;
n<l.length;
n++){
var h=l[n];
r.removeListener(h,this._mouseEventListener);
DwtEventManager.removeListener(h,this._mouseEventListener)
}}
if(!AjxEnv.isIE&&!o.noWindowBlur){
window.onblur=this._savedWindowBlurHandler
}
this._reset()
}};
DwtOutsideMouseEventMgr.prototype._reset=function(){
if(this._capturing&&(DwtMouseEventCapture.getId()==this.id)){
this._menuCapObj.release();
this._capturing=false
}
this._byId={};
this._numIds=0
};
DwtOutsideMouseEventMgr.forwardEvent=function(a){
if(!a){
return
}
var t=DwtOutsideMouseEventMgr.INSTANCE;
if(!t._numIds){
return
}
var e="on"+a.type;
if(DwtOutsideMouseEventMgr.EVENTS_HASH[e]){
DwtOutsideMouseEventMgr._mouseEventHdlr(a)
}};
DwtOutsideMouseEventMgr._mouseEventHdlr=function(r){
r=DwtUiEvent.getEvent(r);
if(!r){
return
}
var h=DwtOutsideMouseEventMgr.INSTANCE;
var l=DwtUiEvent.getTarget(r);
if(AjxEnv.isGeckoBased&&r&&(r.type=="blur")&&r.target&&r.explicitOriginalTarget&&(r.target!=r.explicitOriginalTarget)){
DwtUiEvent.setBehaviour(r,false,true);
return true
}
for(var e in h._byId){
var s=true;
var t=h._byId[e];
var n=t.elementIds;
for(var o=0;
o<n.length;
o++){
var a=document.getElementById(n[o]);
if(a&&l&&Dwt.isAncestor(a,l)){
s=false;
break
}}
if(s){
t.outsideListener.run(r,t)
}}
DwtUiEvent.setBehaviour(r,false,true);
return true
};
new DwtOutsideMouseEventMgr()
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroupEvent")){
DwtTabGroupEvent=function(){
this.tabGroup=null;
this.newFocusMember=null
};
DwtTabGroupEvent.prototype.toString=function(){
return"DwtTabGroupEvent"
};
DwtTabGroupEvent.prototype.reset=function(){
this.tabGroup=null;
this.newFocusMember=null
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyMap")){
DwtKeyMap=function(e){
if(e){
return
}
this._map={};
this._args={};
this._checkedMap={};
this._load(this._map,AjxKeys);
DwtKeyMap.MOD_ORDER[DwtKeyMap.ALT]=1;
DwtKeyMap.MOD_ORDER[DwtKeyMap.CTRL]=2;
DwtKeyMap.MOD_ORDER[DwtKeyMap.META]=3;
DwtKeyMap.MOD_ORDER[DwtKeyMap.SHIFT]=4
};
DwtKeyMap.prototype.isDwtKeyMap=true;
DwtKeyMap.prototype.toString=function(){
return"DwtKeyMap"
};
DwtKeyMap.ALT="Alt";
DwtKeyMap.CTRL="Ctrl";
DwtKeyMap.META="Meta";
DwtKeyMap.SHIFT="Shift";
DwtKeyMap.deserialize=function(e){
alert("DwtKeyMap.deserialize: NOT IMPLEMENTED")
};
DwtKeyMap.serialize=function(e){
alert("DwtKeyMap.serialize: NOT IMPLEMENTED")
};
DwtKeyMap.MAP_DIALOG="dialog";
DwtKeyMap.MAP_OPTION_DIALOG="optionDialog";
DwtKeyMap.MAP_BUTTON="button";
DwtKeyMap.MAP_LIST="list";
DwtKeyMap.MAP_MENU="menu";
DwtKeyMap.MAP_EDITOR="editor";
DwtKeyMap.MAP_TOOLBAR_HORIZ="toolbarHorizontal";
DwtKeyMap.MAP_TOOLBAR_VERT="toolbarVertical";
DwtKeyMap.MAP_TAB_VIEW="tabView";
DwtKeyMap.MAP_TREE="tree";
DwtKeyMap.IS_MODIFIER={};
DwtKeyMap.MOD_ORDER={};
DwtKeyMap.ARROW_DOWN="ArrowDown";
DwtKeyMap.ARROW_LEFT="ArrowLeft";
DwtKeyMap.ARROW_RIGHT="ArrowRight";
DwtKeyMap.ARROW_UP="ArrowUp";
DwtKeyMap.BACKSLASH="Backslash";
DwtKeyMap.BACKSPACE="Backspace";
DwtKeyMap.COMMA="Comma";
DwtKeyMap.DELETE="Del";
DwtKeyMap.END="End";
DwtKeyMap.ENTER="Enter";
DwtKeyMap.ESC="Esc";
DwtKeyMap.HOME="Home";
DwtKeyMap.PGDOWN="PgDown";
DwtKeyMap.PGUP="PgUp";
DwtKeyMap.SEMICOLON="Semicolon";
DwtKeyMap.SPACE="Space";
DwtKeyMap.TAB="Tab";
DwtKeyMap.ADD_SELECT_NEXT="AddNext";
DwtKeyMap.ADD_SELECT_PREV="AddPrevious";
DwtKeyMap.CANCEL="Cancel";
DwtKeyMap.COLLAPSE="Collapse";
DwtKeyMap.DBLCLICK="DoubleClick";
DwtKeyMap.DELETE="Delete";
DwtKeyMap.EXPAND="Expand";
DwtKeyMap.GOTO_TAB="GoToTab";
DwtKeyMap.HEADER1="Header1";
DwtKeyMap.HEADER2="Header2";
DwtKeyMap.HEADER3="Header3";
DwtKeyMap.HEADER4="Header4";
DwtKeyMap.HEADER5="Header5";
DwtKeyMap.HEADER6="Header6";
DwtKeyMap.INSERT_LINK="InsertLink";
DwtKeyMap.JUSTIFY_CENTER="CenterJustify";
DwtKeyMap.JUSTIFY_LEFT="LeftJustify";
DwtKeyMap.JUSTIFY_RIGHT="RightJustify";
DwtKeyMap.NEXT="Next";
DwtKeyMap.NEXT_TAB="NextTab";
DwtKeyMap.NO="No";
DwtKeyMap.PAGE_UP="PageUp";
DwtKeyMap.PAGE_DOWN="PageDown";
DwtKeyMap.PARENTMENU="ParentMenu";
DwtKeyMap.PREV="Previous";
DwtKeyMap.PREV_TAB="PreviousTab";
DwtKeyMap.SELECT_ALL="SelectAll";
DwtKeyMap.SELECT="Select";
DwtKeyMap.SELECT_CURRENT="SelectCurrent";
DwtKeyMap.SELECT_FIRST="SelectFirst";
DwtKeyMap.SELECT_LAST="SelectLast";
DwtKeyMap.SELECT_NEXT="SelectNext";
DwtKeyMap.SELECT_PREV="SelectPrevious";
DwtKeyMap.SUBMENU="SubMenu";
DwtKeyMap.SWITCH_MODE="SwitchMode";
DwtKeyMap.TEXT_BOLD="Bold";
DwtKeyMap.TEXT_ITALIC="Italic";
DwtKeyMap.TEXT_UNDERLINE="Underline";
DwtKeyMap.TEXT_STRIKETHRU="Strikethru";
DwtKeyMap.YES="Yes";
DwtKeyMap.GOTO_TAB_RE=new RegExp(DwtKeyMap.GOTO_TAB+"(\\d+)");
DwtKeyMap.JOIN="+";
DwtKeyMap.SEP=",";
DwtKeyMap.INHERIT="INHERIT";
DwtKeyMap.prototype.getMap=function(){
return this._map
};
DwtKeyMap.prototype._load=function(w,h){
var m=AjxEnv.platform.toLowerCase();
for(var r in h){
var d=r.split(".");
var s=d[d.length-1];
if(s==="win"||s==="mac"||s==="linux"){
if(s===m){
var g=d.slice(0,d.length-1).join(".");
h[g]=h[r]
}
h[r]=null
}
var n=AjxStringUtil.trim(h[r]);
if(d[2]&&d[2]==="keycode"&&n&&n.indexOf("{")!==-1){
h[r]=n.replace(/\{(\w)(\w+)\}/g,function(i,k,p){
return k.toUpperCase()+p
}
)
}}
for(var r in h){
var n=AjxStringUtil.trim(h[r]);
if(!n||(typeof h[r]!="string")){
continue
}
var d=r.split(".");
var e=d[d.length-1];
var t=(d.length==2);
var u=t?null:d[1];
if(d[0]=="keys"){
this._processKeyDef(u,e,n);
continue
}
if(e!=DwtKeyMap.INHERIT&&e!="keycode"){
continue
}
var c=d[0];
if((this._checkedMap[c]===false)||(!this._checkedMap[c]&&!this._checkMap(c))){
continue
}
if(!w[c]){
w[c]={}
}
if(!this._checkAction(c,u)){
continue
}
var o=n.split(/\s*;\s*/);
for(var f=0;
f<o.length;
f++){
var v=this._canonicalize(o[f]);
if(e==DwtKeyMap.INHERIT){
var y=v.split(/\s*,\s*/);
var a=[];
for(var l=0;
l<y.length;
l++){
a[l]=y[l]
}
w[c][d[1]]=a.join(",")
}else{
if(e=="keycode"){
w[c][v]=u
}}}}};
DwtKeyMap.prototype._checkMap=function(t){
var e=true;
this._checkedMap[t]=e;
return e
};
DwtKeyMap.prototype._checkAction=function(e,t){
return true
};
DwtKeyMap.prototype._processKeyDef=function(e,a,t){
if(!e||!a||!t){
return
}
if(a=="keycode"){
DwtKeyMap.IS_MODIFIER[t]=true
}};
DwtKeyMap.prototype._canonicalize=function(r){
var n=r.split(DwtKeyMap.SEP);
var e=[];
for(var a=0;
a<n.length;
a++){
var t=n[a];
var s=t.split(DwtKeyMap.JOIN);
if(s.length>2){
var o=s.slice(0,s.length-1);
o.sort(function(c,h){
var l=DwtKeyMap.MOD_ORDER[c]||0;
var i=DwtKeyMap.MOD_ORDER[h]||0;
return Number(l-i)
}
);
o.push(s[s.length-1]);
e.push(o.join(DwtKeyMap.JOIN))
}else{
e.push(t)
}}
return e.join(",")
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyMapMgr")){
DwtKeyMapMgr=function(a){
var t=this._map=a.getMap();
this._args=a._args;
this._fsas={};
for(var e in t){
this._fsas[e]=DwtKeyMapMgr.__buildFSA({}
,t[e],e)
}};
DwtKeyMapMgr.prototype.toString=function(){
return"DwtKeyMapMgr"
};
DwtKeyMapMgr.prototype.isDwtKeyMapMgr=true;
DwtKeyMapMgr.NOT_A_TERMINAL=-999;
DwtKeyMapMgr.TAB_KEYCODE=DwtKeyEvent.KEY_TAB;
DwtKeyMapMgr.prototype.getActionCode=function(a,s,r){
var e=this._fsas[s];
if(!e){
return null
}
var n=a.length;
var l=e;
var h;
for(var t=0;
t<n&&l;
t++){
h=a[t];
if(!l||!l[h]){
break
}
if(t<n-1){
l=l[h].subMap
}}
if(l&&l[h]){
var o=l[h];
if(!o.subMap||r){
var i=this.__getInheritedActionCode(a,e,r);
return i==DwtKeyMapMgr.NOT_A_TERMINAL?DwtKeyMapMgr.NOT_A_TERMINAL:(o.actionCode||i)
}else{
return DwtKeyMapMgr.NOT_A_TERMINAL
}}else{
return this.__getInheritedActionCode(a,e,r)
}};
DwtKeyMapMgr.prototype.getAction=function(t,e){
return this._map[t][e]
};
DwtKeyMapMgr.prototype.getKeySequences=function(t,a){
var e=[];
for(var i in this._map[t]){
if(this._map[t][i]==a){
e.push(i)
}}
return e
};
DwtKeyMapMgr.prototype.setMapping=function(t,e,a){
this._map[t][e]=a
};
DwtKeyMapMgr.prototype.removeMapping=function(t,e){
delete this._map[t][e]
};
DwtKeyMapMgr.prototype.replaceMapping=function(a,e,t){
var i=this._map[a][e];
if(!i){
return
}
this.removeMapping(a,e);
this.setMapping(a,t,i)
};
DwtKeyMapMgr.prototype.setArg=function(t,a,e){
if(!this._args[t]){
this._args[t]={}
}
this._args[t][a]=e
};
DwtKeyMapMgr.prototype.removeArg=function(e,t){
delete this._args[e][t]
};
DwtKeyMapMgr.prototype.getArg=function(e,t){
return this._args[e]?this._args[e][t]:null
};
DwtKeyMapMgr.prototype.reloadMap=function(e){
this._fsas[e]=DwtKeyMapMgr.__buildFSA({}
,this._map[e],e)
};
DwtKeyMapMgr.prototype.getAncestors=function(o,n){
n=n||[];
var e=this._fsas[o];
var t=e&&e.inherit;
if(t&&t.length){
for(var a=0;
a<t.length;
a++){
n.push(t[a]);
n=this.getAncestors(t[a],n)
}}
return n
};
DwtKeyMapMgr.isInputElement=function(a){
if(!a){
return false
}
var t=a.ownerDocument?a.ownerDocument.designMode:null;
if(t&&(t.toLowerCase()=="on")){
return true
}
var e=a.tagName.toUpperCase();
return(e=="INPUT"||e=="TEXTAREA")
};
DwtKeyMapMgr.__buildFSA=function(l,e,n){
for(var a in e){
if(a==DwtKeyMap.INHERIT){
l.inherit=e[a].split(/\s*,\s*/);
continue
}
var o=a.split(DwtKeyMap.SEP);
var s=o.length;
var h=l;
for(var t=0;
t<s;
t++){
var r=o[t];
if(!h[r]){
h[r]={}
}
if(t==s-1){
h[r].actionCode=e[a]
}else{
if(!h[r].subMap){
h[r].subMap={}
}
h=h[r].subMap
}}}
return l
};
DwtKeyMapMgr.prototype.__getInheritedActionCode=function(s,t,n){
if(t.inherit&&t.inherit.length){
var o=null;
var e=t.inherit.length;
for(var a=0;
a<e;
a++){
o=this.getActionCode(s,t.inherit[a],n);
if(o!=null){
return o
}}}
return null
};
DwtKeyMapMgr.hasModifier=function(e){
return(e.altKey||e.ctrlKey||e.metaKey)
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyboardMgr")){
DwtKeyboardMgr=function(e){
DwtKeyboardMgr.__shell=e;
this.__kbEventStatus=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
this.__keyTimeout=DwtKeyboardMgr.SHORTCUT_TIMEOUT;
this.__tabGrpStack=[];
this.__currTabGroup=null;
this.__tabGroupChangeListenerObj=this.__tabGrpChangeListener.bind(this);
this.__shortcutsEnabled=false;
this.__defaultHandlerStack=[];
this.__currDefaultHandler=null;
this.__killKeySeqTimedAction=new AjxTimedAction(this,this.__killKeySequenceAction);
this.__killKeySeqTimedActionId=-1;
this.__keySequence=[];
this._evtMgr=new AjxEventMgr();
Dwt.setHandler(document,DwtEvent.ONKEYDOWN,DwtKeyboardMgr.__keyDownHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYUP,DwtKeyboardMgr.__keyUpHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYPRESS,DwtKeyboardMgr.__keyPressHdlr)
};
DwtKeyboardMgr.prototype.isDwtKeyboardMgr=true;
DwtKeyboardMgr.prototype.toString=function(){
return"DwtKeyboardMgr"
};
DwtKeyboardMgr.SHORTCUT_TIMEOUT=750;
DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED="NOT HANDLED";
DwtKeyboardMgr.__KEYSEQ_HANDLED="HANDLED";
DwtKeyboardMgr.__KEYSEQ_PENDING="PENDING";
DwtKeyboardMgr.IS_INPUT_SHORTCUT_KEY=AjxUtil.arrayAsHash([DwtKeyEvent.KEY_END_OF_TEXT,DwtKeyEvent.KEY_RETURN,DwtKeyEvent.KEY_ARROW_LEFT,DwtKeyEvent.KEY_ARROW_UP,DwtKeyEvent.KEY_ARROW_RIGHT,DwtKeyEvent.KEY_ARROW_DOWN]);
DwtKeyboardMgr.isPossibleInputShortcut=function(e){
var t=DwtUiEvent.getTarget(e);
return !DwtKeyMap.IS_MODIFIER[e.keyCode]&&(e.keyCode===DwtKeyEvent.KEY_ESCAPE||DwtKeyMapMgr.hasModifier(e)||(t&&t.nodeName.toLowerCase()=="input"&&DwtKeyboardMgr.IS_INPUT_SHORTCUT_KEY[e.keyCode]))
};
DwtKeyboardMgr.prototype.pushTabGroup=function(t,a){
if(!(t&&t.isDwtTabGroup)){
return
}
this.__tabGrpStack.push(t);
this.__currTabGroup=t;
var e=t.getFocusMember();
if(!e){
e=t.resetFocusMember(true)
}
if(!e){
return
}
t.addFocusChangeListener(this.__tabGroupChangeListenerObj);
if(!a){
this.grabFocus(e)
}};
DwtKeyboardMgr.prototype.popTabGroup=function(r){
if(!(r&&r.isDwtTabGroup)){
return null
}
if(this.__tabGrpStack.length<=1){
return null
}
if(r&&this.__tabGrpStack[this.__tabGrpStack.length-1]!=r){
var t=this.__tabGrpStack;
var e=t.length;
for(var s=e-1;
s>=0;
s--){
if(r==t[s]){
t[s].dump(AjxDebug.DBG1);
break
}}
if(s<0){
return null
}else{
if(s!=e-1){
t.splice(s,1);
return r
}}}
var r=this.__tabGrpStack.pop();
r.removeFocusChangeListener(this.__tabGroupChangeListenerObj);
var n=null;
if(this.__tabGrpStack.length>0){
n=this.__tabGrpStack[this.__tabGrpStack.length-1];
var o=n.getFocusMember();
if(!o){
o=n.resetFocusMember(true)
}
if(o){
this.grabFocus(o)
}}
this.__currTabGroup=n;
return r
};
DwtKeyboardMgr.prototype.setTabGroup=function(t){
var e=this.popTabGroup();
this.pushTabGroup(t);
return e
};
DwtKeyboardMgr.prototype.getCurrentTabGroup=function(){
return this.__currTabGroup
};
DwtKeyboardMgr.prototype.pushDefaultHandler=function(e){
if(!this.isEnabled()||!e){
return
}
this.__defaultHandlerStack.push(e);
this.__currDefaultHandler=e
};
DwtKeyboardMgr.prototype.popDefaultHandler=function(){
if(this.__defaultHandlerStack.length<=1){
return null
}
var e=this.__defaultHandlerStack.pop();
this.__currDefaultHandler=this.__defaultHandlerStack[this.__defaultHandlerStack.length-1];
return e
};
DwtKeyboardMgr.prototype.grabFocus=function(e){
if(typeof e==="string"){
e=document.getElementById(e)
}else{
if(e&&e.isDwtTabGroup){
e=e.getFocusMember()||e.getFirstMember()
}}
if(!e){
return
}
if(this.__currTabGroup){
this.__currTabGroup.setFocusMember(e,false,true)
}
this.__doGrabFocus(e)
};
DwtKeyboardMgr.prototype.updateFocus=function(e,a){
if(!e){
return
}
var i=this.__currTabGroup;
if(i){
this.__currTabGroup.__showFocusedItem(e,"updateFocus")
}
var o=e.isDwtControl?e:DwtControl.findControl(e);
if(o){
this.__focusObj=o
}
var t=this._findTabGroupMember(a||e);
if(t&&i){
i.setFocusMember(t,false,true)
}};
DwtKeyboardMgr.prototype._findTabGroupMember=function(s){
var i=this.__currTabGroup;
if(!s||!i){
return
}
var a=(s.isDwtControl&&s.getHtmlElement())||DwtUiEvent.getTarget(s,false)||s;
try{
while(a){
if(i.contains(a)){
return a
}else{
var n=DwtControl.ALL_BY_ID[a.id];
if(n&&i.contains(n)){
return n
}else{
var t=n&&n.getTabGroupMember&&n.getTabGroupMember();
if(t&&i.contains(t)){
return t
}}}
a=a.parentNode
}}
catch(o){}
return null
};
DwtKeyboardMgr.prototype.getFocusObj=function(e){
return this.__focusObj
};
DwtKeyboardMgr.prototype.registerDefaultKeyActionHandler=function(e){
if(this.isEnabled()){
this.__defaultKeyActionHdlr=e
}};
DwtKeyboardMgr.prototype.registerKeyMap=function(e){
if(this.isEnabled()){
this.__keyMapMgr=new DwtKeyMapMgr(e)
}};
DwtKeyboardMgr.prototype.setKeyTimeout=function(e){
this.__keyTimeout=e
};
DwtKeyboardMgr.prototype.clearKeySeq=function(){
this.__killKeySeqTimedActionId=-1;
this.__keySequence=[]
};
DwtKeyboardMgr.prototype.enable=function(e){
this.__shortcutsEnabled=e
};
DwtKeyboardMgr.prototype.isEnabled=function(){
return this.__shortcutsEnabled
};
DwtKeyboardMgr.prototype.addListener=function(e,t){
this._evtMgr.addListener(e,t)
};
DwtKeyboardMgr.prototype.removeListener=function(e,t){
this._evtMgr.removeListener(e,t)
};
DwtKeyboardMgr.prototype.__doGrabFocus=function(e){
if(!e){
return
}
var t=this.getFocusObj();
if(t&&t.blur){
t.blur()
}
if(e.focus){
this.updateFocus(e.focus()||e)
}};
DwtKeyboardMgr.__keyUpHdlr=function(e){
e=DwtUiEvent.getEvent(e);
var t=DwtKeyboardMgr.__shell.getKeyboardMgr();
if(t._evtMgr.notifyListeners(DwtEvent.ONKEYUP,e)===false){
return false
}
if(AjxEnv.isMac&&AjxEnv.isGeckoBased&&e.keyCode===0){
return DwtKeyboardMgr.__keyDownHdlr(e)
}else{
return DwtKeyboardMgr.__handleKeyEvent(e)
}};
DwtKeyboardMgr.__keyPressHdlr=function(e){
e=DwtUiEvent.getEvent(e);
var t=DwtKeyboardMgr.__shell.getKeyboardMgr();
if(t._evtMgr.notifyListeners(DwtEvent.ONKEYPRESS,e)===false){
return false
}
DwtKeyEvent.geckoCheck(e);
return DwtKeyboardMgr.__handleKeyEvent(e)
};
DwtKeyboardMgr.__handleKeyEvent=function(e){
if(DwtKeyboardMgr.__shell._blockInput){
return false
}
e=DwtUiEvent.getEvent(e,this);
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
var t=DwtShell.keyEvent;
t.setFromDhtmlEvent(e);
if(a.__kbEventStatus!=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED){
return a.__processKeyEvent(e,t,false)
}};
DwtKeyboardMgr.__keyDownHdlr=function(l){
try{
l=DwtUiEvent.getEvent(l,this);
var e=DwtKeyboardMgr.__shell.getKeyboardMgr();
l.focusObj=null;
if(e._evtMgr.notifyListeners(DwtEvent.ONKEYDOWN,l)===false){
return false
}
if(DwtKeyboardMgr.__shell._blockInput){
return false
}
var d=DwtShell.keyEvent;
d.setFromDhtmlEvent(l);
var c=DwtKeyEvent.getCharCode(l);
DwtKeyboardMgr.__shell.getToolTip().popdown();
var h=e.__currTabGroup,o;
if(c==DwtKeyEvent.KEY_TAB){
if(h&&!DwtKeyMapMgr.hasModifier(d)){
if(h.getFocusMember()){
o=d.shiftKey?h.getPrevFocusMember(true):h.getNextFocusMember(true)
}else{
o=h.resetFocusMember(true)
}}
return e.__processKeyEvent(l,d,!o,o?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}else{
if(h&&AjxEnv.isGecko&&d.target instanceof HTMLHtmlElement){
o=h.resetFocusMember(true)
}}
if(!e.isEnabled()){
return true
}
if(DwtKeyMap.IS_MODIFIER[c]||(e.__killKeySeqTimedActionId===-1&&d.target&&DwtKeyMapMgr.isInputElement(d.target)&&!d.target["data-hidden"]&&!DwtKeyboardMgr.isPossibleInputShortcut(d))){
return e.__processKeyEvent(l,d,true,DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}
if(e.__killKeySeqTimedActionId!=-1){
AjxTimedAction.cancelAction(e.__killKeySeqTimedActionId);
e.__killKeySeqTimedActionId=-1
}
var a=[];
if(d.altKey){
a.push(DwtKeyMap.ALT)
}
if(d.ctrlKey){
a.push(DwtKeyMap.CTRL)
}
if(d.metaKey){
a.push(DwtKeyMap.META)
}
if(d.shiftKey){
a.push(DwtKeyMap.SHIFT)
}
a.push(c);
e.__keySequence[e.__keySequence.length]=a.join(DwtKeyMap.JOIN);
var s=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
var i=l.focusObj||e.__focusObj;
var t=i&&i.hasFocus&&i.hasFocus();
if(t&&i.handleKeyAction){
s=e.__dispatchKeyEvent(i,d);
while((s===DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)&&i.parent){
i=i.parent;
if(i.getKeyMapName){
s=e.__dispatchKeyEvent(i,d)
}}}
if(s===DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED&&e.__currDefaultHandler){
s=e.__dispatchKeyEvent(e.__currDefaultHandler,d)
}
if(d.forcePropagate){
s=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
d.forcePropagate=false
}
e.__kbEventStatus=s;
var n=(s==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED);
if(s!=DwtKeyboardMgr.__KEYSEQ_PENDING){
e.clearKeySeq()
}
return e.__processKeyEvent(l,d,n)
}
catch(r){
AjxException.reportScriptError(r)
}};
DwtKeyboardMgr.prototype.__dispatchKeyEvent=function(o,n,a){
if(o&&o.handleKeyEvent){
var s=o.handleKeyEvent(n);
return s?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var i=(o&&o.getKeyMapName)?o.getKeyMapName():null;
if(!i){
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var t=this.__keyMapMgr.getActionCode(this.__keySequence,i,a);
if(t===DwtKeyMapMgr.NOT_A_TERMINAL){
this.__hdlr=o;
this.__mapName=i;
this.__ev=n;
this.__killKeySeqTimedActionId=AjxTimedAction.scheduleAction(this.__killKeySeqTimedAction,this.__keyTimeout);
return DwtKeyboardMgr.__KEYSEQ_PENDING
}else{
if(t!=null){
if(!o.handleKeyAction){
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var e=o.handleKeyAction(t,n);
return e?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}else{
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}}};
DwtKeyboardMgr.prototype.__killKeySequenceAction=function(){
this.__dispatchKeyEvent(this.__hdlr,this.__ev,true);
this.clearKeySeq()
};
DwtKeyboardMgr.prototype.__tabGrpChangeListener=function(e){
this.__doGrabFocus(e.newFocusMember)
};
DwtKeyboardMgr.prototype.__processKeyEvent=function(a,i,e,t){
if(t){
this.__kbEventStatus=t
}
i._stopPropagation=!e;
i._returnValue=e;
i.setToDhtmlEvent(a);
return e
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroup")){
DwtTabGroup=function(e){
this.__members=new AjxVector();
this.__parent=null;
this.__name=e;
this.__currFocusMember=null;
this.__evtMgr=new AjxEventMgr();
DwtTabGroup.BY_NAME[e]=this
};
DwtTabGroup.prototype.isDwtTabGroup=true;
DwtTabGroup.prototype.toString=function(){
return"DwtTabGroup"
};
DwtTabGroup.NOT_ROOT_TABGROUP="NOT ROOT TAB GROUP";
DwtTabGroup.__changeEvt=new DwtTabGroupEvent();
DwtTabGroup.getByName=function(e){
return DwtTabGroup.BY_NAME[e]
};
DwtTabGroup.BY_NAME={};
DwtTabGroup.prototype.getName=function(){
return this.__name
};
DwtTabGroup.prototype.addFocusChangeListener=function(e){
this.__checkRoot();
this.__evtMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabGroup.prototype.removeFocusChangeListener=function(e){
this.__checkRoot();
this.__evtMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabGroup.prototype.addMember=function(n,a){
a=(a!=null)?a:this.__members.size();
var t=AjxUtil.collapseList(AjxUtil.toArray(n));
for(var o=0,e=t.length;
o<e;
o++){
var n=t[o];
this.__members.add(n,a+o);
if(n.isDwtTabGroup){
n.newParent(this)
}}};
DwtTabGroup.prototype.setMembers=function(e){
this.removeAllMembers();
this.addMember(e)
};
DwtTabGroup.prototype.addMemberAfter=function(e,t){
this.addMember(e,this.__indexOfMember(t)+1)
};
DwtTabGroup.prototype.addMemberBefore=function(e,t){
this.addMember(e,this.__indexOfMember(t))
};
DwtTabGroup.prototype.removeMember=function(a,e,t){
return this.replaceMember(a,null,e,t)
};
DwtTabGroup.prototype.removeAllMembers=function(){
this.__members.removeAll()
};
DwtTabGroup.prototype.replaceMember=function(o,n,h,s,e,i){
var t=this.__getTabGroupForMember(o);
if(!t){
this.addMember(n);
return null
}
var r=this.__getRootTabGroup();
var a;
if(e){
a=e
}else{
if(r.__currFocusMember===o||(o&&o.isDwtTabGroup&&o.contains(r.__currFocusMember))){
if(n){
a=(n.isDwtTabGroup)?n.getFirstMember():n
}else{
a=this.__getPrevMember(o,h);
if(!a){
a=this.__getNextMember(o,h)
}}}}
if(a&&!i){
r.__currFocusMember=a;
this.__showFocusedItem(this.__currFocusMember,"replaceMember");
if(!s){
this.__notifyListeners(a)
}}
if(n&&n.isDwtTabGroup){
n.newParent(this)
}
return n?this.__members.replaceObject(o,n):this.__members.remove(o)
};
DwtTabGroup.prototype.contains=function(e){
return !!this.__getTabGroupForMember(e)
};
DwtTabGroup.prototype.newParent=function(e){
this.__parent=e
};
DwtTabGroup.prototype.getFirstMember=function(e){
return this.__getLeftMostMember(e)
};
DwtTabGroup.prototype.getLastMember=function(e){
return this.__getRightMostMember(e)
};
DwtTabGroup.prototype.getFocusMember=function(){
this.__checkRoot();
return this.__currFocusMember
};
DwtTabGroup.prototype.setFocusMember=function(a,e,t){
if(!a){
return false
}
if(a.isDwtTabGroup){
a=a.getFocusMember()||a.getFirstMember()
}
this.__checkRoot();
if(!this.__checkEnabled(a,e)){
return false
}
if(this.contains(a)){
this.__currFocusMember=a;
this.__showFocusedItem(this.__currFocusMember,"setFocusMember");
if(!t){
this.__notifyListeners(this.__currFocusMember)
}
return true
}
return false
};
DwtTabGroup.prototype.getNextFocusMember=function(e,t){
this.__checkRoot();
return this.__setFocusMember(true,e,t)
};
DwtTabGroup.prototype.getPrevFocusMember=function(e,t){
this.__checkRoot();
return this.__setFocusMember(false,e,t)
};
DwtTabGroup.prototype.resetFocusMember=function(t,a){
this.__checkRoot();
var e=this.__getLeftMostMember(t);
if((e!=this.__currFocusMember)&&!a){
this.__notifyListeners(this.__currFocusMember)
}
this.__showFocusedItem(this.__currFocusMember,"resetFocusMember");
this.__currFocusMember=e;
return this.__currFocusMember
};
DwtTabGroup.prototype.dump=function(e){
if(e){
if(!window.AjxDebug||!window.DBG){
return
}
var t=function(i){
var i=AjxStringUtil.convertToHtml(i)
};
DwtTabGroup.__dump(this,t,0)
}else{
if(window.console&&window.console.log){
var a=[];
DwtTabGroup.__dump(this,a.push.bind(a),0);
console.log(a.join("\n"))
}}};
DwtTabGroup.prototype.size=function(){
return this.__members.size()
};
DwtTabGroup.prototype.__getPrevMember=function(s,t){
var e=this.__members.getArray();
for(var o=this.__lastIndexOfMember(s)-1;
o>-1;
o--){
var n=e[o];
if(!n.isDwtTabGroup){
if(this.__checkEnabled(n,t)){
return n
}}else{
n=n.__getRightMostMember(t);
if(this.__checkEnabled(n,t)){
return n
}}}
return this.__parent?this.__parent.__getPrevMember(this,t):null
};
DwtTabGroup.prototype.__checkEnabled=function(i,e){
if(!e){
return true
}
if(!i||i.noTab){
return false
}
if(i.isDwtControl?!i.getEnabled():i.disabled){
return false
}
if(i.isDwtControl){
i=i.getHtmlElement()
}
var a=Dwt.getLocation(i);
if(a.x===null||a.y===null||a.x===Dwt.LOC_NOWHERE||a.y===Dwt.LOC_NOWHERE){
return false
}
var t=Dwt.getSize(i);
if(!t||t.x===0||t.y===0){
return false
}
if(i.nodeName&&i.nodeName.toLowerCase()==="body"){
return true
}
return(Dwt.getZIndex(i,true)>Dwt.Z_HIDDEN&&Dwt.getVisible(i)&&Dwt.getVisibility(i))
};
DwtTabGroup.prototype.__indexOfMember=function(e){
return this.__members.indexOf(e)
};
DwtTabGroup.prototype.__lastIndexOfMember=function(e){
return this.__members.lastIndexOf(e)
};
DwtTabGroup.prototype.__getNextMember=function(r,t){
var e=this.__members.getArray();
var s=this.__members.size();
for(var n=this.__indexOfMember(r)+1;
n<s;
n++){
var o=e[n];
if(!o.isDwtTabGroup){
if(this.__checkEnabled(o,t)){
return o
}}else{
o=o.__getLeftMostMember(t);
if(this.__checkEnabled(o,t)){
return o
}}}
return this.__parent?this.__parent.__getNextMember(this,t):null
};
DwtTabGroup.prototype.__getRightMostMember=function(t){
var e=this.__members.getArray();
var n=null;
for(var o=this.__members.size()-1;
o>=0;
o--){
n=e[o];
if(!n.isDwtTabGroup){
if(this.__checkEnabled(n,t)){
break
}}else{
n=n.__getRightMostMember(t);
if(this.__checkEnabled(n,t)){
break
}}}
return this.__checkEnabled(n,t)?n:null
};
DwtTabGroup.prototype.__getLeftMostMember=function(t){
var n=this.__members.size();
var e=this.__members.getArray();
var s=null;
for(var o=0;
o<n;
o++){
s=e[o];
if(!s.isDwtTabGroup){
if(this.__checkEnabled(s,t)){
break
}}else{
s=s.__getLeftMostMember(t);
if(this.__checkEnabled(s,t)){
break
}}}
return this.__checkEnabled(s,t)?s:null
};
DwtTabGroup.prototype.__notifyListeners=function(t){
var a=this.__getRootTabGroup();
if(a.__evtMgr){
var e=DwtTabGroup.__changeEvt;
e.reset();
e.tabGroup=this;
e.newFocusMember=t;
a.__evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,e)
}};
DwtTabGroup.prototype.__getRootTabGroup=function(){
var e=this;
while(e.__parent){
e=e.__parent
}
return e
};
DwtTabGroup.DUMP_INDENT="|\t";
DwtTabGroup.__dump=function(t,c,e){
var s=AjxStringUtil.repeat(DwtTabGroup.DUMP_INDENT,e);
c(s+"TABGROUP: "+t.__name);
s+=DwtTabGroup.DUMP_INDENT;
var h=t.__members.size();
var l=t.__members.getArray();
for(var n=0;
n<h;
n++){
var o=l[n];
if(o.isDwtTabGroup){
DwtTabGroup.__dump(o,c,e+1)
}else{
var r=o.nodeName?[o.nodeName,o.id,o.className].join(" "):[String(o),o._htmlElId].join(" ");
if(o.noTab){
r+=" - no tab!"
}
c(s+r)
}}};
DwtTabGroup.prototype.__setFocusMember=function(o,t,a){
if(!this.__currFocusMember){
return this.resetFocusMember(t,a)
}
var i=this.__getTabGroupForMember(this.__currFocusMember);
if(!i){
return null
}
var e=o?i.__getNextMember(this.__currFocusMember,t):i.__getPrevMember(this.__currFocusMember,t);
if(!e){
e=o?this.__getLeftMostMember(t):this.__getRightMostMember(t);
if(e==this.__currFocusMember){
return null
}}
this.__currFocusMember=e;
this.__showFocusedItem(this.__currFocusMember,"__setFocusMember");
if(!a){
this.__notifyListeners(this.__currFocusMember)
}
return this.__currFocusMember
};
DwtTabGroup.prototype.__getTabGroupForMember=function(s){
if(!s){
return null
}
var t=this.__members.getArray(),n=t.length,o,e;
for(o=0;
o<n;
o++){
e=t[o];
if(e===s){
return this
}else{
if(e.isDwtTabGroup&&(e=e.__getTabGroupForMember(s))){
return e
}}}
return null
};
DwtTabGroup.prototype.__checkRoot=function(){
if(this.__parent){}};
DwtTabGroup.prototype.__showFocusedItem=function(o,a){
if(o&&window.AjxDebug&&window.DBG){
var e=a?"DwtTabGroup."+a+": ":"",s=" ["+(o.isDwtControl?o._htmlElId:o.id)+"] ",t=(o.nodeName||o)+" "+s,n=(o.getTitle&&o.getTitle())||(o.getText&&o.getText())||"",i=t+n
}}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragEvent")){
DwtDragEvent=function(){
this.operation=null;
this.srcControl=null;
this.action=null;
this.doIt=false;
this.srcData=null
};
DwtDragEvent.DRAG_INIT="INIT";
DwtDragEvent.DRAG_START="START";
DwtDragEvent.SET_DATA="SET_DATA";
DwtDragEvent.DRAG_MOVE="MOVE";
DwtDragEvent.DRAG_END="END";
DwtDragEvent.DRAG_CANCEL="CANCEL"
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragSource")){
DwtDragSource=function(e){
this.__supportedOps=e;
this.__evtMgr=new AjxEventMgr()
};
DwtDragSource.__DRAG_LISTENER="DwtDragSource.__DRAG_LISTENER";
DwtDragSource.__dragEvent=new DwtDragEvent();
DwtDragSource.prototype.toString=function(){
return"DwtDragSource"
};
DwtDragSource.prototype.addDragListener=function(e){
this.__evtMgr.addListener(DwtDragSource.__DRAG_LISTENER,e)
};
DwtDragSource.prototype.removeDragListener=function(e){
this.__evtMgr.removeListener(DwtDragSource.__DRAG_LISTENER,e)
};
DwtDragSource.prototype._beginDrag=function(e,t){
if(!(this.__supportedOps&e)){
return Dwt.DND_DROP_NONE
}
DwtDragSource.__dragEvent.operation=e;
DwtDragSource.__dragEvent.srcControl=t;
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_START;
DwtDragSource.__dragEvent.srcData=null;
DwtDragSource.__dragEvent.doit=true;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.operation
};
DwtDragSource.prototype._getData=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.SET_DATA;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.srcData
};
DwtDragSource.prototype._endDrag=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_END;
DwtDragSource.__dragEvent.doit=false;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.doit
};
DwtDragSource.prototype._cancelDrag=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_CANCEL;
DwtDragSource.__dragEvent.doit=false;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.doit
}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDropEvent")){
DwtDropEvent=function(){
this.operation=null;
this.targetControl=null;
this.action=null;
this.srcData=null;
this.doIt=false
};
DwtDropEvent.DRAG_ENTER=1;
DwtDropEvent.DRAG_LEAVE=2;
DwtDropEvent.DRAG_OP_CHANGED=3;
DwtDropEvent.DRAG_DROP=4
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDropTarget")){
DwtDropTarget=function(t){
this._evtMgr=new AjxEventMgr();
this.__hasMultiple=false;
this._types={};
if(typeof t=="string"){
t=[t]
}
if(t&&t.length){
for(var e=0;
e<t.length;
e++){
this.addTransferType(t[e])
}}};
DwtDropTarget.__DROP_LISTENER="DwtDropTarget.__DROP_LISTENER";
DwtDropTarget.__dropEvent=new DwtDropEvent();
DwtDropTarget.prototype.toString=function(){
return"DwtDropTarget"
};
DwtDropTarget.prototype.addDropListener=function(e){
this._evtMgr.addListener(DwtDropTarget.__DROP_LISTENER,e)
};
DwtDropTarget.prototype.removeDropListener=function(e){
this._evtMgr.removeListener(DwtDropTarget.__DROP_LISTENER,e)
};
DwtDropTarget.prototype.isValidTarget=function(t){
if(t instanceof Array){
var e=t.length;
for(var a=0;
a<e;
a++){
if(!this.__checkTarget(t[a])){
return false
}}
return true
}else{
return this.__checkTarget(t)
}};
DwtDropTarget.prototype.markAsMultiple=function(){
this.__hasMultiple=true
};
DwtDropTarget.prototype.hasMultipleTargets=function(){
return this.__hasMultiple
};
DwtDropTarget.prototype.getTransferTypes=function(){
return this._types
};
DwtDropTarget.prototype.addTransferType=function(e){
this._types[e]=null
};
DwtDropTarget.prototype._dragEnter=function(e,a,o,t,i){
DwtDropTarget.__dropEvent.operation=e;
DwtDropTarget.__dropEvent.targetControl=a;
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_ENTER;
DwtDropTarget.__dropEvent.srcData=o;
DwtDropTarget.__dropEvent.uiEvent=t;
DwtDropTarget.__dropEvent.doIt=true;
DwtDropTarget.__dropEvent.dndProxy=i;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype._dragLeave=function(){
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_LEAVE;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent)
};
DwtDropTarget.prototype._dragOpChanged=function(e){
DwtDropTarget.__dropEvent.operation=e;
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_OP_CHANGED;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype._drop=function(t,e){
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_DROP;
DwtDropTarget.__dropEvent.srcData=t;
DwtDropTarget.__dropEvent.uiEvent=e;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype.__checkTarget=function(item){
if(this._types){
for(var i in this._types){
var ctor;
if(this._types[i]){
ctor=this._types[i]
}else{
ctor=this._types[i]=eval(i)
}
if(ctor&&(typeof ctor=="function")&&(item instanceof ctor)){
return true
}}
return false
}}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragBox")){
DwtDragBox=function(){
this.__evtMgr=new AjxEventMgr()
};
DwtDragBox.__DRAG_LISTENER="DwtDragBox.__DRAG_LISTENER";
DwtDragBox.__dragEvent=new DwtDragEvent();
DwtDragBox.prototype.toString=function(){
return"DwtDragBox"
};
DwtDragBox.prototype.addDragListener=function(e){
this.__evtMgr.addListener(DwtDragBox.__DRAG_LISTENER,e)
};
DwtDragBox.prototype.removeDragListener=function(e){
this.__evtMgr.removeListener(DwtDragBox.__DRAG_LISTENER,e)
};
DwtDragBox.prototype._setStart=function(e,t){
this._startX=e.docX;
this._startY=e.docY;
this._dragObj=DwtDragBox.__dragEvent.srcControl=t;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_INIT;
DwtDragBox.__dragEvent.target=e.target;
return(this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)!==false)
};
DwtDragBox.prototype._beginDrag=function(e){
e._dragging=DwtControl._DRAGGING;
DwtDragBox.__dragEvent.srcControl=e;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_START;
this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)
};
DwtDragBox.prototype._dragMove=function(n,s){
var i=n.docX-this._startX;
var t=n.docY-this._startY;
var a=(i>0)?this._startX:n.docX;
var e=(t>0)?this._startY:n.docY;
var o=s.getDragSelectionBox();
Dwt.setLocation(o,a,e);
Dwt.setSize(o,Math.abs(i),Math.abs(t));
DwtDragBox.__dragEvent.srcControl=s;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_MOVE;
this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)
};
DwtDragBox.prototype._endDrag=function(e){
e._dragging=DwtControl._NO_DRAG;
DwtDragBox.__dragEvent.action=DwtDragEvent.DRAG_END;
if(!this.__evtMgr.notifyListeners(DwtDragBox.__DRAG_LISTENER,DwtDragBox.__dragEvent)){
e.destroyDragSelectionBox()
}
this._dragObj=null
};
DwtDragBox.prototype.getStartX=function(){
return this._startX
};
DwtDragBox.prototype.getStartY=function(){
return this._startY
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtHoverMgr")){
DwtHoverMgr=function(){
this._hoverOverAction=new AjxTimedAction(this,this._notifyHoverOver);
this._hoverOutAction=new AjxTimedAction(this,this._notifyHoverOut);
this._ignoreHoverOverOnClickAction=new AjxTimedAction(this,this._resetIgnoreHoverOverOnClick)
};
DwtHoverMgr.prototype.isDwtHoverMgr=true;
DwtHoverMgr.prototype.toString=function(){
return"DwtHoverMgr"
};
DwtHoverMgr.prototype._hoverOverDelay=750;
DwtHoverMgr.prototype._hoverOverActionId=-1;
DwtHoverMgr.prototype._hoverOutDelay=50;
DwtHoverMgr.prototype._ignoreHoverOverOnClickDelay=750;
DwtHoverMgr.prototype._hoverOutActionId=-1;
DwtHoverMgr.prototype._isHovering=false;
DwtHoverMgr.prototype.setHoverObject=function(e){
this._hoverObject=e
};
DwtHoverMgr.prototype.getHoverObject=function(){
return this._hoverObject
};
DwtHoverMgr.prototype.reset=function(){
this._hoverObject=null;
this._hoverOverDelay=DwtHoverMgr.prototype._hoverOverDelay;
this._hoverOverData=null;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
this._hoverOverActionId=-1;
this._hoverOverListener=null;
this._hoverOutDelay=DwtHoverMgr.prototype._hoverOutDelay;
this._hoverOutData=null;
if(this._hoverOutActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOutActionId);
this._notifyHoverOut()
}
this._hoverOutActionId=-1;
this._hoverOutListener=null
};
DwtHoverMgr.prototype.isHovering=function(){
return this._isHovering
};
DwtHoverMgr.prototype.setHoverOverDelay=function(e){
this._hoverOverDelay=e
};
DwtHoverMgr.prototype.setHoverOverData=function(e){
this._hoverOverData=e
};
DwtHoverMgr.prototype.setHoverOverListener=function(e){
this._hoverOverListener=e
};
DwtHoverMgr.prototype.setHoverOutDelay=function(e){
this._hoverOutDelay=e
};
DwtHoverMgr.prototype.setHoverOutData=function(e){
this._hoverOutData=e
};
DwtHoverMgr.prototype.setHoverOutListener=function(e){
this._hoverOutListener=e
};
DwtHoverMgr.prototype.ignoreHoverOverOnClick=function(){
this._ignoreHoverOverOnClick=true;
AjxTimedAction.scheduleAction(this._ignoreHoverOverOnClickAction,this._ignoreHoverOverOnClickDelay)
};
DwtHoverMgr.prototype._resetIgnoreHoverOverOnClick=function(){
this._ignoreHoverOverOnClick=false
};
DwtHoverMgr.prototype.hoverOver=function(e,t){
if(this._ignoreHoverOverOnClick){
return
}
this._isHovering=true;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
this._hoverOverAction.args=[e,t];
this._hoverOverActionId=AjxTimedAction.scheduleAction(this._hoverOverAction,this._hoverOverDelay)
};
DwtHoverMgr.prototype.hoverOut=function(){
this._isHovering=false;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
if(this._hoverOutActionId==-1){
if(this._hoverOutDelay>0){
this._hoverOutActionId=AjxTimedAction.scheduleAction(this._hoverOutAction,this._hoverOutDelay)
}else{
this._notifyHoverOut()
}}};
DwtHoverMgr.prototype._notifyHoverOver=function(){
this._hoverOverActionId=-1;
if(this._hoverOverListener!=null){
var e=this._hoverOverAction.args[0];
var a=this._hoverOverAction.args[1];
var t=new DwtHoverEvent(DwtEvent.HOVEROVER,this._hoverOverDelay,this._hoverOverData,e,a);
this._hoverOverListener.handleEvent(t)
}};
DwtHoverMgr.prototype._notifyHoverOut=function(){
this._hoverOutActionId=-1;
if(this._hoverOutListener!=null){
var e=new DwtHoverEvent(DwtEvent.HOVEROUT,this._hoverOutDelay,this._hoverOutData);
this._hoverOutListener.handleEvent(e)
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtControl")){
DwtControl=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtControl.PARAMS);
var e=this.parent=t.parent;
if(e&&!(e.isDwtComposite)){
throw new DwtException("Parent must be a subclass of Composite",DwtException.INVALIDPARENT,"DwtControl")
}
this.shell=null;
this._data={};
this._eventMgr=new AjxEventMgr();
this._disposed=false;
this._propagateEvent={};
this._propagateEvent[DwtEvent.ONMOUSEWHEEL]=true;
if(!e){
return
}
this._className=t.className||"DwtControl";
this.__posStyle=t.posStyle;
if(t.id){
this._htmlElId=t.id
}
this.isFocusable=(t.isFocusable!==false);
if(t.role!=null){
this.role=t.role
}
this.__index=t.index;
this.__parentElement=t.parentElement;
this._enabled=false;
this._dragging=null;
this._dndProxy=null;
this._hasFocus=false;
if(!t.deferred){
this.__initCtrl()
}
this._hoverOverListener=new AjxListener(this,this.__handleHoverOver);
this._hoverOutListener=new AjxListener(this,this.__handleHoverOut);
this._dblClickIsolation=false;
this._ignoreInternalOverOut=false;
this.TEMPLATE=t.template||this.TEMPLATE
};
DwtControl.prototype.isDwtControl=true;
DwtControl.prototype.toString=function(){
return"DwtControl"
};
DwtControl.prototype.isFocusable=null;
DwtControl.PARAMS=["parent","className","posStyle","deferred","id","index","template"];
DwtControl.ALL_BY_ID={};
DwtControl.NORMAL="";
DwtControl.ACTIVE="ZActive";
DwtControl.FOCUSED="ZFocused";
DwtControl.DISABLED="ZDisabled";
DwtControl.HOVER="ZHover";
DwtControl.SELECTED="ZSelected";
DwtControl.DEFAULT="ZDefault";
DwtControl.ERROR="ZError";
DwtControl._STATES=[DwtControl.ACTIVE,DwtControl.FOCUSED,DwtControl.DISABLED,DwtControl.HOVER,DwtControl.SELECTED,DwtControl.DEFAULT,DwtControl.ERROR];
DwtControl._RE_STATES=new RegExp("\\b("+DwtControl._STATES.join("|")+")\\b","g");
DwtControl._RE_STATE=AjxUtil.arrayAsHash(DwtControl._STATES,function(e){
return new RegExp("\\b"+e+"\\b","g")
}
);
DwtControl._ARIA_STATES={};
DwtControl._ARIA_STATES[DwtControl.DISABLED]="aria-disabled";
DwtControl._ARIA_STATES[DwtControl.SELECTED]="aria-selected";
DwtControl._ARIA_STATES[DwtControl.ERROR]="aria-invalid";
DwtControl.useBrowserTooltips=false;
DwtControl.STATIC_STYLE=Dwt.STATIC_STYLE;
DwtControl.ABSOLUTE_STYLE=Dwt.ABSOLUTE_STYLE;
DwtControl.RELATIVE_STYLE=Dwt.RELATIVE_STYLE;
DwtControl.FIXED_STYLE=Dwt.FIXED_STYLE;
DwtControl.CLIP=Dwt.CLIP;
DwtControl.VISIBLE=Dwt.VISIBLE;
DwtControl.SCROLL=Dwt.SCROLL;
DwtControl.FIXED_SCROLL=Dwt.FIXED_SCROLL;
DwtControl._NO_DRAG="NO_DRAG";
DwtControl._DRAGGING="DRAGGING";
DwtControl._DRAG_REJECTED="DRAG_REJECTED";
DwtControl.__DRAG_THRESHOLD=3;
DwtControl.__TOOLTIP_THRESHOLD=5;
DwtControl.__DND_HOVER_DELAY=750;
DwtControl.__controlEvent=new DwtControlEvent();
DwtControl.__DBL_CLICK_TIMEOUT=300;
DwtControl.prototype._displayState="";
DwtControl.prototype.addControlListener=function(e){
this.addListener(DwtEvent.CONTROL,e)
};
DwtControl.prototype.removeControlListener=function(e){
this.removeListener(DwtEvent.CONTROL,e)
};
DwtControl.prototype.addDisposeListener=function(e){
this.addListener(DwtEvent.DISPOSE,e)
};
DwtControl.prototype.removeDisposeListener=function(e){
this.removeListener(DwtEvent.DISPOSE,e)
};
DwtControl.prototype.addListener=function(t,a,e){
return this._eventMgr.addListener(t,a,e)
};
DwtControl.prototype.removeListener=function(e,t){
return this._eventMgr.removeListener(e,t)
};
DwtControl.prototype.removeAllListeners=function(e){
return this._eventMgr.removeAll(e)
};
DwtControl.prototype.isListenerRegistered=function(e){
return this._eventMgr.isListenerRegistered(e)
};
DwtControl.prototype.notifyListeners=function(e,t){
return this._eventMgr.notifyListeners(e,t)
};
DwtControl.prototype.dispose=function(){
if(this._disposed){
return
}
if(this.parent&&this.parent.isDwtComposite){
this.parent.removeChild(this)
}
this._elRef=null;
DwtControl.ALL_BY_ID[this._htmlElId]=null;
delete DwtControl.ALL_BY_ID[this._htmlElId];
this._disposed=true;
var e=new DwtDisposeEvent();
e.dwtObj=this;
this.notifyListeners(DwtEvent.DISPOSE,e);
this._eventMgr.clearAllEvents()
};
DwtControl.prototype.getDocument=function(){
return document
};
DwtControl.prototype.getTabGroupMember=function(){
return this.tabGroupMember||this
};
DwtControl.prototype.getData=function(e){
return this._data[e]
};
DwtControl.prototype.setData=function(e,t){
this._data[e]=t
};
DwtControl.prototype.isDisposed=function(){
return this._disposed
};
DwtControl.prototype.isInitialized=function(){
return this.__ctrlInited
};
DwtControl.prototype.focus=function(){
if(!this._checkState()){
return
}
var t=this.getFocusElement();
if(t&&t.focus){
AjxTimedAction.scheduleAction(this._focusAction);
var e=this.getScrollContainer(),a=e&&e.scrollTop;
t.focus();
if(a>0){
e.scrollTop=a
}}
return this
};
DwtControl.prototype.blur=function(){
if(!this._checkState()){
return
}
var e=this.getFocusElement();
if(e&&e.blur){
AjxTimedAction.scheduleAction(this._blurAction);
e.blur()
}
return this
};
DwtControl.prototype.hasFocus=function(){
return this._hasFocus
};
DwtControl.prototype.handleKeyAction=function(e,t){
return false
};
DwtControl.prototype.reparent=function(t,e){
if(!this._checkState()){
return
}
var a=this.getHtmlElement();
this.parent.removeChild(this,true);
DwtComposite._pendingElements[this._htmlElId]=a;
t.addChild(this,e);
this.parent=t
};
DwtControl.prototype.reparentHtmlElement=function(a,e){
if(typeof a=="string"){
a=document.getElementById(a)
}
if(!a){
return
}
var t=this.getHtmlElement();
if(e==null){
a.appendChild(t)
}else{
if(typeof e=="object"){
a.insertBefore(t,e)
}else{
if(a.childNodes[e]){
a.insertBefore(t,a.childNodes[e])
}else{
a.appendChild(t)
}}}};
DwtControl.prototype.setHandler=function(t,e){
if(!this._checkState()){
return
}
var a=this.getHtmlElement();
Dwt.setHandler(a,t,e)
};
DwtControl.prototype.clearHandler=function(e){
if(!this._checkState()){
return
}
var t=this.getHtmlElement();
Dwt.clearHandler(t,e)
};
DwtControl.prototype.setEventPropagation=function(e,a){
a=AjxUtil.toArray(a);
for(var t=0;
t<a.length;
t++){
this._propagateEvent[a[t]]=e
}};
DwtControl.prototype.getBounds=function(){
if(!this._checkState()){
return
}
return Dwt.getBounds(this.getHtmlElement())
};
DwtControl.prototype.getInsetBounds=function(){
if(!this._checkState()){
return
}
return Dwt.getInsetBounds(this.getHtmlElement())
};
DwtControl.prototype.getInsets=function(){
if(!this._checkState()){
return
}
return Dwt.getInsets(this.getHtmlElement())
};
DwtControl.prototype.getMargins=function(){
if(!this._checkState()){
return
}
return Dwt.getMargins(this.getHtmlElement())
};
DwtControl.prototype.setBounds=function(a,n,i,t){
if(!this._checkState()){
return
}
var o=this.getHtmlElement();
if(this.isListenerRegistered(DwtEvent.CONTROL)){
this.__controlEvent.reset(DwtControlEvent.RESIZE|DwtControlEvent.MOVE);
var e=Dwt.getBounds(o);
this.__controlEvent.oldX=e.x;
this.__controlEvent.oldY=e.y;
this.__controlEvent.oldWidth=e.width;
this.__controlEvent.oldHeight=e.height;
this.setLocation(a,n);
this.setSize(i,t);
e=Dwt.getBounds(o);
this.__controlEvent.newX=e.x;
this.__controlEvent.newY=e.y;
this.__controlEvent.newWidth=(AjxUtil.isNumber(i))?i:e.width;
this.__controlEvent.newHeight=(AjxUtil.isNumber(t))?t:e.height;
this.__controlEvent.requestedWidth=i;
this.__controlEvent.requestedHeight=t;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
this.setLocation(a,n);
this.setSize(i,t)
}
return this
};
DwtControl.prototype.getClassName=function(){
return this._className
};
DwtControl.prototype.setClassName=function(t){
if(!this._checkState()){
return
}
this._className=t;
var e=this.getHtmlElement();
e.className=t;
Dwt.addClass(e,this._displayState)
};
DwtControl.prototype.addClassName=function(e){
Dwt.addClass(this.getHtmlElement(),e)
};
DwtControl.prototype.delClassName=function(e,t){
Dwt.delClass(this.getHtmlElement(),e,t)
};
DwtControl.prototype.condClassName=function(a,e,t){
Dwt.condClass(this.getHtmlElement(),a,e,t)
};
DwtControl.prototype.setDisplayState=function(n){
if(!this._enabled){
n=DwtControl.DISABLED
}
if(arguments.length>1){
var e=[];
for(var o=0;
o<arguments.length;
o++){
e.push(arguments[o])
}
n=e.join(" ")
}
if(this._displayState==n){
return
}
var t=this._displayState;
this._displayState=n;
Dwt.delClass(this.getHtmlElement(),DwtControl._RE_STATES,n);
AjxUtil.foreach(DwtControl._ARIA_STATES,(function(a,i){
if(DwtControl._RE_STATE[i].test(this._displayState)){
this.setAttribute(a,true)
}else{
this.removeAttribute(a)
}}
).bind(this));
if(this.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this.__controlEvent.reset(DwtControlEvent.STATE);
this.__controlEvent.oldState=t;
this.__controlEvent.newState=n;
this.__controlEvent.dwtObj=this;
this.notifyListeners(DwtEvent.STATE_CHANGE,this.__controlEvent)
}};
DwtControl.prototype.showAlert=function(e){
if(e&&!this._alert){
this.delClassName(null,"ZAlert")
}else{
if(!e&&this._alert){
this.delClassName("ZAlert",null)
}}
this._alert=e
};
DwtControl.prototype.isAlertShown=function(){
return this._alert
};
DwtControl.prototype._createHtmlFromTemplate=function(e,a){
this.getHtmlElement().innerHTML=AjxTemplate.expand(e,a);
var i=AjxTemplate.getParams(e);
var t=i&&i["class"];
if(t){
t=[this._className,t].join(" ");
this.setClassName(t)
}};
DwtControl.prototype.getCursor=function(){
if(!this._checkState()){
return
}
return Dwt.getCursor(this.getHtmlElement())
};
DwtControl.prototype.setCursor=function(e){
if(!this._checkState()){
return
}
Dwt.setCursor(this.getHtmlElement(),e)
};
DwtControl.prototype.getDragSource=function(){
return this._dragSource
};
DwtControl.prototype.setDragSource=function(e){
this._dragSource=e;
if(e&&!this._ctrlCaptureObj){
this.__initCapture();
this._dndHoverAction=new AjxTimedAction(null,this.__dndDoHover)
}};
DwtControl.prototype.getDropTarget=function(){
return this._dropTarget
};
DwtControl.prototype.setDropTarget=function(e){
this._dropTarget=e
};
DwtControl.prototype.getDragBox=function(){
return this._dragBox
};
DwtControl.prototype.setDragBox=function(e){
this._dragBox=e;
if(e&&!this._ctrlCaptureObj){
this.__initCapture()
}};
DwtControl.prototype.__initCapture=function(e){
this._ctrlCaptureObj=new DwtMouseEventCapture({
targetObj:this,id:"DwtControl",mouseOverHdlr:DwtControl.__mouseOverHdlr,mouseDownHdlr:DwtControl.__mouseDownHdlr,mouseMoveHdlr:DwtControl.__mouseMoveHdlr,mouseUpHdlr:DwtControl.__mouseUpHdlr,mouseOutHdlr:DwtControl.__mouseOutHdlr}
)
};
DwtControl.prototype.getEnabled=function(){
if(!this._checkState()){
return
}
return this._enabled
};
DwtControl.prototype.setEnabled=function(e,t){
if(!this._checkState()){
return
}
if(e!=this._enabled){
this._enabled=e;
this.setDisplayState(e?DwtControl.NORMAL:DwtControl.DISABLED);
if(t){
this.getHtmlElement().disabled=!e
}}};
DwtControl.prototype.getHTMLElId=function(){
return this._htmlElId
};
DwtControl.prototype.getHtmlElement=function(){
if(!this._checkState()){
return
}
var e=this._elRef||document.getElementById(this._htmlElId);
if(e==null){
e=DwtComposite._pendingElements[this._htmlElId]
}else{
if(!e._rendered){
delete DwtComposite._pendingElements[this._htmlElId];
e._rendered=true
}}
return this._elRef=e
};
DwtControl.prototype.getFocusElement=function(){
return this.isFocusable?this._focusElement:null
};
DwtControl.prototype.setFocusElement=function(a){
if(!this.isFocusable){
return
}
var e=(document.activeElement===this._focusElement),t=a||(this.getInputElement&&this.getInputElement())||this.getHtmlElement();
if(this._focusElement&&this._focusElement!==t){
this._makeFocusable(this._focusElement,false)
}
this._focusElement=t;
if(t){
this._makeFocusable(this._focusElement,true);
if(e){
t.focus()
}}};
DwtControl.fromElement=function(e){
return DwtControl.ALL_BY_ID[e.id]
};
DwtControl.fromElementId=function(e){
return DwtControl.ALL_BY_ID[e]
};
DwtControl.findControl=function(a){
if(AjxEnv.isFirefox3_5up&&!AjxEnv.isFirefox3_6up){
var t=HTMLElement.prototype.toString.call(a);
if(t=="[xpconnect wrapped native prototype]"||t=="[object XULElement]"){
return null
}}
try{
while(a){
if(a.id&&DwtControl.ALL_BY_ID[a.id]){
return DwtControl.ALL_BY_ID[a.id]
}
a=a.parentNode
}}
catch(i){}
return null
};
DwtControl.getTargetControl=function(e,a){
var t=DwtUiEvent.getTarget(e,a);
return t?DwtControl.findControl(t):null
};
DwtControl.prototype.setHtmlElementId=function(t){
if(this._disposed){
return
}
if(this.__ctrlInited){
var e=this.getHtmlElement();
if(!e._rendered){
delete DwtComposite._pendingElements[this._htmlElId];
DwtComposite._pendingElements[t]=e
}else{
delete DwtControl.ALL_BY_ID[this._htmlElId];
DwtControl.ALL_BY_ID[t]=this
}
e.id=t
}
this._htmlElId=t
};
DwtControl.prototype.getX=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement()).x
};
DwtControl.prototype.getXW=function(){
if(!this._checkState()){
return
}
var e=this.getBounds();
return e.x+e.width
};
DwtControl.prototype.getY=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement()).y
};
DwtControl.prototype.getYH=function(){
if(!this._checkState()){
return
}
var e=this.getBounds();
return e.y+e.height
};
DwtControl.prototype.getPosition=function(){
if(!this._checkState()){
return
}
return Dwt.getPosition(this.getHtmlElement())
};
DwtControl.prototype.setPosition=function(e){
if(!this._checkState()){
return
}
return Dwt.setPosition(this.getHtmlElement(),e)
};
DwtControl.prototype.getLocation=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement())
};
DwtControl.prototype.setLocation=function(e,i){
if(!this._checkState()){
return
}
if(this.isListenerRegistered(DwtEvent.CONTROL)){
var t=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.MOVE);
var a=Dwt.getLocation(t);
this.__controlEvent.oldX=a.x;
this.__controlEvent.oldY=a.y;
Dwt.setLocation(t,e,i);
a=Dwt.getLocation(t);
this.__controlEvent.newX=a.x;
this.__controlEvent.newY=a.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
Dwt.setLocation(this.getHtmlElement(),e,i)
}
return this
};
DwtControl.prototype.getScrollStyle=function(){
if(!this._checkState()){
return
}
return Dwt.getScrollStyle(this.getHtmlElement())
};
DwtControl.prototype.setScrollStyle=function(e){
if(!this._checkState()){
return
}
Dwt.setScrollStyle(this.getHtmlElement(),e)
};
DwtControl.prototype.getScrollContainer=function(){
return this.parent&&this.parent.getHtmlElement()
};
DwtControl.prototype.setPosition=function(e){
if(!this._checkState()){
return
}
if(e==DwtControl.STATIC_STYLE||e==DwtControl.ABSOLUTE_STYLE||e==DwtControl.RELATIVE_STYLE){
this.__posStyle=e;
Dwt.setPosition(this.getHtmlElement(),e)
}};
DwtControl.prototype.getW=function(){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement()).x
};
DwtControl.prototype.getH=function(){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement()).y
};
DwtControl.prototype.getSize=function(e){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement(),null,e)
};
DwtControl.prototype.getOuterSize=function(){
if(!this._checkState()){
return
}
return Dwt.getOuterSize(this.getHtmlElement(),null)
};
DwtControl.prototype.setSize=function(t,e){
if(!this._checkState()){
return
}
if(this.isListenerRegistered(DwtEvent.CONTROL)){
var i=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.RESIZE);
var a=Dwt.getSize(i);
this.__controlEvent.oldWidth=a.x;
this.__controlEvent.oldHeight=a.y;
Dwt.setSize(i,t,e);
a=Dwt.getSize(i);
this.__controlEvent.newWidth=a.x;
this.__controlEvent.newHeight=a.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
Dwt.setSize(this.getHtmlElement(),t,e)
}
return this
};
DwtControl.prototype.getToolTipContent=function(e){
if(this._disposed){
return null
}
return this.__toolTipContent
};
DwtControl.prototype.setToolTipContent=function(t,e){
if(this._disposed){
return
}
if(t&&(typeof(t)=="string")&&DwtControl.useBrowserTooltips){
if(!t||(!t.match(/[\n\r\t]/)&&!t.match(/<[a-zA-Z]+/))){
var a=this.getHtmlElement();
if(a){
a.title=t;
this._browserToolTip=true;
return
}}}
this._browserToolTip=false;
this.__toolTipContent=t
};
DwtControl.prototype.getVisible=function(){
if(!this._checkState()){
return
}
return Dwt.getVisible(this.getHtmlElement())
};
DwtControl.prototype.setVisible=function(e){
if(!this._checkState()){
return
}
Dwt.setVisible(this.getHtmlElement(),e)
};
DwtControl.prototype.setVisibility=function(e){
if(!this._checkState()){
return
}
Dwt.setVisibility(this.getHtmlElement(),e)
};
DwtControl.prototype.getVisibility=function(){
if(!this._checkState()){
return
}
return Dwt.getVisibility(this.getHtmlElement())
};
DwtControl.prototype.getZIndex=function(e){
if(!this._checkState()){
return
}
return Dwt.getZIndex(this.getHtmlElement(),e)
};
DwtControl.prototype.setZIndex=function(e){
if(!this._checkState()){
return
}
Dwt.setZIndex(this.getHtmlElement(),e)
};
DwtControl.prototype.zShow=function(e){
this.setZIndex(e?Dwt.Z_VIEW:Dwt.Z_HIDDEN)
};
DwtControl.prototype.setDisplay=function(e){
if(!this._checkState()){
return
}
Dwt.setDisplay(this.getHtmlElement(),e)
};
DwtControl.prototype.setOpacity=function(e){
if(!this._checkState()){
return
}
Dwt.setOpacity(this.getHtmlElement(),e)
};
DwtControl.prototype.getOpacity=function(){
if(!this._checkState()){
return
}
return Dwt.getOpacity(this.getHtmlElement())
};
DwtControl.prototype.preventSelection=function(e){
return !this.__isInputEl(e)
};
DwtControl.prototype.preventContextMenu=function(e){
return e?(!this.__isInputEl(e)):true
};
DwtControl.prototype.getContent=function(){
return this.getHtmlElement().innerHTML
};
DwtControl.prototype.setContent=function(e){
if(e){
this.getHtmlElement().innerHTML=e
}};
DwtControl.prototype.clearContent=function(){
this.getHtmlElement().innerHTML=""
};
DwtControl.prototype.appendElement=function(t){
var e=AjxUtil.isString(t)?document.getElementById(t):t;
if(e){
e.appendChild(this.getHtmlElement(),e)
}};
DwtControl.prototype.replaceElement=function(i,e,o){
var t=AjxUtil.isString(i)?document.getElementById(i):i;
if(t){
var a=this.getHtmlElement();
t.parentNode.replaceChild(a,t);
this._replaceElementHook(t,a,e,o)
}};
DwtControl.prototype._replaceElementHook=function(a,o,t,r){
if((t==null||t)&&a.className){
Dwt.addClass(o,a.className)
}
if(r==null||r){
var i=a.getAttribute("style")||a.style;
if(i){
if(AjxUtil.isString(i)){
o.setAttribute("style",[o.getAttribute("style"),i].join(";"))
}else{
if(AjxUtil.isString(i.cssText)){
if(i.cssText){
o.setAttribute("style",[o.getAttribute("style"),i.cssText].join(";"))
}}else{
for(var n in i){
if(i[n]){
try{
o.style[n]=i[n]
}
catch(s){}}}}}}}};
DwtControl.prototype._blur=function(){};
DwtControl.prototype._focus=function(){};
DwtControl.prototype._focusByMouseUpEvent=function(e){
if(this.getEnabled()){
this.shell.getKeyboardMgr().grabFocus(this)
}};
DwtControl.prototype._focusByMouseDownEvent=function(e){
this._duringFocusByMouseDown=true;
this._focusByMouseUpEvent(e);
this._duringFocusByMouseDown=false
};
DwtControl.prototype._getDragOp=function(e){
return e.ctrlKey?Dwt.DND_DROP_COPY:Dwt.DND_DROP_MOVE
};
DwtControl.prototype._getDragProxy=function(e){
return null
};
DwtControl.prototype.getDragSelectionBox=function(e){
if(!this._dragSelectionBox){
var t=this._dragSelectionBox=document.createElement("div");
t.className="dndSelectionBox";
Dwt.setPosition(t,Dwt.ABSOLUTE_STYLE);
this.shell.getHtmlElement().appendChild(t);
Dwt.setZIndex(t,Dwt.Z_DND)
}
return this._dragSelectionBox
};
DwtControl.prototype._setDragProxyState=function(e){
if(this._dndProxy){
Dwt.condClass(this._dndProxy,e,DwtCssStyle.DROPPABLE,DwtCssStyle.NOT_DROPPABLE)
}};
DwtControl.__junkIconId=0;
DwtControl.prototype._destroyDragProxy=function(e){
if(e){
if(e.parentNode){
e.parentNode.removeChild(e)
}else{
e.style.zIndex=-100;
e.id="DwtJunkIcon"+DwtControl.__junkIconId++;
e=null
}}};
DwtControl.prototype.destroyDragSelectionBox=function(){
var e=this._dragSelectionBox;
if(e&&e.parentNode){
e.parentNode.removeChild(e)
}
this._dragSelectionBox=null
};
DwtControl.prototype._isValidDragObject=function(e){
return true
};
DwtControl.prototype._dragEnter=function(e){};
DwtControl.prototype._dragOver=function(e){};
DwtControl.prototype._dragHover=function(e){};
DwtControl.prototype._dragLeave=function(e){};
DwtControl.prototype._drop=function(e){};
DwtControl.prototype._makeFocusable=function(e,t){
t=(t!==false);
this._setEventHdlrs([DwtEvent.ONFOCUS,DwtEvent.ONBLUR],true,e);
if(t){
this._setEventHdlrs([DwtEvent.ONFOCUS,DwtEvent.ONBLUR],false,e);
e.tabIndex=0
}else{
e.removeAttribute("tabIndex")
}};
DwtControl.prototype._setKeyPressEventHdlr=function(e,t){
this._setEventHdlrs([DwtEvent.ONKEYPRESS],e,t)
};
DwtControl.prototype._setMouseEventHdlrs=function(e,t){
this._setEventHdlrs(DwtEvent.MOUSE_EVENTS,e,t)
};
DwtControl.prototype._setKeyEventHdlrs=function(e,t){
this._setEventHdlrs(DwtEvent.KEY_EVENTS,e,t)
};
DwtControl.prototype._setEventHdlrs=function(o,e,a){
if(!this._checkState()){
return
}
var n=a||this.getHtmlElement();
for(var t=0;
t<o.length;
t++){
if(e!==true){
Dwt.setHandler(n,o[t],DwtControl.__HANDLER[o[t]])
}else{
Dwt.clearHandler(n,o[t])
}}};
DwtControl.prototype._setMouseEvents=function(){
var e=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART];
if(AjxEnv.isIE){
e.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{
e.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
this._setEventHdlrs(e)
};
DwtControl.prototype._setMouseEvent=function(t,e){
t.reset();
e.ersatz=true;
DwtUiEvent.copy(t,e);
t.button=e.button
};
DwtControl.prototype._getStopPropagationValForMouseEv=function(e){
return true
};
DwtControl.prototype._getEventReturnValForMouseEv=function(e){
return false
};
DwtControl.prototype._checkState=function(){
if(this._disposed){
return false
}
if(!this.__ctrlInited){
this.__initCtrl()
}
return true
};
DwtControl.prototype._position=function(i){
this._checkState();
var a=this.shell.getSize();
var t=this.getSize();
var e,o;
if(!i){
e=Math.round((a.x-t.x)/2);
o=Math.round((a.y-t.y)/2)
}else{
e=i.x;
o=i.y
}
if((e+t.x)>a.x){
e=a.x-t.x
}
if((o+t.y)>a.y){
o=a.y-t.y
}
this.setLocation(e,o)
};
DwtControl._dndScrollCallback=function(a,s){
var t=a.container;
if(!t){
return
}
var c=s.dwtObj&&s.dwtObj._dndScrollId;
if(s.type=="mouseup"||!c||(a.id&&c!=a.id)){
if(t._dndScrollActionId!=-1){
AjxTimedAction.cancelAction(t._dndScrollActionId);
t._dndScrollActionId=-1
}
return
}
t._scrollAmt=0;
if(t.clientHeight<t.scrollHeight){
var i=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y;
var d=i+t.scrollTop;
var r=t.scrollTop;
var h=s.docY-d;
var o=(t.clientWidth<t.scrollWidth)?a.threshold+Dwt.SCROLLBAR_WIDTH:a.threshold;
var n=(h<=o)?-1*a.amount:0;
if(n==0){
var e=Dwt.getSize(t,DwtPoint.tmp).y;
var l=d+e;
h=l-s.docY;
n=(h<=o)?a.amount:0
}
t._scrollAmt=n;
if(n){
if(!t._dndScrollAction){
t._dndScrollAction=new AjxTimedAction(null,DwtControl._dndScroll,[a]);
t._dndScrollActionId=-1
}
if(t._dndScrollActionId==-1){
t._dndScrollActionId=AjxTimedAction.scheduleAction(t._dndScrollAction,0)
}}else{
if(t._dndScrollActionId!=-1){
AjxTimedAction.cancelAction(t._dndScrollActionId);
t._dndScrollActionId=-1
}}}};
DwtControl._dndScroll=function(o){
var t=o.container;
var i=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y;
var a=Dwt.getSize(t,DwtPoint.tmp).y;
var e=t.scrollTop;
if((t._scrollAmt<0&&e>0)||(t._scrollAmt>0&&(e+a<t.scrollHeight))){
t.scrollTop+=t._scrollAmt;
t._dndScrollActionId=AjxTimedAction.scheduleAction(t._dndScrollAction,o.interval)
}};
DwtControl.__keyPressHdlr=function(a){
var i=i?i:DwtControl.getTargetControl(a);
if(!i){
return false
}
if(i.__hasToolTipContent()){
var t=DwtShell.getShell(window);
var e=t.getHoverMgr();
e.setHoverOutListener(i._hoverOutListener);
e.hoverOut();
i.__tooltipClosed=false
}};
DwtControl.__keyUpHdlr=function(e){
return DwtKeyboardMgr.__keyUpHdlr.apply(this,arguments)
};
DwtControl.__keyDownHdlr=function(e){
return DwtKeyboardMgr.__keyDownHdlr.apply(this,arguments)
};
DwtControl.__focusHdlr=function(t,e,a){
a=a||DwtControl.getTargetControl(t);
if(!a){
return false
}
a._cancelFocusBlurActions();
return a.__doFocus(t)
};
DwtControl.__blurHdlr=function(t,e,a){
a=a||DwtControl.getTargetControl(t);
if(!a){
return false
}
a._cancelFocusBlurActions();
return a.__doBlur(t)
};
DwtControl.prototype._cancelFocusBlurActions=function(){
if(this._focusAction._id!==-1){
AjxTimedAction.cancelAction(this._focusAction._id)
}
if(this._blurAction._id!==-1){
AjxTimedAction.cancelAction(this._blurAction._id)
}};
DwtControl.prototype.__hasToolTipContent=function(){
if(this._disposed){
return false
}
return Boolean(!this._browserToolTip&&(this.__toolTipContent||(this.getToolTipContent!=DwtControl.prototype.getToolTipContent)))
};
DwtControl.prototype.__doFocus=function(e){
if(!this._checkState()){
return false
}
this._hasFocus=true;
this.shell.getKeyboardMgr().updateFocus(this,e);
if(this.isListenerRegistered(DwtEvent.ONFOCUS)){
e=e||DwtShell.focusEvent;
e.dwtObj=this;
e.state=DwtFocusEvent.FOCUS;
this.notifyListeners(DwtEvent.ONFOCUS,e)
}
this._focus();
return true
};
DwtControl.prototype.__doBlur=function(e){
if(!this._checkState()){
return false
}
this._hasFocus=false;
if(this.isListenerRegistered(DwtEvent.ONBLUR)){
e=e||DwtShell.focusEvent;
e.dwtObj=this;
e.state=DwtFocusEvent.BLUR;
this.notifyListeners(DwtEvent.ONBLUR,e)
}
this._blur();
return true
};
DwtControl.__clickHdlr=function(t){
var a=DwtControl.getTargetControl(t);
if(a&&a._clickPending){
return
}
try{
return DwtControl.__mouseEvent(t,DwtEvent.ONCLICK)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__dblClickHdlr=function(t){
try{
var a=DwtControl.getTargetControl(t);
if(a&&a._dblClickIsolation){
a._clickPending=false;
AjxTimedAction.cancelAction(a._dblClickActionId)
}
return DwtControl.__mouseEvent(t,DwtEvent.ONDBLCLICK)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__mouseOverHdlr=function(n,s){
try{
var a=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
if(a!=null){
n=DwtUiEvent.getEvent(n);
n._stopPropagation=true;
return false
}
var t=DwtControl.getTargetControl(n);
if(!t){
return false
}
s=s||DwtEvent.ONMOUSEOVER;
if((s==DwtEvent.ONMOUSEOVER)&&t._ignoreInternalOverOut){
var h=DwtControl.getTargetControl(n,true);
if(t==h){
return false
}}
var r=DwtShell.mouseEvent;
if(t._dragging==DwtControl._NO_DRAG){
r.setFromDhtmlEvent(n,t);
r.hoverStarted=false;
if(t.isListenerRegistered(s)){
t.notifyListeners(s,r)
}
if(t.__hasToolTipContent(r)&&!r.hoverStarted){
var i=DwtShell.getShell(window);
var e=i.getHoverMgr();
if((!e.isHovering()||e.getHoverObject()!=t)&&!DwtMenu.menuShowing()){
e.reset();
e.setHoverObject(t);
e.setHoverOverData(r);
e.setHoverOverDelay(DwtToolTip.TOOLTIP_DELAY);
e.setHoverOverListener(t._hoverOverListener);
e.hoverOver(r.docX,r.docY)
}}}
r._stopPropagation=true;
r._returnValue=false;
r.setToDhtmlEvent(n);
return false
}
catch(o){
AjxException.reportScriptError(o)
}};
DwtControl.__mouseEnterHdlr=function(e){
return DwtControl.__mouseOverHdlr(e,DwtEvent.ONMOUSEENTER)
};
DwtControl.__mouseDownHdlr=function(o){
try{
var n=DwtControl.getTargetControl(o);
if(!n){
return false
}
o=DwtUiEvent.getEvent(o);
var i=DwtShell.mouseEvent;
i.setFromDhtmlEvent(o,n);
if(i.button==DwtMouseEvent.LEFT){
n._focusByMouseDownEvent(o);
i.setFromDhtmlEvent(o,n)
}
if(n.__hasToolTipContent()){
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
t.setHoverOutListener(n._hoverOutListener);
t.hoverOut()
}
if(n._dragSource&&(i.button==DwtMouseEvent.LEFT)&&n._isValidDragObject(i)){
try{
n._ctrlCaptureObj.capture()
}
catch(e){}
n._dragOp=n._getDragOp(i);
n.__dragStartX=i.docX;
n.__dragStartY=i.docY
}else{
if(n._dragBox){
if(n._dragBox._setStart(i,n)){
try{
n._ctrlCaptureObj.capture()
}
catch(e){}}}}
return DwtControl.__mouseEvent(o,DwtEvent.ONMOUSEDOWN,n,i)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__mouseMoveHdlr=function(u){
try{
var s=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var n=s?s.targetObj:DwtControl.getTargetControl(u);
if(!n){
return false
}
if(n.__dndHoverActionId!=-1){
AjxTimedAction.cancelAction(n.__dndHoverActionId);
n.__dndHoverActionId=-1
}
var m=DwtShell.mouseEvent;
m.setFromDhtmlEvent(u,s?true:n);
if(m.docX<0||m.docY<0){
m._stopPropagation=true;
m._returnValue=false;
m.setToDhtmlEvent(u);
return false
}
var c=(n._dragSource&&s&&(Math.abs(n.__dragStartX-m.docX)>=DwtControl.__DRAG_THRESHOLD||Math.abs(n.__dragStartY-m.docY)>=DwtControl.__DRAG_THRESHOLD));
var f=(s&&n._dragBox&&n._dragBox._dragObj==n);
if(!c&&!f){
if(n.__hasToolTipContent()){
var h=DwtShell.getShell(window);
var a=h.getHoverMgr();
if(!n.__tooltipClosed&&!DwtMenu.menuShowing()){
a.hoverOver(m.docX,m.docY)
}else{
var i=n.__lastTooltipX?Math.abs(m.docX-n.__lastTooltipX):null;
var t=n.__lastTooltipY?Math.abs(m.docY-n.__lastTooltipY):null;
if((i!=null&&i>DwtControl.__TOOLTIP_THRESHOLD)||(t!=null&&t>DwtControl.__TOOLTIP_THRESHOLD)){
a.setHoverOutListener(n._hoverOutListener);
a.hoverOut();
n.__tooltipClosed=true
}}}
return DwtControl.__mouseEvent(u,DwtEvent.ONMOUSEMOVE,n,m)
}else{
if(n._dragging==DwtControl._NO_DRAG){
if(n._dragSource){
n._dragOp=n._dragSource._beginDrag(n._dragOp,n);
if(n._dragOp!=Dwt.DND_DROP_NONE){
n._dragging=DwtControl._DRAGGING;
n._dndProxy=n._getDragProxy(n._dragOp);
Dwt.addClass(n._dndProxy,"DwtDragProxy");
if(!n._dndProxy){
n._dragging=DwtControl._DRAG_REJECTED
}}else{
n._dragging=DwtControl._DRAG_REJECTED
}}else{
if(n._dragBox){
n._dragging=DwtControl._DRAGGING;
n._dragBox._beginDrag(n)
}}}
if(n._dragging!=DwtControl._DRAG_REJECTED){
var l=m.dwtObj;
if(n._dragSource){
var e=l&&l._dropTarget;
var p=n.__lastTargetObj;
if(l){
n._dndHoverAction.args=[l];
n.__dndHoverActionId=AjxTimedAction.scheduleAction(n._dndHoverAction,DwtControl.__DND_HOVER_DELAY)
}
if(l&&e&&((l!=n)||e.hasMultipleTargets())){
if(l!=p||e.hasMultipleTargets()){
var o=n._dragSource._getData();
if(e._dragEnter(n._dragOp,l,o,m,n._dndProxy)){
n._setDragProxyState(true);
n.__dropAllowed=true;
l._dragEnter(m)
}else{
n._setDragProxyState(false);
n.__dropAllowed=false
}}else{
if(n.__dropAllowed){
l._dragOver(m)
}}}else{
n._setDragProxyState(false)
}
if(p&&p!=l&&p._dropTarget&&p!=n){
if(l&&!l._dndScrollCallback&&p._dndScrollCallback){
p._dndScrollCallback.run(m)
}
p._dragLeave(m);
p._dropTarget._dragLeave()
}
n.__lastTargetObj=l;
if((l!=n)&&l&&l._dndScrollCallback){
l._dndScrollCallback.run(m)
}
Dwt.setLocation(n._dndProxy,m.docX+2,m.docY+2)
}else{
if(n._dragBox){
var r=DwtUiEvent.getTarget(u);
if(l&&(Dwt.isAncestor(n.getHtmlElement(),r)||r==n._dragSelectionBox)){
n._dragBox._dragMove(m,n)
}}}}else{
DwtControl.__mouseEvent(u,DwtEvent.ONMOUSEMOVE,n,m)
}
m._stopPropagation=true;
m._returnValue=false;
m.setToDhtmlEvent(u);
return false
}}
catch(d){
AjxException.reportScriptError(d)
}};
DwtControl.__mouseUpHdlr=function(i){
try{
var n=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var o=n?n.targetObj:DwtControl.getTargetControl(i);
if(!o){
return false
}
if(o.__dndHoverActionId!=-1){
AjxTimedAction.cancelAction(o.__dndHoverActionId);
o.__dndHoverActionId=-1
}
var a=DwtShell.mouseEvent;
a.setFromDhtmlEvent(i,n?true:o);
if(!(n&&(o._dragSource||o._dragBox))){
return DwtControl.__processMouseUpEvent(i,o,a)
}else{
n.release();
if(o._dragging!=DwtControl._DRAGGING){
o._dragging=DwtControl._NO_DRAG;
return DwtControl.__processMouseUpEvent(i,o,a)
}
if(o._dragSource){
o.__lastTargetObj=null;
var t=a.dwtObj;
var s=t&&t._dropTarget;
if(t&&s&&o.__dropAllowed&&((t!=o)||s.hasMultipleTargets())){
t._drop(a);
s._drop(o._dragSource._getData(),a);
o._dragSource._endDrag();
o._destroyDragProxy(o._dndProxy);
o._dragging=DwtControl._NO_DRAG
}else{
DwtControl.__badDrop(o,a)
}
if(t&&t._dndScrollCallback){
t._dndScrollCallback.run(a)
}}else{
if(o._dragBox){
o._dragBox._endDrag(o)
}}
a._stopPropagation=true;
a._returnValue=false;
a.setToDhtmlEvent(i);
return false
}}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__badDrop=function(i,a){
if(i._dragSource){
i._dragSource._cancelDrag()
}
var t=a.dwtObj;
if(t){
t._drop(a)
}
i.__dragEndX=a.docX;
i.__dragEndY=a.docY;
if(i.__badDropAction==null){
i.__badDropAction=new AjxTimedAction(i,i.__badDropEffect)
}
var e=(i.__dragEndY-i.__dragStartY)/(i.__dragEndX-i.__dragStartX);
i.__badDropAction.args=[e,i.__dragStartY-(e*i.__dragStartX),(i.__dragStartX-i.__dragEndX<0)?-1:1];
AjxTimedAction.scheduleAction(i.__badDropAction,0)
};
DwtControl.__processMouseUpEvent=function(i,n,a){
var t=DwtShell.getShell(window);
var o=t.getHoverMgr();
o.ignoreHoverOverOnClick();
if(n._dblClickIsolation&&a&&(a.button==DwtMouseEvent.LEFT)){
if(n._clickPending){
return false
}else{
n._clickPending=true;
var e=new AjxTimedAction(null,DwtControl.__timedClick,[i,n,a]);
n._dblClickActionId=AjxTimedAction.scheduleAction(e,DwtControl.__DBL_CLICK_TIMEOUT);
DwtUiEvent.setBehaviour(i,true,false);
n._st=new Date();
return false
}}else{
n._clickPending=false;
return DwtControl.__mouseEvent(i,DwtEvent.ONMOUSEUP,n,a)
}};
DwtControl.__timedClick=function(t,a,e){
a._clickPending=false;
DwtControl.__mouseEvent(t,DwtEvent.ONMOUSEUP,a,e)
};
DwtControl.__mouseOutHdlr=function(n,o){
try{
var s=DwtControl.getTargetControl(n);
if(!s){
return false
}
o=o||DwtEvent.ONMOUSEOUT;
if((o==DwtEvent.ONMOUSEOUT)&&s._ignoreInternalOverOut){
var e=DwtControl.getTargetControl(n,true);
if(s==e){
return false
}}
if(s.__hasToolTipContent()){
var i=DwtShell.getShell(window);
var a=i.getHoverMgr();
a.setHoverOutListener(s._hoverOutListener);
a.hoverOut();
s.__tooltipClosed=false
}
return DwtControl.__mouseEvent(n,o||DwtEvent.ONMOUSEOUT,s)
}
catch(t){
AjxException.reportScriptError(t)
}};
DwtControl.__mouseLeaveHdlr=function(e){
return DwtControl.__mouseOutHdlr(e,DwtEvent.ONMOUSELEAVE)
};
DwtControl.__mouseWheelHdlr=function(t){
try{
return DwtControl.__mouseEvent(t,DwtEvent.ONMOUSEWHEEL)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__selectStartHdlr=function(t){
try{
return DwtControl.__mouseEvent(t,DwtEvent.ONSELECTSTART)
}
catch(e){
AjxException.reportScriptError(e)
}};
DwtControl.__contextMenuHdlr=function(a){
try{
if(AjxEnv.isSafari){
var i=DwtControl.getTargetControl(a);
var e=i?i.preventContextMenu():true;
if(e){
DwtControl.__mouseEvent(a,DwtEvent.ONMOUSEDOWN);
return DwtControl.__mouseEvent(a,DwtEvent.ONMOUSEUP)
}}
return DwtControl.__mouseEvent(a,DwtEvent.ONCONTEXTMENU)
}
catch(t){
AjxException.reportScriptError(t)
}};
DwtControl.__mouseEvent=function(o,a,n,i){
var n=n?n:DwtControl.getTargetControl(o);
if(!n){
return false
}
if(!i){
i=DwtShell.mouseEvent;
i.setFromDhtmlEvent(o,n)
}
var t=i.target.tagName&&i.target.tagName.toLowerCase();
var e=n._propagateEvent[a]||(t==="input"||t==="textarea"||t==="a"||t==="label"||t==="select");
i._stopPropagation=!e;
i._dontCallPreventDefault=e;
i._returnValue=e;
DwtEventManager.notifyListeners(a,i);
if(n.isListenerRegistered&&n.isListenerRegistered(a)){
n.notifyListeners(a,i)
}
i.setToDhtmlEvent(o);
if(a==DwtEvent.ONMOUSELEAVE||a==DwtEvent.ONMOUSEOUT){
n.__ignoreNextClick=false
}else{
if(a==DwtEvent.ONMOUSEUP){
n.__ignoreNextClick=true
}else{
if(a==DwtEvent.ONCLICK){
if(n.__ignoreNextClick){
DBG.println(AjxDebug.ACCESSIBILITY,"DwtControl: ignoring a click!");
n.__ignoreNextClick=false;
return true
}
if(n.isListenerRegistered&&!n.isListenerRegistered(DwtEvent.ONCLICK)){
DBG.println(AjxDebug.ACCESSIBILITY,"DwtControl: faking a click!");
a=DwtEvent.ONMOUSEDOWN;
if(o){
o.type=a
}
DwtControl.__mouseEvent(o,a,n,DwtShell.mouseEvent);
a=DwtEvent.ONMOUSEUP;
if(o){
o.type=a
}
DwtControl.__mouseEvent(o,a,n,DwtShell.mouseEvent);
return DwtShell.mouseEvent._returnValue
}else{
DBG.println(AjxDebug.ACCESSIBILITY,"DwtControl: skipping a click!");
window.console&&console.warn("skipping a click!")
}}}}
return i._returnValue
};
DwtControl.__HANDLER={};
DwtControl.__HANDLER[DwtEvent.ONCONTEXTMENU]=DwtControl.__contextMenuHdlr;
DwtControl.__HANDLER[DwtEvent.ONCLICK]=DwtControl.__clickHdlr;
DwtControl.__HANDLER[DwtEvent.ONDBLCLICK]=DwtControl.__dblClickHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEDOWN]=DwtControl.__mouseDownHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEENTER]=DwtControl.__mouseEnterHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSELEAVE]=DwtControl.__mouseLeaveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEMOVE]=DwtControl.__mouseMoveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOUT]=DwtControl.__mouseOutHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOVER]=DwtControl.__mouseOverHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEUP]=DwtControl.__mouseUpHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEWHEEL]=DwtControl.__mouseWheelHdlr;
DwtControl.__HANDLER[DwtEvent.ONSELECTSTART]=DwtControl.__selectStartHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYPRESS]=DwtControl.__keyPressHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYUP]=DwtControl.__keyUpHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYDOWN]=DwtControl.__keyDownHdlr;
DwtControl.__HANDLER[DwtEvent.ONFOCUS]=DwtControl.__focusHdlr;
DwtControl.__HANDLER[DwtEvent.ONBLUR]=DwtControl.__blurHdlr;
DwtControl.prototype.__initCtrl=function(){
this.shell=this.parent.shell||this.parent;
this._htmlElId=this.__internalId=this._htmlElId||Dwt.getNextId();
var e=this._elRef=this._createElement(this._htmlElId);
e.id=this._htmlElId;
if(DwtControl.ALL_BY_ID[this._htmlElId]){
this._htmlElId=e.id=this.__internalId=DwtId.makeId(this._htmlElId,Dwt.getNextId())
}
DwtControl.ALL_BY_ID[this._htmlElId]=this;
DwtComposite._pendingElements[this._htmlElId]=e;
e.style.position=this.__posStyle||DwtControl.STATIC_STYLE;
e.className=this._className;
e.style.overflow="visible";
if(this.role){
e.setAttribute("role",this.role)
}
this._enabled=true;
this.__controlEvent=DwtControl.__controlEvent;
this._dragging=DwtControl._NO_DRAG;
this.__ctrlInited=true;
this.setFocusElement();
this._focusAction=new AjxTimedAction(null,DwtControl.__focusHdlr,[DwtShell.focusEvent,DwtEvent.ONFOCUS,this]);
this._blurAction=new AjxTimedAction(null,DwtControl.__blurHdlr,[DwtShell.focusEvent,DwtEvent.ONBLUR,this]);
this.parent.addChild(this,this.__index)
};
DwtControl.prototype._createElement=function(e){
return document.createElement("DIV")
};
DwtControl.prototype.__dndDoHover=function(e){
e._dragHover()
};
DwtControl.prototype.__badDropEffect=function(e,o,a){
var t=(Math.abs(e)<=1);
var i=t?this.__dragStartX-this.__dragEndX:this.__dragStartY-this.__dragEndY;
if(i*a>0&&!(this.__dragEndY==this.__dragStartY||this.__dragEndX==this.__dragStartX)){
if(t){
this.__dragEndX+=(30*a);
this._dndProxy.style.top=e*this.__dragEndX+o;
this._dndProxy.style.left=this.__dragEndX
}else{
this.__dragEndY+=(30*a);
this._dndProxy.style.top=this.__dragEndY;
this._dndProxy.style.left=(this.__dragEndY-o)/e
}
AjxTimedAction.scheduleAction(this.__badDropAction,0)
}else{
this._destroyDragProxy(this._dndProxy);
this._dragging=DwtControl._NO_DRAG
}};
DwtControl.prototype.__handleHoverOver=function(i){
if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROVER)){
this._eventMgr.notifyListeners(DwtEvent.HOVEROVER,i)
}
var a=i&&i.object;
var o=this.getToolTipContent(a);
var t,n;
if(!o){
t=""
}else{
if(typeof(o)=="string"){
t=o
}else{
if(o.isAjxCallback||AjxUtil.isFunction(o)){
n=o
}else{
if(typeof(o)=="object"){
t=o.content;
n=o.callback
}}}}
if(!t&&n&&o.loading){
t=AjxMsg.loading
}
if(t){
this.__showToolTip(i,t)
}
if(n){
var e=new AjxCallback(this,this.__showToolTip,[i]);
AjxTimedAction.scheduleAction(new AjxTimedAction(null,function(){
n.run(e)
}
),0)
}};
DwtControl.prototype.__showToolTip=function(t,e){
if(!e){
return
}
DwtControl.showToolTip(e,t.x,t.y,this,t);
this.__lastTooltipX=t.x;
this.__lastTooltipY=t.y;
this.__tooltipClosed=false
};
DwtControl.prototype.__handleHoverOut=function(e){
if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROUT)){
this._eventMgr.notifyListeners(DwtEvent.HOVEROUT,e)
}
DwtControl.hideToolTip();
this.__lastTooltipX=null;
this.__lastTooltipY=null
};
DwtControl.prototype.__isInputEl=function(a){
var i=false;
if(!a||!a.tagName){
return i
}
var e=a.tagName.toLowerCase();
var t=e=="input"?a.type.toLowerCase():null;
if(e=="textarea"||(t&&(t=="text"||t=="password"))){
i=true
}
return i
};
DwtControl.ON_UNLOAD=function(){
var t=DwtControl.ALL_BY_ID,e;
for(e in t){
t[e]._elRef=null
}
DwtControl.ALL_BY_ID={}
};
if(window.attachEvent){
window.attachEvent("onunload",DwtControl.ON_UNLOAD)
}else{
if(window.addEventListener){
window.addEventListener("unload",DwtControl.ON_UNLOAD,false)
}}
DwtControl.showToolTip=function(t,e,n,i,o){
if(!t){
return
}
var a=DwtShell.getShell(window).getToolTip();
a.setContent(t);
a.popup(e,n,false,false,i,o)
};
DwtControl.hideToolTip=function(){
DwtShell.getShell(window).getToolTip().popdown()
};
DwtControl.prototype.getTooltipBase=function(e){
return this.getHtmlElement()
};
DwtControl.prototype.boundsForChild=function(a){
if(a&&a.getHtmlElement){
a=a.getHtmlElement()
}
var e=function(o,i){
var n=Dwt.getMargins(i);
var o=Dwt.insetBounds(o,Dwt.getInsets(i));
o.width=Math.max(o.width-n.left-n.right,0);
o.height=Math.max(o.height-n.top-n.bottom,0);
return o
};
var t=new DwtRectangle(0,0,this.getHtmlElement().clientWidth,this.getHtmlElement().clientHeight);
return AjxUtil.reduce(Dwt.getAncestors(a,this.getHtmlElement(),true),e,t)
};
DwtControl.prototype.hasAttribute=function(e){
return this.getHtmlElement().hasAttribute(e)
};
DwtControl.prototype.getAttribute=function(e){
return this.getHtmlElement().getAttribute(e)
};
DwtControl.prototype.setAttribute=function(e,t){
this.getHtmlElement().setAttribute(e,t)
};
DwtControl.prototype.removeAttribute=function(e){
this.getHtmlElement().removeAttribute(e)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtComposite")){
DwtComposite=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtComposite.PARAMS);
t.className=t.className||"DwtComposite";
DwtControl.call(this,t);
var e=this.toString();
if(e=="DwtComposite"){
e=this.getHTMLElId()
}
this._compositeTabGroup=new DwtTabGroup(e+" (DwtComposite)");
this._children=new AjxVector()
};
DwtComposite.PARAMS=DwtControl.PARAMS.concat();
DwtComposite.prototype=new DwtControl;
DwtComposite.prototype.constructor=DwtComposite;
DwtComposite.prototype.isDwtComposite=true;
DwtComposite.prototype.toString=function(){
return"DwtComposite"
};
DwtComposite._pendingElements=new Object();
DwtComposite.prototype.dispose=function(){
if(this._disposed){
return
}
var e=this._children.getArray();
while(e.length>0){
e.pop().dispose()
}
if(this._compositeTabGroup){
this._compositeTabGroup.removeAllMembers()
}
this._compositeTabGroup=null;
DwtControl.prototype.dispose.call(this)
};
DwtComposite.prototype.getChildren=function(){
return this._children.getArray().slice(0)
};
DwtComposite.prototype.getChild=function(e){
return this._children.get(e)
};
DwtComposite.prototype.cleanupSeparators=function(){
var t=this.getChildren();
var a=true;
var n;
for(var o=0;
o<t.length;
o++){
var s=t[o];
var e=s.isStyle&&s.isStyle(DwtMenuItem.SEPARATOR_STYLE);
if(e){
s.setVisible(!a);
if(!a||!n){
a=true;
n=s
}
continue
}
if(s.getVisible()){
a=false
}}
if(a&&n){
n.setVisible(false)
}};
DwtComposite.prototype.getNumChildren=function(){
return this._children.size()
};
DwtComposite.prototype.removeChildren=function(){
var e=this._children.getArray();
while(e.length>0){
e[0].dispose()
}
if(this._compositeTabGroup){
this._compositeTabGroup.removeAllMembers()
}};
DwtComposite.prototype.clear=function(){
this.removeChildren();
this.getHtmlElement().innerHTML=""
};
DwtComposite.prototype.addChild=function(a,e){
this._children.add(a,e);
this._compositeTabGroup.addMember(a,e);
var t=a.getHtmlElement();
t.setAttribute("parentId",this._htmlElId);
if(this instanceof DwtShell&&this.isVirtual()){
document.body.appendChild(t)
}else{
a.reparentHtmlElement(a.__parentElement||this.getHtmlElement(),e);
a.__parentElement=null
}};
DwtComposite.prototype.removeChild=function(a){
if(a.isInitialized()){
this._children.remove(a);
this._compositeTabGroup.removeMember(a);
var t=a.getHtmlElement();
if(t){
t.removeAttribute("parentId");
if(t.parentNode){
var e=t.parentNode.removeChild(t)
}}}};
DwtComposite.prototype.getTabGroupMember=function(){
return this.tabGroupMember||(this.getNumChildren()>0?this._compositeTabGroup:this)
};
DwtComposite.prototype._setAllowSelection=function(){
if(!this._allowSelection){
this._allowSelection=true;
this.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));
this.addListener(DwtEvent.ONCONTEXTMENU,new AjxListener(this,this._contextMenuListener))
}};
DwtComposite.prototype.preventSelection=function(e){
return this._allowSelection?false:DwtControl.prototype.preventSelection.call(this,e)
};
DwtComposite.prototype.preventContextMenu=function(a){
if(!this._allowSelection){
return DwtControl.prototype.preventContextMenu.apply(this,arguments)
}
var e=a?(a.id.indexOf("OBJ_")==0):false;
var t=false;
if(document.selection){
t=document.selection.type=="Text"
}else{
if(getSelection()){
t=getSelection().toString().length>0
}}
return(t&&!e)?false:true
};
DwtComposite.prototype._focusByMouseUpEvent=function(){
if(!this._allowSelection){
DwtControl.prototype._focusByMouseUpEvent.apply(this,arguments)
}};
DwtComposite.prototype._mouseDownListener=function(e){
if(e.button==DwtMouseEvent.LEFT){
e._stopPropagation=true;
e._returnValue=true
}};
DwtComposite.prototype._contextMenuListener=function(e){
e._stopPropagation=false;
e._returnValue=true
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtShell")){
DwtShell=function(o){
if(window._dwtShellId){
throw new DwtException("DwtShell already exists for window",DwtException.INVALID_OP,"DwtShell")
}
var a=o.className||"DwtShell";
DwtComposite.call(this,{
className:a}
);
this.__ctrlInited=true;
document.body.style.margin=0;
if(!o.docBodyScrollable){
if(AjxEnv.isIE){
document.body.onscroll=DwtShell.__onBodyScroll
}
document.body.style.overflow="hidden"
}
document.body.onselect=DwtShell._preventDefaultSelectPrt;
document.body.onselectstart=DwtShell._preventDefaultSelectPrt;
document.body.oncontextmenu=DwtShell._preventDefaultPrt;
window.onresize=DwtShell._resizeHdlr;
var i=document.createElement("div");
this._htmlElId=window._dwtShellId=i.id=o.id||Dwt.getNextId();
DwtControl.ALL_BY_ID[this._htmlElId]=this;
i.className=a;
i.style.width=i.style.height="100%";
Dwt.setPosition(i,DwtControl.ABSOLUTE_STYLE);
if(i.style.overflow){
i.style.overflow=null
}
try{
if(o.userShell){
document.body.removeChild(o.userShell)
}}
catch(t){}
document.body.appendChild(i);
if(o.userShell){
var e=new DwtControl({
parent:this,posStyle:Dwt.ABSOLUTE_STYLE}
);
e.getHtmlElement().appendChild(o.userShell);
e.setSize("100%","100%");
e.zShow(true);
this._userShell=o.userShell
}else{
this._userShell=null
}
this.shell=this;
this._createBusyOverlay(i);
this._veilOverlay=document.createElement("div");
this._veilOverlay.className=(!AjxEnv.isLinux)?"VeilOverlay":"VeilOverlay-linux";
this._veilOverlay.style.position="absolute";
this._veilOverlay.style.cursor=AjxEnv.isIE6up?"not-allowed":"wait";
Dwt.setBounds(this._veilOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._veilOverlay,Dwt.Z_HIDDEN);
this._veilOverlay.veilZ=new Array();
this._veilOverlay.veilZ.push(Dwt.Z_HIDDEN);
this._veilOverlay.dialogZ=new Array();
this._veilOverlay.activeDialogs=new Array();
this._veilOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
i.appendChild(this._veilOverlay);
if(o.useCurtain){
this._curtainOverlay=document.createElement("div");
this._curtainOverlay.className="CurtainOverlay";
this._curtainOverlay.style.position="absolute";
Dwt.setBounds(this._curtainOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._curtainOverlay,Dwt.Z_CURTAIN);
this._curtainOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
i.appendChild(this._curtainOverlay)
}
this._uiEvent=new DwtUiEvent(true);
this.relayout();
this._toolTip=new DwtToolTip(this);
this._hoverMgr=new DwtHoverMgr();
this._keyboardMgr=new DwtKeyboardMgr(this)
};
DwtShell.prototype=new DwtComposite;
DwtShell.prototype.constructor=DwtShell;
DwtShell.CANCEL_BUTTON=-1;
DwtShell.controlEvent=new DwtControlEvent();
DwtShell.focusEvent=new DwtFocusEvent();
DwtShell.keyEvent=new DwtKeyEvent();
DwtShell.mouseEvent=new DwtMouseEvent();
DwtShell.selectionEvent=new DwtSelectionEvent(true);
DwtShell.treeEvent=new DwtTreeEvent();
DwtShell._GLOBAL_SELECTION="GlobalSelection";
DwtShell.prototype.toString=function(){
return"DwtShell"
};
DwtShell.getShell=function(e){
e=e||window;
return DwtControl.fromElementId(e._dwtShellId)
};
DwtShell.prototype.getKeyboardMgr=function(){
return this._keyboardMgr
};
DwtShell.prototype.setBusy=function(i,o,t,a,e){
if(i){
this._setBusyCount++
}else{
if(this._setBusyCount>0){
this._setBusyCount--
}}
if(!this._setBusy&&(this._setBusyCount>0)){
Dwt.setCursor(this._busyOverlay,"wait");
Dwt.setVisible(this._busyOverlay,true);
this._setBusy=this._blockInput=true
}else{
if(this._setBusy&&(this._setBusyCount<=0)){
Dwt.setCursor(this._busyOverlay,"default");
Dwt.setVisible(this._busyOverlay,false);
this._setBusy=this._blockInput=false
}}
if(i&&t){
if(a&&a>0){
this._busyActionId[o]=AjxTimedAction.scheduleAction(this._busyTimedAction,a)
}else{
this._showBusyDialogAction(o)
}
this._cancelBusyCallback=e;
if(this._busyDialog){
this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(e!=null))
}}else{
if(this._busyActionId[o]&&(this._busyActionId[o]!=-1)){
AjxTimedAction.cancelAction(this._busyActionId[o]);
this._busyActionId[o]=-1
}
if(this._busyDialog&&this._busyDialog.isPoppedUp){
this._busyDialog.popdown()
}}};
DwtShell.prototype.getBusy=function(){
return this._setBusy
};
DwtShell.prototype.setBusyDialogText=function(e){
this._busyDialogText=e;
if(this._busyDialogTxt){
this._busyDialogTxt.innerHTML=(e)?e:""
}};
DwtShell.prototype.setBusyDialogTitle=function(e){
this._busyDialogTitle=e;
if(this._busyDialog){
this._busyDialog.setTitle((e)?e:AjxMsg.workInProgress)
}};
DwtShell.prototype.getHoverMgr=function(){
return this._hoverMgr
};
DwtShell.prototype.getToolTip=function(){
return this._toolTip
};
DwtShell.prototype.getH=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e).y:Dwt.getSize(document.body,e).y
};
DwtShell.prototype.getW=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e).x:Dwt.getSize(document.body,e).x
};
DwtShell.prototype.getSize=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e):Dwt.getSize(document.body,e)
};
DwtShell.prototype.getLocation=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()):Dwt.getLocation(document.body)
};
DwtShell.prototype.getX=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).x:Dwt.getLocation(document.body).x
};
DwtShell.prototype.getY=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).y:Dwt.getLocation(document.body).y
};
DwtShell.prototype.getBounds=function(e){
return(!this._virtual)?Dwt.getBounds(this.getHtmlElement(),e):Dwt.getBounds(document.body,e)
};
DwtShell.prototype.setVirtual=function(){
this._virtual=true;
this.setVisible(false)
};
DwtShell.prototype.addFocusListener=function(e){
if(!this._hasFocusHandler){
var t=document;
if((typeof t.onfocusin!="undefined")&&t.attachEvent){
t.attachEvent("onfocusin",DwtShell.__focusHdlr)
}else{
if(window.addEventListener){
window.addEventListener("focus",DwtShell.__focusHdlr,false)
}}
this._hasFocusHandler=true
}
this.addListener(DwtEvent.ONFOCUS,e)
};
DwtShell.prototype.addBlurListener=function(e){
if(!this._hasBlurHandler){
var t=document;
if((typeof t.onfocusin!="undefined")&&t.attachEvent){
t.attachEvent("onfocusout",DwtShell.__blurHdlr)
}else{
if(window.addEventListener){
window.addEventListener("blur",DwtShell.__blurHdlr,false)
}}
this._hasBlurHandler=true
}
this.addListener(DwtEvent.ONBLUR,e)
};
DwtShell.prototype.addGlobalSelectionListener=function(e){
this.addListener(DwtShell._GLOBAL_SELECTION,e)
};
DwtShell.prototype.removeGlobalSelectionListener=function(e){
this.removeListener(DwtShell._GLOBAL_SELECTION,e)
};
DwtShell.prototype.notifyGlobalSelection=function(e){
this.notifyListeners(DwtShell._GLOBAL_SELECTION,e)
};
DwtShell.prototype.isVirtual=function(){
return this._virtual
};
DwtShell.prototype._showBusyDialogAction=function(t){
var e=this._getBusyDialog();
e.popup();
this._busyActionId[t]=-1
};
DwtShell.prototype._createBusyOverlay=function(e){
this._busyOverlay=document.createElement("div");
this._busyOverlay.className=(!AjxEnv.isLinux)?"BusyOverlay":"BusyOverlay-linux";
this._busyOverlay.style.position="absolute";
Dwt.setBounds(this._busyOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._busyOverlay,Dwt.Z_VEIL);
this._busyOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
e.appendChild(this._busyOverlay);
Dwt.setVisible(this._busyOverlay,false);
this._busyTimedAction=new AjxTimedAction(this,this._showBusyDialogAction);
this._busyActionId={};
this._setBusyCount=0;
this._setBusy=false
};
DwtShell.prototype._getBusyDialog=function(a){
if(!this._busyDialog){
var i=new DwtDialog_ButtonDescriptor(DwtShell.CANCEL_BUTTON,AjxMsg.cancelRequest,DwtDialog.ALIGN_CENTER);
this._busyDialog=new DwtDialog({
parent:this,className:"DwtShellBusyDialog",title:AjxMsg.workInProgress,standardButtons:DwtDialog.NO_BUTTONS,extraButtons:[i],zIndex:Dwt.BUSY+10}
);
this._busyDialog.registerCallback(DwtShell.CANCEL_BUTTON,this._busyCancelButtonListener,this);
var t=Dwt.getNextId();
var e=["<table class='DialogContent'><tr>","<td><div class='WaitIcon'></div></td><td class='MsgText' id='",t,"'>&nbsp;</td>","</tr></table>"].join("");
this._busyDialog.setContent(e);
this._busyDialogTxt=document.getElementById(t);
if(this._busyDialogText){
this._busyDialogTxt.innerHTML=this._busyDialogText
}
if(this._busyDialogTitle){
this._busyDialog.setTitle(this._busyDialogTitle)
}
this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(this._cancelBusyCallback!=null))
}
return this._busyDialog
};
DwtShell.prototype.relayout=function(){
this._currWinSize=Dwt.getWindowSize();
if(this._userShell){
var e=Dwt.byClassName("skin_layout_filler",this._userShell);
AjxUtil.foreach(e,function(a){
if(Dwt.hasClass(a,"skin_layout_row")){
var l=a;
var h=l.parentNode;
var r=Dwt.getSize(h).y;
var o=0;
var i=Dwt.getInsets(h);
r-=i.top+i.bottom;
var n=Dwt.getMargins(l);
r-=n.top+n.bottom;
AjxUtil.foreach(h.children,function(d){
var u=Dwt.getMargins(d);
r-=u.top+u.bottom;
if(Dwt.hasClass(d,"skin_layout_filler")){
o+=1
}else{
var c=Dwt.getSize(d).y;
AjxUtil.foreach(d.children,function(f){
var p=Dwt.getMargins(f);
var m=Dwt.getSize(f).y+p.top+p.bottom;
c=Math.max(c,m)
}
);
r-=c
}}
);
l.style.height=Math.max(r/o,0)+"px"
}else{
if(Dwt.hasClass(a,"skin_layout_cell")){
var s=a;
var l=s.parentNode;
var h=l.parentNode;
var t=Dwt.getSize(h).x;
var o=0;
var i=Dwt.getInsets(h);
t-=i.left+i.right;
var n=Dwt.getMargins(l);
t-=n.left+n.right;
AjxUtil.foreach(l.children,function(c){
var d=Dwt.getMargins(c);
t-=d.left+d.right;
if(Dwt.hasClass(c,"skin_layout_filler")){
o+=1
}else{
if(s.id==="skin_td_main"&&c.id==="skin_td_tree_app_sash"&&AjxEnv.isChrome&&!AjxUtil.isInt(window.devicePixelRatio)){
t-=3
}
t-=Dwt.getSize(c).x
}}
);
s.style.width=Math.max(t/o,0)+"px"
}else{
if(window.console){
console.warn("not fixing sizes for element!",a)
}}}}
)
}};
DwtShell.prototype._busyCancelButtonListener=function(e){
this._cancelBusyCallback.run();
if(this._busyDialog){
this._busyDialog.popdown()
}};
DwtShell._preventDefaultSelectPrt=function(t){
var e=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
e.setFromDhtmlEvent(t,true);
if(e.dwtObj&&e.dwtObj instanceof DwtControl&&!e.dwtObj.preventSelection(e.target)){
e._stopPropagation=false;
e._returnValue=true
}else{
e._stopPropagation=true;
e._returnValue=false
}
e.setToDhtmlEvent(t);
return !e._stopPropagation
};
DwtShell._preventDefaultPrt=function(t){
t=DwtUiEvent.getEvent(t);
var a=t.target?t.target:t.srcElement;
var e=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
e.setFromDhtmlEvent(t,true);
e._stopPropagation=true;
e._returnValue=false;
if(e.dwtObj&&e.dwtObj instanceof DwtControl&&!e.dwtObj.preventContextMenu(e.target)){
e._stopPropagation=false;
e._returnValue=true
}else{
if(a!=null&&typeof(a)=="object"){
if((a.tagName=="A"||a.tagName=="a")&&a.href){
e._stopPropagation=false;
e._returnValue=true
}}}
e.setToDhtmlEvent(t);
return e._returnValue
};
DwtShell._resizeHdlr=function(a){
var t=DwtControl.fromElementId(window._dwtShellId);
if(t.isListenerRegistered(DwtEvent.CONTROL)){
var e=DwtShell.controlEvent;
e.reset();
e.oldWidth=t._currWinSize.x;
e.oldHeight=t._currWinSize.y;
t.relayout();
e.newWidth=t._currWinSize.x;
e.newHeight=t._currWinSize.y;
t.notifyListeners(DwtEvent.CONTROL,e)
}else{
t.relayout()
}};
DwtShell.__onBodyScroll=function(){
document.body.scrollTop=0;
document.body.scrollLeft=0
};
DwtShell.__focusHdlr=function(){
var t=DwtShell.focusEvent;
var e=DwtShell.getShell(window);
t.dwtObj=e;
t.state=DwtFocusEvent.FOCUS;
e.notifyListeners(DwtEvent.ONFOCUS,t)
};
DwtShell.__blurHdlr=function(){
var t=DwtShell.focusEvent;
var e=DwtShell.getShell(window);
t.dwtObj=e;
t.state=DwtFocusEvent.BLUR;
e.notifyListeners(DwtEvent.ONBLUR,t)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtColorPicker")){
DwtColorPicker=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtColorPicker.PARAMS);
e.className=e.className||"DwtColorPicker";
DwtComposite.call(this,e);
this._hideNoFill=e.hideNoFill;
this._noFillLabel=e.noFillLabel;
this._allowColorInput=e.allowColorInput;
this._defaultColor=e.defaultColor||"#000000";
this._createHtml()
};
DwtColorPicker.prototype=new DwtComposite;
DwtColorPicker.prototype.constructor=DwtColorPicker;
DwtColorPicker.prototype.toString=function(){
return"DwtColorPicker"
};
DwtColorPicker.PARAMS=["parent","className","posStyle","noFillLabel","allowColorInput","defaultColor"];
DwtColorPicker._RGB_RE=/^rgb\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)$/;
DwtColorPicker._HEX_RE=/^\#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i;
DwtColorPicker.prototype.TEMPLATE="dwt.Widgets#DwtColorPicker";
DwtColorPicker.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
DwtColorPicker.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtColorPicker.prototype.dispose=function(){
if(this._disposed){
return
}
DwtControl.prototype.dispose.call(this)
};
DwtColorPicker.prototype._createHtml=function(e){
this._createHtmlFromTemplate(e||this.TEMPLATE,{
id:this.getHtmlElement().id}
)
};
DwtColorPicker.prototype._createHtmlFromTemplate=function(t,n){
n.allowColorInput=this._allowColorInput;
n.hideNoFill=this._hideNoFill;
n.noFillLabel=this._noFillLabel;
DwtComposite.prototype._createHtmlFromTemplate.apply(this,arguments);
if(n.allowColorInput){
var u=document.getElementById(n.id+"_input");
var h={
parent:this,validationStyle:DwtInputField.CONTINUAL_VALIDATION,errorIconStyle:DwtInputField.ERROR_ICON_RIGHT,validator:DwtColorPicker.__isValidInputValue};
var d=this._colorInput=new DwtInputField(h);
d.replaceElement(u);
var i=new AjxCallback(this,this._updatePreview);
d.setValidationCallback(i);
var c=this._error=new DwtLabel({
parent:this}
);
var e=document.getElementById(n.id+"_error");
c.replaceElement(e);
c.setVisible(false);
this._preview=document.getElementById(n.id+"_preview");
var l=document.getElementById(n.id+"_button");
var s=new DwtButton({
parent:this}
);
s.setText(AjxMsg.setColor);
s.replaceElement(l);
s.addSelectionListener(new AjxListener(this,this._handleSetColor))
}
var l=document.getElementById(n.id+"_default");
if(l){
if(!DwtColorPicker.Button){
DwtColorPicker.__defineClasses()
}
var s=this._defaultColorButton=new DwtColorPicker.Button({
parent:this}
);
s.setText(n.noFillLabel||AjxMsg.colorsUseDefault);
s.replaceElement(l);
s.addSelectionListener(new AjxListener(this,this._handleColorSelect,[0]))
}
var o=document.getElementById(n.id+"_colors");
var a=AjxEnv.isIE?DwtEvent.ONMOUSEENTER:DwtEvent.ONMOUSEOVER;
var r=AjxEnv.isIE?DwtEvent.ONMOUSELEAVE:DwtEvent.ONMOUSEOUT;
Dwt.setHandler(o,DwtEvent.ONMOUSEDOWN,AjxCallback.simpleClosure(this._handleMouseDown,this));
Dwt.setHandler(o,DwtEvent.ONMOUSEUP,AjxCallback.simpleClosure(this._handleMouseUp,this));
Dwt.setHandler(o,a,AjxCallback.simpleClosure(this._handleMouseOver,this));
Dwt.setHandler(o,r,AjxCallback.simpleClosure(this._handleMouseOut,this))
};
DwtColorPicker.prototype._handleMouseOver=function(e){
var t=DwtUiEvent.getEvent(e);
var a=DwtUiEvent.getTarget(t);
if(!Dwt.hasClass(a,"Color")){
return
}
this._handleMouseOut(e);
Dwt.addClass(a,DwtControl.HOVER);
this._mouseOverEl=a
};
DwtColorPicker.prototype._handleMouseOut=function(e){
if(this._mouseOverEl){
Dwt.delClass(this._mouseOverEl,DwtControl.HOVER)
}
this._mouseOverEl=null
};
DwtColorPicker.prototype._handleMouseDown=function(e){
var t=DwtUiEvent.getEvent(e);
var a=DwtUiEvent.getTarget(t);
this._mouseDownEl=Dwt.hasClass(a,"Color")?a:null
};
DwtColorPicker.prototype._handleMouseUp=function(e){
var t=DwtUiEvent.getEvent(e);
var i=DwtUiEvent.getTarget(t);
if(this._mouseDownEl!=i){
return
}
var a=DwtCssStyle.getProperty(i,"background-color");
this._handleColorSelect(DwtColorPicker.__color2hex(a))
};
DwtColorPicker.prototype._handleSetColor=function(e){
var t=this._colorInput.getValue();
if(t){
t=DwtColorPicker.__color2hex(t);
if(!t){
return
}
this._handleColorSelect(t)
}};
DwtColorPicker.prototype._handleColorSelect=function(e){
this._inputColor=e;
if(this.parent instanceof DwtMenu){
DwtMenu.closeActiveMenu()
}
if(this.isListenerRegistered(DwtEvent.SELECTION)){
var t=DwtShell.selectionEvent;
t.item=this;
t.detail=this._inputColor;
this.notifyListeners(DwtEvent.SELECTION,t)
}};
DwtColorPicker.prototype.getInputColor=function(){
return this._inputColor
};
DwtColorPicker.prototype.setDefaultColor=function(e){
if(this._defaultColorButton){
this._defaultColorButton.setDefaultColor(e)
}};
DwtColorPicker.__color2hex=function(a){
if(a=="white"){
return"#FFFFFF"
}
if(a=="black"){
return"#000000"
}
var e=a&&a.match(DwtColorPicker._RGB_RE);
if(e){
for(var t=1;
t<=3;
t++){
if(parseInt(e[t])>255){
return""
}}
return AjxColor.color(e[1],e[2],e[3])
}
e=a&&a.match(DwtColorPicker._HEX_RE);
if(e){
return a
}
return""
};
DwtColorPicker.__isValidInputValue=function(e){
if(!e){
return e
}
var t=DwtColorPicker.__color2hex(e);
if(!t){
throw AjxMsg.colorFormatError
}
return e
};
DwtColorPicker.prototype._updatePreview=function(a,t,e){
if(t){
e=DwtColorPicker.__color2hex(e);
Dwt.setVisible(this._preview,true);
this._preview.style.backgroundColor=e;
this._error.setVisible(false)
}else{
Dwt.setVisible(this._preview,false);
this._error.setVisible(true);
this._error.setText(AjxMsg.colorFormatError)
}};
DwtColorPicker.__defineClasses=function(){
DwtColorPicker.Button=function(e){
e.className=e.className||"DwtColorPickerButton";
DwtButton.call(this,e);
this._colorDiv=document.getElementById(this.getHtmlElement().id+"_color")
};
DwtColorPicker.Button.prototype=new DwtButton;
DwtColorPicker.Button.prototype.constructor=DwtColorPicker.Button;
DwtColorPicker.Button.prototype.setDefaultColor=function(e){
this._colorDiv.style.backgroundColor=(e===null)?"":e
};
DwtColorPicker.Button.prototype.toString=function(){
return"DwtColorPickerButton"
};
DwtColorPicker.Button.prototype.TEMPLATE="dwt.Widgets#DwtColorPickerButton"
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtBaseDialog")){
DwtBaseDialog=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtBaseDialog.PARAMS);
var e=t.parent;
if(!(e instanceof DwtShell)){
throw new DwtException("DwtBaseDialog parent must be a DwtShell",DwtException.INVALIDPARENT,"DwtDialog")
}
t.className=t.className||"DwtBaseDialog";
t.posStyle=DwtControl.ABSOLUTE_STYLE;
t.isFocusable=false;
this._title=t.title||"";
DwtComposite.call(this,t);
this._disposeOnPopDown=t.disposeOnPopDown||false;
this._shell=e;
this._zIndex=t.zIndex||Dwt.Z_DIALOG;
this._mode=t.mode||DwtBaseDialog.MODAL;
this._loc=new DwtPoint();
if(t.loc){
this._loc.x=t.loc.x;
this._loc.y=t.loc.y
}else{
this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
}
this._tabGroup=new DwtTabGroup(this.toString());
this._dragHandleId=t.dragHandleId||this._htmlElId+"_handle";
this._createHtml();
this._initializeDragging(this._dragHandleId);
if(t.view){
this.setView(t.view)
}
this.setZIndex(Dwt.Z_HIDDEN);
this.setVisible(true);
this._position(DwtBaseDialog.__nowhereLoc);
this._propagateEvent[DwtEvent.ONMOUSEUP]=true
};
DwtBaseDialog.PARAMS=["parent","className","title","zIndex","mode","loc","view","dragHandleId","id"];
DwtBaseDialog.prototype=new DwtComposite;
DwtBaseDialog.prototype.constructor=DwtBaseDialog;
DwtBaseDialog.prototype.toString=function(){
return"DwtBaseDialog"
};
DwtBaseDialog.prototype.isDwtBaseDialog=true;
DwtBaseDialog.prototype.role="dialog";
DwtBaseDialog.prototype.isFocusable=true;
DwtBaseDialog.MODELESS=1;
DwtBaseDialog.MODAL=2;
DwtBaseDialog.__nowhereLoc=new DwtPoint(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
DwtBaseDialog.prototype.TEMPLATE="dwt.Widgets#DwtBaseDialog";
DwtBaseDialog.prototype.CONTROLS_TEMPLATE=null;
DwtBaseDialog.prototype.addPopupListener=function(e){
this.addListener(DwtEvent.POPUP,e)
};
DwtBaseDialog.prototype.removePopupListener=function(e){
this.removeListener(DwtEvent.POPUP,e)
};
DwtBaseDialog.prototype.addPopdownListener=function(e){
this.addListener(DwtEvent.POPDOWN,e)
};
DwtBaseDialog.prototype.removePopdownListener=function(e){
this.removeListener(DwtEvent.POPDOWN,e)
};
DwtBaseDialog.prototype.popup=function(t){
if(this._poppedUp){
return
}
this.cleanup(true);
var e=this._zIndex;
if(this._mode==DwtBaseDialog.MODAL){
e=this._setModalEffect(e)
}
this._shell._veilOverlay.activeDialogs.push(this);
this.setVisible(true);
if(t){
this._loc.x=t.x;
this._loc.y=t.y
}
this._position(t);
this._resetTabFocus();
this.setZIndex(e);
this._poppedUp=true;
var a=this._shell.getKeyboardMgr();
a.pushTabGroup(this._tabGroup);
a.pushDefaultHandler(this);
DwtShell.getShell().addListener(DwtEvent.CONTROL,this._resizeHdlr.bind(this));
this.notifyListeners(DwtEvent.POPUP,this)
};
DwtBaseDialog.prototype._resetTabFocus=function(){
this._tabGroup.resetFocusMember(true)
};
DwtBaseDialog.prototype.focus=function(){
if(this.isListenerRegistered(DwtEvent.ONFOCUS)){
this.notifyListeners(DwtEvent.ONFOCUS)
}else{
if(this._focusElementId){
var e=document.getElementById(this._focusElementId);
if(e){
e.focus();
return e
}}}};
DwtBaseDialog.prototype.isPoppedUp=function(){
return this._poppedUp
};
DwtBaseDialog.prototype.popdown=function(){
if(this._poppedUp){
this._poppedUp=false;
this.cleanup(false);
var e=this._zIndex;
this.setZIndex(Dwt.Z_HIDDEN);
this.setVisible(false);
this._position(DwtBaseDialog.__nowhereLoc);
if(this._mode==DwtBaseDialog.MODAL){
this._undoModality(e)
}else{
this._shell._veilOverlay.activeDialogs.pop()
}
if(this._disposeOnPopDown===true){
this.dispose()
}
var t=this._shell.getKeyboardMgr();
t.popTabGroup(this._tabGroup);
t.popDefaultHandler();
DwtShell.getShell().removeListener(DwtEvent.CONTROL,this._resizeHdlr.bind(this));
this.notifyListeners(DwtEvent.POPDOWN,this)
}};
DwtBaseDialog.prototype.setView=function(e){
this.reset();
if(e){
this._getContentDiv().appendChild(e.getHtmlElement())
}};
DwtBaseDialog.prototype.reset=function(){
this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
};
DwtBaseDialog.prototype.cleanup=function(t){
var o=this._getInputFields();
if(o){
var e=o.length;
for(var a=0;
a<e;
a++){
o[a].disabled=!t;
if(t){
o[a].value=""
}}}};
DwtBaseDialog.prototype.setTitle=function(e){
if(this._titleEl){
this._titleEl.innerHTML=e||""
}
this._title=e
};
DwtBaseDialog.prototype.setContent=function(t){
var e=this._getContentDiv();
if(e){
e.innerHTML=t||""
}};
DwtBaseDialog.prototype._getContentDiv=function(){
return this._contentEl
};
DwtBaseDialog.prototype.addEnterListener=function(e){
this.addListener(DwtEvent.ENTER,e)
};
DwtBaseDialog.getActiveDialog=function(){
var t=null;
var a=DwtShell.getShell(window);
if(a){
var e=a._veilOverlay.activeDialogs.length;
if(e>0){
t=a._veilOverlay.activeDialogs[e-1]
}}
return t
};
DwtBaseDialog.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtBaseDialog.prototype._initializeDragging=function(r){
var s=document.getElementById(r);
if(s){
var n=DwtControl.fromElementId(window._dwtShellId);
if(n){
var e=Dwt.getSize(n.getHtmlElement());
var a=document.getElementById(this._htmlElId);
var h=this.getSize();
var o=new AjxCallback(this,this._dragEnd);
var i=new AjxCallback(this,this._duringDrag);
var t=new AjxCallback(this,this._dragStart);
DwtDraggable.init(s,a,0,document.body.offsetWidth-10,0,document.body.offsetHeight-10,t,i,o)
}}};
DwtBaseDialog.prototype._getContentHtml=function(){
return""
};
DwtBaseDialog.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtBaseDialog.prototype._createHtmlFromTemplate=function(e,t){
t.dragId=this._dragHandleId;
t.title=this._title;
t.icon="";
t.closeIcon1="";
t.closeIcon2="";
t.controlsTemplateId=this.CONTROLS_TEMPLATE;
DwtComposite.prototype._createHtmlFromTemplate.call(this,e,t);
this._titleBarEl=document.getElementById(t.id+"_titlebar");
this._titleEl=document.getElementById(t.id+"_title");
this._contentEl=document.getElementById(t.id+"_content");
if(this._titleEl){
this.setAttribute("aria-labelledby",this._titleEl.id);
this._titleEl.setAttribute("role","heading");
this._titleEl.setAttribute("aria-level","2")
}
this.setContent(this._getContentHtml())
};
DwtBaseDialog.prototype._setModalEffect=function(){
var a=this._shell._veilOverlay.dialogZ;
var i=null;
var t,e;
if(a.length){
i=a[a.length-1]
}
if(i){
t=i+2;
e=i+1
}else{
t=this._zIndex;
e=Dwt.Z_VEIL
}
this._shell._veilOverlay.veilZ.push(e);
this._shell._veilOverlay.dialogZ.push(t);
Dwt.setZIndex(this._shell._veilOverlay,e);
return t
};
DwtBaseDialog.prototype._undoModality=function(a){
var e=this._shell._veilOverlay.veilZ;
e.pop();
var t=e[e.length-1];
Dwt.setZIndex(this._shell._veilOverlay,t);
this._shell._veilOverlay.dialogZ.pop();
this._shell._veilOverlay.activeDialogs.pop();
if(this._shell._veilOverlay.activeDialogs.length>0){
this._shell._veilOverlay.activeDialogs[0].focus()
}};
DwtBaseDialog.prototype._getInputFields=function(){};
DwtBaseDialog.prototype._resizeHdlr=function(e){
if(this._loc.x===Dwt.LOC_NOWHERE&&this._loc.y===Dwt.LOC_NOWHERE){
this._position()
}};
DwtBaseDialog.prototype._dragStart=function(e,i){
if(AjxEnv.isNav&&!this._ignoreSetDragBoundries){
this._currSize=this.getSize();
var a=DwtControl.fromElementId(window._dwtShellId);
if(a){
var t=Dwt.getSize(a.getHtmlElement());
DwtDraggable.setDragBoundaries(DwtDraggable.dragEl,0,t.x-this._currSize.x,0,t.y-this._currSize.y)
}}};
DwtBaseDialog.prototype._dragEnd=function(e,t){
this._loc.x=e;
this._loc.y=t
};
DwtBaseDialog.prototype._duringDrag=function(e,t){};
DwtBaseDialog.prototype._doesContainElement=function(e){
return Dwt.contains(this.getHtmlElement(),e)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtDialog")){
DwtDialog=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtDialog.PARAMS);
t.className=t.className||"DwtDialog";
this._title=t.title=t.title||"";
var a=t.standardButtons;
var l=t.extraButtons;
if(!a){
a=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]
}else{
if(a==DwtDialog.NO_BUTTONS){
a=null
}else{
if(a&&!a.length){
a=[a]
}}}
this._buttonList=[];
var d={};
d[DwtDialog.ALIGN_LEFT]=[];
d[DwtDialog.ALIGN_CENTER]=[];
d[DwtDialog.ALIGN_RIGHT]=[];
if(a||l){
this._buttonDesc={};
if(a&&a.length){
this._initialEnterButtonId=this._enterButtonId=a[0];
for(var o=0;
o<a.length;
o++){
var h=a[o];
this._buttonList.push(h);
var r=DwtDialog.ALIGN[h];
if(r){
d[r].push(h)
}
this._buttonDesc[h]=new DwtDialog_ButtonDescriptor(h,AjxMsg[DwtDialog.MSG_KEY[h]],r)
}
this._resetCallbacks()
}
if(l&&l.length){
if(!this._enterButtonId){
this._initialEnterButtonId=this._enterButtonId=l[0]
}
for(var o=0;
o<l.length;
o++){
var h=l[o].id;
this._buttonList.push(h);
var r=l[o].align;
if(r){
d[r].push(h)
}
this._buttonDesc[h]=l[o]
}}}
this._buttonElementId={};
for(var o=0;
o<this._buttonList.length;
o++){
var h=this._buttonList[o];
this._buttonElementId[h]=this._buttonDesc[h].label?this._buttonDesc[h].label+"_"+Dwt.getNextId():Dwt.getNextId()
}
DwtBaseDialog.call(this,t);
this._button={};
for(var o=0;
o<this._buttonList.length;
o++){
var h=this._buttonList[o];
var c=this._button[h]=new DwtButton({
parent:this,id:this._htmlElId+"_button"+h}
);
c.setText(this._buttonDesc[h].label);
c.buttonId=h;
c.addSelectionListener(new AjxListener(this,this._buttonListener));
var e=document.getElementById(this._buttonElementId[h]);
if(e){
e.appendChild(c.getHtmlElement())
}}
var s=d[DwtDialog.ALIGN_LEFT].concat(d[DwtDialog.ALIGN_CENTER],d[DwtDialog.ALIGN_RIGHT]);
for(var o=0;
o<s.length;
o++){
var n=this._button[s[o]];
this._tabGroup.addMember(n)
}};
DwtDialog.PARAMS=["parent","className","title","standardButtons","extraButtons","zIndex","mode","loc","id"];
DwtDialog.prototype=new DwtBaseDialog;
DwtDialog.prototype.constructor=DwtDialog;
DwtDialog.prototype.isDwtDialog=true;
DwtDialog.prototype.toString=function(){
return"DwtDialog"
};
DwtDialog.ALIGN_LEFT=1;
DwtDialog.ALIGN_RIGHT=2;
DwtDialog.ALIGN_CENTER=3;
DwtDialog.CANCEL_BUTTON=1;
DwtDialog.OK_BUTTON=2;
DwtDialog.DISMISS_BUTTON=3;
DwtDialog.NO_BUTTON=4;
DwtDialog.YES_BUTTON=5;
DwtDialog.LAST_BUTTON=5;
DwtDialog.NO_BUTTONS=256;
DwtDialog.ALL_BUTTONS=[DwtDialog.CANCEL_BUTTON,DwtDialog.OK_BUTTON,DwtDialog.DISMISS_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.YES_BUTTON];
DwtDialog.MSG_KEY={};
DwtDialog.MSG_KEY[DwtDialog.CANCEL_BUTTON]="cancel";
DwtDialog.MSG_KEY[DwtDialog.OK_BUTTON]="ok";
DwtDialog.MSG_KEY[DwtDialog.DISMISS_BUTTON]="close";
DwtDialog.MSG_KEY[DwtDialog.NO_BUTTON]="no";
DwtDialog.MSG_KEY[DwtDialog.YES_BUTTON]="yes";
DwtDialog.ALIGN={};
DwtDialog.ALIGN[DwtDialog.CANCEL_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.OK_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.DISMISS_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.NO_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.YES_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.MODELESS=DwtBaseDialog.MODELESS;
DwtDialog.MODAL=DwtBaseDialog.MODAL;
DwtDialog.prototype.CONTROLS_TEMPLATE="dwt.Widgets#DwtDialogControls";
DwtDialog.prototype.popdown=function(){
DwtBaseDialog.prototype.popdown.call(this);
if(!this._disposeOnPopDown){
this.resetButtonStates()
}};
DwtDialog.prototype.popup=function(e,t){
this._focusButtonId=t;
DwtBaseDialog.prototype.popup.call(this,e)
};
DwtDialog.prototype._resetTabFocus=function(){
if(this._focusButtonId){
var e=this.getButton(this._focusButtonId);
this._tabGroup.setFocusMember(e,true)
}else{
DwtBaseDialog.prototype._resetTabFocus.call(this)
}};
DwtDialog.prototype.reset=function(){
this._resetCallbacks();
this.resetButtonStates();
DwtBaseDialog.prototype.reset.call(this)
};
DwtDialog.prototype.resetButtonStates=function(){
for(b in this._button){
this._button[b].setEnabled(true);
this._button[b].setHovered(false)
}
this.associateEnterWithButton(this._initialEnterButtonId)
};
DwtDialog.prototype.getButton=function(e){
return this._button[e]
};
DwtDialog.prototype.setButtonEnabled=function(t,e){
if(!this._button[t]){
return
}
this._button[t].setEnabled(e)
};
DwtDialog.prototype.setButtonVisible=function(e,t){
if(!this._button[e]){
return
}
this._button[e].setVisible(t)
};
DwtDialog.prototype.getButtonEnabled=function(e){
return this._button[e].getEnabled()
};
DwtDialog.prototype.registerCallback=function(t,a,i,e){
this._buttonDesc[t].callback=(a&&(a.isAjxCallback||(!i&&!e)))?a:(new AjxCallback(i,a,e))
};
DwtDialog.prototype.unregisterCallback=function(e){
this._buttonDesc[e].callback=null
};
DwtDialog.prototype.setButtonListener=function(e,t){
this._button[e].removeSelectionListeners();
this._button[e].addSelectionListener(t)
};
DwtDialog.prototype.setEnterListener=function(e){
this.removeAllListeners(DwtEvent.ENTER);
this.addEnterListener(e)
};
DwtDialog.prototype.associateEnterWithButton=function(e){
this._enterButtonId=e
};
DwtDialog.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_DIALOG
};
DwtDialog.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.ENTER:this.notifyListeners(DwtEvent.ENTER,t);
break;
case DwtKeyMap.CANCEL:var a=false;
a=a||this._runCallbackForButtonId(DwtDialog.CANCEL_BUTTON);
a=a||this._runCallbackForButtonId(DwtDialog.NO_BUTTON);
a=a||this._runCallbackForButtonId(DwtDialog.DISMISS_BUTTON);
if(!a&&this._buttonDesc[DwtDialog.OK_BUTTON]&&this._buttonList.length==1){
a=a||this._runCallbackForButtonId(DwtDialog.OK_BUTTON)
}
this.popdown();
return true;
case DwtKeyMap.YES:if(this._buttonDesc[DwtDialog.YES_BUTTON]){
this._runCallbackForButtonId(DwtDialog.YES_BUTTON)
}
break;
case DwtKeyMap.NO:if(this._buttonDesc[DwtDialog.NO_BUTTON]){
this._runCallbackForButtonId(DwtDialog.NO_BUTTON)
}
break;
default:return false
}
return true
};
DwtDialog.prototype._createHtmlFromTemplate=function(a,o){
DwtBaseDialog.prototype._createHtmlFromTemplate.call(this,a,o);
var i=o.id+"_focus";
if(document.getElementById(i)){
this._focusElementId=i
}
this._buttonsEl=document.getElementById(o.id+"_buttons");
if(this._buttonsEl){
var t=[];
var e=0;
this._addButtonsHtml(t,e);
this._buttonsEl.innerHTML=t.join("")
}};
DwtDialog.prototype._getButtonsContainerStartTemplate=function(){
return"<table role='presentation' width='100%'><tr>"
};
DwtDialog.prototype._getButtonsAlignStartTemplate=function(){
return"<td align=\"{0}\"><table role='presentation'><tr>"
};
DwtDialog.prototype._getButtonsAlignEndTemplate=function(){
return"</tr></table></td>"
};
DwtDialog.prototype._getButtonsCellTemplate=function(){
return'<td id="{0}"></td>'
};
DwtDialog.prototype._getButtonsContainerEndTemplate=function(){
return"</tr></table>"
};
DwtDialog.prototype._addButtonsHtml=function(s,t){
if(this._buttonList&&this._buttonList.length){
var a=new Array();
var e=new Array();
var n=new Array();
for(var o=0;
o<this._buttonList.length;
o++){
var r=this._buttonList[o];
switch(this._buttonDesc[r].align){
case DwtDialog.ALIGN_RIGHT:e.push(r);
break;
case DwtDialog.ALIGN_LEFT:a.push(r);
break;
case DwtDialog.ALIGN_CENTER:n.push(r);
break
}}
s[t++]=this._getButtonsContainerStartTemplate();
if(a.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["left"]);
for(var o=0;
o<a.length;
o++){
var r=a[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
if(n.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["center"]);
for(var o=0;
o<n.length;
o++){
var r=n[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
if(e.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["right"]);
for(var o=0;
o<e.length;
o++){
var r=e[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
s[t++]=this._getButtonsContainerEndTemplate()
}
return t
};
DwtDialog.prototype._buttonListener=function(a,e){
var i=DwtControl.getTargetControl(a);
var t=(i&&i.buttonId)||this._enterButtonId;
if(t){
this._runCallbackForButtonId(t,e)
}};
DwtDialog.prototype._runCallbackForButtonId=function(i,e){
var t=this._buttonDesc[i];
var a=t&&t.callback;
if(!a){
return false
}
e=(e instanceof Array)?e:[e];
a.run.apply(a,e);
return true
};
DwtDialog.prototype._runEnterCallback=function(e){
if(this._enterButtonId&&this.getButtonEnabled(this._enterButtonId)){
this._runCallbackForButtonId(this._enterButtonId,e)
}};
DwtDialog.prototype._resetCallbacks=function(){
if(this._buttonDesc){
for(var e=0;
e<DwtDialog.ALL_BUTTONS.length;
e++){
var t=DwtDialog.ALL_BUTTONS[e];
if(this._buttonDesc[t]){
this._buttonDesc[t].callback=new AjxCallback(this,this.popdown)
}}}};
DwtDialog_ButtonDescriptor=function(o,e,i,a,t){
this.id=o;
this.label=e;
this.align=i;
this.callback=a;
this.cellTemplate=t
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtLabel")){
DwtLabel=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtLabel.PARAMS);
e.className=e.className||"DwtLabel";
DwtComposite.call(this,e);
this._style=e.style||(DwtLabel.IMAGE_LEFT|DwtLabel.ALIGN_CENTER);
this._textBackground=null;
this._textForeground=null;
this._createHtml(e.template)
};
DwtLabel.PARAMS=["parent","style","className","posStyle","id","index"];
DwtLabel.prototype=new DwtComposite;
DwtLabel.prototype.constructor=DwtLabel;
DwtLabel.prototype.isFocusable=true;
DwtLabel.prototype.toString=function(){
return"DwtLabel"
};
DwtLabel.IMAGE_LEFT=1;
DwtLabel.IMAGE_RIGHT=2;
DwtLabel.IMAGE_BOTH=4;
DwtLabel.ALIGN_LEFT=8;
DwtLabel.ALIGN_RIGHT=16;
DwtLabel.ALIGN_CENTER=32;
DwtLabel._LAST_STYLE=32;
DwtLabel.LEFT="left";
DwtLabel.RIGHT="right";
DwtLabel.prototype.TEMPLATE="dwt.Widgets#ZLabel";
DwtLabel.prototype.dispose=function(){
delete this._dropDownEl;
delete this._iconEl;
delete this._textEl;
DwtControl.prototype.dispose.call(this)
};
DwtLabel.prototype.setEnabled=function(e){
if(e!=this._enabled){
DwtControl.prototype.setEnabled.call(this,e);
var t=this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT;
this.__imageInfo=this.__imageInfo||{};
this.__setImage(this.__imageInfo[t])
}};
DwtLabel.prototype.getImage=function(e){
e=e||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
return this.__imageInfo[e]
};
DwtLabel.prototype.setImage=function(e,a,t){
a=a||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
this.__imageInfo=this.__imageInfo||{};
this.__imageInfo[a]=e;
this.__setImage(e,a,t)
};
DwtLabel.prototype.setIconEl=function(e,t){
this._iconEl=this._iconEl||{};
t=t||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
this._iconEl[t]=e
};
DwtLabel.prototype.setDisabledImage=function(e){};
DwtLabel.prototype.getText=function(){
return(this.__text!=null)?this.__text:null
};
DwtLabel.prototype.setText=function(e){
if(!this._textEl){
return
}
if(e==null||e==""){
this.__text=null;
this._textEl.innerHTML=""
}else{
this.__text=e;
this._textEl.innerHTML=e
}
this._textSet(e)
};
DwtLabel.prototype.setTextBackground=function(e){
this._textBackground=e;
if(this._textEl){
this._textEl.style.backgroundColor=e
}};
DwtLabel.prototype.setTextForeground=function(e){
this._textForeground=e;
if(this._textEl){
this._textEl.style.color=e
}};
DwtLabel.prototype.setAlign=function(e){
this._style=e;
var t=this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT;
this.__imageInfo=this.__imageInfo||{};
this.__setImage(this.__imageInfo[t])
};
DwtLabel.prototype.isStyle=function(e){
return this._style&e
};
DwtLabel.prototype.getTabGroupMember=function(){
return DwtControl.prototype.getTabGroupMember.apply(this,arguments)
};
DwtLabel.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtLabel.prototype._createHtmlFromTemplate=function(e,t){
DwtControl.prototype._createHtmlFromTemplate.call(this,e,t);
this._textEl=document.getElementById(t.id+"_title")
};
DwtLabel.prototype._getIconEl=function(t){
var e=this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT;
t=typeof t==="boolean"?e:(t||e);
this._iconEl=this._iconEl||{};
return this._iconEl[t]||(this._iconEl[t]=document.getElementById(this._htmlElId+"_"+t+"_icon"))
};
DwtLabel.prototype.__setImage=function(t,i,a){
this.__altText=a||this.__altText;
var e=this._getIconEl(i);
if(e){
if(t){
AjxImg.setImage(e,t,null,!this._enabled,null,this.__altText);
var o=(this._style&DwtLabel.IMAGE_RIGHT?"ZHasRightIcon":"ZHasLeftIcon");
Dwt.addClass(this.getHtmlElement(),o)
}else{
e.innerHTML=""
}}};
DwtLabel.prototype._textSet=function(e){
if(!this.hasAttribute("aria-labelledby")){
if(e){
this.setAttribute("aria-label",e)
}else{
this.removeAttribute("aria-label")
}}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtCheckbox")){
DwtCheckbox=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtCheckbox.PARAMS);
e.className=e.className||"DwtCheckbox";
DwtControl.call(this,e);
this._textPosition=DwtCheckbox.DEFAULT_POSITION;
this._initName=e.name;
this._initValue=e.value;
this._createHtml();
this.setSelected(e.checked)
};
DwtCheckbox.prototype=new DwtControl;
DwtCheckbox.prototype.constructor=DwtCheckbox;
DwtCheckbox.prototype.isDwtCheckbox=true;
DwtCheckbox.prototype.isInputControl=true;
DwtCheckbox.prototype.toString=function(){
return"DwtCheckbox"
};
DwtCheckbox.PARAMS=["parent","style","name","checked","className","posStyle","id","index","value"];
DwtCheckbox.TEXT_LEFT="left";
DwtCheckbox.TEXT_RIGHT="right";
DwtCheckbox.DEFAULT_POSITION=DwtCheckbox.TEXT_RIGHT;
DwtCheckbox.prototype.TEMPLATE="dwt.Widgets#DwtCheckbox";
DwtCheckbox.prototype.INPUT_TYPE="checkbox";
DwtCheckbox.prototype.getInputElement=function(){
return this._inputEl
};
DwtCheckbox.prototype._focus=function(){
Dwt.addClass(this.getHtmlElement(),DwtControl.FOCUSED)
};
DwtCheckbox.prototype._blur=function(){
Dwt.delClass(this.getHtmlElement(),DwtControl.FOCUSED)
};
DwtCheckbox.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
DwtCheckbox.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtCheckbox.prototype.setEnabled=function(e){
if(e!=this._enabled){
DwtControl.prototype.setEnabled.call(this,e);
this._inputEl.disabled=!e;
var t=e?"Text":"DisabledText";
if(this._textElLeft){
this._textElLeft.className=t
}
if(this._textElRight){
this._textElRight.className=t
}}};
DwtCheckbox.prototype.setSelected=function(e){
if(this._inputEl&&this._inputEl.checked!=e){
this._inputEl.checked=e
}};
DwtCheckbox.prototype.isSelected=function(){
return this._inputEl&&this._inputEl.checked
};
DwtCheckbox.prototype.setText=function(e){
if(this._textEl&&this._text!=e){
this._text=e;
this._textEl.innerHTML=e||""
}};
DwtCheckbox.prototype.getText=function(){
return this._text
};
DwtCheckbox.prototype.setTextPosition=function(e){
this._textEl=e==DwtCheckbox.TEXT_LEFT?this._textElLeft:this._textElRight;
if(this._textPosition!=e){
this._textPosition=e;
if(this._textElLeft){
this._textElLeft.innerHTML=""
}
if(this._textElRight){
this._textElRight.innerHTML=""
}
this.setText(this._text)
}};
DwtCheckbox.prototype.getTextPosition=function(){
return this._textPosition
};
DwtCheckbox.prototype.setValue=function(t){
var e=this._inputEl||this;
if(e.value!==t){
e.value=t
}};
DwtCheckbox.prototype.getValue=function(){
var e=this._inputEl||this;
return e.value!=null?e.value:this.getText()
};
DwtCheckbox.prototype.getInputElement=function(){
return this._inputEl
};
DwtCheckbox.prototype.setToolTipContent=function(e){
if(e&&!this.__mouseEventsSet){
this.__mouseEventsSet=true;
this._setMouseEvents()
}
DwtControl.prototype.setToolTipContent.apply(this,arguments)
};
DwtCheckbox.prototype._replaceElementHook=function(t,a,e,i){
a=this.getInputElement();
DwtControl.prototype._replaceElementHook.call(this,t,a,e,i);
if(t.id){
this.setHtmlElementId(t.id+"_control");
a.id=t.id;
if(this._textEl){
this._textEl.setAttribute(AjxEnv.isIE?"htmlFor":"for",t.id)
}}};
DwtCheckbox.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtCheckbox.prototype._createHtmlFromTemplate=function(t,a){
a.name=this._initName||this._htmlElId;
a.value=this._initValue;
a.type=this.INPUT_TYPE;
DwtControl.prototype._createHtmlFromTemplate.call(this,t,a);
this._inputEl=document.getElementById(a.id+"_input");
if(this._inputEl){
var e=DwtShell.getShell(window).getKeyboardMgr();
var i=AjxCallback.simpleClosure(e.grabFocus,e,this.getInputElement());
Dwt.setHandler(this._inputEl,DwtEvent.ONFOCUS,i);
Dwt.setHandler(this._inputEl,DwtEvent.ONCLICK,DwtCheckbox.__handleClick);
this.setFocusElement()
}
this._textElLeft=document.getElementById(a.id+"_text_left");
this._textElRight=document.getElementById(a.id+"_text_right");
this.setTextPosition(this._textPosition)
};
DwtCheckbox.__handleClick=function(e){
var t=DwtUiEvent.getEvent(e);
var o=DwtUiEvent.getTarget(t);
var i=DwtShell.selectionEvent;
DwtUiEvent.copy(i,t);
i.item=this;
i.detail=o.checked;
var a=DwtControl.findControl(o);
a.setSelected(o.checked);
a.focus();
a.notifyListeners(DwtEvent.SELECTION,i)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtRadioButton")){
DwtRadioButton=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtRadioButton.PARAMS);
e.className=e.className||"DwtRadioButton";
DwtCheckbox.call(this,e)
};
DwtRadioButton.PARAMS=DwtCheckbox.PARAMS;
DwtRadioButton.prototype=new DwtCheckbox;
DwtRadioButton.prototype.constructor=DwtRadioButton;
DwtRadioButton.prototype.isDwtRadioButton=true;
DwtRadioButton.prototype.isInputControl=true;
DwtRadioButton.prototype.toString=function(){
return"DwtRadioButton"
};
DwtRadioButton.prototype.INPUT_TYPE="radio"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtListView")){
DwtListView=function(i){
if(arguments.length==0){
return
}
i=Dwt.getParams(arguments,DwtListView.PARAMS);
i.className=i.className||"DwtListView";
DwtComposite.call(this,i);
this._view=i.view||Dwt.getNextId();
if(i.headerList){
var a=this.getHtmlElement();
var n=new Array(50);
var h=0;
var r=Dwt.getNextId();
var e=Dwt.getNextId();
n[h++]="<table width='100%'><tr><td ";
n[h++]="id="+r;
n[h++]="></td></tr><tr><td ";
n[h++]="id="+e;
n[h++]="></td></tr></table>";
a.innerHTML=n.join("");
var l=document.getElementById(r);
this._listColDiv=document.createElement("div");
this._listColDiv.id=DwtId.getListViewId(this._view,DwtId.LIST_VIEW_HEADERS);
l.appendChild(this._listColDiv);
var t=document.getElementById(e);
this._listDiv=this.useListElement()?document.createElement("ul"):document.createElement("div");
this._listDiv.id=DwtId.getListViewId(this._view,DwtId.LIST_VIEW_ROWS);
this._listDiv.className="DwtListView-Rows";
t.appendChild(this._listDiv);
this._bSortAsc=false;
this._currentColId=null;
this.sortingEnabled=true
}else{
this._listDiv=document.getElementById(i.id);
this.setScrollStyle(DwtControl.SCROLL)
}
this._setMouseEventHdlrs();
this._listenerMouseOver=this._mouseOverListener.bind(this);
this._listenerMouseOut=this._mouseOutListener.bind(this);
this._listenerMouseDown=this._mouseDownListener.bind(this);
this._listenerMouseUp=this._mouseUpListener.bind(this);
this._listenerMouseMove=this._mouseMoveListener.bind(this);
this._listenerDoubleClick=this._doubleClickListener.bind(this);
this.addListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.addListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.addListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.addListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.addListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.addListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick);
this._evtMgr=new AjxEventMgr();
this._selectedItems=new AjxVector();
this._selAnchor=null;
this._kbAnchor=null;
this._selEv=new DwtSelectionEvent(true);
this._actionEv=new DwtListViewActionEvent(true);
this._stateChangeEv=new DwtEvent(true);
this._headerList=i.headerList;
this._noMaximize=i.noMaximize;
if(this._headerList){
this._parentEl=this._listDiv
}else{
this._parentEl=this.getHtmlElement();
if(this.useListElement()){
var s=document.createElement("ul");
s.className="DwtListView-Rows";
this._parentEl.appendChild(s);
this._parentEl=s
}}
this._parentEl.tabIndex=0;
this._list=null;
this.offset=0;
this.headerColCreated=false;
this.setMultiSelect(true);
this.firstSelIndex=-1;
this._data={};
this._rowClass=[this._className,DwtListView.ROW_CLASS].join("");
var o=this._normalClass=DwtListView.ROW_CLASS;
this._selectedClass=[o,DwtCssStyle.SELECTED].join("-");
this._viewedButUnselectedClass=[o,DwtCssStyle.ALT_SELECTED].join("-");
this._disabledSelectedClass=[this._selectedClass,DwtCssStyle.DISABLED].join("-");
this._kbFocusClass=[o,DwtCssStyle.FOCUSED].join("-");
this._dndClass=[o,DwtCssStyle.DRAG_PROXY].join("-");
this._rightClickClass=[this._selectedClass,DwtCssStyle.ACTIONED].join("-");
this._styleRe=this._getStyleRegex()
};
DwtListView.prototype=new DwtComposite;
DwtListView.prototype.constructor=DwtListView;
DwtListView.prototype.isDwtListView=true;
DwtListView.prototype.toString=function(){
return"DwtListView"
};
DwtListView.prototype.role="list";
DwtListView.prototype.itemRole="listitem";
DwtListView.PARAMS=["parent","className","posStyle","headerList","noMaximize"];
DwtListView.ITEM_SELECTED=1;
DwtListView.ITEM_DESELECTED=2;
DwtListView.ITEM_DBL_CLICKED=3;
DwtListView._LAST_REASON=3;
DwtListView._TOOLTIP_DELAY=250;
DwtListView.HEADERITEM_HEIGHT=24;
DwtListView.TYPE_HEADER_ITEM="1";
DwtListView.TYPE_LIST_ITEM="2";
DwtListView.TYPE_HEADER_SASH="3";
DwtListView.DEFAULT_LIMIT=25;
DwtListView.MAX_REPLENISH_THRESHOLD=10;
DwtListView.MIN_COLUMN_WIDTH=20;
DwtListView.COL_MOVE_THRESHOLD=3;
DwtListView.ROW_CLASS="Row";
DwtListView.ROW_CLASS_ODD="RowEven";
DwtListView.ROW_CLASS_EVEN="RowOdd";
DwtListView._STYLE_CLASS="_sc";
DwtListView._SELECTED_STYLE_CLASS="_ssc";
DwtListView._SELECTED_DIS_STYLE_CLASS="_sdsc";
DwtListView._KBFOCUS_CLASS="_kfc";
DwtListView.prototype.dispose=function(){
this._listColDiv=null;
this._listDiv=null;
this._parentEl=null;
this._clickDiv=null;
this._selectedItems=null;
DwtComposite.prototype.dispose.call(this)
};
DwtListView.prototype.setEnabled=function(e){
DwtComposite.prototype.setEnabled.call(this,e);
this.removeListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.removeListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.removeListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.removeListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.removeListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.removeListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick);
if(e){
this.addListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.addListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.addListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.addListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.addListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.addListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick)
}
var a=this.getSelectedItems();
if(a){
var o=a.getArray();
for(var t=0;
t<o.length;
t++){
Dwt.delClass(o[t],this._styleRe,e?this._selectedClass:this._disabledSelectedClass)
}}};
DwtListView.prototype.createHeaderHtml=function(d,p){
if(!this._headerList||this.headerColCreated){
return
}
this._headerHash={};
this._headerIdHash={};
var u=0;
var f=[];
f[u++]="<table id='";
f[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_TABLE,this._view);
f[u++]="' height=100%";
f[u++]=this._noMaximize?">":" width=100%>";
f[u++]="<tr>";
var o=this._headerList.length;
for(var s=0;
s<o;
s++){
var l=this._headerList[s];
var c=l._field;
l._index=s;
var t=l._id=DwtId.getListViewHdrId(DwtId.WIDGET_HDR,this._view,c);
this._headerHash[c]=l;
this._headerIdHash[t]=l;
if(l._variable){
this._variableHeaderCol=l
}
if(l._visible){
u=this._createHeader(f,u,l,s,o,t,d)
}}
f[u++]="</tr></table>";
this._listColDiv.innerHTML=f.join("");
this._listColDiv.className="DwtListView-ColHeader"+(p?" FixedColumnHeaderTables":"");
setTimeout($.proxy(function(){
for(var g=0;
g<o;
g++){
var y=this._headerList[g];
if(y._cssClass&&y._resizeable&&y._width==="auto"){
this._createHeaderCssStyle(y,this._calcRelativeWidth(g))
}}}
,this),0);
var e=0,h;
for(var n=0;
n<this._headerList.length;
n++){
var l=this._headerList[n];
var m=document.getElementById(l._id);
if(!m){
continue
}
if(l._sortable&&l._field==d){
m.className="DwtListView-Column DwtListView-ColumnActive"
}
if(l._resizeable){
var r=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_SASH,this._view,l._field);
var a=document.getElementById(r);
if(a){
this.associateItemWithElement(l,a,DwtListView.TYPE_HEADER_SASH,r,{
index:n}
)
}
e++;
h=l
}
this.associateItemWithElement(l,m,DwtListView.TYPE_HEADER_ITEM,l._id,{
index:n}
)
}
if(e==1){
h._resizeable=false
}
this.headerColCreated=true
};
DwtListView.prototype._createHeader=function(m,u,l,n,o,t,d){
var c=l._field;
m[u++]="<td id='";
m[u++]=t;
m[u++]="' class='";
var r=(t==this._currentColId)?"DwtListView-Column DwtListView-ColumnActive":"DwtListView-Column";
r+=l._sortable?"":" DwtDefaultCursor";
m[u++]=r+"'";
if(l._width){
m[u++]=" width=";
m[u++]=l._width;
if(l._cssClass&&l._resizeable&&l._width!=="auto"){
this._createHeaderCssStyle(l,l._width)
}
if(l._widthUnits){
m[u++]=l._widthUnits
}}
if(l._tooltip&&DwtControl.useBrowserTooltips){
m[u++]=" title='"+l._tooltip+"'"
}
m[u++]=">";
m[u++]="<div";
var s=null;
if(l._width&&l._width!="auto"){
if(AjxEnv.isIE){
s=l._width
}else{
s=l._width+2
}
if(l._widthUnits){
s+=l._widthUnits
}}
if(!!s){
m[u++]=" style='overflow: hidden; width: ";
m[u++]=s;
m[u++]="'>"
}else{
m[u++]=">"
}
m[u++]="<table width=100%><tr>";
if(l._iconInfo){
var h=["id='",DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,c),"'"].join("");
m[u++]="<td><center>";
m[u++]=AjxImg.getImageHtml(l._iconInfo,null,h);
m[u++]="</center></td>"
}
if(l._label){
m[u++]="<td id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,c);
m[u++]="' class='DwtListHeaderItem-label' style='padding-right:6px; padding-left:6px'>";
m[u++]=l._label;
m[u++]="</td>"
}
if(l._sortable&&!l._noSortArrow){
var e=this._bSortAsc?"ColumnUpArrow":"ColumnDownArrow";
m[u++]="<td align=right style='padding-right:2px' width='8px' id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,c);
m[u++]="'>";
var a=(c==d);
m[u++]=AjxImg.getImageHtml(e,a?null:"visibility:hidden");
m[u++]="</td>";
if(a){
this._currentColId=t
}}
if(n<(o-1)){
m[u++]="<td width=6>";
m[u++]="<table align=right width=4 height=100% id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_SASH,this._view,c);
m[u++]="'><tr>";
m[u++]="<td class='DwtListView-Sash'><div style='width: 1px; height: ";
m[u++]=(DwtListView.HEADERITEM_HEIGHT-2);
m[u++]="px; background-color: #8A8A8A;margin-left:2px'></div></td><td class='DwtListView-Sash'><div style='width: 1px; height: ";
m[u++]=(DwtListView.HEADERITEM_HEIGHT-2);
m[u++]="px;'></div></td></tr></table>";
m[u++]="</td>"
}
m[u++]="</tr></table>";
m[u++]="</div></td>";
return u
};
DwtListView.prototype._createHeaderCssStyle=function(i,t){
if(!i._cssClass||!i._resizeable){
return
}
if(i._cssRuleIndex){
DwtCssStyle.removeRule(document.styleSheets[0],i._cssRuleIndex)
}
var e="#"+this.parent._htmlElId;
e+=" ."+i._cssClass;
var a="width:"+t+($.isNumeric(t)?"px;":";");
i._cssRuleIndex=DwtCssStyle.addRule(document.styleSheets[0],e,a,i._cssRuleIndex)
};
DwtListView.prototype.getItemIndex=function(a){
var o=this._list;
if(o){
var e=o.size();
for(var t=0;
t<e;
++t){
if(o.get(t).id==a.id){
return t
}}}
return null
};
DwtListView.prototype.setSize=function(t,e){
DwtComposite.prototype.setSize.call(this,t,e);
this._sizeChildren(e)
};
DwtListView.prototype.size=function(){
return this._list?this._list.size():0
};
DwtListView.prototype.set=function(a,t,e){
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._curViewedItem=null;
this._rightSelItem=null;
this.sortingEnabled=true;
this._resetList();
this._list=a;
this.setUI(t,e)
};
DwtListView.prototype.setUI=function(t,e){
this.removeAll();
this.createHeaderHtml(t);
this._renderList(this._list,e)
};
DwtListView.prototype._renderList=function(r,s,a){
if(r instanceof AjxVector&&r.size()){
var t=new Date();
var c=r.size();
var h=[];
if(!a){
this._parentEl.innerHTML=""
}
Dwt.delClass(this._parentEl,"DwtListView-Rows-Empty");
for(var n=0;
n<c;
n++){
var l=r.get(n);
var e=this._createItemHtml(l,{
now:t}
,false,n);
if(e){
if(e instanceof Array){
for(var o=0;
o<e.length;
o++){
this._addRow(e[o])
}}else{
this._addRow(e)
}
this._itemAdded(l)
}}}else{
if(!s){
this._setNoResultsHtml();
Dwt.addClass(this._parentEl,"DwtListView-Rows-Empty")
}}};
DwtListView.prototype.addItems=function(e){
if(AjxUtil.isArray(e)){
if(!this._list){
this._list=new AjxVector()
}
if(this._list.size()==0){
this._resetList()
}
this._renderList(AjxVector.fromArray(e),null,true);
this._list.addList(e)
}};
DwtListView.prototype.addItem=function(o,t,a,i){
if(!this._list){
this._list=new AjxVector()
}
if(this._list.size()==0){
this._resetList()
}
this._list.add(o,(i!=null)?i:t);
var n=this._createItemHtml(o);
if(n){
if(n instanceof Array){
for(var e=0;
e<n.length;
e++){
this._addRow(n[e])
}}else{
this._addRow(n,t)
}}
if(!a&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.removeItem=function(a,t,i){
var e=this._getElFromItem(a);
if(!e){
return
}
var o=this._getRowIndex(a);
this._selectedItems.remove(e);
if(this._rightSelItem===e){
this._rightSelItem=null
}
if(this._kbAnchor===e){
this._kbAnchor=null
}
if(e.parentNode===this._parentEl){
this._parentEl.removeChild(e)
}
if(this._list){
this._list.remove(a)
}
var n=e.id;
if(this._data[n]){
this._data[n]=null;
delete this._data[n]
}
if(!i){
this._fixAlternation(o)
}
if(!t&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.redrawItem=function(t){
var a=this._getElFromItem(t);
if(a){
var e=a.className;
var i=this._createItemHtml(t);
i.className=e;
a.parentNode.replaceChild(i,a);
if(this._selectedItems.contains(a)){
this._selectedItems.remove(a);
this.selectItem(t)
}
if(this._kbAnchor===a){
this._setKbFocusElement(i)
}}};
DwtListView.prototype.addSelectionListener=function(e){
this._evtMgr.addListener(DwtEvent.SELECTION,e)
};
DwtListView.prototype.removeSelectionListener=function(e){
this._evtMgr.removeListener(DwtEvent.SELECTION,e)
};
DwtListView.prototype.addActionListener=function(e){
this._evtMgr.addListener(DwtEvent.ACTION,e)
};
DwtListView.prototype.removeActionListener=function(e){
this._evtMgr.removeListener(DwtEvent.ACTION,e)
};
DwtListView.prototype.addStateChangeListener=function(e){
this._evtMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtListView.prototype.removeStateChangeListener=function(e){
this._evtMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtListView.prototype.removeAll=function(e){
if(this._parentEl){
this._parentEl.innerHTML=""
}
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=this._selAnchor=this._kbAnchor=null;
if(!e&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.selectAll=function(){
if(this._list&&this._list.size()){
this.setSelectedItems(this._list.getArray())
}};
DwtListView.prototype.deselectAll=function(){
if(this._selectedItems){
var e=this._selectedItems.getArray();
var o=this._selectedItems.size();
for(var t=0;
t<o;
t++){
Dwt.delClass(e[t],this._styleRe);
e[t].removeAttribute("aria-selected")
}
this._selectedItems.removeAll();
this._rightSelItem=this._selAnchor=null;
if(this._kbAnchor!=null&&this.hasFocus()){
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}}};
DwtListView.prototype._markUnselectedViewedItem=function(e){
var t=this._curViewedItem;
var a=t&&this._getElFromItem(t);
if(!a){
return
}
if(e){
Dwt.delClass(a,this._styleRe,this._viewedButUnselectedClass)
}else{
Dwt.delClass(a,this._viewedButUnselectedClass)
}};
DwtListView.prototype.getDnDSelection=function(){
if(this._dndSelection instanceof AjxVector){
return this.getSelection()
}else{
return this.getItemFromElement(this._dndSelection)
}};
DwtListView.prototype.getSelection=function(){
var t=[];
if(this._rightSelItem){
t.push(this.getItemFromElement(this._rightSelItem))
}else{
if(this._selectedItems){
var e=this._selectedItems.getArray();
var n=this._selectedItems.size();
for(var o=0;
o<n;
o++){
t[o]=this.getItemFromElement(e[o])
}}}
return t
};
DwtListView.prototype.getSelectedItems=function(){
return this._selectedItems
};
DwtListView.prototype.setSelection=function(i,t,e){
if(!i){
return
}
var a=this._getElFromItem(i);
if(a){
if(this._selectedItems.size()==1&&this._selectedItems.get(0)==a&&!e){
return
}
this.deselectAll();
this._unmarkKbAnchorElement(true);
this._setKbFocusElement(a);
this._selAnchor=a;
this.selectItem(i,this.getEnabled());
this.firstSelIndex=(this._list&&this._list.size()>0)?this._list.indexOf(i):-1;
this._scrollList(a);
if(!t&&this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
var o=new DwtSelectionEvent(true);
o.button=DwtMouseEvent.LEFT;
o.target=a;
o.item=this.getItemFromElement(a);
o.detail=DwtListView.ITEM_SELECTED;
o.ersatz=true;
this._evtMgr.notifyListeners(DwtEvent.SELECTION,o)
}}};
DwtListView.prototype.setMultiSelection=function(e,a,t){
if(a){
this._selectedItems.remove(e);
e.removeAttribute("aria-selected");
Dwt.delClass(e,this._styleRe);
this._selEv.detail=DwtListView.ITEM_DESELECTED
}else{
this._selectedItems.add(e,null,true);
e.setAttribute("aria-selected",true);
Dwt.delClass(e,this._styleRe,this._selectedClass);
this._selEv.detail=DwtListView.ITEM_SELECTED
}
if(this._kbAnchor&&this._kbAnchor!=e){
Dwt.delClass(this._kbAnchor,this._kbFocusClass)
}
this._setKbFocusElement(e);
this._selAnchor=e;
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
};
DwtListView.prototype.setSelectedItems=function(a){
this.deselectAll();
var o=a.length,e=this.getEnabled();
for(var t=0;
t<o;
++t){
this.selectItem(a[t],e)
}};
DwtListView.prototype.selectItem=function(a,t){
var e=this._getElFromItem(a);
if(e){
Dwt.delClass(e,this._styleRe,t?this._selectedClass:this._disabledSelectedClass);
if(this._kbAnchor==e&&this.hasFocus()){
Dwt.addClass(e,this._kbFocusClass);
e.focus()
}
this._selectedItems.add(e);
e.setAttribute("aria-selected",true)
}};
DwtListView.prototype.getSelectionCount=function(){
return this._rightSelItem?1:this._selectedItems.size()
};
DwtListView.prototype.handleActionPopdown=function(){
this._clearRightSel()
};
DwtListView.prototype.associateItemWithElement=function(i,t,a,n,o){
n=n||this._getItemId(i);
if(t){
t.id=n
}
a=a||DwtListView.TYPE_LIST_ITEM;
this._data[n]={
item:i,id:n,type:a};
if(o){
for(var e in o){
this._data[n][e]=o[e]
}}
return n
};
DwtListView.prototype.getItemFromElement=function(e){
return this._getItemData(e,"item")
};
DwtListView.prototype.findItem=function(e){
if(!e){
return
}
var t=this.findItemDiv(e);
return this._getItemData(t,"item")
};
DwtListView.prototype.findItemDiv=function(e){
if(!e){
return
}
while(e&&(e.id!=this._htmlElId)){
if(e.id&&this._data[e.id]){
return e
}
e=e.parentNode
}
return null
};
DwtListView.prototype.getTargetItem=function(e){
return this.findItem(DwtUiEvent.getTarget(e))
};
DwtListView.prototype.getTargetItemDiv=function(e){
return this.findItemDiv(DwtUiEvent.getTarget(e))
};
DwtListView.prototype.dragSelect=function(t){
if(this._dragHighlight){
var e=document.getElementById(this._dragHighlight);
if(!t||(e&&(t.id!=e.id))){
this._updateDragSelection(e,false)
}}
if(!t){
return
}
if(this._getItemData(t,"type")!=DwtListView.TYPE_LIST_ITEM){
return
}
if(t.id!=this._dragHighlight){
this._dragHighlight=t.id;
this._updateDragSelection(t,true)
}};
DwtListView.prototype.dragDeselect=function(t){
if(this._dragHighlight){
var e=document.getElementById(this._dragHighlight);
this._updateDragSelection(e,false);
this._dragHighlight=null
}};
DwtListView.prototype.getScrollContainer=function(){
return this._parentEl
};
DwtListView.prototype.scrollToItem=function(t){
var e=this._getElFromItem(t);
if(e){
this._listDiv.scrollTop=e.offsetTop
}};
DwtListView.prototype.scrollToTop=function(){
this._listDiv.scrollTop=0
};
DwtListView.prototype.scrollPage=function(e){
var t=this._parentEl;
if(t.clientHeight>=t.scrollHeight){
return
}
t.scrollTop=e?Math.max(t.scrollTop-t.clientHeight,0):Math.min(t.scrollTop+t.clientHeight,t.scrollHeight-t.clientHeight)
};
DwtListView.prototype.setSortByAsc=function(a,t){
if(!this._headerList){
return
}
this._bSortAsc=t;
var o=null;
for(var e=0;
e<this._headerList.length;
e++){
if(this._headerList[e]._sortable&&this._headerList[e]._field==a){
o=this._headerList[e]._id;
break
}}
if(o){
this._setSortedColStyle(o)
}};
DwtListView.prototype.getNewOffset=function(t){
var e=this.getLimit();
var a=t?(this.offset+e):(this.offset-e);
return(a<0)?0:a
};
DwtListView.prototype.getLimit=function(){
return DwtListView.DEFAULT_LIMIT
};
DwtListView.prototype.getReplenishThreshold=function(){
return DwtListView.MAX_REPLENISH_THRESHOLD
};
DwtListView.prototype.getList=function(){
return this._list
};
DwtListView.prototype.getFocusElement=function(){
if(!this._kbAnchor){
this._setKbFocusElement(null,true)
}
return this._kbAnchor||this._parentEl
};
DwtListView.prototype.replenish=function(o){
this._list.addList(o);
var t=o.size();
for(var e=0;
e<t;
e++){
var a=o.get(e);
var n=this._createItemHtml(a);
if(n){
this._addRow(n)
}}};
DwtListView.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_LIST
};
DwtListView.prototype.handleKeyAction=function(n,h){
if(!this.size()){
return false
}
switch(n){
case DwtKeyMap.SELECT:this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,kbNavEvent:true}
);
break;
case DwtKeyMap.SELECT_CURRENT:this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,ctrlKey:true,kbNavEvent:true}
);
break;
case DwtKeyMap.SELECT_NEXT:this._selectItem(true,false,true);
break;
case DwtKeyMap.SELECT_PREV:this._selectItem(false,false,true);
break;
case DwtKeyMap.ADD_SELECT_NEXT:this._selectItem(true,true,true);
break;
case DwtKeyMap.ADD_SELECT_PREV:this._selectItem(false,true,true);
break;
case DwtKeyMap.PREV:this._setKbFocusElement(false);
break;
case DwtKeyMap.NEXT:this._setKbFocusElement(true);
break;
case DwtKeyMap.DBLCLICK:if(!this._kbAnchor){
break
}
var t=false;
var c=this.getSelectedItems().getArray();
for(var o=0;
o<c.length;
o++){
if(c[o]==this._kbAnchor){
t=true;
break
}}
if(t){
this.emulateDblClick(this.getItemFromElement(this._kbAnchor),true)
}else{
this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,kbNavEvent:true}
)
}
break;
case DwtKeyMap.SELECT_ALL:this.selectAll();
break;
case DwtKeyMap.SELECT_FIRST:case DwtKeyMap.SELECT_LAST:var d=(n==DwtKeyMap.SELECT_FIRST)?this._getFirstItem():this._getLastItem();
if(d){
this.setSelection(d);
this._scrollList(this._kbAnchor)
}
break;
case DwtKeyMap.SUBMENU:if(this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
var e=Dwt.toWindow(this._kbAnchor,0,0);
var u=Dwt.getSize(this._kbAnchor);
var l=e.x+u.x/4;
var r=e.y+u.y/2;
this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.RIGHT,docX:l,docY:r,kbNavEvent:true}
)
}
break;
case DwtKeyMap.PAGE_UP:case DwtKeyMap.PAGE_DOWN:this.scrollPage(n==DwtKeyMap.PAGE_UP);
break;
default:return false
}
return true
};
DwtListView.prototype.setMultiSelect=function(e){
this.setAttribute("aria-multiselectable",Boolean(e))
};
DwtListView.prototype.isMultiSelectEnabled=function(){
return this.getAttribute("aria-multiselectable")==="true"
};
DwtListView.prototype.setListDivHeight=function(a){
if(this._listDiv&&this._listColDiv){
var t=Dwt.getSize(this._listColDiv).y;
var e=a-t-25;
Dwt.setSize(this._listDiv,Dwt.DEFAULT,e)
}};
DwtListView.prototype._getStyleRegex=function(){
return new RegExp("\\bRow(-("+[DwtCssStyle.ALT_SELECTED,DwtCssStyle.SELECTED,DwtCssStyle.ACTIONED,DwtCssStyle.FOCUSED,DwtCssStyle.DISABLED,DwtCssStyle.DRAG_PROXY].join("|")+"))+\\b","g")
};
DwtListView.prototype._addRow=function(a,t){
if(!a||!this._parentEl){
return
}
var e=this._parentEl.childNodes.length;
if(t!=null&&e>0&&t!=e){
this._parentEl.insertBefore(a,this._parentEl.childNodes[t])
}else{
this._parentEl.appendChild(a)
}
this._fixAlternation((t!=null)?t:e);
a.setAttribute("role",this.itemRole)
};
DwtListView.prototype._itemAdded=function(e){};
DwtListView.prototype._fixAlternation=function(e){
var o=this._parentEl.childNodes;
if(!(o&&o.length)){
return
}
if(!(this._list&&this._list.size())){
return
}
var i=o[e];
if(!i){
return
}
var a=Boolean(e%2);
this._setAlternatingRowClass(i,a);
var t=i.nextSibling;
while(t){
a=!a;
this._setAlternatingRowClass(t,a);
t=t.nextSibling
}};
DwtListView.prototype._setAlternatingRowClass=function(i,e){
var t=e?DwtListView.ROW_CLASS_ODD:DwtListView.ROW_CLASS_EVEN;
var a=e?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD;
Dwt.delClass(i,t,a)
};
DwtListView.prototype._createItemHtml=function(d,i,r,s){
i=i||{};
this._addParams(d,i,c,l);
var e;
var c=[];
var l=0;
if(r){
l=this._getDivHtml(d,i,c,l,s)
}else{
if(i.div){
var a=[this._getDivClass(i.divClass||this._normalClass,d,i),(s%2)?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD];
i.div.className=a.join(" ")
}
e=i.div||this._getDiv(d,i)
}
var o=this.useListElement();
if(!o){
l=this._getTable(c,l,i)
}
l=this._getRow(c,l,d,i);
var t=i.headerList||this._headerList;
if(t&&t.length){
for(var n=0;
n<t.length;
n++){
if(!t[n]._visible){
continue
}
var h=t[n]._field;
l=this._getCell(c,l,d,h,n,i)
}}else{
l=this._getCell(c,l,d,null,null,i)
}
c[l++]=o?"</div>":"</tr></table>";
if(r){
c[l++]=o?"</li>":"</div>";
return c.join("")
}
e.innerHTML=c.join("");
return e
};
DwtListView.prototype._addParams=function(e,t){};
DwtListView.prototype._getDiv=function(t,a){
var i=document.createElement("div");
var e=[];
this._getDivHtml(t,a,e,0,0);
i.innerHTML=e.join("");
return i.firstChild
};
DwtListView.prototype._getExtraStyle=function(e){
return null
};
DwtListView.prototype._getDivHtml=function(h,o,n,r,s,i){
n[r++]=this.useListElement()?"<li ":"<div ";
i=i||[];
i.push(this._getDivClass(o.divClass||this._normalClass,h,o));
i.push((s%2)?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD);
n[r++]=AjxUtil.getClassAttr(i);
var t=[];
if(o.isDragProxy&&AjxEnv.isMozilla){
t.push("overflow:visible")
}
if(o.isDragProxy){
t.push("position:absolute");
t.push("width:"+this.getSize().x+"px")
}
var e=this._getExtraStyle(h);
if(e){
t.push(e)
}
if(t.length){
n[r++]=" style='";
n[r++]=t.join(";");
n[r++]="'"
}
var a=o.isDragProxy?this._getItemId(h)+"_dnd":null;
n[r++]=" id='";
n[r++]=this.associateItemWithElement(h,null,null,a);
n[r++]="'>";
return r
};
DwtListView.prototype._getDivClass=function(t,e,a){
return a.isDragProxy?([t," ",t,"-",DwtCssStyle.DRAG_PROXY].join("")):t
};
DwtListView.prototype._getTable=function(t,e,a){
t[e++]="<table width=";
t[e++]=!a.isDragProxy?"100%>":(this.getSize().x+">");
return e
};
DwtListView.prototype._getRow=function(t,e,o,s,a){
var n=this._getRowId(o,s)||Dwt.getNextId();
var i=this._getRowClass(o,s);
if(this.useListElement()){
t[e++]="<div ";
a=a||[];
if(i){
a.push(i)
}
if(n){
t[e++]=["id='",n,"'"].join("")
}
t[e++]=AjxUtil.getClassAttr(a)+">"
}else{
t[e++]=n?["<tr id='",n,"'"].join(""):"<tr";
t[e++]=i?([" class='",i,"'>"].join("")):">"
}
return e
};
DwtListView.prototype.useListElement=function(){
return false
};
DwtListView.prototype._getRowClass=function(e,t){
return null
};
DwtListView.prototype._getRowId=function(e,t){
return null
};
DwtListView.prototype._getCell=function(f,m,g,u,n,o){
if(this.useListElement()){
var i=[];
var l=this._getCellClass(g,u,o);
if(l){
i.push(l)
}
m=this._getCellContents(f,m,g,u,n,o,[l||""])
}else{
var a=this._getCellId(g,u,o);
var d=a?[" id=","'",a,"'"].join(""):"";
var t=this._getCellWidth(n,o);
var h=t?([" width=",t].join("")):(" width='100%'");
var l=this._getCellClass(g,u,o);
var s=l?[" class=",l].join(""):"";
var p=this._getCellAlign(n,o);
var c=p?[" align=",p].join(""):"";
var e=(this._getCellAttrText(g,u,o))||"";
var r=[d,h,s,c,e].join(" ");
f[m++]="<td";
f[m++]=r?(" "+r):"";
f[m++]=">";
m=this._getCellContents(f,m,g,u,n,o);
f[m++]="</td>"
}
return m
};
DwtListView.prototype._getCellWidth=function(i,a){
if(i==null){
return null
}
var e=a.headerList||this._headerList;
var t=e[i]._width;
if(t){
if(t!="auto"&&t>0){
if(AjxEnv.isIE){
return(t+2)
}
if(AjxEnv.isSafari&&!AjxEnv.isSafari6up&&!AjxEnv.isChrome19up){
return(t+5)
}}
return t
}
return null
};
DwtListView.prototype._getCellAlign=function(a,t){
if(a==null){
return null
}
var e=t.headerList||this._headerList;
return e[a]._align
};
DwtListView.prototype._getCellId=function(e,t,a){
return null
};
DwtListView.prototype._getCellClass=function(e,t,a){
return null
};
DwtListView.prototype._getCellAttrText=function(e,t,a){
return null
};
DwtListView.prototype._getCellContents=function(t,e,a,i,n,o){
t[e++]=a.toString?a.toString():a;
return e
};
DwtListView.prototype._getFieldId=function(e,t){
return DwtId.getListViewItemId(DwtId.WIDGET_ITEM_FIELD,this._view,e.id,t)
};
DwtListView.prototype._getElement=function(e,t){
return document.getElementById(this._getFieldId(e,t))
};
DwtListView.prototype._getDragProxy=function(i){
var o=this.getDnDSelection();
if(!o){
return null
}
var s;
var e;
var t;
this._dndImg=null;
if(!(o instanceof Array)||o.length==1){
var h=(o instanceof Array)?o[0]:o;
s=this._createItemHtml(h,{
now:new Date(),isDragProxy:true}
);
this._setItemData(s,"origClassName",s.className);
Dwt.setPosition(s,Dwt.ABSOLUTE_STYLE);
t="position:absolute;top:18;left:-11;visibility:hidden"
}else{
s=document.createElement("div");
s.className="DragProxy";
Dwt.setPosition(s,Dwt.ABSOLUTE_STYLE);
AjxImg.setImage(s,"DndMultiYes_48");
this._dndImg=s;
e=document.createElement("div");
Dwt.setPosition(e,Dwt.ABSOLUTE_STYLE);
var r=this.allSelected?ZmMsg.all:o.length;
e.innerHTML="<table><tr><td class='DragProxyTextLabel'>"+r+"</td></tr></table>";
s.appendChild(e);
t="position:absolute;top:30;left:0;visibility:hidden";
Dwt.setBounds(s,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE,43+32-16,36+32-20)
}
var a=AjxImg.getImageHtml("RoundPlus",t,"id="+DwtId.DND_PLUS_ID);
if(!this._noDndPlusImage){
s.appendChild(Dwt.parseHtmlFragment(a))
}
this.shell.getHtmlElement().appendChild(s);
if(e){
var n=Dwt.getSize(e);
Dwt.setLocation(e,16+(32-n.x)/2,19+(32-n.y)/2)
}
Dwt.setZIndex(s,Dwt.Z_DND);
return s
};
DwtListView.prototype._setDragProxyState=function(t){
if(this._dndImg){
AjxImg.setImage(this._dndImg,t?"DndMultiYes_48":"DndMultiNo_48")
}else{
if(this._dndProxy){
var a=t?DwtCssStyle.DROPPABLE:DwtCssStyle.NOT_DROPPABLE;
var e=this._getItemData(this._dndProxy,"origClassName");
this._dndProxy.className=[e,a].join(" ")
}}};
DwtListView.prototype._setNoResultsHtml=function(){
var t=document.createElement("div");
var e={
message:this._getNoResultsMessage(),type:this.type};
t.innerHTML=AjxTemplate.expand("dwt.Widgets#DwtListView-NoResults",e);
this._addRow(t)
};
DwtListView.prototype._getNoResultsMessage=function(){
return AjxMsg.noResults
};
DwtListView.prototype._clearRightSel=function(){
if(!this._rightSelItem){
return
}
Dwt.delClass(this._rightSelItem,this._rightClickClass);
this._rightSelItem=null;
if(!this._curViewedItem){
return
}
this.deselectAll();
this.selectItem(this._curViewedItem,true)
};
DwtListView.prototype._getItemId=function(e){
return DwtId.getListViewItemId(DwtId.WIDGET_ITEM,this._view,(e&&e.id)?e.id:Dwt.getNextId())
};
DwtListView.prototype._getElFromItem=function(e){
return Dwt.byId(this._getItemId(e))
};
DwtListView.prototype._getRowIndex=function(t){
var o=this._getItemId(t);
var a=this._parentEl.childNodes;
for(var e=0;
e<a.length;
e++){
if(a[e].id==o){
return e
}}
return null
};
DwtListView.prototype._getItemData=function(e,a,i){
i=i||(e?e.id:null);
var t=this._data[i];
return t?t[a]:null
};
DwtListView.prototype._setItemData=function(e,i,a,o){
o=o||(e?e.id:null);
var t=this._data[o];
if(t){
t[i]=a
}};
DwtListView.prototype._isValidDragObject=function(e){
return(this.getTargetItemDiv(e)!=null)
};
DwtListView.prototype._updateDragSelection=function(t,e){
if(!t){
return
}
if(!e){
t.className=this._getItemData(t,"origClassName")
}else{
this._setItemData(t,"origClassName",t.className);
Dwt.delClass(t,this._styleRe,this._dndClass)
}};
DwtListView.prototype._mouseOverAction=function(t,i){
var e=this._getItemData(i,"type");
if(e==DwtListView.TYPE_HEADER_ITEM){
var a=this.getItemFromElement(i);
if(a&&this.sortingEnabled&&a._sortable&&!this._headerClone){
i.className+=" DwtListView-ColumnHover"
}}else{
if(e==DwtListView.TYPE_HEADER_SASH){
i.style.cursor=AjxEnv.isIE?"col-resize":"e-resize"
}}
return true
};
DwtListView.prototype._mouseOutAction=function(t,i){
var e=this._getItemData(i,"type");
if(e==DwtListView.TYPE_HEADER_ITEM&&!this._headerClone){
i.className=(i.id!=this._currentColId)?"DwtListView-Column":"DwtListView-Column DwtListView-ColumnActive";
var a=this.getItemFromElement(i);
if(!a._sortable){
i.className+=" DwtDefaultCursor"
}}else{
if(e==DwtListView.TYPE_HEADER_SASH){
i.style.cursor="auto"
}}
return true
};
DwtListView.prototype._mouseOverListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
return
}
this._mouseOverAction(e,t)
};
DwtListView.prototype._mouseOutListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
return
}
this.setToolTipContent(null);
this._mouseOutAction(e,t)
};
DwtListView.prototype._mouseMoveListener=function(t){
if(!this._clickDiv){
return
}
var e=this._getItemData(this._clickDiv,"type");
if(e==DwtListView.TYPE_HEADER_ITEM){
this._handleColHeaderMove(t)
}else{
if(e==DwtListView.TYPE_HEADER_SASH){
this._handleColHeaderResize(t)
}}};
DwtListView.prototype._mouseDownListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
this._dndSelection=null
}else{
this._clickDiv=t;
if(this._getItemData(t,"type")!=DwtListView.TYPE_LIST_ITEM){
this._dndSelection=null
}else{
this._dndSelection=(this._selectedItems.contains(t))?this._selectedItems:t
}}
this._mouseDownAction(e,t)
};
DwtListView.prototype._mouseUpListener=function(a){
var n=this.getTargetItemDiv(a);
var o=this._handleColHeaderDrop(a);
var e=this._handleColSashDrop(a);
if(!n||n!=this._clickDiv||o||e){
delete this._clickDiv;
this._mouseUpAction(a,n);
return
}
delete this._clickDiv;
var t=this._getItemData(n,"type");
if(this._headerList&&t==DwtListView.TYPE_HEADER_ITEM){
if(a.button==DwtMouseEvent.LEFT){
this._columnClicked(n,a)
}else{
if(a.button==DwtMouseEvent.RIGHT){
var i=this._colHeaderActionMenu=this._getActionMenuForColHeader();
if(i&&i instanceof DwtMenu){
i.popup(0,a.docX,a.docY)
}}}}else{
if(t==DwtListView.TYPE_LIST_ITEM){
if(a.button==DwtMouseEvent.LEFT||a.button==DwtMouseEvent.RIGHT){
this._itemClicked(n,a)
}}}
this._mouseUpAction(a,n)
};
DwtListView.prototype._mouseDownAction=function(e,t){};
DwtListView.prototype._mouseUpAction=function(e,t){};
DwtListView.prototype._doubleClickAction=function(e,t){
return true
};
DwtListView.prototype._doubleClickListener=function(t){
var a=this.getTargetItemDiv(t);
if(!a){
return
}
var e=this._getItemData(a,"type");
if(e==DwtListView.TYPE_LIST_ITEM){
if(!this._doubleClickAction(t,a)){
return
}
if(this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
DwtUiEvent.copy(this._selEv,t);
this._selEv.item=this.getItemFromElement(a);
this._selEv.detail=DwtListView.ITEM_DBL_CLICKED;
this._evtMgr.notifyListeners(DwtEvent.SELECTION,this._selEv)
}}};
DwtListView.prototype.emulateDblClick=function(e,t){
var i=document.getElementById(this._getItemId(e));
if(i){
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
target:i,button:DwtMouseEvent.LEFT}
);
a.kbNavEvent=t;
this._itemClicked(i,a);
this._doubleClickListener(a)
}};
DwtListView.prototype._selectItem=function(a,e,i){
if(!this.size()){
return
}
var t=(this._kbAnchor)?this._getSiblingElement(this._kbAnchor,a):this._parentEl.firstChild;
this._scrollList(t);
this._emulateSingleClick({
target:t,button:DwtMouseEvent.LEFT,shiftKey:e,kbNavEvent:i}
)
};
DwtListView.prototype._getSiblingElement=function(e,a){
if(!e){
return null
}
var t=a?e.nextSibling:e.previousSibling;
while(this._hasHiddenRows&&t&&!Dwt.getVisible(t)){
t=a?t.nextSibling:t.previousSibling
}
return(!t||(this._hasHiddenRows&&!Dwt.getVisible(t)))?e:t
};
DwtListView.prototype._scrollList=function(e){
Dwt.scrollIntoView(e,e.parentNode)
};
DwtListView.prototype._setRowHeight=function(){
if(!this._rowHeight){
var e=this._parentEl.firstChild;
this._rowHeight=e&&Dwt.getSize(e).y
}};
DwtListView.prototype._emulateSingleClick=function(e){
this._clickDiv=this.findItemDiv(e.target);
var t=new DwtMouseEvent();
this._setMouseEvent(t,e);
t.kbNavEvent=e.kbNavEvent;
this.notifyListeners(DwtEvent.ONMOUSEUP,t)
};
DwtListView.prototype._setKbFocusElement=function(e,t){
if(!this._list||!this._list.size()){
this._kbAnchor=null;
this.setFocusElement(this.getHtmlElement());
return
}
if(this._kbAnchor){
this._setEventHdlrs([DwtEvent.ONFOCUS,DwtEvent.ONBLUR],true,this._kbAnchor);
this._unmarkKbAnchorElement()
}
if(e&&e!==true){
this._kbAnchor=e
}else{
if(this._kbAnchor){
this._kbAnchor=this._getSiblingElement(this._kbAnchor,e)
}else{
this._kbAnchor=this._parentEl.firstChild
}}
this.setFocusElement(this._kbAnchor);
if(this._kbAnchor&&!t){
Dwt.addClass(this._kbAnchor,this._kbFocusClass);
if(!this._duringFocusByMouseDown){
this._scrollList(this._kbAnchor)
}
var a=this.shell.getKeyboardMgr();
if(this.hasFocus()||a.getFocusObj()===this){
a.grabFocus(this)
}}};
DwtListView.prototype._itemSelected=function(e,a){
if(this._allowLeftSelection(e,a,a&&a.button)){
this._unmarkKbAnchorElement(true);
this.deselectAll();
this._selectedItems.add(e);
e.setAttribute("aria-selected",true);
this._setKbFocusElement(e);
this._selAnchor=e;
Dwt.delClass(e,this._styleRe,this._selectedClass);
if(this.hasFocus()){
Dwt.addClass(e,this._kbFocusClass)
}
var t=this.getItemFromElement(e);
this._markUnselectedViewedItem(false);
this._curViewedItem=t;
this.firstSelIndex=(this._list&&t)?this._list.indexOf(t):-1
}};
DwtListView.prototype._itemClicked=function(r,u){
if(this._rightSelItem){
Dwt.delClass(this._rightSelItem,this._styleRe);
this._rightSelItem=null
}
var s=this._selectedItems.size();
var o=this._selectedItems.contains(r);
if((!u.shiftKey&&!u.ctrlKey)||!this.isMultiSelectEnabled()){
if(u.button==DwtMouseEvent.LEFT||u.button==DwtMouseEvent.RIGHT){
this._selEv.detail=DwtListView.ITEM_SELECTED
}
if(u.button==DwtMouseEvent.LEFT){
this._itemSelected(r,u)
}else{
if(u.button==DwtMouseEvent.RIGHT&&!o&&this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
this.deselectAll();
this._markUnselectedViewedItem(true);
this._rightSelItem=r;
Dwt.delClass(r,this._styleRe,this._rightClickClass);
this._setKbFocusElement(r,true)
}}}else{
if(u.button==DwtMouseEvent.LEFT){
if(u.ctrlKey){
this.setMultiSelection(r,o,u)
}else{
if(!this._selAnchor){
return
}
var h=this._getChildren()||r.parentNode.childNodes;
var c=h.length;
var n;
var t=0;
this._rightSelItem=null;
this._selectedItems.removeAll();
for(var l=0;
l<c;
l++){
n=h[l];
var m=this.getItemFromElement(n);
if(m===null){
continue
}
var a=this._selectedClass;
var e=(t===1);
if(n===r||n===this._selAnchor||n.id===r.id||n.id===this._selAnchor.id){
t++;
e=true
}
if(e){
this._selectedItems.add(n);
n.setAttribute("aria-selected",true);
Dwt.delClass(n,this._styleRe,a)
}else{
if(n.className.indexOf(a)!==-1){
Dwt.delClass(n,this._styleRe);
n.removeAttribute("aria-selected")
}}}
this._setKbFocusElement(r);
var d=this._selectedItems.size();
if(s<d){
this._selEv.detail=DwtListView.ITEM_SELECTED
}else{
if(s>d){
this._selEv.detail=DwtListView.ITEM_DESELECTED
}else{
return
}}}}}
if(u.button==DwtMouseEvent.LEFT&&this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
if(this._setListEvent(u,this._selEv,r)){
this._evtMgr.notifyListeners(DwtEvent.SELECTION,this._selEv)
}
if(!this.hasFocus()){
this.focus()
}}else{
if(u.button==DwtMouseEvent.RIGHT&&!u.shiftKey&&!u.ctrlKey&&this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
if(this._setListEvent(u,this._actionEv,r)){
this._evtMgr.notifyListeners(DwtEvent.ACTION,this._actionEv)
}}}};
DwtListView.prototype._focusByMouseDownEvent=function(){};
DwtListView.prototype._setListEvent=function(t,a,e){
DwtUiEvent.copy(a,t);
a.kbNavEvent=t.kbNavEvent;
a.item=this.findItem(e);
return true
};
DwtListView.prototype._columnClicked=function(o,a){
var n=this.getItemFromElement(o);
if(!(n._sortable&&this.sortingEnabled)){
return
}
var i=this.getList();
var e=i?i.size():null;
var t=this._columnHasCustomQuery(n);
if(!e&&!t){
return
}
this._bSortAsc=(n._id===this._currentColId)?!this._bSortAsc:this._isDefaultSortAscending(n);
this._setSortedColStyle(n._id);
if(e>=1||t){
this._sortColumn(n,this._bSortAsc)
}};
DwtListView.prototype._columnHasCustomQuery=function(e){
return false
};
DwtListView.prototype._sortColumn=function(e,t){};
DwtListView.prototype._getActionMenuForColHeader=function(){
return null
};
DwtListView.prototype._isDefaultSortAscending=function(e){
return true
};
DwtListView.prototype._allowLeftSelection=function(t,a,e){
return true
};
DwtListView.prototype._setSortedColStyle=function(e){
if(this._currentColId&&(e!=this._currentColId)){
var n=this._headerIdHash[this._currentColId];
if(n&&!n._noSortArrow){
var s=n._field;
var r=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,s);
var i=document.getElementById(r);
if(i&&i.firstChild){
var t=(AjxImg._mode==AjxImg.SINGLE_IMG)?i.firstChild:i.firstChild.firstChild;
if(t){
t.style.visibility="hidden"
}}}
var l=document.getElementById(this._currentColId);
if(l){
l.className="DwtListView-Column"
}}
this._currentColId=e;
var n=this._headerIdHash[this._currentColId];
if(!n._noSortArrow){
var s=n._field;
var h=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,s);
var a=document.getElementById(h);
if(a){
AjxImg.setImage(a,this._bSortAsc?"ColumnUpArrow":"ColumnDownArrow");
var t=(AjxImg._mode==AjxImg.SINGLE_IMG)?a.firstChild:a.firstChild.firstChild;
if(t){
t.style.visibility="visible"
}}}
var o=document.getElementById(e);
if(o){
o.className="DwtListView-Column DwtListView-ColumnActive"
}};
DwtListView.prototype._resetList=function(){
if(this._list&&this._list.size()){
this._list.removeAll()
}
this._resetListView()
};
DwtListView.prototype._resetListView=function(){
var e;
while(this._parentEl&&this._parentEl.hasChildNodes()){
var e=this._parentEl.removeChild(this._parentEl.firstChild);
this._data[e.id]=null
}
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=null
};
DwtListView.prototype._destroyDragProxy=function(e){
this._data[e.id]=null;
DwtControl.prototype._destroyDragProxy.call(this,e)
};
DwtListView.prototype._handleColHeaderMove=function(s){
if(!this._headerClone){
if(!this._headerColX){
this._headerColX=s.docX;
return
}else{
var o=Math.abs(this._headerColX-s.docX);
if(o<DwtListView.COL_MOVE_THRESHOLD){
return
}}
this._headerClone=document.createElement("div");
var c=Dwt.getSize(this._clickDiv);
var t=AjxEnv.isIE?c.x:c.x-3;
var l=AjxEnv.isIE?c.y:c.y-5;
Dwt.setSize(this._headerClone,t,l);
Dwt.setPosition(this._headerClone,Dwt.ABSOLUTE_STYLE);
Dwt.setZIndex(this._headerClone,Dwt.Z_DND);
Dwt.setLocation(this._headerClone,Dwt.DEFAULT,s.docY);
this._headerClone.className=this._clickDiv.className+" DragProxy";
this._headerClone.innerHTML=this._clickDiv.innerHTML;
this._clickDiv.className="DwtListView-Column DwtListView-ColumnEmpty";
this._headerClone.style.borderTop="1px solid #777777";
var r=this._headerIdHash[this._clickDiv.id];
var h=r._field;
var i=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,h);
var a=document.getElementById(i);
if(a){
a.style.color="#FFFFFF"
}
this.shell.getHtmlElement().appendChild(this._headerClone)
}else{
var e=this.getTargetItemDiv(s);
var n=this._getItemData(e,"type");
if(n==DwtListView.TYPE_HEADER_ITEM){
if(this._headerCloneTarget&&(this._headerCloneTarget==this._clickDiv)){
this._headerCloneTarget=null
}else{
if(this._headerCloneTarget!=e){
this._headerCloneTarget=e
}}}else{
this._headerCloneTarget=null
}}
if(this._headerClone){
Dwt.setLocation(this._headerClone,s.docX+2)
}};
DwtListView.prototype._handleColHeaderResize=function(t){
if(!this._headerSash){
this._headerSash=document.createElement("div");
Dwt.setSize(this._headerSash,Dwt.DEFAULT,this.getSize().y);
Dwt.setPosition(this._headerSash,Dwt.ABSOLUTE_STYLE);
Dwt.setZIndex(this._headerSash,Dwt.Z_DND);
var a=this._getHeaderSashLocation();
this._headerSashFudgeX=a.x;
Dwt.setLocation(this._headerSash,Dwt.DEFAULT,a.y);
this._headerSash.className="DwtListView-ColumnSash";
this.getHtmlElement().appendChild(this._headerSash);
this._headerSashX=t.docX
}
var e=this._getParentForColResize();
var i=Dwt.toWindow(e.getHtmlElement(),0,0);
Dwt.setLocation(this._headerSash,(t.docX-i.x)+this._headerSashFudgeX)
};
DwtListView.prototype._getHeaderSashLocation=function(){
if(!this._tmpPoint){
this._tmpPoint=new DwtPoint()
}
this._tmpPoint.x=0;
this._tmpPoint.y=0;
return this._tmpPoint
};
DwtListView.prototype._handleColHeaderDrop=function(h){
this._headerColX=null;
if(this._headerClone==null||h.button==DwtMouseEvent.RIGHT){
return false
}
if(this._headerCloneTarget){
var e=this._getItemData(this._clickDiv,"index");
var a=this._getItemData(this._headerCloneTarget,"index");
this._reIndexColumn(e,a)
}
this._clickDiv.className=(this._clickDiv.id!=this._currentColId)?"DwtListView-Column":"DwtListView-Column DwtListView-ColumnActive";
var c=this._headerClone.parentNode;
if(c){
c.removeChild(this._headerClone)
}
delete this._headerClone;
var s=this._data[this._clickDiv.id];
if(s.type!=DwtListView.TYPE_HEADER_ITEM){
var l=this._headerIdHash[this._currentColId];
var r=l._sortable?l._field:null;
this.headerColCreated=false;
this.createHeaderHtml(r)
}else{
var l=this._headerIdHash[this._clickDiv.id];
var o=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,l._field);
var t=document.getElementById(o);
if(t){
t.style.color="#000000"
}}
for(var n=0;
n<this._headerList.length;
n++){
this._headerList[n]._width=this._calcRelativeWidth(n)
}
this._resetColWidth();
return true
};
DwtListView.prototype._reIndexColumn=function(i,a){
if(!this._headerList){
return
}
var e=this._headerList.length;
if(i<0||a<0||i>=e||a>=e||i==a){
return
}
var t=this._headerList.splice(i,1);
this._headerList.splice(a,0,t[0]);
this._relayout()
};
DwtListView.prototype._handleColSashDrop=function(c){
if(this._headerSash==null||c.button==DwtMouseEvent.RIGHT){
return false
}
var d=this._headerSash.parentNode;
if(d){
d.removeChild(this._headerSash)
}
delete this._headerSash;
for(var o=0;
o<this._headerList.length;
o++){
this._headerList[o]._width=this._calcRelativeWidth(o)
}
var a=this._getItemData(this._clickDiv,"index");
if(a==null){
return false
}
var u=c.docX-this._headerSashX;
var l=this._headerList[a];
var h=l;
var r;
var n=[];
if(u<0){
if((h==r)||!r){
r=this._getNextResizeableColumnHeader(h)
}
if(!r){
return false
}
u=Math.max(DwtListView.MIN_COLUMN_WIDTH-l._width,u);
l._width=Math.max(l._width+u,DwtListView.MIN_COLUMN_WIDTH);
r._width=Math.max(this._calcRelativeWidth(r._index)-u,DwtListView.MIN_COLUMN_WIDTH);
n.push(l._index,r._index)
}else{
if(u>0){
var s=u;
while(s>0){
if((h==r)||!r){
r=this._getNextResizeableColumnHeader(h,[],false)
}
if(!r){
u-=s;
break
}
var m=this._calcRelativeWidth(r._index);
var e=m-DwtListView.MIN_COLUMN_WIDTH;
if(s>e){
s-=e;
m=DwtListView.MIN_COLUMN_WIDTH
}else{
m-=s;
s=0
}
r._width=m;
n.push(r._index);
h=r
}
l._width=Math.max(l._width+u,DwtListView.MIN_COLUMN_WIDTH);
n.push(l._index)
}}
var t=this._getNextResizeableColumnHeader(l,n,true);
if(t){
t._width="auto"
}
this._relayout();
this._resetColWidth();
return true
};
DwtListView.prototype.recalculateCssStyle=function(){
for(var e=0;
e<this._headerList.length;
e++){
var t=this._headerList[e];
this._createHeaderCssStyle(t,this._calcRelativeWidth(e))
}};
DwtListView.prototype._calcRelativeWidth=function(a){
var t=this._headerList[a];
if(!t._width||(t._width&&t._width=="auto")){
var e=document.getElementById(t._id);
return(e)?(e.clientWidth-(AjxEnv.isIE?4:5)):null
}
return t._width
};
DwtListView.prototype._resetColWidth=function(){
if(!this.headerColCreated){
return
}
var n=this._getLastColumnIndex();
if(n){
var a=this._headerList[n];
var t=document.getElementById(a._id);
if(t){
var s=t.firstChild;
var e=16;
var o=this._listColDiv.clientWidth;
var i=this._listDiv.clientWidth;
if(o!=i){
t.style.width=s.style.width=(a._width!=null&&a._width!="auto")?(a._width+e+"px"):(t.clientWidth+e+"px")
}else{
Dwt.setSize(t,a._width,Dwt.DEFAULT);
Dwt.setSize(s,a._width,Dwt.DEFAULT)
}
this.recalculateCssStyle()
}}};
DwtListView.prototype._getLastColumnIndex=function(){
var t=null;
if(this._headerList){
var e=this._headerList.length-1;
while(t==null&&e>=0){
if(this._headerList[e]._visible){
t=e
}
e--
}}
return t
};
DwtListView.prototype._getNextResizeableColumnIndex=function(n,e,o){
e=e?AjxUtil.arrayAsHash(e):{};
e[n]=true;
if(this._headerList){
for(var a=n+1;
a<this._headerList.length;
a++){
var t=this._headerList[a];
if(e[a]){
continue
}
if(t._visible&&t._resizeable){
return a
}}
if(o){
for(var a=0;
a<n;
a++){
if(e[a]){
continue
}
var t=this._headerList[a];
if(t._visible&&t._resizeable){
return a
}}}}
return null
};
DwtListView.prototype._getNextResizeableColumnHeader=function(i,e,a){
var t=this._getNextResizeableColumnIndex(i._index,e,a);
return(t!==null)?this._headerList[t]:false
};
DwtListView.prototype._relayout=function(){
this.headerColCreated=false;
var a=this._headerIdHash[this._currentColId];
var e=(a&&a._sortable)?a._field:null;
var t=this.getSelection()[0];
this.setUI(e);
this.setSelection(t,true)
};
DwtListView.prototype._getParentForColResize=function(){
return this
};
DwtListView.prototype._sizeChildren=function(e){
if(this.headerColCreated&&this._listDiv&&(e!=Dwt.DEFAULT)){
Dwt.setSize(this._listDiv,Dwt.DEFAULT,e-DwtListView.HEADERITEM_HEIGHT);
return true
}else{
return false
}};
DwtListView.prototype._getChildren=function(){
return null
};
DwtListView.prototype._focus=function(){
if(this.size()==0){
return
}
if(this._kbAnchor){
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}else{
this._setKbFocusElement(null,true)
}};
DwtListView.prototype._blur=function(){
this._unmarkKbAnchorElement()
};
DwtListView.prototype._unmarkKbAnchorElement=function(e){
if(this._kbAnchor){
Dwt.delClass(this._kbAnchor,this._kbFocusClass)
}
if(e){
this._kbAnchor=null
}};
DwtListView.prototype._getFirstItem=function(){
var e=this._list.getArray();
if(e&&e.length>1){
return e[0]
}
return null
};
DwtListView.prototype._getLastItem=function(){
var e=this._list.getArray();
if(e&&e.length>1){
return e[e.length-1]
}
return null
};
DwtListHeaderItem=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtListView.PARAMS);
this._field=t.field;
this._label=t.text;
this._iconInfo=t.icon;
this._sortable=t.sortable;
this._noSortArrow=t.noSortArrow;
this._resizeable=t.resizeable;
this._visible=(t.visible!==false);
this._name=t.name||t.text;
this._align=t.align;
this._noRemove=t.noRemove;
this._tooltip=t.tooltip;
this._cssClass=t.cssClass;
var e=parseInt(t.width);
if(isNaN(e)||!e){
this._width="auto";
this._variable=true;
this._resizeable=true
}else{
if(String(e)==String(t.width)){
this._width=e
}else{
this._width=parseInt(String(t.width).substr(0,String(e).length));
this._widthUnits=AjxStringUtil.getUnitsFromSizeString(t.width)
}}};
DwtListHeaderItem.prototype.isDwtListHeaderItem=true;
DwtListHeaderItem.prototype.toString=function(){
return"DwtListHeaderItem"
};
DwtListHeaderItem.PARAMS=["id","text","icon","width","sortable","resizeable","visible","name","align","noRemove","view"];
DwtListHeaderItem.sortCompare=function(t,e){
return t._index<e._index?-1:(t._index>e._index?1:0)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtButton")){
DwtButton=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtButton.PARAMS);
a.className=a.className||"ZButton";
DwtLabel.call(this,a);
var t=a.parent;
if(!t._hasSetMouseEvents||AjxEnv.isIE){
this._setMouseEvents()
}
var e;
if(t._hasSetMouseEvents){
e=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[]
}else{
e=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
e.push(DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONCLICK)
}
if(e&&e.length){
this._setEventHdlrs(e)
}
this._listeners=a.listeners||DwtButton._listeners;
this._addMouseListeners();
this._ignoreInternalOverOut=true;
this._dropDownEvtMgr=new AjxEventMgr();
this._selected=false;
this._actionTiming=a.actionTiming||DwtButton.ACTION_MOUSEUP;
this.__preventMenuFocus=null;
this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_BELOW
};
DwtButton.prototype=new DwtLabel;
DwtButton.prototype.constructor=DwtButton;
DwtButton.prototype.isDwtButton=true;
DwtButton.prototype.toString=function(){
return"DwtButton"
};
DwtButton.prototype.role="button";
DwtButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index","listeners"];
DwtButton.TOGGLE_STYLE=DwtLabel._LAST_STYLE*2;
DwtButton.ALWAYS_FLAT=DwtLabel._LAST_STYLE*4;
DwtButton._LAST_STYLE=DwtButton.ALWAYS_FLAT;
DwtButton.ACTION_MOUSEUP=1;
DwtButton.ACTION_MOUSEDOWN=2;
DwtButton.NOTIFY_WINDOW=500;
DwtButton.MENU_POPUP_STYLE_BELOW="BELOW";
DwtButton.MENU_POPUP_STYLE_ABOVE="ABOVE";
DwtButton.MENU_POPUP_STYLE_RIGHT="RIGHT";
DwtButton.MENU_POPUP_STYLE_CASCADE="CASCADE";
DwtButton.MOUSE_EVENTS=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP];
if(AjxEnv.isIE){
DwtButton.MOUSE_EVENTS.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{
DwtButton.MOUSE_EVENTS.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
DwtButton.prototype.TEMPLATE="dwt.Widgets#ZButton";
DwtButton.prototype.dispose=function(){
if(this._menu&&this._menu.isDwtMenu&&(this._menu.parent==this)){
this._menu.dispose();
this._menu=null
}
DwtLabel.prototype.dispose.call(this)
};
DwtButton.prototype.addSelectionListener=function(t,e){
this.addListener(DwtEvent.SELECTION,t,e)
};
DwtButton.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype.removeSelectionListeners=function(){
this.removeAllListeners(DwtEvent.SELECTION)
};
DwtButton.prototype.addDropDownSelectionListener=function(e){
return this._dropDownEvtMgr.addListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype.removeDropDownSelectionListener=function(e){
this._dropDownEvtMgr.removeListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype._dropDownImg="SelectPullDownArrow";
DwtButton.prototype._dropDownDepImg="SelectPullDownArrow";
DwtButton.prototype._dropDownHovImg="SelectPullDownArrowHover";
DwtButton.prototype.setDropDownImages=function(t,a,i,e){
this._dropDownImg=t;
this._dropDownHovImg=i;
this._dropDownDepImg=e
};
DwtButton.prototype.setDropDownHovImage=function(e){
this._dropDownHovImg=e
};
DwtButton.prototype._addMouseListeners=function(){
AjxUtil.foreach(DwtButton.MOUSE_EVENTS,(function(e){
this.addListener(e,this._listeners[e])
}
).bind(this))
};
DwtButton.prototype._removeMouseListeners=function(){
AjxUtil.foreach(DwtButton.MOUSE_EVENTS,(function(e){
this.removeListener(e,this._listeners[e])
}
).bind(this))
};
DwtButton.prototype.setDisplayState=function(t,e){
if(this._selected&&t!=DwtControl.SELECTED&&!e){
t=[DwtControl.SELECTED,t].join(" ")
}
DwtLabel.prototype.setDisplayState.call(this,t)
};
DwtButton.prototype.setEnabled=function(t){
if(t!=this._enabled){
DwtLabel.prototype.setEnabled.call(this,t);
if(t){
var a=(AjxEnv.isIE)?this.getHtmlElement().firstChild:null;
if(a){
var e=a.className;
a.className="";
a.className=e
}
this._addMouseListeners();
if(this._menu){
this._setDropDownCellMouseHandlers(true);
if(this._dropDownEl&&this._dropDownImg){
AjxImg.setImage(this._dropDownEl,this._dropDownImg)
}}}else{
this._removeMouseListeners();
if(this._menu){
this._setDropDownCellMouseHandlers(false);
if(this._dropDownEl&&this._dropDownImg){
AjxImg.setDisabledImage(this._dropDownEl,this._dropDownImg)
}}}}};
DwtButton.prototype.setImage=function(e,t){
if(this.whatToShow&&!this.whatToShow.showImage){
return
}
DwtLabel.prototype.setImage.apply(this,arguments);
this._setMinWidth()
};
DwtButton.prototype.setText=function(e){
if(this.whatToShow&&!this.whatToShow.showText){
return
}
DwtLabel.prototype.setText.call(this,e);
this._setMinWidth()
};
DwtButton.prototype._setMinWidth=function(){
if(this.getText()!=null){
Dwt.addClass(this.getHtmlElement(),"ZHasText")
}else{
Dwt.delClass(this.getHtmlElement(),"ZHasText")
}};
DwtButton.prototype.setHoverImage=function(t,e){
e=e||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
this._hoverImageInfo=this._hoverImageInfo||{};
this._hoverImageInfo[e]=t
};
DwtButton.prototype.setMenu=function(e){
e=Dwt.getParams(arguments,DwtButton.setMenuParams,(arguments.length==1&&arguments[0]&&!arguments[0].menu));
if(e){
this._menu=e.menu
}
if(this._menu){
if(this._menu.isDwtMenu){
this._shouldToggleMenu=(e.shouldToggle===true);
if(e.popupAbove){
this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_ABOVE
}else{
if(e.popupRight){
this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_RIGHT
}else{
this._menuPopupStyle=e.menuPopupStyle||DwtButton.MENU_POPUP_STYLE_BELOW
}}
this._menuAdded(this._menu)
}else{
this._savedMenuParams=e
}
if(this._dropDownEl){
Dwt.addClass(this.getHtmlElement(),"ZHasDropDown");
if(this._dropDownImg){
AjxImg.setImage(this._dropDownEl,this._dropDownImg)
}
if(this._enabled){
this._setDropDownCellMouseHandlers(true)
}
if(this._menu.isDwtMenu){
this._menu.setAssociatedElementId(this._dropDownEl.id)
}}
if((this.__preventMenuFocus!=null)&&this._menu.isDwtMenu){
this._menu.dontStealFocus(this.__preventMenuFocus)
}}else{
if(this._dropDownEl){
Dwt.delClass(this.getHtmlElement(),"ZHasDropDown");
this._dropDownEl.innerHTML=""
}}};
DwtButton.setMenuParams=["menu","shouldToggle","followIconStyle","popupAbove","popupRight"];
DwtButton.prototype._setDropDownCellMouseHandlers=function(e){
this._dropDownEventsEnabled=e
};
DwtButton.prototype.getMenu=function(e){
if(this._menu&&this._menu.isAjxCallback){
if(e){
return null
}
var a=this._menu;
var t=this._savedMenuParams||{};
t.menu=a.run(this);
this.setMenu(t);
if((this.__preventMenuFocus!=null)&&(this._menu.isDwtMenu)){
this._menu.dontStealFocus(this.__preventMenuFocus)
}}
if(this._menu){
this.setAttribute("menuId",this._menu._htmlElId)
}
return this._menu
};
DwtButton.prototype.resetClassName=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype.setActionTiming=function(e){
this._actionTiming=e
};
DwtButton.prototype.setHovered=function(e){
this.setDisplayState(e?DwtControl.HOVER:DwtControl.NORMAL)
};
DwtButton.prototype.setEnabledImage=function(e){
this._enabledImageInfo=e;
this.setImage(e)
};
DwtButton.prototype.setDepressedImage=function(e){
this._depressedImageInfo=e
};
DwtButton.prototype.setSelected=function(e){
if(this._selected!=e){
this._selected=e;
this.setDisplayState(e?DwtControl.SELECTED:DwtControl.NORMAL)
}};
DwtButton.prototype.isToggled=function(){
return this._selected
};
DwtButton.prototype.popup=function(o,t){
o=o||this.getMenu();
if(!o){
return
}
var c=o.parent;
var s=c.getBounds();
var l=o.shell.getSize();
var a=o.getSize();
var d=c.getHtmlElement();
var i=Dwt.toWindow(d,0,0);
var e=(d.style.borderLeftWidth=="")?0:parseInt(d.style.borderLeftWidth);
var u=Boolean(t&&DwtKeyEvent.isKeyEvent(t));
var h;
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_RIGHT){
h=i.x+s.width-a.x
}else{
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_CASCADE){
h=i.x+s.width
}else{
h=i.x+e;
h=((h+a.x)>=l.x)?l.x-a.x:h
}}
var r;
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_ABOVE){
r=i.y-a.y
}else{
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_CASCADE){
r=i.y
}else{
var n=(d.style.borderTopWidth=="")?0:parseInt(d.style.borderTopWidth);
n+=(d.style.borderBottomWidth=="")?0:parseInt(d.style.borderBottomWidth);
r=i.y+s.height+n
}}
o.popup(0,h,r,u);
o.setSelectedItem(0)
};
DwtButton.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_BUTTON
};
DwtButton.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.SELECT:this._emulateSingleClick();
break;
case DwtKeyMap.SUBMENU:var a=this.getMenu();
if(!a){
return false
}
this._emulateDropDownClick();
a.setSelectedItem(0);
break
}
return true
};
DwtButton.prototype.removePullDownMenuOptions=function(){
if(this._menu){
this._setDropDownCellMouseHandlers(false);
if(this._dropDownEl&&this._dropDownImg){
AjxImg.setImage(this._dropDownEl,"");
this.setDropDownImages("","","","")
}}};
DwtButton.prototype._emulateSingleClick=function(){
this.trigger();
var e=this.getHtmlElement();
var t=Dwt.toWindow(e);
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
type:this._actionTiming==DwtButton.ACTION_MOUSEDOWN?DwtEvent.ONMOUSEDOWN:DwtEvent.ONMOUSEUP,dwtObj:this,target:e,button:DwtMouseEvent.LEFT,docX:t.x,docY:t.y,kbNavEvent:true}
);
this.notifyListeners(a.type,a)
};
DwtButton.prototype._emulateDropDownClick=function(){
var e=this._dropDownEl;
if(!e){
return
}
var t=Dwt.toWindow(e);
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
dwtObj:this,target:e,button:DwtMouseEvent.LEFT,docX:t.x,docY:t.y,kbNavEvent:true}
);
DwtButton._dropDownCellMouseUpHdlr(a)
};
DwtButton.prototype._focusByMouseUpEvent=function(){};
DwtButton.prototype._focus=function(){
this.setDisplayState(DwtControl.FOCUSED)
};
DwtButton.prototype._blur=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._toggleMenu=function(e){
if(this._shouldToggleMenu){
var t=this.getMenu();
if(!t.isPoppedUp()){
this.popup(null,e);
this._menuUp=true
}else{
t.popdown(0,e);
this._menuUp=false;
this.deactivate()
}}else{
this.popup(null,e)
}};
DwtButton.prototype._isDropDownEvent=function(t){
if(this._dropDownEventsEnabled&&this._dropDownEl){
var e=t.docX;
var a=Dwt.toWindow(this._dropDownEl,0,0,window).x;
if(e>=a){
return true
}}
return false
};
DwtButton.prototype.trigger=function(){
if(this._depressedImageInfo){
this.setImage(this._depressedImageInfo)
}
this.setDisplayState(DwtControl.ACTIVE,true);
this.isActive=true
};
DwtButton.prototype.deactivate=function(){
this._showHoverImage(true);
if(this._style&DwtButton.TOGGLE_STYLE){
this._selected=!this._selected
}
this.setDisplayState(DwtControl.HOVER)
};
DwtButton.prototype.dontStealFocus=function(e){
if(e==null){
e=true
}
if(this._menu&&this._menu.isDwtMenu){
this._menu.dontStealFocus(e)
}
this.__preventMenuFocus=e
};
DwtButton.prototype._toggleHoverClass=function(t,i){
var e=this._getIconEl(i);
if(e){
var a=t?this._hoverImageInfo[i]:this.__imageInfo[i];
e.firstChild.className=AjxImg.getClassForImage(a)
}};
DwtButton.prototype._showHoverImage=function(e){
if(!this._hoverImageInfo){
return
}
if(this._hoverImageInfo.left){
this._toggleHoverClass(e,DwtLabel.LEFT)
}
if(this._hoverImageInfo.right){
this._toggleHoverClass(e,DwtLabel.RIGHT)
}};
DwtButton.prototype._handleClick=function(t){
if(this.isListenerRegistered(DwtEvent.SELECTION)){
var e=(new Date()).getTime();
if(!this._lastNotify||(e-this._lastNotify>DwtButton.NOTIFY_WINDOW)){
var a=DwtShell.selectionEvent;
DwtUiEvent.copy(a,t);
a.item=this;
a.detail=(typeof this.__detail=="undefined")?0:this.__detail;
this.notifyListeners(DwtEvent.SELECTION,a);
this._lastNotify=e;
this.shell.notifyGlobalSelection(a)
}}else{
if(this._menu){
if(this._menu.isDwtMenu&&!this.isListenerRegistered(DwtEvent.SELECTION)){
this._menu.setAssociatedObj(this)
}
this._toggleMenu(t)
}}};
DwtButton.prototype._setMouseOutClassName=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._createHtmlFromTemplate=function(e,t){
DwtLabel.prototype._createHtmlFromTemplate.call(this,e,t);
this._dropDownEl=document.getElementById(t.id+"_dropdown")
};
DwtButton.prototype._menuAdded=function(e){
this.setAttribute("aria-haspopup",true);
this.setAttribute("aria-controls",e._htmlElId)
};
DwtButton.prototype._menuItemSelected=function(e){};
DwtButton._dropDownCellMouseDownHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,a);
if(e.button==DwtMouseEvent.LEFT){
if(this._depImg){
AjxImg.setImage(this,this._depImg)
}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtButton._dropDownCellMouseUpHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(e.button==DwtMouseEvent.LEFT){
if(this._dropDownHovImg&&!this.noMenuBar){
AjxImg.setImage(this,this._dropDownHovImg)
}
DwtEventManager.notifyListeners(DwtEvent.ONMOUSEDOWN,e);
var i=DwtControl.getTargetControl(t);
if(i){
if(i.getMenu()&&i.getMenu().isPoppedUp()){
i.getMenu().popdown()
}else{
if(i._menu&&i._menu.isAjxCallback){
i.popup()
}
if(i._dropDownEvtMgr.isListenerRegistered(DwtEvent.SELECTION)){
var a=DwtShell.selectionEvent;
DwtUiEvent.copy(a,e);
a.item=i;
i._dropDownEvtMgr.notifyListeners(DwtEvent.SELECTION,a)
}else{
i._toggleMenu(t)
}}}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtButton._mouseOverListener=function(i){
var t=i.dwtObj;
if(!t){
return false
}
t._showHoverImage(true);
t.setDisplayState(DwtControl.HOVER);
var o=t._dropDownEl;
if(t._menu&&o&&t._dropDownHovImg&&!t.noMenuBar&&t.isListenerRegistered(DwtEvent.SELECTION)){
if(t._dropDownHovImg){
AjxImg.setImage(o,t._dropDownHovImg)
}}
if(AjxEnv.isIE){
if(i&&i.target&&i.target.firstChild){
var a=i.target.firstChild;
var e=a.className;
a.className="";
a.className=e
}}
i._stopPropagation=true
};
DwtButton._mouseOutListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
e._showHoverImage(false);
e._setMouseOutClassName();
e.isActive=false;
var a=e._dropDownEl;
if(e._menu&&a&&e._dropDownImg){
AjxImg.setImage(a,e._dropDownImg)
}};
DwtButton._mouseDownListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
if(e._isDropDownEvent(t)){
return DwtButton._dropDownCellMouseDownHdlr(t)
}
if(t.button!=DwtMouseEvent.LEFT){
return
}
var a=e._dropDownEl;
if(e._menu&&a&&e._dropDownDepImg){
AjxImg.setImage(a,e._dropDownDepImg)
}
switch(e._actionTiming){
case DwtButton.ACTION_MOUSEDOWN:e.trigger();
e._handleClick(t);
break;
case DwtButton.ACTION_MOUSEUP:e.trigger();
break
}};
DwtButton._mouseUpListener=function(a){
var e=a.dwtObj;
if(!e){
return false
}
if(e._isDropDownEvent(a)){
return DwtButton._dropDownCellMouseUpHdlr(a)
}
if(a.button!=DwtMouseEvent.LEFT){
return
}
var i=e._dropDownEl;
if(e._menu&&i&&e._dropDownHovImg&&!e.noMenuBar){
AjxImg.setImage(i,e._dropDownHovImg)
}
switch(e._actionTiming){
case DwtButton.ACTION_MOUSEDOWN:e.deactivate();
break;
case DwtButton.ACTION_MOUSEUP:var t=e.getHtmlElement();
if(e.isActive){
e.deactivate();
e._handleClick(a)
}
break
}};
DwtButton._listeners={};
DwtButton._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtButton._mouseOutListener);
DwtButton._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtButton._mouseDownListener);
DwtButton._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtButton._mouseUpListener);
DwtButton._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtButton._mouseOutListener)
}
if(AjxPackage.define("ajax.dwt.widgets.DwtBorderlessButton")){
DwtBorderlessButton=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtBorderlessButton.PARAMS);
DwtButton.call(this,e)
};
DwtBorderlessButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index"];
DwtBorderlessButton.prototype=new DwtButton;
DwtBorderlessButton.prototype.constructor=DwtBorderlessButton;
DwtBorderlessButton.prototype.toString=function(){
return"DwtBorderlessButton"
};
DwtBorderlessButton.prototype.TEMPLATE="dwt.Widgets#ZBorderlessButton"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMenuItem")){
DwtMenuItem=function(i){
if(arguments.length==0){
return
}
i=Dwt.getParams(arguments,DwtMenuItem.PARAMS);
var a=i.parent;
if(!(a&&a.isDwtMenu)){
throw new DwtException("Parent must be a DwtMenu object",DwtException.INVALIDPARENT,"DwtMenuItem")
}
var t=i.style=i.style||DwtMenuItem.NO_STYLE;
if(a._style==DwtMenu.BAR_STYLE&&t!=DwtMenuItem.PUSH_STYLE){
throw new DwtException("DwtMenuItemInit: invalid style",DwtException.INVALID_PARAM,"DwtMenuItem")
}
i.className=i.className||"ZMenuItem";
t&=~DwtLabel.IMAGE_RIGHT;
t|=DwtButton.ALWAYS_FLAT|DwtLabel.IMAGE_LEFT;
var e=(t&DwtMenuItem.SEPARATOR_STYLE);
if(e){
i.className="ZMenuItemSeparator";
this.isFocusable=false;
this.noTab=true;
this.role=null
}
i.listeners=DwtMenuItem._listeners;
DwtButton.call(this,i);
this.setDropDownImages("Cascade","Cascade","Cascade","Cascade");
this._radioGroupId=i.radioGroupId;
if(a._addItem){
a._addItem(this,i.index)
}
if(!e){
this.addSelectionListener(this.__handleItemSelect.bind(this))
}};
DwtMenuItem.PARAMS=["parent","style","radioGroupId","index","className","posStyle","id"];
DwtMenuItem.prototype=new DwtButton;
DwtMenuItem.prototype.constructor=DwtMenuItem;
DwtMenuItem.prototype.isDwtMenuItem=true;
DwtMenuItem.prototype.toString=function(){
return"DwtMenuItem"
};
DwtMenuItem.prototype.role="menuitem";
DwtMenuItem.CHECKED=1;
DwtMenuItem.UNCHECKED=2;
DwtMenuItem.NO_STYLE=0;
DwtMenuItem.CHECK_STYLE=DwtButton._LAST_STYLE*2;
DwtMenuItem.RADIO_STYLE=DwtButton._LAST_STYLE*4;
DwtMenuItem.SEPARATOR_STYLE=DwtButton._LAST_STYLE*8;
DwtMenuItem.CASCADE_STYLE=DwtButton._LAST_STYLE*16;
DwtMenuItem.PUSH_STYLE=DwtButton._LAST_STYLE*32;
DwtMenuItem.SELECT_STYLE=DwtButton._LAST_STYLE*64;
DwtMenuItem._LAST_STYLE=DwtMenuItem.SELECT_STYLE;
DwtMenuItem._MENU_POPUP_DELAY=250;
DwtMenuItem._MENU_POPDOWN_DELAY=250;
DwtMenuItem.prototype.TEMPLATE="dwt.Widgets#ZMenuItem";
DwtMenuItem.prototype.SEPARATOR_TEMPLATE="dwt.Widgets#ZMenuItemSeparator";
DwtMenuItem.prototype.BLANK_CHECK_TEMPLATE="dwt.Widgets#ZMenuItemBlankCheck";
DwtMenuItem.prototype.BLANK_ICON_TEMPLATE="dwt.Widgets#ZMenuItemBlankIcon";
DwtMenuItem.prototype.BLANK_CASCADE_TEMPLATE="dwt.Widgets#ZMenuItemBlankCascade";
DwtMenuItem.prototype.dispose=function(){
delete this._checkEl;
DwtButton.prototype.dispose.call(this)
};
DwtMenuItem.create=function(t){
var e=new DwtMenuItem(t);
if(t.imageInfo){
e.setImage(t.imageInfo)
}
if(t.text){
e.setText(t.text)
}
e.setEnabled(t.enabled!==false);
return e
};
DwtMenuItem.prototype.getChecked=function(){
return this._itemChecked
};
DwtMenuItem.prototype.setChecked=function(t,e){
this._setChecked(t,null,e);
this.parent._checkItemAdded(this)
};
DwtMenuItem.prototype.setImage=function(e){
DwtButton.prototype.setImage.call(this,e);
this.parent._iconItemAdded(this)
};
DwtMenuItem.prototype.setText=function(e){
DwtButton.prototype.setText.call(this,e);
if(this.parent.isPoppedUp()){
this.parent.render()
}};
DwtMenuItem.prototype.setMenu=function(e){
var e=Dwt.getParams(arguments,DwtButton.setMenuParams);
DwtButton.prototype.setMenu.call(this,e);
this.parent._submenuItemAdded(this)
};
DwtMenuItem.prototype.setHoverDelay=function(e){
this._hoverDelay=e
};
DwtMenuItem.prototype.setShortcut=function(e){
if(e&&this._dropDownEl){
this._dropDownEl.innerHTML=e
}};
DwtMenuItem.prototype.setSelectableWithSubmenu=function(e){
this._selectableWithSubmenu=e
};
DwtMenuItem.prototype.isSeparator=function(){
return Boolean(this._style&DwtMenuItem.SEPARATOR_STYLE)
};
DwtMenuItem.prototype.handleKeyAction=function(e,t){
if(this.parent){
return this.parent.handleKeyAction(e,t)
}else{
return DwtButton.prototype.handleKeyAction.call(this,e,t)
}};
DwtMenuItem.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_MENU
};
DwtMenuItem.prototype._createHtml=function(e){
var t=this.isSeparator()?this.SEPARATOR_TEMPLATE:this.TEMPLATE;
DwtButton.prototype._createHtml.call(this,e||t)
};
DwtMenuItem.prototype._createHtmlFromTemplate=function(e,t){
DwtButton.prototype._createHtmlFromTemplate.call(this,e,t);
this._checkEl=document.getElementById(t.id+"_check")
};
DwtMenuItem.prototype._setChecked=function(n,o,t){
var e=this._style&DwtMenuItem.CHECK_STYLE;
var i=this._style&DwtMenuItem.RADIO_STYLE;
if((e||i)&&this._itemChecked!=n){
this._itemChecked=n;
if(this._checkEl){
this._checkEl.innerHTML="";
var a=n?(e?"MenuCheck":"MenuRadio"):"Blank_9";
AjxImg.setImage(this._checkEl,a);
if(n){
if(i){
this.parent._radioItemSelected(this,t)
}}}}};
DwtMenuItem.prototype._checkItemAdded=function(e){};
DwtMenuItem.prototype._checkedItemsRemoved=function(){};
DwtMenuItem.prototype._submenuItemAdded=function(){
if(this.isSeparator()){
return
}
if(this._cascCell==null){
this._cascCell=this._row.insertCell(-1);
this._cascCell.noWrap=true
}};
DwtMenuItem.prototype._submenuItemRemoved=function(){
if(this._dropDownEl){
this._dropDownEl.innerHTML=""
}};
DwtMenuItem.prototype._popupMenu=function(o,d){
var e=this.getMenu();
var t=this.parent.parent;
var l=this.getBounds();
var n=e.shell.getSize();
var u=e.getSize();
var c;
var r;
var i;
var h;
var a=t.getHtmlElement();
if(t._style==DwtMenu.BAR_STYLE){
i=(a.style.borderLeftWidth=="")?0:parseInt(a.style.borderLeftWidth);
c=l.x+i;
h=(a.style.borderTopWidth=="")?0:parseInt(a.style.borderTopWidth);
h+=(a.style.borderBottomWidth=="")?0:parseInt(a.style.borderBottonWidth);
r=l.y+l.height+h;
c=((c+u.x)>=n.x)?c-(c+u.x-n.x):c
}else{
i=(a.style.borderLeftWidth=="")?0:parseInt(a.style.borderLeftWidth);
i+=(a.style.borderRightWidth=="")?0:parseInt(a.style.borderRightWidth);
c=l.x+l.width+i;
h=(a.style.borderTopWidth=="")?0:parseInt(a.style.borderTopWidth);
r=l.y+h;
if(e.centerOnParentVertically()){
r+=l.height/2
}}
e.popup(o,c,r,d)
};
DwtMenuItem.prototype._popdownMenu=function(){
var e=this.getMenu();
if(e){
e.popdown()
}};
DwtMenuItem.prototype._isMenuPoppedUp=function(){
var e=this.getMenu();
return(e&&e.isPoppedUp())
};
DwtMenuItem.prototype._blur=function(){
var e=this.parent;
var t=new DwtMouseEvent();
this._setMouseEvent(t,{
dwtObj:this,ersatz:true,type:DwtEvent.ONMOUSEOUT}
);
this.notifyListeners(DwtEvent.ONMOUSEOUT,t);
e.__currentItem=null;
DwtButton.prototype._blur.call(this)
};
DwtMenuItem.prototype._focus=function(){
var t=this.parent;
var e=t.__currentItem;
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
dwtObj:this,ersatz:true}
);
this.notifyListeners(AjxEnv.isIE?DwtEvent.ONMOUSEENTER:DwtEvent.ONMOUSEOVER,a);
t.__currentItem=this;
DwtButton.prototype._focus.call(this)
};
DwtMenuItem.prototype.__handleItemSelect=function(e){
this.setDisplayState(DwtControl.NORMAL);
if(this.isStyle(DwtMenuItem.CHECK_STYLE)){
this._setChecked(!this._itemChecked,null,true);
e.detail=this.getChecked()?DwtMenuItem.CHECKED:DwtMenuItem.UNCHECKED
}else{
if(this.isStyle(DwtMenuItem.RADIO_STYLE)){
this._setChecked(true,true);
this.parent._radioItemSelected(this,true);
e.detail=this.getChecked()?DwtMenuItem.CHECKED:DwtMenuItem.UNCHECKED
}else{
if(this.isStyle(DwtMenuItem.PUSH_STYLE)){
if(this._menu){
if(this._isMenuPoppedUp()){
DwtMenu.closeActiveMenu(e)
}else{
this._popupMenu(DwtKeyEvent.isKeyEvent(ev))
}}
return
}}}
if(!this.isStyle(DwtMenuItem.CASCADE_STYLE)){
if(this._selectableWithSubmenu||!this._menu||!this._menu.isPoppedUp||!this._menu.isPoppedUp()){
DwtMenu.closeActiveMenu(e)
}}};
DwtMenuItem._mouseOverListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
var a=e.parent;
if(e.isSeparator()){
return false
}
DwtButton._mouseOverListener(t,e);
if(!t.ersatz){
a._popdownSubmenus()
}
if(!e.hasFocus()&&e.getEnabled()){
e.focus()
}
if(e._menu&&!t.ersatz){
e._popupMenu(e._hoverDelay)
}};
DwtMenuItem._mouseOutListener=function(a){
var t=a.dwtObj;
var e=t&&t.getMenu();
if(e&&e.isPoppedUp()){
return
}
DwtButton._mouseOutListener(a)
};
DwtMenuItem.prototype.getRowElement=function(){
var e=this._textEl||this._dropDownEl||(this._iconEl&&this._iconEl.left)||(this._iconEl&&this._iconEl.right);
if(e){
return e.parentNode
}};
DwtMenuItem._listeners={};
DwtMenuItem._listeners[DwtEvent.ONMOUSEOVER]=DwtMenuItem._mouseOverListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEOUT]=DwtMenuItem._mouseOutListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEDOWN]=DwtButton._mouseDownListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEUP]=DwtButton._mouseUpListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSEENTER]=DwtMenuItem._mouseOverListener.bind();
DwtMenuItem._listeners[DwtEvent.ONMOUSELEAVE]=DwtButton._mouseOutListener.bind()
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMenu")){
DwtMenu=function(i){
this._created=false;
if(arguments.length==0){
return
}
i=Dwt.getParams(arguments,DwtMenu.PARAMS);
this._origStyle=i.style;
var t=i.parent;
if(t){
if(t instanceof DwtMenuItem||t instanceof DwtButton){
if((i.style==DwtMenu.GENERIC_WIDGET_STYLE)||(i.style==DwtMenu.DROPDOWN_CENTERV_STYLE)){
this._style=i.style
}else{
this._style=DwtMenu.DROPDOWN_STYLE
}}else{
this._style=i.style||DwtMenu.POPUP_STYLE
}
if(!i.posStyle){
i.posStyle=(this._style==DwtMenu.BAR_STYLE)?DwtControl.STATIC_STYLE:DwtControl.ABSOLUTE_STYLE
}}
i.className=i.className||"DwtMenu";
this._layoutStyle=i.layout==null||i.layout;
if(this._layoutStyle===true){
this._layoutStyle=DwtMenu.LAYOUT_CASCADE
}else{
if(this._layoutStyle===false){
this._layoutStyle=DwtMenu.LAYOUT_STACK
}}
this._maxRows=this._layoutStyle&&i.maxRows||0;
this._congruent=i.congruent;
i.parent=(t instanceof DwtShell)?t:t.shell;
DwtComposite.call(this,i);
this.parent=t;
if(this._isPopupStyle()&&(this._layoutStyle==DwtMenu.LAYOUT_STACK)){
this.setScrollStyle(DwtControl.SCROLL)
}
if(!t){
return
}
var e=AjxEnv.isIE?[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP]:[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
this._setEventHdlrs(e);
this._hasSetMouseEvents=true;
var a=this.getHtmlElement();
if(i.posStyle!=DwtControl.STATIC_STYLE){
Dwt.setLocation(a,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}
if(this._style!=DwtMenu.COLOR_PICKER_STYLE&&this._style!=DwtMenu.CALENDAR_PICKER_STYLE&&this._style!=DwtMenu.GENERIC_WIDGET_STYLE){
this._table=document.createElement("table");
this._table.border=this._table.cellPadding=this._table.cellSpacing=0;
this._table.className="DwtMenuTable";
this._table.id=Dwt.getNextId();
if(this._layoutStyle==DwtMenu.LAYOUT_SCROLL){
this._setupScroll()
}else{
a.appendChild(this._table)
}
this._table.backgroundColor=DwtCssStyle.getProperty(a,"background-color")
}
if(i.style!=DwtMenu.BAR_STYLE){
this.setVisible(false);
this._isPoppedUp=false
}else{
DwtMenu._activeMenuIds.add(a.id,null,true);
this._isPoppedUp=true
}
this._popdownAction=new AjxTimedAction(this,this._doPopdown);
this._popdownActionId=-1;
this._popupAction=new AjxTimedAction(this,this._doPopup);
this._popupActionId=-1;
this._outsideListener=new AjxListener(null,DwtMenu._outsideMouseDownListener);
this._menuItemsHaveChecks=false;
this._menuItemsHaveIcons=false;
this._menuItemsWithSubmenus=0;
this.__currentItem=null;
this.__preventMenuFocus=false;
this._created=true;
this._itemSelectionListener=new AjxListener(this,this._propagateItemSelection);
if(t._menuAdded){
t._menuAdded(this)
}};
DwtMenu.PARAMS=["parent","style","className","posStyle","cascade","id"];
DwtMenu.prototype=new DwtComposite;
DwtMenu.prototype.constructor=DwtMenu;
DwtMenu.prototype.isDwtMenu=true;
DwtMenu.prototype.toString=function(){
return"DwtMenu"
};
DwtMenu.prototype.role="menu";
DwtMenu.BAR_STYLE="BAR";
DwtMenu.POPUP_STYLE="POPUP";
DwtMenu.DROPDOWN_STYLE="DROPDOWN";
DwtMenu.DROPDOWN_CENTERV_STYLE="DROPDOWN_CENTERV";
DwtMenu.COLOR_PICKER_STYLE="COLOR";
DwtMenu.CALENDAR_PICKER_STYLE="CALENDAR";
DwtMenu.GENERIC_WIDGET_STYLE="GENERIC";
DwtMenu.HAS_ICON="ZHasIcon";
DwtMenu.HAS_CHECK="ZHasCheck";
DwtMenu.HAS_SUBMENU="ZHasSubMenu";
DwtMenu.LAYOUT_STACK=0;
DwtMenu.LAYOUT_CASCADE=1;
DwtMenu.LAYOUT_SCROLL=2;
DwtMenu._activeMenuUp=false;
DwtMenu._activeMenuIds=new AjxVector();
DwtMenu._activeMenus=new AjxVector();
DwtMenu.prototype.dispose=function(){
this._table=null;
DwtComposite.prototype.dispose.call(this);
if(!(this.parent instanceof DwtShell)){
this.shell.removeChild(this)
}};
DwtMenu.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
DwtMenu.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtMenu.prototype.addPopupListener=function(e){
this.addListener(DwtEvent.POPUP,e)
};
DwtMenu.prototype.removePopupListener=function(e){
this.removeListener(DwtEvent.POPUP,e)
};
DwtMenu.prototype.addPopdownListener=function(e){
this.addListener(DwtEvent.POPDOWN,e)
};
DwtMenu.prototype.removePopdownListener=function(e){
this.removeListener(DwtEvent.POPDOWN,e)
};
DwtMenu.prototype.setWidth=function(e){
this._width=e;
if(this._table){
Dwt.setSize(this._table,e,Dwt.CLEAR)
}};
DwtMenu.prototype.centerOnParentVertically=function(){
return(this._style===DwtMenu.DROPDOWN_CENTERV_STYLE)
};
DwtMenu.prototype._isPopupStyle=function(){
return(this._style===DwtMenu.POPUP_STYLE||this._style===DwtMenu.DROPDOWN_STYLE||this._style===DwtMenu.DROPDOWN_CENTERV_STYLE)
};
DwtMenu.prototype.getItem=function(e){
return this._children.get(e)
};
DwtMenu.prototype.getItemIndex=function(e){
return this._children.indexOf(e)
};
DwtMenu.prototype.getItemById=function(a,n){
var e=this.getItems();
for(var t=0;
t<e.length;
t++){
var o=e[t].getData(a);
if(o==n){
e[t].index=t;
return e[t]
}}
return null
};
DwtMenu.prototype.getItemCount=function(){
return this._children.size()
};
DwtMenu.prototype.getItems=function(){
return this._children.getArray()
};
DwtMenu.prototype.getSelectedItem=function(n){
var e=this._children.getArray();
for(var o=0;
o<e.length;
o++){
var t=e[o];
if((n==null||(t._style&&n!=0))&&t.getChecked()){
return t
}}
return null
};
DwtMenu.prototype.isPoppedUp=function(){
return this._isPoppedUp
};
DwtMenu.prototype.popup=function(a,e,i,t){
if(this._style==DwtMenu.BAR_STYLE){
return
}
if(this._popdownActionId!=-1){
AjxTimedAction.cancelAction(this._popdownActionId);
this._popdownActionId=-1
}else{
if(this._isPoppedUp||(this._popupActionId!=-1&&a&&a>0)){
return
}else{
if(this._popupActionId!=-1){
AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}}
if(!a){
this._doPopup(e,i,t)
}else{
this._popupAction.args=[e,i,t];
this._popupActionId=AjxTimedAction.scheduleAction(this._popupAction,a)
}}};
DwtMenu.prototype.popdown=function(t,e){
if(this._style==DwtMenu.BAR_STYLE){
return
}
if(this._popupActionId!=-1){
AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}else{
if(!this._isPoppedUp||this._popdownActionId!=-1){
return
}
if(t==null||t==0){
this._doPopdown(e)
}else{
this._popdownActionId=AjxTimedAction.scheduleAction(this._popdownAction,t)
}}};
DwtMenu.prototype._setupScroll=function(){
var r=this.getHtmlElement();
this._table.style.position="relative";
this._topScroller=document.createElement("div");
this._topScroller.className="DwtMenuScrollTop";
this._topScroller.id=Dwt.getNextId();
this._imgDivTop=document.createElement("div");
this._imgDivTop.className="ImgUpArrowSmall";
this._topScroller.appendChild(this._imgDivTop);
Dwt.setHandler(this._imgDivTop,DwtEvent.ONMOUSEOUT,DwtMenu._stopEvent);
Dwt.setHandler(this._imgDivTop,DwtEvent.ONMOUSEOVER,DwtMenu._stopEvent);
r.appendChild(this._topScroller);
this._tableContainer=document.createElement("div");
this._tableContainer.appendChild(this._table);
r.appendChild(this._tableContainer);
this._bottomScroller=document.createElement("div");
this._bottomScroller.className="DwtMenuScrollBottom";
this._bottomScroller.id=Dwt.getNextId();
this._imgDivBottom=document.createElement("div");
this._imgDivBottom.className="ImgDownArrowSmall";
Dwt.setHandler(this._imgDivBottom,DwtEvent.ONMOUSEOUT,DwtMenu._stopEvent);
Dwt.setHandler(this._imgDivBottom,DwtEvent.ONMOUSEOVER,DwtMenu._stopEvent);
this._bottomScroller.appendChild(this._imgDivBottom);
r.appendChild(this._bottomScroller);
var a=AjxCallback.simpleClosure(this._scroll,this,this._table.id,true,false);
var e=AjxCallback.simpleClosure(this._scroll,this,this._table.id,false,false);
var t=AjxCallback.simpleClosure(this._handleMouseOut,this,this._topScroller.id,this._table.id);
var n=AjxCallback.simpleClosure(this._handleMouseOut,this,this._bottomScroller.id,this._table.id);
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEDOWN,a);
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEUP,e);
if(!AjxEnv.isIE){
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEOUT,t)
}else{
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSELEAVE,e)
}
var o=AjxCallback.simpleClosure(this._scroll,this,this._table.id,true,true);
var i=AjxCallback.simpleClosure(this._scroll,this,this._table.id,false,true);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEDOWN,o);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEUP,i);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEUP,i);
if(!AjxEnv.isIE){
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEOUT,n)
}else{
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSELEAVE,i)
}
var s=AjxCallback.simpleClosure(this._handleScroll,this,this._table.id);
Dwt.setHandler(r,DwtEvent.ONMOUSEWHEEL,s)
};
DwtMenu.prototype.render=function(k,w){
var T=this.shell.getSize();
var S=this.getSize();
var q=this.getHtmlElement();
T.y-=10+(AjxEnv.isIE?20:0);
T.x-=28;
var z=this._layoutStyle==DwtMenu.LAYOUT_SCROLL;
var s=this._isPopupStyle();
var W=this._layoutStyle==DwtMenu.LAYOUT_CASCADE;
if(this._table){
if(s&&W){
var F=T.y;
var M=null;
var v=this._table.rows;
var r=v.length;
var t=this._maxRows;
var O=S.y;
var g=F-25;
for(var C=r-1;
C>=0;
C--){
O-=Dwt.getSize(v[C]).y;
if(O<g){
break
}}
var p=t?Math.min(C+1,t):(C+1);
for(var B=p;
B<r;
B++){
var f=v[(B-p)%p];
var o=f.insertCell(-1);
o.className="DwtMenuCascadeCell";
var m=v[B].cells[0].firstChild;
while(m!=null){
o.appendChild(m);
m=m.nextSibling
}}
for(B=v.length-1;
B>=p;
B--){
this._table.deleteRow(p)
}
var d=r%p;
if(d>0){
for(var B=d;
B<p;
B++){
var f=v[B];
var o=f.insertCell(-1);
o.className="DwtMenuCascadeCell";
o.empty=true;
o.innerHTML="&nbsp;"
}}
S=this.getSize();
if(M){
w=M-S.y
}}else{
if(s&&z){
var v=this._table.rows;
var r=v.length;
var t=this._maxRows;
var u=t?Math.min(t,r):r;
var c=T.y-25;
var O=20;
for(var C=0;
C<u;
C++){
var e=Dwt.getSize(v[C]).y;
if(O+e<=c){
O+=e
}else{
break
}}
S.y=O
}}}
var H="auto";
var l="auto";
if(s&&z){
l=S.y;
if(this._tableContainer){
this._tableContainer.style.height=(l-20)+"px"
}}else{
if((s&&W)||w+S.y<T.y-5){
l="auto"
}else{
l=T.y-w-5
}}
if(z){
if(this._table){
this._table.style.width=S.x
}
H=S.x
}
this.setSize(H,l);
if((AjxEnv.isGeckoBased||AjxEnv.isSafari||(this._origStyle==DwtMenu.CALENDAR_PICKER_STYLE))&&this._table&&!z){
q.style.width=(S.x+(s&&!W?10:0))+"px"
}
var R=k+S.x>=T.x?T.x-S.x:k;
if(this.parent instanceof DwtMenuItem){
Dwt.delClass(q,"DwtMenu-congruentLeft");
Dwt.delClass(q,"DwtMenu-congruentRight");
var D=this.parent.getBounds();
var I=DwtCssStyle.getComputedStyleObject(this.parent.parent.getHtmlElement());
var a=DwtCssStyle.getComputedStyleObject(q);
if(((R>D.x&&R<D.x+D.width)||(D.x>=R&&D.x<R+S.x))&&D.x>=S.x){
var n=parseInt(a.width);
if(!AjxEnv.isIE){
n+=parseInt(a.paddingLeft)+parseInt(a.paddingRight)+parseInt(a.borderLeftWidth)+parseInt(a.borderRightWidth)
}
R=(parseInt(I.left)||D.x)-(n||S.x);
if(this._congruent){
var d;
if(AjxEnv.isIE){
d=parseInt(a.borderLeftWidth)
}else{
d=parseInt(a.borderLeftWidth)+parseInt(a.borderRightWidth)
}
if(!isNaN(d)){
R+=d;
Dwt.addClass(q,"DwtMenu-congruentLeft")
}}}else{
var h=parseInt(I.left)||(D.x-(parseInt(I.paddingLeft)||0));
var A=parseInt(I.width)||D.width;
R=h+A;
if(this._congruent){
var d=parseInt(I.paddingRight)+parseInt(a.paddingLeft)+parseInt(a.borderLeftWidth);
if(!isNaN(d)){
R+=d;
Dwt.addClass(q,"DwtMenu-congruentRight")
}}}}
if(this._style===DwtMenu.DROPDOWN_CENTERV_STYLE){
w-=S.y/2;
if(w<0){
w=0
}}
var M=s&&w+S.y>=T.y?T.y-S.y:w;
if(this.parent instanceof DwtMenuItem&&this._congruent){
var d=(parseInt(a.paddingTop)||0)-(parseInt(a.borderTopWidth)||0);
if(d>0){
M-=d
}}
R=R<0&&R!==Dwt.DEFAULT?0:R;
M=M<0&&M!==Dwt.DEFAULT?0:M;
this.setLocation(R,M)
};
DwtMenu.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_MENU
};
DwtMenu.prototype._handleScroll=function(e,i){
if(!i){
i=window.event
}
var n=Dwt.byId(e);
if(n&&i){
i=i?i:window.event;
var t=i.detail?i.detail*-1:i.wheelDelta/40;
var o=n.rows;
var a=Dwt.getSize(o[0]).y||10;
this._popdownSubmenus();
if(t>0){
this._doScroll(n,+a)
}else{
if(t<0){
this._doScroll(n,-a)
}}}};
DwtMenu.prototype._handleMouseOut=function(e,t,a){
if(e&&a.type&&a.type=="mouseout"&&!AjxEnv.isIE){
var i=e?Dwt.byId(e):null;
fromEl=a.target;
if(fromEl!=i){
return
}
toEl=a.relatedTarget;
while(toEl){
toEl=toEl.parentNode;
if(toEl==i){
return
}}
this._scroll(t,false,false,null)
}};
DwtMenu.prototype._scroll=function(e,n,o,a){
var s=e?document.getElementById(e):null;
if(s&&n){
var i=s.rows;
var t=Dwt.getSize(i[0]).y||10;
if(this._direction!=o||!this._scrollTimer){
this._popdownSubmenus();
this._direction=o;
if(this._scrollTimer){
clearInterval(this._scrollTimer);
this._scrollTimer=null
}
if(o){
this._scrollTimer=setInterval(AjxCallback.simpleClosure(this._doScroll,this,s,-t),100);
this._doScroll(s,-t)
}else{
this._scrollTimer=setInterval(AjxCallback.simpleClosure(this._doScroll,this,s,t),100);
this._doScroll(s,t)
}}}else{
if(this._scrollTimer){
clearInterval(this._scrollTimer);
this._scrollTimer=null
}}};
DwtMenu.prototype._doScroll=function(s,i){
if(s&&i){
var a=parseInt(s.style.top)||0;
var n;
if(i<0){
var o=this._table.rows||null;
var t=o&&o.length&&Dwt.getSize(o[0]).y;
var e=s.scrollHeight-(parseInt(s.parentNode.style.height)||((this._maxRows||(o&&o.length))*t)||0);
if(Math.abs(a+i)<=e){
n=a+i
}else{
n=-e
}}else{
if((a+i)<0){
n=a+i
}else{
n=0
}}
Dwt.setLocation(s,Dwt.DEFAULT,n)
}};
DwtMenu.prototype.scrollToItem=function(a,e){
var t=this.getItemIndex(a);
if(t!=-1){
this.scrollToIndex(t,e)
}};
DwtMenu.prototype.scrollToIndex=function(r,o){
if(this._created&&this._layoutStyle==DwtMenu.LAYOUT_SCROLL&&r!==null&&r>=0&&this._table){
var f=this._table.rows;
if(f){
var u=this._maxRows;
var e=0;
var c=[];
for(var a=0,s=f.length;
a<s;
a++){
var n=Dwt.getSize(f[a]).y;
if(a<u){
e+=n
}
c.push(n)
}
var t=c[r];
var l=parseInt(this._table.style.top)||0;
if(r>=f.length){
r=f.length-1
}
var d=0;
for(var a=0;
a<r&&a<c.length;
a++){
d+=c[a]
}
var m=0;
if(o){
if(d<-l){
m=-(d+l)
}else{
if(d+t>e-l){
m=-(d+l-e+t)
}}}else{
m=-(d+l)
}
if(m){
this._popdownSubmenus();
this._doScroll(this._table,m)
}}}};
DwtMenu.prototype.handleKeyAction=function(t,i){
switch(this._style){
case DwtMenu.BAR_STYLE:case DwtMenu.POPUP_STYLE:case DwtMenu.DROPDOWN_STYLE:case DwtMenu.DROPDOWN_CENTERV_STYLE:break;
default:return false
}
switch(t){
case DwtKeyMap.PAGE_UP:case DwtKeyMap.PAGE_DOWN:var a=this.__currentItem||this._children.get(0);
var e=this.getItemIndex(a);
if(this._maxRows&&e!==-1){
this.setSelectedItem(e+((t===DwtKeyMap.PAGE_UP)?-this._maxRows:this._maxRows))
}else{
this.setSelectedItem(t===DwtKeyMap.PAGE_DOWN)
}
break;
case DwtKeyMap.SELECT_PREV:case DwtKeyMap.SELECT_NEXT:this.setSelectedItem(t===DwtKeyMap.SELECT_NEXT);
break;
case DwtKeyMap.SELECT:if(this.__currentItem){
this.__currentItem._emulateSingleClick()
}
break;
case DwtKeyMap.SUBMENU:if(this.__currentItem&&this.__currentItem._menu){
this.__currentItem._popupMenu(0,true)
}
break;
case DwtKeyMap.PARENTMENU:if(this.parent.isDwtMenuItem){
this.popdown();
this.parent.focus()
}
break;
case DwtKeyMap.CANCEL:this.popdown();
break;
default:return false
}
return true
};
DwtMenu.prototype.setAssociatedObj=function(e){
this._associatedObj=e
};
DwtMenu.prototype.setAssociatedElementId=function(e){
this._associatedElId=e
};
DwtMenu.prototype.checkItem=function(s,n,a){
var e=this._children.getArray();
for(var t=0;
t<e.length;
t++){
var o=e[t];
if(!(o.isStyle(DwtMenuItem.CHECK_STYLE)||o.isStyle(DwtMenuItem.RADIO_STYLE))){
continue
}
var r=o.getData(s);
if(r==n){
o.setChecked(true,a)
}}};
DwtMenu.prototype.setSelectedItem=function(a,t){
var e=this.__currentItem;
if(typeof(a)=="boolean"){
e=!e?this._children.get(0):a?this._children.getNext(e):this._children.getPrev(e)
}else{
if(a instanceof DwtMenuItem){
if(this._children.contains(a)){
e=a
}}else{
a=Math.max(0,Math.min(this._children.size()-1,a));
e=this._children.get(a)
}}
while(e){
if(!e.isStyle){
if(!t){
e.focus()
}
break
}else{
if(!e.isStyle(DwtMenuItem.SEPARATOR_STYLE)&&e.getEnabled()&&e.getVisible()){
break
}}
e=(a===false)?this._children.getPrev(e):this._children.getNext(e)
}
if(!e){
return
}
this.scrollToItem(e,true);
if(!t){
e.focus()
}
if(this.parent&&this.parent._menuItemSelected){
this.parent._menuItemSelected(e)
}};
DwtMenu.prototype.clearExternallySelectedItems=function(){
if(this._externallySelected!=null){
this._externallySelected._deselect();
this._externallySelected=null
}};
DwtMenu.prototype.removeChild=function(a){
if(this._table){
if(this._style==DwtMenu.BAR_STYLE){
var e=a.getHtmlElement().parentNode;
this._table.rows[0].deleteCell(Dwt.getCellIndex(e))
}else{
var t=a.getHtmlElement();
if(t&&t.parentNode&&t.parentNode.parentNode.rowIndex>-1){
this._table.deleteRow(t.parentNode.parentNode.rowIndex)
}}}
this._children.remove(a);
if(a.removeSelectionListener){
a.removeSelectionListener(this._itemSelectionListener)
}};
DwtMenu.prototype.addChild=function(e){
DwtComposite.prototype.addChild.apply(this,arguments);
if(Dwt.instanceOf(e,"DwtColorPicker")||Dwt.instanceOf(e,"DwtCalendar")||(this._style==DwtMenu.GENERIC_WIDGET_STYLE)){
this._addItem(e)
}
if(e.addSelectionListener){
e.addSelectionListener(this._itemSelectionListener)
}};
DwtMenu.prototype._addItem=function(i,t){
if(this._style==DwtMenu.COLOR_PICKER_STYLE||this._style==DwtMenu.CALENDAR_PICKER_STYLE||this._style==DwtMenu.GENERIC_WIDGET_STYLE){
return
}
var n;
var e;
if(this._style==DwtMenu.BAR_STYLE){
var o=this._table.rows;
n=(o.length!=0)?o[0]:this._table.insertRow(0);
if(t==null||t>n.cells.length){
t=o.cells.length
}
e=n.insertCell(t);
e.align="center";
e.vAlign="middle";
var a=n.insertCell(-1);
a.nowrap=true;
a.width="7px"
}else{
if(i.isStyle&&(i.isStyle(DwtMenuItem.CHECK_STYLE)||i.isStyle(DwtMenuItem.RADIO_STYLE))){
this._checkItemAdded()
}
if(t==null||t>this._table.rows.length){
t=-1
}
n=this._table.insertRow(t);
e=n.insertCell(0)
}
e.noWrap=true;
e.appendChild(i.getHtmlElement())
};
DwtMenu.prototype._radioItemSelected=function(r,n){
var t=r._radioGroupId;
var s=this._children.size();
var e=this._children.getArray();
for(var o=0;
o<s;
o++){
if(e[o]!=r&&e[o].isStyle(DwtMenuItem.RADIO_STYLE)&&e[o]._radioGroupId==t&&e[o]._itemChecked){
e[o].setChecked(false,n);
break
}}};
DwtMenu.prototype._propagateItemSelection=function(e){
if(this.isListenerRegistered(DwtEvent.SELECTION)){
this.notifyListeners(DwtEvent.SELECTION,e)
}};
DwtMenu.prototype._menuHasCheckedItems=function(){
return this._menuItemsHaveChecks
};
DwtMenu.prototype._menuHasItemsWithIcons=function(){
return this._menuItemsHaveIcons
};
DwtMenu.prototype._menuHasSubmenus=function(){
return(this._menuItemsWithSubmenus>0)
};
DwtMenu.prototype._iconItemAdded=function(e){
if(!this._menuItemsHaveIcons){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_ICON)
}
this._menuItemsHaveIcons=true
};
DwtMenu.prototype._checkItemAdded=function(e){
if(!this._menuItemsHaveChecks){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_CHECK)
}
this._menuItemsHaveChecks=true
};
DwtMenu.prototype._submenuItemAdded=function(){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU);
this._menuItemsWithSubmenus++
};
DwtMenu.prototype._submenuItemRemoved=function(){
if(this._menuItemsWithSubmenus==1){
var o=this._children.size();
var e=this._children.getArray();
for(var t=0;
t<o;
t++){
e[t]._submenuItemRemoved()
}}
this._menuItemsWithSubmenus--;
if(this._menuItemsWithSubmenus==0){
Dwt.delClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU)
}};
DwtMenu.prototype._popdownSubmenus=function(){
var o=this._children.size();
var e=this._children.getArray();
for(var t=0;
t<o;
t++){
if(e[t]._popdownMenu){
e[t]._popdownMenu()
}}};
DwtMenu.prototype.dontStealFocus=function(e){
if(e==null){
e=true
}
this.__preventMenuFocus=!!e
};
DwtMenu.prototype._doPopup=function(o,a,r){
var i=DwtBaseDialog.getActiveDialog()?Dwt.Z_DIALOG_MENU:Dwt.Z_MENU;
this.setZIndex(i);
this.setVisible(true);
this.render(o,a);
var t=this._layoutStyle==DwtMenu.LAYOUT_SCROLL;
var n=this._layoutStyle==DwtMenu.LAYOUT_CASCADE;
if(!t){
this.setScrollStyle(this._isPopupStyle()&&n?Dwt.CLIP:Dwt.SCROLL)
}else{
if(this._tableContainer){
Dwt.setScrollStyle(this._tableContainer,Dwt.CLIP)
}}
this.notifyListeners(DwtEvent.POPUP,this);
var h=this.shell.getToolTip();
if(h){
h.popdown()
}
this._popupActionId=-1;
this._isPoppedUp=true;
var s=DwtOutsideMouseEventMgr.INSTANCE;
var e={
id:"DwtMenu",obj:this,outsideListener:this._outsideListener};
s.startListening(e);
if(!DwtMenu._activeMenu){
DwtMenu._activeMenu=this;
DwtMenu._activeMenuUp=true
}
DwtMenu._activeMenuIds.add(this._htmlElId,null,true);
DwtMenu._activeMenuIds.sort();
DwtMenu._activeMenus.add(this,null,true);
DwtShell.getShell(window).getKeyboardMgr().pushTabGroup(this._compositeTabGroup,this.__preventMenuFocus);
if(r||!this.parent.isDwtMenu){
this.setSelectedItem(0,this.__preventMenuFocus)
}};
DwtMenu.prototype.getSize=function(t){
var e;
if(this._table){
e=Dwt.getSize(this._table,t)
}else{
e=DwtComposite.prototype.getSize.call(this,t)
}
if(this._width&&this._width>e.x){
e.x=this._width
}
return e
};
DwtMenu.prototype._doPopdown=function(h){
var l=this._children.getArray();
var m=this._children.size();
for(var n=0;
n<m;
n++){
if((l[n] instanceof DwtMenuItem)&&!(l[n].isStyle(DwtMenuItem.SEPARATOR_STYLE))){
l[n]._popdownMenu()
}}
this.setVisible(false);
this._ev=h;
this.notifyListeners(DwtEvent.POPDOWN,this);
var d=DwtOutsideMouseEventMgr.INSTANCE;
d.stopListening({
id:"DwtMenu",obj:this}
);
if(DwtMenu._activeMenu==this){
DwtMenu._activeMenu=null;
DwtMenu._activeMenuUp=false
}
DwtMenu._activeMenuIds.remove(this._htmlElId);
DwtMenu._activeMenus.remove(this);
this._popdownActionId=-1;
this._isPoppedUp=false;
if(this._isPopupStyle()&&this._table&&this._table.rows&&this._table.rows.length&&this._table.rows[0].cells.length){
var t=this._table.rows[0].cells.length;
var r=this._table.rows.length;
for(var n=1;
n<t;
n++){
for(var o=0;
o<r;
o++){
var c=this._table.rows[o].cells[n];
if(!c.empty){
var e=c.firstChild;
var u=this._table.insertRow(this._table.rows.length);
var c=u.insertCell(0);
while(e!=null){
c.appendChild(e);
e=e.nextSibling
}}}}
for(var o=0;
o<r;
o++){
var u=this._table.rows[o];
for(var n=u.cells.length-1;
n>0;
n--){
u.deleteCell(n)
}}}
if(this.__currentItem){
this.__currentItem.blur()
}
DwtShell.getShell(window).getKeyboardMgr().popTabGroup(this._compositeTabGroup)
};
DwtMenu.prototype._getActiveItem=function(){
var e=this._children.getArray();
var o=this._children.size();
for(var t=0;
t<o;
t++){
if(e[t]._isMenuPoppedUp()){
return e[t]
}}
return null
};
DwtMenu._outsideMouseDownListener=function(t){
if(DwtMenu._activeMenuUp){
var i=DwtMenu._activeMenu;
var o=i._htmlElId;
var a=DwtUiEvent.getTarget(t);
while(a!=null){
if(a.id&&a.id!=""&&(a.id==o||a.id==i._associatedElId||DwtMenu._activeMenuIds.binarySearch(a.id)!=-1)){
return false
}
a=a.parentNode
}
i.popdown(0,t);
var e=null;
do{
e=DwtMenu._activeMenus.getLast();
if(e!=null&&e instanceof DwtMenu){
e.popdown()
}}
while(e!=null)
}};
DwtMenu._stopEvent=function(t){
if(!t){
t=window.event
}
t.cancelBubble=true;
if(t.stopPropagation){
t.stopPropagation()
}};
DwtMenu.menuShowing=function(){
return DwtMenu._activeMenuUp
};
DwtMenu.closeActiveMenu=function(e){
if(DwtMenu._activeMenuUp){
DwtMenu._activeMenu.popdown(0,e)
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMessageDialog")){
DwtMessageDialog=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtMessageDialog.PARAMS);
this._msgCellId=Dwt.getNextId("MessageDialog_");
t.standardButtons=t.buttons||[DwtDialog.OK_BUTTON];
if(t.helpText){
var e=new DwtDialog_ButtonDescriptor(DwtMessageDialog.HELP_BUTTON,t.helpText,DwtDialog.ALIGN_LEFT);
t.extraButtons=t.extraButtons||[];
t.extraButtons.push(e);
DwtDialog.call(this,t);
this.registerCallback(DwtMessageDialog.HELP_BUTTON,function(){
ZmZimbraMail.helpLinkCallback(this._helpURL)
}
,this)
}else{
DwtDialog.call(this,t)
}
this.setContent(this._contentHtml());
this._msgCell=document.getElementById(this._msgCellId);
this.addEnterListener(new AjxListener(this,this._enterListener));
this._setAllowSelection();
if(AjxEnv.isSafari){
this.setAttribute("aria-labelledby",this._titleEl.id+" "+this._msgCellId)
}else{
this.setAttribute("aria-describedby",this._msgCellId)
}};
DwtMessageDialog.PARAMS=["parent","className","buttons","extraButtons","id"];
DwtMessageDialog.prototype=new DwtDialog;
DwtMessageDialog.prototype.constructor=DwtMessageDialog;
DwtMessageDialog.prototype.isDwtMessageDialog=true;
DwtMessageDialog.prototype.role="alertdialog";
DwtMessageDialog.prototype.toString=function(){
return"DwtMessageDialog"
};
DwtMessageDialog.CRITICAL_STYLE=1;
DwtMessageDialog.INFO_STYLE=2;
DwtMessageDialog.WARNING_STYLE=3;
DwtMessageDialog.PLAIN_STYLE=4;
DwtMessageDialog.TITLE={};
DwtMessageDialog.TITLE[DwtMessageDialog.CRITICAL_STYLE]=AjxMsg.criticalMsg;
DwtMessageDialog.TITLE[DwtMessageDialog.INFO_STYLE]=AjxMsg.infoMsg;
DwtMessageDialog.TITLE[DwtMessageDialog.WARNING_STYLE]=AjxMsg.warningMsg;
DwtMessageDialog.TITLE[DwtMessageDialog.PLAIN_STYLE]=AjxMsg.infoMsg;
DwtMessageDialog.ICON={};
DwtMessageDialog.ICON[DwtMessageDialog.CRITICAL_STYLE]="Critical_32";
DwtMessageDialog.ICON[DwtMessageDialog.INFO_STYLE]="Information_32";
DwtMessageDialog.ICON[DwtMessageDialog.WARNING_STYLE]="Warning_32";
DwtMessageDialog.HELP_BUTTON="Help";
DwtMessageDialog.prototype.toString=function(){
return"DwtMessageDialog"
};
DwtMessageDialog.prototype.setMessage=function(a,o,n){
this._message=a||"";
this._style=o||this._getDefaultStyle();
this.setTitle(n||DwtMessageDialog.TITLE[this._style]);
if(a){
var t=[];
var e=0;
t[e++]="<table role='presentation' cellspacing=0 cellpadding=0 border=0 width=100% height=100%><tr>";
if(DwtMessageDialog.ICON[this._style]){
t[e++]="<td valign='top'>";
t[e++]=AjxImg.getImageHtml({
imageName:DwtMessageDialog.ICON[this._style],attrStr:"id='"+this._msgCellId+"_Image''",altText:DwtMessageDialog.TITLE[this._style]}
);
t[e++]="</td>"
}
t[e++]="<td class='DwtMsgArea' id='"+this._msgCellId+"_Msg'>";
t[e++]=a;
t[e++]="</td></tr></table>";
this._msgCell.innerHTML=t.join("")
}else{
this._msgCell.innerHTML=""
}};
DwtMessageDialog.prototype.setHelpURL=function(e){
this._helpURL=e
};
DwtMessageDialog.prototype.setSize=function(t,e){
var a=document.getElementById(this._msgCellId);
if(a&&(t||e)){
Dwt.setSize(a,t,e)
}};
DwtMessageDialog.prototype._getDefaultStyle=function(){
return DwtMessageDialog.INFO_STYLE
};
DwtMessageDialog.prototype.reset=function(){
this._msgCell.innerHTML="";
this._helpURL="";
DwtDialog.prototype.reset.call(this)
};
DwtMessageDialog.prototype.handleKeyAction=function(e,t){
return DwtDialog.prototype.handleKeyAction.call(this,e,t)
};
DwtMessageDialog.prototype._contentHtml=function(){
return"<div id='"+this._msgCellId+"' class='DwtMsgDialog'></div>"
};
DwtMessageDialog.prototype._enterListener=function(e){
this._runEnterCallback()
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtOptionDialog")){
DwtOptionDialog=function(s){
if(arguments.length==0){
return
}
s.buttons=s.buttons||[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
DwtMessageDialog.call(this,s);
var e=s.options||[];
this._options=[];
this._selectedIdx=0;
this._buttonContainer=document.createElement("FIELDSET");
this._buttonContainer.setAttribute("role","radiogroup");
this._getContentDiv().appendChild(this._buttonContainer);
for(var a=0;
a<e.length;
a++){
var o=AjxUtil.hashCopy(e[a]);
o.index=a;
var n=(a===0);
var t=o.button=new DwtRadioButton({
parent:this,parentElement:this._buttonContainer,id:[this.getHTMLElId(),name,"button"].join("_"),name:o.name,value:o.value||o.name,checked:n}
);
if(o.text){
t.setText(o.text)
}
t.getInputElement().setAttribute("aria-setsize",e.length);
t.getInputElement().setAttribute("aria-posinset",a+1);
t.addSelectionListener(this._selectionListener.bind(this,a));
this._options.push(o)
}
if(s.message){
this.setMessage(s.message,null,s.title)
}else{
if(s.title){
this.setTitle(s.title)
}}};
DwtOptionDialog.prototype=new DwtMessageDialog;
DwtOptionDialog.prototype.constructor=DwtOptionDialog;
DwtOptionDialog.prototype.isDwtOptionDialog=true;
DwtOptionDialog.prototype.toString=function(){
return"DwtOptionDialog"
};
DwtOptionDialog.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_OPTION_DIALOG
};
DwtOptionDialog.prototype._getDefaultStyle=function(){
return DwtMessageDialog.PLAIN_STYLE
};
DwtOptionDialog.prototype._updateSelection=function(e,t){
if(!AjxUtil.isNumber(e)||e<0||e>=this._options.length){
return false
}
this._selectedIdx=e;
for(var a=0;
a<this._options.length;
a++){
this._options[a].button.setSelected(a===e)
}
if(t){
this._options[e].button.focus()
}
return true
};
DwtOptionDialog.prototype._getOptionByName=function(e){
for(var t=0;
t<this._options.length;
t++){
if(this._options[t].name===e){
return this._options[t]
}}
return null
};
DwtOptionDialog.prototype._selectionListener=function(e,t){
if(!t.detail){
return
}
this._updateSelection(e)
};
DwtOptionDialog.prototype.getSelection=function(){
var e=this._options[this._selectedIdx];
return e.button?e.button.getValue():null
};
DwtOptionDialog.prototype.setSelection=function(e){
var t=this._getOptionByName(e);
this._updateSelection(t&&t.index)
};
DwtOptionDialog.prototype.getButton=function(e){
var t=this._getOptionByName(e);
return t&&t.button
};
DwtOptionDialog.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.NEXT:return this._updateSelection(this._selectedIdx+1,true);
case DwtKeyMap.PREV:return this._updateSelection(this._selectedIdx-1,true);
default:return DwtMessageDialog.prototype.handleKeyAction.apply(this,arguments)
}};
DwtOptionDialog.prototype.popup=function(e){
DwtMessageDialog.prototype.popup.call(this,e);
this._updateSelection(0,true)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtInputField")){
DwtInputField=function(h){
if(arguments.length==0){
return
}
h.className=h.className||"DwtInputField";
this._origClassName=h.className;
this._errorClassName=this._origClassName+"-error";
this._hintClassName=this._origClassName+"-hint";
this._disabledClassName=this._origClassName+"-disabled";
this._focusedClassName=this._origClassName+"-focused";
this._errorHintClassName=this._origClassName+"-errorhint";
this._requiredClassName=this._origClassName+"-required";
DwtComposite.call(this,h);
this._inputEventHandlers={};
this._type=h.type?h.type:DwtInputField.STRING;
this._rows=h.rows?h.rows:1;
this._size=h.size;
this._errorIconStyle=h.errorIconStyle?h.errorIconStyle:h.validator?DwtInputField.ERROR_ICON_RIGHT:DwtInputField.ERROR_ICON_NONE;
this._validationStyle=h.validationStyle?h.validationStyle:DwtInputField.ONEXIT_VALIDATION;
this._hasError=false;
this._hintIsVisible=false;
this._hint=h.hint;
this._label=h.label;
this.addListener(DwtEvent.ONFOCUS,this._focusHdlr.bind(this));
this.addListener(DwtEvent.ONBLUR,this._blurHdlr.bind(this));
this.addListener(DwtEvent.STATE_CHANGE,this._stateChanged.bind(this));
var r=h.inputId||Dwt.getNextId();
var s=Dwt.getNextId();
var n=this.getHtmlElement();
if(this._errorIconStyle==DwtInputField.ERROR_ICON_NONE){
if(h.forceMultiRow||(h.rows&&h.rows>1)){
var e=["<textarea id='",r,"' rows=",h.rows];
var o=e.length;
if(h.forceMultiRow||h.size){
e[o++]=" cols=";
e[o++]=h.size||1
}
if(h.wrap){
e[o++]=" wrap=";
e[o++]=h.wrap
}
e[o++]="></textarea>";
n.innerHTML=e.join("")
}else{
n.innerHTML=["<input id='",r,"'>"].join("")
}}else{
var e=["<table cellspacing='0' cellpadding='0'><tr>"];
var o=1;
if(this._errorIconStyle==DwtInputField.ERROR_ICON_LEFT){
e[o++]=["<td style='padding-right:2px;'id='",s,"'></td>"].join("")
}
e[o++]=["<td>","<input id='",r,"'>","</td>"].join("");
if(this._errorIconStyle==DwtInputField.ERROR_ICON_RIGHT){
e[o++]=["<td style='padding-left:2px;' id='",s,"'></td>"].join("")
}
e[o++]="</tr></table>";
n.innerHTML=e.join("");
if(this._errorIconStyle!=DwtInputField.ERROR_ICON_NONE){
this._errorIconTd=document.getElementById(s);
this._errorIconTd.vAlign="middle";
this._errorIconTd.innerHTML=DwtInputField._NOERROR_ICON_HTML
}}
if(h.forceMultiRow||this._rows>1){
this._inputField=document.getElementById(r);
this._inputField.onkeyup=DwtInputField._keyUpHdlr;
this._inputField.onkeydown=DwtInputField._keyDownHdlr;
if(h.size){
this._inputField.size=h.size
}
if(h.maxLen){
this._inputField.maxLength=this._maxLen=h.maxLen
}
this._inputField.value=h.initialValue||""
}else{
var t=document.getElementById(r);
var a=this.__createInputEl(h);
if(AjxEnv.isCamino){
t.parentNode.style.overflow="hidden"
}
t.parentNode.replaceChild(a,t)
}
this.setFocusElement();
this.setValidatorFunction(h.validatorCtxtObj,h.validator);
this._setMouseEventHdlrs(false);
this._setKeyPressEventHdlr(false);
if(h.required!=null){
this.setRequired(h.required)
}
if(h.hint!=null){
this.setHint(h.hint)
}};
DwtInputField.prototype=new DwtComposite;
DwtInputField.prototype.constructor=DwtInputField;
DwtInputField.prototype.isDwtInputField=true;
DwtInputField.prototype.isInputControl=true;
DwtInputField.prototype.toString=function(){
return"DwtInputField"
};
DwtInputField.ERROR_ICON_LEFT=1;
DwtInputField.ERROR_ICON_RIGHT=2;
DwtInputField.ERROR_ICON_NONE=3;
DwtInputField.CONTINUAL_VALIDATION=1;
DwtInputField.ONEXIT_VALIDATION=2;
DwtInputField.MANUAL_VALIDATION=3;
DwtInputField.NUMBER=1;
DwtInputField.INTEGER=2;
DwtInputField.FLOAT=3;
DwtInputField.STRING=4;
DwtInputField.PASSWORD=5;
DwtInputField.DATE=6;
DwtInputField._ERROR_ICON_HTML=AjxImg.getImageHtml("Critical");
DwtInputField._NOERROR_ICON_HTML=AjxImg.getImageHtml("Blank_9");
DwtInputField.prototype.dispose=function(){
this._errorIconTd=null;
this._inputField=null;
DwtComposite.prototype.dispose.call(this)
};
DwtInputField.prototype.setHandler=function(t,e){
if(!this._checkState()){
return
}
this._inputEventHandlers[t]=e;
Dwt.setHandler(this.getInputElement(),t,e)
};
DwtInputField.prototype.setInputType=function(a){
if(a!=this._type&&this._rows==1){
this._type=a;
if(AjxEnv.isIE){
var e=this._inputField;
var t=this.__createInputEl();
e.parentNode.replaceChild(t,e)
}else{
this._inputField.type=this._type!=DwtInputField.PASSWORD?"text":"password"
}}};
DwtInputField.prototype.applySubstitution=function(a,t){
if(!this._inputField.setRangeText){
this.setValue(this.getValue().replace(a,t))
}else{
var e;
while((e=a.exec(this.getValue()))){
this._inputField.setRangeText(t,e.index,e.index+e[0].length);
if(!a.global){
return
}}}};
DwtInputField.prototype.setValidatorFunction=function(t,e){
if(e){
this._validator=e;
this._validatorObj=t
}else{
switch(this._type){
case DwtInputField.NUMBER:this._validator=DwtInputField.validateNumber;
break;
case DwtInputField.INTEGER:this._validator=DwtInputField.validateInteger;
break;
case DwtInputField.FLOAT:this._validator=DwtInputField.validateFloat;
break;
case DwtInputField.STRING:case DwtInputField.PASSWORD:this._validator=DwtInputField.validateString;
break;
case DwtInputField.DATE:this._validator=DwtInputField.validateDate;
break;
default:this._validator=DwtInputField.validateAny
}}};
DwtInputField.prototype.setValidatorRegExp=function(e,t){
this._validator=e;
this._validatorObj=null;
this._errorString=t||""
};
DwtInputField.prototype.setValidationCallback=function(e){
this._validationCallback=e
};
DwtInputField.prototype.getInputElement=function(){
return this._inputField
};
DwtInputField.prototype.getValue=function(){
return this._hintIsVisible?"":AjxStringUtil.trim(this._inputField.value)
};
DwtInputField.prototype.setValue=function(t,e){
t=t||"";
this._inputField.value=t;
if(!e){
t=this._validateInput(t);
if(t!=null){
this._inputField.value=t
}}
if(this._hintIsVisible&&t){
this._hideHint(t)
}else{
if(!t){
this._showHint()
}}};
DwtInputField.prototype.clear=function(){
this.setValue("")
};
DwtInputField.prototype.setHint=function(t){
this._hint=t;
var e=this.getInputElement();
if(AjxEnv.supportsPlaceholder){
e.placeholder=t||"";
return
}
if(this._hintIsVisible){
e.value=t;
if(!t){
this._hintIsVisible=false;
this._updateClassName()
}}else{
if(e.value===""){
this._showHint()
}}};
DwtInputField.prototype.setLabel=function(e){
this._label=e;
var t=this.getInputElement();
if(e){
t.setAttribute("aria-label",e)
}else{
t.removeAttribute("aria-label",e)
}};
DwtInputField.prototype.setValidNumberRange=function(t,e){
this._minNumVal=t;
this._maxNumVal=e;
var a=this._validateInput(this.getValue());
if(a!=null){
this.setValue(a)
}};
DwtInputField.prototype.setValidStringLengths=function(t,e){
this._minLen=t||0;
if(e!=null){
this._inputField.maxLength=e;
this._maxLen=e
}};
DwtInputField.prototype.setNumberPrecision=function(e){
this._decimals=e
};
DwtInputField.prototype.setReadOnly=function(e){
this._inputField.setAttribute("readonly",(e==null?true:e))
};
DwtInputField.prototype.getRequired=function(){
var e=this.getInputElement().getAttribute("aria-required");
return e&&e.toLowerCase()==="true"
};
DwtInputField.prototype.setRequired=function(e){
this.getInputElement().setAttribute("aria-required",e?"true":"false")
};
DwtInputField.prototype.setVisible=function(e){
DwtComposite.prototype.setVisible.apply(this,arguments);
Dwt.setVisible(this.getInputElement(),e)
};
DwtInputField.prototype.isValid=function(){
if(!this.getEnabled()){
return this.getValue()
}
try{
if(typeof this._validator=="function"){
return this._validatorObj?this._validator.call(this._validatorObj,this.getValue(),this):this._validator(this.getValue())
}else{
return this._validator.test(this._inputField.value)
}}
catch(e){
if(typeof e=="string"){
return null
}else{
throw e
}}};
DwtInputField.prototype.getValidationError=function(){
this.validate();
return this._validationError
};
DwtInputField.prototype.validate=function(){
var e=this._validateInput(this.getValue());
if(e!=null){
this.setValue(e);
return true
}else{
return false
}};
DwtInputField.validateNumber=function(e){
var t=new Number(e);
if(isNaN(t)||(Math.round(t)!=t)){
throw AjxMsg.notAnInteger
}
return DwtInputField.validateFloat.call(this,e)
};
DwtInputField.validateInteger=function(e){
var t=new Number(e);
if(isNaN(t)||(Math.round(t)!=t)||(t.toString()!=e)){
throw AjxMsg.notAnInteger
}
if(this._minNumVal&&e<this._minNumVal){
throw AjxMessageFormat.format(AjxMsg.numberLessThanMin,this._minNumVal)
}
if(this._maxNumVal&&e>this._maxNumVal){
throw AjxMessageFormat.format(AjxMsg.numberMoreThanMax,this._maxNumVal)
}
return e
};
DwtInputField.validateFloat=function(e){
var i=new Number(e);
if(isNaN(i)){
throw AjxMsg.notANumber
}
if(this._minNumVal&&e<this._minNumVal){
throw AjxMessageFormat.format(AjxMsg.numberLessThanMin,this._minNumVal)
}
if(this._maxNumVal&&e>this._maxNumVal){
throw AjxMessageFormat.format(AjxMsg.numberMoreThanMax,this._maxNumVal)
}
if(this._decimals!=null){
var t=i.toString();
var a=t.indexOf(".");
if(a==-1){
a=t.length
}
e=i.toPrecision(a+this._decimals)
}else{
e=i.toString()
}
return e
};
DwtInputField.validateString=function(e){
if(this._minLen!=null&&e.length<this._minLen){
throw AjxMessageFormat.format(AjxMsg.stringTooShort,this._minLen)
}
if(this._maxLen!=null&&e.length>this._maxLen){
throw AjxMessageFormat.format(AjxMsg.stringTooLong,this._maxLen)
}
return e
};
DwtInputField.validateDate=function(e){
if(AjxDateUtil.simpleParseDateStr(e)==null){
throw AjxMsg.invalidDatetimeString
}
return e
};
DwtInputField.validateEmail=function(e){
if(!AjxEmailAddress.isValid(e)){
throw AjxMsg.invalidEmailAddr
}
return e
};
DwtInputField.validateAny=function(e){
return e
};
DwtInputField.prototype._validateRegExp=function(e){
if(this._regExp&&!this._regExp.test(e)){
throw this._errorString
}
return e
};
DwtInputField._keyUpHdlr=function(t){
var e=DwtShell.keyEvent;
e.setFromDhtmlEvent(t,true);
var i=e.dwtObj;
var a=e.keyCode;
if(i.notifyListeners(DwtEvent.ONKEYUP,e)){
return true
}
var o=null;
if((a==13||a==9)&&i._validationStyle==DwtInputField.ONEXIT_VALIDATION){
o=i._validateInput(i.getValue())
}else{
if(i._validationStyle==DwtInputField.CONTINUAL_VALIDATION){
o=i._validateInput(i.getValue())
}}
if(o!=null&&o!=i.getValue()){
i.setValue(o)
}
return true
};
DwtInputField.prototype._blurHdlr=function(e){
if(this.isDisposed()){
return
}
this._updateClassName();
if(this._validationStyle==DwtInputField.ONEXIT_VALIDATION){
var t=this._validateInput(this.getValue());
if(t!=null){
this.setValue(t)
}}
if(!this._hintIsVisible&&this._hint){
this._showHint()
}};
DwtInputField.prototype._focusHdlr=function(e){
appCtxt.getKeyboardMgr().updateFocus(this);
this._updateClassName();
if(this._hintIsVisible){
this._hideHint("")
}};
DwtInputField._keyDownHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t){
if(t._hintIsVisible){
t._hideHint("")
}}};
DwtInputField.prototype._hideHint=function(t){
if(!AjxEnv.supportsPlaceholder){
var e=this.getInputElement();
e.value=t;
e.title=this._hint||"";
this._hintIsVisible=false;
this._updateClassName()
}};
DwtInputField.prototype._showHint=function(){
if(!AjxEnv.supportsPlaceholder&&this._hint){
var e=this.getInputElement();
if(!e.value){
this._hintIsVisible=true;
this._updateClassName();
e.title="";
e.value=this._hint
}}};
DwtInputField.prototype._updateClassName=function(){
var e=[];
if(this._hasFocus){
e.push(this._focusedClassName)
}
if(!this.getEnabled()){
e.push(this._disabledClassName)
}else{
if(this._hasError){
if(this._validationError===AjxMsg.valueIsRequired){
e.push(this._requiredClassName)
}else{
if(this._hintIsVisible&&!this._hasFocus){
e.push(this._errorHintClassName)
}else{
e.push(this._errorClassName)
}}}else{
if(this._hintIsVisible&&!this._hasFocus){
e.push(this._hintClassName)
}}}
e.push(this._origClassName);
this.getHtmlElement().className=e.join(" ")
};
DwtInputField.prototype._validateInput=function(t){
var i=true;
var a;
this._validationError=null;
if(!this.getEnabled()){
a=this.getValue()
}else{
if(this.getRequired()&&t==""){
this._validationError=AjxMsg.valueIsRequired
}else{
try{
if(typeof this._validator=="function"){
a=t=this._validatorObj?this._validator.call(this._validatorObj,t,this):this._validator(t)
}else{
if(!this._validator.test(t)){
this._validationError=this._errorString
}}}
catch(e){
if(typeof e=="string"){
this._validationError=e
}else{
throw e
}}}}
if(this._validationError){
this._hasError=true;
if(this._errorIconTd){
this._errorIconTd.innerHTML=DwtInputField._ERROR_ICON_HTML
}
this.setToolTipContent(this._validationError);
i=false;
a=null
}else{
this._hasError=false;
if(this._errorIconTd){
this._errorIconTd.innerHTML=DwtInputField._NOERROR_ICON_HTML
}
this.setToolTipContent(null);
i=true
}
this._updateClassName();
if(this._validationCallback){
this._validationCallback.run(this,i,t)
}
return a
};
DwtInputField.prototype._focusByMouseUpEvent=function(){
if(this.getEnabled()){
this._hasFocus=true
}};
DwtInputField.prototype._replaceElementHook=function(t,a,e,i){
a=this.getInputElement();
DwtControl.prototype._replaceElementHook.call(this,t,a,e,i);
if(t.id){
a.id=t.id
}
if(t.size){
a.size=t.size
}
if(t.title){
this.setHint(t.title)
}};
DwtInputField.prototype.__createInputEl=function(s){
var t=this._inputField;
if(t){
for(var o in this._inputEventHandlers){
t.removeAttribute(o)
}}
var i;
var n=this._type!=DwtInputField.PASSWORD?"text":"password";
i=document.createElement("INPUT");
i.type=n;
this._inputField=i;
var a=s?s.size:t.size;
var e=s?s.maxLen:t.maxLength;
i.autocomplete="off";
if(a){
i.size=a
}
if(e){
i.maxLength=e
}
i.value=(s?s.initialValue:t.value)||"";
i.readonly=t?t.readonly:false;
if(s&&s.inputId){
i.id=s.inputId
}
if(AjxEnv.supportsPlaceholder&&this._hint){
i.placeholder=this._hint
}
if(this._label){
i.setAttribute("aria-label",this._label)
}
i.onkeyup=DwtInputField._keyUpHdlr;
i.onkeydown=DwtInputField._keyDownHdlr;
this._makeFocusable(i);
for(var o in this._inputEventHandlers){
i[o]=this._inputEventHandlers[o]
}
return i
};
DwtInputField.prototype._stateChanged=function(e){
this.getInputElement().disabled=!this.getEnabled();
this._validateInput(this.getValue())
};
DwtInputField.prototype.disableFocusHdlr=function(){
this._inputField.onfocus=null
};
DwtInputField.prototype.enableFocusHdlr=function(){
this._inputField.onfocus=DwtInputField._focusHdlr
};
DwtInputField.prototype.enableKeyDownHdlr=function(){
this._inputField.onkeydown=DwtInputField._keyDownHdlr
};
DwtInputField.prototype.moveCursorToEnd=function(){
Dwt.moveCursorToEnd(this._inputField)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtPasswordField")){
DwtPasswordField=function(e){
if(arguments.length==0){
return
}
e=e||{
parent:DwtShell.getShell(window)};
e.type=DwtInputField.PASSWORD;
DwtInputField.call(this,e);
this._tabGroup=new DwtTabGroup(this._htmlElId);
this._createHtml()
};
DwtPasswordField.prototype=new DwtInputField;
DwtPasswordField.prototype.constructor=DwtPasswordField;
DwtPasswordField.prototype.TEMPLATE="dwt.Widgets#DwtPasswordField";
DwtPasswordField.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtPasswordField.prototype.setShowPassword=function(e){
this._showCheckbox.setSelected(e);
this.setInputType(e?DwtInputField.STRING:DwtInputField.PASSWORD)
};
DwtPasswordField.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtPasswordField.prototype._createHtmlFromTemplate=function(a,o){
this._tabGroup.removeAllMembers();
var e=document.createDocumentFragment();
var s=this.getHtmlElement().firstChild;
while(s){
var i=s.nextSibling;
e.appendChild(s);
s=i
}
DwtInputField.prototype._createHtmlFromTemplate.apply(this,arguments);
var n=document.getElementById(o.id+"_input");
n.appendChild(e);
this._tabGroup.addMember(this.getInputElement());
var t=document.getElementById(o.id+"_show_password");
if(t){
this._showCheckbox=new DwtCheckbox({
parent:this}
);
this._showCheckbox.setText(AjxMsg.showPassword);
this._showCheckbox.addSelectionListener(new AjxListener(this,this._handleShowCheckbox));
this._showCheckbox.replaceElement(t);
this._tabGroup.addMember(this._showCheckbox)
}};
DwtPasswordField.prototype._handleShowCheckbox=function(e){
this.setShowPassword(e.detail)
};
DwtPasswordField.prototype.getValue=function(){
return this._inputField.value
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtSash")){
DwtSash=function(a){
a=Dwt.getParams(arguments,DwtSash.PARAMS);
a.className=a.className||"DwtSash";
a.posStyle=a.posStyle||DwtControl.ABSOLUTE_STYLE;
DwtControl.call(this,a);
var t=this.getHtmlElement();
var e="dwt.Widgets#";
if(!a.style||a.style!=DwtSash.HORIZONTAL_STYLE){
this._style=DwtSash.VERTICAL_STYLE;
t.style.cursor=AjxEnv.isIE?"row-resize":"s-resize";
t.innerHTML=AjxTemplate.expand(e+"DwtVerticalSash")
}else{
this._style=DwtSash.HORIZONTAL_STYLE;
t.style.cursor=AjxEnv.isIE?"col-resize":"w-resize";
t.innerHTML=AjxTemplate.expand(e+"DwtHorizontalSash")
}
this._threshold=(a.threshold>0)?a.threshold:1;
this._captureObj=new DwtMouseEventCapture({
targetObj:this,id:"DwtSash",mouseOverHdlr:DwtSash._mouseOverHdlr,mouseDownHdlr:DwtSash._mouseDownHdlr,mouseMoveHdlr:DwtSash._mouseMoveHdlr,mouseUpHdlr:DwtSash._mouseUpHdlr,mouseOutHdlr:DwtSash._mouseOutHdlr}
);
this.setHandler(DwtEvent.ONMOUSEDOWN,DwtSash._mouseDownHdlr);
this.setHandler(DwtEvent.ONMOUSEOVER,DwtSash._mouseOverHdlr);
this.setHandler(DwtEvent.ONMOUSEOUT,DwtSash._mouseOutHdlr);
this.setZIndex(Dwt.Z_VIEW)
};
DwtSash.PARAMS=["parent","style","className","threshold","posStyle"];
DwtSash.prototype=new DwtControl;
DwtSash.prototype.constructor=DwtSash;
DwtSash.prototype.toString=function(){
return"DwtSash"
};
DwtSash.HORIZONTAL_STYLE=1;
DwtSash.VERTICAL_STYLE=2;
DwtSash.prototype.registerCallback=function(e,t){
this._callbackFunc=e;
this._callbackObj=t
};
DwtSash._mouseOverHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseDownHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,true);
if(e.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(t,true,false);
return false
}
DwtEventManager.notifyListeners(DwtEvent.ONMOUSEDOWN,e);
var a=e.dwtObj;
if(a._callbackFunc!=null){
a._captureObj.capture();
a._startCoord=(a._style==DwtSash.HORIZONTAL_STYLE)?e.docX:e.docY
}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseMoveHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
var i=0;
var a=DwtMouseEventCapture.getTargetObj();
if(a._style==DwtSash.HORIZONTAL_STYLE){
if(e.docX>0&&e.docX!=a._startCoord){
i=e.docX-a._startCoord
}}else{
if(e.docY>0&&e.docY!=a._startCoord){
i=e.docY-a._startCoord
}}
if(Math.abs(i)>=a._threshold){
if(a._callbackObj!=null){
i=a._callbackFunc.call(a._callbackObj,i)
}else{
i=a._callbackFunc(i)
}
a._startCoord+=i;
if(i!=0&&a.getHtmlElement().style.position==Dwt.ABSOLUTE_STYLE){
if(a._style==DwtSash.HORIZONTAL_STYLE){
a.setLocation(a.getLocation().x+i,Dwt.DEFAULT)
}else{
a.setLocation(Dwt.DEFAULT,a.getLocation().y+i)
}}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseUpHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(e.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(t,true,false);
return false
}
var a=DwtMouseEventCapture.getTargetObj();
if(a._callbackFunc!=null){
DwtMouseEventCapture.getCaptureObj().release()
}
a.notifyListeners(DwtEvent.ONMOUSEUP,e);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseOutHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtToolBar")){
DwtToolBar=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtToolBar.PARAMS);
t.className=t.className||"ZToolbar";
DwtComposite.call(this,t);
if(t.parent instanceof DwtToolBar){
this._hasSetMouseEvents=t.parent._hasSetMouseEvents
}
if(t.handleMouse!==false&&!this._hasSetMouseEvents){
var e=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONCLICK];
if(!AjxEnv.isIE){
e.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
this._setEventHdlrs(e);
this._hasSetMouseEvents=true
}
this._style=t.style||DwtToolBar.HORIZ_STYLE;
this._createHtml();
this._numFillers=0;
this._curFocusIndex=0;
this.tabGroupMember=this;
this._keyMapName=(this._style==DwtToolBar.HORIZ_STYLE)?DwtKeyMap.MAP_TOOLBAR_HORIZ:DwtKeyMap.MAP_TOOLBAR_VERT
};
DwtToolBar.PARAMS=["parent","className","posStyle","style","index","id"];
DwtToolBar.prototype=new DwtComposite;
DwtToolBar.prototype.constructor=DwtToolBar;
DwtToolBar.prototype.role="toolbar";
DwtToolBar.prototype.isDwtToolBar=true;
DwtToolBar.prototype.toString=function(){
return"DwtToolBar"
};
DwtToolBar.HORIZ_STYLE=1;
DwtToolBar.VERT_STYLE=2;
DwtToolBar.FIRST_ITEM="ZFirstItem";
DwtToolBar.LAST_ITEM="ZLastItem";
DwtToolBar.SELECTED_NEXT=DwtControl.SELECTED+"Next";
DwtToolBar.SELECTED_PREV=DwtControl.SELECTED+"Prev";
DwtToolBar._NEXT_PREV_RE=new RegExp("\\b"+[DwtToolBar.SELECTED_NEXT,DwtToolBar.SELECTED_PREV].join("|")+"\\b","g");
DwtToolBar.prototype.TEMPLATE="dwt.Widgets#ZToolbar";
DwtToolBar.prototype.ITEM_TEMPLATE="dwt.Widgets#ZToolbarItem";
DwtToolBar.prototype.SEPARATOR_TEMPLATE="dwt.Widgets#ZToolbarSeparator";
DwtToolBar.prototype.SPACER_TEMPLATE="dwt.Widgets#ZToolbarSpacer";
DwtToolBar.prototype.FILLER_TEMPLATE="dwt.Widgets#ZToolbarFiller";
DwtToolBar.__itemCount=0;
DwtToolBar.prototype.dispose=function(){
DwtComposite.prototype.dispose.call(this);
this._itemsEl=null;
this._prefixEl=null;
this._suffixEl=null
};
DwtToolBar.prototype.getItem=function(e){
return this._children.get(e)
};
DwtToolBar.prototype.getItemCount=function(){
return this._children.size()
};
DwtToolBar.prototype.getItems=function(){
return this._children.getArray()
};
DwtToolBar.prototype.addSpacer=function(a,t){
var e=new DwtToolBarSpacer({
parent:this,index:t,className:a,toolbarItemTemplate:this.SPACER_TEMPLATE,id:this._htmlElId+"_spacer"+DwtToolBar.__itemCount}
);
return e
};
DwtToolBar.prototype.addSeparator=function(a,t){
var e=new DwtToolBarSpacer({
parent:this,index:t,className:a,toolbarItemTemplate:this.SEPARATOR_TEMPLATE,id:this._htmlElId+"_separator"+DwtToolBar.__itemCount}
);
return e
};
DwtToolBar.prototype.addFiller=function(a,e){
var t=new DwtToolBarSpacer({
parent:this,index:e,className:a,toolbarItemTemplate:this.FILLER_TEMPLATE,id:this._htmlElId+"_filler"+DwtToolBar.__itemCount}
);
return t
};
DwtToolBar.prototype.addChild=function(o,e){
var a=this.getChild(e);
var i=a?a.getHtmlElement().parentNode:this._suffixEl;
DwtComposite.prototype.addChild.apply(this,arguments);
if(this._itemsEl){
var t=this._createItemElement(o.toolbarItemTemplate);
this._itemsEl.insertBefore(t,i)
}
o.reparentHtmlElement(t)
};
DwtToolBar.prototype.removeChild=function(t){
var e=t.getHtmlElement().parentNode;
DwtComposite.prototype.removeChild.apply(this,arguments);
if(e&&e.parentNode){
e.parentNode.removeChild(e)
}};
DwtToolBar.prototype.getKeyMapName=function(){
return this._keyMapName
};
DwtToolBar.prototype.handleKeyAction=function(o,s){
var i=this._curFocusIndex,a=this.getItemCount(),t=s&&s.target&&s.target.nodeName.toLowerCase()==="input"?s.target:null,r=t&&t.selectionStart,e=t&&t.value&&t.value.length;
if(a<2){
return false
}
switch(o){
case DwtKeyMap.PREV:if(t&&r>0){
s.forcePropagate=true;
return false
}else{
if(i>0){
this._moveFocus(true,s);
return true
}}
break;
case DwtKeyMap.NEXT:if(t&&r<e){
s.forcePropagate=true;
return false
}else{
if(i<a-1){
this._moveFocus(false);
return true
}}
break;
default:var n=this._getCurrentFocusItem();
if(n){
return n.handleKeyAction(o,s)
}}
return true
};
DwtToolBar.prototype._createItemId=function(t){
t=t||this._htmlElId;
var e=[t,"item",++DwtToolBar.__itemCount].join("_");
return e
};
DwtToolBar.prototype._createHtml=function(){
var e={
id:this._htmlElId};
this._createHtmlFromTemplate(this.TEMPLATE,e);
this._itemsEl=document.getElementById(e.id+"_items");
this._prefixEl=document.getElementById(e.id+"_prefix");
this._suffixEl=document.getElementById(e.id+"_suffix")
};
DwtToolBar.prototype._createItemElement=function(a){
a=a||this.ITEM_TEMPLATE;
var i={
id:this._htmlElId,itemId:this._createItemId()};
var t=AjxTemplate.expand(a,i);
var e=AjxStringUtil.calcDIV();
e.innerHTML=t;
return e.firstChild.rows[0].cells[0]
};
DwtToolBar.prototype.focus=function(e){
this._setMenuKey();
e=e||this._getCurrentFocusItem();
if(e&&this._canFocusItem(e)){
this._curFocusIndex=this.__getButtonIndex(e);
return e.focus()
}else{
return this._moveFocus(false)
}};
DwtToolBar.prototype.blur=function(e){
e=e||this._getCurrentFocusItem();
if(e&&e.blur){
e.blur()
}};
DwtToolBar.prototype._canFocusItem=function(e){
if(!e){
return false
}
if(!e.focus){
return false
}
if(e.isDwtToolBarSpacer){
return false
}
if(e.getEnabled&&!e.getEnabled()){
return false
}
if(e.getVisible&&!e.getVisible()){
return false
}
if(e.isDwtText&&!e.getText()){
return false
}
return true
};
DwtToolBar.prototype._getCurrentFocusItem=function(){
return this.getItem(this._curFocusIndex)
};
DwtToolBar.prototype.getEnabled=function(){
return this._children.some(function(e){
return this._canFocusItem(e)
}
,this)
};
DwtToolBar.prototype._moveFocus=function(e){
var t=this._curFocusIndex,a=this.getItemCount()-1,i=null,o=false;
t=e?t-1:t+1;
while(!o&&t>=0&&t<=a){
i=this.getItem(t);
if(this._canFocusItem(i)){
o=true
}
t=e?t-1:t+1
}
if(i&&o){
this.blur();
this.focus(i)
}
return i
};
DwtToolBar.prototype._setMenuKey=function(){
if(!this._submenuKeySet){
var t=this.shell.getKeyboardMgr();
if(t.isEnabled()){
var e=t.__keyMapMgr;
if(e){
if(this._style==DwtToolBar.HORIZ_STYLE){
e.removeMapping(DwtKeyMap.MAP_BUTTON,"ArrowRight");
e.setMapping(DwtKeyMap.MAP_BUTTON,"ArrowDown",DwtKeyMap.SUBMENU)
}else{
e.removeMapping(DwtKeyMap.MAP_BUTTON,"ArrowDown");
e.setMapping(DwtKeyMap.MAP_BUTTON,"ArrowRight",DwtKeyMap.SUBMENU)
}
e.reloadMap(DwtKeyMap.MAP_BUTTON)
}}
this._submenuKeySet=true
}};
DwtToolBar.prototype._childFocusListener=function(e){
this._curFocusIndex=this.__getButtonIndex(e.dwtObj)
};
DwtToolBar.prototype.__markPrevNext=function(s,n){
var e=this.__getButtonIndex(s);
var i=this.getChild(e-1);
var t=this.getChild(e+1);
if(n){
if(i){
Dwt.delClass(i.getHtmlElement(),DwtToolBar._NEXT_PREV_RE,DwtToolBar.SELECTED_PREV)
}
if(t){
Dwt.delClass(t.getHtmlElement(),DwtToolBar._NEXT_PREV_RE,DwtToolBar.SELECTED_NEXT)
}}else{
if(i){
Dwt.delClass(i.getHtmlElement(),DwtToolBar._NEXT_PREV_RE)
}
if(t){
Dwt.delClass(t.getHtmlElement(),DwtToolBar._NEXT_PREV_RE)
}}
var o=this.getChild(0);
if(o){
Dwt.addClass(o.getHtmlElement(),DwtToolBar.FIRST_ITEM)
}
var a=this.getChild(this.getItemCount()-1);
if(a){
Dwt.addClass(a.getHtmlElement(),DwtToolBar.LAST_ITEM)
}};
DwtToolBar.prototype.__getButtonIndex=function(a){
var t=AjxUtil.isString(a)?DwtControl.fromElementId(a):a;
for(var e=0;
e<=this.getItemCount()-1;
e++){
if(t===this.getItem(e)){
return e
}}
return -1
};
DwtToolBarButton=function(e){
if(arguments.length==0){
return
}
var e=Dwt.getParams(arguments,DwtToolBarButton.PARAMS);
e.className=e.className||"ZToolbarButton";
DwtButton.call(this,e)
};
DwtToolBarButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index"];
DwtToolBarButton.prototype=new DwtButton;
DwtToolBarButton.prototype.constructor=DwtToolBarButton;
DwtToolBarButton.prototype.isDwtToolBarButton=true;
DwtToolBarButton.prototype.toString=function(){
return"DwtToolBarButton"
};
DwtToolBarButton.prototype.TEMPLATE="dwt.Widgets#ZToolbarButton";
DwtToolBarSpacer=function(e){
if(arguments.length==0){
return
}
this._noFocus=this.noTab=true;
this.toolbarItemTemplate=e.toolbarItemTemplate;
DwtControl.call(this,e)
};
DwtToolBarSpacer.prototype=new DwtControl;
DwtToolBarSpacer.prototype.constructor=DwtToolBarSpacer;
DwtToolBarSpacer.prototype.isDwtToolBarSpacer=true;
DwtToolBarSpacer.prototype.toString=function(){
return"DwtToolBarSpacer"
};
DwtToolBarSpacer.prototype.role="separator"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtToolTip")){
DwtToolTip=function(n,s,o){
if(arguments.length==0){
return
}
this.shell=n;
this._dialog=o;
this._poppedUp=false;
this._div=document.createElement("div");
this._div.className=s||"DwtToolTip";
this._div.style.position=DwtControl.ABSOLUTE_STYLE;
this.shell.getHtmlElement().appendChild(this._div);
Dwt.setZIndex(this._div,Dwt.Z_HIDDEN);
Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._eventMgr=new AjxEventMgr();
var a="dwt.Widgets#DwtToolTip";
this._div.innerHTML=AjxTemplate.expand(a);
var h=AjxTemplate.getParams(a);
this._offsetX=(h.width!=null)?Number(h.width):DwtToolTip.POPUP_OFFSET_X;
this._offsetY=(h.height!=null)?Number(h.height):DwtToolTip.POPUP_OFFSET_Y;
this._contentDiv=document.getElementById("tooltipContents");
Dwt.setHandler(this._div,DwtEvent.ONMOUSEOVER,AjxCallback.simpleClosure(this._mouseOverListener,this));
Dwt.setHandler(this._div,DwtEvent.ONMOUSEOUT,AjxCallback.simpleClosure(this._mouseOutListener,this));
var t=[DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEWHEEL,DwtEvent.ONSCROLL];
for(var e=0;
e<t.length;
e++){
var r=t[e];
Dwt.setHandler(this._div,r,AjxCallback.simpleClosure(this.notifyListeners,this,[r]))
}};
DwtToolTip.prototype.isDwtToolTip=true;
DwtToolTip.prototype.toString=function(){
return"DwtToolTip"
};
DwtToolTip.TOOLTIP_DELAY=750;
DwtToolTip.WINDOW_GUTTER=5;
DwtToolTip.POPUP_OFFSET_X=5;
DwtToolTip.POPUP_OFFSET_Y=5;
DwtToolTip.prototype.getContent=function(){
return this._div.innerHTML
};
DwtToolTip.prototype.setContent=function(t,e){
this._content=t;
if(e){
this._contentDiv.innerHTML=this._content
}};
DwtToolTip.prototype.popup=function(e,s,t,a,i,n,o){
this._hovered=false;
if(this._popupAction){
AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}
this._popdownOnMouseOver=a;
this._popdownListener=o;
if(this._content!=null){
if(!t){
this._contentDiv.innerHTML=this._content
}
this._popupAction=new AjxTimedAction(this,this._positionElement,[e,s,i,n]);
AjxTimedAction.scheduleAction(this._popupAction,5)
}};
DwtToolTip.prototype.setSticky=function(e){
this._poppedUp=!e
};
DwtToolTip.prototype.popdown=function(){
this._popdownOnMouseOver=false;
this._hovered=false;
if(this._popupAction){
AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}
if(this._content!=null&&this._poppedUp){
Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._poppedUp=false;
if(this._popdownListener instanceof AjxCallback){
this._popdownListener.run()
}
this._popdownListener=null
}};
DwtToolTip.prototype._positionElement=function(s,n,o,r){
this._popupAction=null;
var a=DwtShell.getShell(window).getSize();
var t=a.x,m=a.y;
var f,u,e;
var p=o&&o.getTooltipBase(r);
if(p){
e=Dwt.toWindow(p);
var i=Dwt.getSize(p);
f=e.x+this._offsetX;
u=e.y+i.y+this._offsetY
}else{
f=s+this._offsetX;
u=n+this._offsetY
}
var c=Dwt.getSize(this._div);
var d=c.x,h=c.y;
if(f+d>t-DwtToolTip.WINDOW_GUTTER){
f=t-DwtToolTip.WINDOW_GUTTER-d
}
if(u+h>m-DwtToolTip.WINDOW_GUTTER){
u=(e?e.y:u)-this._offsetY-h
}
Dwt.setLocation(this._div,f,u);
var l=this._dialog?this._dialog.getZIndex()+Dwt._Z_INC:Dwt.Z_TOOLTIP;
Dwt.setZIndex(this._div,l);
this._poppedUp=true
};
DwtToolTip.prototype._mouseOverListener=function(e){
this._hovered=true;
if(this._popdownOnMouseOver&&this._poppedUp){
var t=(this._popdownOnMouseOver.isAjxCallback||AjxUtil.isFunction(this._popdownOnMouseOver))?this._popdownOnMouseOver:null;
this.popdown();
if(t){
t.run()
}}
this.notifyListeners(DwtEvent.ONMOUSEOVER)
};
DwtToolTip.prototype._mouseOutListener=function(a){
a=DwtUiEvent.getEvent(a,this._div);
var e=Dwt.toWindow(this._div);
var t=Dwt.getSize(this._div);
if(a.clientX<=e.x||a.clientX>=(e.x+t.x)||a.clientY<=e.y||a.clientY>=(e.y+t.y)){
this.popdown();
this.notifyListeners(DwtEvent.ONMOUSEOUT)
}};
DwtToolTip.prototype.getHovered=function(){
return this._hovered
};
DwtToolTip.prototype.addListener=function(t,a,e){
return this._eventMgr.addListener(t,a,e)
};
DwtToolTip.prototype.setListener=function(t,a,e){
this.removeAllListeners(t);
return this._eventMgr.addListener(t,a,e)
};
DwtToolTip.prototype.removeListener=function(e,t){
return this._eventMgr.removeListener(e,t)
};
DwtToolTip.prototype.removeAllListeners=function(e){
return this._eventMgr.removeAll(e)
};
DwtToolTip.prototype.isListenerRegistered=function(e){
return this._eventMgr.isListenerRegistered(e)
};
DwtToolTip.prototype.notifyListeners=function(e,t){
return this._eventMgr.notifyListeners(e,t)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTreeItem")){
DwtTreeItem=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtTreeItem.PARAMS);
var e=t.parent;
if(e instanceof DwtTree){
this._tree=e
}else{
if(e instanceof DwtTreeItem){
this._tree=e._tree
}else{
throw new DwtException("DwtTreeItem parent must be a DwtTree or DwtTreeItem",DwtException.INVALIDPARENT,"DwtTreeItem")
}}
this._origClassName=t.className||"DwtTreeItem";
this._textClassName=[this._origClassName,"Text"].join("-");
this._selectedClassName=this._origClassName+" "+[this._origClassName,DwtCssStyle.SELECTED].join("-");
this._selectedFocusedClassName=this._selectedClassName+" "+[this._origClassName,DwtCssStyle.SELECTED,DwtCssStyle.FOCUSED].join("-");
this._actionedClassName=this._origClassName+" "+[this._origClassName,DwtCssStyle.ACTIONED].join("-");
this._dragOverClassName=this._origClassName+" "+[this._origClassName,DwtCssStyle.DRAG_OVER].join("-");
this._treeItemTextClass="DwtTreeItem-Text";
this._treeItemExtraImgClass="DwtTreeItem-ExtraImg";
this._dynamicWidth=t.dynamicWidth;
t.deferred=(t.deferred!==false);
t.className="DwtTreeItem-Control";
DwtComposite.call(this,t);
this._imageInfoParam=t.imageInfo;
this._extraInfo=t.extraInfo;
this._textParam=t.text;
this._deferred=t.deferred;
this._expandNodeImage=t.expandNodeImage||"NodeExpanded";
this._collapseNodeImage=t.collapseNodeImage||"NodeCollapsed";
this._itemChecked=false;
this._initialized=false;
this._selectionEnabled=Boolean(t.selectable!==false);
this._forceNotifySelection=Boolean(t.forceNotifySelection);
this._actionEnabled=true;
this._forceNotifyAction=Boolean(t.forceNotifyAction);
this._dndScrollCallback=t.dndScrollCallback;
this._dndScrollId=t.dndScrollId;
this._arrowDisabled=t.arrowDisabled;
if(t.singleClickAction){
this._singleClickAction=true;
this._selectedFocusedClassName=this._selectedClassName=this._textClassName;
this._hoverClassName=[this._origClassName,DwtCssStyle.HOVER].join("-")
}else{
this._hoverClassName=this._textClassName
}
if(e instanceof DwtTree||(e._initialized&&(!e._deferred||e._expanded))||!t.deferred){
this._initialize(t.index)
}else{
e._addDeferredChild(this,t.index);
this._index=t.index
}};
DwtTreeItem.PARAMS=["parent","index","text","imageInfo","deferred","className","posStyle","forceNotifySelection","forceNotifyAction"];
DwtTreeItem.prototype=new DwtComposite;
DwtTreeItem.prototype.constructor=DwtTreeItem;
DwtTreeItem.prototype.isDwtTreeItem=true;
DwtTreeItem.prototype.toString=function(){
return"DwtTreeItem"
};
DwtTreeItem.prototype.TEMPLATE="dwt.Widgets#ZTreeItem";
DwtTreeItem.prototype.role="treeitem";
DwtTreeItem.prototype.isFocusable=true;
DwtTreeItem.prototype._checkBoxVisible=true;
DwtTreeItem._NODECELL_DIM="16px";
DwtTreeItem._processedMouseDown=false;
DwtTreeItem.prototype.dispose=function(){
DwtComposite.prototype.dispose.call(this);
this._itemDiv=null;
this._nodeCell=null;
this._checkBoxCell=null;
this._checkedImg=null;
this._checkBox=null;
this._imageCell=null;
this._textCell=null;
this._childDiv=null;
this._initialized=false
};
DwtTreeItem.prototype.getData=function(e){
var t=this._data[e];
if(e!==Dwt.KEY_OBJECT||!t||!t.isZmOrganizer){
return t
}
var a=t&&appCtxt.cacheGet(t.id);
return a||t
};
DwtTreeItem.prototype.getChecked=function(){
return this._itemChecked
};
DwtTreeItem.prototype.setChecked=function(e,t){
if((this._itemChecked!=e)||t){
this._itemChecked=e;
if(this._checkBox!=null&&(this._checkBoxCell&&Dwt.getVisible(this._checkBoxCell))){
Dwt.setVisible(this._checkedImg,e)
}}};
DwtTreeItem.prototype._handleCheckboxOnclick=function(e){
this.setChecked(!Dwt.getVisible(this._checkedImg));
e=e||window.event;
e.item=this;
this._tree._itemChecked(this,e)
};
DwtTreeItem.prototype.getExpanded=function(){
return this._expanded
};
DwtTreeItem.prototype.setExpanded=function(t,s,n){
if(t){
var r=this.parent;
while(r instanceof DwtTreeItem&&!r._expanded){
r.setExpanded(true);
r=r.parent
}
this._realizeDeferredChildren()
}
if(this.getNumChildren()){
if(t&&s){
if(!this._expanded){
this._expand(t,null,n)
}
var e=this.getChildren();
for(var o=0;
o<e.length;
o++){
if(e[o] instanceof DwtTreeItem){
e[o].setExpanded(t,s,n)
}}}else{
if(this._expanded!=t){
this._expand(t,null,n)
}}}};
DwtTreeItem.prototype.getItemCount=function(){
return this._children.size()
};
DwtTreeItem.prototype.getItems=function(){
return this._children.getArray()
};
DwtTreeItem.prototype.getChildIndex=function(e){
return this._children.indexOf(e)
};
DwtTreeItem.prototype.getNestingLevel=function(){
return this.parent.getNestingLevel()+1
};
DwtTreeItem.prototype.getImage=function(){
return this._imageInfo
};
DwtTreeItem.prototype.setImage=function(e){
if(this._initialized){
if(this._imageCell){
AjxImg.setImage(this._imageCell,e)
}
this._imageInfo=e
}else{
this._imageInfoParam=e
}};
DwtTreeItem.prototype.setDndImage=function(e){
this._dndImageInfo=e
};
DwtTreeItem.prototype.getSelected=function(){
return this._selected
};
DwtTreeItem.prototype.getActioned=function(){
return this._actioned
};
DwtTreeItem.prototype.getText=function(){
return this._text
};
DwtTreeItem.prototype.setText=function(e){
if(this._initialized&&this._textCell){
if(!e){
e=""
}
this._text=this._textCell.innerHTML=e
}else{
this._textParam=e
}};
DwtTreeItem.prototype.setDndText=function(e){
this._dndText=e
};
DwtTreeItem.prototype.showCheckBox=function(e){
this._checkBoxVisible=e;
if(this._checkBoxCell){
Dwt.setVisible(this._checkBoxCell,e)
}};
DwtTreeItem.prototype.showExpansionIcon=function(e){
if(this._nodeCell){
Dwt.setVisible(this._nodeCell,e)
}};
DwtTreeItem.prototype.enableSelection=function(e){
this._selectionEnabled=e;
this._selectedClassName=e?this._origClassName+"-"+DwtCssStyle.SELECTED:this._origClassName
};
DwtTreeItem.prototype.isSelectionEnabled=function(){
return this._selectionEnabled
};
DwtTreeItem.prototype.enableAction=function(e){
this._actionEnabled=e
};
DwtTreeItem.prototype.addSeparator=function(e){
this._children.add((new DwtTreeItemSeparator(this)),e)
};
DwtTreeItem.prototype.setVisible=function(a,t,e){
if(t&&!e){
Dwt.setVisible(this._itemDiv,a)
}else{
if(e&&!t){
Dwt.setVisible(this._childDiv,a)
}else{
DwtComposite.prototype.setVisible.call(this,a)
}}};
DwtTreeItem.prototype.removeChild=function(t){
if(t._initialized){
this._tree._deselect(t);
if(this._childDiv){
this._childDiv.removeChild(t.getHtmlElement())
}}
this._children.remove(t);
if(this._children.size()==0){
if(this._expanded){
this._expanded=false
}
this._expandable=false;
this.removeAttribute("aria-expanded");
if(this._initialized&&this._nodeCell){
AjxImg.setImage(this._nodeCell,"Blank_16");
var e=AjxImg.getImageElement(this._nodeCell);
if(e){
Dwt.clearHandler(e,DwtEvent.ONMOUSEDOWN)
}}}};
DwtTreeItem.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_TREE
};
DwtTreeItem.prototype.handleKeyAction=function(o,r){
switch(o){
case DwtKeyMap.ENTER:this._tree.setEnterSelection(this,true);
break;
case DwtKeyMap.NEXT:var e=this._tree._getNextTreeItem(true);
if(e){
e._tree.setSelection(e,false,true)
}
break;
case DwtKeyMap.PREV:var e=this._tree._getNextTreeItem(false);
if(e){
e._tree.setSelection(e,false,true)
}
break;
case DwtKeyMap.SELECT_FIRST:case DwtKeyMap.SELECT_LAST:var e=(o===DwtKeyMap.SELECT_FIRST)?this._tree._getFirstTreeItem():this._tree._getLastTreeItem();
if(e){
e._tree.setSelection(e,false,true)
}
break;
case DwtKeyMap.EXPAND:if(!this._expanded){
this.setExpanded(true,false,true)
}else{
if(this._children.size()>0){
var i=this._children.get(0);
this._tree.setSelection(i,false,true)
}}
break;
case DwtKeyMap.COLLAPSE:if(this._expanded){
this.setExpanded(false,false,true)
}else{
if(this.parent.isDwtTreeItem){
this._tree.setSelection(this.parent,false,true)
}}
break;
case DwtKeyMap.SUBMENU:var a=this.getHtmlElement();
var t=Dwt.toWindow(a,0,0);
var l=this.getSize();
var h=t.x+l.x/4;
var n=t.y+l.y/2;
this._gotMouseDownRight=true;
this._emulateSingleClick({
dwtObj:this,target:a,button:DwtMouseEvent.RIGHT,docX:h,docY:n,kbNavEvent:true}
);
break;
default:return false
}
return true
};
DwtTreeItem.prototype.addNodeIconListeners=function(){
var e=AjxImg.getImageElement(this._nodeCell);
if(e){
Dwt.setHandler(e,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr);
Dwt.setHandler(e,DwtEvent.ONMOUSEUP,DwtTreeItem._nodeIconMouseUpHdlr)
}};
DwtTreeItem.prototype._initialize=function(e,o,i){
this._checkState();
if(AjxEnv.isIE){
this._setEventHdlrs([DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE])
}
if(AjxEnv.isSafari){
this._setEventHdlrs([DwtEvent.ONCONTEXTMENU])
}
var a={
id:this._htmlElId,divClassName:this._origClassName,isCheckedStyle:this._tree.isCheckedStyle,textClassName:this._textClassName};
this._createHtmlFromTemplate(this.TEMPLATE,a);
this.parent._addItem(this,e,o);
this._itemDiv=document.getElementById(a.id+"_div");
this._nodeCell=document.getElementById(a.id+"_nodeCell");
this._checkBoxCell=document.getElementById(a.id+"_checkboxCell");
this._checkBox=document.getElementById(a.id+"_checkbox");
this._checkedImg=document.getElementById(a.id+"_checkboxImg");
this._imageCell=document.getElementById(a.id+"_imageCell");
this._textCell=document.getElementById(a.id+"_textCell");
this._extraCell=document.getElementById(a.id+"_extraCell");
this.setAttribute("aria-level",this.getNestingLevel());
if(this._textCell){
this.setAttribute("aria-labelledby",this._textCell.id)
}
if(this._dynamicWidth){
var t=document.getElementById(a.id+"_table");
if(t){
t.style.tableLayout="auto"
}}
this._expandable=false;
this.removeAttribute("aria-expanded");
if(this._nodeCell){
this._nodeCell.style.minWidth=this._nodeCell.style.width=this._nodeCell.style.height=DwtTreeItem._NODECELL_DIM;
if(this._children.size()>0||i){
this._expandable=true;
AjxImg.setImage(this._nodeCell,this._collapseNodeImage);
this.addNodeIconListeners()
}}
if(this._extraCell){
AjxImg.setImage(this._extraCell,(this._extraInfo||"Blank_16"));
this._extraCell.className=this._treeItemExtraImgClass
}
if(this._tree.isCheckedStyle&&this._checkBox){
this._checkBox.onclick=AjxCallback.simpleClosure(this._handleCheckboxOnclick,this);
this.showCheckBox(this._checkBoxVisible);
this.setChecked(this._tree.isCheckedByDefault,true)
}
if(this._imageCell&&this._imageInfoParam){
AjxImg.setImage(this._imageCell,this._imageInfoParam);
this._imageInfo=this._imageInfoParam
}
if(this._textCell&&this._textParam){
this._textCell.innerHTML=this._text=this._textParam
}
this._expanded=this._selected=this._actioned=false;
this._gotMouseDownLeft=this._gotMouseDownRight=false;
this._addMouseListeners();
this._initialized=true
};
DwtTreeItem.prototype.setTreeItemColor=function(i){
var n=this._htmlElId+"_table";
var a=document.getElementById(n);
var o=document.getElementById(this._htmlElId+"_div");
var t=this.getHtmlElement();
var e=this._origClassName+" "+i;
if(o){
o.className=e
}else{
if(t){
t.className=i
}}};
DwtTreeItem.prototype._addMouseListeners=function(){
var t=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONDBLCLICK];
if(AjxEnv.isIE){
t.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{
t.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
if(AjxEnv.isSafari){
t.push(DwtEvent.ONCONTEXTMENU)
}
for(var e=0;
e<t.length;
e++){
this.addListener(t[e],DwtTreeItem._listeners[t[e]])
}};
DwtTreeItem.prototype._addDeferredChild=function(a,e){
if(this._initialized&&this._children.size()==0){
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage);
var t=AjxImg.getImageElement(this._nodeCell);
if(t){
this._expandable=true;
this.setAttribute("aria-expanded",this._expanded);
Dwt.setHandler(t,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr);
Dwt.setHandler(t,DwtEvent.ONMOUSEUP,DwtTreeItem._nodeIconMouseUpHdlr)
}}}
this._children.add(a,e)
};
DwtTreeItem.prototype.addChild=function(e){};
DwtTreeItem.prototype._addItem=function(a,t,n){
if(!this._children.contains(a)){
this._children.add(a,t)
}
this._expandable=true;
if(this._childDiv==null){
this._childDiv=document.createElement("div");
this._childDiv.className=(this.parent!=this._tree)?"DwtTreeItemChildDiv":"DwtTreeItemLevel1ChildDiv";
this._childDiv.setAttribute("role","group");
this._childDiv.setAttribute("aria-labelledby",this._itemDiv.id);
this._childDiv.setAttribute("aria-expanded",this._expanded);
this.getHtmlElement().appendChild(this._childDiv);
if(!this._expanded){
this._childDiv.style.display="none"
}}
if(n&&this._nodeCell){
if(AjxImg.getImageClass(this._nodeCell)==AjxImg.getClassForImage("Blank_16")){
AjxImg.setImage(this._nodeCell,this._expanded?this._expandNodeImage:this._collapseNodeImage);
var o=AjxImg.getImageElement(this._nodeCell);
if(o){
Dwt.setHandler(o,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr)
}}}
var e=this._childDiv;
var i=e.childNodes.length;
if(t==null||t>=i||i==0){
e.appendChild(a.getHtmlElement())
}else{
e.insertBefore(a.getHtmlElement(),e.childNodes[t])
}};
DwtTreeItem.prototype.sort=function(e){
this._children.sort(e);
if(this._childDiv){
this._setChildElOrder()
}else{
this._needsSort=true
}};
DwtTreeItem.prototype._setChildElOrder=function(e){
var t=document.createDocumentFragment();
this._children.foreach(function(o,a){
t.appendChild(o.getHtmlElement());
o._index=a
}
);
this._childDiv.appendChild(t)
};
DwtTreeItem.prototype._getDragProxy=function(){
var t=document.createElement("div");
Dwt.setPosition(t,Dwt.ABSOLUTE_STYLE);
var a=document.createElement("table");
t.appendChild(a);
a.cellSpacing=a.cellPadding=0;
var o=a.insertRow(0);
var e=0;
var n=o.insertCell(e++);
n.noWrap=true;
if(this._dndImageInfo){
AjxImg.setImage(n,this._dndImageInfo)
}else{
if(this._imageInfo){
AjxImg.setImage(n,this._imageInfo)
}}
n=o.insertCell(e);
n.noWrap=true;
n.className=this._origClassName;
if(this._dndText){
n.innerHTML=this._dndText
}else{
if(this._text){
n.innerHTML=this._text
}}
this.shell.getHtmlElement().appendChild(t);
Dwt.setZIndex(t,Dwt.Z_DND);
return t
};
DwtTreeItem.prototype._dragEnter=function(){
this._preDragClassName=this._textCell.className;
this._textCell.className=this._dragOverClassName;
this._draghovering=true
};
DwtTreeItem.prototype._dragHover=function(){
if(this.getNumChildren()>0&&!this.getExpanded()){
this.setExpanded(true)
}};
DwtTreeItem.prototype._dragLeave=function(e){
if(this._preDragClassName){
this._textCell.className=this._preDragClassName
}
this._draghovering=false
};
DwtTreeItem.prototype._drop=function(){
if(this._preDragClassName){
this._textCell.className=this._preDragClassName
}
this._draghovering=false
};
DwtTreeItem.prototype._focusByMouseDownEvent=function(e){};
DwtTreeItem._nodeIconMouseDownHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,a);
if(e.button==DwtMouseEvent.LEFT){
a._expand(!a._expanded,e)
}else{
if(e.button==DwtMouseEvent.RIGHT){
e.dwtObj._tree._itemActioned(e.dwtObj,e)
}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtTreeItem._nodeIconMouseUpHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtTreeItem.prototype._expand=function(t,a,e){
if(t!==this._expanded){
if(!t){
this._expanded=false;
this._childDiv.style.display="none";
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage)
}
this._tree._itemCollapsed(this,a,e)
}else{
this._realizeDeferredChildren();
this._expanded=true;
if(this._childDiv&&this._childDiv.style){
this._childDiv.style.display="block"
}
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._expandNodeImage)
}
this._tree._itemExpanded(this,a,e)
}
this.setAttribute("aria-expanded",t);
this._childDiv.setAttribute("aria-expanded",t);
this._childDiv.setAttribute("aria-hidden",!t)
}};
DwtTreeItem.prototype._realizeDeferredChildren=function(){
var e=this._children.getArray();
for(var t=0;
t<e.length;
t++){
var o=e[t];
if(!o._initialized){
o._initialize(o._index,true)
}else{
if(o._isSeparator&&!o.div&&this._childDiv){
var n=o.div=document.createElement("div");
n.className="vSpace";
this._childDiv.appendChild(n);
o._initialized=true
}}}
if(this._needsSort){
if(e.length){
this._setChildElOrder()
}
delete this.__needsSort
}};
DwtTreeItem.prototype._isChildOf=function(e){
var t=this.parent;
while(t&&t!=this._tree){
if(t==e){
return true
}
t=t.parent
}
return false
};
DwtTreeItem.prototype._setTreeElementStyles=function(e,a){
if(this._arrowDisabled||this._draghovering){
return
}
var t=a?"-focused":"";
if(this._extraCell){
AjxImg.setImage(this._extraCell,e);
this._extraCell.className=this._treeItemExtraImgClass+t
}
if(this._textCell){
this._textCell.className=this._treeItemTextClass+t
}};
DwtTreeItem.prototype._setSelected=function(t,i){
if(this._selected!=t&&!this._disposed){
this._selected=t;
if(!this._initialized){
this._initialize()
}
if(!this._itemDiv){
return
}
var a;
if(t&&(this._selectionEnabled||this._forceNotifySelection)){
this._itemDiv.className=this._selectedClassName;
this._setTreeElementStyles("DownArrowSmall",true);
this._tree.setAttribute("aria-activedescendant",this.getHTMLElId());
if(!i){
this.focus()
}
a=true
}else{
this.blur();
this._setTreeElementStyles("Blank_16",false);
this._itemDiv.className=this._origClassName;
this._tree.removeAttribute("aria-activedescendant");
a=false
}
this.getHtmlElement().setAttribute("aria-selected",t);
var e=this._tree.getHtmlElement();
if(t){
e.setAttribute("aria-activedescendant",this.getHTMLElId())
}else{
e.removeAttribute("aria-activedescendant")
}
return a
}};
DwtTreeItem.prototype._setActioned=function(e){
if(this._actioned!=e){
this._actioned=e;
if(!this._initialized){
this._initialize()
}
if(!this._itemDiv){
return
}
if(e&&(this._actionEnabled||this._forceNotifyAction)&&!this._selected){
this._itemDiv.className=this._actionedClassName;
return true
}
if(!e){
if(!this._selected){
this._itemDiv.className=this._origClassName
}
return false
}}};
DwtTreeItem.prototype._focus=function(){
if(!this._itemDiv){
return
}
this._itemDiv.className=this._selectedFocusedClassName;
this._setTreeElementStyles("DownArrowSmall",true)
};
DwtTreeItem.prototype._blur=function(){
if(!this._itemDiv){
return
}
this._itemDiv.className=this._selected?this._selectedClassName:this._origClassName;
this._setTreeElementStyles(this._selected?"DownArrowSmall":"Blank_16",this._selected)
};
DwtTreeItem._mouseDownListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(e.button==DwtMouseEvent.LEFT&&(t._selectionEnabled||t._forceNotifySelection)){
t._gotMouseDownLeft=true
}else{
if(e.button==DwtMouseEvent.RIGHT&&(t._actionEnabled||t._forceNotifyAction)){
t._gotMouseDownRight=true
}}};
DwtTreeItem._mouseOutListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
t._gotMouseDownLeft=false;
t._gotMouseDownRight=false;
if(t._singleClickAction&&t._textCell){
t._textCell.className=t._textClassName
}
if(!t._selected){
t._setTreeElementStyles("Blank_16",false)
}};
DwtTreeItem._mouseOverListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(t._singleClickAction&&t._textCell){
t._textCell.className=t._hoverClassName
}
if(!t._selected){
t._setTreeElementStyles("ColumnDownArrow",true)
}};
DwtTreeItem._mouseUpListener=function(a){
var i=a.dwtObj;
if(!i){
return false
}
if(a.target===i._childDiv){
return
}
if(i._expandable&&a.target===AjxImg.getImageElement(i._nodeCell)){
return
}
var e=DwtUiEvent.getTargetWithProp(a,"id"),t=(i._extraCell&&e&&i._extraCell.id===e.id);
if((a.button===DwtMouseEvent.RIGHT&&i._gotMouseDownRight)||t){
i._tree._itemActioned(i,a)
}else{
if(a.button===DwtMouseEvent.LEFT&&i._gotMouseDownLeft){
i._tree._itemClicked(i,a)
}}};
DwtTreeItem._doubleClickListener=function(t){
var a=t.dwtObj;
if(!a){
return false
}
if(t.target==a._childDiv){
return
}
var i=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,i);
if(e.button==DwtMouseEvent.LEFT||e.button==DwtMouseEvent.NONE){
e.dwtObj._tree._itemDblClicked(e.dwtObj,e)
}};
DwtTreeItem._contextListener=function(t){
if(AjxEnv.isSafari){
var a=DwtControl.getTargetControl(t);
var e=a?a.preventContextMenu():true;
if(e){
a.notifyListeners(DwtEvent.ONMOUSEDOWN,t);
return a.notifyListeners(DwtEvent.ONMOUSEUP,t)
}}};
DwtTreeItem.prototype._emulateSingleClick=function(e){
var t=new DwtMouseEvent();
this._setMouseEvent(t,e);
t.kbNavEvent=e.kbNavEvent;
this.notifyListeners(DwtEvent.ONMOUSEUP,t)
};
DwtTreeItem.prototype.getTooltipBase=function(e){
return this._itemDiv
};
DwtTreeItem._listeners={};
DwtTreeItem._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtTreeItem._mouseDownListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtTreeItem._mouseOutListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtTreeItem._mouseOutListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtTreeItem._mouseOverListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtTreeItem._mouseOverListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtTreeItem._mouseUpListener);
DwtTreeItem._listeners[DwtEvent.ONDBLCLICK]=new AjxListener(null,DwtTreeItem._doubleClickListener);
DwtTreeItem._listeners[DwtEvent.ONCONTEXTMENU]=new AjxListener(null,DwtTreeItem._contextListener);
DwtTreeItemSeparator=function(e){
this.parent=e;
this._isSeparator=true;
this._initialized=true
};
DwtTreeItemSeparator.prototype.dispose=function(){
DwtComposite.prototype.removeChild.call(this.parent,this)
};
DwtTreeItemSeparator.prototype.isInitialized=function(){
return this._initialized
};
DwtTreeItemSeparator.prototype.getHtmlElement=function(){
return this.div
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTree")){
DwtTree=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtTree.PARAMS);
a.className=a.className||"DwtTree";
DwtComposite.call(this,a);
var e=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONDBLCLICK];
if(!AjxEnv.isIE){
e=e.concat([DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT])
}
this._setEventHdlrs(e);
var t=a.style;
if(!t){
this._style=DwtTree.SINGLE_STYLE
}else{
if(t==DwtTree.CHECKEDITEM_STYLE){
t|=DwtTree.SINGLE_STYLE
}
this._style=t
}
this.isCheckedStyle=((this._style&DwtTree.CHECKEDITEM_STYLE)!=0);
this.isCheckedByDefault=a.isCheckedByDefault;
this._selectedItems=new AjxVector();
this._selEv=new DwtSelectionEvent(true);
this._selByClickEv=new DwtSelectionEvent(true);
this._selByClickEv.clicked=true;
this._selByEnterEv=new DwtSelectionEvent(true);
this._selByEnterEv.enter=true;
this.tabGroupMember=this
};
DwtTree.PARAMS=["parent","style","className","posStyle"];
DwtTree.prototype=new DwtComposite;
DwtTree.prototype.constructor=DwtTree;
DwtTree.prototype.role="tree";
DwtTree.prototype.toString=function(){
return"DwtTree"
};
DwtTree.SINGLE_STYLE=1;
DwtTree.MULTI_STYLE=2;
DwtTree.CHECKEDITEM_STYLE=4;
DwtTree.ITEM_SELECTED=0;
DwtTree.ITEM_DESELECTED=1;
DwtTree.ITEM_CHECKED=2;
DwtTree.ITEM_ACTIONED=3;
DwtTree.ITEM_DBL_CLICKED=4;
DwtTree.ITEM_EXPANDED=1;
DwtTree.ITEM_COLLAPSED=2;
DwtTree.prototype.getStyle=function(){
return this._style
};
DwtTree.prototype.getNestingLevel=function(){
return 0
};
DwtTree.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
DwtTree.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtTree.prototype.addTreeListener=function(e){
this.addListener(DwtEvent.TREE,e)
};
DwtTree.prototype.removeTreeListener=function(e){
this.removeListener(DwtEvent.TREE,e)
};
DwtTree.prototype.getItemCount=function(){
return this.getItems().length
};
DwtTree.prototype.getItems=function(){
return this._children.getArray()
};
DwtTree.prototype.clearItems=function(){
var e=this.getItems();
for(var t=0;
t<e.length;
t++){
this.removeChild(e[t])
}
this._getContainerElement().innerHTML=""
};
DwtTree.prototype.deselectAll=function(){
var e=this._selectedItems.getArray();
var o=this._selectedItems.size();
for(var t=0;
t<o;
t++){
if(e[t]){
e[t]._setSelected(false)
}}
if(o>0){
this._notifyListeners(DwtEvent.SELECTION,this._selectedItems.getArray(),DwtTree.ITEM_DESELECTED,null,this._selEv)
}
this._selectedItems.removeAll()
};
DwtTree.prototype.getSelection=function(){
return this._selectedItems.getArray()
};
DwtTree.prototype.setEnterSelection=function(t,e){
if(!t){
return
}
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_SELECTED,null,this._selByEnterEv,e)
};
DwtTree.prototype.setSelection=function(n,r,c,e){
if(!n||!n.isSelectionEnabled()){
return
}
var l=this._selectedItems.getArray();
var h=this._selectedItems.size();
var d;
var t=0;
var s=false;
for(var o=0;
o<h;
o++){
if(l[o]==n){
s=true
}else{
l[o]._setSelected(false);
this._selectedItems.remove(l[o]);
if(d==null){
d=new Array()
}
d[t++]=l[o]
}}
if(d&&!r){
this._notifyListeners(DwtEvent.SELECTION,d,DwtTree.ITEM_DESELECTED,null,this._selEv,c)
}
if(s){
return
}
this._selectedItems.add(n);
this._expandUp(n);
if(n._setSelected(true,e)&&!r){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,null,this._selEv,c)
}};
DwtTree.prototype.getSelectionCount=function(){
return this._selectedItems.size()
};
DwtTree.prototype.addChild=function(e){
if(e.isDwtTreeItem){
return
}
DwtComposite.prototype.addChild.apply(this,arguments)
};
DwtTree.prototype.addSeparator=function(){
var e=document.createElement("div");
e.className="vSpace";
this._getContainerElement().appendChild(e)
};
DwtTree.prototype._expandUp=function(t){
var e=t.parent;
while(e instanceof DwtTreeItem){
e.setExpanded(true);
e.setVisible(true);
e=e.parent
}};
DwtTree.prototype._addItem=function(t,e){
this._children.add(t,e);
var i=this._getContainerElement();
var a=i.childNodes.length;
if(e==null||e>a){
i.appendChild(t.getHtmlElement())
}else{
i.insertBefore(t.getHtmlElement(),i.childNodes[e]||null)
}};
DwtTree.prototype._getContainerElement=DwtTree.prototype.getHtmlElement;
DwtTree.prototype.sort=function(a){
var t=this.getItems();
t.sort(a);
var e=document.createDocumentFragment();
AjxUtil.foreach(t,function(n,o){
e.appendChild(n.getHtmlElement());
n._index=o
}
);
this._getContainerElement().appendChild(e)
};
DwtTree.prototype.removeChild=function(t){
this._children.remove(t);
this._selectedItems.remove(t);
var e=t.getHtmlElement();
if(e.parentNode){
e.parentNode.removeChild(e)
}};
DwtTree.prototype._getNextTreeItem=function(n){
var a=this.getSelection();
var l=(a&&a.length)?a[0]:null;
var e=null,h=-1;
var r=this.getTreeItemList(true);
if(l){
for(var o=0,s=r.length;
o<s;
o++){
var t=r[o];
if(t==l){
h=n?o+1:o-1;
break
}}
e=r[h]
}else{
if(r&&r.length){
e=n?r[0]:r[r.length-1]
}}
return e
};
DwtTree.prototype._getFirstTreeItem=function(){
var e=this.getTreeItemList(true);
if(e&&e.length>0){
return e[0]
}
return null
};
DwtTree.prototype._getLastTreeItem=function(){
var e=this.getTreeItemList(true);
if(e&&e.length>0){
return e[e.length-1]
}
return null
};
DwtTree.prototype.getTreeItemList=function(e){
return this._addToList([],e)
};
DwtTree.prototype._addToList=function(n,s,o){
if(o&&!o._isSeparator&&(!s||(o.getVisible()&&o._selectionEnabled))){
n.push(o)
}
if(!o||!s||o._expanded){
var a=o||this;
var t=a.getChildren?a.getChildren():[];
for(var e=0;
e<t.length;
e++){
this._addToList(n,s,t[e])
}}
return n
};
DwtTree.prototype._deselect=function(e){
if(this._selectedItems.contains(e)){
this._selectedItems.remove(e);
e._setSelected(false);
this._notifyListeners(DwtEvent.SELECTION,[e],DwtTree.ITEM_DESELECTED,null,this._selEv)
}};
DwtTree.prototype._itemActioned=function(t,e){
if(this._actionedItem&&!this._actionedItem.isDisposed()){
this._actionedItem._setActioned(false);
this._notifyListeners(DwtEvent.SELECTION,[this._actionedItem],DwtTree.ITEM_DESELECTED,e,this._selEv)
}
this._actionedItem=t;
t._setActioned(true);
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_ACTIONED,e,this._selEv)
};
DwtTree.prototype._itemChecked=function(t,e){
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_CHECKED,e,this._selEv)
};
DwtTree.prototype._itemClicked=function(n,o){
var t;
var e=this._selectedItems.getArray();
var s=this._selectedItems.size();
if(this._style&DwtTree.SINGLE_STYLE||(!o.shiftKey&&!o.ctrlKey)){
if(s>0){
for(t=0;
t<s;
t++){
e[t]._setSelected(false)
}
this._notifyListeners(DwtEvent.SELECTION,this._selectedItems.getArray(),DwtTree.ITEM_DESELECTED,o,this._selByClickEv);
this._selectedItems.removeAll()
}
this._selectedItems.add(n);
if(n._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,o,this._selByClickEv)
}}else{
if(o.ctrlKey){
if(this._selectedItems.contains(n)){
this._selectedItems.remove(n);
n._setSelected(false);
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_DESELECTED,o,this._selByClickEv)
}else{
this._selectedItems.add(n);
if(n._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,o,this._selByClickEv)
}}}else{}}};
DwtTree.prototype._itemDblClicked=function(t,e){
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_DBL_CLICKED,e,this._selEv)
};
DwtTree.prototype._itemExpanded=function(a,t,e){
if(!e){
this._notifyListeners(DwtEvent.TREE,[a],DwtTree.ITEM_EXPANDED,t,DwtShell.treeEvent)
}};
DwtTree.prototype._itemCollapsed=function(l,s,n){
var o;
if(!n){
this._notifyListeners(DwtEvent.TREE,[l],DwtTree.ITEM_COLLAPSED,s,DwtShell.treeEvent)
}
var h=false;
var r=this._selectedItems.getArray();
var e=this._selectedItems.size();
var c;
var t=0;
for(o=0;
o<e;
o++){
if(r[o]._isChildOf(l)){
h=true;
if(c==null){
c=new Array()
}
c[t++]=r[o];
r[o]._setSelected(false);
this._selectedItems.remove(r[o])
}}
if(c){
this._notifyListeners(DwtEvent.SELECTION,c,DwtTree.ITEM_DESELECTED,s,this._selEv)
}
if(h&&!this._selectedItems.contains(l)){
if(l._setSelected(true)){
this._selectedItems.add(l);
this._notifyListeners(DwtEvent.SELECTION,[l],DwtTree.ITEM_SELECTED,s,this._selEv)
}}};
DwtTree.prototype._notifyListeners=function(n,e,i,a,t,o){
if(this.isListenerRegistered(n)){
if(a){
DwtUiEvent.copy(t,a)
}
t.items=e;
if(e.length==1){
t.item=e[0]
}
t.detail=i;
t.kbNavEvent=o;
this.notifyListeners(n,t);
if(n==DwtEvent.SELECTION){
this.shell.notifyGlobalSelection(t)
}}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtCalendar")){
DwtCalendar=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtCalendar.PARAMS);
e.className=e.className||"DwtCalendar";
DwtComposite.call(this,e);
this._skipNotifyOnPage=false;
this._hidePrevNextMo=e.hidePrevNextMo;
this._readOnly=e.readOnly;
this._showWeekNumber=e.showWeekNumber;
this._uuid=Dwt.getNextId();
var t=this._origDayClassName=e.className+"Day";
this._todayClassName=" "+e.className+"Day-today";
this._selectedDayClassName=" "+t+"-"+DwtCssStyle.SELECTED;
this._hoveredDayClassName=" "+t+"-"+DwtCssStyle.HOVER;
this._activeDayClassName=" "+t+"-"+DwtCssStyle.ACTIVE;
this._hiliteClassName=" "+t+"-hilited";
this._greyClassName=" "+t+"-grey";
if(!this._readOnly){
this._installListeners()
}
this._selectionMode=DwtCalendar.DAY;
this._init();
this._weekDays=new Array(7);
this._workingDays=e.workingDays||DwtCalendar._DEF_WORKING_DAYS;
this._useISO8601WeekNo=e.useISO8601WeekNo;
this.setFirstDayOfWeek(e.firstDayOfWeek||DwtCalendar.SUN);
this._forceRollOver=(e.forceRollOver!==false)
};
DwtCalendar.PARAMS=["parent","className","posStyle","firstDayOfWeek","forceRollOver","workingDaysArray","hidePrevNextMo","readOnly"];
DwtCalendar.prototype=new DwtComposite;
DwtCalendar.prototype.constructor=DwtCalendar;
DwtCalendar.SUN=0;
DwtCalendar.MON=1;
DwtCalendar.TUE=2;
DwtCalendar.WED=3;
DwtCalendar.THU=4;
DwtCalendar.FRI=5;
DwtCalendar.SAT=6;
DwtCalendar.DAY=1;
DwtCalendar.WEEK=2;
DwtCalendar.WORK_WEEK=3;
DwtCalendar.MONTH=4;
DwtCalendar.RANGE_CHANGE="DwtCalendar.RANGE_CHANGE";
DwtCalendar._FULL_WEEK=[1,1,1,1,1,1,1];
DwtCalendar._DEF_WORKING_DAYS=[0,1,1,1,1,1,0];
DwtCalendar._DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];
DwtCalendar._NO_MONTH=-2;
DwtCalendar._PREV_MONTH=-1;
DwtCalendar._THIS_MONTH=0;
DwtCalendar._NEXT_MONTH=1;
DwtCalendar._NORMAL=1;
DwtCalendar._HOVERED=2;
DwtCalendar._ACTIVE=3;
DwtCalendar._SELECTED=4;
DwtCalendar._DESELECTED=5;
DwtCalendar.DATE_SELECTED=1;
DwtCalendar.DATE_DESELECTED=2;
DwtCalendar.DATE_DBL_CLICKED=3;
DwtCalendar._LAST_DAY_CELL_IDX=41;
DwtCalendar._BUTTON_CLASS="DwtCalendarButton";
DwtCalendar._BUTTON_HOVERED_CLASS=DwtCalendar._BUTTON_CLASS+"-"+DwtCssStyle.HOVER;
DwtCalendar._BUTTON_ACTIVE_CLASS=DwtCalendar._BUTTON_CLASS+"-"+DwtCssStyle.ACTIVE;
DwtCalendar._TITLE_CLASS="DwtCalendarTitle";
DwtCalendar._TITLE_HOVERED_CLASS=DwtCalendar._TITLE_CLASS+"-"+DwtCssStyle.HOVER;
DwtCalendar._TITLE_ACTIVE_CLASS=DwtCalendar._TITLE_CLASS+"-"+DwtCssStyle.ACTIVE;
DwtCalendar.prototype.toString=function(){
return"DwtCalendar"
};
DwtCalendar.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
DwtCalendar.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtCalendar.prototype.addActionListener=function(e){
this.addListener(DwtEvent.ACTION,e)
};
DwtCalendar.prototype.removeActionListener=function(e){
this.removeListener(DwtEvent.ACTION,e)
};
DwtCalendar.prototype.addDateRangeListener=function(e){
this.addListener(DwtEvent.DATE_RANGE,e)
};
DwtCalendar.prototype.removeDateRangeListener=function(e){
this.removeListener(DwtEvent.DATE_RANGE,e)
};
DwtCalendar.prototype.setSkipNotifyOnPage=function(e){
this._skipNotifyOnPage=e
};
DwtCalendar.prototype.getSkipNotifyOnPage=function(){
return this._skipNotifyOnPage
};
DwtCalendar.prototype.setDate=function(i,s,a,t){
a=(a==null)?this._forceRollOver:a;
if(!i){
i=new Date()
}
var l=new Date(i.getTime());
var o=this._date;
var n=false;
var d=false;
var e;
if(this._date2CellId!=null){
var h=(l.getFullYear()*10000)+(l.getMonth()*100)+l.getDate();
var e=this._date2CellId[h];
if(e){
if(e==this._selectedCellId){
d=true
}
var c=document.getElementById(e);
if(c._dayType==DwtCalendar._THIS_MONTH){
d=true
}else{
if(a){
d=n=true
}else{
d=true
}}}else{
d=n=true
}}else{
d=n=true
}
if(d){
if(this._date){
if(AjxDateUtil.isDayShifted(l)){
AjxDateUtil.rollToNextDay(l)
}
l.setHours(this._date.getHours(),this._date.getMinutes(),this._date.getSeconds(),0)
}
this._date=l;
if(!n&&!this._readOnly){
this._setSelectedDate();
this._setToday()
}}
if(n){
this._layout()
}
if(d&&!s){
var r=t?DwtCalendar.DATE_DBL_CLICKED:DwtCalendar.DATE_SELECTED;
this._notifyListeners(DwtEvent.SELECTION,r,this._date)
}
return true
};
DwtCalendar.prototype.isSelected=function(t){
if(t==this._selectedDayElId){
return true
}else{
if(this._selectionMode!=DwtCalendar.DAY){
var e=this._getDayCellIndex(t);
if(Math.floor(e/7)==Math.floor(this._getDayCellIndex(this._selectedDayElId)/7)&&this._currWorkingDays[e%7]){
return true
}}}
return false
};
DwtCalendar.prototype.getForceRollOver=function(){
return this._forceRollOver
};
DwtCalendar.prototype.setForceRollOver=function(e){
if(e==null){
return
}
if(this._forceRollOver!=e){
this._forceRollOver=e;
this._layout()
}};
DwtCalendar.prototype.getSelectionMode=function(){
return this._selectionMode
};
DwtCalendar.prototype.setSelectionMode=function(e){
if(this._selectionMode==e){
return
}
this._selectionMode=e;
if(e==DwtCalendar.WEEK){
this._currWorkingDays=DwtCalendar._FULL_WEEK
}else{
if(e==DwtCalendar.WORK_WEEK){
this._currWorkingDays=this._workingDays
}}
this._layout()
};
DwtCalendar.prototype.setWorkingWeek=function(e){
this._workingDays=this._currWorkingDays=e;
if(this._selectionMode==DwtCalendar.WORK_WEEK){
this._layout()
}};
DwtCalendar.prototype.setHilite=function(s,a,t){
if(this._date2CellId==null){
return
}
var e;
var r;
if(t){
for(r in this._date2CellId){
e=document.getElementById(this._date2CellId[r]);
if(e._isHilited){
e._isHilited=false;
this._setClassName(e,DwtCalendar._NORMAL)
}}}
var n;
for(var o in s){
if(s.hasOwnProperty(o)){
r=s[o];
n=this._date2CellId[r.getFullYear()*10000+r.getMonth()*100+r.getDate()];
if(n){
e=document.getElementById(n);
if(e._isHilited!=a){
e._isHilited=a;
this._setClassName(e,DwtCalendar._NORMAL)
}}}}};
DwtCalendar.prototype.getDate=function(){
return this._date
};
DwtCalendar.prototype.setFirstDayOfWeek=function(e){
for(var a=0;
a<7;
a++){
this._weekDays[a]=(a<e)?(6-(e-a-1)):(a-e);
var t=document.getElementById(this._getDOWCellId(a));
t.innerHTML=AjxDateUtil.WEEKDAY_SHORT[(e+a)%7]
}
this._firstDayOfWeek=e;
this._layout()
};
DwtCalendar.prototype.getDateRange=function(){
return this._range
};
DwtCalendar.prototype._getDayCellId=function(e){
return("c:"+e+":"+this._uuid)
};
DwtCalendar.prototype._getDayCellIndex=function(e){
return e.substring(2,e.indexOf(":",3))
};
DwtCalendar.prototype._getDOWCellId=function(e){
return("w:"+e+":"+this._uuid)
};
DwtCalendar.prototype._getWeekNumberCellId=function(e){
return("k:"+e+":"+this._uuid)
};
DwtCalendar.prototype._getDaysInMonth=function(t,e){
if(t!=1){
return DwtCalendar._DAYS_IN_MONTH[t]
}
if(e%4!=0||(e%100==0&&e%400!=0)){
return 28
}
return 29
};
DwtCalendar.prototype._installListeners=function(){
this._setMouseEventHdlrs();
this.addListener(DwtEvent.ONMOUSEOVER,new AjxListener(this,this._mouseOverListener));
this.addListener(DwtEvent.ONMOUSEOUT,new AjxListener(this,this._mouseOutListener));
this.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));
this.addListener(DwtEvent.ONMOUSEUP,new AjxListener(this,this._mouseUpListener));
this.addListener(DwtEvent.ONDBLCLICK,new AjxListener(this,this._doubleClickListener))
};
DwtCalendar.prototype._notifyListeners=function(e,a,t,i){
if(!this.isListenerRegistered(e)){
return
}
var o=DwtShell.selectionEvent;
if(i){
DwtUiEvent.copy(o,i)
}else{
o.reset()
}
o.item=this;
o.detail=t;
o.type=a;
this.notifyListeners(e,o)
};
DwtCalendar.prototype._layout=function(){
if(this._date==null){
this._date=new Date()
}
if(!this._calWidgetInited){
this._init()
}
var p=new Date(this._date.getTime());
p.setDate(1);
var s=p.getFullYear();
var g=p.getMonth();
var n=p.getDay();
var a=this._getDaysInMonth(g,s);
var l=1;
var y=1;
this._date2CellId=new Object();
this._selectedDayElId=null;
var o,d,w,f,e;
if(!this._hidePrevNextMo){
if(g!=0){
o=this._getDaysInMonth(g-1,s)-this._weekDays[n]+1;
d=s;
w=g-1;
if(g!=11){
f=g+1;
e=s
}else{
f=0;
e=s+1
}}else{
o=this._getDaysInMonth(11,s-1)-this._weekDays[n]+1;
d=s-1;
w=11;
f=1;
e=s
}}
for(var c=0;
c<6;
c++){
for(var h=0;
h<7;
h++){
var m=document.getElementById(this._getDayCellId(c*7+h));
if(m._isHilited==null){
m._isHilited=false
}
if(l<=a){
if(c!=0||h>=this._weekDays[n]){
this._date2CellId[(s*10000)+(g*100)+l]=m.id;
m._day=l;
m._month=g;
m._year=s;
m.innerHTML=l++;
m._dayType=DwtCalendar._THIS_MONTH;
if(this._readOnly){
m.style.fontFamily="Arial";
m.style.fontSize="10px"
}}else{
if(this._hidePrevNextMo){
m.innerHTML=""
}else{
this._date2CellId[(d*10000)+(w*100)+o]=m.id;
m._day=o;
m._month=w;
m._year=d;
m.innerHTML=o++;
m._dayType=DwtCalendar._PREV_MONTH
}}}else{
if(!this._hidePrevNextMo){
this._date2CellId[(e*10000)+(f*100)+y]=m.id;
m._day=y;
m._month=f;
m._year=e;
m.innerHTML=y++;
m._dayType=DwtCalendar._NEXT_MONTH
}}
this._setClassName(m,DwtCalendar._NORMAL)
}
if(this._showWeekNumber){
var r=this._getWeekNumberCellId("kw"+c*7);
var u=document.getElementById(r);
if(u){
var t=document.getElementById(this._getDayCellId(c*7));
u.innerHTML=AjxDateUtil.getWeekNumber(new Date(t._year,t._month,t._day),this._firstDayOfWeek,null,this._useISO8601WeekNo)
}}}
this._setTitle(g,s);
if(!this._readOnly){
this._setSelectedDate();
this._setToday()
}
this._setRange()
};
DwtCalendar.prototype._setRange=function(){
var e=document.getElementById(this._getDayCellId(0));
var i=new Date(e._year,e._month,e._day,0,0,0,0);
e=document.getElementById(this._getDayCellId(DwtCalendar._LAST_DAY_CELL_IDX));
var a=this._getDaysInMonth(e._month,e._year);
var t;
if(e._day<a){
t=new Date(e._year,e._month,e._day+1,0,0,0,0)
}else{
if(e._month<11){
t=new Date(e._year,e._month+1,1,0,0,0,0)
}else{
t=new Date(e._year+1,0,1,0,0,0,0)
}}
if(this._range==null){
this._range={}
}else{
if(this._range.start.getTime()==i.getTime()&&this._range.end.getTime()==t.getTime()){
return false
}}
this._range.start=i;
this._range.end=t;
if(!this.isListenerRegistered(DwtEvent.DATE_RANGE)){
return
}
if(!this._dateRangeEvent){
this._dateRangeEvent=new DwtDateRangeEvent(true)
}
this._dateRangeEvent.item=this;
this._dateRangeEvent.start=i;
this._dateRangeEvent.end=t;
this.notifyListeners(DwtEvent.DATE_RANGE,this._dateRangeEvent)
};
DwtCalendar.prototype._setToday=function(){
var e;
var t=new Date();
var a=t.getDate();
if(!this._todayDay||this._todayDay!=a){
if(this._todayCellId!=null){
e=document.getElementById(this._todayCellId);
e._isToday=false;
this._setClassName(e,DwtCalendar._NORMAL)
}
this._todayCellId=this._date2CellId[(t.getFullYear()*10000)+(t.getMonth()*100)+a];
if(this._todayCellId!=null){
e=document.getElementById(this._todayCellId);
e._isToday=true;
this._setClassName(e,DwtCalendar._NORMAL)
}}};
DwtCalendar.prototype._setSelectedDate=function(){
var t=this._date.getDate();
var o=this._date.getMonth();
var a=this._date.getFullYear();
var e;
if(this._selectedDayElId){
e=document.getElementById(this._selectedDayElId);
this._setClassName(e,DwtCalendar._DESELECTED)
}
var i=this._date2CellId[(a*10000)+(o*100)+t];
e=document.getElementById(i);
this._selectedDayElId=i;
this._setClassName(e,DwtCalendar._SELECTED)
};
DwtCalendar.prototype._setCellClassName=function(t,a,i){
if(t._dayType!=DwtCalendar._THIS_MONTH){
a+=this._greyClassName
}
if(this._selectionMode==DwtCalendar.DAY&&t.id==this._selectedDayElId&&i!=DwtCalendar._DESELECTED){
a+=this._selectedDayClassName
}else{
if(this._selectionMode!=DwtCalendar.DAY&&i!=DwtCalendar._DESELECTED&&this._selectedDayElId!=null){
var e=this._getDayCellIndex(t.id);
if(Math.floor(this._getDayCellIndex(this._selectedDayElId)/7)==Math.floor(e/7)&&this._currWorkingDays[e%7]){
a+=this._selectedDayClassName
}}}
if(t._isHilited){
a+=this._hiliteClassName
}
if(t._isToday){
a+=this._todayClassName
}
return a
};
DwtCalendar.prototype._setClassName=function(e,s){
var a="";
if(s==DwtCalendar._NORMAL){
a=this._origDayClassName
}else{
if(s==DwtCalendar._HOVERED){
a=this._hoveredDayClassName
}else{
if(s==DwtCalendar._ACTIVE){
a=this._activeDayClassName
}else{
if(s==DwtCalendar._DESELECTED&&this._selectionMode==DwtCalendar.DAY){
a=this._origDayClassName
}else{
if(this._selectionMode!=DwtCalendar.DAY&&(s==DwtCalendar._SELECTED||s==DwtCalendar._DESELECTED)){
var n=Math.floor(this._getDayCellIndex(this._selectedDayElId)/7)*7;
for(var t=0;
t<7;
t++){
a=this._origDayClassName;
var o=document.getElementById(this._getDayCellId(n++));
o.className=this._setCellClassName(o,a,s)
}
return
}}}}}
e.className=this._setCellClassName(e,a,s)
};
DwtCalendar.prototype._setTitle=function(o,i){
var e=document.getElementById(this._monthCell);
var a=DwtCalendar.getMonthFormatter();
var t=new Date(i,o);
e.innerHTML=a.format(t)
};
DwtCalendar.prototype._init=function(){
var o=new Array(100);
var e=0;
this._monthCell="t:"+this._uuid;
o[e++]="<table width=100%>";
o[e++]="<tr><td class='DwtCalendarTitlebar'>";
o[e++]="<table>";
o[e++]="<tr>";
o[e++]="<td align='center' class='";
o[e++]=DwtCalendar._BUTTON_CLASS;
o[e++]="' id='b:py:";
o[e++]=this._uuid;
o[e++]="'>";
o[e++]=AjxImg.getImageHtml("FastRevArrowSmall",null,["id='b:py:img:",this._uuid,"'"].join(""));
o[e++]="</td>";
o[e++]="<td align='center' class='";
o[e++]=DwtCalendar._BUTTON_CLASS;
o[e++]="' id='b:pm:";
o[e++]=this._uuid;
o[e++]="'>";
o[e++]=AjxImg.getImageHtml("RevArrowSmall",null,["id='b:pm:img:",this._uuid,"'"].join(""));
o[e++]="</td>";
o[e++]="<td class='DwtCalendarTitleCell' 'nowrap' style='width: 60%'><span class='";
o[e++]=DwtCalendar._TITLE_CLASS;
o[e++]="' id='";
o[e++]=this._monthCell;
o[e++]="'></span></td>";
o[e++]="<td align='center' class='";
o[e++]=DwtCalendar._BUTTON_CLASS;
o[e++]="' id='b:nm:";
o[e++]=this._uuid;
o[e++]="'>";
o[e++]=AjxImg.getImageHtml("FwdArrowSmall",null,["id='b:nm:img:",this._uuid,"'"].join(""));
o[e++]="</td>";
o[e++]="<td align='center' class='";
o[e++]=DwtCalendar._BUTTON_CLASS;
o[e++]="' id='b:ny:";
o[e++]=this._uuid;
o[e++]="'>";
o[e++]=AjxImg.getImageHtml("FastFwdArrowSmall",null,["id='b:ny:img:",this._uuid,"'"].join(""));
o[e++]="</td>";
o[e++]="</tr>";
o[e++]="</table>";
o[e++]="</td></tr>";
o[e++]="<tr><td class='DwtCalendarBody'>";
o[e++]="<table width='100%' style='border-collapse:separate;' cellspacing='0'>";
o[e++]="<tr>";
if(this._showWeekNumber){
o[e++]="<td class='DwtCalendarWeekNoTitle' width='14%' id='";
o[e++]=this._getWeekNumberCellId("kw");
o[e++]="'>";
o[e++]=AjxMsg.calendarWeekTitle;
o[e++]="</td>"
}
for(var a=0;
a<7;
a++){
o[e++]="<td class='DwtCalendarDow' width='";
o[e++]=(a<5?"14%":"15%");
o[e++]="' id='";
o[e++]=this._getDOWCellId(a);
o[e++]="'>&nbsp;</td>"
}
o[e++]="</tr>";
for(var a=0;
a<6;
a++){
o[e++]="<tr>";
if(this._showWeekNumber){
o[e++]="<td class='DwtCalendarWeekNo' id='"+this._getWeekNumberCellId("kw"+a*7)+"'>&nbsp;</td>"
}
for(var t=0;
t<7;
t++){
o[e++]="<td id='";
o[e++]=this._getDayCellId(a*7+t);
o[e++]="'>&nbsp;</td>"
}
o[e++]="</tr>"
}
o[e++]="</td></tr></table></table>";
this.getHtmlElement().innerHTML=o.join("");
if(!this._readOnly){
document.getElementById("b:py:img:"+this._uuid)._origClassName=AjxImg.getClassForImage("FastRevArrowSmall");
document.getElementById("b:pm:img:"+this._uuid)._origClassName=AjxImg.getClassForImage("RevArrowSmall");
document.getElementById("b:nm:img:"+this._uuid)._origClassName=AjxImg.getClassForImage("FwdArrowSmall");
document.getElementById("b:ny:img:"+this._uuid)._origClassName=AjxImg.getClassForImage("FastFwdArrowSmall")
}
this._calWidgetInited=true
};
DwtCalendar.prototype.setMouseOverDayCallback=function(e){
this._mouseOverDayCB=e
};
DwtCalendar.prototype.setMouseOutDayCallback=function(e){
this._mouseOutDayCB=e
};
DwtCalendar.prototype.getDndDate=function(){
var e=this._lastDndCell;
if(e){
return new Date(e._year,e._month,e._day)
}
return null
};
DwtCalendar._tmpDate=new Date();
DwtCalendar._tmpDate.setHours(0,0,0,0);
DwtCalendar.prototype._mouseOverListener=function(t){
var a=t.target;
if(a.id.charAt(0)=="c"){
this._setClassName(a,DwtCalendar._HOVERED);
if(this._mouseOverDayCB){
DwtCalendar._tmpDate.setFullYear(a._year,a._month,a._day);
this._mouseOverDayCB.run(this,DwtCalendar._tmpDate)
}}else{
if(a.id.charAt(0)=="t"){
return
}else{
if(a.id.charAt(0)=="b"){
var e;
if(a.firstChild==null){
e=a;
AjxImg.getParentElement(a).className=DwtCalendar._BUTTON_HOVERED_CLASS
}else{
a.className=DwtCalendar._BUTTON_HOVERED_CLASS;
e=AjxImg.getImageElement(a)
}
e.className=e._origClassName
}}}
t._stopPropagation=true
};
DwtCalendar.prototype._mouseOutListener=function(t){
this.setToolTipContent(null);
var a=t.target;
if(a.id.charAt(0)=="c"){
this._setClassName(a,DwtCalendar._NORMAL);
if(this._mouseOutDayCB){
this._mouseOutDayCB.run(this)
}}else{
if(a.id.charAt(0)=="b"){
var e;
a.className=DwtCalendar._BUTTON_CLASS;
if(a.firstChild==null){
e=a;
AjxImg.getParentElement(a).className=DwtCalendar._BUTTON_CLASS
}else{
a.className=DwtCalendar._BUTTON_CLASS;
e=AjxImg.getImageElement(a)
}
e.className=e._origClassName
}}};
DwtCalendar.prototype._mouseDownListener=function(t){
if(t.button==DwtMouseEvent.LEFT){
var a=t.target;
if(a.id.charAt(0)=="c"){
this._setClassName(a,DwtCalendar._ACTIVE)
}else{
if(a.id.charAt(0)=="t"){
a.className=DwtCalendar._TITLE_ACTIVE_CLASS
}else{
if(a.id.charAt(0)=="b"){
var e;
if(a.firstChild==null){
e=a;
AjxImg.getParentElement(a).className=DwtCalendar._BUTTON_ACTIVE_CLASS
}else{
a.className=DwtCalendar._BUTTON_ACTIVE_CLASS;
e=AjxImg.getImageElement(a)
}
e.className=e._origClassName
}else{
if(a.id.charAt(0)=="w"){}}}}}};
DwtCalendar.prototype._mouseUpListener=function(t){
var i=t.target;
if(t.button==DwtMouseEvent.LEFT){
if(i.id.charAt(0)=="c"){
if(this.parent instanceof DwtMenu){
DwtMenu.closeActiveMenu()
}
var a=new Date(i._year,i._month,i._day);
if(a.getDate()!=i._day){
a.setDate(i._day)
}
if(this.setDate(a)){
return
}
this._setClassName(i,DwtCalendar._HOVERED)
}else{
if(i.id.charAt(0)=="b"){
var e;
if(i.firstChild==null){
e=i;
AjxImg.getParentElement(i).className=DwtCalendar._BUTTON_HOVERED_CLASS
}else{
i.className=DwtCalendar._BUTTON_HOVERED_CLASS;
e=AjxImg.getImageElement(i)
}
e.className=e._origClassName;
if(e.id.indexOf("py")!=-1){
this._prevYear()
}else{
if(e.id.indexOf("pm")!=-1){
this._prevMonth()
}else{
if(e.id.indexOf("nm")!=-1){
this._nextMonth()
}else{
this._nextYear()
}}}}else{
if(i.id.charAt(0)=="t"){
i.className=DwtCalendar._TITLE_HOVERED_CLASS;
this.setDate(new Date(),this._skipNotifyOnPage);
if(this.parent instanceof DwtMenu){
DwtMenu.closeActiveMenu()
}}}}}else{
if(t.button==DwtMouseEvent.RIGHT&&i.id.charAt(0)=="c"){
this._notifyListeners(DwtEvent.ACTION,0,new Date(i._year,i._month,i._day),t)
}}};
DwtCalendar.prototype._doubleClickListener=function(e){
var t=e.target;
if(this._selectionEvent){
this._selectionEvent.type=DwtCalendar.DATE_DBL_CLICKED
}
if(t.id.charAt(0)=="c"){
if(this.parent instanceof DwtMenu){
DwtMenu.closeActiveMenu()
}
this.setDate(new Date(t._year,t._month,t._day),false,false,true)
}};
DwtCalendar.prototype._prevMonth=function(e){
var t=new Date(this._date.getTime());
this.setDate(AjxDateUtil.roll(t,AjxDateUtil.MONTH,-1),this._skipNotifyOnPage)
};
DwtCalendar.prototype._nextMonth=function(e){
var t=new Date(this._date.getTime());
this.setDate(AjxDateUtil.roll(t,AjxDateUtil.MONTH,1),this._skipNotifyOnPage)
};
DwtCalendar.prototype._prevYear=function(e){
var t=new Date(this._date.getTime());
this.setDate(AjxDateUtil.roll(t,AjxDateUtil.YEAR,-1),this._skipNotifyOnPage)
};
DwtCalendar.prototype._nextYear=function(e){
var t=new Date(this._date.getTime());
this.setDate(AjxDateUtil.roll(t,AjxDateUtil.YEAR,1),this._skipNotifyOnPage)
};
DwtCalendar.getDateFormatter=function(){
if(!DwtCalendar._dateFormatter){
DwtCalendar._dateFormatter=new AjxDateFormat(AjxMsg.formatCalDate)
}
return DwtCalendar._dateFormatter
};
DwtCalendar.getDateLongFormatter=function(){
if(!DwtCalendar._dateLongFormatter){
DwtCalendar._dateLongFormatter=new AjxDateFormat(AjxMsg.formatCalDateLong)
}
return DwtCalendar._dateLongFormatter
};
DwtCalendar.getDateFullFormatter=function(){
if(!DwtCalendar._dateFullFormatter){
DwtCalendar._dateFullFormatter=new AjxDateFormat(AjxMsg.formatCalDateFull)
}
return DwtCalendar._dateFullFormatter
};
DwtCalendar.getHourFormatter=function(){
if(!DwtCalendar._hourFormatter){
DwtCalendar._hourFormatter=new AjxMessageFormat(AjxMsg.formatCalHour)
}
return DwtCalendar._hourFormatter
};
DwtCalendar.getDayFormatter=function(){
if(!DwtCalendar._dayFormatter){
DwtCalendar._dayFormatter=new AjxDateFormat(AjxMsg.formatCalDay)
}
return DwtCalendar._dayFormatter
};
DwtCalendar.getMonthFormatter=function(){
if(!DwtCalendar._monthFormatter){
DwtCalendar._monthFormatter=new AjxDateFormat(AjxMsg.formatCalMonth)
}
return DwtCalendar._monthFormatter
};
DwtCalendar.getShortMonthFormatter=function(){
if(!DwtCalendar._shortMonthFormatter){
DwtCalendar._shortMonthFormatter=new AjxDateFormat(AjxMsg.formatShortCalMonth)
}
return DwtCalendar._shortMonthFormatter
};
DwtCalendar.prototype._dragEnter=function(e){};
DwtCalendar.prototype._dragHover=function(e){};
DwtCalendar.prototype._dragOver=function(e){
var t=e.target;
if(t.id.charAt(0)=="c"){
this._setClassName(t,DwtCalendar._HOVERED);
this._lastDndCell=t
}else{
this._lastDndCell=null
}};
DwtCalendar.prototype._dragLeave=function(e){}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtPropertyPage")){
DwtPropertyPage=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtPropertyPage.PARAMS);
e.className=e.className||"DwtPropertyPage";
DwtComposite.call(this,e);
this._fieldIds=new Object();
this._fildDivIds=new Object();
this._isDirty=false;
this._tabGroup=new DwtTabGroup(this.toString())
};
DwtPropertyPage.prototype=new DwtComposite;
DwtPropertyPage.prototype.constructor=DwtPropertyPage;
DwtPropertyPage.prototype.toString=function(){
return"DwtPropertyPage"
};
DwtPropertyPage.PARAMS=DwtComposite.PARAMS;
DwtPropertyPage.prototype.setDirty=function(e){
this._isDirty=e
};
DwtPropertyPage.prototype.isDirty=function(){
return this._isDirty
};
DwtPropertyPage.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtPropertyPage.prototype._installOnKeyUpHandler=function(i,t){
if(!i){
return
}
var a=null;
a=document.getElementById(this._fieldIds[i]);
if(a){
Dwt.setHandler(a,DwtEvent.ONKEYUP,t?t:this._onKeyUp);
a._view=this;
a._field=i
}};
DwtPropertyPage.prototype._installOnClickHandler=function(i,t){
if(!i){
return
}
var a=document.getElementById(this._fieldIds[i]);
if(a){
Dwt.setHandler(a,DwtEvent.ONCLICK,t?t:this._onClick);
a._view=this;
a._field=i
}};
DwtPropertyPage.prototype._onClick=function(e){
this._view.setDirty(true);
return true
};
DwtPropertyPage.prototype._onKeyUp=function(e){
this._view.setDirty(true);
return true
};
DwtPropertyPage.prototype._installOnChangeHandler=function(i,t){
if(!i){
return
}
var a=null;
a=document.getElementById(this._fieldIds[i]);
if(a){
Dwt.setHandler(a,DwtEvent.ONCHANGE,t?t:this._onChange);
a._view=this;
a._field=i
}};
DwtPropertyPage._onChange=function(e){
this._view.setDirty(true);
return true
};
DwtPropertyPage.prototype._onChange2=function(e){
this.setDirty(true);
return true
};
DwtPropertyPage.prototype._addDwtSelectEntryRow=function(o,n,a,e,i){
var t="30ex";
if(i){
t=i
}
a[e++]="<tr valign='center'>";
e=this._addDwtSelectEntryCell(o,n,a,e,t);
a[e++]="</tr>";
return e
};
DwtPropertyPage.prototype._addDwtSelectEntryCell=function(a,i,t,e,n){
var o=Dwt.getNextId();
this._fieldIds[a]=o;
if(i){
t[e++]="<td align='left' style='width:"+n+"'>";
t[e++]=AjxStringUtil.htmlEncode(i)+":";
t[e++]="</td>"
}
t[e++]="<td align='left'>";
t[e++]="<div id='"+o+"'></div></td>";
return e
};
DwtPropertyPage.prototype._addBoolEntryRow=function(a,i,t,e,o){
t[e++]="<tr valign='center'>";
e=this._addBoolEntryCell(a,i,t,e,o);
t[e++]="</tr>";
return e
};
DwtPropertyPage.prototype._addBoolEntryCell=function(i,o,t,e,s){
var n=Dwt.getNextId();
this._fieldIds[i]=n;
var a="20ex";
if(s){
a=s
}
if(o){
t[e++]="<td style='width:"+a+";' align='left'>";
t[e++]=AjxStringUtil.htmlEncode(o)+":";
t[e++]="</td>"
}
t[e++]="<td align='left'>";
t[e++]="<input type='checkbox' id='"+n+"'>";
t[e++]="</td>";
return e
};
DwtPropertyPage.prototype._addTextAreaEntryRow=function(i,o,t,e,s){
var a="on";
if(s){
a="off"
}
var n=Dwt.getNextId();
this._fieldIds[i]=n;
t[e++]="<tr valign='center'>";
t[e++]="<td align='left' style='width:60ex;'>";
t[e++]=AjxStringUtil.htmlEncode(o)+":";
t[e++]="</td></tr>";
t[e++]="<tr valign='center'><td align='left' style='width:60ex;'><textarea wrap='"+a+"' rows='8' cols ='60' id='";
t[e++]=n;
t[e++]="'/></textarea></td></tr>";
return e
};
DwtPropertyPage.prototype._addEntryRow=function(s,n,t,h,i,o,e,r,a){
t[h++]="<tr valign='center'>";
h=this._addEntryCell(s,n,t,h,i,o,e,r,a);
t[h++]="</tr>";
return h
};
DwtPropertyPage.prototype._addEntryCell=function(h,r,i,c,n,s,t,l,o){
if(n==null){
n="text"
}
if(s==null){
s=35
}
var a="20ex";
if(l){
a=l
}
var e=Dwt.getNextId();
this._fieldIds[h]=e;
if(r){
i[c++]="<td align='left' style='width:"+a+";'>";
i[c++]=AjxStringUtil.htmlEncode(r)+":";
i[c++]="</td>"
}
i[c++]="<td ";
if(o){
i[c++]="class='redAsteric' "
}
i[c++]="	align='left'><input autocomplete='off' size='"+s+"' type='"+n+"' id='";
i[c++]=e;
i[c++]="'";
if(o){
i[c++]="/>*"
}else{
i[c++]="/>&nbsp;"
}
if(t!=null){
i[c++]=t
}
i[c++]="</td>";
return c
};
DwtPropertyPage.prototype._createHTML=function(){}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTabView")){
DwtTabView=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtListView.PARAMS);
t.className=t.className||"ZTabView";
t.posStyle=t.posStyle||DwtControl.ABSOLUTE_STYLE;
DwtComposite.call(this,t);
this._stateChangeEv=new DwtEvent(true);
this._stateChangeEv.item=this;
this._tabs=[];
this._tabIx=1;
this._createHtml();
var e=[this.toString(),this._htmlElId].join(" ");
this._tabGroup=new DwtTabGroup(e);
this._tabGroup.addMember(this._tabBar)
};
DwtTabView.PARAMS=["parent","className","posStyle"];
DwtTabView.prototype=new DwtComposite;
DwtTabView.prototype.constructor=DwtTabView;
DwtTabView.prototype.isDwtTabView=true;
DwtTabView.prototype.toString=function(){
return"DwtTabView"
};
DwtTabView.prototype.role="tablist";
DwtTabView.Z_ACTIVE_TAB=Dwt.Z_VIEW+10;
DwtTabView.Z_HIDDEN_TAB=Dwt.Z_HIDDEN;
DwtTabView.Z_TAB_PANEL=Dwt.Z_VIEW+20;
DwtTabView.Z_CURTAIN=Dwt.Z_CURTAIN;
DwtTabView.prototype.TEMPLATE="dwt.Widgets#ZTabView";
DwtTabView.prototype.addStateChangeListener=function(e){
this._eventMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabView.prototype.removeStateChangeListener=function(e){
this._eventMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabView.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtTabView.prototype.addTab=function(n,o,a,e){
var i=this._tabIx++;
this._tabs[i]={
title:n,button:this._tabBar.addButton(i,n,a,e)};
this.setTabView(i,o);
if(i==1){
var t=this.getTabView(i);
if(t){
o.showMe()
}
this._currentTabKey=i;
this.switchToTab(i)
}else{
if(o&&!(o instanceof AjxCallback)){
o.hideMe();
Dwt.setVisible(o.getHtmlElement(),false)
}}
this._tabBar.addSelectionListener(i,new AjxListener(this,DwtTabView.prototype._tabButtonListener));
return i
};
DwtTabView.prototype.enable=function(e){
for(var a in this._tabs){
var t=this._tabs[a].button;
if(t){
t.setEnabled(e)
}}};
DwtTabView.prototype.getCurrentTab=function(){
return this._currentTabKey
};
DwtTabView.prototype.getNumTabs=function(){
return(this._tabs.length-1)
};
DwtTabView.prototype.getTab=function(e){
return(this._tabs&&this._tabs[e])?this._tabs[e]:null
};
DwtTabView.prototype.getTabBar=function(){
return this._tabBar
};
DwtTabView.prototype.getTabTitle=function(e){
return(this._tabs&&this._tabs[e])?this._tabs[e]["title"]:null
};
DwtTabView.prototype.getTabButton=function(e){
return(this._tabs&&this._tabs[e])?this._tabs[e]["button"]:null
};
DwtTabView.prototype.setTabView=function(i,a){
var t=this.getTab(i);
t.view=a;
if(a&&!(a instanceof AjxCallback)){
this._pageEl.appendChild(a.getHtmlElement());
a._tabKey=i;
if(i==this._currentTabKey){
var e=a.getTabGroupMember();
this._tabGroup.replaceMember(t.tabGroup,e);
t.tabGroup=e
}}};
DwtTabView.prototype.getTabView=function(i){
var a=this.getTab(i);
var t=a&&a.view;
if(t instanceof AjxCallback){
var o=t;
t=o.run(i);
this.setTabView(i,t);
var e=this._getTabSize();
t.setSize(e.x,e.y);
t.setAttribute("aria-labelledby",a.button.getHTMLElId())
}
return t
};
DwtTabView.prototype.switchToTab=function(a){
var t=this.getTab(a);
if(t){
var e=this.getTab(this._currentTabKey);
if(e){
this._tabGroup.removeMember(e.tabGroup)
}
this._showTab(a);
this._tabBar.openTab(a);
if(!t.tabGroup&&t.view){
t.tabGroup=t.view.getTabGroupMember()
}
this._tabGroup.addMember(t.tabGroup);
if(this._eventMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._eventMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}}};
DwtTabView.prototype.setBounds=function(t,i,a,e){
DwtComposite.prototype.setBounds.call(this,t,i,a,e);
this._resetTabSizes(a,e)
};
DwtTabView.prototype.getActiveView=function(){
return this._tabs[this._currentTabKey].view
};
DwtTabView.prototype.getKeyMapName=function(){
return DwtKeyMap.MAP_TAB_VIEW
};
DwtTabView.prototype.resetKeyBindings=function(){
var t=this.shell.getKeyboardMgr();
if(t.isEnabled()){
var n=t.__keyMapMgr;
if(!n){
return
}
var o=this.getNumTabs();
var r=n.getKeySequences(DwtKeyMap.MAP_TAB_VIEW,"GoToTab");
for(var e=0;
e<r.length;
e++){
var h=r[e];
for(var a=1;
a<=o;
a++){
var s=48+a;
var l=h.replace(/NNN/,s);
n.setMapping(DwtKeyMap.MAP_TAB_VIEW,l,"GoToTab"+a)
}}
n.reloadMap(DwtKeyMap.MAP_TAB_VIEW)
}};
DwtTabView.prototype.handleKeyAction=function(i){
switch(i){
case DwtKeyMap.NEXT_TAB:var a=this.getCurrentTab();
if(a<this.getNumTabs()){
this.switchToTab(a+1)
}
break;
case DwtKeyMap.PREV_TAB:var a=this.getCurrentTab();
if(a>1){
this.switchToTab(a-1)
}
break;
default:var t=i.match(DwtKeyMap.GOTO_TAB_RE);
if(t&&t.length){
var e=t[1];
if((e<=this.getNumTabs())&&(e!=this.getCurrentTab())){
this.switchToTab(e)
}}else{
return false
}}
return true
};
DwtTabView.prototype._resetTabSizes=function(a,e){
if(this._tabs&&this._tabs.length){
for(var o in this._tabs){
var t=this._tabs[o].view;
if(t&&!(t instanceof AjxCallback)){
var i;
i=i||e-Dwt.getSize(this._tabBarEl).y;
t.resetSize(a,i)
}}}};
DwtTabView.prototype._getTabSize=function(){
var t=this.getSize();
var a=t.x||this.getHtmlElement().clientWidth;
var e=t.y||this.getHtmlElement().clientHeight;
var i=this._tabBar.getSize();
var o=i.y||this._tabBar.getHtmlElement().clientHeight;
return new DwtPoint(a,(e-o))
};
DwtTabView.prototype._createHtml=function(e){
this._createHtmlFromTemplate(e||this.TEMPLATE,{
id:this._htmlElId}
)
};
DwtTabView.prototype._createHtmlFromTemplate=function(e,t){
DwtComposite.prototype._createHtmlFromTemplate.call(this,e,t);
this._tabBarEl=document.getElementById(t.id+"_tabbar");
this._tabBar=new DwtTabBar(this);
this._tabBar.reparentHtmlElement(this._tabBarEl);
this._pageEl=document.getElementById(t.id+"_page")
};
DwtTabView.prototype._showTab=function(t){
if(this._tabs&&this._tabs[t]){
this._currentTabKey=t;
this._hideAllTabs();
var e=this.getTabView(t);
if(e){
e.setVisible(true);
e.showMe()
}}};
DwtTabView.prototype._hideAllTabs=function(){
if(this._tabs&&this._tabs.length){
for(var t in this._tabs){
var e=this._tabs[t].view;
if(e&&!(e instanceof AjxCallback)){
e.hideMe();
Dwt.setVisible(e.getHtmlElement(),false)
}}}};
DwtTabView.prototype._tabButtonListener=function(e){
this.switchToTab(e.item.getData("tabKey"))
};
DwtTabViewPage=function(a,t,e,o){
if(arguments.length==0){
return
}
var i=Dwt.getParams(arguments,DwtTabViewPage.PARAMS);
i.className=i.className||"ZTabPage";
i.posStyle=i.posStyle||DwtControl.ABSOLUTE_STYLE;
i.id=o||null;
this._rendered=true;
DwtPropertyPage.call(this,i);
this._createHtml();
this.getHtmlElement().style.overflowY="auto";
this.getHtmlElement().style.overflowX="visible";
if(i.contentTemplate){
this.getContentHtmlElement().innerHTML=AjxTemplate.expand(i.contentTemplate,this._htmlElId)
}};
DwtTabViewPage.prototype=new DwtPropertyPage;
DwtTabViewPage.prototype.constructor=DwtTabViewPage;
DwtTabViewPage.prototype.isDwtTabViewPage=true;
DwtTabViewPage.prototype.toString=function(){
return"DwtTabViewPage"
};
DwtTabViewPage.prototype.role="tabpanel";
DwtTabViewPage.prototype.TEMPLATE="dwt.Widgets#ZTabPage";
DwtTabViewPage.PARAMS=DwtPropertyPage.PARAMS.concat("contentTemplate");
DwtTabViewPage.prototype.getContentHtmlElement=function(){
return this._contentEl||this.getHtmlElement()
};
DwtTabViewPage.prototype.showMe=function(){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
this.setAttribute("aria-selected",true);
if(this.parent.getHtmlElement().offsetHeight>80){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-80
}else{
var t=parseInt(this.parent.getHtmlElement().style.height);
var e=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(t>80){
this._contentEl.style.height=(Number(t-80).toString()+e)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width
};
DwtTabViewPage.prototype.hideMe=function(){
this.setZIndex(DwtTabView.Z_HIDDEN_TAB);
this.setAttribute("aria-selected",false)
};
DwtTabViewPage.prototype.resetSize=function(t,e){
this.setSize(t,e)
};
DwtTabViewPage.prototype._createHtml=function(e){
this._createHtmlFromTemplate(e||this.TEMPLATE,{
id:this._htmlElId}
)
};
DwtTabViewPage.prototype._createHtmlFromTemplate=function(e,t){
DwtPropertyPage.prototype._createHtmlFromTemplate.call(this,e,t);
this._contentEl=document.getElementById(t.id+"_content")||this.getHtmlElement()
};
DwtTabBar=function(a,t,i){
if(arguments.length==0){
return
}
this._buttons=[];
this._btnStyle=i||"ZTab";
this._btnImage=null;
this._currentTabKey=1;
var e=t||"ZTabBar";
DwtToolBar.call(this,{
parent:a,className:e,posStyle:DwtControl.STATIC_STYLE}
);
if(AjxEnv.isFirefox){
if(this._prefixEl&&this.constructor==DwtTabBar){
this._prefixEl.style.cssFloat="none"
}}};
DwtTabBar.prototype=new DwtToolBar;
DwtTabBar.prototype.constructor=DwtTabBar;
DwtTabBar.prototype.TEMPLATE="dwt.Widgets#ZTabBar";
DwtTabBar.prototype.toString=function(){
return"DwtTabBar"
};
DwtTabBar.prototype.getCurrentTab=function(){
return this._currentTabKey
};
DwtTabBar.prototype.addStateChangeListener=function(e){
this._eventMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabBar.prototype.removeStateChangeListener=function(e){
this._eventMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabBar.prototype.addSelectionListener=function(t,e){
this._buttons[t].addSelectionListener(e)
};
DwtTabBar.prototype.removeSelectionListener=function(t,e){
this._buttons[t].removeSelectionListener(e)
};
DwtTabBar.prototype.addButton=function(n,o,s,a){
var t=this._buttons[n]=new DwtTabButton(this,s,a);
this._buttons[n].addSelectionListener(new AjxListener(this,DwtTabBar._setActiveTab));
if(this._btnImage!=null){
t.setImage(this._btnImage)
}
if(o!=null){
t.setText(o)
}
t.setEnabled(true);
t.setData("tabKey",n);
if(parseInt(n)==1){
this.openTab(n,true)
}
var e=this.__getButtonIndex(this._currentTabKey);
if(e!=-1){
var i=this.__getButtonIndex(n);
if(i==e+1){
Dwt.addClass(t.getHtmlElement(),DwtTabBar.SELECTED_NEXT)
}}
return t
};
DwtTabBar.prototype.getButton=function(e){
return(this._buttons[e])?this._buttons[e]:null
};
DwtTabBar.prototype.openTab=function(e,o){
this._currentTabKey=e;
var i=this._buttons.length;
for(var t=0;
t<i;
t++){
if(t==e){
continue
}
var a=this._buttons[t];
if(a){
this.__markPrevNext(t,false);
a.setClosed()
}}
var a=this._buttons[e];
if(a){
a.setOpen();
this.__markPrevNext(e,true)
}
if(!o&&this._eventMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._eventMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtTabBar._setActiveTab=function(a){
var e;
if(a&&a.item){
e=a.item.getData("tabKey")
}else{
if(a&&a.target){
var t=a.target;
while(t.tagName!="TABLE"&&t.offsetParent){
t=t.offsetParent
}
e=t.getAttribute("tabKey");
if(e==null){
return false
}}else{
return false
}}
this.openTab(e)
};
DwtTabButton=function(i,o,t,a){
if(arguments.length==0){
return
}
var e=a||"ZTab";
DwtButton.call(this,{
parent:i,className:e,id:o,index:t}
)
};
DwtTabButton.prototype=new DwtButton;
DwtTabButton.prototype.constructor=DwtTabButton;
DwtTabButton.prototype.TEMPLATE="dwt.Widgets#ZTab";
DwtTabButton.prototype.isDwtTabButton=true;
DwtTabButton.prototype.toString=function(){
return"DwtTabButton"
};
DwtTabButton.prototype.role="tab";
DwtTabButton.prototype.setOpen=function(){
this._isSelected=true;
this.setDisplayState(DwtControl.SELECTED)
};
DwtTabButton.prototype.setClosed=function(){
this._isSelected=false;
this.setDisplayState(DwtControl.NORMAL)
};
DwtTabButton.prototype.setDisplayState=function(e){
if(this._isSelected&&e!=DwtControl.SELECTED){
e=[DwtControl.SELECTED,e].join(" ")
}
DwtButton.prototype.setDisplayState.call(this,e)
};
DwtTabBarFloat=function(t,e,a){
if(arguments.length==0){
return
}
DwtTabBar.call(this,t,e,a)
};
DwtTabBarFloat.prototype=new DwtTabBar;
DwtTabBarFloat.prototype.constructor=DwtTabBarFloat;
DwtTabBarFloat.prototype.TEMPLATE="dwt.Widgets#ZTabBarFloat";
DwtTabBarFloat.prototype.addButton=function(o,i,n){
var t=this._buttons[o]=new DwtTabButtonFloat(this,n);
this._buttons[o].addSelectionListener(new AjxListener(this,DwtTabBar._setActiveTab));
if(this._btnImage!=null){
t.setImage(this._btnImage)
}
if(i!=null){
t.setText(i)
}
t.setEnabled(true);
t.setData("tabKey",o);
if(parseInt(o)==1){
this.openTab(o,true)
}
var e=this.__getButtonIndex(this._currentTabKey);
if(e!=-1){
var a=this.__getButtonIndex(o);
if(a==e+1){
Dwt.addClass(t.getHtmlElement(),DwtTabBar.SELECTED_NEXT)
}}
return t
};
DwtTabButtonFloat=function(e,t){
DwtTabButton.call(this,e,t,undefined,"ZTab")
};
DwtTabButtonFloat.prototype=new DwtTabButton;
DwtTabButtonFloat.prototype.constructor=DwtTabButtonFloat;
DwtTabButtonFloat.prototype.TEMPLATE="dwt.Widgets#ZTabFloat"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtWizardDialog")){
DwtWizardDialog=function(o,i,r,e,a){
if(arguments.length==0){
return
}
i=i||"DwtDialog";
var s=new DwtDialog_ButtonDescriptor(DwtWizardDialog.NEXT_BUTTON,AjxMsg._next,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.goNext));
var t=new DwtDialog_ButtonDescriptor(DwtWizardDialog.PREV_BUTTON,AjxMsg._prev,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.goPrev));
var n=new DwtDialog_ButtonDescriptor(DwtWizardDialog.FINISH_BUTTON,AjxMsg._finish,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.finishWizard));
DwtDialog.call(this,{
parent:o,className:i,standardButtons:[DwtDialog.CANCEL_BUTTON],extraButtons:[t,s,n]}
);
if(!e){
this._contentW="80ex"
}else{
this._contentW=e
}
if(!a){
this._contentH="100ex"
}else{
this._contentH=a
}
this._pages=new Array();
this._pageIx=1;
this._currentPage=1;
this._progressDiv=document.createElement("div");
this._progressDiv.style.position=DwtControl.STATIC_STYLE;
this._pageDiv=document.createElement("div");
this._pageDiv.className="DwtWizardDialogPageDiv";
this._pageDiv.style.width=this._contentW;
this._pageDiv.style.height=this._contentH;
this._progressBar=new DwtWizProgressBar(this);
this._createContentHtml();
this.setTitle(r)
};
DwtWizardDialog.prototype=new DwtDialog;
DwtWizardDialog.prototype.constructor=DwtWizardDialog;
DwtWizardDialog.Z_ACTIVE_PAGE=Dwt.Z_VIEW+10;
DwtWizardDialog.Z_HIDDEN_PAGE=Dwt.Z_HIDDEN;
DwtWizardDialog.Z_TAB_PANEL=Dwt.Z_VIEW+20;
DwtWizardDialog.Z_CURTAIN=Dwt.Z_CURTAIN;
DwtWizardDialog.NEXT_BUTTON=12;
DwtWizardDialog.PREV_BUTTON=11;
DwtWizardDialog.FINISH_BUTTON=13;
DwtWizardDialog.prototype.toString=function(){
return"DwtWizardDialog"
};
DwtWizardDialog.prototype.popdown=function(){
DwtDialog.prototype.popdown.call(this);
this._hideAllPages()
};
DwtWizardDialog.prototype.goPage=function(e){
if(this._pages&&this._pages[e]){
this._currentPage=e;
this._showPage(e);
this._progressBar.showStep(e);
this._pages[e].setActive()
}};
DwtWizardDialog.prototype.goNext=function(){
var e=this._currentPage+1;
if(this._pages&&this._pages[this._currentPage]){
this._pages[this._currentPage].switchToNextPage(e)
}};
DwtWizardDialog.prototype.goPrev=function(){
var e=this._currentPage-1;
if(this._pages&&this._pages[this._currentPage]){
this._pages[this._currentPage].switchToPrevPage(e)
}};
DwtWizardDialog.prototype.finishWizard=function(){
this.popdown()
};
DwtWizardDialog.prototype.getPage=function(e){
if(this._pages&&this._pages[e]){
return this._pages[e]
}else{
return null
}};
DwtWizardDialog.prototype.addPage=function(e,t){
var a=this._pageIx++;
this._pages[a]=e;
this._progressBar.addStep(a,t);
this._pageDiv.appendChild(this._pages[a].getHtmlElement());
if(a==1){
this._pages[a].setZIndex(DwtWizardDialog.Z_ACTIVE_PAGE)
}else{
this._pages[a].setZIndex(DwtWizardDialog.Z_HIDDEN_PAGE);
Dwt.setVisible(this._pages[a].getHtmlElement(),false)
}
return a
};
DwtWizardDialog.prototype._createContentHtml=function(){
this._table=document.createElement("table");
this._table.border=0;
this._table.width=this._contentW;
this._table.cellPadding=this._table.cellSpacing=0;
this._table.backgroundColor=DwtCssStyle.getProperty(this.parent.getHtmlElement(),"background-color");
var i;
var o;
i=this._table.insertRow(0);
i.align="left";
i.vAlign="middle";
o=i.insertCell(i.cells.length);
o.align="left";
o.vAlign="middle";
o.noWrap=true;
o.width="100%";
o.className="DwtTabTable";
o.appendChild(this._progressBar.getHtmlElement());
var s;
var e;
s=this._table.insertRow(1);
s.align="center";
s.vAlign="middle";
e=s.insertCell(s.cells.length);
e.align="left";
e.vAlign="middle";
e.noWrap=true;
e.style.width=this._contentW;
var n=document.createElement("div");
n.className="horizSep";
n.style.width=this._contentW;
n.style.height="5px";
e.appendChild(n);
var t;
var a;
t=this._table.insertRow(2);
t.align="left";
t.vAlign="middle";
a=t.insertCell(t.cells.length);
a.align="left";
a.vAlign="middle";
a.noWrap=true;
a.width=this._contentW;
a.appendChild(this._pageDiv);
this._getContentDiv().appendChild(this._table)
};
DwtWizardDialog.prototype.addChild=function(e){
this._children.add(e)
};
DwtWizardDialog.prototype._showPage=function(e){
if(this._pages&&this._pages[e]){
this._hideAllPages();
this._pages[e].showMe();
Dwt.setVisible(this._pages[e].getHtmlElement(),true)
}};
DwtWizardDialog.prototype._hideAllPages=function(){
if(this._pages&&this._pages.length){
for(var e in this._pages){
if(this._pages[e]){
this._pages[e].hideMe();
Dwt.setVisible(this._pages[e].getHtmlElement(),false)
}}}};
DwtWizardPage=function(t,e){
if(arguments.length==0){
return
}
var a=e||"DwtDialog";
DwtPropertyPage.call(this,t,e,DwtControl.ABSOLUTE_STYLE)
};
DwtWizardPage.prototype=new DwtTabViewPage;
DwtWizardPage.prototype.constructor=DwtWizardPage;
DwtWizardPage.prototype.toString=function(){
return"DwtWizardPage"
};
DwtWizardPage.prototype.setActive=function(){};
DwtWizardPage.prototype.switchToNextPage=function(e){
this.parent.goPage(e)
};
DwtWizardPage.prototype.switchToPrevPage=function(e){
this.parent.goPage(e)
};
DwtWizardPage.prototype.showMe=function(){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
this.getHtmlElement().style.height=this.parent._contentH;
this.getHtmlElement().style.width=this.parent._contentW
};
DwtWizProgressBar=function(e){
if(arguments.length==0){
return
}
DwtComposite.call(this,{
parent:e,className:"DwtWizProgressBar",posStyle:DwtControl.STATIC_STYLE}
);
this._table=document.createElement("table");
this._table.border=0;
this._table.cellPadding=0;
this._table.cellSpacing=0;
this.getHtmlElement().appendChild(this._table);
this._table.backgroundColor=DwtCssStyle.getProperty(this.parent.getHtmlElement(),"background-color");
this._stepsNumber=0;
this._steps=new Array();
this._lblHeader=new DwtStepLabel(this);
this._lblHeader.setText("Step 0 of 0");
this._lblHeader.setActive(true)
};
DwtWizProgressBar.prototype=new DwtComposite;
DwtWizProgressBar.prototype.constructor=DwtWizProgressBar;
DwtWizProgressBar.prototype.toString=function(){
return"DwtWizProgressBar"
};
DwtWizProgressBar.prototype.showStep=function(t){
var e="Step "+t+" of "+this._stepsNumber;
if(this._steps[t]){
e=e+": "+this._steps[t]
}
this._lblHeader.setText(e)
};
DwtWizProgressBar.prototype.addStep=function(t,e){
this._steps[t]=e;
return(++this._stepsNumber)
};
DwtWizProgressBar.prototype.addChild=function(a){
this._children.add(a);
var t;
var e;
this._table.width="100%";
t=(this._table.rows.length!=0)?this._table.rows[0]:this._table.insertRow(0);
t.align="center";
t.vAlign="middle";
e=t.insertCell(t.cells.length);
e.align="center";
e.vAlign="middle";
e.noWrap=true;
e.appendChild(a.getHtmlElement())
};
DwtStepLabel=function(e){
DwtLabel.call(this,{
parent:e,style:DwtLabel.ALIGN_CENTER,className:"DwtStepLabel"}
)
};
DwtStepLabel.prototype=new DwtLabel;
DwtStepLabel.prototype.constructor=DwtStepLabel;
DwtStepLabel.prototype.toString=function(){
return"DwtStepLabel"
};
DwtStepLabel.prototype.setActive=function(e){
if(e){
this._textCell.className="DwtStepLabelActive"
}else{
this._textCell.className="DwtStepLabelInactive"
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtSelect")){
DwtSelect=function(o){
if(arguments.length==0){
return
}
o=Dwt.getParams(arguments,DwtSelect.PARAMS);
o.className=o.className||"ZSelect";
o.posStyle=o.posStyle||Dwt.STATIC_STYLE;
this._legendId=o.legendId;
DwtButton.call(this,o);
var a=AjxEnv.isIE?[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP]:[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
this._setEventHdlrs(a);
this._hasSetMouseEvents=true;
this._currentSelectedOption=null;
this._options=new AjxVector();
this._optionValuesToIndices={};
this._selectedValue=this._selectedOption=null;
this._maxRows=o.maxRows||0;
this._layout=o.layout;
this._congruent=o.congruent;
this._hrCount=0;
var e=o.options;
if(e){
for(var t=0;
t<e.length;
++t){
this.addOption(e[t])
}}
this.setDropDownImages("SelectPullDownArrow","SelectPullDownArrowDis","SelectPullDownArrow","SelectPullDownArrow");
this._menuCallback=new AjxListener(this,this._createMenu);
this.setMenu(this._menuCallback,true)
};
DwtSelect.PARAMS=["parent","options","style","className","layout"];
DwtSelect.prototype=new DwtButton;
DwtSelect.prototype.constructor=DwtSelect;
DwtSelect.prototype.isDwtSelect=true;
DwtSelect.prototype.toString=function(){
return"DwtSelect"
};
DwtSelect.prototype.role="combobox";
DwtSelect._CONTAINER_TEMPLATE="dwt.Widgets#ZSelectAutoSizingContainer";
DwtSelect._objectIds=[null];
DwtSelect.prototype.TEMPLATE="dwt.Widgets#ZSelect";
DwtSelect.getObjectFromElement=function(e){
return e&&e.dwtObj?AjxCore.objectWithId(e.dwtObj):null
};
DwtSelect.prototype.addOption=function(n,o,s,i){
if(!n){
return -1
}
i=i||null;
var t=null;
var a=null;
var e=null;
if(typeof(n)=="string"){
a=s!=null?s:n;
t=new DwtSelectOption(a,o,n,this,null,i)
}else{
if(n instanceof DwtSelectOption){
t=n;
if(s){
t.setValue(s)
}
o=t.isSelected()
}else{
if(n instanceof DwtSelectOptionData||n.value!=null){
a=s!=null?s:n.value;
t=new DwtSelectOption(a,n.isSelected,n.displayValue,this,null,n.image,n.selectedValue,false,n.extraData,n.id);
o=Boolean(n.isSelected);
e=n.id
}else{
return -1
}}}
this._options.add(t);
if(this._options.size()==1||o){
this._setSelectedOption(t)
}
var h=this._pseudoItemsEl;
var l=h.insertRow(-1);
var r=l.insertCell(-1);
r.className="ZSelectPseudoItem";
r.innerHTML=["<div class='ZWidgetTitle'>",AjxStringUtil.htmlEncode(t.getDisplayValue()),"</div>"].join("");
this.fixedButtonWidth();
this.setMenu(this._menuCallback,true);
this._optionValuesToIndices[t.getValue()]=this._options.size()-1;
return(this._options.size()-1)
};
DwtSelect.prototype.addHR=function(){
opt=new DwtSelectOption("hr"+this._hrCount.toString(),false,"",this,null,null,null,true);
this._hrCount++;
this._options.add(opt)
};
DwtSelect.prototype.removeOption=function(o){
if(!o){
return -1
}
this.setMenu(this._menuCallback,true);
this._options.remove(o);
var a=this._options.size();
var n=o.getValue();
var e=this._optionValuesToIndices[n];
if(e!=null){
this._pseudoItemsEl.deleteRow(e);
if(this._selectedOption==o){
if(a>0){
var s=(e>=a)?a-1:e;
this._setSelectedOption(this._options.get(s))
}
this.removeAttribute("aria-activedescendant")
}
this.fixedButtonWidth()
}
delete this._optionValuesToIndices[n];
for(var t=e;
t<a;
t++){
var o=this._options.get(t);
this._optionValuesToIndices[o.getValue()]=t
}
return e
};
DwtSelect.prototype.removeOptionWithValue=function(t){
var e=this.getOptionWithValue(t);
return e?this.removeOption(e):-1
};
DwtSelect.prototype.popup=function(){
var n=this.getMenu();
if(!n){
return
}
var i=this._selectEl;
var t=Dwt.getBounds(i);
var o=(i.style.borderLeftWidth=="")?0:parseInt(i.style.borderLeftWidth);
var r=(i.style.borderTopWidth=="")?0:parseInt(i.style.borderTopWidth);
r+=(i.style.borderBottomWidth=="")?0:parseInt(i.style.borderBottomWidth);
var a=Dwt.toWindow(i,0,0);
var e=a.x+o;
var s=a.y+t.height+r;
n.popup(0,e,s);
if(this._currentSelectedOption){
n.setSelectedItem(this._currentSelectedOption.getItem())
}};
DwtSelect.prototype.rename=function(t,a){
var e=this.getOptionWithValue(t);
if(!e){
return
}
e._displayValue=a;
if(this._selectedOption&&(this._selectedOption._value==t)){
this.setText(AjxStringUtil.htmlEncode(a))
}
this.setMenu(this._menuCallback,true)
};
DwtSelect.prototype.enableOption=function(i,e){
var t=this.getOptionWithValue(i);
if(!t){
return
}
if(t.enabled!=e){
t.enabled=e;
var a=t.getItem();
if(a){
a.setEnabled(e)
}}};
DwtSelect.prototype.clearOptions=function(){
var a=this._options.getArray();
for(var t=0;
t<a.length;
++t){
a[t]=null
}
this._options.removeAll();
this._optionValuesToIndices=null;
this._optionValuesToIndices=[];
this._selectedValue=null;
this._selectedOption=null;
this._currentSelectedOption=null;
if(this._pseudoItemsEl){
try{
this._pseudoItemsEl.innerHTML=""
}
catch(o){}}};
DwtSelect.prototype.setName=function(e){
this._name=e
};
DwtSelect.prototype.getName=function(){
return this._name
};
DwtSelect.prototype.setSelectedValue=function(t){
var e=this._optionValuesToIndices[t];
if(e!=null){
this.setSelected(e)
}};
DwtSelect.prototype.setSelected=function(e){
var t=this.getOptionWithHandle(e);
this.setSelectedOption(t)
};
DwtSelect.prototype.getOptionCount=function(){
return this._options.size()
};
DwtSelect.prototype.getOptions=function(){
return this._options
};
DwtSelect.prototype.getOptionWithHandle=function(e){
return this._options.get(e)
};
DwtSelect.prototype.getOptionAtIndex=DwtSelect.prototype.getOptionWithHandle;
DwtSelect.prototype.getIndexForValue=function(e){
return this._optionValuesToIndices[e]
};
DwtSelect.prototype.getOptionWithValue=function(a){
var e=this._optionValuesToIndices[a];
var t=null;
if(e!=null){
t=this.getOptionWithHandle(e)
}
return t
};
DwtSelect.prototype.setSelectedOption=function(e){
if(e){
this._setSelectedOption(e)
}};
DwtSelect.prototype.getValue=function(){
return this._selectedValue
};
DwtSelect.prototype.getSelectedOption=function(){
return this._selectedOption
};
DwtSelect.prototype.getSelectedIndex=function(){
return this.getIndexForValue(this.getValue())
};
DwtSelect.prototype.addChangeListener=function(e){
this.addListener(DwtEvent.ONCHANGE,e)
};
DwtSelect.prototype.size=function(){
return this._options.size()
};
DwtSelect.prototype.disable=function(){
this.setEnabled(false)
};
DwtSelect.prototype.enable=function(){
this.setEnabled(true)
};
DwtSelect.prototype.setImage=function(e){
DwtLabel.prototype.setImage.call(this,e)
};
DwtSelect.prototype.setText=function(e){
DwtLabel.prototype.setText.call(this,e)
};
DwtSelect.prototype.dispose=function(){
this._selectEl=null;
if(this._pseudoItemsEl){
this._pseudoItemsEl.outerHTML="";
this._pseudoItemsEl=null
}
this._containerEl=null;
DwtButton.prototype.dispose.call(this);
if(this._internalObjectId){
DwtSelect._unassignId(this._internalObjectId)
}};
DwtSelect._assignId=function(e){
var t=DwtSelect._objectIds.length;
DwtSelect._objectIds[t]=e;
return t
};
DwtSelect._getObjectWithId=function(e){
return DwtSelect._objectIds[e]
};
DwtSelect._unassignId=function(e){
DwtSelect._objectIds[e]=null
};
DwtSelect.prototype.dynamicButtonWidth=function(){
this._isDynamicButtonWidth=true;
this._selectEl.style.width="auto";
this._pseudoItemsEl.style.display="none"
};
DwtSelect.prototype.fixedButtonWidth=function(){
if(this._isDynamicButtonWidth){
return
}
this._pseudoItemsEl.style.display="block";
var t=this._selectEl;
var e=t.offsetWidth;
if(e){
t.style.width=e+"px"
}
this._pseudoItemsEl.style.display="none"
};
DwtSelect.prototype._createHtmlFromTemplate=function(a,o){
var t=DwtSelect._CONTAINER_TEMPLATE;
var e={
id:o.id,selectTemplateId:a||this.TEMPLATE,selectData:o};
DwtButton.prototype._createHtmlFromTemplate.call(this,t,e);
this._selectEl=document.getElementById(o.id+"_select_container");
this._pseudoItemsEl=document.getElementById(o.id+"_pseudoitems_container");
this._pseudoItemsEl.style.display="block";
var i=this._containerEl=this.getHtmlElement();
this._selectEl.className=i.className;
Dwt.addClass(i,"ZSelectAutoSizingContainer");
this.removeAttribute("style");
if(AjxEnv.isIE&&!AjxEnv.isIE9up){
i.style.overflow="hidden"
}
if(this._legendId){
this.setAttribute("aria-labelledby",[this._legendId,this._textEl.id].join(" "))
}};
DwtSelect.prototype._createMenu=function(){
var h=new DwtSelectMenu(this);
var a;
for(var o=0,t=this._options.size();
o<t;
++o){
var n=this._options.get(o);
if(n._hr){
a=new DwtMenuItem({
parent:h,style:DwtMenuItem.SEPARATOR_STYLE}
);
a.setEnabled(false)
}else{
var a=new DwtSelectMenuItem(h,n.id||Dwt.getNextId(h._htmlElId+"_option_"));
var s=n.getImage();
if(s){
a.setImage(s)
}
var r=n.getDisplayValue();
if(r){
a.setText(AjxStringUtil.htmlEncode(r))
}
a.setEnabled(n.enabled);
a.addSelectionListener(new AjxListener(this,this._handleOptionSelection));
a._optionIndex=o
}
a._optionIndex=o;
n.setItem(a)
}
var e=this;
h.addPopupListener(function(){
e.setAttribute("aria-expanded",true)
}
);
h.addPopdownListener(function(){
e.setAttribute("aria-expanded",false);
e.removeAttribute("aria-activedescendant")
}
);
return h
};
DwtSelect.prototype._handleOptionSelection=function(s){
var i=s.item;
var n=i._optionIndex;
var a=this._options.get(n);
var t=this.getValue();
this._setSelectedOption(a);
var e=new Object();
e.selectObj=this;
e.newValue=a.getValue();
e.oldValue=t;
var o=DwtUiEvent.getEvent(s);
o._args=e;
this.notifyListeners(DwtEvent.ONCHANGE,o)
};
DwtSelect.prototype._setSelectedOption=function(t){
var e=t.getSelectedValue()||t.getDisplayValue();
var a=t.getImage();
if(this._selectedOption!=t){
if(e){
this.setText(AjxStringUtil.htmlEncode(e))
}
this.setImage(a);
this._selectedValue=t._value;
this._selectedOption=t
}
this._updateSelection(t);
this.autoResize()
};
DwtSelect.prototype.autoResize=function(){
var e=this.getHtmlElement();
AjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){
var t=document.getElementById(e.id);
if(t){
t.style.width=t.childNodes[0].offsetWidth||"auto"
}}
,200))
};
DwtSelect.prototype._updateSelection=function(e){
var a=this._currentSelectedOption;
if(a){
a.deSelect()
}
this._currentSelectedOption=e;
if(!e){
return
}
e.select();
var t=this.getMenu(true);
if(!t){
return
}
t.setSelectedItem(e.getItem())
};
DwtSelect.prototype.updateRendering=function(){
var e=this.getScrollStyle();
this.setScrollStyle(e==Dwt.VISIBLE?Dwt.CLIP:Dwt.VISIBLE);
var t=function(){
try{
this.setScrollStyle(e)
}
catch(i){}};
var a=new AjxTimedAction(this,t);
AjxTimedAction.scheduleAction(a,4)
};
DwtSelect.prototype._menuAdded=function(e){
this.setAttribute("aria-owns",e._htmlElId)
};
DwtSelect.prototype._menuItemSelected=function(e){
this.setAttribute("aria-activedescendant",e._htmlElId)
};
DwtSelectOptionData=function(o,a,e,t,n,s,i){
if(o==null||a==null){
return null
}
this.value=o;
this.displayValue=a;
this.isSelected=e;
this.selectedValue=t;
this.image=n;
this.extraData=i;
this.id=s||Dwt.getNextId()
};
DwtSelectOption=function(h,o,r,t,s,i,n,l,a,e){
this._value=h;
this._selected=o;
this._displayValue=r;
this._image=i;
this._selectedValue=n;
this._hr=l;
this._extraData=a;
this.id=e;
this._internalObjectId=DwtSelect._assignId(this);
this.enabled=true
};
DwtSelectOption.prototype.toString=function(){
return"DwtSelectOption"
};
DwtSelectOption.prototype.setItem=function(e){
this._menuItem=e
};
DwtSelectOption.prototype.getItem=function(e){
return this._menuItem
};
DwtSelectOption.prototype.getDisplayValue=function(){
return this._displayValue
};
DwtSelectOption.prototype.getImage=function(){
return this._image
};
DwtSelectOption.prototype.getSelectedValue=function(){
return this._selectedValue
};
DwtSelectOption.prototype.getValue=function(){
return this._value
};
DwtSelectOption.prototype.setValue=function(e){
this._value=e
};
DwtSelectOption.prototype.select=function(){
this._selected=true
};
DwtSelectOption.prototype.deSelect=function(){
this._selected=false
};
DwtSelectOption.prototype.isSelected=function(){
return this._selected
};
DwtSelectOption.prototype.getIdentifier=function(){
return this._internalObjectId
};
DwtSelectOption.prototype.getExtraData=function(e){
return this._extraData&&this._extraData[e]
};
DwtSelectMenu=function(e){
DwtMenu.call(this,{
parent:e,style:DwtMenu.DROPDOWN_STYLE,className:"DwtMenu",layout:e._layout,maxRows:e._maxRows,congruent:e._congruent,id:Dwt.getNextId(e.getHTMLElId()+"_Menu_")}
)
};
DwtSelectMenu.prototype=new DwtMenu;
DwtSelectMenu.prototype.constructor=DwtSelectMenu;
DwtSelectMenu.prototype.TEMPLATE="dwt.Widgets#ZSelectMenu";
DwtSelectMenu.prototype.toString=function(){
return"DwtSelectMenu"
};
DwtSelectMenuItem=function(e,t){
DwtMenuItem.call(this,{
parent:e,style:DwtMenuItem.SELECT_STYLE,className:"ZSelectMenuItem",id:t}
)
};
DwtSelectMenuItem.prototype=new DwtMenuItem;
DwtSelectMenuItem.prototype.constructor=DwtSelectMenuItem;
DwtSelectMenuItem.prototype.TEMPLATE="dwt.Widgets#ZSelectMenuItem";
DwtSelectMenuItem.prototype.isDwtSelectMenuItem=true;
DwtSelectMenuItem.prototype.toString=function(){
return"DwtSelectMenuItem"
};
DwtSelectMenuItem.prototype.role="option";
DwtLabel.prototype._textSet=function(e){}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtAlert")){
DwtAlert=function(a,t,e){
if(arguments.length==0){
return
}
t=t||"DwtAlert";
e=e||DwtControl.STATIC_STYLE;
DwtControl.call(this,{
parent:a,className:t,posStyle:e}
);
this._alertStyle=DwtAlert.INFORMATION;
this._createHtml()
};
DwtAlert.prototype=new DwtControl;
DwtAlert.prototype.constructor=DwtAlert;
DwtAlert.INFORMATION=0;
DwtAlert.WARNING=1;
DwtAlert.CRITICAL=2;
DwtAlert.SUCCESS=3;
DwtAlert._ICONS=[AjxImg.getClassForImage("Information_32"),AjxImg.getClassForImage("Warning_32"),AjxImg.getClassForImage("Critical_32"),AjxImg.getClassForImage("Success")];
DwtAlert._CLASSES=["DwtAlertInfo","DwtAlertWarn","DwtAlertCrit","DwtAlertWarn"];
DwtAlert._RE_ICONS=new RegExp(DwtAlert._ICONS.join("|"));
DwtAlert._RE_CLASSES=new RegExp(DwtAlert._CLASSES.join("|"));
DwtAlert.prototype.TEMPLATE="dwt.Widgets#DwtAlert";
DwtAlert.prototype.setStyle=function(e){
this._alertStyle=e||DwtAlert.INFORMATION;
if(this._iconDiv){
Dwt.delClass(this._iconDiv,DwtAlert._RE_ICONS,DwtAlert._ICONS[this._alertStyle])
}
Dwt.delClass(this.getHtmlElement(),DwtAlert._RE_CLASSES,DwtAlert._CLASSES[this._alertStyle])
};
DwtAlert.prototype.getStyle=function(){
return this._alertStyle
};
DwtAlert.prototype.setIconVisible=function(e){
if(this._iconDiv){
Dwt.setVisible(this._iconDiv,e)
}};
DwtAlert.prototype.getIconVisible=function(){
return this._iconDiv?Dwt.getVisible(this._iconDiv):false
};
DwtAlert.prototype.setTitle=function(e){
this._alertTitle=e;
if(this._titleDiv){
this._titleDiv.innerHTML=e||""
}};
DwtAlert.prototype.getTitle=function(){
return this._alertTitle
};
DwtAlert.prototype.setContent=function(e){
this._alertContent=e;
if(this._contentDiv){
this._contentDiv.innerHTML=e||""
}};
DwtAlert.prototype.getContent=function(){
return this._alertContent
};
DwtAlert.prototype.setDismissContent=function(e){
if(this._dismissDiv){
e.reparentHtmlElement(this._dismissDiv.id)
}};
DwtAlert.prototype.getTabGroupMember=function(){
return null
};
DwtAlert.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtAlert.prototype._createHtmlFromTemplate=function(e,t){
DwtControl.prototype._createHtmlFromTemplate.apply(this,arguments);
this._iconDiv=document.getElementById(t.id+"_icon");
this._titleDiv=document.getElementById(t.id+"_title");
this._contentDiv=document.getElementById(t.id+"_content");
this._dismissDiv=document.getElementById(t.id+"_dismiss")
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtText")){
DwtText=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtText.PARAMS);
e.className=e.className||"DwtText";
if(Dwt.hasClass(e,"FakeAnchor")){
this.role="link"
}
DwtControl.call(this,e);
this.noTab=true
};
DwtText.PARAMS=["parent","className","posStyle"];
DwtText.prototype=new DwtControl;
DwtText.prototype.constructor=DwtText;
DwtText.prototype.isDwtText=true;
DwtText.prototype.toString=function(){
return"DwtText"
};
DwtText.prototype.setText=function(a){
this.noTab=!a;
if(!this._textNode){
this._textNode=document.createTextNode(a);
this.getHtmlElement().appendChild(this._textNode)
}else{
try{
this._textNode.data=a
}
catch(t){}}
this.setAttribute("aria-label",a)
};
DwtText.prototype.getText=function(){
return this._textNode?this._textNode.data:""
};
DwtText.prototype.getTextNode=function(){
return this._textNode
};
DwtText.prototype._focus=function(){
this.setDisplayState(DwtControl.FOCUSED)
};
DwtText.prototype._blur=function(){
this.setDisplayState(DwtControl.NORMAL)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtIframe")){
DwtIframe=function(i){
i.posStyle=i.posStyle||DwtControl.STATIC_STYLE;
i.className=i.className||"DwtIframe";
DwtControl.call(this,i);
this._styles=i.styles;
this._noscroll=i.noscroll;
this._iframeID=i.id?DwtId.getIframeId(i.id):Dwt.getNextId();
this._onLoadHandler=i.onload;
this._processHtmlCallback=i.processHtmlCallback;
this._hidden=i.hidden;
this._title=i.title;
if(!this._createFrame(i.html)){
this.initFailed=true;
return
}
if(i.useKbMgmt){
var t=this.getIframe();
var e=Dwt.getIframeDoc(t);
var a=AjxEnv.isIE?e:t.contentWindow;
Dwt.setHandler(a,DwtEvent.ONKEYDOWN,DwtKeyboardMgr.__keyDownHdlr);
Dwt.setHandler(a,DwtEvent.ONKEYUP,DwtKeyboardMgr.__keyUpHdlr);
Dwt.setHandler(a,DwtEvent.ONKEYPRESS,DwtKeyboardMgr.__keyPressHdlr)
}};
DwtIframe.prototype=new DwtControl;
DwtIframe.prototype.constructor=DwtIframe;
DwtIframe.prototype.isDwtIframe=true;
DwtIframe.prototype.toString=function(){
return"DwtIframe"
};
DwtIframe.prototype.getIframe=function(){
return document.getElementById(this._iframeID)
};
DwtIframe.prototype.getInputElement=function(){
return this.getIframe()
};
DwtIframe.prototype.getDocument=function(){
return this.getIframe().contentWindow.document
};
DwtIframe.prototype._rawEventHandler=function(s){
var a=this.getIframe();
var i=a.contentWindow;
if(AjxEnv.isIE){
s=i.event
}
var e;
if(/mouse|context|click|select/i.test(s.type)){
e=new DwtMouseEvent(true)
}else{
e=new DwtUiEvent(true)
}
e.setFromDhtmlEvent(s);
if(s.type=="mousedown"||s.type=="mousewheel"){
DwtOutsideMouseEventMgr.forwardEvent(s)
}
var o=e.type.toLowerCase();
if(!/^on/.test(o)){
o="on"+o
}
var n=this.getLocation();
if(!AjxEnv.isIE){
var r=i.document;
var t=r.documentElement.scrollLeft||(r.body?r.body.scrollLeft:0);
var c=r.documentElement.scrollTop||(r.body?r.body.scrollTop:0);
n.x-=t;
n.y-=c
}
e.docX+=n.x;
e.docY+=n.y;
e.elementX+=n.x;
e.elementY+=n.y;
var l=DwtMouseEventCapture.getCaptureObj();
l=l&&e.button!=DwtMouseEvent.RIGHT;
if(AjxEnv.isIE||!l){
if(o===DwtEvent.ONFOCUS||o===DwtEvent.ONBLUR){
DwtControl.__HANDLER[o].call(null,e,o,this.parent)
}else{
DwtEventManager.notifyListeners(o,e);
this.parent.notifyListeners(o,e)
}}else{
var h=document.createEvent("MouseEvents");
h.initMouseEvent(s.type,true,true,document.defaultView,0,s.screenX,s.screenY,e.docX,e.docY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget);
document.body.dispatchEvent(h)
}
e.setToDhtmlEvent(s);
return e._returnValue
};
DwtIframe._forwardEvents=[DwtEvent.ONCHANGE,DwtEvent.ONCLICK,DwtEvent.ONCONTEXTMENU,DwtEvent.ONDBLCLICK,DwtEvent.ONFOCUS,DwtEvent.ONKEYDOWN,DwtEvent.ONKEYPRESS,DwtEvent.ONKEYUP,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEOUT,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART];
DwtIframe.prototype._createFrame=function(t){
var e=this.getHTMLElId();
function a(n){
var o=document.getElementById(e);
var i=DwtControl.findControl(o);
return i._rawEventHandler(n)
}
return(function(){
var c,l=[],h=0,o;
var s=document.getElementById(e);
var n=DwtControl.findControl(s);
if(!n){
return false
}
l[h++]="<iframe";
if(n._noscroll){
l[h++]=" scrolling='no'"
}
if(n._hidden){
l[h++]=" style='visibility:hidden'"
}
if(n._title){
l[h++]=" title='"+AjxStringUtil.encodeQuotes(AjxStringUtil.htmlEncode(n._title))+"'"
}
l[h++]=" frameborder='0' width='100%' id='";
l[h++]=n._iframeID;
l[h++]="' name='"+n._iframeID+"'";
if(n._onLoadHandler){
l[h++]=" onload='"+n._onLoadHandler+"'"
}
l[h++]=" src='javascript:\"\";' ></iframe>";
n.setContent(l.join(""));
t=t.replace(/(<style[^>]*>)[\s\t\u00A0]*((.|\n)*?)[\s\t\u00A0]*<\x2fstyle>/mgi,function(i,m,u){
return m+u.replace(/@import.*?(;|[\s\t\u00A0]*$)/gi,"")+"</style>"
}
);
t=AjxStringUtil.checkForCleanHtml(t,ZmMailMsgView.TRUSTED_TAGS,ZmMailMsgView.UNTRUSTED_ATTRS).html;
c=n.getIframe();
o=Dwt.getIframeDoc(c);
o.open();
if(n._styles){
o.write(["<style type='text/css'>",n._styles,"</style>"].join(""))
}
o.write(t);
o.close();
if(n._processHtmlCallback){
n._processHtmlCallback.run(o)
}
l=o.documentElement.style;
l.margin=l.padding="0";
if(o.body){
o.body.style.margin="0"
}
var d=o.firstChild&&o.firstChild.tagName&&o.firstChild.tagName.toLowerCase()==="html"?o.firstChild:null,r=d&&d.getAttribute("lang");
if(d&&!r){
d.setAttribute("lang",window.appLang)
}
l=DwtIframe._forwardEvents;
if(!AjxEnv.isIE){
o=c.contentWindow
}
for(h=l.length;
--h>=0;
){
o[l[h]]=a
}
return true
}
)()
};
DwtIframe.prototype._resetEventHandlers=function(){
var e=this;
function t(a){
return e._rawEventHandler(a)
}
(function(){
var s,n=[],o=0,a;
s=e.getIframe();
a=Dwt.getIframeDoc(s);
n=DwtIframe._forwardEvents;
if(!AjxEnv.isIE){
a=s.contentWindow
}
for(o=n.length;
--o>=0;
){
a[n[o]]=t
}}
)()
};
DwtIframe.prototype.setSrc=function(t){
t=t||'javascript:"";';
var e=this.getIframe();
e.src=t
};
DwtIframe.prototype.setIframeContent=function(e){
var t=this.getDocument();
if(t.body){
t.body.innerHTML=e
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtPropertySheet")){
DwtPropertySheet=function(o,i,a,e){
if(arguments.length==0){
return
}
i=i||"DwtPropertySheet";
DwtComposite.call(this,{
parent:o,className:i,posStyle:a}
);
this._labelSide=e||DwtPropertySheet.DEFAULT;
this._propertyIdCount=0;
this._propertyList=[];
this._propertyMap={};
this._tabGroup=new DwtTabGroup(this.toString());
this._tableEl=document.createElement("TABLE");
this._tableEl.cellSpacing=6;
var t=this.getHtmlElement();
t.appendChild(this._tableEl);
this._setAllowSelection()
};
DwtPropertySheet.prototype=new DwtComposite;
DwtPropertySheet.prototype.constructor=DwtPropertySheet;
DwtPropertySheet.prototype.toString=function(){
return"DwtPropertySheet"
};
DwtPropertySheet.RIGHT="right";
DwtPropertySheet.LEFT="left";
DwtPropertySheet.DEFAULT=DwtPropertySheet.LEFT;
DwtPropertySheet.prototype._labelCssClass="Label";
DwtPropertySheet.prototype._valueCssClass="Field";
DwtPropertySheet.prototype.addProperty=function(s,r,n){
var o=this._tableEl.rows.length;
var l=this._tableEl.insertRow(-1);
l.vAlign=this._vAlign?this._vAlign:"top";
var e=Dwt.getNextId(),a=Dwt.getNextId(),i;
if(this._labelSide==DwtPropertySheet.LEFT){
this._insertLabel(l,s,n,e,a);
i=this._insertValue(l,r,n,e,a)
}else{
this._insertValue(l,r,n,e,a);
i=this._insertLabel(l,s,n,e,a)
}
var t=this._propertyIdCount++;
var h={
id:t,index:o,row:l,visible:true,labelId:e,valueId:a,tabValue:i};
this._propertyList.push(h);
this._propertyMap[t]=h;
return t
};
DwtPropertySheet.prototype._insertLabel=function(s,t,n,o,e){
var i=s.insertCell(-1);
i.className=this._labelCssClass;
i.id=o;
i.setAttribute("for",e);
if(this._labelSide!=DwtPropertySheet.LEFT){
i.width="100%";
i.style.textAlign="left"
}
i.innerHTML=t;
if(n){
var a=this._tableEl.ownerDocument.createElement("SUP");
a.innerHTML="*";
i.insertBefore(a,i.firstChild)
}};
DwtPropertySheet.prototype._insertValue=function(s,i,n,o,e){
var a=s.insertCell(-1);
a.className=this._valueCssClass;
a.id=e;
if(!i){
a.innerHTML="&nbsp;"
}else{
if(i.isDwtControl){
a.appendChild(i.getHtmlElement());
this._tabGroup.addMember(i);
var t=i.getInputElement&&i.getInputElement();
if(t){
t.setAttribute("aria-labelledby",o)
}}else{
if(i.nodeType==AjxUtil.ELEMENT_NODE){
a.appendChild(i);
this._addTabGroupMemberEl(a);
i.setAttribute("aria-labelledby",o)
}else{
a.innerHTML=String(i);
this._addTabGroupMemberEl(a);
a.setAttribute("aria-labelledby",o);
i=a
}}}
return i
};
DwtPropertySheet.prototype._addTabGroupMemberEl=function(a,t){
var i=this;
function e(o){
if(o.children.length>0){
AjxUtil.foreach(o.children,function(n){
e(n)
}
)
}else{
if(AjxUtil.isBoolean(t)){
i.noTab=!t
}else{
i._makeFocusable(o);
i._tabGroup.addMember(o)
}}}
e(a,t)
};
DwtPropertySheet.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtPropertySheet.prototype.getProperty=function(e){
return this._propertyMap[e]
};
DwtPropertySheet.prototype.removeProperty=function(s){
var n=this._propertyMap[s];
if(n){
var t=n.index;
if(n.visible){
var o=this.__getTableIndex(t);
var a=this._tableEl.rows[o];
a.parentNode.removeChild(a)
}
n.row=null;
for(var e=t+1;
e<this._propertyList.length;
e++){
this._propertyList[e].index--
}
this._propertyList.splice(t,1);
delete this._propertyMap[s]
}};
DwtPropertySheet.prototype.setPropertyVisible=function(i,t){
var a=this._propertyMap[i];
if(a&&a.visible!==t){
a.visible=t;
Dwt.setVisible(this._tableEl.rows[a.index],t);
var e=a.tabValue;
if(e.isDwtControl){
e.noTab=!t
}else{
this._addTabGroupMemberEl(e,!t)
}}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtGrouper")){
DwtGrouper=function(i,a,t){
if(arguments.length==0){
return
}
a=a||"DwtGrouper";
t=t||DwtControl.STATIC_STYLE;
DwtComposite.call(this,{
parent:i,posStyle:t}
);
this._labelEl=document.createElement("LEGEND");
this._labelEl.id=Dwt.getNextId();
this._insetEl=document.createElement("DIV");
this._borderEl=document.createElement("FIELDSET");
this._borderEl.appendChild(this._labelEl);
this._borderEl.appendChild(this._insetEl);
this._tabGroup=new DwtTabGroup(this.toString());
var e=this.getHtmlElement();
e.appendChild(this._borderEl)
};
DwtGrouper.prototype=new DwtComposite;
DwtGrouper.prototype.constructor=DwtGrouper;
DwtGrouper.prototype.setLabel=function(e){
Dwt.setVisible(this._labelEl,Boolean(e));
this._labelEl.style.display="";
this._labelEl.innerHTML=e?e:""
};
DwtGrouper.prototype.setContent=function(o){
var t=this._insetEl;
t.innerHTML=o;
var a=t.getElementsByTagName("input");
for(var e=0;
e<a.length;
e++){
this._tabGroup.addMember(a[e])
}};
DwtGrouper.prototype.setElement=function(t){
var e=this._insetEl;
Dwt.removeChildren(e);
e.appendChild(t)
};
DwtGrouper.prototype.setView=function(e){
this.setElement(e.getHtmlElement())
};
DwtGrouper.prototype.getInsetHtmlElement=function(){
return this._insetEl
};
DwtGrouper.prototype.getTabGroupMember=function(){
return this._tabGroup
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtProgressBar")){
DwtProgressBar=function(a,t,e){
if(arguments.length==0){
return
}
e=e||DwtControl.STATIC_STYLE;
DwtComposite.call(this,{
parent:a,posStyle:e}
);
this._maxValue=100;
this._value=0;
this._quotabarDiv=null;
this._quotausedDiv=null;
this._progressBgColor=null;
this._progressCssClass="quotaused";
this._wholeBgColor=null;
this._wholeCssClass="quotabar";
this._createHTML()
};
DwtProgressBar.prototype=new DwtComposite;
DwtProgressBar.prototype.constructor=DwtProgressBar;
DwtProgressBar.prototype.setProgressBgColor=function(e){
this._progressBgColor=e
};
DwtProgressBar.prototype.setWholeBgColor=function(e){
this._wholeBgColor=e
};
DwtProgressBar.prototype.setProgressCssClass=function(e){
this._progressCssClass=e
};
DwtProgressBar.prototype.setWholeCssClass=function(e){
this._wholeCssClass=e
};
DwtProgressBar.prototype.setProgressCssStyle=function(e){
this._progressCssStyle=e
};
DwtProgressBar.prototype.setWholeCssStyle=function(e){
this._wholeCssStyle=e
};
DwtProgressBar.prototype.setValue=function(t){
this._value=parseInt(t);
var e;
if(this._value==this._maxValue){
e=100
}else{
e=Math.min(Math.round((this._value/this._maxValue)*100),100)
}
if(isNaN(e)){
e="0"
}
if(!this._quotabarDiv){
this._quotabarDiv=document.createElement("div");
if(this._wholeCssClass){
this._quotabarDiv.className=this._wholeCssClass
}
if(this._wholeBgColor){
this._quotabarDiv.backgroundColor=this._wholeBgColor
}
this._cell.appendChild(this._quotabarDiv)
}
if(!this._quotausedDiv){
this._quotausedDiv=document.createElement("div");
if(this._progressCssClass){
this._quotausedDiv.className=this._progressCssClass
}
if(this._progressBgColor){
this._quotausedDiv.style.backgroundColor=this._progressBgColor
}
this._quotabarDiv.appendChild(this._quotausedDiv)
}
this._quotausedDiv.style.width=e+"%"
};
DwtProgressBar.prototype.setValueByPercent=function(e){
this.setMaxValue(100);
this.setValue(e.replace(/\%/gi,""))
};
DwtProgressBar.prototype.getValue=function(){
return this._value
};
DwtProgressBar.prototype.getMaxValue=function(){
return this._maxValue
};
DwtProgressBar.prototype.setMaxValue=function(e){
this._maxValue=parseInt(e)
};
DwtProgressBar.prototype.setLabel=function(o,t){
var a=document.createTextNode(o);
var e=t?-1:0;
var i=this._row.insertCell(e);
i.appendChild(a)
};
DwtProgressBar.prototype._createHTML=function(){
this._table=document.createElement("table");
this._table.border=this._table.cellpadding=this._table.cellspacing=0;
this._row=this._table.insertRow(-1);
this._cell=this._row.insertCell(-1);
this.getHtmlElement().appendChild(this._table)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtPropertyEditor")){
DwtPropertyEditor=function(o,t,i,a,e){
if(arguments.length>0){
if(!i){
i="DwtPropertyEditor"
}
DwtComposite.call(this,{
parent:o,className:i,posStyle:a,deferred:e}
);
this._useDwtInputField=t!=null?t:true;
this._schema=null;
this._init()
}};
DwtPropertyEditor.MSG_TIMEOUT=4000;
DwtPropertyEditor.MSG={
mustMatch:"This field does not match validators: REGEXP",mustNotMatch:"This field matches anti-validators: REGEXP"};
DwtPropertyEditor.prototype=new DwtComposite;
DwtPropertyEditor.prototype.constructor=DwtPropertyEditor;
DwtPropertyEditor.prototype.toString=function(){
return"DwtPropertyEditor"
};
DwtPropertyEditor.prototype._init=function(){
var t=document.createElement("div");
t.id=this._relDivId=Dwt.getNextId();
t.style.position="relative";
var e=document.createElement("table");
e.id=this._tableId=Dwt.getNextId();
e.cellSpacing=e.cellPadding=0;
e.appendChild(document.createElement("tbody"));
t.appendChild(e);
this.getHtmlElement().appendChild(t);
this.maxLabelWidth=0;
this.maxFieldWidth=0;
this._setMouseEventHdlrs();
this._onMouseDown=new AjxListener(this,this._onMouseDown);
this.addListener(DwtEvent.ONMOUSEDOWN,this._onMouseDown)
};
DwtPropertyEditor.prototype.getRelDiv=function(){
return document.getElementById(this._relDivId)
};
DwtPropertyEditor.prototype.getTable=function(){
return document.getElementById(this._tableId)
};
DwtPropertyEditor.prototype._onMouseDown=function(a){
var i=a.target;
var e=i.tagName.toLowerCase();
if(e=="input"){
a._stopPropagation=false;
a._returnValue=true;
return true
}
if(this._currentInputField&&!this._currentInputField.onblur()){
a._stopPropagation=true;
a._returnValue=false;
return false
}
try{
while(i&&e!="tr"){
i=i.parentNode;
e=i.tagName.toLowerCase()
}
if(i&&i.__msh_doMouseDown){
i.__msh_doMouseDown(a)
}}
catch(t){}};
DwtPropertyEditor.prototype.getProperties=function(){
if(this._currentInputField){
this._currentInputField.onblur()
}
function e(o){
var r={}
,a,s=o.length;
for(var t=0;
t<s;
++t){
a=o[t];
if(a.type=="struct"){
r[a.name]=e(a.children)
}else{
r[a.name]=a.value
}}
return r
}
return e(this._schema)
};
DwtPropertyEditor.prototype.validateData=function(){
var e=true;
function t(s){
var o,r=s.length;
for(var a=0;
a<r;
++a){
o=s[a];
if(o.type=="struct"){
t(o.children)
}else{
if(!o._validate()){
e=false
}}}}
t(this._schema);
return e
};
DwtPropertyEditor.prototype.initProperties=function(a,t){
if(t==null){
this._schema=a;
t=null
}
for(var e=0;
e<a.length;
++e){
this._createProperty(a[e],t)
}};
DwtPropertyEditor.prototype._createProperty=function(e,l){
var t=l?l._level+1:0;
var h=this.getTable().firstChild.appendChild(document.createElement("tr"));
e._parent=l;
e._level=t;
e._rowElId=h.id=Dwt.getNextId();
e._propertyEditor=this;
for(var s in DwtPropertyEditor._prop_functions){
e[s]=DwtPropertyEditor._prop_functions[s]
}
e._init();
h.className="level-"+t;
if(e.visible=="false"){
h.className+=" invisible"
}
if(e.readonly){
h.className+=" readonly"
}
if(e.type!="struct"){
h.className+=" "+e.type;
var a=document.createElement("td");
a.className="label";
if(e.type=="checkboxgroup"){
a.className+=" grouplabel"
}
h.appendChild(a);
var r=AjxStringUtil.htmlEncode(e.label||e.name);
if(e.required){
r+="<span class='DwtPropertyEditor-required'>*</span>"
}
a.innerHTML=r;
var o=document.createElement("td");
o.className="field";
h.appendChild(o);
switch(e.type){
case"boolean":this._createCheckbox(e,o);
break;
case"enum":this._createDropDown(e,o);
break;
case"date":this._createCalendar(e,o);
break;
case"checkboxgroup":this._createCheckBoxGroup(e,o);
break;
default:if(this._useDwtInputField){
this._createInputField(e,o)
}else{
o.innerHTML=e._makeDisplayValue();
h.__msh_doMouseDown=DwtPropertyEditor.simpleClosure(e._edit,e)
}
break
}
e._fieldCellId=o.id=Dwt.getNextId();
if(a.offsetWidth>this.maxLabelWidth){
this.maxLabelWidth=a.offsetWidth
}
if(o.offsetWidth>this.maxFieldWidth){
this.maxFieldWidth=o.offsetWidth
}}else{
var n=document.createElement("td");
n.colSpan=2;
h.appendChild(n);
n.className="label";
h.className+=" expander-collapsed";
n.innerHTML=["<div>",AjxStringUtil.htmlEncode(e.label),"</div>"].join("");
this.initProperties(e.children,e);
h.__msh_doMouseDown=DwtPropertyEditor.simpleClosure(e._toggle,e)
}
if(t>0){
h.style.display="none";
l._hidden=true
}};
DwtPropertyEditor.prototype.setFixedLabelWidth=function(e){
try{
this.getTable().rows[0].cells[0].style.width=(e||this.maxLabelWidth)+"px"
}
catch(t){}};
DwtPropertyEditor.prototype.setFixedFieldWidth=function(e){
try{
this.getTable().rows[0].cells[1].style.width=(e||this.maxFieldWidth)+"px"
}
catch(t){}};
DwtPropertyEditor.prototype._setCurrentMsgDiv=function(e){
this._currentMsgDiv=e;
this._currentMsgDivTimer=setTimeout(DwtPropertyEditor.simpleClosure(this._clearMsgDiv,this),DwtPropertyEditor.MSG_TIMEOUT)
};
DwtPropertyEditor.prototype._clearMsgDiv=function(){
try{
this._stopMsgDivTimer()
}
catch(e){}
var t=this._currentMsgDiv;
if(t){
t.parentNode.removeChild(t);
this._currentMsgDiv=t=null;
this._currentMsgDivTimer=null
}};
DwtPropertyEditor.prototype._stopMsgDivTimer=function(){
if(this._currentMsgDivTimer){
clearTimeout(this._currentMsgDivTimer);
this._currentMsgDivTimer=null
}};
DwtPropertyEditor.prototype.addChild=function(e){
if(!this._currentFieldCell){
DwtComposite.prototype.addChild.call(this,e)
}else{
this._children.add(e);
this._currentFieldCell.appendChild(e.getHtmlElement())
}};
DwtPropertyEditor.prototype._createCheckbox=function(a,t){
var e=document.createElement("input");
e._prop=a;
e.id=a.name;
e.type="checkbox";
if(e.attachEvent){
e.attachEvent("onclick",a._onCheckboxChange)
}else{
if(e.addEventListener){
e.addEventListener("click",a._onCheckboxChange,false)
}}
this._children.add(e);
t.appendChild(e);
if(a.value=="true"){
e.checked=a.value
}};
DwtPropertyEditor.prototype._createCheckBoxGroup=function(e,n){
var t=document.createElement("div");
t._prop=e;
t.id=e.name;
e._checkBox=[];
t.appendChild(document.createTextNode(e.value));
var h=document.createElement("table");
h.id=Dwt.getNextId();
h.border=0;
h.cellSpacing=h.cellPadding=0;
h.appendChild(document.createElement("tbody"));
for(var a=0;
a<e.checkBox.length;
a++){
var s=document.createElement("tr");
var l=document.createElement("td");
l.className="field";
var o=this._createCheckboxForGroup(e,e.checkBox[a],l);
s.appendChild(l);
o._label=e.checkBox[a].label;
var r=document.createElement("td");
r.className="field";
r.appendChild(document.createTextNode(e.checkBox[a].label));
s.appendChild(r);
h.firstChild.appendChild(s);
e._checkBox[a]=o
}
t.appendChild(h);
this._children.add(t);
n.appendChild(t);
return t
};
DwtPropertyEditor.prototype._createCheckboxForGroup=function(e,i,a){
var t=document.createElement("input");
t._prop=e;
t.id=i.name;
t.type="checkbox";
if(i.value=="true"){
t.checked=i.value
}
if(t.attachEvent){
t.attachEvent("onclick",e._onCheckboxGroupChange)
}else{
if(t.addEventListener){
t.addEventListener("click",e._onCheckboxGroupChange,false)
}}
this._children.add(t);
a.appendChild(t);
return t
};
DwtPropertyEditor.prototype._createDropDown=function(r,s){
this._currentFieldCell=s;
var o,n,a=0,t=[],e=r.item;
while(o=e[a]){
t[a++]=new DwtSelectOption(o.value,o.value==r.value,o.label)
}
r._select=n=new DwtSelect({
parent:this,options:t}
);
n.addChangeListener(new AjxListener(r,r._onSelectChange));
n.addListener(DwtEvent.ONMOUSEDOWN,this._onMouseDown);
this._currentFieldCell=null
};
DwtPropertyEditor.prototype._createCalendar=function(n,i){
this._currentFieldCell=i;
var t=new DwtButton({
parent:this}
);
this._currentFieldCell=null;
t.setText(n._makeDisplayValue());
var o=new DwtMenu({
parent:t,style:DwtMenu.CALENDAR_PICKER_STYLE}
);
o.setAssociatedObj(t);
var a=new DwtCalendar({
parent:o}
);
var e=new Date();
e.setTime(n.value);
a.setDate(e);
a.setSize(150,"auto");
a.addSelectionListener(new AjxListener(n,n._onCalendarSelect));
t.setMenu(o);
n._dateButton=t;
n._dateCalendar=a
};
DwtPropertyEditor.DWT_INPUT_FIELD_TYPES={
string:DwtInputField.STRING,password:DwtInputField.PASSWORD,integer:DwtInputField.INTEGER,number:DwtInputField.FLOAT};
DwtPropertyEditor.prototype._createInputField=function(i,a){
this._currentFieldCell=a;
var e=DwtPropertyEditor.DWT_INPUT_FIELD_TYPES[i.type]||DwtInputField.STRING;
var t=new DwtInputField({
parent:this,type:e,initialValue:i.value,maxLen:i.maxLength,rows:i.rows}
);
if(e==DwtInputField.INTEGER||e==DwtInputField.FLOAT){
t.setValidNumberRange(i.minValue||null,i.maxValue||null);
if(i.decimals!=null){
t.setNumberPrecision(i.decimals)
}}
if(e==DwtInputField.STRING||e==DwtInputField.PASSWORD){
t.setValidStringLengths(i.minLength,i.maxLength)
}
if(i.required){
t.setRequired(true)
}
this._currentFieldCell=null;
i._inputField=t;
t.setValue(i.value);
if(i.readonly){
t.setReadOnly(true)
}
t.setValidationCallback(new AjxCallback(i,i._onDwtInputFieldValidated))
};
DwtPropertyEditor._prop_functions={
_init:function(){
this.type!=null||(this.type="string");
this.value!=null||(this.value="");
this._initialVal=this.value;
if(this.type=="date"){
if(!this.value){
this.value=new Date().getTime()
}
if(!this.format){
this.format=AjxDateUtil.getSimpleDateFormat().toPattern()
}}}
,_modified:function(){
return this._initialVal!=this.value
}
,_getRowEl:function(){
return document.getElementById(this._rowElId)
}
,_makeDisplayValue:function(){
var t=this._getValue();
switch(this.type){
case"password":t=t.replace(/./g,"*");
break;
case"date":var e=new Date();
e.setTime(t);
t=AjxDateFormat.format(this.format,e);
break
}
if(t==""){
t="<br />"
}else{
t=AjxStringUtil.htmlEncode(String(t))
}
return t
}
,_display:function(o){
var n=this.children,a=o?"":"none";
if(n){
var e=n.length;
while(--e>=0){
n[e]._getRowEl().style.display=a;
if(!o){
n[e]._display(false)
}}
this._hidden=!o;
var t=this._getRowEl();
t.className=t.className.replace(/expander-[^\s]+/,o?"expander-expanded":"expander-collapsed")
}}
,_toggle:function(){
this._display(this._hidden)
}
,_edit:function(){
if(this.readonly){
return
}
switch(this.type){
case"string":case"number":case"integer":case"password":setTimeout(DwtPropertyEditor.simpleClosure(this._createInputField,this),50);
break
}}
,_createInputField:function(){
var e=this._propertyEditor;
var n=document.getElementById(this._fieldCellId);
var a=e.getRelDiv();
var t=document.createElement("input");
t.className="DwtPropertyEditor-input "+this.type;
t.setAttribute("autocomplete","off");
t.type=this.type=="password"?"password":"text";
var o=n.offsetLeft,i=n.offsetTop;
if(AjxEnv.isGeckoBased){
--o;
--i
}
t.style.left=o+"px";
t.style.top=i+"px";
t.style.width=n.offsetWidth+1+"px";
t.style.height=n.offsetHeight+1+"px";
t.value=this._getValue();
a.appendChild(t);
t.focus();
t.onblur=DwtPropertyEditor.simpleClosure(this._saveInput,this);
t.onkeydown=DwtPropertyEditor.simpleClosure(this._inputKeyPress,this);
this._propertyEditor._currentInputField=this._inputField=t;
if(!AjxEnv.isGeckoBased){
t.select()
}else{
t.setSelectionRange(0,t.value.length)
}}
,_getValue:function(){
return this.value||""
}
,_checkValue:function(a){
var e=a=="";
if(e){
if(!this.required){
return a
}
this._displayMsg(AjxMsg.valueIsRequired);
return null
}
if(this.maxLength!=null&&a.length>this.maxLength){
this._displayMsg(AjxMessageFormat.format(AjxMsg.stringTooLong,this.maxLength));
return null
}
if(this.minLength!=null&&a.length<this.minLength){
this._displayMsg(AjxMessageFormat.format(AjxMsg.stringTooShort,this.minLength));
return null
}
if(this.mustMatch&&!this.mustMatch.test(a)){
this._displayMsg(this.msg_mustMatch||DwtPropertyEditor.MSG.mustMatch.replace(/REGEXP/,this.mustMatch.toString()));
return null
}
if(this.mustNotMatch&&this.mustNotMatch.test(a)){
this._displayMsg(this.msg_mustNotMatch||DwtPropertyEditor.MSG.mustNotMatch.replace(/REGEXP/,this.mustNotMatch.toString()));
return null
}
switch(this.type){
case"integer":case"number":var o=new Number(a);
if(isNaN(o)){
this._displayMsg(AjxMsg.notANumber);
return null
}
if(this.type=="integer"&&Math.round(o)!=o){
this._displayMsg(AjxMsg.notAnInteger);
return null
}
if(this.minValue!=null&&o<this.minValue){
this._displayMsg(AjxMessageFormat.format(AjxMsg.numberLessThanMin,this.minValue));
return null
}
if(this.maxValue!=null&&o>this.maxValue){
this._displayMsg(AjxMessageFormat.format(AjxMsg.numberMoreThanMax,this.maxValue));
return null
}
a=o;
if(this.type=="number"&&this.decimals!=null){
var t=a.toString();
var i=t.indexOf(".");
if(i==-1){
i=t.length
}
a=a.toPrecision(i+this.decimals)
}
break
}
return a
}
,_displayMsg:function(t){
var s,n,r,i;
var o=this._propertyEditor;
var e=o._currentMsgDiv;
if(!e){
e=document.createElement("div");
e.className="DwtPropertyEditor-ErrorMsg";
o.getRelDiv().appendChild(e)
}else{
o._stopMsgDivTimer()
}
e.style.visibility="hidden";
e.innerHTML=AjxStringUtil.htmlEncode(t);
var l=o.getTable();
r=l.offsetWidth;
if(!AjxEnv.isIE){
r-=12
}
s=l.offsetLeft;
e.style.left=s+"px";
e.style.width=r+"px";
i=e.offsetHeight;
var a=document.getElementById(this._fieldCellId);
n=a.offsetTop+a.offsetHeight;
if(n+i>l.offsetTop+l.offsetHeight){
n=a.offsetTop-i
}
e.style.top=n+"px";
e.style.visibility="";
o._setCurrentMsgDiv(e)
}
,_saveInput:function(){
var e=this._inputField;
var t=this._checkValue(e.value);
if(t!=null){
this._setValue(t);
e.onblur=e.onkeyup=e.onkeydown=e.onkeypress=null;
var a=document.getElementById(this._fieldCellId);
a.innerHTML=this._makeDisplayValue();
this._inputField=null;
this._propertyEditor._currentInputField=null;
this._propertyEditor._clearMsgDiv();
e.parentNode.removeChild(e);
return true
}else{
if(e.className.indexOf(" DwtPropertyEditor-input-error")==-1){
e.className+=" DwtPropertyEditor-input-error"
}
e.focus();
return false
}}
,_inputKeyPress:function(t){
t||(t=window.event);
var e=this._inputField;
if(t.keyCode==13){
this._saveInput()
}else{
if(t.keyCode==27){
e.value=this._getValue();
this._saveInput()
}else{
this._propertyEditor._clearMsgDiv();
e.className=e.className.replace(/ DwtPropertyEditor-input-error/,"")
}}}
,_onCheckboxChange:function(t){
t||(t=window.event);
var e=AjxEnv.isIE?t.srcElement:t.target;
e._prop._setValue(e.checked?"true":"false")
}
,_onSelectChange:function(){
this._setValue(this._select.getValue())
}
,_onCheckboxGroupChange:function(o){
o||(o=window.event);
var a=AjxEnv.isIE?o.srcElement:o.target;
var e=a._prop._checkBox;
var n=[];
for(var t=0;
t<e.length;
t++){
if(e[t].checked){
n.push(e[t]._label)
}}
a._prop._setValue(n)
}
,_onCalendarSelect:function(){
this._setValue(this._dateCalendar.getDate().getTime());
this._dateButton.setText(this._makeDisplayValue())
}
,_onDwtInputFieldValidated:function(e,a,t){
if(a){
this._setValue(t)
}}
,_setValue:function(t){
this.value=t;
var e=this._getRowEl();
e.className=e.className.replace(/ dirty/,"");
if(this._modified()){
e.className+=" dirty"
}}
,_validate:function(){
if(this._inputField){
if(this._inputField instanceof DwtInputField){
return this._inputField.validate()
}else{
return this._inputField.onblur()
}}else{
return true
}}};
DwtPropertyEditor.simpleClosure=function(e,t){
return function(){
return e.call(t,arguments[0])
}
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtConfirmDialog")){
DwtConfirmDialog=function(t,e,o,i,a){
if(arguments.length==0){
return
}
if(!i){
i=[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.CANCEL_BUTTON]
}
DwtDialog.call(this,{
parent:t,className:e||"DwtConfirmDialog",title:AjxMsg.confirmTitle,standardButtons:i,id:o,extraButtons:a}
);
this._questionDiv=document.createElement("DIV");
this._questionDiv.className="DwtConfirmDialogQuestion";
this._getContentDiv().appendChild(this._questionDiv);
this.registerCallback(DwtDialog.YES_BUTTON,this._handleYesButton,this);
this.registerCallback(DwtDialog.NO_BUTTON,this._handleNoButton,this);
this.registerCallback(DwtDialog.CANCEL_BUTTON,this._handleCancelButton,this)
};
DwtConfirmDialog.prototype=new DwtDialog;
DwtConfirmDialog.prototype.constructor=DwtConfirmDialog;
DwtConfirmDialog.prototype.toString=function(){
return"DwtConfirmDialog"
};
DwtConfirmDialog.prototype.popup=function(a,e,i,t,o){
this._questionDiv.innerHTML=a||"";
this._yesCallback=e;
this._noCallback=i;
this._cancelCallback=t;
this.setButtonVisible(DwtDialog.CANCEL_BUTTON,Boolean(i));
DwtDialog.prototype.popup.call(this,o)
};
DwtConfirmDialog.prototype.popdown=function(){
this._yesCallback=this._noCallback=this._cancelCallback=null;
DwtDialog.prototype.popdown.call(this)
};
DwtConfirmDialog.prototype._handleYesButton=function(e){
if(this._yesCallback){
this._yesCallback.run(e)
}
this.popdown()
};
DwtConfirmDialog.prototype._handleNoButton=function(e){
if(this._noCallback){
this._noCallback.run(e)
}
this.popdown()
};
DwtConfirmDialog.prototype._handleCancelButton=function(e){
if(this._cancelCallback){
this._cancelCallback.run(e)
}
this.popdown()
};
DwtConfirmDialog.prototype._getSeparatorTemplate=function(){
return""
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtChooser")){
DwtChooser=function(a){
if(arguments.length==0){
return
}
DwtComposite.call(this,a.parent,a.className);
this._slvClassName=a.slvClassName;
this._tlvClassName=a.tlvClassName;
this._layoutStyle=a.layoutStyle?a.layoutStyle:DwtChooser.HORIZ_STYLE;
this._selectStyle=a.selectStyle?a.selectStyle:DwtChooser.MULTI_SELECT;
this._mode=a.listStyle?a.listStyle:DwtChooser.MODE_MOVE;
this._noDuplicates=(a.noDuplicates!==false);
this._singleHeight=a.singleHeight?a.singleHeight:45;
this._listSize=a.listSize;
this._sourceEmptyOk=a.sourceEmptyOk;
this._allButtons=a.allButtons;
this._hasTextField=a.hasTextField;
this._handleButtonInfo(a.buttonInfo);
this._mode=a.mode?a.mode:this._hasMultiButtons?DwtChooser.MODE_COPY:DwtChooser.MODE_MOVE;
this._createHtml();
this._initialize();
var t=a.parent.getSize();
var i=a.listWidth||t.x;
var e=a.listHeight||t.y;
if(i&&e){
this.resize(i,e)
}};
DwtChooser.prototype=new DwtComposite;
DwtChooser.prototype.constructor=DwtChooser;
DwtChooser.prototype.isFocusable=true;
DwtChooser.prototype.role="listbox";
DwtChooser.HORIZ_STYLE=1;
DwtChooser.VERT_STYLE=2;
DwtChooser.SINGLE_SELECT=1;
DwtChooser.MULTI_SELECT=2;
DwtChooser.MODE_COPY=1;
DwtChooser.MODE_MOVE=2;
DwtChooser.REMOVE_BTN_ID="__remove__";
DwtChooser.ADD_ALL_BTN_ID="__addAll__";
DwtChooser.REMOVE_ALL_BTN_ID="__removeAll__";
DwtChooser.prototype.toString=function(){
return"DwtChooser"
};
DwtChooser.prototype.setItems=function(t,e,a){
e=e?e:DwtChooserListView.SOURCE;
this._reset(e);
this.addItems(t,e,true);
this._selectFirst(e);
if(a){
this._reset((e==DwtChooserListView.SOURCE)?DwtChooserListView.TARGET:DwtChooserListView.SOURCE)
}};
DwtChooser.prototype.getItems=function(e){
e=e?e:DwtChooserListView.TARGET;
if(e==DwtChooserListView.SOURCE){
return this.sourceListView.getList().clone()
}else{
if(this._hasMultiButtons){
var a={};
for(var t in this._data){
a[t]=this._data[t].clone()
}
return a
}else{
return this._data[this._buttonInfo[0].id].clone()
}}};
DwtChooser.prototype.addItems=function(t,e,o,r){
e=e?e:DwtChooserListView.SOURCE;
var s=(t instanceof AjxVector)?t.getArray():(t instanceof Array)?t:[t];
if(e==DwtChooserListView.SOURCE){
for(var a=0;
a<s.length;
a++){
this._addToSource(s[a],null,o)
}}else{
var n;
if(this._selectStyle==DwtChooser.SINGLE_SELECT){
this.targetListView._resetList();
s=(s.length>0)?[s[0]]:s
}
for(var a=0;
a<s.length;
a++){
this._addToTarget(s[a],r,o)
}}
if(e==DwtChooserListView.SOURCE){
var s=this.sourceListView.getList();
this._sourceSize=s?s.size():0
}};
DwtChooser.prototype.removeItems=function(o,e,a){
o=(o instanceof AjxVector)?o.getArray():(o instanceof Array)?o:[o];
for(var t=0;
t<o.length;
t++){
(e==DwtChooserListView.SOURCE)?this._removeFromSource(o[t],a):this._removeFromTarget(o[t],a)
}};
DwtChooser.prototype.transfer=function(t,i,e){
i=i?i:this._activeButtonId;
this._setActiveButton(i);
if(this._mode==DwtChooser.MODE_MOVE){
if(this._selectStyle==DwtChooser.SINGLE_SELECT){
var a=this.targetListView.getList();
if(a&&a.size()){
this.remove(a,true)
}}
this.removeItems(t,DwtChooserListView.SOURCE,true)
}
this.addItems(t,DwtChooserListView.TARGET,e);
this.sourceListView.deselectAll()
};
DwtChooser.prototype.remove=function(o,a){
o=(o instanceof AjxVector)?o.getArray():(o instanceof Array)?o:[o];
if(this._mode==DwtChooser.MODE_MOVE){
for(var t=0;
t<o.length;
t++){
var e=this._getInsertionIndex(this.sourceListView,o[t]);
this.sourceListView.addItem(o[t],e,true)
}
this._sourceSize=o?o.length:0
}
this.removeItems(o,DwtChooserListView.TARGET)
};
DwtChooser.prototype.setSelectStyle=function(i,s){
if(i==this._selectStyle){
return
}
this._selectStyle=i;
if(this._defLabel){
var t=this._button[this._buttonInfo[0].id];
t.setText((i==DwtChooser.SINGLE_SELECT)?AjxMsg.select:AjxMsg.add)
}
if(!s){
var o=this.getSize();
this.resize(o.x,o.y)
}
if(this._allButtons){
this._addAllButton.setVisible(i==DwtChooser.MULTI_SELECT);
this._removeAllButton.setVisible(i==DwtChooser.MULTI_SELECT);
this._enableButtons()
}
if(i==DwtChooser.SINGLE_SELECT){
var n=this.targetListView.getList();
var e=n?n.clone().getArray():null;
if(e&&e.length){
this._reset(DwtChooserListView.TARGET);
this.addItems(e[0],DwtChooserListView.TARGET,true);
this.targetListView.deselectAll();
if(e.length>1&&this._mode==DwtChooser.MODE_MOVE){
this.addItems(e.slice(1),DwtChooserListView.SOURCE,true)
}
this._enableButtons()
}}
this.sourceListView.setMultiSelect(i==DwtChooser.MULTI_SELECT);
this.targetListView.setMultiSelect(i==DwtChooser.MULTI_SELECT)
};
DwtChooser.prototype.reset=function(e){
this._reset(e);
this._setActiveButton(this._buttonInfo[0].id);
this._enableButtons();
if(this._hasTextField){
this._textField.setValue("")
}};
DwtChooser.prototype._reset=function(e){
if(!e||e==DwtChooserListView.SOURCE){
this.sourceListView._resetList()
}
if(!e||e==DwtChooserListView.TARGET){
this.targetListView._resetList();
for(var t in this._data){
this._data[t].removeAll()
}}};
DwtChooser.prototype.addStateChangeListener=function(e){
this.targetListView.addStateChangeListener(e)
};
DwtChooser.prototype.removeStateChangeListener=function(e){
this.targetListView.removeStateChangeListener(e)
};
DwtChooser.prototype.getSourceListView=function(){
return document.getElementById(this._sourceListViewDivId)
};
DwtChooser.prototype.getButtons=function(){
return document.getElementById(this._buttonsDivId)
};
DwtChooser.prototype.getTargetListView=function(){
return document.getElementById(this._targetListViewDivId)
};
DwtChooser.prototype.getTextField=function(){
return this._textField
};
DwtChooser.prototype._createHtml=function(){
this._sourceListViewDivId=Dwt.getNextId();
this._targetListViewDivId=Dwt.getNextId();
this._buttonsDivId=Dwt.getNextId();
this._removeButtonDivId=Dwt.getNextId();
if(this._allButtons){
this._addAllButtonDivId=Dwt.getNextId();
this._removeAllButtonDivId=Dwt.getNextId()
}
if(this._hasTextField){
this._textFieldTdId=Dwt.getNextId()
}
var a=[];
var e=0;
if(this._layoutStyle==DwtChooser.HORIZ_STYLE){
a[e++]="<table>";
a[e++]="<tr>";
a[e++]="<td id='";
a[e++]=this._sourceListViewDivId;
a[e++]="'></td>";
a[e++]="<td valign='middle' id='";
a[e++]=this._buttonsDivId;
a[e++]="'>";
if(this._allButtons){
a[e++]="<div id='";
a[e++]=this._addAllButtonDivId;
a[e++]="'></div><br>"
}
for(var t=0;
t<this._buttonInfo.length;
t++){
var o=this._buttonInfo[t].id;
a[e++]="<div id='";
a[e++]=this._buttonDivId[o];
a[e++]="'></div><br>"
}
a[e++]="<br><div id='";
a[e++]=this._removeButtonDivId;
a[e++]="'></div>";
if(this._allButtons){
a[e++]="<br><div id='";
a[e++]=this._removeAllButtonDivId;
a[e++]="'></div><br>"
}
a[e++]="</td>";
a[e++]="<td id='";
a[e++]=this._targetListViewDivId;
a[e++]="'></td>";
a[e++]="</tr>";
if(this._hasTextField){
a[e++]="<tr><td>";
a[e++]="<table width=100%><tr><td style='white-space:nowrap; width:1%'>";
a[e++]=AjxMsg.add;
a[e++]=":</td><td id='";
a[e++]=this._textFieldTdId;
a[e++]="'></td></tr></table>";
a[e++]="</td><td>&nbsp;</td><td>&nbsp;</td></tr>"
}
a[e++]="</table>"
}else{
a[e++]="<div id='";
a[e++]=this._sourceListViewDivId;
a[e++]="'></div>";
a[e++]="<div align='center' id='";
a[e++]=this._buttonsDivId;
a[e++]="'>";
a[e++]="<table class='ZPropertySheet' cellspacing='6'><tr>";
if(this._allButtons){
a[e++]="<td id='";
a[e++]=this._addAllButtonDivId;
a[e++]="'></td>"
}
for(var t=0;
t<this._buttonInfo.length;
t++){
var o=this._buttonInfo[t].id;
a[e++]="<td id='";
a[e++]=this._buttonDivId[o];
a[e++]="'></td>"
}
a[e++]="<td id='";
a[e++]=this._removeButtonDivId;
a[e++]="'></td>";
if(this._allButtons){
a[e++]="<td id='";
a[e++]=this._removeAllButtonDivId;
a[e++]="'></td>"
}
a[e++]="</tr></table></div>";
a[e++]="<div id='";
a[e++]=this._targetListViewDivId;
a[e++]="'></div>"
}
this.getHtmlElement().innerHTML=a.join("")
};
DwtChooser.prototype._handleButtonInfo=function(t){
if(!t){
this._defLabel=(this._selectStyle==DwtChooser.SINGLE_SELECT)?AjxMsg.select:AjxMsg.add;
t=[{
label:this._defLabel}
]
}
this._buttonInfo=t;
this._buttonDivId={};
this._buttonId={};
if(this._buttonInfo.length==1){
if(!this._buttonInfo[0].id){
this._buttonInfo[0].id=Dwt.getNextId("DwtChooserButtonInfo_")
}
this._activeButtonId=this._buttonInfo[0].id
}
for(var e=0;
e<this._buttonInfo.length;
e++){
var a=this._buttonInfo[e].id;
this._buttonDivId[a]=Dwt.getNextId("DwtChooserButtonDiv_");
this._buttonId[a]=Dwt.getNextId("DwtChooserButton_")
}
this._hasMultiButtons=(this._buttonInfo.length>1)
};
DwtChooser.prototype._initialize=function(){
var e=new AjxListener(this,this._transferButtonListener);
this._button={};
this._buttonIndex={};
this._data={};
for(var t=0;
t<this._buttonInfo.length;
t++){
var o=this._buttonInfo[t].id;
this._button[o]=this._setupButton(o,this._buttonId[o],this._buttonDivId[o],this._buttonInfo[t].label);
this._button[o].addSelectionListener(e);
this._buttonIndex[o]=t;
this._data[o]=new AjxVector()
}
this.sourceListView=this._createSourceListView();
this._addListView(this.sourceListView,this._sourceListViewDivId);
this.sourceListView.addSelectionListener(new AjxListener(this,this._sourceListener));
this.targetListView=this._createTargetListView();
this._addListView(this.targetListView,this._targetListViewDivId);
this.targetListView.addSelectionListener(new AjxListener(this,this._targetListener));
this._removeButtonId=Dwt.getNextId("DwtChooserRemoveButton_");
this._removeButton=this._setupButton(DwtChooser.REMOVE_BTN_ID,this._removeButtonId,this._removeButtonDivId,AjxMsg.remove);
this._removeButton.addSelectionListener(new AjxListener(this,this._removeButtonListener));
if(this._allButtons){
this._addAllButtonId=Dwt.getNextId();
this._addAllButton=this._setupButton(DwtChooser.ADD_ALL_BTN_ID,this._addAllButtonId,this._addAllButtonDivId,AjxMsg.addAll);
this._addAllButton.addSelectionListener(new AjxListener(this,this._addAllButtonListener));
this._removeAllButtonId=Dwt.getNextId();
this._removeAllButton=this._setupButton(DwtChooser.REMOVE_ALL_BTN_ID,this._removeAllButtonId,this._removeAllButtonDivId,AjxMsg.removeAll);
this._removeAllButton.addSelectionListener(new AjxListener(this,this._removeAllButtonListener));
if(this._selectStyle==DwtChooser.SINGLE_SELECT){
this._addAllButton.setVisible(false);
this._removeAllButton.setVisible(false)
}}
if(this._hasTextField){
var a={
parent:this,type:DwtInputField.STRING};
this._textField=new DwtInputField(a);
this._textField.reparentHtmlElement(this._textFieldTdId);
this._textField._chooser=this;
this._textField.setHandler(DwtEvent.ONKEYUP,DwtChooser._onKeyUp);
Dwt.setSize(this._textField.getInputElement(),"100%",Dwt.DEFAULT)
}
if(this._selectStyle==DwtChooser.SINGLE_SELECT){
this.sourceListView.setMultiSelect(false);
this.targetListView.setMultiSelect(false)
}};
DwtChooser.prototype.getTabGroupMember=function(){
var t=new DwtTabGroup(this.toString());
t.addMember(this.sourceListView);
for(var e=0;
e<this._buttonInfo.length;
e++){
t.addMember(this._button[this._buttonInfo[e].id])
}
t.addMember(this._removeButton);
if(this._addAllButton){
t.addMember(this._addAllButton);
t.addMember(this._removeAllButton)
}
if(this._hasTextField){
t.addMember(this._textField)
}
t.addMember(this.targetListView);
return t
};
DwtChooser.prototype._createSourceListView=function(){
return new DwtChooserListView(this,DwtChooserListView.SOURCE,this._slvClassName)
};
DwtChooser.prototype._createTargetListView=function(){
return new DwtChooserListView(this,DwtChooserListView.TARGET,this._tlvClassName)
};
DwtChooser.prototype._addListView=function(t,a){
var e=document.getElementById(a);
e.appendChild(t.getHtmlElement());
t.setUI(null,true);
t._initialized=true
};
DwtChooser.prototype.resize=function(o,e){
if(!o||!e){
return
}
if(o==Dwt.DEFAULT&&e==Dwt.DEFAULT){
return
}
var a=document.getElementById(this._buttonsDivId);
var s=Dwt.getSize(a);
var t,i,n;
if(this._layoutStyle==DwtChooser.HORIZ_STYLE){
t=this._listSize?this._listSize:(o==Dwt.DEFAULT)?o:Math.floor(((o-s.x)/2)-12);
i=n=e
}else{
t=o;
if(this._selectStyle==DwtChooser.SINGLE_SELECT){
i=this._listSize?this._listSize:(e==Dwt.DEFAULT)?e:e-s.y-this._singleHeight-30;
n=(e==Dwt.DEFAULT)?e:e-s.y-i-30
}else{
i=n=this._listSize?this._listSize:(e==Dwt.DEFAULT)?e:Math.floor(((e-s.y)/2)-12)
}}
this.sourceListView.setSize((t==Dwt.DEFAULT)?t:t+2,i);
this.targetListView.setSize((t==Dwt.DEFAULT)?t:t+2,n)
};
DwtChooser.prototype._setupButton=function(n,a,o,e){
var t=new DwtButton({
parent:this,id:a}
);
t.setText(e);
t.id=a;
t._buttonId=n;
var i=document.getElementById(o);
i.appendChild(t.getHtmlElement());
return t
};
DwtChooser.prototype._sourceListener=function(e){
if(e.detail==DwtListView.ITEM_DBL_CLICKED){
this.transfer(this.sourceListView.getSelection(),this._activeButtonId);
this.sourceListView.deselectAll()
}else{
if(this._activeButtonId==DwtChooser.REMOVE_BTN_ID){
var t=this._lastActiveTransferButtonId?this._lastActiveTransferButtonId:this._buttonInfo[0].id;
this._setActiveButton(t)
}}
this.targetListView.deselectAll();
this._enableButtons()
};
DwtChooser.prototype._targetListener=function(e){
if(e.detail==DwtListView.ITEM_DBL_CLICKED){
this.remove(this.targetListView.getSelection())
}else{
this._setActiveButton(DwtChooser.REMOVE_BTN_ID);
this.sourceListView.deselectAll();
this._enableButtons()
}};
DwtChooser.prototype._transferButtonListener=function(a){
var t=DwtControl.getTargetControl(a);
var o=t._buttonId;
var i=this.sourceListView.getSelection();
if(i&&i.length){
this.transfer(i,o);
this._enableButtons()
}else{
var e=this._getEmailFromText();
if(e){
this.transfer([e],o)
}else{
this._setActiveButton(o)
}}};
DwtChooser.prototype._removeButtonListener=function(e){
this.remove(this.targetListView.getSelection());
var t=this.targetListView.getList();
if(t&&t.size()){
this._selectFirst(DwtChooserListView.TARGET)
}else{
this._enableButtons()
}};
DwtChooser.prototype._addAllButtonListener=function(e){
this.transfer(this.sourceListView.getList().clone());
this._selectFirst(DwtChooserListView.TARGET)
};
DwtChooser.prototype._removeAllButtonListener=function(e){
this.remove(this.targetListView.getList().clone());
this._selectFirst(DwtChooserListView.SOURCE)
};
DwtChooser.prototype._enableButtons=function(a,r){
var h=this.sourceListView.getList();
var c=this.targetListView.getList();
var o=(a||(this.sourceListView.getSelectionCount()>0));
for(var s=0;
s<this._buttonInfo.length;
s++){
var t=this._buttonInfo[s].id;
this._button[t].setEnabled(o)
}
var l=(r||(this.targetListView.getSelectionCount()>0));
this._removeButton.setEnabled(l);
if(this._allButtons&&(this._selectStyle==DwtChooser.MULTI_SELECT)){
var e=h?h.size():0;
var n=c?c.size():0;
this._addAllButton.setEnabled(e>0);
this._removeAllButton.setEnabled(n>0)
}};
DwtChooser.prototype._selectFirst=function(t,a){
var e=(t==DwtChooserListView.SOURCE)?this.sourceListView:this.targetListView;
var i=e.getList();
if(i&&i.size()>0){
e.setSelection(i.get(0))
}};
DwtChooser.prototype._setActiveButton=function(i){
if(!this._hasMultiButtons){
return
}
if(i!=this._activeButtonId){
var a=(this._activeButtonId==DwtChooser.REMOVE_BTN_ID)?this._removeButtonId:this._buttonId[this._activeButtonId];
if(a){
var e=DwtControl.findControl(document.getElementById(a));
if(e){
e.setDisplayState(DwtControl.NORMAL)
}}
a=(i==DwtChooser.REMOVE_BTN_ID)?this._removeButtonId:this._buttonId[i];
var t=DwtControl.findControl(document.getElementById(a));
if(t){
t.setDisplayState(DwtControl.DEFAULT)
}
this._activeButtonId=i;
if(i!=DwtChooser.REMOVE_BTN_ID){
this._lastActiveTransferButtonId=i
}}};
DwtChooser.prototype._isDuplicate=function(e,t){
return t.contains(e)
};
DwtChooser.prototype._addToSource=function(a,e,t){
if(!a){
return
}
if(!a._chooserIndex){
var i=this.sourceListView.getList();
a._chooserIndex=i?i.size()+1:1
}
this.sourceListView.addItem(a,e,t)
};
DwtChooser.prototype._addToTarget=function(l,e,s){
if(!l){
return
}
e=e?e:this._activeButtonId;
if(this._noDuplicates&&this._data[e]&&this._isDuplicate(l,this._data[e])){
return
}
var n=this.targetListView.getList();
if(n&&n.contains(l)&&l.clone){
var a=l.clone();
a.id=Dwt.getNextId();
l=a
}
var r=null;
if(this._hasMultiButtons){
n=[];
for(var t=0;
t<this._buttonInfo.length;
t++){
n=n.concat(this._data[this._buttonInfo[t].id].getArray())
}
var o=this._buttonIndex[e];
for(r=0;
r<n.length;
r++){
var h=this._buttonIndex[n[r]._buttonId];
if(h>o){
break
}}}
l._buttonId=e;
l.id=l.id||Dwt.getNextId();
this._data[e].add(l);
this.targetListView.addItem(l,r,s)
};
DwtChooser.prototype._removeFromSource=function(t,e){
if(!t){
return
}
var a=this.sourceListView.getList();
if(!a){
return
}
if(!a.contains(t)){
return
}
this.sourceListView.removeItem(t,e)
};
DwtChooser.prototype._removeFromTarget=function(t,e){
if(!t){
return
}
var a=this.targetListView.getList();
if(!a){
return
}
if(!a.contains(t)){
return
}
this._data[t._buttonId].remove(t);
this.targetListView.removeItem(t,e)
};
DwtChooser.prototype._getInsertionIndex=function(t,n){
var s=t.getList();
if(!s){
return null
}
var e=s.getArray();
for(var o=0;
o<e.length;
o++){
if(n._chooserIndex&&e[o]._chooserIndex&&(e[o]._chooserIndex>=n._chooserIndex)){
return o
}}
return null
};
DwtChooser.prototype._getEmailFromText=function(){
if(this._hasTextField){
var t=this._textField.getValue();
var e=AjxEmailAddress.parse(t);
if(e){
e.id=Dwt.getNextId();
return e
}}};
DwtChooser._onKeyUp=function(o){
var a=DwtUiEvent.getTarget(o);
var n=DwtControl.findControl(a);
var i=n._chooser;
var t=DwtKeyEvent.getCharCode(o);
if(DwtKeyEvent.IS_RETURN[t]){
var e=i._getEmailFromText();
if(e){
i.transfer([e],i._activeButtonId);
a.value=""
}}
i._enableButtons(a.value.length)
};
DwtChooserListView=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtChooserListView.PARAMS);
e.className=e.className||"DwtChooserListView";
e.headerList=this._getHeaderList(parent);
DwtListView.call(this,e);
this.type=e.type;
this._chooserParent=e.parent.parent;
this._dragSrc=new DwtDragSource(Dwt.DND_DROP_MOVE);
this.setDragSource(this._dragSrc)
};
DwtChooserListView.PARAMS=["parent","type","className","view"];
DwtChooserListView.SOURCE=1;
DwtChooserListView.TARGET=2;
DwtChooserListView.prototype=new DwtListView;
DwtChooserListView.prototype.constructor=DwtChooserListView;
DwtChooserListView.prototype._getHeaderList=function(){};
DwtChooserListView.prototype.toString=function(){
return"DwtChooserListView"
};
DwtChooserListView.prototype.setUI=function(t,e){
e=e?e:((this.type==DwtChooserListView.TARGET)||this.parent._sourceEmptyOk);
DwtListView.prototype.setUI.call(this,t,e)
};
DwtChooserListView.prototype._itemClicked=function(e,t){
if(!t.shiftKey&&!t.ctrlKey&&t.button==DwtMouseEvent.RIGHT){
return
}else{
DwtListView.prototype._itemClicked.call(this,e,t)
}};
DwtChooserListView.prototype._sortColumn=function(t,e){
this._chooserParent.search(t,e)
};
DwtChooserListView.prototype._getHeaderSashLocation=function(){
var t=this.getHtmlElement();
if(Dwt.getPosition(t)==Dwt.ABSOLUTE_STYLE){
return DwtListView.prototype._getHeaderSashLocation.call(this)
}
var a=Dwt.toWindow(t,0,0);
var e=Dwt.toWindow(this._chooserParent.getHtmlElement(),0,0);
if(!this._tmpPoint){
this._tmpPoint=new DwtPoint()
}
this._tmpPoint.x=a.x-e.x;
this._tmpPoint.y=a.y-e.y;
return this._tmpPoint
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtSpinner")){
DwtSpinner=function(e){
if(arguments.length==0){
return
}
DwtControl.call(this,{
parent:e.parent,className:e.className,posStyle:e.posStyle,parentElement:e.parentElement}
);
this._maxValue=e.max!=null?e.max:null;
this._minValue=e.min!=null?e.min:null;
this._fieldSize=e.size!=null?e.size:3;
this._origValue=e.value||0;
this._maxLen=e.maxLen||null;
this._step=e.step||1;
this._decimals="decimals" in e?e.decimals:0;
this._align=e.align||null;
this._timerFunc=AjxCallback.simpleClosure(this._timerFunc,this);
this._btnPressCapture=new DwtMouseEventCapture({
targetObj:this,id:"DwtSpinner",mouseUpHdlr:AjxCallback.simpleClosure(this._stopCapture,this)}
);
this._createElements()
};
DwtSpinner.prototype=new DwtControl;
DwtSpinner.prototype.constructor=DwtSpinner;
DwtSpinner.INIT_TIMER=250;
DwtSpinner.SLOW_TIMER=125;
DwtSpinner.FAST_TIMER=33;
DwtSpinner.prototype._createElements=function(){
var n=this.getHtmlElement();
var o=Dwt.getNextId();
this._idField=o;
this._idUpButton=o+"-up";
this._idDownButton=o+"-down";
var i=["<table class='DwtSpinner' cellspacing='0' cellpadding='0'>","<tr><td rowspan='2' class='DwtSpinner-inputCell'>","<input id='",o,"' autocomplete='off' />","</td>","<td unselectable id='",this._idUpButton,"' class='DwtSpinner-upBtn'><div class='ImgUpArrowSmall'>&nbsp;</div></td>","</tr><tr>","<td unselectable id='",this._idDownButton,"' class='DwtSpinner-downBtn'><div class='ImgDownArrowSmall'>&nbsp;</div></td>","</tr></table>"];
n.innerHTML=i.join("");
var a=this._getUpButton();
a.onmousedown=AjxCallback.simpleClosure(this._btnPressed,this,"Up");
var t=this._getDownButton();
t.onmousedown=AjxCallback.simpleClosure(this._btnPressed,this,"Down");
var e=this.getInputElement();
if(this._maxLen){
e.maxLength=this._maxLen
}
if(this._fieldSize){
e.size=this._fieldSize
}
if(this._align){
e.style.textAlign=this._align
}
if(this._origValue!=null){
this.setValue(this._origValue)
}
e.onblur=AjxCallback.simpleClosure(this.setValue,this,null);
e[(AjxEnv.isIE||AjxEnv.isOpera)?"onkeydown":"onkeypress"]=AjxCallback.simpleClosure(this.__onKeyPress,this)
};
DwtSpinner.prototype._getValidValue=function(e){
var t=parseFloat(e);
if(isNaN(t)||t==null){
t=this._lastValidValue
}
if(t==null){
t=this._minValue||0
}
if(this._minValue!=null&&t<this._minValue){
t=this._minValue
}
if(this._maxValue!=null&&t>this._maxValue){
t=this._maxValue
}
t=parseFloat(t);
if(this._decimals!=null){
t=t.toFixed(this._decimals)
}
this._lastValidValue=t;
return t
};
DwtSpinner.prototype.getInputElement=function(){
return document.getElementById(this._idField)
};
DwtSpinner.prototype._getUpButton=function(){
return document.getElementById(this._idUpButton)
};
DwtSpinner.prototype._getDownButton=function(){
return document.getElementById(this._idDownButton)
};
DwtSpinner.prototype._getButton=function(e){
switch(e){
case"Up":return this._getUpButton();
case"Down":return this._getDownButton()
}};
DwtSpinner.prototype._setBtnState=function(e,a){
var t=this._getButton(e);
if(a){
Dwt.addClass(t,"DwtSpinner-"+e+"-disabled");
t.firstChild.className="Img"+e+"ArrowSmallDis"
}else{
Dwt.delClass(t,"DwtSpinner-"+e+"-disabled");
t.firstChild.className="Img"+e+"ArrowSmall"
}};
DwtSpinner.prototype.getValue=function(){
return parseFloat(this._getValidValue(this.getInputElement().value))
};
DwtSpinner.prototype.setValue=function(e){
if(e==null){
e=this.getInputElement().value
}
e=this._getValidValue(e);
this.getInputElement().value=e;
e=parseFloat(e);
this._setBtnState("Down",this._minValue!=null&&this._minValue==e);
this._setBtnState("Up",this._maxValue!=null&&this._maxValue==e)
};
DwtSpinner.prototype.setEnabled=function(e){
DwtControl.prototype.setEnabled.call(this,e);
this.getInputElement().disabled=!e;
var t=this.getHtmlElement().firstChild;
if(!e){
Dwt.addClass(t,"DwtSpinner-disabled")
}else{
Dwt.delClass(t,"DwtSpinner-disabled")
}};
DwtSpinner.prototype._rotateVal=function(e){
var t=this.getValue();
switch(e){
case"Up":t+=this._step;
break;
case"Down":t-=this._step;
break
}
this.setValue(t)
};
DwtSpinner.prototype._btnPressed=function(e){
if(!this.getEnabled()){
return
}
Dwt.addClass(this._getButton(e),"DwtSpinner-"+e+"-pressed");
this._direction=e;
this._rotateVal(e);
this._btnPressCapture.capture();
this._timerSteps=0;
this._timer=setTimeout(this._timerFunc,DwtSpinner.INIT_TIMER)
};
DwtSpinner.prototype._timerFunc=function(){
var a=this.getValue();
this._rotateVal(this._direction);
var t=this.getValue();
this._timerSteps++;
var e=this._timerSteps>4?DwtSpinner.FAST_TIMER:DwtSpinner.SLOW_TIMER;
if(a!=t){
this._timer=setTimeout(this._timerFunc,e)
}else{
this._stopCapture()
}};
DwtSpinner.prototype._stopCapture=function(){
if(this._timer){
clearTimeout(this._timer)
}
this._timer=null;
this._timerSteps=null;
var t=this._direction;
Dwt.delClass(this._getButton(t),"DwtSpinner-"+t+"-pressed");
this._direction=null;
this._btnPressCapture.release();
var e=this.getInputElement();
e.focus();
Dwt.setSelectionRange(e,0,e.value.length)
};
DwtSpinner.prototype.__onKeyPress=function(a){
if(AjxEnv.isIE){
a=window.event
}
var t=null;
switch(a.keyCode){
case 38:t="Up";
break;
case 40:t="Down";
break
}
if(t){
this._rotateVal(t);
var e=this.getInputElement();
Dwt.setSelectionRange(e,0,e.value.length)
}};
DwtSpinner.prototype.focus=function(){
this.getInputElement().focus()
};
DwtSpinner.prototype.select=function(){
var e=this.getInputElement();
e.focus();
Dwt.setSelectionRange(e,0,e.value.length)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtButtonColorPicker")){
DwtButtonColorPicker=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtButtonColorPicker.PARAMS);
a.actionTiming=DwtButton.ACTION_MOUSEUP;
DwtButton.call(this,a);
var e=new DwtMenu({
parent:this,style:DwtMenu.COLOR_PICKER_STYLE}
);
this.setMenu(e);
var t=new DwtColorPicker(e,null,null,a.noFillLabel,a.allowColorInput);
t.addSelectionListener(new AjxListener(this,this._colorPicked));
this.__colorPicker=t;
this.__color=""
};
DwtButtonColorPicker.PARAMS=["parent","style","className","posStyle","id","index","noFillLabel","allowColorInput"];
DwtButtonColorPicker.prototype=new DwtButton;
DwtButtonColorPicker.prototype.constructor=DwtButtonColorPicker;
DwtButtonColorPicker._RGB_RE=/rgb\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/;
DwtButtonColorPicker._hexdigits=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];
DwtButtonColorPicker.toHex=function(i,t){
var e=[];
while(i){
var a=DwtButtonColorPicker._hexdigits[i&15];
e.push(a);
i=i>>4
}
if(t!=null){
t-=e.length;
while(t-->0){
e.push("0")
}}
e.reverse();
return e.join("")
};
DwtButtonColorPicker.prototype.showColorDisplay=function(e){
if(!this._colorEl){
return
}
if(!e){
this._colorEl.onmouseover=DwtButtonColorPicker.__colorDisplay_onMouseOver;
this._colorEl.onmouseout=DwtButtonColorPicker.__colorDisplay_onMouseOut;
this._colorEl.onmousedown=DwtButtonColorPicker.__colorDisplay_onMouseDown
}};
DwtButtonColorPicker.prototype.getColor=function(){
return this.__color
};
DwtButtonColorPicker.prototype.setColor=function(e){
var t=e.match(DwtButtonColorPicker._RGB_RE);
if(t){
e="#"+DwtButtonColorPicker.toHex(parseInt(t[1]),2)+DwtButtonColorPicker.toHex(parseInt(t[2]),2)+DwtButtonColorPicker.toHex(parseInt(t[3]),2)
}
this.__color=e;
var a=this._colorEl;
if(a){
a.style.backgroundColor=e
}};
DwtButtonColorPicker.prototype._createHtmlFromTemplate=function(t,a){
DwtButton.prototype._createHtmlFromTemplate.call(this,t,a);
var e=AjxTemplate.expand("dwt.Widgets#ZButtonColorDisplay",a);
this.setText(e);
this._colorEl=document.getElementById(a.id+"_color")
};
DwtButtonColorPicker.prototype._setMinWidth=function(){};
DwtButtonColorPicker.prototype._colorPicked=function(a){
var e=a.detail||"#000000";
this.__color=this.__detail=e;
var t=this._colorEl;
if(t){
t.style.backgroundColor=e
}
if(this.isListenerRegistered(DwtEvent.SELECTION)){
var i=DwtShell.selectionEvent;
i.item=this;
i.detail=e;
this.notifyListeners(DwtEvent.SELECTION,i)
}};
DwtButtonColorPicker.prototype.__colorDisplay_onMouseOver=function(e,t){
if(!this.getEnabled()){
return
}
Dwt.addClass(t,"ImgDisable")
};
DwtButtonColorPicker.prototype.__colorDisplay_onMouseOut=function(e,t){
if(!this.getEnabled()){
return
}
Dwt.delClass(t,"ImgDisable")
};
DwtButtonColorPicker.prototype.__colorDisplay_onMouseDown=function(t,i){
if(!this.getEnabled()){
return
}
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
this.__color=this.__detail=i.style.backgroundColor="";
if(this.isListenerRegistered(DwtEvent.SELECTION)){
var a=DwtShell.selectionEvent;
a.item=this;
a.detail="";
this.notifyListeners(DwtEvent.SELECTION,a)
}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtButtonColorPicker.__colorDisplay_onMouseOver=function(e){
var t=DwtControl.getTargetControl(e);
t.__colorDisplay_onMouseOver(e,this)
};
DwtButtonColorPicker.__colorDisplay_onMouseOut=function(e){
var t=DwtControl.getTargetControl(e);
t.__colorDisplay_onMouseOut(e,this)
};
DwtButtonColorPicker.__colorDisplay_onMouseDown=function(e){
var t=DwtControl.getTargetControl(e);
t.__colorDisplay_onMouseDown(e,this)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMessageComposite")){
DwtMessageComposite=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtMessageComposite.PARAMS);
if(!e.className){
e.className="DwtMessageComposite"
}
DwtComposite.call(this,e);
this._tabGroup=new DwtTabGroup("DwtMessageComposite");
if(e.format){
this.setFormat(e.format,e.controlCallback,e.hintsCallback)
}};
DwtMessageComposite.PARAMS=["parent","className","posStyle"];
DwtMessageComposite.prototype=new DwtComposite;
DwtMessageComposite.prototype.constructor=DwtMessageComposite;
DwtMessageComposite.prototype.isDwtMessageComposite=true;
DwtMessageComposite.prototype.toString=function(){
return"DwtMessageComposite"
};
DwtMessageComposite.prototype.setFormat=function(f,d,a){
this._formatter=new AjxMessageFormat(f);
this._controls={};
var t=this._htmlElId;
this.getHtmlElement().innerHTML="<table class='DwtCompositeTable' border='0' cellspacing='0' cellpadding='0'><tr valign='center'></tr></table>";
var m=this.getHtmlElement().firstChild.rows[0];
var s=this._formatter.getSegments();
for(var n=0;
n<s.length;
n++){
var r=s[n];
var u=r instanceof AjxMessageFormat.MessageSegment;
var h=[t,n].join("_");
var c=document.createElement("TD");
c.id=h;
c.className="DwtCompositeCell";
m.appendChild(c);
if(u){
c.className+=" MessageControl"+r.getIndex();
var o=d?d.run(this,r,n):null;
if(!o){
o=new DwtInputField({
parent:this,parentElement:c}
)
}else{
o.reparentHtmlElement(c)
}
this._tabGroup.addMember(o.getTabGroupMember());
if(a){
var e=a.run(this,r,n);
AjxUtil.hashUpdate(o.getHtmlElement(),e,true)
}
var l=r.getIndex();
this._controls[l]=this._controls[l]||o
}else{
o=new DwtText({
parent:this,parentElement:c}
);
o.setText(r.toSubPattern());
this._tabGroup.addMember(o)
}}};
DwtMessageComposite.prototype.format=function(){
var t=[];
for(var e in this._controls){
t[e]=this._controls[e].getValue()
}
return this._formatter.format(t)
};
DwtMessageComposite.prototype.getTabGroupMember=function(){
return this._tabGroup
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtRadioButtonGroup")){
DwtRadioButtonGroup=function(a,e){
this._radios={};
this._radioButtons={};
this._values={};
this._value2id={};
this._eventMgr=new AjxEventMgr();
for(var t in a){
this.addRadio(t,a[t],(t==e))
}};
DwtRadioButtonGroup.prototype.toString=function(){
return"DwtRadioButtonGroup"
};
DwtRadioButtonGroup.prototype._enabled=true;
DwtRadioButtonGroup.prototype._visible=true;
DwtRadioButtonGroup.prototype.addSelectionListener=function(e){
return this._eventMgr.addListener(DwtEvent.SELECTION,e)
};
DwtRadioButtonGroup.prototype.removeSelectionListener=function(e){
return this._eventMgr.removeListener(DwtEvent.SELECTION,e)
};
DwtRadioButtonGroup.prototype.setEnabled=function(e){
this._enabled=e;
for(var t in this._radios){
this._radios[t].disabled=!e
}};
DwtRadioButtonGroup.prototype.isEnabled=function(){
return this._enabled
};
DwtRadioButtonGroup.prototype.setVisible=function(e){
this._visible=e;
for(var t in this._radioButtons){
this._radioButtons[t].setVisible(e)
}
for(var t in this._radios){
Dwt.setVisible(this._radios[t],e)
}};
DwtRadioButtonGroup.prototype.isVisible=function(){
return this._visible
};
DwtRadioButtonGroup.prototype.addRadio=function(r,s,i){
var e=s instanceof DwtRadioButton;
var o=e?s:null;
var n=o?o.getValue():s;
this._values[r]=n;
this._value2id[n]=r;
var t=document.getElementById(r);
this._radios[r]=t;
this._radioButtons[r]=o;
var a=AjxCallback.simpleClosure(this._handleClick,this);
Dwt.setHandler(t,DwtEvent.ONCLICK,a);
t.checked=i;
if(i){
this._selectedId=r
}};
DwtRadioButtonGroup.prototype.getRadioByValue=function(e){
var t=this._value2id[e];
return this._radios[t]
};
DwtRadioButtonGroup.prototype.getRadioButtonByValue=function(e){
var t=this._value2id[e];
return this._radioButtons[t]
};
DwtRadioButtonGroup.prototype.setSelectedId=function(i,e){
if(i!=this._selectedId){
var t=document.getElementById(i);
if(!t){
return
}
t.checked=true;
this._selectedId=i;
if(!e){
var a=DwtShell.selectionEvent;
a.reset();
this._notifySelection(a)
}}};
DwtRadioButtonGroup.prototype.setSelectedValue=function(t,e){
var a=this._valueToId(t);
this.setSelectedId(a,e)
};
DwtRadioButtonGroup.prototype.getSelectedId=function(){
return this._selectedId
};
DwtRadioButtonGroup.prototype.getSelectedValue=function(){
return this._values[this._selectedId]
};
DwtRadioButtonGroup.prototype.getValue=function(){
return this.getSelectedValue()
};
DwtRadioButtonGroup.prototype.getData=function(t){
var e=!AjxUtil.isUndefined(this._selectedId)&&this._radioButtons[this._selectedId];
if(e){
return e.getData(t)
}};
DwtRadioButtonGroup.prototype._valueToId=function(e){
for(var t in this._values){
if(this._values[t]==e){
return t
}
if(e===true&&this._values[t]=="true"){
return t
}
if(e===false&&(this._values[t]=="false"||this._values[t]=="")){
return t
}}
return null
};
DwtRadioButtonGroup.prototype._notifySelection=function(e){
e.item=this;
e.detail={
id:this._selectedId,value:this._values[this._selectedId]};
this._eventMgr.notifyListeners(DwtEvent.SELECTION,e)
};
DwtRadioButtonGroup.prototype._handleClick=function(e){
e=DwtUiEvent.getEvent(e);
var a=DwtUiEvent.getTarget(e);
if(a&&a.nodeName.match(/label/i)){
a=document.getElementById(a.getAttribute(AjxEnv.isIE?"htmlFor":"for"))
}
var i=a.id;
if(!a.checked){
for(i in this._radios){
if(this._radios[i].checked){
break
}}}
if(i!=this._selectedId){
this._selectedId=i;
var t=DwtShell.selectionEvent;
DwtUiEvent.copy(t,e);
this._notifySelection(t)
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtForm")){
DwtForm=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtForm.PARAMS);
e.className=e.className||"DwtForm";
DwtComposite.apply(this,arguments);
this.setScrollStyle(DwtControl.SCROLL);
this._tabGroup=new DwtTabGroup(this._htmlElId);
this._context={
set:AjxCallback.simpleClosure(this.set,this),get:AjxCallback.simpleClosure(this.get,this)};
this._dirty={};
this._ignore={};
this._invalid={};
this._errorMessages={};
this.setModel(e.model);
this.setForm(e.form);
this.reset()
};
DwtForm.prototype=new DwtComposite;
DwtForm.prototype.constructor=DwtForm;
DwtForm.prototype.toString=function(){
return"DwtForm"
};
DwtForm.PARAMS=DwtControl.PARAMS.concat("form","model");
DwtForm.prototype.setValue=function(n,a,t){
if(typeof n!="string"){
n=String(n)
}
if(n.match(/\./)||n.match(/\[/)){
var o=n.replace(/\[(\d+)\](\.)?/,".$1$2").split(".");
var i=this.getControl(o[0]);
if(Dwt.instanceOf(i,"DwtForm")){
i.setValue(o.slice(1).join("."),a,t)
}
return
}
var e=this._items[n];
if(!e){
return
}
if(!t&&a==e.value){
return
}
this._setModelValue(n,a);
this._setControlValue(n,a)
};
DwtForm.prototype.getValue=function(n,e){
if(typeof n!=="string"){
n=String(n)
}
if(n.match(/\./)||n.match(/\[/)){
var o=n.replace(/\[(\d+)\](\.)?/,".$1$2").split(".");
var i=this.getControl(o[0]);
if(Dwt.instanceOf(i,"DwtForm")){
return i.getValue(o.slice(1).join("."))
}
return null
}
var t=this._items[n];
if(!t){
return
}
if(t.getter){
return this._call(t.getter)||e
}
var a=this._getControlValue(n);
if(a==null){
a=t.value
}
return a||e||""
};
DwtForm.prototype.getControl=function(t){
if(typeof t!="string"){
t=String(t)
}
var e=this._items[t];
return e&&e.control
};
DwtForm.prototype.isRelevant=function(e){
return this.isVisible(e)&&this.isEnabled(e)
};
DwtForm.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtForm.prototype.setLabel=function(i,e){
var t=this._items[i];
if(!t){
return
}
if(e==this.getLabel(i)){
return
}
var a=t.control;
if(!a){
return
}
if(a.setLabel){
a.setLabel(e);
return
}
if(a.setText){
a.setText(e);
return
}};
DwtForm.prototype.setImage=function(o,i,e){
var t=this._items[o];
if(!t){
return
}
var a=t.control;
if(!a){
return
}
a.setImage(i,null,e)
};
DwtForm.prototype.getLabel=function(a){
var e=this._items[a];
var t=e&&e.control;
if(t){
if(t.getLabel){
return t.getLabel()
}
if(t.getText){
return t.getText()
}}
return""
};
DwtForm.prototype.setVisible=function(o,i){
if(arguments.length==1){
DwtComposite.prototype.setVisible.call(this,arguments[0]);
return
}
var t=this._items[o];
var a=t&&t.control;
if(!a){
return
}
if(a.setVisible){
a.setVisible(i)
}else{
Dwt.setVisible(a,i)
}
var e=document.getElementById([this._htmlElId,o,"row"].join("_"));
if(e){
Dwt.setVisible(e,i)
}};
DwtForm.prototype.isVisible=function(a){
if(arguments.length==0){
return DwtComposite.prototype.isVisible.call(this)
}
var e=this._items[a];
var t=e&&e.control;
if(!t){
return false
}
if(t.getVisible){
return t.getVisible()
}
if(t.isVisible){
return t.isVisible()
}
return Dwt.getVisible(t)
};
DwtForm.prototype.setEnabled=function(i,e){
if(arguments.length==1){
DwtComposite.prototype.setEnabled.call(this,arguments[0]);
return
}
var t=this._items[i];
var a=t&&t.control;
if(!a){
return
}
if(a.setEnabled){
a.setEnabled(e)
}else{
a.disabled=!e
}};
DwtForm.prototype.isEnabled=function(a){
if(arguments.length==0){
return DwtComposite.prototype.isEnabled.call(this)
}
var e=this._items[a];
var t=e&&e.control;
if(!t){
return false
}
if(t.isEnabled){
return t.isEnabled()
}
if(t.getEnabled){
return t.getEnabled()
}
return !t.disabled
};
DwtForm.prototype.setValid=function(t,e){
if(typeof(t)=="boolean"){
e=arguments[0];
for(t in this._items){
this.setValid(t,e)
}
return
}
if(e){
delete this._invalid[t]
}else{
this._invalid[t]=true
}};
DwtForm.prototype.isValid=function(e){
if(arguments.length==0||AjxUtil.isUndefined(e)){
for(var e in this._invalid){
return false
}
return true
}
return !(e in this._invalid)
};
DwtForm.prototype.setErrorMessage=function(t,e){
if(!t||t==""){
this._errorMessages={};
return
}
if(!e){
delete this._errorMessages[t]
}else{
this._errorMessages[t]=e
}};
DwtForm.prototype.getErrorMessage=function(t){
if(arguments.length==0){
var e={};
for(var t in this._invalid){
e[t]=this._errorMessages[t]
}
return e
}
return this._errorMessages[t]
};
DwtForm.prototype.getInvalidItems=function(){
return AjxUtil.keys(this._invalid)
};
DwtForm.prototype.setDirty=function(i,t,e){
if(typeof i=="boolean"){
t=arguments[0];
for(i in this._items){
this.setDirty(i,t,true)
}
if(!e&&this._ondirty){
this._call(this._ondirty,["*"])
}
return
}
if(t){
this._dirty[i]=true
}else{
delete this._dirty[i]
}
if(!e&&this._ondirty){
var a=this._items[i];
if(!a.ignore||!this._call(a.ignore)){
this._call(this._ondirty,[i])
}}};
DwtForm.prototype.isDirty=function(t){
if(arguments.length==0){
for(var t in this._dirty){
var e=this._items[t];
if(e.ignore&&this._call(e.ignore)){
continue
}
return true
}
return false
}
var e=this._items[t];
return e.ignore&&this._call(e.ignore)?false:t in this._dirty
};
DwtForm.prototype.getDirtyItems=function(){
DwtForm.__acceptDirtyItem.form=this;
return AjxUtil.keys(this._dirty,DwtForm.__acceptDirtyItem)
};
DwtForm.__acceptDirtyItem=function(a){
var t=arguments.callee.form;
var e=t._items[a];
return !e.ignore||!t._call(e.ignore)
};
DwtForm.prototype.setIgnore=function(t,e){
if(typeof t=="boolean"){
this._ignore={};
return
}
if(e){
this._ignore[t]=true;
return
}
delete this._ignore[t]
};
DwtForm.prototype.isIgnore=function(e){
return e in this._ignore
};
DwtForm.prototype.set=function(t,e){
this.setValue(t,e,true);
this.update()
};
DwtForm.prototype.get=DwtForm.prototype.getValue;
DwtForm.prototype.setModel=function(e,t){
this._context.model=this.model=e
};
DwtForm.prototype.setForm=function(e){
this._context.form=this.form=e;
this._createHtml(e.template)
};
DwtForm.prototype.validate=function(e){
if(arguments.length==0){
this.setValid(true);
for(var e in this._items){
this._validateItem(e)
}
return this.isValid()
}
return this._validateItem(e)
};
DwtForm.prototype._validateItem=function(s){
if(!s){
return true
}
var i=this._items[s];
if(!i){
return true
}
try{
var o=this.getValue(s);
var a=i.validator?i.validator(o):((i.control&&i.control.validator)?i.control.validator(o):true);
this.setValid(s,Boolean(a)||a==="");
if(AjxUtil.isString(a)||AjxUtil.isObject(a)){
this._setControlValue(s,a);
i.value=i.setter?this._call(i.setter,[a]):a;
var t=!Boolean(this._call(i.equals,[i.value,i.ovalue]));
this.setDirty(s,t)
}}
catch(n){
this.setErrorMessage(s,AjxUtil.isString(n)?n:n.message);
this.setValid(s,false)
}
return !(s in this._invalid)
};
DwtForm.prototype.reset=function(i){
this._dirty={};
this._ignore={};
this._invalid={};
for(var a in this._items){
var t=this._items[a];
if(t.control instanceof DwtForm){
t.control.reset(i)
}
var e=this._items[a].def;
if(!e){
continue
}
this._initControl(e,i)
}
this.update();
for(var a in this._items){
var t=this._items[a];
t.ovalue=t.value
}
this.validate();
this.setDirty(false);
if(this._onreset){
this._call(this._onreset)
}};
DwtForm.prototype.update=function(){
for(var t in this._items){
var e=this._items[t];
if(e.control instanceof DwtForm){
e.control.update()
}
if(e.getter){
this.setValue(t,this._call(e.getter))
}}
for(var t in this._items){
var e=this._items[t];
if(e.visible){
this.setVisible(t,Boolean(this._call(e.visible)))
}
if(e.enabled){
this.setEnabled(t,Boolean(this._call(e.enabled)))
}
if(e.ignore){
this.setIgnore(t,Boolean(this._call(e.ignore)))
}}
if(this._onupdate){
this._call(this._onupdate)
}};
DwtForm.prototype._setModelValue=function(i,a){
var t=this._items[i];
t.value=t.setter?this._call(t.setter,[a]):a;
var e=!Boolean(this._call(t.equals,[t.value,t.ovalue]));
this.setDirty(i,e);
this.validate(i);
return e
};
DwtForm.prototype._setControlValue=function(a,e){
var t=this._items[a].control;
if(t){
if(t instanceof DwtCheckbox||t instanceof DwtRadioButton){
t.setSelected(e);
return
}
if(t instanceof DwtMenuItem&&t.isStyle(DwtMenuItem.CHECK_STYLE)){
t.setChecked(e,true);
return
}
if(t.setSelectedValue){
t.setSelectedValue(e);
return
}
if(t.setValue){
t.setValue(e);
return
}
if(t.setText&&!(t instanceof DwtButton)){
t.setText(e);
return
}
if(!(t instanceof DwtControl)){
if(t.type=="checkbox"||t=="radio"){
t.checked=e
}else{
t.value=e
}
return
}}};
DwtForm.prototype._getControlValue=function(t){
var e=this._items[t].control;
if(e){
if(e instanceof DwtCheckbox||e instanceof DwtRadioButton){
return e.isSelected()
}
if(e.getSelectedValue){
return e.getSelectedValue()
}
if(e.getValue){
return e.getValue()
}
if(e.getText&&!(e instanceof DwtButton)){
return e.getText()
}
if(!(e instanceof DwtControl)){
if(e.type=="checkbox"||e=="radio"){
return e.checked
}
return e.value
}}};
DwtForm.prototype._deleteItem=function(e){
delete this._items[e];
delete this._dirty[e];
delete this._invalid[e];
delete this._ignore[e]
};
DwtForm.prototype._call=function(t,e){
if(t){
if(e){
return t.apply(this,e)
}
return t.call(this)
}};
DwtForm.prototype._createHtml=function(e){
this._createHtmlFromTemplate(e||this.TEMPLATE,{
id:this._htmlElId}
)
};
DwtForm.prototype._createHtmlFromTemplate=function(t,s){
DwtComposite.prototype._createHtmlFromTemplate.apply(this,arguments);
var a=[];
this._items={};
this._tabGroup.removeAllMembers();
this._onupdate=null;
this._onreset=null;
this._ondirty=null;
var e=this.form;
if(e&&e.items){
this._registerControls(e.items,null,a);
this._onupdate=DwtForm.__makeFunc(e.onupdate);
this._onreset=DwtForm.__makeFunc(e.onreset);
this._ondirty=DwtForm.__makeFunc(e.ondirty)
}
var l=this.getHtmlElement().getElementsByTagName("A");
for(var r=0;
r<l.length;
r++){
var h=l[r];
if(!h.href||h.getAttribute("notab")=="true"){
continue
}
var c=h.id&&h.id.substr(this.getHTMLElId().length+1);
if(this._items[c]){
continue
}
a.push({
tabindex:h.getAttribute("tabindex")||Number.MAX_VALUE,control:h}
)
}
a.sort(DwtForm.__byTabIndex);
for(var r=0;
r<a.length;
r++){
var n=a[r].control;
var o=(n.getTabGroupMember&&n.getTabGroupMember())||n;
this._tabGroup.addMember(o)
}};
DwtForm.prototype._registerControls=function(a,n,e,s,o,r){
for(var t=0;
t<a.length;
t++){
this._registerControl(a[t],n,e,s,o,r)
}};
DwtForm.prototype._registerControl=function(l,s,w,y,c,n){
var f=l.id||[this._htmlElId,Dwt.getNextId()].join("_");
var g=this._items[f]={
id:f,def:l,parentDef:s,equals:DwtForm.__makeFunc(l.equals)||DwtForm.__equals,getter:DwtForm.__makeGetter(l),setter:DwtForm.__makeSetter(l),value:l.value,visible:DwtForm.__makeFunc(l.visible),enabled:DwtForm.__makeFunc(l.enabled),validator:DwtForm.__makeFunc(l.validator),ignore:DwtForm.__makeFunc(l.ignore),control:l.control};
if(l.aka){
this._items[f].aka=l.aka;
this._items[l.aka]=g
}
var d=g.control;
if(d){
return d
}
c=c||this;
var o=l.type=l.type||n;
var t=(s&&s.menu==l);
var a=document.getElementById([c._htmlElId,f].join("_"));
if(Dwt.instanceOf(o,"DwtRadioButtonGroup")){
d=new window[o]({}
);
g.control=d;
var r={
name:[c._htmlElId,f].join("_"),value:l.value};
if(l.items){
for(var p=0;
p<l.items.length;
p++){
var m=l.items[p];
var h=m.checked||m.value==l.value;
var u=this._registerControl(m,l,w,r,c,"DwtRadioButton");
this._items[m.id].value=h;
if(u){
d.addRadio(u.getInputElement().id,u,h);
var e=DwtForm.__makeFunc(m.onclick||l.onclick);
u.addSelectionListener(new AjxListener(this,this._radio2group2model,[m.id,f,e]));
DwtForm.__hack_fixRadioButtonHandler(u)
}}}}else{
if(o){
if(Dwt.instanceOf(o,"DwtInputField")){
g.value=g.value||""
}
if(Dwt.instanceOf(o,"DwtFormRows")){
g.equals=DwtFormRows.__equals
}
if(a||t){
d=g.control=this._createControl(l,s,w,y,c,n)
}}else{
if(a){
this._attachElementHandlers(l,s,w,c,a);
d=g.control=a;
if(l.items){
this._registerControls(l.items,l,w,null,c,null)
}}}}
if(a&&d instanceof DwtControl){
d.replaceElement(a)
}
if(a&&d instanceof DwtInputField){
d.getInputElement().id+="_input";
d.setHandler(DwtEvent.ONPASTE,this._onPaste.bind(this,f))
}
if(l.notab==null){
l.notab=a&&a.getAttribute("notab")=="true"
}
if(w&&d&&!l.notab&&!(d instanceof DwtRadioButtonGroup)){
w.push({
tabindex:(a&&a.getAttribute("tabindex"))||Number.MAX_VALUE,control:d}
)
}
if(d instanceof DwtListView){
g.getter=g.getter||AjxCallback.simpleClosure(this.__list_getValue,this,f);
g.setter=g.setter||AjxCallback.simpleClosure(this.__list_setValue,this,f)
}
return d
};
DwtForm.prototype._onPaste=function(t,e){
AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._applyPasteInput,[t]),100)
};
DwtForm.prototype._applyPasteInput=function(t,e){
this._setModelValue(t,this._getControlValue(t))
};
DwtForm.prototype._attachElementHandlers=function(s,a,i,l,n){
var t=s.id;
var e=n.nodeName.toLowerCase();
var h=n.type;
if(h=="checkbox"||h=="radio"){
var r;
if(h=="radio"){
r=n.name;
if(!this._items[r]){
this._items[r]={
id:r}
}
if(n.checked){
this._items[r].value=n.value
}}
var d=n.onclick;
var c=DwtForm.__makeFunc(s.onclick);
n.onclick=AjxCallback.simpleClosure(this._htmlInput_checked,this,t,r,c,d)
}else{
if(e=="select"){
var o=n.onchange;
var c=DwtForm.__makeFunc(s.onchange);
n.onchange=AjxCallback.simpleClosure(this._htmlSelect_selectedIndex,this,t,c,o)
}else{
if(e=="button"||e=="a"||h=="button"||h=="reset"||h=="submit"){
var d=n.onclick;
var c=DwtForm.__makeFunc(s.onclick);
n.onclick=AjxCallback.simpleClosure(this._htmlElement,this,t,c,d)
}else{
if(e=="textarea"||e=="input"){
var o=n.onchange;
var c=DwtForm.__makeFunc(s.onchange);
n.onchange=AjxCallback.simpleClosure(this._htmlInput_value,this,t,c,o)
}}}}
return n
};
DwtForm.prototype._createControl=function(m,c,M,F,g,l){
var j=m.id||[this._htmlElId,Dwt.getNextId()].join("_");
var n=m.type=m.type||l;
F=F?AjxUtil.createProxy(F):{};
F.id=F.id||[this._htmlElId,j].join("_");
F.parent=g||this;
F.template=m.template||F.template;
F.className=m.className||F.className;
var S=Dwt.instanceOf(n,"DwtRadioButton");
var q=Dwt.instanceOf(n,"DwtCheckbox");
if(S||q){
F.name=m.name||F.name;
F.value=m.value||F.value;
F.checked=m.checked!=null?m.checked:F.checked
}
var f=Dwt.instanceOf(n,"DwtInputField");
if(f){
F.type=m.password?DwtInputField.PASSWORD:null;
F.size=m.cols;
F.rows=m.rows
}
var r=Dwt.instanceOf(n,"DwtTabViewPage");
if(r){
F.contentTemplate=m.template;
delete m.template
}
var x=Dwt.instanceOf(n,"DwtTree");
if(x){
F.style=m.style
}
F.formItemDef=m;
if(m.params){
for(var z in m.params){
F[z]=m.params[z]
}}
var y=new window[n](F);
if(y instanceof DwtSelect){
var o=m.items;
if(o){
for(var B=0;
B<o.length;
B++){
var k=o[B];
k.displayValue=k.label||k.value;
y.addOption(k)
}}
var t=DwtForm.__makeFunc(m.onchange);
y.addChangeListener(new AjxListener(this,this._control2model,[j,t]))
}else{
if(y instanceof DwtButton||y instanceof DwtMenuItem){
if(m.label){
y.setText(m.label)
}
if(m.image){
y.setImage(m.image,null,m.imageAltText)
}
if(m.menu){
var a=Dwt.instanceOf(m.menu.type||"DwtMenu","DwtMenu");
var e;
if(a){
e=this._registerControl(m.menu,m,null,null,y,"DwtMenu")
}else{
e=new DwtMenu({
parent:y}
);
var C=Dwt.instanceOf(m.menu.type,"DwtCalendar")?DwtMenu.CALENDAR_PICKER_STYLE:DwtMenu.GENERIC_WIDGET_STYLE;
this._registerControl(m.menu,m,null,{
style:C}
,e)
}
y.setMenu(e)
}
var W;
if(g instanceof DwtToolBar||g instanceof DwtMenu){
W=c.id
}
var t=DwtForm.__makeFunc(m.onclick||(c&&c.onclick));
y.addSelectionListener(new AjxListener(this,this._item2parent,[j,W,t]))
}else{
if(y instanceof DwtCheckbox&&!(y instanceof DwtRadioButton)){
var t=DwtForm.__makeFunc(m.onclick);
y.addSelectionListener(new AjxListener(this,this._control2model,[j,t]))
}else{
if(y instanceof DwtInputField){
var T=DwtForm.__makeFunc(m.onchange);
var A=AjxCallback.simpleClosure(this._input2model2handler,this,j,T);
y.addListener(DwtEvent.ONKEYUP,A);
if(AjxEnv.isFirefox){
var u=this._onkeydownhandler.bind(this,j,T);
y.addListener(DwtEvent.ONKEYDOWN,u)
}
var D=DwtForm.__makeFunc(m.onblur);
if(D){
var s=AjxCallback.simpleClosure(this._input2model2handler,this,j,D);
y.addListener(DwtEvent.ONBLUR,s)
}
m.tooltip=m.tooltip||m.hint;
y.setHint(m.hint);
y.setLabel(m.label||m.tooltip)
}else{
if(y instanceof DwtListView){
y.addSelectionListener(new AjxListener(this,this._handleListSelection,[j]))
}else{
if(y instanceof DwtMenu){
if(m.items){
var O=m.items;
for(var B=0;
B<O.length;
B++){
var v=O[B];
if(v.type==DwtMenuItem.SEPARATOR_STYLE){
new DwtMenuItem({
parent:y,style:DwtMenuItem.SEPARATOR_STYLE}
);
continue
}
this._registerControl(v,m,null,null,y,"DwtMenuItem")
}}}else{
if(y instanceof DwtTabView){
var d=m.items;
if(d){
this._registerControls(d,m,null,null,y,"DwtTabViewPage")
}}else{
if(y instanceof DwtTabViewPage&&g instanceof DwtTabView){
var R=g.addTab(m.label,y);
if(m.image){
g.getTabButton(R).setImage(m.image,null,m.imageAltText)
}
if(m.items){
this._registerControls(m.items,m,M,null,y)
}}else{
if(y instanceof DwtToolBar){
var w=m.items;
if(w){
for(var B=0;
B<w.length;
B++){
var h=w[B];
if(h.type==DwtToolBar.SPACER){
y.addSpacer(h.size);
continue
}
if(h.type==DwtToolBar.SEPARATOR){
y.addSeparator(h.className);
continue
}
if(h.type==DwtToolBar.FILLER){
y.addFiller(h.className);
continue
}
this._registerControl(h,m,null,null,y,"DwtToolBarButton")
}}}else{
if(y instanceof DwtCalendar){
if(m.onselect instanceof AjxListener){
y.addSelectionListener(m.onselect)
}}else{
if(y instanceof DwtComposite){
if(m.items){
this._registerControls(m.items,m,M,null,y)
}}}}}}}}}}}}
if(m.width||m.height){
if(y instanceof DwtInputField){
Dwt.setSize(y.getInputElement(),m.width,m.height)
}else{
y.setSize(m.width,m.height)
}}
if(m.tooltip){
y.setToolTipContent(m.tooltip)
}
return y
};
DwtForm.prototype._onkeydownhandler=function(t,e){
setTimeout(this._input2model2handler.bind(this,t,e),500)
};
DwtForm.prototype._initControl=function(e,i){
var a=e.id;
if(e.label){
this.setLabel(a,e.label)
}
var t=this._items[a];
if(i){
t.ovalue=t.value
}else{
if(e.value){
if(Dwt.instanceOf(e.type,"DwtRadioButton")){
t.ovalue=t.value=t.control&&t.control.isSelected()
}else{
this.setValue(a,e.value,true);
t.ovalue=t.value
}}else{
t.ovalue=null
}}
if(typeof e.enabled=="boolean"){
this.setEnabled(a,e.enabled)
}
if(typeof e.visible=="boolean"){
this.setVisible(a,e.visible)
}};
DwtForm.prototype._htmlElement=function(i,a,t,e){
if(a){
this._call(a,[i])
}
if(t){
t(e)
}};
DwtForm.prototype._htmlInput_checked=function(s,n,a,t,e){
var o=this.getControl(s);
var i=o.checked;
this._setModelValue(s,i);
if(n&&i){
this._setModelValue(n,o.value)
}
this.update();
this._htmlElement(s,a,t,e)
};
DwtForm.prototype._htmlInput_value=function(i,a,t,e){
this._setModelValue(i,this.getControl(i).value);
this.update();
this._htmlElement(i,a,t,e)
};
DwtForm.prototype._htmlSelect_selectedIndex=function(o,i,a,t){
var e=this.getControl(o);
this._setModelValue(o,e.options[e.selectedIndex].value);
this.update();
this._htmlElement(o,i,a,t)
};
DwtForm.prototype._control2model=function(t,e){
this._setModelValue(t,this._getControlValue(t));
this.update();
if(e){
this._call(e,[t])
}};
DwtForm.prototype._radio2group2model=function(e,t,a){
this._setModelValue(t,this.getControl(e).getValue());
this._setModelValue(e,this._getControlValue(e));
this.update();
if(a){
this._call(a,[e])
}};
DwtForm.prototype._input2model2handler=function(t,e){
this._setModelValue(t,this._getControlValue(t));
this.update();
if(e){
this._call(e,[t])
}};
DwtForm.prototype._item2parent=function(i,o,t){
var a=this.getControl(i);
var e=this._items[i].def;
if(a instanceof DwtButtonColorPicker||(e.menu&&!e.onclick)){
a._toggleMenu()
}else{
if(o){
this._setModelValue(o,this._getControlValue(i)||i);
this.update()
}}
if(t){
this._call(t,[i])
}};
DwtForm.prototype._handleListSelection=function(t,e){
this.update()
};
DwtForm.prototype.__list_getValue=function(e){
return this.getControl(e).getSelection()
};
DwtForm.prototype.__list_setValue=function(t,e){
this.getControl(t).setSelection(e)
};
DwtForm.__makeGetter=function(s){
var t=s.getter;
if(t){
return DwtForm.__makeFunc(t)
}
var n=s.ref;
if(!n){
return null
}
var r=n.split(".");
var e=["var context = this.model;"];
for(var o=0;
o<r.length;
o++){
var a=r[o];
var h=DwtForm.__makeFuncName(a);
if(o==r.length-1){
break
}
e.push("context = context && (context.",h," ? context.",h,"() : context.",a,");")
}
e.push("var value = context ? (context.",h," ? context.",h,"() : context.",a,") : this._items.",a,".value;","return value !== undefined ? value : defaultValue;");
return new Function("defaultValue",e.join(""))
};
DwtForm.__makeSetter=function(l){
var o=l.setter;
if(o){
return DwtForm.__makeFunc(o)
}
var a=l.ref;
if(!a){
return null
}
var n=a.split(".");
var h=["var context = this.model;"];
for(var r=0;
r<n.length;
r++){
var s=r==n.length-1;
var e=n[r];
var t=DwtForm.__makeFuncName(e,s?"set":"get");
if(s){
break
}
h.push("context = context && (context.",t," ? context.",t,"() : context.",e,");")
}
h.push("if (context) {","if (context.",t,") {","context.",t,"(value);","}","else {","context.",e," = value;","}","}");
return new Function("value",h.join("\n"))
};
DwtForm.__makeFuncName=function(e,t){
return[t||"get",e.substr(0,1).toUpperCase(),e.substr(1)].join("")
};
DwtForm.__makeFunc=function(t){
if(t==null){
return null
}
if(typeof t=="function"&&!(t instanceof RegExp)){
return t
}
var e=["with (this._context) {","return (",t,");","}"].join("");
return new Function(e)
};
DwtForm.__equals=function(t,e){
return t==e
};
DwtForm.__byTabIndex=function(t,e){
return t.tabindex-e.tabindex
};
DwtForm.__hack_fixRadioButtonHandler=function(t){
var e=[t.getInputElement().onclick,DwtCheckbox.__handleClick];
var a=function(o){
for(var n=0;
n<e.length;
n++){
var s=e[n];
if(s){
s(o)
}}};
Dwt.setHandler(t.getInputElement(),DwtEvent.ONCLICK,a)
};
DwtFormRows=function(a){
if(arguments.length==0){
return
}
this._itemDef=a.formItemDef||{};
a.className=a.className||"DwtFormRows";
DwtForm.call(this,{
id:a.id,parent:a.parent,form:{}
,template:this._itemDef.template}
);
this._rowsTabGroup=new DwtTabGroup(this._htmlElId);
this._rowDef=this._itemDef.rowitem||{};
this._equals=DwtForm.__makeFunc(this._rowDef.equals)||DwtForm.__equals;
this._rowCount=0;
this._minRows=this._itemDef.minrows||1;
this._maxRows=this._itemDef.maxrows||Number.MAX_VALUE;
if(this._itemDef.rowtemplate){
this.ROW_TEMPLATE=this._itemDef.rowtemplate
}
var t=this._itemDef.items||[];
for(var e=0;
e<t.length;
e++){
this.addRow(t[e])
}
for(;
e<this._minRows;
e++){
this.addRow()
}
this._onaddrow=DwtForm.__makeFunc(this._itemDef.onaddrow);
this._onremoverow=DwtForm.__makeFunc(this._itemDef.onremoverow)
};
DwtFormRows.prototype=new DwtForm;
DwtFormRows.prototype.constructor=DwtFormRows;
DwtFormRows.prototype.toString=function(){
return"DwtFormRows"
};
DwtFormRows.prototype.TEMPLATE="dwt.Widgets#DwtFormRows";
DwtFormRows.prototype.ROW_TEMPLATE="dwt.Widgets#DwtFormRow";
DwtFormRows.prototype.getTabGroupMember=function(){
return this._rowsTabGroup
};
DwtFormRows.prototype.setValue=function(o){
if(arguments.length>1){
DwtForm.prototype.setValue.apply(this,arguments);
return
}
var a=Math.max(o.length,this._minRows);
for(var t=this._rowCount;
t>a;
t--){
this.removeRow(t-1)
}
var e=Math.min(o.length,this._maxRows);
for(var t=this._rowCount;
t<e;
t++){
this.addRow()
}
for(var t=0;
t<e;
t++){
this.setValue(String(t),o[t],true)
}
for(var t=o.length;
t<this._rowCount;
t++){
this.setValue(String(t),null,true)
}};
DwtFormRows.prototype.getValue=function(){
if(arguments.length>0){
return DwtForm.prototype.getValue.apply(this,arguments)
}
var t=new Array(this._rowCount);
for(var e=0;
e<this._rowCount;
e++){
t[e]=this.getValue(String(e))
}
return t
};
DwtFormRows.prototype.getRowCount=function(){
return this._rowCount
};
DwtFormRows.prototype.addRow=function(n,o){
if(this._rowCount>=this._maxRows){
return
}
n=n||(this._rowDef&&AjxUtil.createProxy(this._rowDef));
if(!n){
return
}
if(o==null){
o=this._rowCount
}
for(var d=this._rowCount-1;
d>=o;
d--){
var w=d,u=d+1;
var m=this._items[w];
m.aka=String(u);
delete this._items[w];
this._items[m.aka]=m;
this._setControlIds(m.id,m.aka)
}
n.id=n.id||Dwt.getNextId();
n.aka=String(o);
this._rowCount++;
var v={
id:[this.getHTMLElId(),n.id].join("_")};
var p=AjxTemplate.expand(this.ROW_TEMPLATE,v);
var e=this._rowsEl;
e.appendChild(Dwt.toDocumentFragment(p,v.id+"_row"));
var g=e.lastChild;
if(o!=this._rowCount-1){
e.insertBefore(g,e.childNodes[o])
}
var y=[];
var h=this._registerControl(n,null,y);
var t=this._itemDef.additem?AjxUtil.createProxy(this._itemDef.additem):{
image:"Add",tooltip:ZmMsg.addRow};
t.id=t.id||n.id+"_add";
t.visible="this.getRowCount() < this.getMaxRows()";
t.ignore=true;
var c=this._registerControl(t,null,y,null,null,"DwtButton");
if(!t.onclick){
c.addSelectionListener(new AjxListener(this,this._handleAddRow,[n.id]))
}
var l=this._itemDef.removeitem?AjxUtil.createProxy(this._itemDef.removeitem):{
image:"Remove",tooltip:ZmMsg.removeRow};
l.id=l.id||n.id+"_remove";
l.visible="this.getRowCount() > this.getMinRows()";
l.ignore=true;
var f=this._registerControl(l,null,y,null,null,"DwtButton");
if(!l.onclick){
f.addSelectionListener(new AjxListener(this,this._handleRemoveRow,[n.id]))
}
var m=this._items[n.id];
m._rowEl=g;
m._addId=t.id;
m._removeId=l.id;
this._setControlIds(m.id,o);
var a=new DwtTabGroup(n.id);
y.sort(DwtForm.__byTabIndex);
for(var d=0;
d<y.length;
d++){
var s=y[d].control;
a.addMember(s.getTabGroupMember()||s)
}
if(o==this._rowCount-1){
this._rowsTabGroup.addMember(a)
}else{
var r=this._items[String(o+1)];
this._rowsTabGroup.addMemberBefore(a,DwtTabGroup.getByName(r.id))
}
this.update();
if(this._onaddrow){
this._call(this._onaddrow,[o])
}
return h
};
DwtFormRows.prototype.removeRow=function(l){
if(this._rowCount<=this._minRows){
return
}
var u=this._items[l];
var o=Dwt.isAncestor(u._rowEl,document.activeElement);
if(u.control instanceof DwtControl){
this.removeChild(u.control)
}
delete this._items[u.aka];
this._deleteItem(u.id);
var c=this._items[u._addId];
if(c){
this.removeChild(c.control);
this._deleteItem(c.id)
}
var d=this._items[u._removeId];
if(d){
this.removeChild(d.control);
this._deleteItem(d.id)
}
var h=Number(u.aka);
for(var n=h+1;
n<this._rowCount;
n++){
var r=n,a=n-1;
this._items[a]=this._items[r];
this._items[a].aka=String(a);
this._setControlIds(this._items[a].id,this._items[a].aka)
}
this._deleteItem(String(--this._rowCount));
var t=u._rowEl;
t.parentNode.removeChild(t);
delete u._rowEl;
var s=DwtTabGroup.getByName(u.id);
this._rowsTabGroup.removeMember(s);
this.update();
if(o){
var e=this._items[u.aka]||this._items[this._rowCount-1];
e.control.getTabGroupMember().focus()
}
if(this._onremoverow){
this._call(this._onremoverow,[Number(u.aka)])
}};
DwtFormRows.prototype.getMinRows=function(){
return this._minRows
};
DwtFormRows.prototype.getMaxRows=function(){
return this._maxRows
};
DwtFormRows.prototype.getRowCount=function(){
return this._rowCount
};
DwtFormRows.prototype.getIndexForRowId=function(a){
var t=this._rowsEl.childNodes;
for(var e=0;
e<t.length;
e++){
if(t[e].id==[this._htmlElId,a,"row"].join("_")){
return e
}}
return -1
};
DwtFormRows.__equals=function(t,e){
if(t===e){
return true
}
if(!t||!e||t.length!=e.length){
return false
}
for(var o=0;
o<t.length;
o++){
if(!this._call(this._equals,[t[o],e[o]])){
return false
}}
return true
};
DwtFormRows.prototype._setControlIds=function(o,e){
var n=[this.getHTMLElId(),e].join("_");
var i=this._items[o];
this._setControlId(i&&i.control,n);
var t=this._items[i._addId];
this._setControlId(t&&t.control,n+"_add");
var a=this._items[i._removeId];
this._setControlId(a&&a.control,n+"_remove")
};
DwtFormRows.prototype._setControlId=function(e,t){
if(!e){
return
}
if(e instanceof DwtControl){
e.setHtmlElementId(t)
}else{
e.id=t
}};
DwtFormRows.prototype._handleAddRow=function(t){
if(this.getRowCount()<this.getMaxRows()){
var e=this.getIndexForRowId(t)+1;
this.addRow(null,e)
}};
DwtFormRows.prototype._handleRemoveRow=function(e){
this.removeRow(e)
};
DwtFormRows.prototype._setModelValue=function(t,e){
if(DwtForm.prototype._setModelValue.apply(this,arguments)){
this.parent.setDirty(this._itemDef.id,true)
}};
DwtFormRows.prototype._createHtmlFromTemplate=function(e,t){
DwtForm.prototype._createHtmlFromTemplate.apply(this,arguments);
this._rowsEl=document.getElementById(this._htmlElId+"_rows")
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtComboBox")){
DwtComboBox=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtComboBox.PARAMS);
e.className=e.className||"DwtComboBox";
DwtComposite.call(this,e);
this.input=null;
this._menu=null;
this._button=null;
this._textToValue={};
this._valueToText={};
this._valueToItem={};
this._size=0;
this._hasMenuCallback=true;
this._menuItemListenerObj=new AjxListener(this,this._menuItemListener);
this._inputParams=e.inputParams;
this._useLabel=Boolean(e.useLabel);
this._maxRows=e.maxRows;
this._layout=e.layout;
this._autoScroll=e.autoScroll||false;
this._createHtml()
};
DwtComboBox.PARAMS=["parent","inputParams","className","posStyle","dialog"];
DwtComboBox.prototype=new DwtComposite;
DwtComboBox.prototype.constructor=DwtComboBox;
DwtComboBox.prototype.isDwtComboBox=true;
DwtComboBox.prototype.toString=function(){
return"DwtComboBox"
};
DwtComboBox.prototype.TEMPLATE="dwt.Widgets#DwtComboBox";
DwtComboBox.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtComboBox.prototype.addChangeListener=function(e){
this.addListener(DwtEvent.ONCHANGE,e)
};
DwtComboBox.prototype.removeChangeListener=function(e){
this.removeListener(DwtEvent.ONCHANGE,e)
};
DwtComboBox.prototype.add=function(i,t,e){
this._textToValue[i]=t;
this._valueToText[t]=i;
if(!this._hasMenuCallback){
var a=this._button.getMenu();
this._createMenuItem(a,i)
}
if(e){
this.setText(i)
}
this._size++;
this._updateButton()
};
DwtComboBox.prototype.remove=function(t){
var e=this._valueToItem[t];
if(e){
this._button.getMenu().removeChild(e);
var a=this._valueToText[t];
delete this._textToValue[a];
delete this._valueToText[t];
delete this._valueToItem[t];
if(this.getText()==a){
this.setText("")
}
this._size--;
this._updateButton()
}};
DwtComboBox.prototype.removeAll=function(){
this._button.setMenu(new AjxCallback(this,this._createMenu),true);
this._hasMenuCallback=true;
this._textToValue={};
this._valueToText={};
this._valueToItem={};
this._size=0;
this._updateButton()
};
DwtComboBox.prototype.getValue=function(){
var e=this.getText();
return this._textToValue[e]
};
DwtComboBox.prototype.setValue=function(e){
var t=this._valueToText[e];
this.setText(t||e)
};
DwtComboBox.prototype.getText=function(){
return this._useLabel?this.input.getText():this.input.getValue()
};
DwtComboBox.prototype.setText=function(e){
if(this._useLabel){
this.input.setText(e)
}else{
this.input.setValue(e)
}};
DwtComboBox.prototype.setEnabled=function(e){
if(e!=this._enabled){
DwtComposite.prototype.setEnabled.call(this,e);
this.input.setEnabled(e);
this._button.setEnabled(e)
}};
DwtComboBox.prototype.focus=function(){
return this.input.focus()
};
DwtComboBox.prototype.popdown=function(){
if(this._menu){
this._menu.popdown()
}};
DwtComboBox.prototype._createMenu=function(){
var n={
parent:this};
if(this._maxRows){
n.maxRows=this._maxRows
}
if(this._layout){
n.layout=this._layout
}
var o=this._menu=new DwtMenu(n);
for(var e in this._textToValue){
var t=this._createMenuItem(o,e);
var a=this._textToValue[e];
this._valueToItem[a]=t
}
this._hasMenuCallback=false;
return o
};
DwtComboBox.prototype._createMenuItem=function(a,t){
var e=new DwtMenuItem({
parent:a}
);
e.setText(t);
e.addSelectionListener(this._menuItemListenerObj);
if(!this._menuWidth){
this._menuWidth=this.getW()-10
}
e.getHtmlElement().style.minWidth=this._menuWidth;
return e
};
DwtComboBox.prototype._menuItemListener=function(i){
var t=i.dwtObj;
var o=this.getText();
var n=t.getText();
this.setText(n);
this._menu.popdown();
var a=DwtUiEvent.getEvent(i);
a._args={
selectObj:this,newValue:n,oldValue:o};
this.notifyListeners(DwtEvent.ONCHANGE,a);
if(!this._useLabel){
var e=this.input.getInputElement();
e.focus();
e.select()
}};
DwtComboBox.prototype._handleKeyDown=function(t){
var e=DwtKeyEvent.getCharCode(t);
this.__ovalue=this.getText();
return true
};
DwtComboBox.prototype._handleKeyUp=function(a){
DwtInputField._keyUpHdlr(a);
var t=DwtUiEvent.getEvent(a);
var i=this.getText();
t._args={
selectObj:this,newValue:i,oldValue:this.__ovalue};
this.notifyListeners(DwtEvent.ONCHANGE,t);
if(this._menu&&this._autoScroll&&i!=this.__ovalue){
var e=0;
for(var o in this._textToValue){
if(o.indexOf(i)==0){
this._menu.scrollToIndex(e);
break
}
e++
}}
return true
};
DwtComboBox.prototype._updateButton=function(){
this._button.setVisible(this._size>0)
};
DwtComboBox.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtComboBox.prototype._createHtmlFromTemplate=function(t,a){
DwtComposite.prototype._createHtmlFromTemplate.call(this,t,a);
var e=this._inputParams||{};
e.parent=this;
e.size=e.size||40;
delete this._inputParams;
this.input=(this._useLabel?new DwtLabel(e):new DwtInputField(e));
this.input.replaceElement(a.id+"_input");
this.input.setHandler(DwtEvent.ONKEYDOWN,AjxCallback.simpleClosure(this._handleKeyDown,this));
this.input.setHandler(DwtEvent.ONKEYUP,AjxCallback.simpleClosure(this._handleKeyUp,this));
this._button=new DwtComboBoxButton({
parent:this}
);
this._button.setMenu(new AjxListener(this,this._createMenu),true);
this._button.replaceElement(a.id+"_button");
this._updateButton();
this._tabGroup=new DwtTabGroup(this._htmlElId);
this._tabGroup.addMember(this.input);
this._tabGroup.addMember(this._button)
};
DwtComboBox.prototype._replaceElementHook=function(t,i,e,o){
DwtComposite.prototype._replaceElementHook.apply(this,arguments);
if(t.size){
var a=(this._useLabel?this.input.getHtmlElement():this.input.getInputElement());
a.size=t.size
}
if(t.title){
this.input.setHint(t.title)
}};
DwtComboBoxButton=function(e){
e=Dwt.getParams(arguments,DwtComboBoxButton.PARAMS);
e.posStyle=Dwt.RELATIVE_STYLE;
DwtButton.call(this,e)
};
DwtComboBoxButton.prototype=new DwtButton;
DwtComboBoxButton.prototype.constructor=DwtComboBoxButton;
DwtComboBoxButton.prototype.toString=function(){
return"DwtComboBoxButton"
};
DwtComboBoxButton.PARAMS=["parent","className"];
DwtComboBoxButton.prototype.TEMPLATE="dwt.Widgets#DwtComboBoxButton"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTimeSelect")){
DwtTimeSelect=function(e,t){
DwtComposite.call(this,{
parent:e,className:"DwtTimeSelect"}
);
this.id=t;
this._isLocale24Hour=true;
this._createSelects()
};
DwtTimeSelect.START=1;
DwtTimeSelect.END=2;
DwtTimeSelect.HOUR=1;
DwtTimeSelect.MINUTE=2;
DwtTimeSelect.AMPM=3;
DwtTimeSelect.getDateFromFields=function(e,i,a,t){
e=Number(e);
if(a){
if(a=="AM"||a===0){
e=(e==12)?0:e
}else{
if(a=="PM"||a==1){
e=(e<12)?e+12:e
}}}
t=t?t:new Date();
t.setHours(e,Number(i),0,0);
return t
};
DwtTimeSelect.parse=function(a){
var t;
var i=a.toLowerCase();
if(i===AjxMsg.midnight.toLowerCase()||i===AjxMsg.noon.toLowerCase()){
t=new Date();
t.setMinutes(0);
t.setSeconds(0);
t.setHours(i===AjxMsg.noon.toLowerCase()?12:0)
}else{
var e=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
t=e.parse(a)||AjxDateFormat.parseTime(a)
}
return t
};
DwtTimeSelect.format=function(e){
if(e.getHours()==0&&e.getMinutes()==0){
return AjxMsg.midnight
}else{
if(e.getHours()==12&&e.getMinutes()==0){
return AjxMsg.noon
}else{
return AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT).format(e)
}}};
DwtTimeSelect.adjustStartEnd=function(y,e,h,l,u){
var s=y._args.selectObj;
var t=AjxDateUtil.simpleParseDateStr(l.value);
var p=AjxDateUtil.simpleParseDateStr(u.value);
var n=l.value;
var a=u.value;
if(s.id==DwtTimeSelect.START){
var m=(s.compId==DwtTimeSelect.HOUR)?y._args.oldValue:e.getHours();
var c=(s.compId==DwtTimeSelect.MINUTE)?y._args.oldValue:e.getMinutes();
var i=(s.compId==DwtTimeSelect.AMPM)?y._args.oldValue:e.getAmPm();
var d=DwtTimeSelect.getDateFromFields(m,c,i,t).getTime();
var r=DwtTimeSelect.getDateFromFields(e.getHours(),e.getMinutes(),e.getAmPm(),t).getTime();
var f=DwtTimeSelect.getDateFromFields(h.getHours(),h.getMinutes(),h.getAmPm(),p).getTime();
var w=f-d;
if(!w){
return null
}
var o=r+w;
var g=new Date(o);
h.set(g);
u.value=AjxDateUtil.simpleComputeDateStr(g);
if(u.value!=a){
return u
}}else{
return null
}};
DwtTimeSelect.validStartEnd=function(r,t,i,s){
var e=AjxDateUtil.simpleParseDateStr(r.value);
var n=AjxDateUtil.simpleParseDateStr(t.value);
if(e&&n){
if((e.valueOf()>n.valueOf())){
return false
}
if(e.getFullYear()>9999||n.getFullYear()>9999){
return false
}
if(i&&s){
var a=DwtTimeSelect.getDateFromFields(i.getHours(),i.getMinutes(),i.getAmPm(),e).getTime();
var o=DwtTimeSelect.getDateFromFields(s.getHours(),s.getMinutes(),s.getAmPm(),n).getTime();
if(a>o){
return false
}}}else{
return false
}
return true
};
DwtTimeSelect.prototype=new DwtComposite;
DwtTimeSelect.prototype.constructor=DwtTimeSelect;
DwtTimeSelect.prototype.isDwtTimeSelect=true;
DwtTimeSelect.prototype.toString=function(){
return"DwtTimeSelect"
};
DwtTimeSelect.prototype.set=function(i){
var a=0,n=0,o=0;
var t=this.isLocale24Hour();
var e=i.getHours();
if(!t&&e>12){
a=e-13
}else{
if(!t&&e==0){
a=this.getHourSelectSize()-1
}else{
a=t?e:e-1
}}
n=Math.floor(i.getMinutes()/5);
if(!t){
o=(i.getHours()>=12)?1:0
}
this.setSelected(a,n,o)
};
DwtTimeSelect.prototype.getValue=function(e){
return(DwtTimeSelect.getDateFromFields(this.getHours(),this.getMinutes(),this.getAmPm(),e))
};
DwtTimeSelect.prototype.getHours=function(){
return this._hourSelect.getValue()
};
DwtTimeSelect.prototype.getMinutes=function(){
return this._minuteSelect.getValue()
};
DwtTimeSelect.prototype.getAmPm=function(){
return this._amPmSelect?this._amPmSelect.getValue():null
};
DwtTimeSelect.prototype.setSelected=function(e,a,t){
this._hourSelect.setSelected(e);
this._minuteSelect.setSelected(a);
if(!this._isLocale24Hour){
this._amPmSelect.setSelected(t)
}};
DwtTimeSelect.prototype.addChangeListener=function(e){
this._hourSelect.addChangeListener(e);
this._minuteSelect.addChangeListener(e);
if(this._amPmSelect){
this._amPmSelect.addChangeListener(e)
}};
DwtTimeSelect.prototype.isLocale24Hour=function(){
return this._isLocale24Hour
};
DwtTimeSelect.prototype.getHourSelectSize=function(){
return this._hourSelect.size()
};
DwtTimeSelect.prototype.getMinuteSelectSize=function(){
return this._minuteSelect.size()
};
DwtTimeSelect.prototype.getSelectedHourIdx=function(){
return this._hourSelect.getSelectedIndex()
};
DwtTimeSelect.prototype.getSelectedMinuteIdx=function(){
return this._minuteSelect.getSelectedIndex()
};
DwtTimeSelect.prototype.getSelectedAmPmIdx=function(){
return this._amPmSelect?this._amPmSelect.getSelectedIndex():0
};
DwtTimeSelect.prototype.setEnabled=function(e){
DwtComposite.prototype.setEnabled.call(this,e);
this._hourSelect.setEnabled(e);
this._minuteSelect.setEnabled(e);
if(this._amPmSelect){
this._amPmSelect.setEnabled(e)
}};
DwtTimeSelect.prototype._createSelects=function(){
this._hourSelectId=Dwt.getNextId();
this._minuteSelectId=Dwt.getNextId();
this._amPmSelectId=Dwt.getNextId();
var o=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
var s=0;
var d=0;
var c=[];
var h=0;
c[h++]="<table border=0 cellpadding=0 cellspacing=0><tr>";
for(var r=0;
r<o._segments.length;
r++){
var l=o._segments[r]._s;
if(o._segments[r] instanceof AjxFormat.TextSegment){
var e=AjxStringUtil.trim(l);
if(e.length){
c[h++]="<td class='TextPadding ZmFieldLabel'>";
c[h++]=l;
c[h++]="</td>"
}}else{
if(l.charAt(0)=="h"||l.charAt(0)=="H"){
s=r;
c[h++]="<td width=42 id='";
c[h++]=this._hourSelectId;
c[h++]="'></td>"
}else{
if(l.charAt(0)=="m"){
d=r;
c[h++]="<td width=42 id='";
c[h++]=this._minuteSelectId;
c[h++]="'></td>"
}else{
if(l=="a"){
this._isLocale24Hour=false;
c[h++]="<td width=42 id='";
c[h++]=this._amPmSelectId;
c[h++]="'></td>"
}}}}}
c[h++]="</tr></table>";
this.getHtmlElement().innerHTML=c.join("");
var a=new Date();
var t=this._isLocale24Hour?0:1;
var n=this._isLocale24Hour?24:13;
this._hourSelect=new DwtSelect({
parent:this}
);
this._hourSelect.id=this.id;
this._hourSelect.compId=DwtTimeSelect.HOUR;
for(var h=t;
h<n;
h++){
a.setHours(h);
var u=o._segments[s].format(a);
this._hourSelect.addOption(u,false,h)
}
this._hourSelect.reparentHtmlElement(this._hourSelectId);
delete this._hourSelectId;
this._minuteSelect=new DwtSelect({
parent:this}
);
this._minuteSelect.id=this.id;
this._minuteSelect.compId=DwtTimeSelect.MINUTE;
for(var h=0;
h<60;
h=h+5){
a.setMinutes(h);
var u=o._segments[d].format(a);
this._minuteSelect.addOption(u,false,h)
}
this._minuteSelect.reparentHtmlElement(this._minuteSelectId);
delete this._minuteSelectId;
if(!this._isLocale24Hour){
this._amPmSelect=new DwtSelect({
parent:this}
);
this._amPmSelect.id=this.id;
this._amPmSelect.compId=DwtTimeSelect.AMPM;
this._amPmSelect.addOption(I18nMsg.periodAm,false,"AM");
this._amPmSelect.addOption(I18nMsg.periodPm,false,"PM");
this._amPmSelect.reparentHtmlElement(this._amPmSelectId);
delete this._amPmSelectId
}};
DwtTimeInput=function(a,o,e,t){
var i={
parent:a,id:"DwtTimeInput",className:"DwtTimeInput"};
if(e){
i.parentElement=e
}
DwtComposite.call(this,i);
this._interval=t||DwtTimeInput.FIFTEEN_MIN_INTERVAL;
this.id=o;
this._isLocale24Hour=true;
this._createSelects();
this._useTextInput=true
};
DwtTimeInput.THIRTY_MIN_INTERVAL=30;
DwtTimeInput.FIFTEEN_MIN_INTERVAL=15;
DwtTimeInput.START=1;
DwtTimeInput.END=2;
DwtTimeInput.HOUR=1;
DwtTimeInput.MINUTE=2;
DwtTimeInput.AMPM=3;
DwtTimeInput.ROWS=8;
DwtTimeInput.DEFAULT_TOP_ROW=8;
DwtTimeInput.getDateFromFields=function(t,e){
var a=DwtTimeSelect.parse(t);
e=e||new Date();
e.setHours(a.getHours(),a.getMinutes(),0,0);
return e
};
DwtTimeInput.adjustStartEnd=function(y,e,r,l,d,p,n){
var t=AjxDateUtil.simpleParseDateStr(l.value);
var f=AjxDateUtil.simpleParseDateStr(d.value);
var i=l.value;
var a=d.value;
if(n==DwtTimeInput.START){
var h=p?p.startTimeStr:e.getTimeString();
var c=DwtTimeInput.getDateFromFields(h,t).getTime();
var s=DwtTimeInput.getDateFromFields(e.getTimeString(),t).getTime();
var m=DwtTimeInput.getDateFromFields(r.getTimeString(),f).getTime();
var w=m-c;
if(!w){
return null
}
var o=s+w;
var g=new Date(o);
e.set(new Date(s));
r.set(g);
d.value=AjxDateUtil.simpleComputeDateStr(g);
if(d.value!=a){
return d
}}else{
if(n==DwtTimeInput.END){
var h=p?p.endTimeStr:r.getTimeString();
var m=DwtTimeInput.getDateFromFields(h,f).getTime();
var o=DwtTimeInput.getDateFromFields(r.getTimeString(),f).getTime();
var c=DwtTimeInput.getDateFromFields(e.getTimeString(),t).getTime();
var w=m-c;
if(!w){
return null
}
if(o<c){
var s=o-w;
var u=new Date(s);
e.set(u);
r.set(new Date(o));
l.value=AjxDateUtil.simpleComputeDateStr(u);
d.value=AjxDateUtil.simpleComputeDateStr(new Date(o))
}
if(l.value!=i){
return l
}}else{
return null
}}};
DwtTimeInput.validStartEnd=function(o,e,l,h){
var i=AjxDateUtil.simpleParseDateStr(o.value);
var s=AjxDateUtil.simpleParseDateStr(e.value);
if(i&&s){
if((i.valueOf()>s.valueOf())){
return false
}
if(i.getFullYear()>9999||s.getFullYear()>9999){
return false
}
if(l&&h){
var a=l.getTimeString();
var r=h.getTimeString();
if(a&&r){
var t=DwtTimeInput.getDateFromFields(a,i).getTime();
var n=DwtTimeInput.getDateFromFields(r,s).getTime();
if(t>n){
return false
}}}}else{
return false
}
return true
};
DwtTimeInput.prototype=new DwtComposite;
DwtTimeInput.prototype.constructor=DwtTimeInput;
DwtTimeInput.prototype.isDwtTimeInput=true;
DwtTimeInput.prototype.toString=function(){
return"DwtTimeInput"
};
DwtTimeInput.prototype.set=function(e){
var t=DwtTimeSelect.format(e);
this._originalTimeStr=t;
this._timeSelectInput.setValue(t);
this._scrollToValue(t)
};
DwtTimeInput.prototype.setValue=function(t){
var e=DwtTimeSelect.parse(t);
if(!e){
t=""
}
this._originalTimeStr=t;
this._timeSelectInput.setValue(t);
this._scrollToValue(t)
};
DwtTimeInput.prototype._scrollToValue=function(t){
var e=this.getTimeIndex(t);
if(e!==null){
this._hoursSelectMenu.setSelectedItem(e)
}};
DwtTimeInput.prototype.getValue=function(e){
var t=DwtTimeSelect.parse(this._timeSelectInput.getValue());
if(!t){
t=new Date()
}
e=e||new Date();
if(AjxDateUtil.isDayShifted(e)){
AjxDateUtil.rollToNextDay(e)
}
e.setHours(t.getHours(),t.getMinutes(),0,0);
return e
};
DwtTimeInput.prototype.getHours=function(){
var e=this.getValue();
return e?e.getHours():null
};
DwtTimeInput.prototype.getMinutes=function(){
var e=this.getValue();
return e?e.getMinutes():null
};
DwtTimeInput.prototype.addChangeListener=function(e){
this._changeListener=e;
var t=AjxCallback.simpleClosure(this.handleTimeChange,this,e);
this._timeSelectInput.setHandler(DwtEvent.ONBLUR,t)
};
DwtTimeInput.prototype.handleTimeChange=function(t,e){
var i=this._timeSelectInput.getValue();
var a=DwtTimeSelect.parse(i);
if(!a){
this.setValue(this._originalTimeStr)
}else{
this._scrollToValue(i)
}
t.run(e,this.id)
};
DwtTimeInput.prototype.correctTimeString=function(o,t){
var e=o.split(":");
if(!e){
return t
}
var a=(e.length&&e[0]!=null)?parseInt(e[0].replace(/\D/g,"")):null;
var i=(e.length>1&&e[1]!=null)?parseInt(e[1].replace(/\D/g,"")):0;
if(!a){
a=(a==0)?0:t.getHours()
}
if(!i){
i=0
}
t.setHours(a,i,0,0);
return t
};
DwtTimeInput.prototype.isLocale24Hour=function(){
return this._isLocale24Hour
};
DwtTimeInput.prototype.setEnabled=function(e){
DwtComposite.prototype.setEnabled.call(this,e);
this._timeSelectInput.setEnabled(e);
this._timeSelectBtn.setEnabled(e)
};
DwtTimeInput.prototype._timeButtonListener=function(d){
var t=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
var o;
if(!this._menuItemsAdded){
var i,a,r,s,u,n,c,e=new Date(),l=this._timeSelectBtn,h=new AjxListener(this,this._timeSelectionListener);
for(i=0;
i<24;
i++){
e.setHours(i);
e.setMinutes(0);
r=new DwtMenuItem({
parent:this._hoursSelectMenu,style:DwtMenuItem.NO_STYLE}
);
u=t.format(e);
this.putTimeIndex(u,i);
if(i==0||i==12){
u=DwtTimeSelect.format(e);
this.putTimeIndex(u,i)
}
r.setText(u);
r.setData("value",i*60);
if(h){
r.addSelectionListener(h)
}
if(i==DwtTimeInput.DEFAULT_TOP_ROW){
o=r
}
n=60/this._interval;
c=new DwtMenu({
parent:r,style:DwtMenu.DROPDOWN_CENTERV_STYLE,layout:DwtMenu.LAYOUT_CASCADE,maxRows:n,congruent:true}
);
r.setMenu(c,true);
r.setSelectableWithSubmenu(true);
c.dontStealFocus(true);
for(a=1;
a<n;
a++){
e.setMinutes(a*this._interval);
s=new DwtMenuItem({
parent:c,style:DwtMenuItem.NO_STYLE}
);
s.setText(t.format(e));
s.setData("value",i*60+a*this._interval);
if(h){
s.addSelectionListener(h)
}}}
this._hoursSelectMenu.setWidth(l.getW()+this._timeSelectInput.getW());
this._menuItemsAdded=true
}
d.item.popup();
if(o){
this._hoursSelectMenu.scrollToItem(o)
}
this._scrollToValue(t.format(this.getValue()))
};
DwtTimeInput.prototype._timeSelectionListener=function(e){
if(e.item&&e.item instanceof DwtMenuItem){
this._timeSelectInput.setValue(e.item.getText());
this._timeSelectValue=e.item.getData("value");
if(this._changeListener){
this._changeListener.run(e,this.id)
}
return
}};
DwtTimeInput.prototype.getTimeString=function(){
var e=DwtTimeSelect.parse(this._timeSelectInput.getValue());
return e?this._timeSelectInput.getValue():""
};
DwtTimeInput.prototype.getInputField=function(){
return this._timeSelectInput
};
DwtTimeInput.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtTimeInput.prototype.putTimeIndex=function(t,e){
this._timeIndex[t.replace(/\:\d\d/,":00").replace(/\s/,"").toLowerCase()]=e
};
DwtTimeInput.prototype.getTimeIndex=function(t){
if(!t){
return null
}
var e=this._timeIndex[t.replace(/\:\d\d/,":00").replace(/\s/,"").toLowerCase()];
return(e||e===0)?e:null
};
DwtTimeInput.prototype._createSelects=function(){
var o=(this.id===DwtTimeSelect.START?ZmMsg.startTime:this.id===DwtTimeSelect.END?ZmMsg.endTime:ZmMsg.time);
this.getHtmlElement().innerHTML=AjxTemplate.expand("calendar.Appointment#ApptTimeInput",{
id:this._htmlElId}
);
var a=Dwt.getNextId("DwtTimeInputSelect_");
if(this.id&&this.id==DwtTimeSelect.START){
a+="_startTimeInput"
}else{
if(this.id&&this.id==DwtTimeSelect.END){
a+="_endTimeInput"
}}
var s={
parent:this,parentElement:(this._htmlElId+"_timeSelectInput"),type:DwtInputField.STRING,label:o,errorIconStyle:DwtInputField.ERROR_ICON_NONE,validationStyle:DwtInputField.CONTINUAL_VALIDATION,inputId:a,id:Dwt.getNextId("DwtTimeInputField_")};
this._timeSelectInput=new DwtInputField(s);
var i=this._timeSelectInput.getInputElement();
Dwt.setSize(i,"80px","2rem");
i.typeId=this.id;
var e=new AjxListener(this,this._timeButtonListener);
var n=this._htmlElId+"_timeSelectBtn";
var t=this._timeSelectBtn=new DwtButton({
parent:this}
);
t.addDropDownSelectionListener(e);
t.setData(Dwt.KEY_ID,n);
t.setSize("20");
t.setAttribute("aria-label",o);
this._timeIndex={};
this._hoursSelectMenu=new DwtMenu({
parent:t,style:DwtMenu.DROPDOWN_STYLE,layout:DwtMenu.LAYOUT_SCROLL,maxRows:DwtTimeInput.ROWS}
);
t.setMenu(this._hoursSelectMenu,true,false,false,true);
this._menuItemsAdded=false;
t.reparentHtmlElement(n);
this._tabGroup=new DwtTabGroup(this.getHTMLElId());
this._tabGroup.addMember(this._timeSelectInput);
this._tabGroup.addMember(t)
}
}
if(AjxPackage.define("ajax.3rdparty.jquery.jquery")){
/* jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(t,e){
"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(i){
if(!i.document){
throw new Error("jQuery requires a window with a document")
}
return e(i)
}
:e(t)
}
("undefined"!=typeof window?window:this,function(a,b){
var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={}
,i=h.toString,j=h.hasOwnProperty,k="".trim,l={}
,m="1.11.0",n=function(a,b){
return new n.fn.init(a,b)
}
,o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){
return b.toUpperCase()
};
n.fn=n.prototype={
jquery:m,constructor:n,selector:"",length:0,toArray:function(){
return d.call(this)
}
,get:function(a){
return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)
}
,pushStack:function(a){
var b=n.merge(this.constructor(),a);
return b.prevObject=this,b.context=this.context,b
}
,each:function(a,b){
return n.each(this,a,b)
}
,map:function(a){
return this.pushStack(n.map(this,function(b,c){
return a.call(b,c,b)
}
))
}
,slice:function(){
return this.pushStack(d.apply(this,arguments))
}
,first:function(){
return this.eq(0)
}
,last:function(){
return this.eq(-1)
}
,eq:function(a){
var b=this.length,c=+a+(0>a?b:0);
return this.pushStack(c>=0&&b>c?[this[c]]:[])
}
,end:function(){
return this.prevObject||this.constructor(null)
}
,push:f,sort:c.sort,splice:c.splice}
,n.extend=n.fn.extend=function(){
var a,b,c,d,e,f,g=arguments[0]||{}
,h=1,i=arguments.length,j=!1;
for("boolean"==typeof g&&(j=g,g=arguments[h]||{}
,h++),"object"==typeof g||n.isFunction(g)||(g={}
),h===i&&(g=this,h--);
i>h;
h++){
if(null!=(e=arguments[h])){
for(d in e){
a=g[d],c=e[d],g!==c&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(b?(b=!1,f=a&&n.isArray(a)?a:[]):f=a&&n.isPlainObject(a)?a:{}
,g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c))
}}}
return g
}
,n.extend({
expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){
throw new Error(a)
}
,noop:function(){}
,isFunction:function(a){
return"function"===n.type(a)
}
,isArray:Array.isArray||function(a){
return"array"===n.type(a)
}
,isWindow:function(a){
return null!=a&&a==a.window
}
,isNumeric:function(a){
return a-parseFloat(a)>=0
}
,isEmptyObject:function(a){
var b;
for(b in a){
return !1
}
return !0
}
,isPlainObject:function(a){
var b;
if(!a||"object"!==n.type(a)||a.nodeType||n.isWindow(a)){
return !1
}
try{
if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf")){
return !1
}}
catch(c){
return !1
}
if(l.ownLast){
for(b in a){
return j.call(a,b)
}}
for(b in a){}
return void 0===b||j.call(a,b)
}
,type:function(a){
return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a
}
,globalEval:function(b){
b&&n.trim(b)&&(a.execScript||function(b){
a.eval.call(a,b)
}
)(b)
}
,camelCase:function(a){
return a.replace(p,"ms-").replace(q,r)
}
,nodeName:function(a,b){
return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()
}
,each:function(a,b,c){
var d,e=0,f=a.length,g=s(a);
if(c){
if(g){
for(;
f>e;
e++){
if(d=b.apply(a[e],c),d===!1){
break
}}}else{
for(e in a){
if(d=b.apply(a[e],c),d===!1){
break
}}}}else{
if(g){
for(;
f>e;
e++){
if(d=b.call(a[e],e,a[e]),d===!1){
break
}}}else{
for(e in a){
if(d=b.call(a[e],e,a[e]),d===!1){
break
}}}}
return a
}
,trim:k&&!k.call("\ufeff\xa0")?function(a){
return null==a?"":k.call(a)
}
:function(a){
return null==a?"":(a+"").replace(o,"")
}
,makeArray:function(a,b){
var c=b||[];
return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c
}
,inArray:function(a,b,c){
var d;
if(b){
if(g){
return g.call(b,a,c)
}
for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;
d>c;
c++){
if(c in b&&b[c]===a){
return c
}}}
return -1
}
,merge:function(a,b){
var c=+b.length,d=0,e=a.length;
while(c>d){
a[e++]=b[d++]
}
if(c!==c){
while(void 0!==b[d]){
a[e++]=b[d++]
}}
return a.length=e,a
}
,grep:function(a,b,c){
for(var d,e=[],f=0,g=a.length,h=!c;
g>f;
f++){
d=!b(a[f],f),d!==h&&e.push(a[f])
}
return e
}
,map:function(a,b,c){
var d,f=0,g=a.length,h=s(a),i=[];
if(h){
for(;
g>f;
f++){
d=b(a[f],f,c),null!=d&&i.push(d)
}}else{
for(f in a){
d=b(a[f],f,c),null!=d&&i.push(d)
}}
return e.apply([],i)
}
,guid:1,proxy:function(a,b){
var c,e,f;
return"string"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),e=function(){
return a.apply(b||this,c.concat(d.call(arguments)))
}
,e.guid=a.guid=a.guid||n.guid++,e):void 0
}
,now:function(){
return +new Date
}
,support:l}
),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){
h["[object "+b+"]"]=b.toLowerCase()
}
);
function s(a){
var b=a.length,c=n.type(a);
return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a
}
var t=function(a){
var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s="sizzle"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){
return a===b&&(j=!0),0
}
,A="undefined",B=1<<31,C={}
.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=D.indexOf||function(a){
for(var b=0,c=this.length;
c>b;
b++){
if(this[b]===a){
return b
}}
return -1
}
,J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",M=L.replace("w","w#"),N="\\["+K+"*("+L+")"+K+"*(?:([*^$|!~]?=)"+K+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+M+")|)|)"+K+"*\\]",O=":("+L+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+N.replace(3,8)+")*)|.*)\\)|)",P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(O),U=new RegExp("^"+M+"$"),V={
ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L.replace("w","w*")+")"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")}
,W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=/'|\\/g,ab=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),bb=function(a,b,c){
var d="0x"+b-65536;
return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)
};
try{
G.apply(D=H.call(t.childNodes),t.childNodes),D[t.childNodes.length].nodeType
}
catch(cb){
G={
apply:D.length?function(a,b){
F.apply(a,H.call(b))
}
:function(a,b){
var c=a.length,d=0;
while(a[c++]=b[d++]){}
a.length=c-1
}}
}
function db(a,b,d,e){
var f,g,h,i,j,m,p,q,u,v;
if((b?b.ownerDocument||b:t)!==l&&k(b),b=b||l,d=d||[],!a||"string"!=typeof a){
return d
}
if(1!==(i=b.nodeType)&&9!==i){
return[]
}
if(n&&!e){
if(f=Z.exec(a)){
if(h=f[1]){
if(9===i){
if(g=b.getElementById(h),!g||!g.parentNode){
return d
}
if(g.id===h){
return d.push(g),d
}}else{
if(b.ownerDocument&&(g=b.ownerDocument.getElementById(h))&&r(b,g)&&g.id===h){
return d.push(g),d
}}}else{
if(f[2]){
return G.apply(d,b.getElementsByTagName(a)),d
}
if((h=f[3])&&c.getElementsByClassName&&b.getElementsByClassName){
return G.apply(d,b.getElementsByClassName(h)),d
}}}
if(c.qsa&&(!o||!o.test(a))){
if(q=p=s,u=b,v=9===i&&a,1===i&&"object"!==b.nodeName.toLowerCase()){
m=ob(a),(p=b.getAttribute("id"))?q=p.replace(_,"\\$&"):b.setAttribute("id",q),q="[id='"+q+"'] ",j=m.length;
while(j--){
m[j]=q+pb(m[j])
}
u=$.test(a)&&mb(b.parentNode)||b,v=m.join(",")
}
if(v){
try{
return G.apply(d,u.querySelectorAll(v)),d
}
catch(w){}
finally{
p||b.removeAttribute("id")
}}}}
return xb(a.replace(P,"$1"),b,d,e)
}
function eb(){
var a=[];
function b(c,e){
return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e
}
return b
}
function fb(a){
return a[s]=!0,a
}
function gb(a){
var b=l.createElement("div");
try{
return !!a(b)
}
catch(c){
return !1
}
finally{
b.parentNode&&b.parentNode.removeChild(b),b=null
}}
function hb(a,b){
var c=a.split("|"),e=a.length;
while(e--){
d.attrHandle[c[e]]=b
}}
function ib(a,b){
var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||B)-(~a.sourceIndex||B);
if(d){
return d
}
if(c){
while(c=c.nextSibling){
if(c===b){
return -1
}}}
return a?1:-1
}
function jb(a){
return function(b){
var c=b.nodeName.toLowerCase();
return"input"===c&&b.type===a
}
}
function kb(a){
return function(b){
var c=b.nodeName.toLowerCase();
return("input"===c||"button"===c)&&b.type===a
}
}
function lb(a){
return fb(function(b){
return b=+b,fb(function(c,d){
var e,f=a([],c.length,b),g=f.length;
while(g--){
c[e=f[g]]&&(c[e]=!(d[e]=c[e]))
}}
)
}
)
}
function mb(a){
return a&&typeof a.getElementsByTagName!==A&&a
}
c=db.support={}
,f=db.isXML=function(a){
var b=a&&(a.ownerDocument||a).documentElement;
return b?"HTML"!==b.nodeName:!1
}
,k=db.setDocument=function(a){
var b,e=a?a.ownerDocument||a:t,g=e.defaultView;
return e!==l&&9===e.nodeType&&e.documentElement?(l=e,m=e.documentElement,n=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){
k()
}
,!1):g.attachEvent&&g.attachEvent("onunload",function(){
k()
}
)),c.attributes=gb(function(a){
return a.className="i",!a.getAttribute("className")
}
),c.getElementsByTagName=gb(function(a){
return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length
}
),c.getElementsByClassName=Y.test(e.getElementsByClassName)&&gb(function(a){
return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length
}
),c.getById=gb(function(a){
return m.appendChild(a).id=s,!e.getElementsByName||!e.getElementsByName(s).length
}
),c.getById?(d.find.ID=function(a,b){
if(typeof b.getElementById!==A&&n){
var c=b.getElementById(a);
return c&&c.parentNode?[c]:[]
}}
,d.filter.ID=function(a){
var b=a.replace(ab,bb);
return function(a){
return a.getAttribute("id")===b
}
}
):(delete d.find.ID,d.filter.ID=function(a){
var b=a.replace(ab,bb);
return function(a){
var c=typeof a.getAttributeNode!==A&&a.getAttributeNode("id");
return c&&c.value===b
}
}
),d.find.TAG=c.getElementsByTagName?function(a,b){
return typeof b.getElementsByTagName!==A?b.getElementsByTagName(a):void 0
}
:function(a,b){
var c,d=[],e=0,f=b.getElementsByTagName(a);
if("*"===a){
while(c=f[e++]){
1===c.nodeType&&d.push(c)
}
return d
}
return f
}
,d.find.CLASS=c.getElementsByClassName&&function(a,b){
return typeof b.getElementsByClassName!==A&&n?b.getElementsByClassName(a):void 0
}
,p=[],o=[],(c.qsa=Y.test(e.querySelectorAll))&&(gb(function(a){
a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&o.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||o.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll(":checked").length||o.push(":checked")
}
),gb(function(a){
var b=e.createElement("input");
b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&o.push("name"+K+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||o.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),o.push(",.*:")
}
)),(c.matchesSelector=Y.test(q=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&gb(function(a){
c.disconnectedMatch=q.call(a,"div"),q.call(a,"[s!='']:x"),p.push("!=",O)
}
),o=o.length&&new RegExp(o.join("|")),p=p.length&&new RegExp(p.join("|")),b=Y.test(m.compareDocumentPosition),r=b||Y.test(m.contains)?function(a,b){
var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;
return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))
}
:function(a,b){
if(b){
while(b=b.parentNode){
if(b===a){
return !0
}}}
return !1
}
,z=b?function(a,b){
if(a===b){
return j=!0,0
}
var d=!a.compareDocumentPosition-!b.compareDocumentPosition;
return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===t&&r(t,a)?-1:b===e||b.ownerDocument===t&&r(t,b)?1:i?I.call(i,a)-I.call(i,b):0:4&d?-1:1)
}
:function(a,b){
if(a===b){
return j=!0,0
}
var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],k=[b];
if(!f||!g){
return a===e?-1:b===e?1:f?-1:g?1:i?I.call(i,a)-I.call(i,b):0
}
if(f===g){
return ib(a,b)
}
c=a;
while(c=c.parentNode){
h.unshift(c)
}
c=b;
while(c=c.parentNode){
k.unshift(c)
}
while(h[d]===k[d]){
d++
}
return d?ib(h[d],k[d]):h[d]===t?-1:k[d]===t?1:0
}
,e):l
}
,db.matches=function(a,b){
return db(a,null,null,b)
}
,db.matchesSelector=function(a,b){
if((a.ownerDocument||a)!==l&&k(a),b=b.replace(S,"='$1']"),!(!c.matchesSelector||!n||p&&p.test(b)||o&&o.test(b))){
try{
var d=q.call(a,b);
if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType){
return d
}}
catch(e){}}
return db(b,l,null,[a]).length>0
}
,db.contains=function(a,b){
return(a.ownerDocument||a)!==l&&k(a),r(a,b)
}
,db.attr=function(a,b){
(a.ownerDocument||a)!==l&&k(a);
var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!n):void 0;
return void 0!==f?f:c.attributes||!n?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null
}
,db.error=function(a){
throw new Error("Syntax error, unrecognized expression: "+a)
}
,db.uniqueSort=function(a){
var b,d=[],e=0,f=0;
if(j=!c.detectDuplicates,i=!c.sortStable&&a.slice(0),a.sort(z),j){
while(b=a[f++]){
b===a[f]&&(e=d.push(f))
}
while(e--){
a.splice(d[e],1)
}}
return i=null,a
}
,e=db.getText=function(a){
var b,c="",d=0,f=a.nodeType;
if(f){
if(1===f||9===f||11===f){
if("string"==typeof a.textContent){
return a.textContent
}
for(a=a.firstChild;
a;
a=a.nextSibling){
c+=e(a)
}}else{
if(3===f||4===f){
return a.nodeValue
}}}else{
while(b=a[d++]){
c+=e(b)
}}
return c
}
,d=db.selectors={
cacheLength:50,createPseudo:fb,match:V,attrHandle:{}
,find:{}
,relative:{
">":{
dir:"parentNode",first:!0}
," ":{
dir:"parentNode"}
,"+":{
dir:"previousSibling",first:!0}
,"~":{
dir:"previousSibling"}}
,preFilter:{
ATTR:function(a){
return a[1]=a[1].replace(ab,bb),a[3]=(a[4]||a[5]||"").replace(ab,bb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)
}
,CHILD:function(a){
return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||db.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&db.error(a[0]),a
}
,PSEUDO:function(a){
var b,c=!a[5]&&a[2];
return V.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&T.test(c)&&(b=ob(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))
}}
,filter:{
TAG:function(a){
var b=a.replace(ab,bb).toLowerCase();
return"*"===a?function(){
return !0
}
:function(a){
return a.nodeName&&a.nodeName.toLowerCase()===b
}
}
,CLASS:function(a){
var b=w[a+" "];
return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&w(a,function(a){
return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==A&&a.getAttribute("class")||"")
}
)
}
,ATTR:function(a,b,c){
return function(d){
var e=db.attr(d,a);
return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0
}
}
,CHILD:function(a,b,c,d,e){
var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;
return 1===d&&0===e?function(a){
return !!a.parentNode
}
:function(b,c,i){
var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),t=!i&&!h;
if(q){
if(f){
while(p){
l=b;
while(l=l[p]){
if(h?l.nodeName.toLowerCase()===r:1===l.nodeType){
return !1
}}
o=p="only"===a&&!o&&"nextSibling"
}
return !0
}
if(o=[g?q.firstChild:q.lastChild],g&&t){
k=q[s]||(q[s]={}
),j=k[a]||[],n=j[0]===u&&j[1],m=j[0]===u&&j[2],l=n&&q.childNodes[n];
while(l=++n&&l&&l[p]||(m=n=0)||o.pop()){
if(1===l.nodeType&&++m&&l===b){
k[a]=[u,n,m];
break
}}}else{
if(t&&(j=(b[s]||(b[s]={}
))[a])&&j[0]===u){
m=j[1]
}else{
while(l=++n&&l&&l[p]||(m=n=0)||o.pop()){
if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(t&&((l[s]||(l[s]={}
))[a]=[u,m]),l===b)){
break
}}}}
return m-=e,m===d||m%d===0&&m/d>=0
}}
}
,PSEUDO:function(a,b){
var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||db.error("unsupported pseudo: "+a);
return e[s]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?fb(function(a,c){
var d,f=e(a,b),g=f.length;
while(g--){
d=I.call(a,f[g]),a[d]=!(c[d]=f[g])
}}
):function(a){
return e(a,0,c)
}
):e
}}
,pseudos:{
not:fb(function(a){
var b=[],c=[],d=g(a.replace(P,"$1"));
return d[s]?fb(function(a,b,c,e){
var f,g=d(a,null,e,[]),h=a.length;
while(h--){
(f=g[h])&&(a[h]=!(b[h]=f))
}}
):function(a,e,f){
return b[0]=a,d(b,null,f,c),!c.pop()
}
}
),has:fb(function(a){
return function(b){
return db(a,b).length>0
}
}
),contains:fb(function(a){
return function(b){
return(b.textContent||b.innerText||e(b)).indexOf(a)>-1
}
}
),lang:fb(function(a){
return U.test(a||"")||db.error("unsupported lang: "+a),a=a.replace(ab,bb).toLowerCase(),function(b){
var c;
do{
if(c=n?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang")){
return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-")
}}
while((b=b.parentNode)&&1===b.nodeType);
return !1
}
}
),target:function(b){
var c=a.location&&a.location.hash;
return c&&c.slice(1)===b.id
}
,root:function(a){
return a===m
}
,focus:function(a){
return a===l.activeElement&&(!l.hasFocus||l.hasFocus())&&!!(a.type||a.href||~a.tabIndex)
}
,enabled:function(a){
return a.disabled===!1
}
,disabled:function(a){
return a.disabled===!0
}
,checked:function(a){
var b=a.nodeName.toLowerCase();
return"input"===b&&!!a.checked||"option"===b&&!!a.selected
}
,selected:function(a){
return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0
}
,empty:function(a){
for(a=a.firstChild;
a;
a=a.nextSibling){
if(a.nodeType<6){
return !1
}}
return !0
}
,parent:function(a){
return !d.pseudos.empty(a)
}
,header:function(a){
return X.test(a.nodeName)
}
,input:function(a){
return W.test(a.nodeName)
}
,button:function(a){
var b=a.nodeName.toLowerCase();
return"input"===b&&"button"===a.type||"button"===b
}
,text:function(a){
var b;
return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())
}
,first:lb(function(){
return[0]
}
),last:lb(function(a,b){
return[b-1]
}
),eq:lb(function(a,b,c){
return[0>c?c+b:c]
}
),even:lb(function(a,b){
for(var c=0;
b>c;
c+=2){
a.push(c)
}
return a
}
),odd:lb(function(a,b){
for(var c=1;
b>c;
c+=2){
a.push(c)
}
return a
}
),lt:lb(function(a,b,c){
for(var d=0>c?c+b:c;
--d>=0;
){
a.push(d)
}
return a
}
),gt:lb(function(a,b,c){
for(var d=0>c?c+b:c;
++d<b;
){
a.push(d)
}
return a
}
)}}
,d.pseudos.nth=d.pseudos.eq;
for(b in {
radio:!0,checkbox:!0,file:!0,password:!0,image:!0}
){
d.pseudos[b]=jb(b)
}
for(b in {
submit:!0,reset:!0}
){
d.pseudos[b]=kb(b)
}
function nb(){}
nb.prototype=d.filters=d.pseudos,d.setFilters=new nb;
function ob(a,b){
var c,e,f,g,h,i,j,k=x[a+" "];
if(k){
return b?0:k.slice(0)
}
h=a,i=[],j=d.preFilter;
while(h){
(!c||(e=Q.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({
value:c,type:e[0].replace(P," ")}
),h=h.slice(c.length));
for(g in d.filter){
!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({
value:c,type:g,matches:e}
),h=h.slice(c.length))
}
if(!c){
break
}}
return b?h.length:h?db.error(a):x(a,i).slice(0)
}
function pb(a){
for(var b=0,c=a.length,d="";
c>b;
b++){
d+=a[b].value
}
return d
}
function qb(a,b,c){
var d=b.dir,e=c&&"parentNode"===d,f=v++;
return b.first?function(b,c,f){
while(b=b[d]){
if(1===b.nodeType||e){
return a(b,c,f)
}}}
:function(b,c,g){
var h,i,j=[u,f];
if(g){
while(b=b[d]){
if((1===b.nodeType||e)&&a(b,c,g)){
return !0
}}}else{
while(b=b[d]){
if(1===b.nodeType||e){
if(i=b[s]||(b[s]={}
),(h=i[d])&&h[0]===u&&h[1]===f){
return j[2]=h[2]
}
if(i[d]=j,j[2]=a(b,c,g)){
return !0
}}}}}
}
function rb(a){
return a.length>1?function(b,c,d){
var e=a.length;
while(e--){
if(!a[e](b,c,d)){
return !1
}}
return !0
}
:a[0]
}
function sb(a,b,c,d,e){
for(var f,g=[],h=0,i=a.length,j=null!=b;
i>h;
h++){
(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h))
}
return g
}
function tb(a,b,c,d,e,f){
return d&&!d[s]&&(d=tb(d)),e&&!e[s]&&(e=tb(e,f)),fb(function(f,g,h,i){
var j,k,l,m=[],n=[],o=g.length,p=f||wb(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:sb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;
if(c&&c(q,r,h,i),d){
j=sb(r,n),d(j,[],h,i),k=j.length;
while(k--){
(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))
}}
if(f){
if(e||a){
if(e){
j=[],k=r.length;
while(k--){
(l=r[k])&&j.push(q[k]=l)
}
e(null,r=[],j,i)
}
k=r.length;
while(k--){
(l=r[k])&&(j=e?I.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))
}}}else{
r=sb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)
}}
)
}
function ub(a){
for(var b,c,e,f=a.length,g=d.relative[a[0].type],i=g||d.relative[" "],j=g?1:0,k=qb(function(a){
return a===b
}
,i,!0),l=qb(function(a){
return I.call(b,a)>-1
}
,i,!0),m=[function(a,c,d){
return !g&&(d||c!==h)||((b=c).nodeType?k(a,c,d):l(a,c,d))
}
];
f>j;
j++){
if(c=d.relative[a[j].type]){
m=[qb(rb(m),c)]
}else{
if(c=d.filter[a[j].type].apply(null,a[j].matches),c[s]){
for(e=++j;
f>e;
e++){
if(d.relative[a[e].type]){
break
}}
return tb(j>1&&rb(m),j>1&&pb(a.slice(0,j-1).concat({
value:" "===a[j-2].type?"*":""}
)).replace(P,"$1"),c,e>j&&ub(a.slice(j,e)),f>e&&ub(a=a.slice(e)),f>e&&pb(a))
}
m.push(c)
}}
return rb(m)
}
function vb(a,b){
var c=b.length>0,e=a.length>0,f=function(f,g,i,j,k){
var m,n,o,p=0,q="0",r=f&&[],s=[],t=h,v=f||e&&d.find.TAG("*",k),w=u+=null==t?1:Math.random()||0.1,x=v.length;
for(k&&(h=g!==l&&g);
q!==x&&null!=(m=v[q]);
q++){
if(e&&m){
n=0;
while(o=a[n++]){
if(o(m,g,i)){
j.push(m);
break
}}
k&&(u=w)
}
c&&((m=!o&&m)&&p--,f&&r.push(m))
}
if(p+=q,c&&q!==p){
n=0;
while(o=b[n++]){
o(r,s,g,i)
}
if(f){
if(p>0){
while(q--){
r[q]||s[q]||(s[q]=E.call(j))
}}
s=sb(s)
}
G.apply(j,s),k&&!f&&s.length>0&&p+b.length>1&&db.uniqueSort(j)
}
return k&&(u=w,h=t),r
};
return c?fb(f):f
}
g=db.compile=function(a,b){
var c,d=[],e=[],f=y[a+" "];
if(!f){
b||(b=ob(a)),c=b.length;
while(c--){
f=ub(b[c]),f[s]?d.push(f):e.push(f)
}
f=y(a,vb(e,d))
}
return f
};
function wb(a,b,c){
for(var d=0,e=b.length;
e>d;
d++){
db(a,b[d],c)
}
return c
}
function xb(a,b,e,f){
var h,i,j,k,l,m=ob(a);
if(!f&&1===m.length){
if(i=m[0]=m[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&c.getById&&9===b.nodeType&&n&&d.relative[i[1].type]){
if(b=(d.find.ID(j.matches[0].replace(ab,bb),b)||[])[0],!b){
return e
}
a=a.slice(i.shift().value.length)
}
h=V.needsContext.test(a)?0:i.length;
while(h--){
if(j=i[h],d.relative[k=j.type]){
break
}
if((l=d.find[k])&&(f=l(j.matches[0].replace(ab,bb),$.test(i[0].type)&&mb(b.parentNode)||b))){
if(i.splice(h,1),a=f.length&&pb(i),!a){
return G.apply(e,f),e
}
break
}}}
return g(a,m)(f,b,!n,e,$.test(a)&&mb(b.parentNode)||b),e
}
return c.sortStable=s.split("").sort(z).join("")===s,c.detectDuplicates=!!j,k(),c.sortDetached=gb(function(a){
return 1&a.compareDocumentPosition(l.createElement("div"))
}
),gb(function(a){
return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")
}
)||hb("type|href|height|width",function(a,b,c){
return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)
}
),c.attributes&&gb(function(a){
return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")
}
)||hb("value",function(a,b,c){
return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue
}
),gb(function(a){
return null==a.getAttribute("disabled")
}
)||hb(J,function(a,b,c){
var d;
return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null
}
),db
}
(a);
n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;
var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;
function x(a,b,c){
if(n.isFunction(b)){
return n.grep(a,function(a,d){
return !!b.call(a,d,a)!==c
}
)
}
if(b.nodeType){
return n.grep(a,function(a){
return a===b!==c
}
)
}
if("string"==typeof b){
if(w.test(b)){
return n.filter(b,a,c)
}
b=n.filter(b,a)
}
return n.grep(a,function(a){
return n.inArray(a,b)>=0!==c
}
)
}
n.filter=function(a,b,c){
var d=b[0];
return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){
return 1===a.nodeType
}
))
}
,n.fn.extend({
find:function(a){
var b,c=[],d=this,e=d.length;
if("string"!=typeof a){
return this.pushStack(n(a).filter(function(){
for(b=0;
e>b;
b++){
if(n.contains(d[b],this)){
return !0
}}}
))
}
for(b=0;
e>b;
b++){
n.find(a,d[b],c)
}
return c=this.pushStack(e>1?n.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c
}
,filter:function(a){
return this.pushStack(x(this,a||[],!1))
}
,not:function(a){
return this.pushStack(x(this,a||[],!0))
}
,is:function(a){
return !!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length
}}
);
var y,z=a.document,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,B=n.fn.init=function(a,b){
var c,d;
if(!a){
return this
}
if("string"==typeof a){
if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:A.exec(a),!c||!c[1]&&b){
return !b||b.jquery?(b||y).find(a):this.constructor(b).find(a)
}
if(c[1]){
if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:z,!0)),v.test(c[1])&&n.isPlainObject(b)){
for(c in b){
n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c])
}}
return this
}
if(d=z.getElementById(c[2]),d&&d.parentNode){
if(d.id!==c[2]){
return y.find(a)
}
this.length=1,this[0]=d
}
return this.context=z,this.selector=a,this
}
return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))
};
B.prototype=n.fn,y=n(z);
var C=/^(?:parents|prev(?:Until|All))/,D={
children:!0,contents:!0,next:!0,prev:!0};
n.extend({
dir:function(a,b,c){
var d=[],e=a[b];
while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!n(e).is(c))){
1===e.nodeType&&d.push(e),e=e[b]
}
return d
}
,sibling:function(a,b){
for(var c=[];
a;
a=a.nextSibling){
1===a.nodeType&&a!==b&&c.push(a)
}
return c
}}
),n.fn.extend({
has:function(a){
var b,c=n(a,this),d=c.length;
return this.filter(function(){
for(b=0;
d>b;
b++){
if(n.contains(this,c[b])){
return !0
}}}
)
}
,closest:function(a,b){
for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;
e>d;
d++){
for(c=this[d];
c&&c!==b;
c=c.parentNode){
if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){
f.push(c);
break
}}}
return this.pushStack(f.length>1?n.unique(f):f)
}
,index:function(a){
return a?"string"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1
}
,add:function(a,b){
return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))
}
,addBack:function(a){
return this.add(null==a?this.prevObject:this.prevObject.filter(a))
}}
);
function E(a,b){
do{
a=a[b]
}
while(a&&1!==a.nodeType);
return a
}
n.each({
parent:function(a){
var b=a.parentNode;
return b&&11!==b.nodeType?b:null
}
,parents:function(a){
return n.dir(a,"parentNode")
}
,parentsUntil:function(a,b,c){
return n.dir(a,"parentNode",c)
}
,next:function(a){
return E(a,"nextSibling")
}
,prev:function(a){
return E(a,"previousSibling")
}
,nextAll:function(a){
return n.dir(a,"nextSibling")
}
,prevAll:function(a){
return n.dir(a,"previousSibling")
}
,nextUntil:function(a,b,c){
return n.dir(a,"nextSibling",c)
}
,prevUntil:function(a,b,c){
return n.dir(a,"previousSibling",c)
}
,siblings:function(a){
return n.sibling((a.parentNode||{}
).firstChild,a)
}
,children:function(a){
return n.sibling(a.firstChild)
}
,contents:function(a){
return n.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)
}}
,function(a,b){
n.fn[a]=function(c,d){
var e=n.map(this,b,c);
return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(D[a]||(e=n.unique(e)),C.test(a)&&(e=e.reverse())),this.pushStack(e)
}
}
);
var F=/\S+/g,G={};
function H(a){
var b=G[a]={};
return n.each(a.match(F)||[],function(a,c){
b[c]=!0
}
),b
}
n.Callbacks=function(a){
a="string"==typeof a?G[a]||H(a):n.extend({}
,a);
var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){
for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;
h&&e>f;
f++){
if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){
c=!1;
break
}}
b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())
}
,k={
add:function(){
if(h){
var d=h.length;
!function f(b){
n.each(b,function(b,c){
var d=n.type(c);
"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)
}
)
}
(arguments),b?e=h.length:c&&(g=d,j(c))
}
return this
}
,remove:function(){
return h&&n.each(arguments,function(a,c){
var d;
while((d=n.inArray(c,h,d))>-1){
h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)
}}
),this
}
,has:function(a){
return a?n.inArray(a,h)>-1:!(!h||!h.length)
}
,empty:function(){
return h=[],e=0,this
}
,disable:function(){
return h=i=c=void 0,this
}
,disabled:function(){
return !h
}
,lock:function(){
return i=void 0,c||k.disable(),this
}
,locked:function(){
return !i
}
,fireWith:function(a,c){
return !h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this
}
,fire:function(){
return k.fireWith(this,arguments),this
}
,fired:function(){
return !!d
}};
return k
}
,n.extend({
Deferred:function(a){
var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={
state:function(){
return c
}
,always:function(){
return e.done(arguments).fail(arguments),this
}
,then:function(){
var a=arguments;
return n.Deferred(function(c){
n.each(b,function(b,f){
var g=n.isFunction(a[b])&&a[b];
e[f[1]](function(){
var a=g&&g.apply(this,arguments);
a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)
}
)
}
),a=null
}
).promise()
}
,promise:function(a){
return null!=a?n.extend(a,d):d
}}
,e={};
return d.pipe=d.then,n.each(b,function(a,f){
var g=f[2],h=f[3];
d[f[1]]=g.add,h&&g.add(function(){
c=h
}
,b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){
return e[f[0]+"With"](this===e?d:this,arguments),this
}
,e[f[0]+"With"]=g.fireWith
}
),d.promise(e),a&&a.call(e,e),e
}
,when:function(a){
var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){
return function(e){
b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)
}
}
,i,j,k;
if(e>1){
for(i=new Array(e),j=new Array(e),k=new Array(e);
e>b;
b++){
c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f
}}
return f||g.resolveWith(k,c),g.promise()
}}
);
var I;
n.fn.ready=function(a){
return n.ready.promise().done(a),this
}
,n.extend({
isReady:!1,readyWait:1,holdReady:function(a){
a?n.readyWait++:n.ready(!0)
}
,ready:function(a){
if(a===!0?!--n.readyWait:!n.isReady){
if(!z.body){
return setTimeout(n.ready)
}
n.isReady=!0,a!==!0&&--n.readyWait>0||(I.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger("ready").off("ready"))
}}}
);
function J(){
z.addEventListener?(z.removeEventListener("DOMContentLoaded",K,!1),a.removeEventListener("load",K,!1)):(z.detachEvent("onreadystatechange",K),a.detachEvent("onload",K))
}
function K(){
(z.addEventListener||"load"===event.type||"complete"===z.readyState)&&(J(),n.ready())
}
n.ready.promise=function(b){
if(!I){
if(I=n.Deferred(),"complete"===z.readyState){
setTimeout(n.ready)
}else{
if(z.addEventListener){
z.addEventListener("DOMContentLoaded",K,!1),a.addEventListener("load",K,!1)
}else{
z.attachEvent("onreadystatechange",K),a.attachEvent("onload",K);
var c=!1;
try{
c=null==a.frameElement&&z.documentElement
}
catch(d){}
c&&c.doScroll&&!function e(){
if(!n.isReady){
try{
c.doScroll("left")
}
catch(a){
return setTimeout(e,50)
}
J(),n.ready()
}}
()
}}}
return I.promise(b)
};
var L="undefined",M;
for(M in n(l)){
break
}
l.ownLast="0"!==M,l.inlineBlockNeedsLayout=!1,n(function(){
var a,b,c=z.getElementsByTagName("body")[0];
c&&(a=z.createElement("div"),a.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",b=z.createElement("div"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==L&&(b.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(l.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)
}
),function(){
var a=z.createElement("div");
if(null==l.deleteExpando){
l.deleteExpando=!0;
try{
delete a.test
}
catch(b){
l.deleteExpando=!1
}}
a=null
}
(),n.acceptData=function(a){
var b=n.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;
return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b
};
var N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;
function P(a,b,c){
if(void 0===c&&1===a.nodeType){
var d="data-"+b.replace(O,"-$1").toLowerCase();
if(c=a.getAttribute(d),"string"==typeof c){
try{
c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c
}
catch(e){}
n.data(a,b,c)
}else{
c=void 0
}}
return c
}
function Q(a){
var b;
for(b in a){
if(("data"!==b||!n.isEmptyObject(a[b]))&&"toJSON"!==b){
return !1
}}
return !0
}
function R(a,b,d,e){
if(n.acceptData(a)){
var f,g,h=n.expando,i=a.nodeType,j=i?n.cache:a,k=i?a[h]:a[h]&&h;
if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b){
return k||(k=i?a[h]=c.pop()||n.guid++:h),j[k]||(j[k]=i?{}
:{
toJSON:n.noop}
),("object"==typeof b||"function"==typeof b)&&(e?j[k]=n.extend(j[k],b):j[k].data=n.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}
),g=g.data),void 0!==d&&(g[n.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[n.camelCase(b)])):f=g,f
}}}
function S(a,b,c){
if(n.acceptData(a)){
var d,e,f=a.nodeType,g=f?n.cache:a,h=f?a[n.expando]:n.expando;
if(g[h]){
if(b&&(d=c?g[h]:g[h].data)){
n.isArray(b)?b=b.concat(n.map(b,n.camelCase)):b in d?b=[b]:(b=n.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;
while(e--){
delete d[b[e]]
}
if(c?!Q(d):!n.isEmptyObject(d)){
return
}}
(c||(delete g[h].data,Q(g[h])))&&(f?n.cleanData([a],!0):l.deleteExpando||g!=g.window?delete g[h]:g[h]=null)
}}}
n.extend({
cache:{}
,noData:{
"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"}
,hasData:function(a){
return a=a.nodeType?n.cache[a[n.expando]]:a[n.expando],!!a&&!Q(a)
}
,data:function(a,b,c){
return R(a,b,c)
}
,removeData:function(a,b){
return S(a,b)
}
,_data:function(a,b,c){
return R(a,b,c,!0)
}
,_removeData:function(a,b){
return S(a,b,!0)
}}
),n.fn.extend({
data:function(a,b){
var c,d,e,f=this[0],g=f&&f.attributes;
if(void 0===a){
if(this.length&&(e=n.data(f),1===f.nodeType&&!n._data(f,"parsedAttrs"))){
c=g.length;
while(c--){
d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d]))
}
n._data(f,"parsedAttrs",!0)
}
return e
}
return"object"==typeof a?this.each(function(){
n.data(this,a)
}
):arguments.length>1?this.each(function(){
n.data(this,a,b)
}
):f?P(f,a,n.data(f,a)):void 0
}
,removeData:function(a){
return this.each(function(){
n.removeData(this,a)
}
)
}}
),n.extend({
queue:function(a,b,c){
var d;
return a?(b=(b||"fx")+"queue",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0
}
,dequeue:function(a,b){
b=b||"fx";
var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){
n.dequeue(a,b)
};
"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()
}
,_queueHooks:function(a,b){
var c=b+"queueHooks";
return n._data(a,c)||n._data(a,c,{
empty:n.Callbacks("once memory").add(function(){
n._removeData(a,b+"queue"),n._removeData(a,c)
}
)}
)
}}
),n.fn.extend({
queue:function(a,b){
var c=2;
return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){
var c=n.queue(this,a,b);
n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)
}
)
}
,dequeue:function(a){
return this.each(function(){
n.dequeue(this,a)
}
)
}
,clearQueue:function(a){
return this.queue(a||"fx",[])
}
,promise:function(a,b){
var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){
--d||e.resolveWith(f,[f])
};
"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";
while(g--){
c=n._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h))
}
return h(),e.promise(b)
}}
);
var T=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,U=["Top","Right","Bottom","Left"],V=function(a,b){
return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)
}
,W=n.access=function(a,b,c,d,e,f,g){
var h=0,i=a.length,j=null==c;
if("object"===n.type(c)){
e=!0;
for(h in c){
n.access(a,b,h,c[h],!0,f,g)
}}else{
if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){
return j.call(n(a),c)
}
)),b)){
for(;
i>h;
h++){
b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)))
}}}
return e?a:j?b.call(a):i?b(a[0],c):f
}
,X=/^(?:checkbox|radio)$/i;
!function(){
var a=z.createDocumentFragment(),b=z.createElement("div"),c=z.createElement("input");
if(b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a>",l.leadingWhitespace=3===b.firstChild.nodeType,l.tbody=!b.getElementsByTagName("tbody").length,l.htmlSerialize=!!b.getElementsByTagName("link").length,l.html5Clone="<:nav></:nav>"!==z.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,a.appendChild(c),l.appendChecked=c.checked,b.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){
l.noCloneEvent=!1
}
),b.cloneNode(!0).click()),null==l.deleteExpando){
l.deleteExpando=!0;
try{
delete b.test
}
catch(d){
l.deleteExpando=!1
}}
a=b=c=null
}
(),function(){
var b,c,d=z.createElement("div");
for(b in {
submit:!0,change:!0,focusin:!0}
){
c="on"+b,(l[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),l[b+"Bubbles"]=d.attributes[c].expando===!1)
}
d=null
}
();
var Y=/^(?:input|select|textarea)$/i,Z=/^key/,$=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\.(.+)|)$/;
function bb(){
return !0
}
function cb(){
return !1
}
function db(){
try{
return z.activeElement
}
catch(a){}}
n.event={
global:{}
,add:function(a,b,c,d,e){
var f,g,h,i,j,k,l,m,o,p,q,r=n._data(a);
if(r){
c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=n.guid++),(g=r.events)||(g=r.events={}
),(k=r.handle)||(k=r.handle=function(a){
return typeof n===L||a&&n.event.triggered===a.type?void 0:n.event.dispatch.apply(k.elem,arguments)
}
,k.elem=a),b=(b||"").match(F)||[""],h=b.length;
while(h--){
f=ab.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=n.event.special[o]||{}
,o=(e?j.delegateType:j.bindType)||o,j=n.event.special[o]||{}
,l=n.extend({
type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")}
,i),(m=g[o])||(m=g[o]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),n.event.global[o]=!0)
}
a=null
}}
,remove:function(a,b,c,d,e){
var f,g,h,i,j,k,l,m,o,p,q,r=n.hasData(a)&&n._data(a);
if(r&&(k=r.events)){
b=(b||"").match(F)||[""],j=b.length;
while(j--){
if(h=ab.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){
l=n.event.special[o]||{}
,o=(d?l.delegateType:l.bindType)||o,m=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;
while(f--){
g=m[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g))
}
i&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete k[o])
}else{
for(o in k){
n.event.remove(a,o+b[j],c,d,!0)
}}}
n.isEmptyObject(k)&&(delete r.handle,n._removeData(a,"events"))
}}
,trigger:function(b,c,d,e){
var f,g,h,i,k,l,m,o=[d||z],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];
if(h=l=d=d||z,3!==d.nodeType&&8!==d.nodeType&&!_.test(p+n.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[n.expando]?b:new n.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),k=n.event.special[p]||{}
,e||!k.trigger||k.trigger.apply(d,c)!==!1)){
if(!e&&!k.noBubble&&!n.isWindow(d)){
for(i=k.delegateType||p,_.test(i+p)||(h=h.parentNode);
h;
h=h.parentNode){
o.push(h),l=h
}
l===(d.ownerDocument||z)&&o.push(l.defaultView||l.parentWindow||a)
}
m=0;
while((h=o[m++])&&!b.isPropagationStopped()){
b.type=m>1?i:k.bindType||p,f=(n._data(h,"events")||{}
)[b.type]&&n._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&n.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault())
}
if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&n.acceptData(d)&&g&&d[p]&&!n.isWindow(d)){
l=d[g],l&&(d[g]=null),n.event.triggered=p;
try{
d[p]()
}
catch(r){}
n.event.triggered=void 0,l&&(d[g]=l)
}
return b.result
}}
,dispatch:function(a){
a=n.event.fix(a);
var b,c,e,f,g,h=[],i=d.call(arguments),j=(n._data(this,"events")||{}
)[a.type]||[],k=n.event.special[a.type]||{};
if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){
h=n.event.handlers.call(this,a,j),b=0;
while((f=h[b++])&&!a.isPropagationStopped()){
a.currentTarget=f.elem,g=0;
while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped()){
(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((n.event.special[e.origType]||{}
).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))
}}
return k.postDispatch&&k.postDispatch.call(this,a),a.result
}}
,handlers:function(a,b){
var c,d,e,f,g=[],h=b.delegateCount,i=a.target;
if(h&&i.nodeType&&(!a.button||"click"!==a.type)){
for(;
i!=this;
i=i.parentNode||this){
if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){
for(e=[],f=0;
h>f;
f++){
d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?n(c,this).index(i)>=0:n.find(c,this,null,[i]).length),e[c]&&e.push(d)
}
e.length&&g.push({
elem:i,handlers:e}
)
}}}
return h<b.length&&g.push({
elem:this,handlers:b.slice(h)}
),g
}
,fix:function(a){
if(a[n.expando]){
return a
}
var b,c,d,e=a.type,f=a,g=this.fixHooks[e];
g||(this.fixHooks[e]=g=$.test(e)?this.mouseHooks:Z.test(e)?this.keyHooks:{}
),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;
while(b--){
c=d[b],a[c]=f[c]
}
return a.target||(a.target=f.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a
}
,props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{}
,keyHooks:{
props:"char charCode key keyCode".split(" "),filter:function(a,b){
return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a
}}
,mouseHooks:{
props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){
var c,d,e,f=b.button,g=b.fromElement;
return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||z,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a
}}
,special:{
load:{
noBubble:!0}
,focus:{
trigger:function(){
if(this!==db()&&this.focus){
try{
return this.focus(),!1
}
catch(a){}}}
,delegateType:"focusin"}
,blur:{
trigger:function(){
return this===db()&&this.blur?(this.blur(),!1):void 0
}
,delegateType:"focusout"}
,click:{
trigger:function(){
return n.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0
}
,_default:function(a){
return n.nodeName(a.target,"a")
}}
,beforeunload:{
postDispatch:function(a){
void 0!==a.result&&(a.originalEvent.returnValue=a.result)
}}}
,simulate:function(a,b,c,d){
var e=n.extend(new n.Event,c,{
type:a,isSimulated:!0,originalEvent:{}}
);
d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()
}}
,n.removeEvent=z.removeEventListener?function(a,b,c){
a.removeEventListener&&a.removeEventListener(b,c,!1)
}
:function(a,b,c){
var d="on"+b;
a.detachEvent&&(typeof a[d]===L&&(a[d]=null),a.detachEvent(d,c))
}
,n.Event=function(a,b){
return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?bb:cb):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void (this[n.expando]=!0)):new n.Event(a,b)
}
,n.Event.prototype={
isDefaultPrevented:cb,isPropagationStopped:cb,isImmediatePropagationStopped:cb,preventDefault:function(){
var a=this.originalEvent;
this.isDefaultPrevented=bb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)
}
,stopPropagation:function(){
var a=this.originalEvent;
this.isPropagationStopped=bb,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)
}
,stopImmediatePropagation:function(){
this.isImmediatePropagationStopped=bb,this.stopPropagation()
}}
,n.each({
mouseenter:"mouseover",mouseleave:"mouseout"}
,function(a,b){
n.event.special[a]={
delegateType:b,bindType:b,handle:function(a){
var c,d=this,e=a.relatedTarget,f=a.handleObj;
return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c
}}
}
),l.submitBubbles||(n.event.special.submit={
setup:function(){
return n.nodeName(this,"form")?!1:void n.event.add(this,"click._submit keypress._submit",function(a){
var b=a.target,c=n.nodeName(b,"input")||n.nodeName(b,"button")?b.form:void 0;
c&&!n._data(c,"submitBubbles")&&(n.event.add(c,"submit._submit",function(a){
a._submit_bubble=!0
}
),n._data(c,"submitBubbles",!0))
}
)
}
,postDispatch:function(a){
a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate("submit",this.parentNode,a,!0))
}
,teardown:function(){
return n.nodeName(this,"form")?!1:void n.event.remove(this,"._submit")
}}
),l.changeBubbles||(n.event.special.change={
setup:function(){
return Y.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(n.event.add(this,"propertychange._change",function(a){
"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)
}
),n.event.add(this,"click._change",function(a){
this._just_changed&&!a.isTrigger&&(this._just_changed=!1),n.event.simulate("change",this,a,!0)
}
)),!1):void n.event.add(this,"beforeactivate._change",function(a){
var b=a.target;
Y.test(b.nodeName)&&!n._data(b,"changeBubbles")&&(n.event.add(b,"change._change",function(a){
!this.parentNode||a.isSimulated||a.isTrigger||n.event.simulate("change",this.parentNode,a,!0)
}
),n._data(b,"changeBubbles",!0))
}
)
}
,handle:function(a){
var b=a.target;
return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0
}
,teardown:function(){
return n.event.remove(this,"._change"),!Y.test(this.nodeName)
}}
),l.focusinBubbles||n.each({
focus:"focusin",blur:"focusout"}
,function(a,b){
var c=function(a){
n.event.simulate(b,a.target,n.event.fix(a),!0)
};
n.event.special[b]={
setup:function(){
var d=this.ownerDocument||this,e=n._data(d,b);
e||d.addEventListener(a,c,!0),n._data(d,b,(e||0)+1)
}
,teardown:function(){
var d=this.ownerDocument||this,e=n._data(d,b)-1;
e?n._data(d,b,e):(d.removeEventListener(a,c,!0),n._removeData(d,b))
}}
}
),n.fn.extend({
on:function(a,b,c,d,e){
var f,g;
if("object"==typeof a){
"string"!=typeof b&&(c=c||b,b=void 0);
for(f in a){
this.on(f,b,c,a[f],e)
}
return this
}
if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1){
d=cb
}else{
if(!d){
return this
}}
return 1===e&&(g=d,d=function(a){
return n().off(a),g.apply(this,arguments)
}
,d.guid=g.guid||(g.guid=n.guid++)),this.each(function(){
n.event.add(this,a,d,c,b)
}
)
}
,one:function(a,b,c,d){
return this.on(a,b,c,d,1)
}
,off:function(a,b,c){
var d,e;
if(a&&a.preventDefault&&a.handleObj){
return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this
}
if("object"==typeof a){
for(e in a){
this.off(e,b,a[e])
}
return this
}
return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=cb),this.each(function(){
n.event.remove(this,a,c,b)
}
)
}
,trigger:function(a,b){
return this.each(function(){
n.event.trigger(a,b,this)
}
)
}
,triggerHandler:function(a,b){
var c=this[0];
return c?n.event.trigger(a,b,c,!0):void 0
}}
);
function eb(a){
var b=fb.split("|"),c=a.createDocumentFragment();
if(c.createElement){
while(b.length){
c.createElement(b.pop())
}}
return c
}
var fb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gb=/ jQuery\d+="(?:null|\d+)"/g,hb=new RegExp("<(?:"+fb+")[\\s/>]","i"),ib=/^\s+/,jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,kb=/<([\w:]+)/,lb=/<tbody/i,mb=/<|&#?\w+;/,nb=/<(?:script|style|link)/i,ob=/checked\s*(?:[^=]|=\s*.checked.)/i,pb=/^$|\/(?:java|ecma)script/i,qb=/^true\/(.*)/,rb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,sb={
option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:l.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]}
,tb=eb(z),ub=tb.appendChild(z.createElement("div"));
sb.optgroup=sb.option,sb.tbody=sb.tfoot=sb.colgroup=sb.caption=sb.thead,sb.th=sb.td;
function vb(a,b){
var c,d,e=0,f=typeof a.getElementsByTagName!==L?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==L?a.querySelectorAll(b||"*"):void 0;
if(!f){
for(f=[],c=a.childNodes||a;
null!=(d=c[e]);
e++){
!b||n.nodeName(d,b)?f.push(d):n.merge(f,vb(d,b))
}}
return void 0===b||b&&n.nodeName(a,b)?n.merge([a],f):f
}
function wb(a){
X.test(a.type)&&(a.defaultChecked=a.checked)
}
function xb(a,b){
return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a
}
function yb(a){
return a.type=(null!==n.find.attr(a,"type"))+"/"+a.type,a
}
function zb(a){
var b=qb.exec(a.type);
return b?a.type=b[1]:a.removeAttribute("type"),a
}
function Ab(a,b){
for(var c,d=0;
null!=(c=a[d]);
d++){
n._data(c,"globalEval",!b||n._data(b[d],"globalEval"))
}}
function Bb(a,b){
if(1===b.nodeType&&n.hasData(a)){
var c,d,e,f=n._data(a),g=n._data(b,f),h=f.events;
if(h){
delete g.handle,g.events={};
for(c in h){
for(d=0,e=h[c].length;
e>d;
d++){
n.event.add(b,c,h[c][d])
}}}
g.data&&(g.data=n.extend({}
,g.data))
}}
function Cb(a,b){
var c,d,e;
if(1===b.nodeType){
if(c=b.nodeName.toLowerCase(),!l.noCloneEvent&&b[n.expando]){
e=n._data(b);
for(d in e.events){
n.removeEvent(b,d,e.handle)
}
b.removeAttribute(n.expando)
}
"script"===c&&b.text!==a.text?(yb(b).text=a.text,zb(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),l.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&X.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)
}}
n.extend({
clone:function(a,b,c){
var d,e,f,g,h,i=n.contains(a.ownerDocument,a);
if(l.html5Clone||n.isXMLDoc(a)||!hb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ub.innerHTML=a.outerHTML,ub.removeChild(f=ub.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a))){
for(d=vb(f),h=vb(a),g=0;
null!=(e=h[g]);
++g){
d[g]&&Cb(e,d[g])
}}
if(b){
if(c){
for(h=h||vb(a),d=d||vb(f),g=0;
null!=(e=h[g]);
g++){
Bb(e,d[g])
}}else{
Bb(a,f)
}}
return d=vb(f,"script"),d.length>0&&Ab(d,!i&&vb(a,"script")),d=h=e=null,f
}
,buildFragment:function(a,b,c,d){
for(var e,f,g,h,i,j,k,m=a.length,o=eb(b),p=[],q=0;
m>q;
q++){
if(f=a[q],f||0===f){
if("object"===n.type(f)){
n.merge(p,f.nodeType?[f]:f)
}else{
if(mb.test(f)){
h=h||o.appendChild(b.createElement("div")),i=(kb.exec(f)||["",""])[1].toLowerCase(),k=sb[i]||sb._default,h.innerHTML=k[1]+f.replace(jb,"<$1></$2>")+k[2],e=k[0];
while(e--){
h=h.lastChild
}
if(!l.leadingWhitespace&&ib.test(f)&&p.push(b.createTextNode(ib.exec(f)[0])),!l.tbody){
f="table"!==i||lb.test(f)?"<table>"!==k[1]||lb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;
while(e--){
n.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)
}}
n.merge(p,h.childNodes),h.textContent="";
while(h.firstChild){
h.removeChild(h.firstChild)
}
h=o.lastChild
}else{
p.push(b.createTextNode(f))
}}}}
h&&o.removeChild(h),l.appendChecked||n.grep(vb(p,"input"),wb),q=0;
while(f=p[q++]){
if((!d||-1===n.inArray(f,d))&&(g=n.contains(f.ownerDocument,f),h=vb(o.appendChild(f),"script"),g&&Ab(h),c)){
e=0;
while(f=h[e++]){
pb.test(f.type||"")&&c.push(f)
}}}
return h=null,o
}
,cleanData:function(a,b){
for(var d,e,f,g,h=0,i=n.expando,j=n.cache,k=l.deleteExpando,m=n.event.special;
null!=(d=a[h]);
h++){
if((b||n.acceptData(d))&&(f=d[i],g=f&&j[f])){
if(g.events){
for(e in g.events){
m[e]?n.event.remove(d,e):n.removeEvent(d,e,g.handle)
}}
j[f]&&(delete j[f],k?delete d[i]:typeof d.removeAttribute!==L?d.removeAttribute(i):d[i]=null,c.push(f))
}}}}
),n.fn.extend({
text:function(a){
return W(this,function(a){
return void 0===a?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))
}
,null,a,arguments.length)
}
,append:function(){
return this.domManip(arguments,function(a){
if(1===this.nodeType||11===this.nodeType||9===this.nodeType){
var b=xb(this,a);
b.appendChild(a)
}}
)
}
,prepend:function(){
return this.domManip(arguments,function(a){
if(1===this.nodeType||11===this.nodeType||9===this.nodeType){
var b=xb(this,a);
b.insertBefore(a,b.firstChild)
}}
)
}
,before:function(){
return this.domManip(arguments,function(a){
this.parentNode&&this.parentNode.insertBefore(a,this)
}
)
}
,after:function(){
return this.domManip(arguments,function(a){
this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)
}
)
}
,remove:function(a,b){
for(var c,d=a?n.filter(a,this):this,e=0;
null!=(c=d[e]);
e++){
b||1!==c.nodeType||n.cleanData(vb(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&Ab(vb(c,"script")),c.parentNode.removeChild(c))
}
return this
}
,empty:function(){
for(var a,b=0;
null!=(a=this[b]);
b++){
1===a.nodeType&&n.cleanData(vb(a,!1));
while(a.firstChild){
a.removeChild(a.firstChild)
}
a.options&&n.nodeName(a,"select")&&(a.options.length=0)
}
return this
}
,clone:function(a,b){
return a=null==a?!1:a,b=null==b?a:b,this.map(function(){
return n.clone(this,a,b)
}
)
}
,html:function(a){
return W(this,function(a){
var b=this[0]||{}
,c=0,d=this.length;
if(void 0===a){
return 1===b.nodeType?b.innerHTML.replace(gb,""):void 0
}
if(!("string"!=typeof a||nb.test(a)||!l.htmlSerialize&&hb.test(a)||!l.leadingWhitespace&&ib.test(a)||sb[(kb.exec(a)||["",""])[1].toLowerCase()])){
a=a.replace(jb,"<$1></$2>");
try{
for(;
d>c;
c++){
b=this[c]||{}
,1===b.nodeType&&(n.cleanData(vb(b,!1)),b.innerHTML=a)
}
b=0
}
catch(e){}}
b&&this.empty().append(a)
}
,null,a,arguments.length)
}
,replaceWith:function(){
var a=arguments[0];
return this.domManip(arguments,function(b){
a=this.parentNode,n.cleanData(vb(this)),a&&a.replaceChild(b,this)
}
),a&&(a.length||a.nodeType)?this:this.remove()
}
,detach:function(a){
return this.remove(a,!0)
}
,domManip:function(a,b){
a=e.apply([],a);
var c,d,f,g,h,i,j=0,k=this.length,m=this,o=k-1,p=a[0],q=n.isFunction(p);
if(q||k>1&&"string"==typeof p&&!l.checkClone&&ob.test(p)){
return this.each(function(c){
var d=m.eq(c);
q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)
}
)
}
if(k&&(i=n.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){
for(g=n.map(vb(i,"script"),yb),f=g.length;
k>j;
j++){
d=i,j!==o&&(d=n.clone(d,!0,!0),f&&n.merge(g,vb(d,"script"))),b.call(this[j],d,j)
}
if(f){
for(h=g[g.length-1].ownerDocument,n.map(g,zb),j=0;
f>j;
j++){
d=g[j],pb.test(d.type||"")&&!n._data(d,"globalEval")&&n.contains(h,d)&&(d.src?n._evalUrl&&n._evalUrl(d.src):n.globalEval((d.text||d.textContent||d.innerHTML||"").replace(rb,"")))
}}
i=c=null
}
return this
}}
),n.each({
appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"}
,function(a,b){
n.fn[a]=function(a){
for(var c,d=0,e=[],g=n(a),h=g.length-1;
h>=d;
d++){
c=d===h?this:this.clone(!0),n(g[d])[b](c),f.apply(e,c.get())
}
return this.pushStack(e)
}
}
);
var Db,Eb={};
function Fb(b,c){
var d=n(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:n.css(d[0],"display");
return d.detach(),e
}
function Gb(a){
var b=z,c=Eb[a];
return c||(c=Fb(a,b),"none"!==c&&c||(Db=(Db||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Db[0].contentWindow||Db[0].contentDocument).document,b.write(),b.close(),c=Fb(a,b),Db.detach()),Eb[a]=c),c
}
!function(){
var a,b,c=z.createElement("div"),d="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";
c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=c.getElementsByTagName("a")[0],a.style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(a.style.opacity),l.cssFloat=!!a.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===c.style.backgroundClip,a=c=null,l.shrinkWrapBlocks=function(){
var a,c,e,f;
if(null==b){
if(a=z.getElementsByTagName("body")[0],!a){
return
}
f="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c=z.createElement("div"),e=z.createElement("div"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==L&&(e.style.cssText=d+";width:1px;padding:1px;zoom:1",e.innerHTML="<div></div>",e.firstChild.style.width="5px",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null
}
return b
}
}
();
var Hb=/^margin/,Ib=new RegExp("^("+T+")(?!px)[a-z%]+$","i"),Jb,Kb,Lb=/^(top|right|bottom|left)$/;
a.getComputedStyle?(Jb=function(a){
return a.ownerDocument.defaultView.getComputedStyle(a,null)
}
,Kb=function(a,b,c){
var d,e,f,g,h=a.style;
return c=c||Jb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),Ib.test(g)&&Hb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""
}
):z.documentElement.currentStyle&&(Jb=function(a){
return a.currentStyle
}
,Kb=function(a,b,c){
var d,e,f,g,h=a.style;
return c=c||Jb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ib.test(g)&&!Lb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"
}
);
function Mb(a,b){
return{
get:function(){
var c=a();
if(null!=c){
return c?void delete this.get:(this.get=b).apply(this,arguments)
}}}
}
!function(){
var b,c,d,e,f,g,h=z.createElement("div"),i="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",j="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";
h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",b=h.getElementsByTagName("a")[0],b.style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(b.style.opacity),l.cssFloat=!!b.style.cssFloat,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===h.style.backgroundClip,b=h=null,n.extend(l,{
reliableHiddenOffsets:function(){
if(null!=c){
return c
}
var a,b,d,e=z.createElement("div"),f=z.getElementsByTagName("body")[0];
if(f){
return e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=z.createElement("div"),a.style.cssText=i,f.appendChild(a).appendChild(e),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",b=e.getElementsByTagName("td"),b[0].style.cssText="padding:0;margin:0;border:0;display:none",d=0===b[0].offsetHeight,b[0].style.display="",b[1].style.display="none",c=d&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,c
}}
,boxSizing:function(){
return null==d&&k(),d
}
,boxSizingReliable:function(){
return null==e&&k(),e
}
,pixelPosition:function(){
return null==f&&k(),f
}
,reliableMarginRight:function(){
var b,c,d,e;
if(null==g&&a.getComputedStyle){
if(b=z.getElementsByTagName("body")[0],!b){
return
}
c=z.createElement("div"),d=z.createElement("div"),c.style.cssText=i,b.appendChild(c).appendChild(d),e=d.appendChild(z.createElement("div")),e.style.cssText=d.style.cssText=j,e.style.marginRight=e.style.width="0",d.style.width="1px",g=!parseFloat((a.getComputedStyle(e,null)||{}
).marginRight),b.removeChild(c)
}
return g
}}
);
function k(){
var b,c,h=z.getElementsByTagName("body")[0];
h&&(b=z.createElement("div"),c=z.createElement("div"),b.style.cssText=i,h.appendChild(b).appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",n.swap(h,null!=h.style.zoom?{
zoom:1}
:{}
,function(){
d=4===c.offsetWidth
}
),e=!0,f=!1,g=!0,a.getComputedStyle&&(f="1%"!==(a.getComputedStyle(c,null)||{}
).top,e="4px"===(a.getComputedStyle(c,null)||{
width:"4px"}
).width),h.removeChild(b),c=h=null)
}}
(),n.swap=function(a,b,c,d){
var e,f,g={};
for(f in b){
g[f]=a.style[f],a.style[f]=b[f]
}
e=c.apply(a,d||[]);
for(f in b){
a.style[f]=g[f]
}
return e
};
var Nb=/alpha\([^)]*\)/i,Ob=/opacity\s*=\s*([^)]*)/,Pb=/^(none|table(?!-c[ea]).+)/,Qb=new RegExp("^("+T+")(.*)$","i"),Rb=new RegExp("^([+-])=("+T+")","i"),Sb={
position:"absolute",visibility:"hidden",display:"block"}
,Tb={
letterSpacing:0,fontWeight:400}
,Ub=["Webkit","O","Moz","ms"];
function Vb(a,b){
if(b in a){
return b
}
var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ub.length;
while(e--){
if(b=Ub[e]+c,b in a){
return b
}}
return d
}
function Wb(a,b){
for(var c,d,e,f=[],g=0,h=a.length;
h>g;
g++){
d=a[g],d.style&&(f[g]=n._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&V(d)&&(f[g]=n._data(d,"olddisplay",Gb(d.nodeName)))):f[g]||(e=V(d),(c&&"none"!==c||!e)&&n._data(d,"olddisplay",e?c:n.css(d,"display"))))
}
for(g=0;
h>g;
g++){
d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"))
}
return a
}
function Xb(a,b,c){
var d=Qb.exec(b);
return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b
}
function Yb(a,b,c,d,e){
for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;
4>f;
f+=2){
"margin"===c&&(g+=n.css(a,c+U[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+U[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+U[f]+"Width",!0,e))):(g+=n.css(a,"padding"+U[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+U[f]+"Width",!0,e)))
}
return g
}
function Zb(a,b,c){
var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Jb(a),g=l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,f);
if(0>=e||null==e){
if(e=Kb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ib.test(e)){
return e
}
d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0
}
return e+Yb(a,b,c||(g?"border":"content"),d,f)+"px"
}
n.extend({
cssHooks:{
opacity:{
get:function(a,b){
if(b){
var c=Kb(a,"opacity");
return""===c?"1":c
}}}}
,cssNumber:{
columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0}
,cssProps:{
"float":l.cssFloat?"cssFloat":"styleFloat"}
,style:function(a,b,c,d){
if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){
var e,f,g,h=n.camelCase(b),i=a.style;
if(b=n.cssProps[h]||(n.cssProps[h]=Vb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c){
return g&&"get" in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]
}
if(f=typeof c,"string"===f&&(e=Rb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),l.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set" in g&&void 0===(c=g.set(a,c,d))))){
try{
i[b]="",i[b]=c
}
catch(j){}}}}
,css:function(a,b,c,d){
var e,f,g,h=n.camelCase(b);
return b=n.cssProps[h]||(n.cssProps[h]=Vb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get" in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Kb(a,b,d)),"normal"===f&&b in Tb&&(f=Tb[b]),""===c||c?(e=parseFloat(f),c===!0||n.isNumeric(e)?e||0:f):f
}}
),n.each(["height","width"],function(a,b){
n.cssHooks[b]={
get:function(a,c,d){
return c?0===a.offsetWidth&&Pb.test(n.css(a,"display"))?n.swap(a,Sb,function(){
return Zb(a,b,d)
}
):Zb(a,b,d):void 0
}
,set:function(a,c,d){
var e=d&&Jb(a);
return Xb(a,c,d?Yb(a,b,d,l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,e),e):0)
}}
}
),l.opacity||(n.cssHooks.opacity={
get:function(a,b){
return Ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""
}
,set:function(a,b){
var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";
c.zoom=1,(b>=1||""===b)&&""===n.trim(f.replace(Nb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Nb.test(f)?f.replace(Nb,e):f+" "+e)
}}
),n.cssHooks.marginRight=Mb(l.reliableMarginRight,function(a,b){
return b?n.swap(a,{
display:"inline-block"}
,Kb,[a,"marginRight"]):void 0
}
),n.each({
margin:"",padding:"",border:"Width"}
,function(a,b){
n.cssHooks[a+b]={
expand:function(c){
for(var d=0,e={}
,f="string"==typeof c?c.split(" "):[c];
4>d;
d++){
e[a+U[d]+b]=f[d]||f[d-2]||f[0]
}
return e
}}
,Hb.test(a)||(n.cssHooks[a+b].set=Xb)
}
),n.fn.extend({
css:function(a,b){
return W(this,function(a,b,c){
var d,e,f={}
,g=0;
if(n.isArray(b)){
for(d=Jb(a),e=b.length;
e>g;
g++){
f[b[g]]=n.css(a,b[g],!1,d)
}
return f
}
return void 0!==c?n.style(a,b,c):n.css(a,b)
}
,a,b,arguments.length>1)
}
,show:function(){
return Wb(this,!0)
}
,hide:function(){
return Wb(this)
}
,toggle:function(a){
return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){
V(this)?n(this).show():n(this).hide()
}
)
}}
);
function $b(a,b,c,d,e){
return new $b.prototype.init(a,b,c,d,e)
}
n.Tween=$b,$b.prototype={
constructor:$b,init:function(a,b,c,d,e,f){
this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")
}
,cur:function(){
var a=$b.propHooks[this.prop];
return a&&a.get?a.get(this):$b.propHooks._default.get(this)
}
,run:function(a){
var b,c=$b.propHooks[this.prop];
return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):$b.propHooks._default.set(this),this
}}
,$b.prototype.init.prototype=$b.prototype,$b.propHooks={
_default:{
get:function(a){
var b;
return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]
}
,set:function(a){
n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now
}}}
,$b.propHooks.scrollTop=$b.propHooks.scrollLeft={
set:function(a){
a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)
}}
,n.easing={
linear:function(a){
return a
}
,swing:function(a){
return 0.5-Math.cos(a*Math.PI)/2
}}
,n.fx=$b.prototype.init,n.fx.step={};
var _b,ac,bc=/^(?:toggle|show|hide)$/,cc=new RegExp("^(?:([+-])=|)("+T+")([a-z%]*)$","i"),dc=/queueHooks$/,ec=[jc],fc={
"*":[function(a,b){
var c=this.createTween(a,b),d=c.cur(),e=cc.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&cc.exec(n.css(c.elem,a)),h=1,i=20;
if(g&&g[3]!==f){
f=f||g[3],e=e||[],g=+d||1;
do{
h=h||".5",g/=h,n.style(c.elem,a,g+f)
}
while(h!==(h=c.cur()/d)&&1!==h&&--i)
}
return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c
}
]};
function gc(){
return setTimeout(function(){
_b=void 0
}
),_b=n.now()
}
function hc(a,b){
var c,d={
height:a}
,e=0;
for(b=b?1:0;
4>e;
e+=2-b){
c=U[e],d["margin"+c]=d["padding"+c]=a
}
return b&&(d.opacity=d.width=a),d
}
function ic(a,b,c){
for(var d,e=(fc[b]||[]).concat(fc["*"]),f=0,g=e.length;
g>f;
f++){
if(d=e[f].call(c,b,a)){
return d
}}}
function jc(a,b,c){
var d,e,f,g,h,i,j,k,m=this,o={}
,p=a.style,q=a.nodeType&&V(a),r=n._data(a,"fxshow");
c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){
h.unqueued||i()
}
),h.unqueued++,m.always(function(){
m.always(function(){
h.unqueued--,n.queue(a,"fx").length||h.empty.fire()
}
)
}
)),1===a.nodeType&&("height" in b||"width" in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=n.css(a,"display"),k=Gb(a.nodeName),"none"===j&&(j=k),"inline"===j&&"none"===n.css(a,"float")&&(l.inlineBlockNeedsLayout&&"inline"!==k?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",l.shrinkWrapBlocks()||m.always(function(){
p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]
}
));
for(d in b){
if(e=b[d],bc.exec(e)){
if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){
if("show"!==e||!r||void 0===r[d]){
continue
}
q=!0
}
o[d]=r&&r[d]||n.style(a,d)
}}
if(!n.isEmptyObject(o)){
r?"hidden" in r&&(q=r.hidden):r=n._data(a,"fxshow",{}
),f&&(r.hidden=!q),q?n(a).show():m.done(function(){
n(a).hide()
}
),m.done(function(){
var b;
n._removeData(a,"fxshow");
for(b in o){
n.style(a,b,o[b])
}}
);
for(d in o){
g=ic(q?r[d]:0,d,m),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))
}}}
function kc(a,b){
var c,d,e,f,g;
for(c in a){
if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand" in g){
f=g.expand(f),delete a[d];
for(c in f){
c in a||(a[c]=f[c],b[c]=e)
}}else{
b[d]=e
}}}
function lc(a,b,c){
var d,e,f=0,g=ec.length,h=n.Deferred().always(function(){
delete i.elem
}
),i=function(){
if(e){
return !1
}
for(var b=_b||gc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;
i>g;
g++){
j.tweens[g].run(f)
}
return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)
}
,j=h.promise({
elem:a,props:n.extend({}
,b),opts:n.extend(!0,{
specialEasing:{}}
,c),originalProperties:b,originalOptions:c,startTime:_b||gc(),duration:c.duration,tweens:[],createTween:function(b,c){
var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);
return j.tweens.push(d),d
}
,stop:function(b){
var c=0,d=b?j.tweens.length:0;
if(e){
return this
}
for(e=!0;
d>c;
c++){
j.tweens[c].run(1)
}
return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this
}}
),k=j.props;
for(kc(k,j.opts.specialEasing);
g>f;
f++){
if(d=ec[f].call(j,a,k,j.opts)){
return d
}}
return n.map(k,ic,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{
elem:a,anim:j,queue:j.opts.queue}
)),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)
}
n.Animation=n.extend(lc,{
tweener:function(a,b){
n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");
for(var c,d=0,e=a.length;
e>d;
d++){
c=a[d],fc[c]=fc[c]||[],fc[c].unshift(b)
}}
,prefilter:function(a,b){
b?ec.unshift(a):ec.push(a)
}}
),n.speed=function(a,b,c){
var d=a&&"object"==typeof a?n.extend({}
,a):{
complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};
return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){
n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)
}
,d
}
,n.fn.extend({
fadeTo:function(a,b,c,d){
return this.filter(V).css("opacity",0).show().end().animate({
opacity:b}
,a,c,d)
}
,animate:function(a,b,c,d){
var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){
var b=lc(this,n.extend({}
,a),f);
(e||n._data(this,"finish"))&&b.stop(!0)
};
return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)
}
,stop:function(a,b,c){
var d=function(a){
var b=a.stop;
delete a.stop,b(c)
};
return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){
var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=n._data(this);
if(e){
g[e]&&g[e].stop&&d(g[e])
}else{
for(e in g){
g[e]&&g[e].stop&&dc.test(e)&&d(g[e])
}}
for(e=f.length;
e--;
){
f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1))
}
(b||!c)&&n.dequeue(this,a)
}
)
}
,finish:function(a){
return a!==!1&&(a=a||"fx"),this.each(function(){
var b,c=n._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;
for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;
b--;
){
f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1))
}
for(b=0;
g>b;
b++){
d[b]&&d[b].finish&&d[b].finish.call(this)
}
delete c.finish
}
)
}}
),n.each(["toggle","show","hide"],function(a,b){
var c=n.fn[b];
n.fn[b]=function(a,d,e){
return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(hc(b,!0),a,d,e)
}
}
),n.each({
slideDown:hc("show"),slideUp:hc("hide"),slideToggle:hc("toggle"),fadeIn:{
opacity:"show"}
,fadeOut:{
opacity:"hide"}
,fadeToggle:{
opacity:"toggle"}}
,function(a,b){
n.fn[a]=function(a,c,d){
return this.animate(b,a,c,d)
}
}
),n.timers=[],n.fx.tick=function(){
var a,b=n.timers,c=0;
for(_b=n.now();
c<b.length;
c++){
a=b[c],a()||b[c]!==a||b.splice(c--,1)
}
b.length||n.fx.stop(),_b=void 0
}
,n.fx.timer=function(a){
n.timers.push(a),a()?n.fx.start():n.timers.pop()
}
,n.fx.interval=13,n.fx.start=function(){
ac||(ac=setInterval(n.fx.tick,n.fx.interval))
}
,n.fx.stop=function(){
clearInterval(ac),ac=null
}
,n.fx.speeds={
slow:600,fast:200,_default:400}
,n.fn.delay=function(a,b){
return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){
var d=setTimeout(b,a);
c.stop=function(){
clearTimeout(d)
}
}
)
}
,function(){
var a,b,c,d,e=z.createElement("div");
e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=e.getElementsByTagName("a")[0],c=z.createElement("select"),d=c.appendChild(z.createElement("option")),b=e.getElementsByTagName("input")[0],a.style.cssText="top:1px",l.getSetAttribute="t"!==e.className,l.style=/top/.test(a.getAttribute("style")),l.hrefNormalized="/a"===a.getAttribute("href"),l.checkOn=!!b.value,l.optSelected=d.selected,l.enctype=!!z.createElement("form").enctype,c.disabled=!0,l.optDisabled=!d.disabled,b=z.createElement("input"),b.setAttribute("value",""),l.input=""===b.getAttribute("value"),b.value="t",b.setAttribute("type","radio"),l.radioValue="t"===b.value,a=b=c=d=e=null
}
();
var mc=/\r/g;
n.fn.extend({
val:function(a){
var b,c,d,e=this[0];
if(arguments.length){
return d=n.isFunction(a),this.each(function(c){
var e;
1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){
return null==a?"":a+""
}
)),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set" in b&&void 0!==b.set(this,e,"value")||(this.value=e))
}
)
}
if(e){
return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get" in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(mc,""):null==c?"":c)
}}}
),n.extend({
valHooks:{
option:{
get:function(a){
var b=n.find.attr(a,"value");
return null!=b?b:n.text(a)
}}
,select:{
get:function(a){
for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;
h>i;
i++){
if(c=d[i],!(!c.selected&&i!==e||(l.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){
if(b=n(c).val(),f){
return b
}
g.push(b)
}}
return g
}
,set:function(a,b){
var c,d,e=a.options,f=n.makeArray(b),g=e.length;
while(g--){
if(d=e[g],n.inArray(n.valHooks.option.get(d),f)>=0){
try{
d.selected=c=!0
}
catch(h){
d.scrollHeight
}}else{
d.selected=!1
}}
return c||(a.selectedIndex=-1),e
}}}}
),n.each(["radio","checkbox"],function(){
n.valHooks[this]={
set:function(a,b){
return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0
}}
,l.checkOn||(n.valHooks[this].get=function(a){
return null===a.getAttribute("value")?"on":a.value
}
)
}
);
var nc,oc,pc=n.expr.attrHandle,qc=/^(?:checked|selected)$/i,rc=l.getSetAttribute,sc=l.input;
n.fn.extend({
attr:function(a,b){
return W(this,n.attr,a,b,arguments.length>1)
}
,removeAttr:function(a){
return this.each(function(){
n.removeAttr(this,a)
}
)
}}
),n.extend({
attr:function(a,b,c){
var d,e,f=a.nodeType;
if(a&&3!==f&&8!==f&&2!==f){
return typeof a.getAttribute===L?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?oc:nc)),void 0===c?d&&"get" in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set" in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))
}}
,removeAttr:function(a,b){
var c,d,e=0,f=b&&b.match(F);
if(f&&1===a.nodeType){
while(c=f[e++]){
d=n.propFix[c]||c,n.expr.match.bool.test(c)?sc&&rc||!qc.test(c)?a[d]=!1:a[n.camelCase("default-"+c)]=a[d]=!1:n.attr(a,c,""),a.removeAttribute(rc?c:d)
}}}
,attrHooks:{
type:{
set:function(a,b){
if(!l.radioValue&&"radio"===b&&n.nodeName(a,"input")){
var c=a.value;
return a.setAttribute("type",b),c&&(a.value=c),b
}}}}}
),oc={
set:function(a,b,c){
return b===!1?n.removeAttr(a,c):sc&&rc||!qc.test(c)?a.setAttribute(!rc&&n.propFix[c]||c,c):a[n.camelCase("default-"+c)]=a[c]=!0,c
}}
,n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){
var c=pc[b]||n.find.attr;
pc[b]=sc&&rc||!qc.test(b)?function(a,b,d){
var e,f;
return d||(f=pc[b],pc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,pc[b]=f),e
}
:function(a,b,c){
return c?void 0:a[n.camelCase("default-"+b)]?b.toLowerCase():null
}
}
),sc&&rc||(n.attrHooks.value={
set:function(a,b,c){
return n.nodeName(a,"input")?void (a.defaultValue=b):nc&&nc.set(a,b,c)
}}
),rc||(nc={
set:function(a,b,c){
var d=a.getAttributeNode(c);
return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0
}}
,pc.id=pc.name=pc.coords=function(a,b,c){
var d;
return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null
}
,n.valHooks.button={
get:function(a,b){
var c=a.getAttributeNode(b);
return c&&c.specified?c.value:void 0
}
,set:nc.set}
,n.attrHooks.contenteditable={
set:function(a,b,c){
nc.set(a,""===b?!1:b,c)
}}
,n.each(["width","height"],function(a,b){
n.attrHooks[b]={
set:function(a,c){
return""===c?(a.setAttribute(b,"auto"),c):void 0
}}
}
)),l.style||(n.attrHooks.style={
get:function(a){
return a.style.cssText||void 0
}
,set:function(a,b){
return a.style.cssText=b+""
}}
);
var tc=/^(?:input|select|textarea|button|object)$/i,uc=/^(?:a|area)$/i;
n.fn.extend({
prop:function(a,b){
return W(this,n.prop,a,b,arguments.length>1)
}
,removeProp:function(a){
return a=n.propFix[a]||a,this.each(function(){
try{
this[a]=void 0,delete this[a]
}
catch(b){}}
)
}}
),n.extend({
propFix:{
"for":"htmlFor","class":"className"}
,prop:function(a,b,c){
var d,e,f,g=a.nodeType;
if(a&&3!==g&&8!==g&&2!==g){
return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set" in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get" in e&&null!==(d=e.get(a,b))?d:a[b]
}}
,propHooks:{
tabIndex:{
get:function(a){
var b=n.find.attr(a,"tabindex");
return b?parseInt(b,10):tc.test(a.nodeName)||uc.test(a.nodeName)&&a.href?0:-1
}}}}
),l.hrefNormalized||n.each(["href","src"],function(a,b){
n.propHooks[b]={
get:function(a){
return a.getAttribute(b,4)
}}
}
),l.optSelected||(n.propHooks.selected={
get:function(a){
var b=a.parentNode;
return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null
}}
),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){
n.propFix[this.toLowerCase()]=this
}
),l.enctype||(n.propFix.enctype="encoding");
var vc=/[\t\r\n\f]/g;
n.fn.extend({
addClass:function(a){
var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;
if(n.isFunction(a)){
return this.each(function(b){
n(this).addClass(a.call(this,b,this.className))
}
)
}
if(j){
for(b=(a||"").match(F)||[];
i>h;
h++){
if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):" ")){
f=0;
while(e=b[f++]){
d.indexOf(" "+e+" ")<0&&(d+=e+" ")
}
g=n.trim(d),c.className!==g&&(c.className=g)
}}}
return this
}
,removeClass:function(a){
var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;
if(n.isFunction(a)){
return this.each(function(b){
n(this).removeClass(a.call(this,b,this.className))
}
)
}
if(j){
for(b=(a||"").match(F)||[];
i>h;
h++){
if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):"")){
f=0;
while(e=b[f++]){
while(d.indexOf(" "+e+" ")>=0){
d=d.replace(" "+e+" "," ")
}}
g=a?n.trim(d):"",c.className!==g&&(c.className=g)
}}}
return this
}
,toggleClass:function(a,b){
var c=typeof a;
return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){
n(this).toggleClass(a.call(this,c,this.className,b),b)
}
:function(){
if("string"===c){
var b,d=0,e=n(this),f=a.match(F)||[];
while(b=f[d++]){
e.hasClass(b)?e.removeClass(b):e.addClass(b)
}}else{
(c===L||"boolean"===c)&&(this.className&&n._data(this,"__className__",this.className),this.className=this.className||a===!1?"":n._data(this,"__className__")||"")
}}
)
}
,hasClass:function(a){
for(var b=" "+a+" ",c=0,d=this.length;
d>c;
c++){
if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(vc," ").indexOf(b)>=0){
return !0
}}
return !1
}}
),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){
n.fn[b]=function(a,c){
return arguments.length>0?this.on(b,null,a,c):this.trigger(b)
}
}
),n.fn.extend({
hover:function(a,b){
return this.mouseenter(a).mouseleave(b||a)
}
,bind:function(a,b,c){
return this.on(a,null,b,c)
}
,unbind:function(a,b){
return this.off(a,null,b)
}
,delegate:function(a,b,c,d){
return this.on(b,a,c,d)
}
,undelegate:function(a,b,c){
return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)
}}
);
var wc=n.now(),xc=/\?/,yc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
n.parseJSON=function(b){
if(a.JSON&&a.JSON.parse){
return a.JSON.parse(b+"")
}
var c,d=null,e=n.trim(b+"");
return e&&!n.trim(e.replace(yc,function(a,b,e,f){
return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")
}
))?Function("return "+e)():n.error("Invalid JSON: "+b)
}
,n.parseXML=function(b){
var c,d;
if(!b||"string"!=typeof b){
return null
}
try{
a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))
}
catch(e){
c=void 0
}
return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+b),c
};
var zc,Ac,Bc=/#.*$/,Cc=/([?&])_=[^&]*/,Dc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ec=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Fc=/^(?:GET|HEAD)$/,Gc=/^\/\//,Hc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ic={}
,Jc={}
,Kc="*/".concat("*");
try{
Ac=location.href
}
catch(Lc){
Ac=z.createElement("a"),Ac.href="",Ac=Ac.href
}
zc=Hc.exec(Ac.toLowerCase())||[];
function Mc(a){
return function(b,c){
"string"!=typeof b&&(c=b,b="*");
var d,e=0,f=b.toLowerCase().match(F)||[];
if(n.isFunction(c)){
while(d=f[e++]){
"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)
}}}
}
function Nc(a,b,c,d){
var e={}
,f=a===Jc;
function g(h){
var i;
return e[h]=!0,n.each(a[h]||[],function(a,h){
var j=h(b,c,d);
return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)
}
),i
}
return g(b.dataTypes[0])||!e["*"]&&g("*")
}
function Oc(a,b){
var c,d,e=n.ajaxSettings.flatOptions||{};
for(d in b){
void 0!==b[d]&&((e[d]?a:c||(c={}
))[d]=b[d])
}
return c&&n.extend(!0,a,c),a
}
function Pc(a,b,c){
var d,e,f,g,h=a.contents,i=a.dataTypes;
while("*"===i[0]){
i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"))
}
if(e){
for(g in h){
if(h[g]&&h[g].test(e)){
i.unshift(g);
break
}}}
if(i[0] in c){
f=i[0]
}else{
for(g in c){
if(!i[0]||a.converters[g+" "+i[0]]){
f=g;
break
}
d||(d=g)
}
f=f||d
}
return f?(f!==i[0]&&i.unshift(f),c[f]):void 0
}
function Qc(a,b,c,d){
var e,f,g,h,i,j={}
,k=a.dataTypes.slice();
if(k[1]){
for(g in a.converters){
j[g.toLowerCase()]=a.converters[g]
}}
f=k.shift();
while(f){
if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift()){
if("*"===f){
f=i
}else{
if("*"!==i&&i!==f){
if(g=j[i+" "+f]||j["* "+f],!g){
for(e in j){
if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){
g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));
break
}}}
if(g!==!0){
if(g&&a["throws"]){
b=g(b)
}else{
try{
b=g(b)
}
catch(l){
return{
state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}
}}}}}}}
return{
state:"success",data:b}
}
n.extend({
active:0,lastModified:{}
,etag:{}
,ajaxSettings:{
url:Ac,type:"GET",isLocal:Ec.test(zc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{
"*":Kc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"}
,contents:{
xml:/xml/,html:/html/,json:/json/}
,responseFields:{
xml:"responseXML",text:"responseText",json:"responseJSON"}
,converters:{
"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML}
,flatOptions:{
url:!0,context:!0}}
,ajaxSetup:function(a,b){
return b?Oc(Oc(a,n.ajaxSettings),b):Oc(n.ajaxSettings,a)
}
,ajaxPrefilter:Mc(Ic),ajaxTransport:Mc(Jc),ajax:function(a,b){
"object"==typeof a&&(b=a,a=void 0),b=b||{};
var c,d,e,f,g,h,i,j,k=n.ajaxSetup({}
,b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{}
,r={}
,s={}
,t=0,u="canceled",v={
readyState:0,getResponseHeader:function(a){
var b;
if(2===t){
if(!j){
j={};
while(b=Dc.exec(f)){
j[b[1].toLowerCase()]=b[2]
}}
b=j[a.toLowerCase()]
}
return null==b?null:b
}
,getAllResponseHeaders:function(){
return 2===t?f:null
}
,setRequestHeader:function(a,b){
var c=a.toLowerCase();
return t||(a=s[c]=s[c]||a,r[a]=b),this
}
,overrideMimeType:function(a){
return t||(k.mimeType=a),this
}
,statusCode:function(a){
var b;
if(a){
if(2>t){
for(b in a){
q[b]=[q[b],a[b]]
}}else{
v.always(a[v.status])
}}
return this
}
,abort:function(a){
var b=a||u;
return i&&i.abort(b),x(0,b),this
}};
if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||Ac)+"").replace(Bc,"").replace(Gc,zc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(F)||[""],null==k.crossDomain&&(c=Hc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===zc[1]&&c[2]===zc[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(zc[3]||("http:"===zc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),Nc(Ic,k,b,v),2===t){
return v
}
h=k.global,h&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Fc.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(xc.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Cc.test(e)?e.replace(Cc,"$1_="+wc++):e+(xc.test(e)?"&":"?")+"_="+wc++)),k.ifModified&&(n.lastModified[e]&&v.setRequestHeader("If-Modified-Since",n.lastModified[e]),n.etag[e]&&v.setRequestHeader("If-None-Match",n.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Kc+"; q=0.01":""):k.accepts["*"]);
for(d in k.headers){
v.setRequestHeader(d,k.headers[d])
}
if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t)){
return v.abort()
}
u="abort";
for(d in {
success:1,error:1,complete:1}
){
v[d](k[d])
}
if(i=Nc(Jc,k,b,v)){
v.readyState=1,h&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){
v.abort("timeout")
}
,k.timeout));
try{
t=1,i.send(r,x)
}
catch(w){
if(!(2>t)){
throw w
}
x(-1,w)
}}else{
x(-1,"No Transport")
}
function x(a,b,c,d){
var j,r,s,u,w,x=b;
2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Pc(k,v,c)),u=Qc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(n.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))
}
return v
}
,getJSON:function(a,b,c){
return n.get(a,b,c,"json")
}
,getScript:function(a,b){
return n.get(a,void 0,b,"script")
}}
),n.each(["get","post"],function(a,b){
n[b]=function(a,c,d,e){
return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({
url:a,type:b,dataType:e,data:c,success:d}
)
}
}
),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){
n.fn[b]=function(a){
return this.on(b,a)
}
}
),n._evalUrl=function(a){
return n.ajax({
url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}
)
}
,n.fn.extend({
wrapAll:function(a){
if(n.isFunction(a)){
return this.each(function(b){
n(this).wrapAll(a.call(this,b))
}
)
}
if(this[0]){
var b=n(a,this[0].ownerDocument).eq(0).clone(!0);
this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){
var a=this;
while(a.firstChild&&1===a.firstChild.nodeType){
a=a.firstChild
}
return a
}
).append(this)
}
return this
}
,wrapInner:function(a){
return this.each(n.isFunction(a)?function(b){
n(this).wrapInner(a.call(this,b))
}
:function(){
var b=n(this),c=b.contents();
c.length?c.wrapAll(a):b.append(a)
}
)
}
,wrap:function(a){
var b=n.isFunction(a);
return this.each(function(c){
n(this).wrapAll(b?a.call(this,c):a)
}
)
}
,unwrap:function(){
return this.parent().each(function(){
n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)
}
).end()
}}
),n.expr.filters.hidden=function(a){
return a.offsetWidth<=0&&a.offsetHeight<=0||!l.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||n.css(a,"display"))
}
,n.expr.filters.visible=function(a){
return !n.expr.filters.hidden(a)
};
var Rc=/%20/g,Sc=/\[\]$/,Tc=/\r?\n/g,Uc=/^(?:submit|button|image|reset|file)$/i,Vc=/^(?:input|select|textarea|keygen)/i;
function Wc(a,b,c,d){
var e;
if(n.isArray(b)){
n.each(b,function(b,e){
c||Sc.test(a)?d(a,e):Wc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)
}
)
}else{
if(c||"object"!==n.type(b)){
d(a,b)
}else{
for(e in b){
Wc(a+"["+e+"]",b[e],c,d)
}}}}
n.param=function(a,b){
var c,d=[],e=function(a,b){
b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)
};
if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a)){
n.each(a,function(){
e(this.name,this.value)
}
)
}else{
for(c in a){
Wc(c,a[c],b,e)
}}
return d.join("&").replace(Rc,"+")
}
,n.fn.extend({
serialize:function(){
return n.param(this.serializeArray())
}
,serializeArray:function(){
return this.map(function(){
var a=n.prop(this,"elements");
return a?n.makeArray(a):this
}
).filter(function(){
var a=this.type;
return this.name&&!n(this).is(":disabled")&&Vc.test(this.nodeName)&&!Uc.test(a)&&(this.checked||!X.test(a))
}
).map(function(a,b){
var c=n(this).val();
return null==c?null:n.isArray(c)?n.map(c,function(a){
return{
name:b.name,value:a.replace(Tc,"\r\n")}
}
):{
name:b.name,value:c.replace(Tc,"\r\n")}
}
).get()
}}
),n.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){
return !this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&$c()||_c()
}
:$c;
var Xc=0,Yc={}
,Zc=n.ajaxSettings.xhr();
a.ActiveXObject&&n(a).on("unload",function(){
for(var a in Yc){
Yc[a](void 0,!0)
}}
),l.cors=!!Zc&&"withCredentials" in Zc,Zc=l.ajax=!!Zc,Zc&&n.ajaxTransport(function(a){
if(!a.crossDomain||l.cors){
var b;
return{
send:function(c,d){
var e,f=a.xhr(),g=++Xc;
if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields){
for(e in a.xhrFields){
f[e]=a.xhrFields[e]
}}
a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");
for(e in c){
void 0!==c[e]&&f.setRequestHeader(e,c[e]+"")
}
f.send(a.hasContent&&a.data||null),b=function(c,e){
var h,i,j;
if(b&&(e||4===f.readyState)){
if(delete Yc[g],b=void 0,f.onreadystatechange=n.noop,e){
4!==f.readyState&&f.abort()
}else{
j={}
,h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);
try{
i=f.statusText
}
catch(k){
i=""
}
h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404
}}
j&&d(h,i,j,f.getAllResponseHeaders())
}
,a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Yc[g]=b:b()
}
,abort:function(){
b&&b(void 0,!0)
}}
}}
);
function $c(){
try{
return new a.XMLHttpRequest
}
catch(b){}}
function _c(){
try{
return new a.ActiveXObject("Microsoft.XMLHTTP")
}
catch(b){}}
n.ajaxSetup({
accepts:{
script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}
,contents:{
script:/(?:java|ecma)script/}
,converters:{
"text script":function(a){
return n.globalEval(a),a
}}}
),n.ajaxPrefilter("script",function(a){
void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)
}
),n.ajaxTransport("script",function(a){
if(a.crossDomain){
var b,c=z.head||n("head")[0]||z.documentElement;
return{
send:function(d,e){
b=z.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){
(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))
}
,c.insertBefore(b,c.firstChild)
}
,abort:function(){
b&&b.onload(void 0,!0)
}}
}}
);
var ad=[],bd=/(=)\?(?=&|$)|\?\?/;
n.ajaxSetup({
jsonp:"callback",jsonpCallback:function(){
var a=ad.pop()||n.expando+"_"+wc++;
return this[a]=!0,a
}}
),n.ajaxPrefilter("json jsonp",function(b,c,d){
var e,f,g,h=b.jsonp!==!1&&(bd.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&bd.test(b.data)&&"data");
return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bd,"$1"+e):b.jsonp!==!1&&(b.url+=(xc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){
return g||n.error(e+" was not called"),g[0]
}
,b.dataTypes[0]="json",f=a[e],a[e]=function(){
g=arguments
}
,d.always(function(){
a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ad.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0
}
),"script"):void 0
}
),n.parseHTML=function(a,b,c){
if(!a||"string"!=typeof a){
return null
}
"boolean"==typeof b&&(c=b,b=!1),b=b||z;
var d=v.exec(a),e=!c&&[];
return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))
};
var cd=n.fn.load;
n.fn.load=function(a,b,c){
if("string"!=typeof a&&cd){
return cd.apply(this,arguments)
}
var d,e,f,g=this,h=a.indexOf(" ");
return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&n.ajax({
url:a,type:f,dataType:"html",data:b}
).done(function(a){
e=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)
}
).complete(c&&function(a,b){
g.each(c,e||[a.responseText,b,a])
}
),this
}
,n.expr.filters.animated=function(a){
return n.grep(n.timers,function(b){
return a===b.elem
}
).length
};
var dd=a.document.documentElement;
function ed(a){
return n.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1
}
n.offset={
setOffset:function(a,b,c){
var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};
"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&n.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using" in b?b.using.call(a,m):l.css(m)
}}
,n.fn.extend({
offset:function(a){
if(arguments.length){
return void 0===a?this:this.each(function(b){
n.offset.setOffset(this,a,b)
}
)
}
var b,c,d={
top:0,left:0}
,e=this[0],f=e&&e.ownerDocument;
if(f){
return b=f.documentElement,n.contains(b,e)?(typeof e.getBoundingClientRect!==L&&(d=e.getBoundingClientRect()),c=ed(f),{
top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}
):d
}}
,position:function(){
if(this[0]){
var a,b,c={
top:0,left:0}
,d=this[0];
return"fixed"===n.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(c=a.offset()),c.top+=n.css(a[0],"borderTopWidth",!0),c.left+=n.css(a[0],"borderLeftWidth",!0)),{
top:b.top-c.top-n.css(d,"marginTop",!0),left:b.left-c.left-n.css(d,"marginLeft",!0)}
}}
,offsetParent:function(){
return this.map(function(){
var a=this.offsetParent||dd;
while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position")){
a=a.offsetParent
}
return a||dd
}
)
}}
),n.each({
scrollLeft:"pageXOffset",scrollTop:"pageYOffset"}
,function(a,b){
var c=/Y/.test(b);
n.fn[a]=function(d){
return W(this,function(a,d,e){
var f=ed(a);
return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void (f?f.scrollTo(c?n(f).scrollLeft():e,c?e:n(f).scrollTop()):a[d]=e)
}
,a,d,arguments.length,null)
}
}
),n.each(["top","left"],function(a,b){
n.cssHooks[b]=Mb(l.pixelPosition,function(a,c){
return c?(c=Kb(a,b),Ib.test(c)?n(a).position()[b]+"px":c):void 0
}
)
}
),n.each({
Height:"height",Width:"width"}
,function(a,b){
n.each({
padding:"inner"+a,content:b,"":"outer"+a}
,function(c,d){
n.fn[d]=function(d,e){
var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");
return W(this,function(b,c,d){
var e;
return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)
}
,b,f?d:void 0,f,null)
}
}
)
}
),n.fn.size=function(){
return this.length
}
,n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){
return n
}
);
var fd=a.jQuery,gd=a.$;
return n.noConflict=function(b){
return a.$===n&&(a.$=gd),b&&a.jQuery===n&&(a.jQuery=fd),n
}
,typeof b===L&&(a.jQuery=a.$=n),n
}
)
}}
if(AjxPackage.define("dwt.Widgets")){
AjxTemplate.register("dwt.Widgets#DwtAlert",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation" width=100%><tr><td width=1%><div id=\'';
e[a++]=o.id;
e[a++]="_icon' style='margin-right:5px;'></div></td><td width=99%><table role=\"presentation\"><tr><td id='";
e[a++]=o.id;
e[a++]="_title' class='DwtAlertTitle'></td></tr><tr><td id='";
e[a++]=o.id;
e[a++]="_content' class='DwtAlertContent'></td></tr></table></td><td width=1%><div id='";
e[a++]=o.id;
e[a++]="_dismiss' style='margin-left:5px;'></div></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtAlert"}
,false);
AjxTemplate.register("dwt.Widgets",AjxTemplate.getTemplate("dwt.Widgets#DwtAlert"),AjxTemplate.getParams("dwt.Widgets#DwtAlert"));
AjxTemplate.register("dwt.Widgets#DwtCheckbox",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" class='ZCheckboxTable'><tr><td><label id='";
e[a++]=o.id;
e[a++]="_text_left' for='";
e[a++]=o.id;
e[a++]="_input' class='Text' style='text-align:right'></label></td><td><input id='";
e[a++]=o.id;
e[a++]="_input' name='";
e[a++]=o.name;
e[a++]="' value='";
e[a++]=o.value;
e[a++]="' type='";
e[a++]=o.type;
e[a++]="' aria-labelledby='";
e[a++]=o.id;
e[a++]="_text_left ";
e[a++]=o.id;
e[a++]="_text_right'></td><td><label id='";
e[a++]=o.id;
e[a++]="_text_right' for='";
e[a++]=o.id;
e[a++]="_input' class='Text' style='text-align:left'></label></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtCheckbox"}
,false);
AjxTemplate.register("dwt.Widgets#DwtBaseDialog",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtDialog WindowOuterContainer'><table role=\"presentation\"><tr id='";
e[a++]=o.dragId;
e[a++]="'><td class='minWidth'>";
e[a++]=o.icon;
e[a++]="</td><td id='";
e[a++]=o.id;
e[a++]="_title' class='DwtDialogTitle'>";
e[a++]=o.title;
e[a++]="</td><td class='minWidth'><div class='";
e[a++]=o.closeIcon2;
e[a++]="'></div></td><td class='minWidth'><div class='";
e[a++]=o.closeIcon1;
e[a++]="'></div></td></tr><tr><td class='WindowInnerContainer' colspan='4'><div id='";
e[a++]=o.id;
e[a++]="_content' class='DwtDialogBody'></div>";
if(o.controlsTemplateId){
e[a++]=AjxTemplate.expand(o.controlsTemplateId,o)
}
e[a++]="</td></tr></table></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtBaseDialog",height:"32",width:"20"}
,false);
AjxTemplate.register("dwt.Widgets#DwtDialogControls",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='horizSep' id=\"";
e[a++]=o.id;
e[a++]="_buttonsSep\"></div><div id='";
e[a++]=o.id;
e[a++]="_buttons' class='DwtDialogButtonBar'>";
if(AjxEnv.isNav){
e[a++]="<input type='button' id='";
e[a++]=o.id;
e[a++]="_focus' style='height:0px;width:0px;display:none;'>"
}
e[a++]="</div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtDialogControls"}
,false);
AjxTemplate.register("dwt.Widgets#DwtSemiModalDialog",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtDialog LightWindowOuterContainer'><table role=\"presentation\" style='cursor:move;'><tr id='";
e[a++]=o.dragId;
e[a++]="'><td class='minWidth'>";
e[a++]=o.icon;
e[a++]="</td><td id='";
e[a++]=o.id;
e[a++]="_title' class='DwtDialogTitle'>";
e[a++]=o.title;
e[a++]="</td><td class='minWidth'><div class='";
e[a++]=o.closeIcon2;
e[a++]="'></div></td><td class='minWidth'><div class='";
e[a++]=o.closeIcon1;
e[a++]="'></div></td></tr><tr><td class='LightWindowInnerContainer full_size' colspan='4'><div id='";
e[a++]=o.id;
e[a++]="_content' class='DwtDialogBody'></div><div class='horizSep'></div><div id='";
e[a++]=o.id;
e[a++]="_buttons' class='DwtDialogButtonBar'>";
if(AjxEnv.isNav){
e[a++]="<input type='button' id='";
e[a++]=o.id;
e[a++]="_focus' style='height:0px;width:0px;display:none;'>"
}
e[a++]="</div></td></tr></table></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtSemiModalDialog",height:"32",width:"20"}
,false);
AjxTemplate.register("dwt.Widgets#DwtToolTip",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='tooltipContents' class='DwtToolTipBody'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtToolTip",height:"5",width:"5"}
,false);
AjxTemplate.register("dwt.Widgets#DwtVerticalSash",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtVerticalSash'><div class='VSashContainer'><div class='VSashThumb ImgVSash_thumb'></div></div></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtVerticalSash",height:"0",width:"0"}
,false);
AjxTemplate.register("dwt.Widgets#DwtHorizontalSash",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtHorizontalSash'><div class='HSashContainer'><div class='HSashThumb ImgHSash_thumb'></div></div></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtHorizontalSash",height:"0",width:"0"}
,false);
AjxTemplate.register("dwt.Widgets#DwtMissingSoundPlayer",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" class='DwtMissingSoundPlayer'><tr><td nowrap class='ImgCritical'>&nbsp;</td><td nowrap>";
e[a++]=ZmMsg.missingPlugin;
e[a++]="</td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtMissingSoundPlayer"}
,false);
AjxTemplate.register("dwt.Widgets#DwtVerticalSlider",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_button' class='DwtThumb DwtSliderThumb'><div class='DwtSliderThumbBorder'><div class='ImgVerticalSliderThumb'></div></div></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtVerticalSlider","class":"DwtSlider DwtVerticalSlider"}
,false);
AjxTemplate.register("dwt.Widgets#DwtHorizontalSlider",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_button' class='DwtThumb DwtSliderThumb'><div class='DwtSliderThumbBorder'><div class='ImgHorizontalSliderThumb'></div></div></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtHorizontalSlider","class":"DwtSlider DwtHorizontalSlider"}
,false);
AjxTemplate.register("dwt.Widgets#ZLabel",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" class='ZWidgetTable ZLabelBorder'><tr><td id='";
e[a++]=o.id;
e[a++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
e[a++]=o.id;
e[a++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
e[a++]=o.id;
e[a++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZLabel","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZButton",function(a,s,n,t){
var o=Boolean(t);
n=(typeof n=="string"?{
id:n}
:n)||{};
t=t||[];
var i=t.length;
var e=n.buttonClass||"Button";
t[i++]='<table role="presentation" class=\'ZWidgetTable Z';
t[i++]=e;
t[i++]="Table Z";
t[i++]=e;
t[i++]="Border' style='table-layout:auto;' cellspacing='0'><tr><td id='";
t[i++]=n.id;
t[i++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[i++]=n.id;
t[i++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
t[i++]=n.id;
t[i++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td><td id='";
t[i++]=n.id;
t[i++]="_dropdown' \tclass='ZDropDown'></td></tr></table>";
return o?t.length:t.join("")
}
,{
id:"dwt.Widgets#ZButton","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZImageOnlyButton",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_left_icon'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZImageOnlyButton","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarButton",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
o.buttonClass=o.buttonClass||"ToolbarButton";
e[a++]=AjxTemplate.expand("#ZButton",o);
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarButton","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZBorderlessButton",function(a,s,n,t){
var o=Boolean(t);
n=(typeof n=="string"?{
id:n}
:n)||{};
t=t||[];
var i=t.length;
var e=n.buttonClass||"Button";
t[i++]='<table role="presentation" class=\'ZWidgetTable Z';
t[i++]=e;
t[i++]="Table' style='table-layout:auto;'><tr><td id='";
t[i++]=n.id;
t[i++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[i++]=n.id;
t[i++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
t[i++]=n.id;
t[i++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td><td id='";
t[i++]=n.id;
t[i++]="_dropdown' \tclass='ZDropDown'></td></tr></table>";
return o?t.length:t.join("")
}
,{
id:"dwt.Widgets#ZBorderlessButton","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZLinkButton",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
if(o.noDropDown){
e[a++]="<a href='javascript:;' onclick='return false;' id='";
e[a++]=o.id;
e[a++]="_title'></a>"
}else{
e[a++]="<table role=\"presentation\" class='DwtLinkButtonTable' style='table-layout:auto;'><tr><td class='ZWidgetTitle'><a href='javascript:;' onclick='return false;' id='";
e[a++]=o.id;
e[a++]="_title'></a></td><td id='";
e[a++]=o.id;
e[a++]="_dropdown' class='DwtLinkButtonDropDownArrowTd'><div class='DwtLinkButtonDropDownArrow'><center><div class='DwtLinkButtonDropDownArrowRow' style='width:7px;'>&nbsp;</div><div class='DwtLinkButtonDropDownArrowRow' style='width:5px;'>&nbsp;</div><div class='DwtLinkButtonDropDownArrowRow' style='width:3px;'>&nbsp;</div><div class='DwtLinkButtonDropDownArrowRow' style='width:1px;'>&nbsp;</div></center></div></td></tr></table>"
}
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZLinkButton","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZButtonColorDisplay",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_color' class='DwtButtonColorPicker-display' unselectable></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZButtonColorDisplay"}
,false);
AjxTemplate.register("dwt.Widgets#DwtComboBox",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr><td width=*><div id=\'';
e[a++]=o.id;
e[a++]="_input'></div></td><td><div id='";
e[a++]=o.id;
e[a++]="_button'></div></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtComboBox","class":"DwtComboBox"}
,false);
AjxTemplate.register("dwt.Widgets#DwtComboBoxButton",function(a,s,n,t){
var o=Boolean(t);
n=(typeof n=="string"?{
id:n}
:n)||{};
t=t||[];
var i=t.length;
var e=n.buttonClass||"Button";
t[i++]='<table role="presentation" class=\'Z';
t[i++]=e;
t[i++]="Border'><tr><td id='";
t[i++]=n.id;
t[i++]="_dropdown' class='ZDropDown'></td></tr></table>";
return o?t.length:t.join("")
}
,{
id:"dwt.Widgets#DwtComboBoxButton","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabView",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_tabbar'></div><div id='";
e[a++]=o.id;
e[a++]="_page'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabView","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBar",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" width='100%'><tr valign='bottom' id='";
e[a++]=o.id;
e[a++]="_items'>";
e[a++]=AjxTemplate.expand("#ZTabBarPrefix",o);
e[a++]=AjxTemplate.expand("#ZTabBarSuffix",o);
e[a++]="</tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBar","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarPrefix",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<td id='";
e[a++]=o.id;
e[a++]="_prefix'><div class='ZTabBarPrefix'></div></td>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarPrefix"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarSuffix",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<td id='";
e[a++]=o.id;
e[a++]="_suffix' width='100%'><div class='ZTabBarSuffix'></div></td>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarSuffix"}
,false);
AjxTemplate.register("dwt.Widgets#ZTab",function(a,s,n,t){
var o=Boolean(t);
n=(typeof n=="string"?{
id:n}
:n)||{};
t=t||[];
var i=t.length;
var e=n.buttonClass||"Tab";
t[i++]='<table role="presentation" id=\'';
t[i++]=n.id;
t[i++]="_select' class='Z";
t[i++]=e;
t[i++]="Table Z";
t[i++]=e;
t[i++]="Border ZWidgetTable ZWidgetBorder'><tr><td id='";
t[i++]=n.id;
t[i++]="_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='";
t[i++]=n.id;
t[i++]="_title' class='ZWidgetTitle'></td><td id='";
t[i++]=n.id;
t[i++]="_right_icon' class='ZRightIcon ZWidgetIcon'></td></tr></table>";
return o?t.length:t.join("")
}
,{
id:"dwt.Widgets#ZTab","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarFloat",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_items'>";
e[a++]=AjxTemplate.expand("#ZTabBarPrefixFloat",o);
e[a++]=AjxTemplate.expand("#ZTabBarSuffixFloat",o);
e[a++]="</div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarFloat","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarPrefixFloat",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_prefix' class='ZTabBarPrefix'>&nbsp;</div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarPrefixFloat"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarSuffixFloat",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_suffix' class='ZTabBarSuffix'>&nbsp;</div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarSuffixFloat"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabFloat",function(a,s,n,t){
var o=Boolean(t);
n=(typeof n=="string"?{
id:n}
:n)||{};
t=t||[];
var i=t.length;
var e=n.buttonClass||"Tab";
t[i++]='<table role="presentation" id=\'';
t[i++]=n.id;
t[i++]="_select' class='Z";
t[i++]=e;
t[i++]="Table Z";
t[i++]=e;
t[i++]="Border ZWidgetBorder'><tr><td id='";
t[i++]=n.id;
t[i++]="_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='";
t[i++]=n.id;
t[i++]="_title' class='ZWidgetTitle'></td><td id='";
t[i++]=n.id;
t[i++]="_right_icon' class='ZRightIcon ZWidgetIcon'></td></tr></table>";
return o?t.length:t.join("")
}
,{
id:"dwt.Widgets#ZTabFloat","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabPage",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabPage","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelectAutoSizingContainer",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr><td id="';
e[a++]=o.id;
e[a++]='_select_container">';
e[a++]=AjxTemplate.expand(o.selectTemplateId,o.selectData);
e[a++]='</td></tr><tr><td><table role="presentation" id="';
e[a++]=o.id;
e[a++]='_pseudoitems_container"></table></td></tr></table>';
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZSelectAutoSizingContainer"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelect",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]=AjxTemplate.expand("#ZButton",o);
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZSelect","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelectMenu",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]=AjxTemplate.expand("#ZMenu",o);
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZSelectMenu","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelectMenuItem",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]=AjxTemplate.expand("#ZMenuItem",o);
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZSelectMenuItem","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbar",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" class='ZToolbarTable'><tr id='";
e[a++]=o.id;
e[a++]="_items'>";
e[a++]=AjxTemplate.expand("#ZToolbarPrefix",o);
e[a++]=AjxTemplate.expand("#ZToolbarSuffix",o);
e[a++]="</tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbar","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarPrefix",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarPrefix"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarSuffix",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarSuffix"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarItem",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr><td id=\'';
e[a++]=o.itemId;
e[a++]="'></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarSeparator",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr><td id=\'';
e[a++]=o.itemId;
e[a++]="' class='ZToolbarSeparator'>&nbsp;</td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarSeparator"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarSpacer",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr><td id=\'';
e[a++]=o.itemId;
e[a++]="' class='ZToolbarSpacer'>&nbsp;</td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarSpacer"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarFiller",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr><td id=\'';
e[a++]=o.itemId;
e[a++]="' class='ZToolbarFiller' width='100%'>&nbsp;</td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarFiller"}
,false);
AjxTemplate.register("dwt.Widgets#ZField",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<input id='";
e[a++]=o.id;
e[a++]="_field' class='ZFieldInput'>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZField","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZTreeItem",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='";
e[a++]=o.divClassName;
e[a++]="' id='";
e[a++]=o.id;
e[a++]="_div'><table role=\"presentation\" id='";
e[a++]=o.id;
e[a++]='_table\' style="table-layout:fixed; width:100%"><tr><td style="width:20px" align=center nowrap id=\'';
e[a++]=o.id;
e[a++]="_nodeCell'></td>";
if(o.isCheckedStyle){
e[a++]='<td style="width:20px" nowrap id=\'';
e[a++]=o.id;
e[a++]='_checkboxCell\' class="ZTreeItemCheckboxCell"><div class="ZTreeItemCheckbox" id=\'';
e[a++]=o.id;
e[a++]="_checkbox'><div class=\"ZTreeItemCheckboxImg\" id='";
e[a++]=o.id;
e[a++]="_checkboxImg'>";
e[a++]=AjxImg.getImageHtml("MenuCheck");
e[a++]="</div></div></td>"
}
e[a++]="<td style=\"width:20px\" nowrap class='imageCell' id='";
e[a++]=o.id;
e[a++]="_imageCell'></td><td nowrap class='";
e[a++]=o.textClassName;
e[a++]="' id='";
e[a++]=o.id;
e[a++]="_textCell'></td><td class='imageCell' id='";
e[a++]=o.id;
e[a++]="_extraCell'></td></tr></table></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTreeItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZHeaderTreeItem",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='";
e[a++]=o.divClassName;
e[a++]="' id='";
e[a++]=o.id;
e[a++]="_div'><table role=\"presentation\" id='";
e[a++]=o.id;
e[a++]="_table'><tr>";
if(!o.noNodeCell){
e[a++]="<td align=center nowrap id='";
e[a++]=o.id;
e[a++]="_nodeCell'></td>"
}
e[a++]="<td nowrap class='imageCell' id='";
e[a++]=o.id;
e[a++]="_imageCell'></td><td nowrap class='";
e[a++]=o.textClassName;
e[a++]="' id='";
e[a++]=o.id;
e[a++]="_textCell' width=\"100%\"></td><td class='";
e[a++]=o.textClassName;
e[a++]=" FakeAnchor' id='";
e[a++]=o.id;
e[a++]="_optCell'><div id='";
e[a++]=o.id;
e[a++]="_optButton'/></td></tr></table></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZHeaderTreeItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZAccordion",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_div'><table role=\"presentation\" class='ZAccordionTable ZWidget' id='";
e[a++]=o.id;
e[a++]="_accordion_table'></table></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZAccordion"}
,false);
AjxTemplate.register("dwt.Widgets#ZAccordionItem",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_header_";
e[a++]=o.itemNum;
e[a++]="' class='ZAccordionHeader'><table role=\"presentation\" class='ZAccordionHeaderBorder ZWidgetTable'><tr><td><div class='";
e[a++]=o.icon;
e[a++]="' id='";
e[a++]=o.id;
e[a++]="_icon_";
e[a++]=o.itemNum;
e[a++]="'></div></td><td><div class='ZAccordionTitle' id='";
e[a++]=o.id;
e[a++]="_title_";
e[a++]=o.itemNum;
e[a++]="'>";
e[a++]=o.title;
e[a++]="</div></td><td><div class='ImgAccordionClosed' id='";
e[a++]=o.id;
e[a++]="_status_";
e[a++]=o.itemNum;
e[a++]="'></div></td></tr></table></div><div class='ZAccordionBody' id='";
e[a++]=o.id;
e[a++]="_body_";
e[a++]=o.itemNum;
e[a++]="'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZAccordionItem"}
,false);
AjxTemplate.register("dwt.Widgets#DwtTabView",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" width='100%' backgroundColor='";
e[a++]=o.bgcolor;
e[a++]="'><tr align='left' valign='middle'><td id='";
e[a++]=o.id;
e[a++]="_tabs' class='DwtTabTable' nowrap align='left' valign='middle' width='100%'></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtTabView"}
,false);
AjxTemplate.register("dwt.Widgets#DwtTabBar",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<!-- TODO -->";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtTabBar"}
,false);
AjxTemplate.register("dwt.Widgets#DwtTabSpacer",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" width='100%'><tr></tr><tr></tr><tr><td><div class='ImgTabSpacer'></div></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtTabSpacer"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenu",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_container' class='ZMenuBorder'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenu","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItem",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" class='ZWidgetTable ZMenuItemTable ZMenuItemBorder'><tr><td id='";
e[a++]=o.id;
e[a++]="_check' class='ZCheckIcon'><div></div></td><td id='";
e[a++]=o.id;
e[a++]="_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='";
e[a++]=o.id;
e[a++]="_title' class='ZWidgetTitle'></td><td id='";
e[a++]=o.id;
e[a++]="_dropdown' class='ZDropDown'><div></div></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItem","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemSeparator",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" class='ZWidgetTable ZMenuItemTable ZMenuItemBorder ZMenuItemSeparatorBorder'><tr><td id='";
e[a++]=o.id;
e[a++]="_title' class='ZWidgetTitle'><div class='ZMenuItem-Separator'></div></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItemSeparator","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemBlankCheck",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ZMenuItem-BlankCheck'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItemBlankCheck"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemBlankIcon",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ZMenuItem-BlankIcon'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItemBlankIcon"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemBlankCascade",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ZMenuItem-BlankCascade'></div>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItemBlankCascade"}
,false);
AjxTemplate.register("dwt.Widgets#DwtListView-NoResults",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" width='100%'><tr><td class='NoResults'>\n";
e[a++]="\t\t\t\t";
e[a++]=o.message;
e[a++]="\n";
e[a++]="\t\t\t</td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtListView-NoResults"}
,false);
AjxTemplate.register("dwt.Widgets#DwtPasswordField",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr><td><div id=\'';
e[a++]=o.id;
e[a++]="_input'></div></td><td><div id='";
e[a++]=o.id;
e[a++]="_show_password'></div></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtPasswordField"}
,false);
AjxTemplate.register("dwt.Widgets#DwtFormRows",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation" class="ZPropertySheet" cellspacing="6"><tbody id="';
e[a++]=o.id;
e[a++]='_rows" tabindex="100"></tbody></table>';
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtFormRows"}
,false);
AjxTemplate.register("dwt.Widgets#DwtFormRow",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<table role="presentation"><tr id="';
e[a++]=o.id;
e[a++]='_row" class="DwtFormRow"><td><div id="';
e[a++]=o.id;
e[a++]='" tabindex="100"></div></td><td><div id="';
e[a++]=o.id;
e[a++]='_add" class="DwtFormRowAdd" tabindex="200"></div></td><td><div id="';
e[a++]=o.id;
e[a++]='_remove" class="DwtFormRowRemove" tabindex="300"></div></td></tr></table>';
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtFormRow"}
,false);
AjxTemplate.register("dwt.Widgets#DwtColorPicker",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=o.id;
e[a++]="_colors'><div class='Text'>";
e[a++]=AjxMsg.colorsStandard;
e[a++]="</div><div class='Colors First'><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorRed;
e[a++]=";'></div><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorOrange;
e[a++]=";'></div><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorYellow;
e[a++]=";'></div><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorGreen;
e[a++]=";'></div><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorCyan;
e[a++]=";'></div><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorBlue;
e[a++]=";'></div><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorPurple;
e[a++]=";'></div><div class='Color' style='background-color:";
e[a++]=AjxMsg.colorPink;
e[a++]=";'></div><div class='Color' style='background-color:white;'></div><div class='Color' style='background-color:black;'></div></div><div class='Text'>";
e[a++]=AjxMsg.colorsCustom;
e[a++]="</div><div class='Colors First'><div class='Color' style='background-color:#ff8686;'></div><div class='Color' style='background-color:#ff9966;'></div><div class='Color' style='background-color:#ffff99;'></div><div class='Color' style='background-color:#ccffcc;'></div><div class='Color' style='background-color:#ccffff;'></div><div class='Color' style='background-color:#99ccff;'></div><div class='Color' style='background-color:#ccccff;'></div><div class='Color' style='background-color:#ffccff;'></div><div class='Color' style='background-color:#ededed;'></div><div class='Color' style='background-color:#808080;'></div></div><div class='Colors'><div class='Color' style='background-color:#ff0000;'></div><div class='Color' style='background-color:#ff6600;'></div><div class='Color' style='background-color:#ffcc33;'></div><div class='Color' style='background-color:#66cc66;'></div><div class='Color' style='background-color:#00cccc;'></div><div class='Color' style='background-color:#3366ff;'></div><div class='Color' style='background-color:#6666ff;'></div><div class='Color' style='background-color:#cc33cc;'></div><div class='Color' style='background-color:#d5d5d5;'></div><div class='Color' style='background-color:#666666;'></div></div><div class='Colors'><div class='Color' style='background-color:#cc0000;'></div><div class='Color' style='background-color:#cc6600;'></div><div class='Color' style='background-color:#cc9933;'></div><div class='Color' style='background-color:#009900;'></div><div class='Color' style='background-color:#339999;'></div><div class='Color' style='background-color:#3333ff;'></div><div class='Color' style='background-color:#6633ff;'></div><div class='Color' style='background-color:#993399;'></div><div class='Color' style='background-color:#cccccc;'></div><div class='Color' style='background-color:#4d4d4d;'></div></div><div class='Colors'><div class='Color' style='background-color:#990000;'></div><div class='Color' style='background-color:#993300;'></div><div class='Color' style='background-color:#996633;'></div><div class='Color' style='background-color:#006600;'></div><div class='Color' style='background-color:#336666;'></div><div class='Color' style='background-color:#000099;'></div><div class='Color' style='background-color:#330099;'></div><div class='Color' style='background-color:#663366;'></div><div class='Color' style='background-color:#b3b3b3;'></div><div class='Color' style='background-color:#333333;'></div></div><div class='Colors'><div class='Color' style='background-color:#330000;'></div><div class='Color' style='background-color:#663300;'></div><div class='Color' style='background-color:#333300;'></div><div class='Color' style='background-color:#003300;'></div><div class='Color' style='background-color:#003333;'></div><div class='Color' style='background-color:#000066;'></div><div class='Color' style='background-color:#330066;'></div><div class='Color' style='background-color:#330033;'></div><div class='Color' style='background-color:#aaaaaa;'></div><div class='Color' style='background-color:#1a1a1a;'></div></div></div>";
if(!o.hideNoFill){
e[a++]="<div class='Text' style='margin-top:4px;'><div id='";
e[a++]=o.id;
e[a++]="_default'></div></div>"
}
if(o.allowColorInput){
e[a++]="<div class='Text' style='margin-top:4px;'><table role=\"presentation\" border=\"0\" width='100%'><tr><td><div id='";
e[a++]=o.id;
e[a++]="_input'></div></td><td><div id='";
e[a++]=o.id;
e[a++]='_button\'></div></td></tr></table><table role="presentation" class=\'DwtColorPickerLabel\' border="0"><tr><td><div>';
e[a++]=AjxMsg.previewResult;
e[a++]="</div></td><td><div id='";
e[a++]=o.id;
e[a++]="_preview' class='Color'></div></td><td><div id='";
e[a++]=o.id;
e[a++]="_error'></div></td></tr></table></div>"
}
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtColorPicker"}
,false);
AjxTemplate.register("dwt.Widgets#DwtColorPickerButton",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]="<table role=\"presentation\" class='ZWidgetTable ZMenuItemTable ZMenuItemBorder'><tr><td><div id='";
e[a++]=o.id;
e[a++]="_color' class='Color'></div></td><td id='";
e[a++]=o.id;
e[a++]="_title' class='ZWidgetTitle'\n";
e[a++]="\t\t\t";
if(AjxEnv.isIE){
e[a++]="\n";
e[a++]="\t\t\t\tstyle='width:auto;'\n";
e[a++]="\t\t\t"
}
e[a++]="\n";
e[a++]="\t\t\t></td></tr></table>";
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtColorPickerButton","class":"ZWidget"}
,false);
AjxTemplate.register("dwt.Widgets#SVGGradient",function(t,n,o,e){
var i=Boolean(e);
o=(typeof o=="string"?{
id:o}
:o)||{};
e=e||[];
var a=e.length;
e[a++]='<?xml version="1.0" ?><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"\n';
e[a++]='\t     viewBox="0 0 1 1" preserveAspectRatio="none"><linearGradient id="thegradient"\n';
e[a++]='\t\t                gradientUnits="userSpaceOnUse"\n';
e[a++]='\t\t                x1="';
e[a++]=o.x1;
e[a++]='" y1="';
e[a++]=o.y1;
e[a++]='" x2="';
e[a++]=o.x2;
e[a++]='" y2="';
e[a++]=o.y2;
e[a++]='"><stop offset="0%" stop-color="';
e[a++]=o.startColor;
e[a++]='"\n';
e[a++]='\t\t\t            stop-opacity="1"/><stop offset="100%" stop-color="';
e[a++]=o.endColor;
e[a++]='"\n';
e[a++]='\t\t\t            stop-opacity="1"/></linearGradient><rect x="0" y="0" width="1" height="1"\n';
e[a++]='\t\tfill="url(#thegradient)" /></svg>';
return i?e.length:e.join("")
}
,{
id:"dwt.Widgets#SVGGradient"}
,false)
};
