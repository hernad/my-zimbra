
/* Copyright (C) 2005-2009 Zimbra Inc. http://www.zimbra.com/ */
if(AjxPackage.define("Admin")){
if(AjxPackage.define("zimbraAdmin.common.ZaUtil")){
ZaUtil=function(){};
ZaUtil.HELP_URL="help/admin/html/";
ZaUtil.getLifeTimeInSeconds=function(t){
if(AjxUtil.isLifeTime(t)){
var e=t.length;
var n=t.substr(0,e-1);
var o=t.substr(e-1,e);
if(o=="s"){
if(t[e-2]=="m"){
n=t.substr(0,e-2);
return n/1000
}
return n
}else{
if(o=="m"){
return n*60
}else{
if(o=="h"){
return n*3600
}else{
if(o=="d"){
return n*216000
}}}}}else{
throw (new AjxException(AjxMessageFormat.format(ZaMsg.UTIL_INVALID_LIFETIME,[t])))
}};
ZaUtil.findValueInObjArrByPropertyName=function(e,n,o){
if(!o){
o="name"
}
if(e!=null){
for(var t=0;
t<e.length;
t++){
if(e[t]&&e[t][o]==n){
return t
}}}
return -1
};
ZaUtil.getListItemLabel=function(e,o){
if(e!=null){
for(var t=0;
t<e.length;
t++){
if(e[t]["value"]==o){
return e[t]["label"]
}}}
return null
};
ZaUtil.findValueInArray=function(e,o){
if(e!=null){
for(var t=0;
t<e.length;
t++){
if(e[t]==o){
return t
}}}
return -1
};
ZaUtil.getUniqueArrayElements=function(e){
var o=[];
for(var t=0;
t<e.length;
t++){
if(ZaUtil.findValueInArray(o,e[t])<0){
o.push(e[t])
}}
return o
};
ZaUtil.getAdminServerDateTime=function(e,o){
var t=AjxDateUtil.getServerDateTime(e,o);
return t.substring(0,8)+t.substring(9)
};
ZaUtil.compareObjects=function(t,e){
if(t.id==e.id){
return 0
}
if(t.name>e.name){
return 1
}
if(t.name<e.name){
return -1
}};
ZaUtil.deepCloneObject=function(s,n){
var t={};
if(s){
for(var o in s){
if(n&&n.length>0){
if(ZaUtil.findValueInArray(n,o)>=0){
continue
}}
var e=s[o];
if(e!=null&&(e instanceof Array||typeof(e)=="object")){
t[o]=ZaUtil.deepCloneObject(e)
}else{
t[o]=e
}}}else{
return null
}
return t
};
ZaUtil.cloneArray=function(o){
var t=[];
for(var e=0;
e<o.length;
e++){
t.push(o[e])
}
return t
};
ZaUtil.join=function(n,o,e){
if(n==null){
return""
}
var s=[];
for(var t=0;
t<n.length;
t++){
s.push(n[t][o])
}
return s.join(e)
};
ZaUtil.getItemUUid=function(){
var e="ZaItem";
return Dwt.getNextId(e)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaEvent")){
ZaEvent=function(e){
this.type=e;
this.event=null;
this.source=null;
this._details=null
};
ZaEvent.L_MODIFY=1;
ZaEvent.L_PICKER=2;
ZaEvent.EVENT_SOURCE_INDEX=1;
ZaEvent.S_FOLDER=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_TAG=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_CONV=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_MSG=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_ATT=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_CONTACT=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_APPT=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_NOTE=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_PICKER=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_SEARCH=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_SETTING=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_ACCOUNT=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_COS=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_DOMAIN=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_SERVER=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_GLOBALCONFIG=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_STATUS=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_CLUSTER_STATUS=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_DL=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_MTA=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_ZIMLET=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.S_HOME=ZaEvent.EVENT_SOURCE_INDEX++;
ZaEvent.EVENT_TYPES_INDEX=1;
ZaEvent.E_CREATE=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_DELETE=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_MODIFY=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_LOAD=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_REMOVE=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_REMOVE_ALL=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_RENAME=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_MOVE=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_FLAGS=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_ADD_TAG=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_REMOVE_TAG=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.E_SEARCH=ZaEvent.EVENT_TYPES_INDEX++;
ZaEvent.prototype.toString=function(){
return"ZaEvent"
};
ZaEvent.prototype.set=function(e,t){
this.event=e;
this.source=t
};
ZaEvent.prototype.setDetail=function(t,e){
if(!this._details){
this._details=new Object()
}
this._details[t]=e
};
ZaEvent.prototype.getDetail=function(e){
if(!this._details){
return null
}else{
return this._details[e]
}};
ZaEvent.prototype.setDetails=function(e){
this._details=e?e:new Object()
};
ZaEvent.prototype.getDetails=function(){
return this._details
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaModel")){
ZaModel=function(e){
if(arguments.length==0){
return
}
this._evtMgr=new AjxEventMgr()
};
ZaModel.getBooleanChoices=function(){
return[{
value:"TRUE",label:ZaMsg.Yes}
,{
value:"FALSE",label:ZaMsg.No}
,{
value:null,label:ZaMsg.No}
]
};
ZaModel.BOOLEAN_CHOICES=ZaModel.getBooleanChoices;
ZaModel.getBooleanChoices1=function(){
return[{
value:true,label:ZaMsg.Yes}
,{
value:false,label:ZaMsg.No}
,{
value:null,label:ZaMsg.No}
]
};
ZaModel.BOOLEAN_CHOICES1=ZaModel.getBooleanChoices1;
ZaModel.getBooleanChoices2=function(){
return[{
value:"1",label:ZaMsg.Yes}
,{
value:"0",label:ZaMsg.No}
,{
value:null,label:ZaMsg.No}
]
};
ZaModel.BOOLEAN_CHOICES2=ZaModel.getBooleanChoices2;
ZaModel.getAllowChoices=function(){
return[{
value:"1",label:ZaMsg.Yes}
,{
value:"0",label:ZaMsg.No}
,{
value:"-1",label:ZaMsg.Ignored}
,{
value:null,label:ZaMsg.No}
]
};
ZaModel.ALLOW_CHOICES=ZaModel.getAllowChoices;
ZaModel.FONT_SIZE_CHOICES=[{
value:"8pt",label:"8pt"}
,{
value:"10pt",label:"10pt"}
,{
value:"12pt",label:"12pt"}
,{
value:"14pt",label:"14pt"}
,{
value:"18pt",label:"18pt"}
,{
value:"24pt",label:"24pt"}
,{
value:"36pt",label:"36pt"}
];
ZaModel.getFontFamilyChoices=function(){
return[{
label:ZaMsg.LBL_fontFamilySansSerif,value:"arial, helvetica, sans-serif"}
,{
label:ZaMsg.LBL_fontFamilySerif,value:"times new roman, new york, times, serif"}
,{
label:ZaMsg.LBL_fontFamilyWideBlock,value:"arial black,avant garde"}
,{
label:ZaMsg.LBL_fontFamilyMonospaced,value:"courier new, courier, monaco, monospace, sans-serif"}
,{
label:ZaMsg.LBL_fontFamilyComic,value:"comic sans ms, comic sans, sans-serif"}
,{
label:ZaMsg.LBL_fontFamilyConsole,value:"lucida console, sans-serif"}
,{
label:ZaMsg.LBL_fontFamilyGaramond,value:"garamond, new york, times, serif"}
,{
label:ZaMsg.LBL_fontFamilyElegant,value:"georgia,serif"}
,{
label:ZaMsg.LBL_fontFamilyProfessional,value:"tahoma, new york, times, serif"}
,{
label:ZaMsg.LBL_fontFamilyTerminal,value:"terminal,monaco"}
,{
label:ZaMsg.LBL_fontFamilyModern,value:"trebuchet ms,sans-serif"}
,{
label:ZaMsg.LBL_fontFamilyWide,value:"verdana, helvetica, sans-serif"}
]
};
ZaModel.FONT_FAMILY_CHOICES=ZaModel.getFontFamilyChoices;
ZaModel.getComposeFormatChoices=function(){
return[{
value:"text",label:ZaMsg.Text}
,{
value:"html",label:ZaMsg.HTML}
]
};
ZaModel.COMPOSE_FORMAT_CHOICES=ZaModel.getComposeFormatChoices;
ZaModel.SEND_READ_RECEIPT_ALWAYS="always";
ZaModel.SEND_READ_RECEIPT_NEVER="never";
ZaModel.SEND_READ_RECEIPT_PROMPT="prompt";
ZaModel.getSendReadReceiptByChoices=function(){
return[{
value:ZaModel.SEND_READ_RECEIPT_ALWAYS,label:ZaMsg.SEND_READ_RECEIPT_ALWAYS}
,{
value:ZaModel.SEND_READ_RECEIPT_NEVER,label:ZaMsg.SEND_READ_RECEIPT_NEVER}
,{
value:ZaModel.SEND_READ_RECEIPT_PROMPT,label:ZaMsg.SEND_READ_RECEIPT_PROMPT}
]
};
ZaModel.SEND_READ_RECEPIT_CHOICES=ZaModel.getSendReadReceiptByChoices;
ZaModel.getGroupMailByChoices=function(){
return[{
value:"conversation",label:ZaMsg.Conversation}
,{
value:"message",label:ZaMsg.Message}
]
};
ZaModel.GROUP_MAIL_BY_CHOICES=ZaModel.getGroupMailByChoices;
ZaModel.getSignatureStyleChoices=function(){
return[{
value:"outlook",label:ZaMsg.No}
,{
value:"internet",label:ZaMsg.Yes}
]
};
ZaModel.SIGNATURE_STYLE_CHOICES=ZaModel.getSignatureStyleChoices;
ZaModel.getReminderChoices=function(){
return[{
value:"0",label:ZaMsg.never}
,{
value:1,label:"1"}
,{
value:5,label:"5"}
,{
value:10,label:"10"}
,{
value:15,label:"15"}
,{
value:20,label:"20"}
,{
value:25,label:"25"}
,{
value:30,label:"30"}
,{
value:45,label:"45"}
,{
value:50,label:"50"}
,{
value:55,label:"55"}
,{
value:60,label:"60"}
]
};
ZaModel.REMINDER_CHOICES=ZaModel.getReminderChoices;
ZaModel.ErrorCode="code";
ZaModel.ErrorMessage="error_message";
ZaModel.currentStep="currentStep";
ZaModel.currentTab="currentTab";
ZaModel.getTimeChoices=function(){
return[{
value:"d",label:AjxMsg.days}
,{
value:"h",label:AjxMsg.hours}
,{
value:"m",label:AjxMsg.minutes}
,{
value:"s",label:AjxMsg.seconds}
]
};
ZaModel.getTimeChoices1=function(){
return[{
value:"d",label:AjxMsg.days}
,{
value:"h",label:AjxMsg.hours}
]
};
ZaModel.getLongTimeChoices=function(){
return[{
value:"d",label:AjxMsg.days}
,{
value:"w",label:AjxMsg.weeks}
,{
value:"m",label:AjxMsg.months}
,{
value:"y",label:AjxMsg.years}
]
};
ZaModel.getMailPollingIntervalChoices=function(){
return[{
value:"500ms",label:ZaMsg.LBL_asNewMailArrives}
,{
value:"120s",label:"2 "+ZaMsg.LBL_minute}
,{
value:"180s",label:"3 "+ZaMsg.LBL_minute}
,{
value:"240s",label:"4 "+ZaMsg.LBL_minute}
,{
value:"300s",label:"5 "+ZaMsg.LBL_minute}
,{
value:"360s",label:"6 "+ZaMsg.LBL_minute}
,{
value:"420s",label:"7 "+ZaMsg.LBL_minute}
,{
value:"480s",label:"8 "+ZaMsg.LBL_minute}
,{
value:"540s",label:"9 "+ZaMsg.LBL_minute}
,{
value:"600s",label:"10 "+ZaMsg.LBL_minute}
,{
value:"900s",label:"15 "+ZaMsg.LBL_minute}
,{
value:"31536000s",label:ZaMsg.LBL_manual}
]
};
ZaModel.MAIL_POLLING_INTERVAL_CHOICES=ZaModel.getMailPollingIntervalChoices;
ZaModel.prototype.toString=function(){
return"ZaModel"
};
ZaModel.prototype.addChangeListener=function(e){
return this._evtMgr.addListener(ZaEvent.L_MODIFY,e)
};
ZaModel.prototype.removeChangeListener=function(e){
return this._evtMgr.removeListener(ZaEvent.L_MODIFY,e)
};
ZaModel.setUnrecoganizedChoiceValue=function(e,s){
var o=ZaMsg.VALUE_UNRECOGNIZED;
var n=s;
if(typeof(s)=="function"){
n=s.call(this)
}
for(var t=0;
t<n.length;
t++){
if(e==n[t].value){
o=e;
break
}}
return o
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaItem")){
ZaItem=function(e){
if(arguments.length==0){
return
}
this._iKeyName=e;
this._uuid=ZaUtil.getItemUUid();
this.rightsLoaded=false;
ZaModel.call(this,true)
};
ZaItem.prototype=new ZaModel;
ZaItem.prototype.constructor=ZaItem;
ZaItem.loadMethods=new Object();
ZaItem.initMethods=new Object();
ZaItem.modifyMethods=new Object();
ZaItem.modifyMethodsExt=new Object();
ZaItem.createMethods=new Object();
ZaItem.removeMethods=new Object();
ZaItem.modelExtensions=new Object();
ZaItem.getRelatedMethods=new Object();
ZaItem.ACCOUNT="account";
ZaItem.DATASOURCE="dataSource";
ZaItem.DL="dl";
ZaItem.GROUP="grp";
ZaItem.ALIAS="alias";
ZaItem.RESOURCE="calresource";
ZaItem.DOMAIN="domain";
ZaItem.COS="cos";
ZaItem.GLOBAL_CONFIG="config";
ZaItem.GLOBAL_GRANT="global";
ZaItem.SERVER="server";
ZaItem.STATS="stats";
ZaItem.ZIMLET="zimlet";
ZaItem.MAILQ_ITEM="message";
ZaItem.MAILQ="mailque";
ZaItem.HOME="home";
ZaItem.A_objectClass="objectClass";
ZaItem.A_zimbraId="zimbraId";
ZaItem.A_cn="cn";
ZaItem.A_zimbraACE="zimbraACE";
ZaItem.A_zimbraCreateTimestamp="zimbraCreateTimestamp";
ZaItem._ATTR=new Object();
ZaItem._ATTR[ZaItem.A_zimbraId]=ZaMsg.attrDesc_zimbraId;
ZaItem.ID_PATTERN=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;
ZaItem.prototype.toString=function(){
if(this.name){
return this.name
}else{
if(this.id){
return this.id
}else{
return"ZaItem "+this.type+": name="+this.name+" id="+this.id
}}};
ZaItem.compareNamesAsc=function(t,e){
var o=t.name.toLowerCase();
var n=e.name.toLowerCase();
if(o<n){
return -1
}
if(o>n){
return 1
}else{
return 0
}};
ZaItem.compareNamesDesc=function(t,e){
var o=t.name.toLowerCase();
var n=e.name.toLowerCase();
if(o<n){
return 1
}
if(o>n){
return -1
}else{
return 0
}};
ZaItem.compareDescription=function(t,e){
return ZaItem.compareAttr(t,e,"description")
};
ZaItem.compareAttr=function(o,t,e){
if(o.attrs[e]==null){
return -1
}
if(t.attrs[e]==null){
return 1
}
if(o.attrs[e]<t.attrs[e]){
return -1
}
if(o.attrs[e]>t.attrs[e]){
return 1
}else{
return 0
}};
ZaItem.compareAttrAsc=ZaItem.compareAttr;
ZaItem.compareAttrDesc=function(o,t,e){
if(o.attrs[e]==null){
return 1
}
if(t.attrs[e]==null){
return -1
}
if(o.attrs[e]<t.attrs[e]){
return 1
}
if(o.attrs[e]>t.attrs[e]){
return -1
}else{
return 0
}};
ZaItem.getFromType=function(e){
switch(e){
case ZaItem.ACCOUNT:return new ZaAccount();
case ZaItem.ALIAS:return new ZaAlias();
case ZaItem.DL:return new ZaDistributionList();
case ZaItem.RESOURCE:return new ZaResource();
case ZaItem.DOMAIN:return new ZaDomain();
case ZaItem.COS:return new ZaCos();
case ZaItem.SERVER:return new ZaServer();
case ZaItem.MAILQ:return new ZaMTA();
case ZaItem.DATASOURCE:return new ZaDataSource()
}};
ZaItem.prototype.remove=function(){
if(ZaItem.removeMethods[this._iKeyName]){
var e=ZaItem.removeMethods[this._iKeyName];
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this)
}}}};
ZaItem.prototype.refresh=function(t,e){
this.load(this.id?"id":null,this.id?this.id:null,t,e)
};
ZaItem.prototype.getRelatedList=function(t){
var o=[];
if(ZaItem.getRelatedMethods[this._iKeyName]){
var e=ZaItem.getRelatedMethods[this._iKeyName];
var s=e.length;
for(var n=0;
n<s;
n++){
if(typeof(e[n])=="function"){
o=o.concat(e[n].call(this,t))
}}}
return o
};
ZaItem.prototype.copyTo=function(s,t,o,n){
if(!n){
n=1
}else{
n++
}
if(!o){
o=4
}
for(var e in this){
if(this[e]==null||this[e]==undefined){
s[e]=null
}else{
if(t&&(n<=o)){
if(this[e] instanceof Array){
s[e]=[];
ZaItem.prototype.copyTo.call(this[e],s[e],t,o,n)
}else{
if(typeof(this[e])=="object"){
s[e]={};
ZaItem.prototype.copyTo.call(this[e],s[e],t,o,n)
}else{
s[e]=this[e]
}}}else{
s[e]=this[e]
}}}};
ZaItem.prototype.parseTargetsRightsFromJS=function(n){
if(n){
this.noAttrsAvailable=true;
this.rights={};
if(n.right&&n.right instanceof Array){
var l=n.right;
for(var h in l){
this.rights[l[h].n]=true
}}
if(n.id){
this.id=n.id
}
if(n.name){
this.name=n.name
}
if(!this._defaultValues){
this._defaultValues={
attrs:{}}
}
if(!this.getAttrs){
this.getAttrs={}
}
if(!this.setAttrs){
this.setAttrs={}
}
if(AjxUtil.isEmpty(n.getAttrs)&&AjxUtil.isEmpty(n.setAttrs)){
this.getAttrs=null;
return
}
this.attrsToGet=[];
if(n.getAttrs&&n.getAttrs instanceof Array&&n.getAttrs[0]){
if(n.getAttrs[0].a&&n.getAttrs[0].a instanceof Array){
var c=n.getAttrs[0].a;
this.noAttrsAvailable=false;
for(var e in c){
this.getAttrs[c[e].n]=true;
this.attrsToGet.push(c[e].n);
if(c[e]["default"]&&c[e]["default"][0]&&c[e]["default"][0].v&&c[e]["default"][0].v instanceof Array){
var o=c[e]["default"][0].v.length;
if(o==1){
if((c[e].n==ZaDomain.A_zimbraFreebusyExchangeAuthPassword)&&(c[e]["default"][0].v[0]._content=="VALUE-BLOCKED")){
this._defaultValues.attrs[c[e].n]=""
}else{
this._defaultValues.attrs[c[e].n]=c[e]["default"][0].v[0]._content
}}else{
if(o>1){
this._defaultValues.attrs[c[e].n]=new Array();
for(var t=0;
t<o;
t++){
this._defaultValues.attrs[c[e].n][t]=c[e]["default"][0].v[t]._content
}}}}}
if(!c[ZaItem.A_zimbraId]){
this.attrsToGet.push(ZaItem.A_zimbraId)
}}
if(n.getAttrs[0].all){
this.getAttrs.all=true;
this.noAttrsAvailable=false
}}
if(n.setAttrs&&n.setAttrs instanceof Array&&n.setAttrs[0]){
if(n.setAttrs[0].a&&n.setAttrs[0].a instanceof Array){
var s=n.setAttrs[0].a;
if(!this.getAttrs){
this.getAttrs={}
}
this.noAttrsAvailable=false;
for(var e in s){
this.setAttrs[s[e].n]=true;
this.getAttrs[s[e].n]=true;
if(s[e]["default"]&&s[e]["default"][0]&&s[e]["default"][0].v&&s[e]["default"][0].v instanceof Array){
var o=s[e]["default"][0].v.length;
if(o==1){
this._defaultValues.attrs[s[e].n]=s[e]["default"][0].v[0]._content
}else{
if(o>1){
this._defaultValues.attrs[s[e].n]=new Array();
for(var t=0;
t<o;
t++){
this._defaultValues.attrs[s[e].n][t]=s[e]["default"][0].v[t]._content
}}}}}}
if(n.setAttrs[0].all){
this.noAttrsAvailable=false;
this.setAttrs.all=true;
this.getAttrs.all=true
}}}
this.rightsLoaded=true
};
ZaItem.prototype.initEffectiveRightsFromJS=function(e){
this._defaultValues={
attrs:{}};
if(e&&e.target&&e.target instanceof Array){
this.parseTargetsRightsFromJS(e.target[0])
}};
ZaItem.prototype.loadEffectiveRights=function(o,s,e,r){
if(!this.type){
return
}
if(AjxUtil.isUndefined(s)||AjxUtil.isNull(s)){
s=""
}
try{
if(r){
this._getEffectiveRights(o,s,e,r)
}else{
var n=this._getEffectiveRights(o,s,e,r);
this.initEffectiveRightsFromJS(n)
}}
catch(t){
throw (t)
}};
ZaItem.RightCache=[];
ZaItem.getCacheName=function(n,s,t,e){
var o=n+s+" "+t;
if(e){
o=o+"TRUE"
}else{
o=o+"FALSE"
}
return o
};
ZaItem.inCacheProcess=function(e){
if(!e){
return false
}
return ZaSettings.initializing
};
ZaItem.prototype._getEffectiveRights=function(d,o,n,f){
var l=ZaItem.getCacheName(d,o,this.type,n);
var m=ZaItem.inCacheProcess(o);
var h;
if(((!ZaItem.RightCache[l])&&m)||!m){
var u=AjxSoapDoc.create("GetEffectiveRightsRequest",ZaZimbraAdmin.URN,null);
if(n){
u.setMethodAttribute("expandAllAttrs","getAttrs")
}
var e=u.set("target",o);
if(!AjxUtil.isEmpty(d)){
e.setAttribute("by",d)
}
e.setAttribute("type",this.type);
var r=u.set("grantee",ZaZimbraAdmin.currentUserId);
r.setAttribute("by","id");
var s=new Object();
s.soapDoc=u;
s.asyncMode=f?true:false;
s.callback=f?f:null;
var t={};
t.controller=(ZaApp.getInstance()&&ZaApp.getInstance().getCurrentController())?ZaApp.getInstance().getCurrentController():null;
t.busyMsg=ZaMsg.BUSY_REQUESTING_ACCESS_RIGHTS;
try{
if(f){
ZaRequestMgr.invoke(s,t)
}else{
h=ZaRequestMgr.invoke(s,t).Body.GetEffectiveRightsResponse;
if(m){
ZaItem.RightCache[l]=h
}}}
catch(c){
throw (c)
}}else{
h=ZaItem.RightCache[l]
}
return h
};
ZaItem.prototype.loadNewObjectDefaults=function(h,r,o,d){
if(!this.type){
return
}
var c=AjxSoapDoc.create("GetCreateObjectAttrsRequest",ZaZimbraAdmin.URN,null);
var e=c.set("target","");
e.setAttribute("type",this.type);
if(!AjxUtil.isEmpty(r)&&!AjxUtil.isEmpty(h)){
var u=c.set("domain",r);
u.setAttribute("by",h)
}
if(!AjxUtil.isEmpty(d)&&!AjxUtil.isEmpty(o)){
var m=c.set("cos",d);
m.setAttribute("by",o)
}
var s=new Object();
s.soapDoc=c;
var t={};
t.controller=(ZaApp.getInstance()&&ZaApp.getInstance().getCurrentController())?ZaApp.getInstance().getCurrentController():null;
t.busyMsg=ZaMsg.BUSY_REQUESTING_ACCESS_RIGHTS;
try{
var n=ZaRequestMgr.invoke(s,t).Body.GetCreateObjectAttrsResponse;
this.parseTargetsRightsFromJS(n)
}
catch(l){}};
ZaItem.prototype.load=function(r,h,s,e){
r=r?r:"id";
h=h?h:this.id;
if(!s){
this.rights={};
this.getAttrs={};
this.setAttrs={};
this.loadEffectiveRights(r,h,e)
}
if(this.noAttrsAvailable){
return
}
if(ZaItem.loadMethods[this._iKeyName]){
var t=ZaItem.loadMethods[this._iKeyName];
var n=t.length;
for(var o=0;
o<n;
o++){
if(typeof(t[o])=="function"){
t[o].call(this,r,h)
}}}};
ZaItem.prototype.modify=function(n,s){
if(ZaItem.modifyMethods[this._iKeyName]){
var e=ZaItem.modifyMethods[this._iKeyName];
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this,n,s)
}}}};
ZaItem.create=function(h,e,s){
var r=new e();
if(ZaItem.createMethods[s]){
var t=ZaItem.createMethods[s];
var n=t.length;
for(var o=0;
o<n;
o++){
if(typeof(t[o])=="function"){
t[o].call(this,h,r)
}}}
return r
};
ZaItem.prototype.initFromDom=function(s){
this.name=s.getAttribute("name");
this.id=s.getAttribute("id");
this.attrs=new Object();
if(!AjxUtil.isEmpty(s.nodeName)){
this.type=s.nodeName
}
var o=s.childNodes;
var n=o.length;
for(var r=0;
r<n;
r++){
var t=o[r];
if(t.nodeName!="a"){
continue
}
var e=t.getAttribute("n");
var l=t.getAttribute("pd");
if(l&&l==1){
continue
}
if(t.firstChild!=null){
var c=t.firstChild.nodeValue;
if(e in this.attrs){
var h=this.attrs[e];
if((typeof h)=="object"){
h.push(c)
}else{
this.attrs[e]=[h,c]
}}else{
this.attrs[e]=c
}}}};
ZaItem.prototype.initFromJS=function(o){
if(!o){
return
}
if(o.name){
this.name=AjxStringUtil.htmlEncode(o.name)
}
if(o.id){
this.id=o.id
}
if(o.isgroup==false){
this.isgroup=0
}else{
if(o.isgroup==true){
this.isgroup=1
}}
this.attrs=new Object();
if(o.a){
var e=o.a.length;
for(var t=0;
t<e;
t++){
if(o.a[t].pd){
continue
}
if(!this.attrs[[o.a[t].n]]){
this.attrs[[o.a[t].n]]=o.a[t]._content
}else{
if(!(this.attrs[[o.a[t].n]] instanceof Array)){
this.attrs[[o.a[t].n]]=[this.attrs[[o.a[t].n]]]
}
this.attrs[[o.a[t].n]].push(o.a[t]._content)
}}}
if(o._attrs){
for(var t in o._attrs){
if(o._attrs[t].pd){
continue
}
if(!this.attrs[t]){
this.attrs[t]=o._attrs[t]
}else{
if(!(this.attrs[t] instanceof Array)){
this.attrs[t]=[this.attrs[t]]
}
this.attrs[t].push(o._attrs[t])
}}}
if(!this.attrs[ZaAccount.A_description]){
this.attrs[ZaAccount.A_description]=[]
}
if(!(this.attrs[ZaAccount.A_description] instanceof Array)){
this.attrs[ZaAccount.A_description]=[this.attrs[ZaAccount.A_description]]
}
if(!this.attrs[ZaItem.A_zimbraId]&&this.id){
this.attrs[ZaItem.A_zimbraId]=this.id
}};
ZaItem.initAttrsFromJS=function(n){
if(!n){
return
}
var o={};
if(n.a){
var e=n.a.length;
for(var t=0;
t<e;
t++){
if(n.a[t].pd){
continue
}
if(!o[[n.a[t].n]]){
o[[n.a[t].n]]=n.a[t]._content
}else{
if(!(o[[n.a[t].n]] instanceof Array)){
o[[n.a[t].n]]=[o[[n.a[t].n]]]
}
o[[n.a[t].n]].push(n.a[t]._content)
}}}
if(n._attrs){
for(var t in n._attrs){
if(n._attrs[t].pd){
continue
}
if(!o[t]){
o[t]=n._attrs[t]
}else{
if(!(o[t] instanceof Array)){
o[t]=[o[t]]
}
o[t].push(n._attrs[t])
}}}
return o
};
ZaItem.prototype._addRow=function(n,o,t,e){
if(o!=null){
t[e++]="<tr valign='top'><td align='right' style='padding-right: 5px;'><b>";
t[e++]=AjxStringUtil.htmlEncode(n);
t[e++]="</b></td><td align='left'><div style='white-space:nowrap; overflow:hidden;'>";
t[e++]=AjxStringUtil.htmlEncode(o);
t[e++]="</div></td></tr>"
}
return e
};
ZaItem.prototype._addAttrRow=function(t,o,e){
var n=this.attrs[t];
if(n!=null){
var s=ZaItem._attrDesc(t);
o[e++]="<tr valign='top'><td align='left' style='padding-right: 5px;'><b>";
o[e++]=AjxStringUtil.htmlEncode(s)+":";
o[e++]="</b></td><td align='left'><div style='white-space:nowrap; overflow:hidden;'>";
o[e++]=AjxStringUtil.htmlEncode(n);
o[e++]="</div></td></tr>"
}
return e
};
ZaItem._attrDesc=function(e){
var t=ZaItem._ATTR[e];
return(t==null)?e:t
};
ZaItem.prototype._init=function(){
if(ZaItem.initMethods[this._iKeyName]){
var e=ZaItem.initMethods[this._iKeyName];
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this)
}}}};
ZaItem.prototype.addAlias=function(n){
var t;
switch(this.type){
case ZaItem.ACCOUNT:t="AddAccountAliasRequest";
break;
case ZaItem.RESOURCE:t="AddAccountAliasRequest";
break;
case ZaItem.DL:t="AddDistributionListAliasRequest";
break;
default:throw new Error("Can't add alias for account type: "+this.type)
}
var o=AjxSoapDoc.create(t,ZaZimbraAdmin.URN,null);
o.set("id",this.id);
o.set("alias",n);
var s=new Object();
s.soapDoc=o;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_ADD_ALIAS};
ZaRequestMgr.invoke(s,e)
};
ZaItem.prototype.removeAlias=function(e){
var o;
switch(this.type){
case ZaItem.ACCOUNT:o="RemoveAccountAliasRequest";
break;
case ZaItem.DL:o="RemoveDistributionListAliasRequest";
break;
default:throw new Error("Can't add alias for account type: "+account.type)
}
var n=AjxSoapDoc.create(o,ZaZimbraAdmin.URN,null);
n.set("id",this.id);
n.set("alias",e);
var s=new Object();
s.soapDoc=n;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_REMOVE_ALIAS};
ZaRequestMgr.invoke(s,t)
};
ZaItem.checkInteropSettings=function(){
var m=ZaApp.getInstance().getCurrentController();
try{
var b=this.getForm().getInstance();
var t=b._defaultValues;
var r="CheckExchangeAuthRequest";
var y=AjxSoapDoc.create(r,ZaZimbraAdmin.URN,null);
var h=y.set("auth","");
var d=[ZaDomain.A_zimbraFreebusyExchangeURL,ZaDomain.A_zimbraFreebusyExchangeAuthScheme,ZaDomain.A_zimbraFreebusyExchangeAuthUsername,ZaDomain.A_zimbraFreebusyExchangeAuthPassword];
for(var u=0;
u<d.length;
u++){
var s=d[u];
var w=b.attrs[s]||t.attrs[s];
if(w==null){
var f;
if(s==ZaDomain.A_zimbraFreebusyExchangeURL){
f=ZaMsg.Error_missing_exchange_url
}else{
if(s==ZaDomain.A_zimbraFreebusyExchangeAuthScheme){
f=ZaMsg.Error_missing_scheme
}else{
if(s==ZaDomain.A_zimbraFreebusyExchangeAuthUsername){
f=ZaMsg.Error_missing_exchange_username
}else{
if(s==ZaDomain.A_zimbraFreebusyExchangeAuthPassword){
f=ZaMsg.Error_missing_exchange_password
}}}}
m.popupErrorDialog(f);
return
}else{
var g;
if(s==ZaDomain.A_zimbraFreebusyExchangeURL){
g="url"
}else{
if(s==ZaDomain.A_zimbraFreebusyExchangeAuthScheme){
g="scheme"
}else{
if(s==ZaDomain.A_zimbraFreebusyExchangeAuthUsername){
g="user"
}else{
if(s==ZaDomain.A_zimbraFreebusyExchangeAuthPassword){
g="pass"
}}}}
h.setAttribute(g,w)
}}
var c=new Object();
c.soapDoc=y;
var o={
controller:m,busyMsg:ZaMsg.BUSY_CHECKING_INTEROP_SETTINGS};
var l=ZaRequestMgr.invoke(c,o).Body.CheckExchangeAuthResponse;
m.popupMsgDialog(l.code[0]._content+"<br />"+l.message[0]._content)
}
catch(p){
m._handleException(p)
}};
ZaItem.clearInteropSettings=function(){
var e=this.getForm().getInstance();
var s=[ZaDomain.A_zimbraFreebusyExchangeURL,ZaDomain.A_zimbraFreebusyExchangeAuthScheme,ZaDomain.A_zimbraFreebusyExchangeAuthUsername,ZaDomain.A_zimbraFreebusyExchangeAuthPassword,ZaDomain.A_zimbraFreebusyExchangeUserOrg];
for(var t=0;
t<s.length;
t++){
var r=s[t];
this.setInstanceValue("",r)
}
var o=this.getForm();
o.parent.setDirty(true);
o.refresh()
};
ZaItem.ObjectModifiers={};
ZaItem.prototype.modifyObject=function(){
if(ZaItem.ObjectModifiers[this._iKeyName]){
var e=ZaItem.ObjectModifiers[this._iKeyName];
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this)
}}}};
ZaItem.initDescriptionItem=function(){
ZaItem.descriptionModelItem={
id:"description",type:_LIST_,ref:"attrs/description",listItem:{
type:_STRING_}};
ZaItem.descriptionXFormItem={
ref:"description",msgName:ZaMsg.NAD_Description,label:ZaMsg.NAD_Description,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top",type:_REPEAT_,align:_LEFT_,repeatInstance:"",showAddButton:false,showRemoveButton:false,showAddOnNextRow:false,items:[{
ref:".",type:_TEXTFIELD_,enableDisableChecks:[ZaItem.hasWritePermission],visibilityChecks:[ZaItem.hasReadPermission],width:"30em"}
]}
};
ZaItem.initDescriptionItem();
ZaItem.getDescriptionValue=function(e){
if(!e){
e=""
}
if(e instanceof Array){
e=e.toString()
}
return e
};
ZaItem.deepCloneListItem=function(t){
if(t==null){
return[]
}else{
if(!(t instanceof Array)){
return[t]
}else{
var o=[];
for(var e=0;
e<t.length;
e++){
o.push(t[e])
}
return o
}}};
ZaItem.hasReadPermission=function(t,e){
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
return true
}
if(!e){
e=this.getInstance()
}
if(!e.getAttrs){
return false
}
var o=null;
if(t){
o=t
}else{
if(!this.refPath){
return true
}else{
o=this.refPath
}}
return((e.getAttrs.all===true)||(e.getAttrs[o]===true))
};
XFormItem.prototype.hasReadPermission=ZaItem.hasReadPermission;
OSelect1_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Checkbox_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Textfield_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Select1_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Repeat_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
ZaItem.hasWritePermission=function(t,e){
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
return true
}
if(!e){
e=this.getInstance()
}
if(!e.setAttrs){
return false
}
var o=null;
if(t){
o=t
}else{
if(!this.refPath){
return true
}else{
o=this.refPath
}}
return((e.setAttrs.all===true)||(e.setAttrs[o]===true))
};
XFormItem.prototype.hasWritePermission=ZaItem.hasWritePermission;
Textfield_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
OSelect1_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Checkbox_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Select1_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Repeat_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
ZaItem.hasRight=function(t,e){
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
return true
}
if(!e){
e=this.getInstance()
}
if(!t){
return true
}
if(!e.rightsLoaded&&e.id&&e.loadEffectiveRights){
e.loadEffectiveRights("id",e.id,true)
}
if(!e.rights){
return false
}
return(e.rights[t]===true)
};
XFormItem.prototype.hasRight=ZaItem.hasRight;
ZaItem.hasAnyRight=function(o,e){
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
return true
}
if(!e){
e=this.getInstance()
}
if(!e.rights){
return false
}
if(!o){
return true
}
if(!o instanceof Array){
o=[o]
}
for(var t=0;
t<o.length;
t++){
if(e.rights[o[t]]===true){
return true
}}
return false
};
XFormItem.prototype.hasAnyRight=ZaItem.hasAnyRight;
ZaItem.adminHasAnyRight=function(t){
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
return true
}
if(!t){
return true
}
if(!t instanceof Array){
t=[t]
}
var o=new ZaAccount();
o.load(null,ZaZimbraAdmin.currentAdminId,false,true);
if(!o.rights){
return false
}
for(var e=0;
e<t.length;
e++){
if(o.rights[t[e]]===true){
return true
}}
return false
};
ZaItem.formatServerTime=function(n){
if(n){
var t=n.substring(0,8)+"T"+n.substring(8);
var e=AjxDateUtil.parseServerDateTime(t);
var o=AjxDateFormat.getDateTimeInstance(AjxDateFormat.LONG);
return o.format(e)
}else{
return""
}};
ZaItem.getZeroIsUnlimitedItem=function(){
var e={
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,iconVisible:true,content:ZaMsg.NAD_ZERO_UNLIMETED};
return e
};
ZaItem.getAboutScreenCopyright=function(){
var t=ZaServerVersionInfo.version||"N/A";
var e=ZaServerVersionInfo.release||"N/A";
return AjxMessageFormat.format(ZabMsg.aboutScreenCopyright,[t,e,AjxDateUtil.getYearStr()])
};
ZaItem.getSplashScreenCopyright=function(){
return AjxMessageFormat.format(ZabMsg.splashScreenCopyright,[AjxDateUtil.getYearStr()])
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaId")){
ZaId=function(){};
ZaId.WIDGET="z";
ZaId.WIDGET_VIEW="zv";
ZaId.WIDGET_TOOLBAR="ztb";
ZaId.WIDGET_BUTTON="zb";
ZaId.WIDGET_INPUT="zi";
ZaId.WIDGET_MENU="zm";
ZaId.WIDGET_MENU_ITEM="zmi";
ZaId.WIDGET_SELECT="zs";
ZaId.WIDGET_OVERVIEW_CNTR="zovc";
ZaId.WIDGET_OVERVIEW="zov";
ZaId.WIDGET_TREE="zt";
ZaId.WIDGET_TREE_ITEM_HDR="ztih";
ZaId.WIDGET_TREE_ITEM="zti";
ZaId.WIDGET_TAB="ztab";
ZaId.WIDGET_TAB_VIEW="ztabv";
ZaId.WIDGET_DLG="zdlg";
ZaId.WIDGET_DLG_VIEW="zdlgv";
ZaId.WIDGET_DLG_BUTTON="zdlgb";
ZaId.WIDGET_SEARCH_VIEW="zschv";
ZaId.SKIN_APP_BOTTOM_TOOLBAR="skin_container_app_bottom_toolbar";
ZaId.SKIN_APP_CHOOSER="skin_container_app_chooser";
ZaId.SKIN_APP_MAIN_FULL="skin_container_app_main_full";
ZaId.SKIN_APP_MAIN="skin_container_app_main";
ZaId.SKIN_APP_MAIN_ROW_FULL="skin_tr_main_full";
ZaId.SKIN_APP_MAIN_ROW="skin_tr_main";
ZaId.SKIN_APP_TOP_TOOLBAR="skin_container_app_top_toolbar";
ZaId.SKIN_LINKS="skin_container_links";
ZaId.SKIN_LOGO="skin_container_logo";
ZaId.SKIN_QUOTA_INFO="skin_container_quota";
ZaId.SKIN_SASH="skin_container_tree_app_sash";
ZaId.SKIN_SEARCH_BUILDER="skin_container_search_builder";
ZaId.SKIN_SEARCH_BUILDER_TOOLBAR="skin_container_search_builder_toolbar";
ZaId.SKIN_SEARCH_BUILDER_TR="skin_tr_search_builder";
ZaId.SKIN_SEARCH="skin_container_search";
ZaId.SKIN_PEOPLE_SEARCH="skin_container_people_search";
ZaId.SKIN_SHELL="skin_outer";
ZaId.SKIN_SPACING_SEARCH="skin_spacing_search";
ZaId.SKIN_SPLASH_SCREEN="skin_container_splash_screen";
ZaId.SKIN_STATUS="skin_container_status";
ZaId.SKIN_STATUS_ROW="skin_tr_status";
ZaId.SKIN_TREE_FOOTER="skin_container_tree_footer";
ZaId.SKIN_TREE="skin_container_tree";
ZaId.SKIN_USER_INFO="skin_container_username";
ZaId.SKIN_TASKBAR="skin_container_taskbar";
ZaId.SKIN_FOOTER="skin_footer";
ZaId.SKIN_AD="skin_adsrvc";
ZaId.SHELL="z_shell";
ZaId.LOADING_VIEW="z_loading";
ZaId.MAIN_SASH="z_sash";
ZaId.BANNER="z_banner";
ZaId.SEARCH_TOOLBAR="ztb_search";
ZaId.PEOPLE_SEARCH_TOOLBAR="ztb_people_search";
ZaId.USER_NAME="z_userName";
ZaId.USER_QUOTA="z_userQuota";
ZaId.PRESENCE="z_presence";
ZaId.TASKBAR="z_taskbar";
ZaId.NEW_FOLDER_BUTTON="zb_newFolder";
ZaId.STATUS_VIEW="z_status";
ZaId.TOAST="z_toast";
ZaId.APP_CHOOSER="ztb_appChooser";
ZaId.CURRENT_APP_BAR="zb_currentApp";
ZaId.getToolbarId=function(t,e){
return DwtId._makeId(ZaId.WIDGET_TOOLBAR,t,e)
};
ZaId.getButtonId=function(t,o,e){
return DwtId._makeId(ZaId.WIDGET_BUTTON,t,e,o)
};
ZaId.getMenuId=function(t,e){
return DwtId._makeId(ZaId.WIDGET_MENU,t,e)
};
ZaId.getMenuItemId=function(t,o,e){
return DwtId._makeId(ZaId.WIDGET_MENU_ITEM,t,e,o)
};
ZaId.getOverviewContainerId=function(e){
return DwtId._makeId(ZaId.WIDGET_OVERVIEW_CNTR,e)
};
ZaId.getOverviewId=function(e){
return DwtId._makeId(ZaId.WIDGET_OVERVIEW,e)
};
ZaId.getTreeId=function(t,e){
return DwtId._makeId(ZaId.WIDGET_TREE,t,e)
};
ZaId.getTreeItemId=function(n,o,t,e){
if(t){
return DwtId._makeId(ZaId.WIDGET_TREE_ITEM_HDR,n,o,e)
}else{
return DwtId._makeId(ZaId.WIDGET_TREE_ITEM,n,o,e)
}};
ZaId.getViewId=function(e,t,o){
var n=DwtId._makeId(ZaId.WIDGET_VIEW,o,e);
return t?[n,t].join(""):n
};
ZaId.getDialogId=function(e,t){
return DwtId._makeId(ZaId.WIDGET_DLG,e,t)
};
ZaId.getDialogViewId=function(e,t){
return DwtId._makeId(ZaId.WIDGET_DLG_VIEW,e,t)
};
ZaId.getDialogButtonId=function(e,t){
return DwtId._makeId(ZaId.WIDGET_DLG_BUTTON,e,t)
};
ZaId.getComposeViewId=function(e){
var t=DwtId._makeId(ZaId.WIDGET,ZaId.COMPOSE_VIEW);
return e?[t,e].join(""):t
};
ZaId.getTabId=function(e,t){
return DwtId._makeId(ZaId.WIDGET_TAB,e,t)
};
ZaId.getTabViewId=function(e,t){
return DwtId._makeId(ZaId.WIDGET_TAB_VIEW,e,t)
};
ZaId.getPrefPageId=function(e){
return"PREF_PAGE_"+e
};
ZaId.getSearchViewId=function(e,t){
return DwtId._makeId(ZaId.WIDGET_SEARCH_VIEW,e,t)
};
ZaId.APP="App";
ZaId.TREEITEM_ACCOUNT="ACCOUNT";
ZaId.TREEITEM_ALIASES="ALIASES";
ZaId.TREEITEM_DL="DL";
ZaId.TREEITEM_RESOURCES="RESOURCES";
ZaId.TREEITEM_COS="COS";
ZaId.TREEITEM_DOMAINS="DOMAINS";
ZaId.TREEITEM_SERVERS="SERVERS";
ZaId.TREEITEM_ZIMLETS="ZIMLETS";
ZaId.TREEITEM_ADMINEXT="AEMINEXT";
ZaId.TREEITEM_GSET="GSET";
ZaId.TREEITEM_RIGHTS="RIGHTS";
ZaId.TREEITEM_GACL="GACL";
ZaId.TREEITEM_SSTATUS="SSTATUS";
ZaId.TREEITEM_SSTATIS="SSTATIS";
ZaId.TREEITEM_MQUEUE="MQUEUE";
ZaId.TREEITEM_BACKUPS="BACKUPS";
ZaId.TREEITEM_DATAINPUT="DATAINPUT";
ZaId.TREEITEM_CERT="CERT";
ZaId.TREEITEM_SEARCHMAIL="SEARCHMAIL";
ZaId.PANEL_APP="AppAdmin";
ZaId.PANEL_ADDRESS="ADDRESS";
ZaId.PANEL_CONFIGURATION="CONFIGURATION";
ZaId.PANEL_MONITORING="MONITORING";
ZaId.PANEL_TOOLS="TOOLS";
ZaId.PANEL_SEARCHS="SEARCHOPTS";
ZaId.PANEL_APPSEARCH="AppSearch";
ZaId.SEARCH_VIEW="SEARCHV";
ZaId.SEARCH_QUERY="SEARCH_QUERY";
ZaId.VIEW_ACCTLIST="ACLV";
ZaId.VIEW_ALASLIST="ALLV";
ZaId.VIEW_DLLIST="DLLV";
ZaId.VIEW_RESLIST="RESLV";
ZaId.VIEW_COSLIST="COSLV";
ZaId.VIEW_DMLIST="DMLV";
ZaId.VIEW_SERLIST="SERLV";
ZaId.VIEW_ZIMLIST="ZIMLV";
ZaId.VIEW_AELIST="AELV";
ZaId.VIEW_GSETLIST="GSLV";
ZaId.VIEW_RIGHTLIST="RLV";
ZaId.VIEW_GACLIST="ACLV";
ZaId.VIEW_STATUSLIST="STALV";
ZaId.VIEW_STATISLIST="STSLV";
ZaId.VIEW_MQLIST="MQLV";
ZaId.VIEW_BKLIST="BKLV";
ZaId.VIEW_DILIST="DILV";
ZaId.VIEW_CRTLIST="CRTLV";
ZaId.VIEW_SMLIST="SMLV";
ZaId.VIEW_SCHLIST="SCHLV";
ZaId.VIEW_MTALIST="MTALV";
ZaId.VIEW_MEMLIST="MEMLV";
ZaId.VIEW_ACCT="ACCTV";
ZaId.VIEW_ALAS="ALASV";
ZaId.VIEW_DL="DLV";
ZaId.VIEW_RES="RESV";
ZaId.VIEW_COS="COSV";
ZaId.VIEW_DOMAIN="DMV";
ZaId.VIEW_SERVER="SERV";
ZaId.VIEW_ZIMLET="ZIMV";
ZaId.VIEW_ADEXT="AEV";
ZaId.VIEW_GSET="GSV";
ZaId.VIEW_RIGHT="RTV";
ZaId.VIEW_GACL="GACV";
ZaId.VIEW_STATUS="STAV";
ZaId.VIEW_STATIS="STSV";
ZaId.VIEW_MQ="MQV";
ZaId.VIEW_BK="BKV";
ZaId.VIEW_DI="DIV";
ZaId.VIEW_CRT="CRTV";
ZaId.VIEW_SM="SMV";
ZaId.VIEW_SCH="SCHV";
ZaId.VIEW_MTA="MTAV";
ZaId.VIEW_HOME="HOMEV";
ZaId.OP_NEW_ACCT="NEW_ACCT";
ZaId.OP_EDIT_ACCT="EDIT_ACCT";
ZaId.OP_DEL_ACCT="DEL_ACCT";
ZaId.OP_CHD_ACCTPWD="CHD_ACTPWD";
ZaId.OP_CLICK_LEFT="LEFT_CLICK";
ZaId.OP_CLICK_RIGHT="RIGHT_CLICK";
ZaId.OP_CLICK_DBLEFT="DBLEFT_CLICK";
ZaId.MENU_DROP="MENU_DROP";
ZaId.MENU_POP="MENU_POP";
ZaId.TAB_GROUP="TAB_GROUP";
ZaId.TAB_MAIN="MAIN_TAB";
ZaId.TAB_ACCT_MANAGE="ACCT_MANAGE";
ZaId.TAB_ACCT_EDIT="ACCT_EDIT";
ZaId.TAB_ALIAS_MANAGE="ALIAS_MANAGE";
ZaId.TAB_ALIAS_EDIT="ALIAS_EDIT";
ZaId.TAB_DL_MANAGE="DL_MANAGE";
ZaId.TAB_DL_EDIT="DL_EDIT";
ZaId.TAB_RES_MANAGE="RES_MANAGE";
ZaId.TAB_RES_EDIT="RES_EDIT";
ZaId.TAB_COS_MANAGE="COS_MANAGE";
ZaId.TAB_COS_EDIT="COS_EDIT";
ZaId.TAB_DOMAIN_MANAGE="DOMAIN_MANAGE";
ZaId.TAB_DOMAIN_EDIT="DOAMIN_EDIT";
ZaId.TAB_SERVER_MANAGE="SERVER_MANAGE";
ZaId.TAB_SERVER_EDIT="SERVER_EDIT";
ZaId.TAB_ZIM_MANAGE="ZIMLET_MANAGE";
ZaId.TAB_ZIM_EDIT="ZIMLET_EDIT";
ZaId.TAB_AE_MANAGE="ADMEXT_MANAGE";
ZaId.TAB_AE_EDIT="ADMEXT_EDIT";
ZaId.TAB_STATUS_MANAGE="STATUS_MANAGE";
ZaId.TAB_STATUS_EDIT="STATUS_EDIT";
ZaId.TAB_MTX_MANAGE="MTX_MANAGE";
ZaId.TAB_MTX_EDIT="MTX_EDIT";
ZaId.TAB_SEARCH_MANAGE="SEARCH_MANAGE";
ZaId.TAB_SEARCH_EDIT="SEARCH_EDIT";
ZaId.TAB_GSET_EDIT="GSET_EDIT";
ZaId.TAB_DOWNLOADS="DOWNLOADS";
ZaId.TAB_VIEWRIGHTS="VIEW_RIGHTS";
ZaId.TAB_UNDEF="UNDEFINE";
ZaId.DLG_NEW_ACCT="NEW_ACCT";
ZaId.DLG_NEW_ALIAS="NEW_ALIAS";
ZaId.DLG_EDIT_ALIAS="EDIT_ALIAS";
ZaId.DLG_EDIT_SIGNATURE="EDIT_SIGNATURE";
ZaId.DLG_NEW_RES="NEW_RES";
ZaId.DLG_NEW_ADMIN="NEW_ADMIN";
ZaId.DLG_NEW_DOMAIN="NEW_DOMAIN";
ZaId.DLG_ZIM_DEPLOY="ZIM_DEPLOY";
ZaId.DLG_AUTH_CONFIG="AUTH_CONFIG";
ZaId.DLG_AUTPROV_CONFIG="AUTOPROV_CONFIG";
ZaId.DLG_AUTPROV_MANUAL="AUTOPROV_MANUAL";
ZaId.DLG_AUTPROV_MANUAL_PWD="AUTOPROV_MANUAL_PWD";
ZaId.DLG_AUTH_SPNEGO="AUTH_SPNEGO";
ZaId.DLG_AUTH_SPNEGO_UA="AUTH_SPNEGO_UA";
ZaId.DLG_NEW_DL="NEW_DL";
ZaId.DLG_NEW_COS="NEW_COS";
ZaId.FLUSH_SERVER_CACHE="FLUSH_SERVER_CACHE";
ZaId.DLG_MSG="MSG";
ZaId.DLG_ERR="ERR";
ZaId.DLG_UNDEF="UNDEFINE";
ZaId.CTR_GLOBAL="GLOBAL_";
ZaId.CTR_PREFIX="CTR_";
ZaId.CTR_UNDEF="CTR_UNDEFINE"
}
if(AjxPackage.define("zimbraAdmin.common.ZaIPUtil")){
ZaIPUtil=function(){};
ZaIPUtil.MASK_RE=/^\d{1,3}$/;
ZaIPUtil.IP4_CHUNK_RE=ZaIPUtil.MASK_RE;
ZaIPUtil.IP6_CHUNK_RE=/^([A-Fa-f0-9]{1,4})$/;
ZaIPUtil.IPMIX_PREFIX_RE=/^::(f|F){4}:$/;
ZaIPUtil.ERROR_CIDR_NULL="ERROR_CIDR_NULL";
ZaIPUtil.ERROR_MASK_NULL="ERROR_MASK_NULL";
ZaIPUtil.ERROR_MASK_FORMAT="ERROR_MASK_FORMAT";
ZaIPUtil.ERROR_IP_NULL="ERROR_IP_NULL";
ZaIPUtil.ERROR_IP_FORMAT="ERROR_IP_FORMAT";
ZaIPUtil.ERROR_IP_VER_DISMATCH="ERROR_IP_VER_DISMATCH";
ZaIPUtil.isValidCIDR=function(e){
if(!e){
throw ZaIPUtil.ERROR_CIDR_NULL
}
var n=e.indexOf("/");
if(n==-1){
throw ZaIPUtil.ERROR_MASK_NULL
}
var r=e.substring(0,n);
var o=e.substring(n+1);
if(!ZaIPUtil.MASK_RE.test(o)){
throw ZaIPUtil.ERROR_MASK_FORMAT
}
var s=parseInt(o,10);
var t=ZaIPUtil.isValidIP(r);
if(!t){
return""
}
if(t.ver==ZaIPData.v4){
if(s>32){
throw ZaIPUtil.ERROR_MASK_FORMAT
}}else{
if(s>128){
throw ZaIPUtil.ERROR_MASK_FORMAT
}}
return new ZaCIDRData(t,s,e)
};
ZaIPUtil.getNetworkAddr=function(o,d){
var e;
var r;
if(o.ver==ZaIPData.v4){
e=32;
r=8
}else{
if(o.ver==ZaIPData.v6){
e=128;
r=16
}}
var h=Math.floor(d/r);
var t=d%r;
var c=ZaIPUtil.getNonZeroNum(t,r);
var l=[];
for(var s=0;
s<o.fmtArr.length;
s++){
if(h>0){
l.push(o.fmtArr[s]);
h--
}else{
if(c!=0){
var n=o.fmtArr[s]&c;
l.push(n);
c=0
}else{
l.push(0)
}}}
return new ZaCIDRData(new ZaIPData(l,o.ver,undefined,o.src),d)
};
ZaIPUtil.getNonZeroNum=function(e,s){
if(e==0){
return 0
}
var t=0;
var n=Math.pow(2,s-e);
for(var o=0;
o<e;
o++){
t=t+n;
n=n*2
}
return t
};
ZaIPUtil.countOneBit=function(t){
var e=0;
while(t){
e++;
t=t&(t-1)
}
return e
};
ZaIPUtil.getNetBit=function(n){
var h=(n.indexOf(".")!=-1)?true:false;
var r=(n.indexOf(":")!=-1)?true:false;
if(!h&&!r){
var e=parseInt(n,16);
return ZaIPUtil.countOneBit(e)
}
var o=ZaIPUtil.isValidIP(n);
if(!o){
return 0
}
var t=0;
for(var s=0;
s<o.fmtArr.length;
s++){
if(o.fmtArr[s]==0){
break
}
t=t+ZaIPUtil.countOneBit(o.fmtArr[s])
}
return t
};
ZaIPUtil.isInSubNet=function(l,o){
var t=l.ipData;
var d=l.mask;
if(t.ver!=o.ver){
return false
}
var c=d;
var h,r,e;
var n=(t.ver==ZaIPData.v4)?8:16;
for(var s=0;
s<t.fmtArr.length;
s++){
if(c==0){
break
}
if(c>=n){
h=n
}else{
h=c
}
c=c-n;
r=t.fmtArr[s]>>(n-h);
e=o.fmtArr[s]>>(n-h);
if(r!=e){
return false
}}
return true
};
ZaIPUtil.compareIP=function(o,e){
if(!o||!e){
throw ZaIPUtil.ERROR_IP_NULL
}
if(o.ver!=e.ver){
throw ZaIPUtil.ERROR_IP_VER_DISMATCH
}
if(o.fmtArr.length!=e.fmtArr.length){
throw ZaIPUtil.ERROR_IP_VER_DISMATCH
}
for(var t=0;
t<o.fmtArr.length;
t++){
if(o.fmtArr[t]>e.fmtArr[t]){
return 1
}else{
if(o.fmtArr[t]<e.fmtArr[t]){
return -1
}}}
return 0
};
ZaIPUtil.isValidIP=function(e){
if(!e){
throw ZaIPUtil.ERROR_IP_NULL
}
var o=(e.indexOf(".")==-1)?false:true;
var t=(e.indexOf(":")==-1)?false:true;
if(!t&&o){
return ZaIPUtil.isIPV4(e)
}else{
if(t&&!o){
return ZaIPUtil.isIPV6(e)
}else{
if(t&&o){
return ZaIPUtil.isIPVMix(e)
}else{
throw ZaIPUtil.ERROR_IP_FORMAT
}}}};
ZaIPUtil.isIPV4=function(e){
if(!e){
throw ZaIPUtil.ERROR_IP_NULL
}
var n=e.split(".");
if(n.length!=4){
throw ZaIPUtil.ERROR_IP_FORMAT
}
var o;
for(var t=0;
t<n.length;
t++){
if(!n[t]){
throw ZaIPUtil.ERROR_IP_FORMAT
}
if(!ZaIPUtil.IP4_CHUNK_RE.test(n[t])){
throw ZaIPUtil.ERROR_IP_FORMAT
}
o=parseInt(n[t],10);
if(o>255){
throw ZaIPUtil.ERROR_IP_FORMAT
}
n[t]=o
}
return new ZaIPData(n,ZaIPData.v4,undefined,e)
};
ZaIPUtil.isIPV6=function(n){
if(!n){
throw ZaIPUtil.ERROR_IP_NULL
}
var t;
if((n[0]=="[")&&(n[n.length-1]=="]")){
t=n.substring(1,n.length-1)
}else{
t=n
}
var c=t.indexOf("%");
var s;
if(c!=-1){
s=t.substring(c+1);
t=t.substring(0,c)
}
if(!t){
throw ZaIPUtil.ERROR_IP_FORMAT
}
var e=t.indexOf("::");
if(e!=-1){
if(t.indexOf("::",e+2)!=-1){
throw ZaIPUtil.ERROR_IP_FORMAT
}}
var h=t.split(":");
if(h.length>8){
throw ZaIPUtil.ERROR_IP_FORMAT
}
var d;
for(var r=0;
r<h.length;
r++){
if(!h[r]){
if(d===undefined){
d=r
}
h[r]=0;
continue
}
if(!ZaIPUtil.IP6_CHUNK_RE.test(h[r])){
throw ZaIPUtil.ERROR_IP_FORMAT
}
h[r]=parseInt(h[r],16)
}
if(d===undefined&&(h.length!=8)){
throw ZaIPUtil.ERROR_IP_FORMAT
}
if(h.length<8&&(d!==undefined)){
var l=8-h.length;
for(var o=0;
o<l;
o++){
h.splice(d,0,0)
}}
return new ZaIPData(h,ZaIPData.v6,s,n)
};
ZaIPUtil.isIPVMix=function(s){
if(!s||s.length<9){
throw ZaIPUtil.ERROR_IP_FORMAT
}
var e;
if((s[0]=="[")&&(s[s.length-1]=="]")){
e=s.substring(1,s.length-1)
}else{
e=s
}
var n=e.substring(0,7);
if(!ZaIPUtil.IPMIX_PREFIX_RE.test(n)){
throw ZaIPUtil.ERROR_IP_FORMAT
}
var o=e.substring(7);
var t=ZaIPUtil.isIPV4(o);
if(!t){
throw ZaIPUtil.ERROR_IP_FORMAT
}
t.src=e;
return t
};
ZaCIDRData=function(t,e,o){
this.ipData=t;
this.mask=e;
this.src=o
};
ZaIPData=function(o,e,t,n){
this.fmtArr=o;
this.ver=e;
this.zoneSection=t;
this.src=n
};
ZaIPData.v4="4";
ZaIPData.v6="6";
ZaIPData.vMix="Mix"
}
if(AjxPackage.define("zimbraAdmin.common.Lifetime_XFormItem")){
MLifetime_XModelItem=function(){};
XModelItemFactory.createItemType("_MLIFETIME_","mlifetime",MLifetime_XModelItem);
MLifetime_XModelItem.prototype.minInclusive=0;
MLifetime_XModelItem.prototype.zeroValue=ZaMsg.Unlimited;
MLifetime_XModelItem.prototype.required=false;
MLifetime_XModelItem.prototype.validateType=function(e){
var t="";
if(e==this.zeroValue){
t="0"
}else{
if(e!=null&&e.length>0){
if(e.length>1){
t=e.substr(0,e.length-1)
}else{
t="0"
}}}
if(t){
t=XModelItem.prototype.validateNumber.call(this,t)
}
if(t==0&&this.required){
throw AjxMessageFormat.format(ZaMsg.exception_required_lifetime,e)
}
return e
};
Lifetime_XFormItem=function(){};
XFormItemFactory.createItemType("_LIFETIME_","lifetime",Lifetime_XFormItem,Composite_XFormItem);
Lifetime_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Lifetime_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Lifetime_XFormItem.prototype.nowrap=false;
Lifetime_XFormItem.prototype.labelWrap=true;
Lifetime_XFormItem.prototype.initializeItems=function(){
this.items=[{
type:_TEXTFIELD_,ref:".",labelLocation:_NONE_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="";
if(e!=null&&e.length>0){
if(e.length>1){
t=parseInt(e)
}else{
if(e=="0"){
t="0"
}else{
t=""
}}}
this.getParentItem()._numericPart=t;
return((!t||t=="0")?this.getModelItem().zeroValue:t)
}
,elementChanged:function(o,t,e){
if(o==this.getModelItem().zeroValue){
o=0
}
var n=null;
if(AjxUtil.isNumeric(o)){
n=o+this.getParentItem()._stringPart
}
this.getParentItem()._numericPart=o;
this.getForm().itemChanged(this.getParentItem(),n,e)
}}
,{
type:_OSELECT1_,ref:".",labelLocation:_NONE_,choices:ZaModel.getTimeChoices(),visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="d";
if(e!=null&&e.length>0){
if(e.length>1){
t=e.substr(e.length-1,1)
}else{
if(e!="0"){
t=(e=="d"||e=="h"||e=="m"||e=="s")?e:"d"
}}}
this.getParentItem()._stringPart=t;
return t
}
,elementChanged:function(n,t,e){
var o=this.getParentItem()._numericPart+n;
this.getParentItem()._stringPart=n;
this.getForm().itemChanged(this.getParentItem(),o,e)
}}
];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Lifetime_XFormItem.prototype.items=[];
Lifetime_XFormItem.prototype.getDisplayElement=function(){
return this.getElement(this.getId()+"_display")
};
Lifetime1_XFormItem=function(){};
XFormItemFactory.createItemType("_LIFETIME1_","lifetime1",Lifetime1_XFormItem,Composite_XFormItem);
Lifetime1_XFormItem.prototype.nowrap=false;
Lifetime1_XFormItem.prototype.labelWrap=true;
Lifetime1_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Lifetime1_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Lifetime1_XFormItem.prototype.initializeItems=function(){
this.items=[{
type:_TEXTFIELD_,ref:".",labelLocation:_NONE_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="";
if(e!=null&&e.length>0){
if(e.length>1){
t=e.substr(0,e.length-1)
}else{
if(e=="0"){
t="0"
}else{
t=""
}}}
this.getParentItem()._numericPart=t;
return t
}
,elementChanged:function(o,t,e){
var n=o+this.getParentItem()._stringPart;
this.getForm().itemChanged(this.getParentItem(),n,e)
}}
,{
type:_OSELECT1_,ref:".",labelLocation:_NONE_,choices:ZaModel.getTimeChoices1(),visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="d";
if(e!=null&&e.length>0){
if(e.length>1){
t=e.substr(e.length-1,1)
}else{
if(e!="0"){
t=(e=="d"||e=="h"||e=="m"||e=="s")?e:"d"
}}}
this.getParentItem()._stringPart=t;
return t
}
,elementChanged:function(n,t,e){
var o=this.getParentItem()._numericPart+n;
this.getForm().itemChanged(this.getParentItem(),o,e)
}}
];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Lifetime1_XFormItem.prototype.items=[];
Lifetime2_XFormItem=function(){};
Lifetime2_XFormItem.prototype.nowrap=false;
Lifetime2_XFormItem.prototype.labelWrap=true;
XFormItemFactory.createItemType("_LIFETIME2_","lifetime2",Lifetime2_XFormItem,Lifetime1_XFormItem);
Lifetime2_XFormItem.prototype.initializeItems=function(){
this.items=[{
type:_TEXTFIELD_,ref:".",labelLocation:_NONE_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="";
if(e!=null&&e.length>0){
if(e.length>1){
t=e.substr(0,e.length-1)
}else{
if(e=="0"){
t="0"
}else{
t=""
}}}
this.getParentItem()._numericPart=t;
this.getParentItem()._stringPart="d";
return t
}
,elementChanged:function(o,t,e){
var n=o+"d";
this.getForm().itemChanged(this.getParentItem(),n,e)
}}
,{
type:_OUTPUT_,ref:null,labelLocation:_NONE_,value:"d",getDisplayValue:function(e){
return AjxMsg.days
}}
];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Lifetime2_XFormItem.prototype.items=[];
LifetimeMinutes_XFormItem=function(){};
LifetimeMinutes_XFormItem.prototype.nowrap=false;
LifetimeMinutes_XFormItem.prototype.labelWrap=true;
XFormItemFactory.createItemType("_LIFETIME_MINUTES_","lifetime_minutes",LifetimeMinutes_XFormItem,Lifetime1_XFormItem);
LifetimeMinutes_XFormItem.prototype.initializeItems=function(){
this.items=[{
type:_TEXTFIELD_,ref:".",labelLocation:_NONE_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="";
if(e!=null&&e.length>0){
if(e.length>1){
t=e.substr(0,e.length-1)
}else{
if(e=="0"){
t="0"
}else{
t=""
}}}
this.getParentItem()._numericPart=t;
this.getParentItem()._stringPart="m";
return t
}
,elementChanged:function(o,t,e){
var n=o+"m";
this.getForm().itemChanged(this.getParentItem(),n,e)
}}
,{
type:_OUTPUT_,ref:null,labelLocation:_NONE_,value:"m",getDisplayValue:function(e){
return AjxMsg.minutes
}}
];
Composite_XFormItem.prototype.initializeItems.call(this)
};
LifetimeMinutes_XFormItem.prototype.items=[];
Long_Lifetime_XFormItem=function(){};
XFormItemFactory.createItemType("_LONG_LIFETIME_","long_lifetime",Long_Lifetime_XFormItem,Composite_XFormItem);
Long_Lifetime_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Long_Lifetime_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Long_Lifetime_XFormItem.prototype.nowrap=false;
Long_Lifetime_XFormItem.prototype.labelWrap=true;
Long_Lifetime_XFormItem.prototype.initializeItems=function(){
this.items=[{
type:_TEXTFIELD_,ref:".",labelLocation:_NONE_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="";
if(e!=null&&e.length>0){
if(e.length>1){
t=parseInt(e)
}else{
if(e=="0"){
t="0"
}else{
t=""
}}}
this.getParentItem()._numericPart=t;
return((!t||t=="0")?"0":t)
}
,elementChanged:function(o,t,e){
if(o==this.getModelItem().zeroValue){
o=0
}
var n=o+this.getParentItem()._stringPart;
this.getParentItem()._numericPart=o;
this.getForm().itemChanged(this.getParentItem(),n,e)
}}
,{
type:_OSELECT1_,ref:".",labelLocation:_NONE_,choices:ZaModel.getLongTimeChoices,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(e){
var t="d";
if(e!=null&&e.length>0){
if(e.length>1){
t=e.substr(e.length-1,1)
}else{
if(e!="0"){
t=(e=="h"||e=="d"||e=="m"||e=="y")?e:"d"
}}}
this.getParentItem()._stringPart=t;
return t
}
,elementChanged:function(n,t,e){
var o=this.getParentItem()._numericPart+n;
this.getParentItem()._stringPart=n;
this.getForm().itemChanged(this.getParentItem(),o,e)
}}
];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Long_Lifetime_XFormItem.prototype.items=[];
Long_Lifetime_XFormItem.prototype.getDisplayElement=function(){
return this.getElement(this.getId()+"_display")
};
MInterval_XModelItem=function(){};
XModelItemFactory.createItemType("_MINTERVAL_","minterval",MInterval_XModelItem,MLifetime_XModelItem);
MInterval_XModelItem.prototype.zeroValue=ZaMsg.never.toLowerCase()
}
if(AjxPackage.define("zimbraAdmin.config.settings.ZaSettings")){
ZaSettings=function(){};
ZaSettings.initialized=false;
ZaSettings.initializing=false;
ZaSettings.initMethods=new Array();
ZaSettings.RESULTSPERPAGE=50;
ZaSettings.MAXSEARCHRESULTS=100;
ZaSettings.HAVE_MORE_DOMAINS=false;
ZaSettings.postInit=function(){
var n=DwtShell.getShell(window);
var r=ZaAppCtxt.getFromShell(n);
var s=r.getAppController();
s._createApp();
if(ZaSettings.initMethods){
var o=ZaSettings.initMethods.length;
for(var t=0;
t<o;
t++){
if(typeof(ZaSettings.initMethods[t])=="function"){
try{
ZaSettings.initMethods[t].call(this)
}
catch(e){}}}}
s._lauchNewApp();
if(ZaZimbraAdmin.isWarnOnExit){
ZaZimbraAdmin.setOnbeforeunload(ZaZimbraAdmin._confirmExitMethod)
}
ZaSettings.initialized=true;
ZaSettings.initializing=false
};
ZaSettings.initRights=function(){
ZaSettings.ENABLED_UI_COMPONENTS=[];
ZaZimbraAdmin.currentAdminAccount=new ZaAccount();
try{
if(ZaZimbraAdmin.currentAdminId){
ZaZimbraAdmin.currentAdminAccount.load("id",ZaZimbraAdmin.currentAdminId,false,true)
}else{
ZaZimbraAdmin.currentAdminAccount.load("name",ZaZimbraAdmin.currentUserLogin,false,true)
}}
catch(l){}
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]=true
}
if(AjxUtil.isEmpty(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraAdminConsoleUIComponents])){
ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraAdminConsoleUIComponents]=[]
}else{
if(typeof(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraAdminConsoleUIComponents])=="string"){
ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraAdminConsoleUIComponents]=[ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraAdminConsoleUIComponents]]
}
var t=ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraAdminConsoleUIComponents].length;
for(var h=0;
h<t;
h++){
ZaSettings.ENABLED_UI_COMPONENTS[ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraAdminConsoleUIComponents][h]]=true
}}
var c=AjxSoapDoc.create("GetAllEffectiveRightsRequest",ZaZimbraAdmin.URN,null);
var n=c.set("grantee",ZaZimbraAdmin.currentUserId);
n.setAttribute("by","id");
var r=new Object();
r.soapDoc=c;
var o={};
o.controller=ZaApp.getInstance().getCurrentController();
o.busyMsg=ZaMsg.BUSY_REQUESTING_ACCESS_RIGHTS;
try{
var s=ZaRequestMgr.invoke(r,o).Body.GetAllEffectiveRightsResponse;
ZaSettings.initGlobalRightsFromJS(s)
}
catch(l){}
var e=ZaSettings.getUIComponents();
var t=e.length;
for(var h=0;
h<t;
h++){
ZaSettings.ENABLED_UI_COMPONENTS[e[h]._content]=true
}};
ZaSettings.initMethods.push(ZaSettings.initRights);
ZaSettings.initGlobalRightsFromJS=function(h){
ZaSettings.targetRights={};
var e=[];
var r=[];
if(h&&h.target&&h.target instanceof Array){
for(var n=0;
n<h.target.length;
n++){
ZaSettings.parseTargetsRightsFromJS(h.target[n]);
if(h.target[n].type==ZaItem.COS){
if(h.target[n].entries&&h.target[n].entries.length){
for(var o=0;
o<h.target[n].entries.length;
o++){
var s=h.target[n].entries[o].entry;
for(var t=0;
t<s.length;
t++){
e.push(s[t].name)
}}}}else{
if(h.target[n].type==ZaItem.DOMAIN){
if(h.target[n].entries&&h.target[n].entries.length){
for(var o=0;
o<h.target[n].entries.length;
o++){
var s=h.target[n].entries[o].entry;
for(var t=0;
t<s.length;
t++){
r.push(s[t].name)
}}}}}}}
ZaApp.getInstance()._cosNameList=e;
ZaApp.getInstance()._domainNameList=domainNamelist
};
ZaSettings.parseTargetsRightsFromJS=function(h){
if(h){
if(h.type&&AjxUtil.isEmpty(ZaSettings.targetRights[h.type])){
ZaSettings.targetRights[h.type]={}
}
if(h.all&&h.all.length&&h.all[0]&&h.all[0].right&&h.all[0].right.length){
var t=h.all[0].right;
for(var e in t){
if(!ZaSettings.targetRights[h.type][t[e].n]){
ZaSettings.targetRights[h.type][t[e].n]={
all:true,some:true}
}else{
ZaSettings.targetRights[h.type][t[e].n].all=true;
ZaSettings.targetRights[h.type][t[e].n].some=true
}}}
if(h.entries&&h.entries.length){
for(var s=0;
s<h.entries.length;
s++){
var d=h.entries[s];
if(d.rights&&d.rights.length&&d.rights[0]&&d.rights[0].right&&d.rights[0].right.length){
var t=d.rights[0].right;
for(var e in t){
if(!ZaSettings.targetRights[h.type][t[e].n]){
ZaSettings.targetRights[h.type][t[e].n]={
all:false}
}}}
if(d.entry&&d.entry.length){
for(var n=0;
n<d.entry.length;
n++){
if(d.entry[n]&&d.entry[n].name){
for(var l in ZaSettings.targetRights[h.type]){
ZaSettings.targetRights[h.type][l][d.entry[n].name]=true;
ZaSettings.targetRights[h.type][l].some=true
}}}}}}
if(h.inDomains&&h.inDomains.length){
for(var s=0;
s<h.inDomains.length;
s++){
var d=h.inDomains[s];
var c=[];
if(d.domain&&d.domain.length){
for(var n=0;
n<d.domain.length;
n++){
c.push(d.domain[n].name)
}}
if(d.rights&&d.rights.length&&d.rights[0]&&d.rights[0].right&&d.rights[0].right.length){
for(var n=0;
n<d.rights[0].right.length;
n++){
if(!ZaSettings.targetRights[h.type][d.rights[0].right[n].n]){
ZaSettings.targetRights[h.type][d.rights[0].right[n].n]={
all:false,some:true}
}
for(var o=0;
o<c.length;
o++){
ZaSettings.targetRights[h.type][d.rights[0].right[n].n][c[o]]=true;
ZaSettings.targetRights[h.type][d.rights[0].right[n].n].some=true
}}}}}}};
ZaSettings.getUIComponents=function(o){
soapDoc=AjxSoapDoc.create("GetAdminConsoleUICompRequest",ZaZimbraAdmin.URN,null);
if(o&&o.type&&o.id){
var t=soapDoc.set(o.type,o.id);
t.setAttribute("by","id")
}
csfeParams=new Object();
csfeParams.soapDoc=soapDoc;
reqMgrParams={};
reqMgrParams.controller=ZaApp.getInstance().getCurrentController();
reqMgrParams.busyMsg=ZaMsg.BUSY_REQUESTING_UI_COMP;
try{
var n=ZaRequestMgr.invoke(csfeParams,reqMgrParams).Body.GetAdminConsoleUICompResponse;
var s=[];
if(!AjxUtil.isEmpty(n.a)){
if(typeof(n.a)=="string"){
s=[n.a]
}else{
if(n.a instanceof Array){
s=n.a
}}}
return s
}
catch(e){}
return[]
};
ZaSettings.loadStyles=function(o){
var t=document.getElementsByTagName("head")[0];
for(var e=0;
e<o.length;
e++){
var n=document.createElement("link");
n.type="text/css";
n.rel="stylesheet";
n.href=o[e];
t.appendChild(n)
}};
ZaSettings.EnabledZimlet={};
ZaSettings.init=function(){
if(ZaSettings.initialized||ZaSettings.initializing){
return
}
ZaSettings.initializing=true;
try{
var p=AjxSoapDoc.create("GetAdminExtensionZimletsRequest",ZaZimbraAdmin.URN,null);
var r=new ZmCsfeCommand();
var h=new Object();
h.soapDoc=p;
h.noAuthToken=true;
var l=r.invoke(h);
var n=null;
try{
if(l&&l.Body&&l.Body.GetAdminExtensionZimletsResponse&&l.Body.GetAdminExtensionZimletsResponse.zimlets&&l.Body.GetAdminExtensionZimletsResponse.zimlets.zimlet){
n=l.Body.GetAdminExtensionZimletsResponse.zimlets.zimlet
}}
catch(f){}
if(appDevMode||(DBG.getDebugLevel()>AjxDebug.NONE)||(location.search&&(location.search.indexOf("mode=mjsf")!=-1))){
if(n&&n.length>0){
var y=new Array();
var m=new Array();
var t=n.length;
for(var o=0;
o<t;
o++){
if(n[o]&&n[o].zimlet&&n[o].zimlet[0]&&n[o].zimletContext&&n[o].zimletContext[0]){
var e=n[o].zimlet[0];
var s=n[o].zimletContext[0];
ZaSettings.EnabledZimlet[e.name]=true;
y.push([appContextPath,"/res/",e.name,".js?v=",appVers,ZaZimbraAdmin.LOCALE_QS].join(""));
if(e.include&&e.include.length>0){
var u=e.include.length;
for(var c=0;
c<u;
c++){
y.push(s.baseUrl+e.include[c]._content+"?v="+appVers)
}}
if(e.includeCSS&&e.includeCSS.length>0){
var d=e.includeCSS.length;
for(var c=0;
c<d;
c++){
m.push(s.baseUrl+e.includeCSS[c]._content+"?v="+appVers)
}}}else{
continue
}}
try{
if(m.length>0){
ZaSettings.loadStyles(m)
}
if(y.length>0){
AjxInclude(y,null,new AjxCallback(ZaSettings.postInit))
}}
catch(f){
throw f
}}else{
ZaSettings.postInit()
}}else{
if(n&&n.length>0){
var t=n.length;
for(var o=0;
o<t;
o++){
if(n[o]&&n[o].zimlet&&n[o].zimlet[0]){
var e=n[o].zimlet[0];
ZaSettings.EnabledZimlet[e.name]=true
}}}
var g=["/service/zimlet/res/Zimlets-nodev_all.js.zgz",".js?v=",appVers,ZaZimbraAdmin.LOCALE_QS].join("");
AjxInclude([g],null,new AjxCallback(ZaSettings.postInit))
}}
catch(f){
ZaSettings.initializing=false;
throw f
}};
ZaSettings.get=function(t){
var e=ZaSettings.INIT[t];
return e?e[3]:null
};
ZaSettings.T_CONFIG=1;
ZaSettings.D_STRING=1;
ZaSettings.D_INT=2;
ZaSettings.D_BOOLEAN=3;
ZaSettings.D_LDAP_TIME=4;
ZaSettings.D_HASH_TABLE=5;
ZaSettings.LOGO_URI="https://www.zimbra.com";
ZaSettings.CSFE_SERVER_URI=(location.port=="80")?"/service/admin/soap/":":"+location.port+"/service/admin/soap/";
ZaSettings.CSFE_MSG_FETCHER_URI=(location.port=="80")?"/service/content/get?":":"+location.port+"/service/content/get?";
ZaSettings.CONFIG_PATH=location.pathname+"js/zimbraAdmin/config";
ZaSettings.myDomainName=null;
ZaSettings.ZIMBRA_SUPPORT_URL="https://support.zimbra.com/help/index.php";
ZaSettings.ZIMBRA_SUPPORT_URL_QUERY=ZaSettings.ZIMBRA_SUPPORT_URL+"?query=";
ZaSettings.CARTE_BLANCHE_UI="cartBlancheUI";
ZaSettings.initConst=function(){
ZaSettings.ALL_UI_COMPONENTS=[];
ZaSettings.ACCOUNT_LIST_VIEW="accountListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.ACCOUNT_LIST_VIEW,label:ZaMsg.UI_Comp_AccountListView}
);
ZaSettings.DL_LIST_VIEW="DLListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.DL_LIST_VIEW,label:ZaMsg.UI_Comp_DlListView}
);
ZaSettings.ALIAS_LIST_VIEW="aliasListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.ALIAS_LIST_VIEW,label:ZaMsg.UI_Comp_AliasListView}
);
ZaSettings.RESOURCE_LIST_VIEW="resourceListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.RESOURCE_LIST_VIEW,label:ZaMsg.UI_Comp_ResourceListView}
);
ZaSettings.COS_LIST_VIEW="COSListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.COS_LIST_VIEW,label:ZaMsg.UI_Comp_COSListView}
);
ZaSettings.DOMAIN_LIST_VIEW="domainListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.DOMAIN_LIST_VIEW,label:ZaMsg.UI_Comp_DomainListView}
);
ZaSettings.SERVER_LIST_VIEW="serverListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.SERVER_LIST_VIEW,label:ZaMsg.UI_Comp_ServerListView}
);
ZaSettings.ZIMLET_LIST_VIEW="zimletListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.ZIMLET_LIST_VIEW,label:ZaMsg.UI_Comp_ZimletListView}
);
ZaSettings.ADMIN_ZIMLET_LIST_VIEW="adminZimletListView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.ADMIN_ZIMLET_LIST_VIEW,label:ZaMsg.UI_Comp_AdminZimletListView}
);
ZaSettings.GLOBAL_CONFIG_VIEW="globalConfigView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.GLOBAL_CONFIG_VIEW,label:ZaMsg.UI_Comp_globalConfigView}
);
ZaSettings.GLOBAL_STATUS_VIEW="globalServerStatusView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.GLOBAL_STATUS_VIEW,label:ZaMsg.UI_Comp_GlobalStatusView}
);
ZaSettings.SAVE_SEARCH="saveSearch";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.SAVE_SEARCH,label:ZaMsg.UI_Comp_SaveSearch}
);
ZaSettings.HELP_SEARCH="helpSearch";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.HELP_SEARCH,label:ZaMsg.UI_Comp_HelpSearch}
);
ZaSettings.MAILQ_VIEW="mailQueue";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.MAILQ_VIEW,label:ZaMsg.UI_Comp_mailQueueView}
);
ZaSettings.SERVER_STATS_VIEW="perServerStatisticsView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.SERVER_STATS_VIEW,label:ZaMsg.UI_Comp_ServerStatsView}
);
ZaSettings.DOWNLOADS_VIEW="downloadsView";
ZaSettings.ALL_UI_COMPONENTS.push({
value:ZaSettings.DOWNLOADS_VIEW,label:ZaMsg.UI_Comp_DownloadsView}
)
};
ZaSettings.initConst();
ZaSettings.getCalendarViewChoinces=function(){
return[{
value:"day",label:ZaMsg.CalViewDay}
,{
value:"week",label:ZaMsg.CalViewWeek}
,{
value:"workWeek",label:ZaMsg.CalViewWorkWeek}
,{
value:"month",label:ZaMsg.CalViewMonth}
,{
value:"schedule",label:ZaMsg.CalViewSchedule}
,{
value:"list",label:ZaMsg.CalViewList}
]
};
ZaSettings.calendarViewChoinces=ZaSettings.getCalendarViewChoinces;
ZaSettings.getDayOfWeekChoices=function(){
return[{
value:0,label:ZaMsg.Sunday}
,{
value:1,label:ZaMsg.Monday}
,{
value:2,label:ZaMsg.Tuesday}
,{
value:3,label:ZaMsg.Wednesday}
,{
value:4,label:ZaMsg.Thursday}
,{
value:5,label:ZaMsg.Friday}
,{
value:6,label:ZaMsg.Saturday}
]
};
ZaSettings.dayOfWeekChoices=ZaSettings.getDayOfWeekChoices;
ZaSettings.getApptVisibilityChoices=function(){
return[{
value:"public",label:ZaMsg.AptVisibilityPublic}
,{
value:"private",label:ZaMsg.AptVisibilityPrivate}
]
};
ZaSettings.apptVisibilityChoices=ZaSettings.getApptVisibilityChoices;
ZaSettings.getClientTypeChoices=function(){
return[{
value:"advanced",label:ZaMsg.clientAdvanced}
,{
value:"standard",label:ZaMsg.clientStandard}
]
};
ZaSettings.clientTypeChoices=ZaSettings.getClientTypeChoices;
ZaSettings.getAuthorizationScheme=function(){
return[{
value:"basic",label:ZaMsg.choice_basic}
,{
value:"form",label:ZaMsg.choice_form}
]
};
ZaSettings.authorizationScheme=ZaSettings.getAuthorizationScheme;
ZaSettings.getExchangeServerType=function(){
return[{
value:"webdav",label:ZaMsg.choice_webdav}
,{
value:"ews",label:ZaMsg.choice_ews}
]
};
ZaSettings.exchangeServerType=ZaSettings.getExchangeServerType;
ZaSettings.OVERVIEW_CONFIG_ITEMS=[ZaSettings.COS_LIST_VIEW,ZaSettings.ZIMLET_LIST_VIEW,ZaSettings.SERVER_LIST_VIEW,ZaSettings.ADMIN_ZIMLET_LIST_VIEW,ZaSettings.DOMAIN_LIST_VIEW,ZaSettings.GLOBAL_CONFIG_VIEW];
ZaSettings.OVERVIEW_ADDRESSES_ITEMS=[ZaSettings.ACCOUNT_LIST_VIEW,ZaSettings.ALIAS_LIST_VIEW,ZaSettings.DL_LIST_VIEW,ZaSettings.RESOURCE_LIST_VIEW];
ZaSettings.OVERVIEW_TOOLS_ITEMS=[ZaSettings.MAILQ_VIEW,ZaSettings.DOWNLOADS_VIEW];
ZaSettings.OVERVIEW_MONITORING_ITEMS=[ZaSettings.GLOBAL_STATS_VIEW,ZaSettings.GLOBAL_STATUS_VIEW,ZaSettings.SERVER_STATS_VIEW];
ZaSettings.OVERVIEW_MANAGER_ACCOUNT_ITEMS=[ZaSettings.ACCOUNT_LIST_VIEW,ZaSettings.ALIAS_LIST_VIEW,ZaSettings.DL_LIST_VIEW,ZaSettings.RESOURCE_LIST_VIEW];
ZaSettings.OVERVIEW_ADMIN_ITEMS=[ZaSettings.COS_LIST_VIEW,ZaSettings.ZIMLET_LIST_VIEW,ZaSettings.SERVER_LIST_VIEW,ZaSettings.ADMIN_ZIMLET_LIST_VIEW,ZaSettings.DOMAIN_LIST_VIEW,ZaSettings.GLOBAL_CONFIG_VIEW];
ZaSettings.OVERVIEW_TOOLS_ITEMS=[ZaSettings.MAILQ_VIEW,ZaSettings.DOWNLOADS_VIEW];
ZaSettings.OVERVIEW_MONITORING_ITEMS=[ZaSettings.MAILQ_VIEW,ZaSettings.GLOBAL_STATUS_VIEW,ZaSettings.SERVER_STATS_VIEW];
ZaSettings.DOMAIN_GAL_WIZ="domainGALWizard";
ZaSettings.DOMAIN_AUTH_WIZ="domainAuthWizard";
ZaSettings.DOMAIN_WIKI_WIZ="domainWikiWizard";
ZaSettings.DOMAIN_CHECK_MX_WIZ="domainCheckMXWiz";
ZaSettings.VIEW_RIGHTS={};
ZaSettings.VIEW_RIGHTS[ZaSettings.ACCOUNT_LIST_VIEW]="adminConsoleAccountRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.DL_LIST_VIEW]="adminConsoleDLRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.ALIAS_LIST_VIEW]="adminConsoleAliasRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.RESOURCE_LIST_VIEW]="adminConsoleResourceRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.COS_LIST_VIEW]="adminConsoleCOSRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.DOMAIN_LIST_VIEW]="adminConsoleDomainRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.SERVER_LIST_VIEW]="adminConsoleServerRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.ZIMLET_LIST_VIEW]="adminConsoleZimletRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.GLOBAL_STATUS_VIEW]="adminConsoleServerStatusRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.ADMIN_ZIMLET_LIST_VIEW]="adminConsoleExtensionRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.GLOBAL_CONFIG_VIEW]="adminConsoleGlobalRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.MAILQ_VIEW]="adminConsoleMailQueueRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.SAVE_SEARCH]="adminConsoleSavedSearchRights";
ZaSettings.VIEW_RIGHTS[ZaSettings.SERVER_STATS_VIEW]="adminConsoleServerStatisticRights";
ZaSettings.LICENSE_ENABLED=true;
ZaSettings.ADMIN_ZIMLETS_ENABLED=true;
ZaSettings.SAVE_SEARCH_ENABLED=true;
ZaSettings.TREE_ENABLED=true;
ZaSettings.CURRENT_APP_ENABLED=true;
ZaSettings.BANNER_ENABLED=true;
ZaSettings.STATUS_ENABLED=true;
ZaSettings.SEARCH_PANEL_ENABLED=true;
ZaSettings.SKIN_IDX=1;
ZaSettings.SKIN_APP_BOTTOM_TOOLBAR_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_APP_MAIN_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_APP_TOP_TOOLBAR_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_CURRENT_APP_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_LOGO_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SASH_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SEARCH_BUILDER_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SEARCH_BUILDER_TOOLBAR_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SEARCH_BUILDER_SASH_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SEARCH_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SHELL_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_STATUS_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_TREE_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_USER_INFO_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_APP_TABS_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_HELP_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_DW_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_LOGIN_MSG_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_LOGOFF_DOM_ID="skin_container_logoff";
ZaSettings.SKIN_HELP_DOM_ID="skin_container_help";
ZaSettings.SKIN_DW_DOM_ID="skin_container_dw";
ZaSettings.SKIN_USER_NAME_ID="skin_container_username";
ZaSettings.SKIN_LOGO_DOM_ID="skin_container_logo";
ZaSettings.SKIN_TREE_ID="skin_container_tree";
ZaSettings.SKIN_SEARCH_BUILDER_ID="skin_container_search_builder";
ZaSettings.SKIN_SEARCH_BUILDER_TB_ID="skin_container_search_builder_toolbar";
ZaSettings.SKIN_SEARCH_BUILDER_APP_SASH_ID="skin_container_sb_app_sash";
ZaSettings.SKIN_APP_SASH_ID="skin_container_tree_app_sash";
ZaSettings.SKIN_CURRENT_APP_ID="skin_container_current_app";
ZaSettings.SKIN_STATUS_ID="skin_container_status";
ZaSettings.SKIN_SEARCH_PANEL_ID="skin_container_search";
ZaSettings.INIT=new Object();
ZaSettings.INIT[ZaSettings.SKIN_APP_MAIN_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,"skin_container_app_main"];
ZaSettings.INIT[ZaSettings.SKIN_APP_TOP_TOOLBAR_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,"skin_container_top_toolbar"];
ZaSettings.INIT[ZaSettings.SKIN_CURRENT_APP_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_CURRENT_APP_ID];
ZaSettings.INIT[ZaSettings.SKIN_LOGO_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_LOGO_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_SASH_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_APP_SASH_ID];
ZaSettings.INIT[ZaSettings.SKIN_SEARCH_BUILDER_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_SEARCH_BUILDER_ID];
ZaSettings.INIT[ZaSettings.SKIN_SEARCH_BUILDER_TOOLBAR_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_SEARCH_BUILDER_TB_ID];
ZaSettings.INIT[ZaSettings.SKIN_SEARCH_BUILDER_SASH_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_SEARCH_BUILDER_APP_SASH_ID];
ZaSettings.INIT[ZaSettings.SKIN_SEARCH_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_SEARCH_PANEL_ID];
ZaSettings.INIT[ZaSettings.SKIN_SHELL_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,"skin_outer"];
ZaSettings.INIT[ZaSettings.SKIN_STATUS_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_STATUS_ID];
ZaSettings.INIT[ZaSettings.SKIN_TREE_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_TREE_ID];
ZaSettings.INIT[ZaSettings.SKIN_LOGIN_MSG_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,"skin_container_login_msg"];
ZaSettings.INIT[ZaSettings.SKIN_APP_TABS_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,"skin_container_app_tabs"];
ZaSettings.LICENSE_ENABLED=true;
ZaSettings.ADMIN_ZIMLETS_ENABLED=true;
ZaSettings.SAVE_SEARCH_ENABLED=true;
ZaSettings.TREE_ENABLED=true;
ZaSettings.CURRENT_APP_ENABLED=false;
ZaSettings.BANNER_ENABLED=true;
ZaSettings.STATUS_ENABLED=false;
ZaSettings.SEARCH_PANEL_ENABLED=false;
ZaSettings.SKIN_IDX=1;
ZaSettings.SKIN_SHELL_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_LOGO_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SEARCH_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_REFRESH_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_PREVIOUS_ID=ZaSettings.SKIN_IDX;
ZaSettings.SKIN_NEXT_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_USERNAME_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_HELP_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_TREE_TOP_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_TREE_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_TREE_FOOTER_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_APP_HEADER_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_APP_MAIN_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_APP_MAIN_FOOTER_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_TOOL_HEADER_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_TOOL_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_TOOL_FOOTER_ID=ZaSettings.SKIN_IDX++;
ZaSettings.SKIN_SHELL_DOM_ID="skin_outer";
ZaSettings.SKIN_LOGO_DOM_ID="skin_container_logo";
ZaSettings.SKIN_TOASTER_DOM_ID="skin_container_toaster";
ZaSettings.SKIN_SEARCH_DOM_ID="skin_container_search";
ZaSettings.SKIN_REFRESH_DOM_ID="skin_container_refresh";
ZaSettings.SKIN_PREVIOUS_DOM_ID="skin_container_previous";
ZaSettings.SKIN_NEXT_DOM_ID="skin_container_next";
ZaSettings.SKIN_USERNAME_DOM_ID="skin_container_username";
ZaSettings.SKIN_HELP_DOM_ID="skin_container_help";
ZaSettings.SKIN_TREE_TOP_DOM_ID="skin_container_tree_top";
ZaSettings.SKIN_TREE_DOM_ID="skin_container_tree";
ZaSettings.SKIN_TREE_FOOTER_DOM_ID="skin_container_tree_footer";
ZaSettings.SKIN_APP_HEADER_DOM_ID="skin_container_app_tabs";
ZaSettings.SKIN_APP_MAIN_DOM_ID="skin_container_app_main";
ZaSettings.SKIN_APP_MAIN_FOOTER_DOM_ID="skin_container_main_footer";
ZaSettings.SKIN_TOOL_HEADER_DOM_ID="skin_container_tool_header";
ZaSettings.SKIN_TOOL_DOM_ID="skin_container_tool";
ZaSettings.SKIN_TOOL_FOOTER_DOM_ID="skin_container_tool_footer";
ZaSettings.INIT[ZaSettings.SKIN_SHELL_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_SHELL_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_LOGO_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_LOGO_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_SEARCH_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_SEARCH_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_REFRESH_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_REFRESH_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_PREVIOUS_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_PREVIOUS_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_NEXT_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_NEXT_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_USERNAME_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_USERNAME_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_HELP_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_HELP_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_TREE_TOP_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_TREE_TOP_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_TREE_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_TREE_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_TREE_FOOTER_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_TREE_FOOTER_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_APP_HEADER_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_APP_HEADER_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_APP_MAIN_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_APP_MAIN_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_APP_MAIN_FOOTER_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_APP_MAIN_FOOTER_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_TOOL_HEADER_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_TOOL_HEADER_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_TOOL_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_TOOL_DOM_ID];
ZaSettings.INIT[ZaSettings.SKIN_TOOL_FOOTER_ID]=[null,ZaSettings.T_CONFIG,ZaSettings.D_STRING,ZaSettings.SKIN_TOOL_FOOTER_DOM_ID];
ZaSettings.getTimeZoneChoices=function(){
if(!ZaSettings._timeZoneChoices){
ZaSettings._timeZoneChoices=[{
label:ZaMsg.VALUE_NOT_SET,value:""}
];
var e=AjxTimezone.getZonePreferencesOptions();
var o=AjxTimezone.getZonePreferences();
for(var t=0;
t<e.length;
t++){
ZaSettings._timeZoneChoices.push({
label:o[t],value:e[t]}
)
}}
return ZaSettings._timeZoneChoices
};
ZaSettings.timeZoneChoices=ZaSettings.getTimeZoneChoices;
ZaSettings.mailCharsetChoices=[{
value:"Big5",label:"Big5"}
,{
value:"Big5-HKSCS",label:"Big5-HKSCS"}
,{
value:"EUC-JP",label:"EUC-JP"}
,{
value:"EUC-KR",label:"EUC-KR"}
,{
value:"GB18030",label:"GB18030"}
,{
value:"GB2312",label:"GB2312"}
,{
value:"GBK",label:"GBK"}
,{
value:"IBM-Thai",label:"IBM-Thai"}
,{
value:"IBM00858",label:"IBM00858"}
,{
value:"IBM01140",label:"IBM01140"}
,{
value:"IBM01141",label:"IBM01141"}
,{
value:"IBM01142",label:"IBM01142"}
,{
value:"IBM01143",label:"IBM01143"}
,{
value:"IBM01144",label:"IBM01144"}
,{
value:"IBM01145",label:"IBM01145"}
,{
value:"IBM01146",label:"IBM01146"}
,{
value:"IBM01147",label:"IBM01147"}
,{
value:"IBM01148",label:"IBM01148"}
,{
value:"IBM01149",label:"IBM01149"}
,{
value:"IBM037",label:"IBM037"}
,{
value:"IBM1026",label:"IBM1026"}
,{
value:"IBM1047",label:"IBM1047"}
,{
value:"IBM273",label:"IBM273"}
,{
value:"IBM277",label:"IBM277"}
,{
value:"IBM278",label:"IBM278"}
,{
value:"IBM280",label:"IBM280"}
,{
value:"IBM284",label:"IBM284"}
,{
value:"IBM285",label:"IBM285"}
,{
value:"IBM297",label:"IBM297"}
,{
value:"IBM420",label:"IBM420"}
,{
value:"IBM424",label:"IBM424"}
,{
value:"IBM437",label:"IBM437"}
,{
value:"IBM500",label:"IBM500"}
,{
value:"IBM775",label:"IBM775"}
,{
value:"IBM850",label:"IBM850"}
,{
value:"IBM852",label:"IBM852"}
,{
value:"IBM855",label:"IBM855"}
,{
value:"IBM857",label:"IBM857"}
,{
value:"IBM860",label:"IBM860"}
,{
value:"IBM861",label:"IBM861"}
,{
value:"IBM862",label:"IBM862"}
,{
value:"IBM863",label:"IBM863"}
,{
value:"IBM864",label:"IBM864"}
,{
value:"IBM865",label:"IBM865"}
,{
value:"IBM866",label:"IBM866"}
,{
value:"IBM868",label:"IBM868"}
,{
value:"IBM869",label:"IBM869"}
,{
value:"IBM870",label:"IBM870"}
,{
value:"IBM871",label:"IBM871"}
,{
value:"IBM918",label:"IBM918"}
,{
value:"imap-utf-7",label:"imap-utf-7"}
,{
value:"ISO-2022-CN",label:"ISO-2022-CN"}
,{
value:"ISO-2022-JP",label:"ISO-2022-JP"}
,{
value:"ISO-2022-KR",label:"ISO-2022-KR"}
,{
value:"ISO-8859-1",label:"ISO-8859-1"}
,{
value:"ISO-8859-13",label:"ISO-8859-13"}
,{
value:"ISO-8859-15",label:"ISO-8859-15"}
,{
value:"ISO-8859-2",label:"ISO-8859-2"}
,{
value:"ISO-8859-3",label:"ISO-8859-3"}
,{
value:"ISO-8859-4",label:"ISO-8859-4"}
,{
value:"ISO-8859-5",label:"ISO-8859-5"}
,{
value:"ISO-8859-6",label:"ISO-8859-6"}
,{
value:"ISO-8859-7",label:"ISO-8859-7"}
,{
value:"ISO-8859-8",label:"ISO-8859-8"}
,{
value:"ISO-8859-9",label:"ISO-8859-9"}
,{
value:"JIS_X0201",label:"JIS_X0201"}
,{
value:"JIS_X0212-1990",label:"JIS_X0212-1990"}
,{
value:"KOI8-R",label:"KOI8-R"}
,{
value:"macintosh",label:"macintosh"}
,{
value:"macintosh_ce",label:"macintosh_ce"}
,{
value:"Shift_JIS",label:"Shift_JIS"}
,{
value:"TIS-620",label:"TIS-620"}
,{
value:"US-ASCII",label:"US-ASCII"}
,{
value:"UTF-16",label:"UTF-16"}
,{
value:"UTF-16BE",label:"UTF-16BE"}
,{
value:"UTF-16LE",label:"UTF-16LE"}
,{
value:"utf-7",label:"utf-7"}
,{
value:"UTF-8",label:"UTF-8"}
,{
value:"windows-1250",label:"windows-1250"}
,{
value:"windows-1251",label:"windows-1251"}
,{
value:"windows-1252",label:"windows-1252"}
,{
value:"windows-1253",label:"windows-1253"}
,{
value:"windows-1254",label:"windows-1254"}
,{
value:"windows-1255",label:"windows-1255"}
,{
value:"windows-1256",label:"windows-1256"}
,{
value:"windows-1257",label:"windows-1257"}
,{
value:"windows-1258",label:"windows-1258"}
,{
value:"windows-31j",label:"windows-31j"}
];
ZaSettings.getLocaleChoices=function(){
if(!ZaSettings.localeChoices){
var s=AjxSoapDoc.create("GetAvailableLocalesRequest","urn:zimbraAccount",null);
var l={};
l.soapDoc=s;
var n={
controller:(ZaApp.getInstance()?ZaApp.getInstance().getCurrentController():null),busyMsg:ZaMsg.BUSY_GET_LOCALE};
var h=ZaRequestMgr.invoke(l,n).Body.GetAvailableLocalesResponse;
var t=h.locale;
ZaSettings.localeChoices=[];
for(var o=0;
o<t.length;
o++){
var e=t[o].localName;
if(t[o].name!=t[o].localName){
e+=" - "+t[o].name
}
var r=t[o].id.replace(/^in/,"id");
ZaSettings.localeChoices.push({
value:r,label:e}
)
}}
return ZaSettings.localeChoices
};
ZaSettings.isNetworkVersion=function(){
return(ZaSettings.IS_ZCS_NETWORK_VERSION||false)
};
ZaSettings.isOctopus=function(){
return(ZaSettings.IS_OCTOPUS||false)
};
ZaSettings.getSmtpDnsSupportLevel=function(){
return[{
value:"enabled",label:ZaMsg.NAD_MTA_SMTP_Dns_Enabled}
,{
value:"disabled",label:ZaMsg.NAD_MTA_SMTP_Dns_Disabled}
,{
value:"dnssec",label:ZaMsg.NAD_MTA_SMTP_Dns_Dnssec}
]
};
ZaSettings.smtpDnsSupportLevel=ZaSettings.getSmtpDnsSupportLevel
}
if(AjxPackage.define("zimbraAdmin.common.ZaAppCtxt")){
ZaAppCtxt=function(){};
ZaAppCtxt.LABEL="appCtxt";
ZaAppCtxt.prototype.toString=function(){
return"ZaAppCtxt"
};
ZaAppCtxt.getFromShell=function(e){
return e.getData(ZaAppCtxt.LABEL)
};
ZaAppCtxt.prototype.setAppController=function(e){
this._appController=e
};
ZaAppCtxt.prototype.getAppController=function(){
return this._appController
};
ZaAppCtxt.prototype.getApp=function(){
return this._appController.getApp()
};
ZaAppCtxt.prototype.getAppViewMgr=function(){
return this._appController.getAppViewMgr()
};
ZaAppCtxt.prototype.setClientCmdHdlr=function(e){
this._clientCmdHdlr=e
};
ZaAppCtxt.prototype.getClientCmdHdlr=function(){
return this._clientCmdHdlr
};
ZaAppCtxt.prototype.getSearchController=function(){
return this._appController.getSearchController()
};
ZaAppCtxt.prototype.getLoginDialog=function(){
if(!this._loginDialog){
this._loginDialog=new ZaLoginDialog(this.getShell(),null,null,this)
}
return this._loginDialog
};
ZaAppCtxt.prototype.getMsgDialog=function(e){
if(!this._msgDialog||e){
this._msgDialog=new ZaMsgDialog(this.getShell())
}
return this._msgDialog
};
ZaAppCtxt.prototype.getConfirmMsgDialog=function(e){
if(!this._confirmMsgDialog||e){
this._confirmMsgDialog=new ZaMsgDialog(this.getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.CANCEL_BUTTON],null,ZaId.CTR_GLOBAL+"_confirm3btn")
}
return this._confirmMsgDialog
};
ZaAppCtxt.prototype.getConfirmMsgDialog2=function(e){
if(!this._confirmMessageDialog2||e){
this._confirmMessageDialog2=new ZaMsgDialog(this.getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_GLOBAL+"_confirm2btn")
}
return this._confirmMessageDialog2
};
ZaAppCtxt.prototype.getErrorDialog=function(e){
if(!this._errorDialog||e){
this._errorDialog=new ZaErrorDialog(this.getShell())
}
return this._errorDialog
};
ZaAppCtxt.prototype.getShell=function(){
return this._shell
};
ZaAppCtxt.prototype.setShell=function(e){
this._shell=e;
e.setData(ZaAppCtxt.LABEL,this)
};
ZaAppCtxt.prototype.getFolderTree=function(){
return this._folderTree
};
ZaAppCtxt.prototype.setFolderTree=function(e){
this._folderTree=e
};
ZaAppCtxt.prototype.getUsername=function(){
return this._username
};
ZaAppCtxt.prototype.setUsername=function(e){
this._username=e
};
ZaAppCtxt.prototype.getCurrentSearch=function(){
return this._currentSearch
};
ZaAppCtxt.prototype.setCurrentSearch=function(e){
this._currentSearch=e
};
ZaAppCtxt.prototype.getSettings=function(){
if(!this._settings){
this._settings=new ZaSettings(this)
}
return this._settings
};
ZaAppCtxt.prototype.setSettings=function(e){
this._settings=e
};
ZaAppCtxt.prototype.getRootTabGroup=function(){
if(!this._rootTabGrp){
this._rootTabGrp=new DwtTabGroup("ROOT")
}
return this._rootTabGrp
};
ZaAppCtxt.getLogoURI=function(){
if(skin&&skin.hints&&skin.hints.banner){
return skin.hints.banner.url
}else{
return ZaSettings.LOGO_URI
}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaAuthenticate")){
ZaAuthenticate=function(e){
if(arguments.length==0){
return
}
this._appCtxt=e;
this.uname=""
};
ZaAuthenticate.processResponseMethods=new Array();
ZaAuthenticate.prototype.toString=function(){
return"ZaAuthenticate"
};
ZaAuthenticate.prototype.changePassword=function(e,s,t,l){
var n=AjxSoapDoc.create("ChangePasswordRequest","urn:zimbraAccount");
var o=n.set("account",e);
o.setAttribute("by","name");
n.set("oldPassword",s);
n.set("password",t);
var h=new ZmCsfeCommand();
var r=new Object();
r.soapDoc=n;
r.asyncMode=true;
r.noAuthToken=true;
r.callback=l;
h.invoke(r)
};
ZaAuthenticate.prototype.execute=function(e,s,r){
var t=AjxSoapDoc.create("AuthRequest",ZaZimbraAdmin.URN,null);
this.uname=e;
var n=new Object();
n.noAuthToken=true;
n.ignoreAuthToken=true;
if(e&&s){
t.set("name",e);
t.set("password",s)
}else{
t.getMethod().setAttribute("refresh","1")
}
t.set("virtualHost",location.hostname);
t.set("csrfTokenSecured",1);
var o=new ZmCsfeCommand();
n.soapDoc=t;
n.asyncMode=true;
n.skipExpiredToken=true;
n.callback=r;
o.invoke(n)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaPopupMenu")){
ZaPopupMenu=function(l,s,r,t,n,h,c){
if(arguments.length==0){
return
}
s=s||"ActionMenu";
this._contextId=n;
this._menuType=h;
DwtMenu.call(this,l,DwtMenu.POPUP_STYLE,s,null,r,ZaId.getMenuId(this._contextId,this._menuType));
this._menuItems=new Object();
if(t){
var o=0;
for(o=0;
c&&o<c.length;
o++){
if(t[c[o]] instanceof ZaOperation){
if(t[c[o]].id==ZaOperation.NONE||t[c[o]].id==ZaOperation.HELP){
continue
}
var e=(t[c[o]].id==ZaOperation.SEP)?DwtMenuItem.SEPARATOR_STYLE:DwtMenuItem.NO_STYLE;
this.createMenuItem(t[c[o]].id,t[c[o]].imageId,t[c[o]].caption,null,t[c[o]].enabled,e,null);
this.addSelectionListener(t[c[o]].id,t[c[o]].listener)
}}
for(o in t){
if(!c||AjxUtil.indexOf(c,o)<0){
if(t[o] instanceof ZaOperation){
if(t[o].id==ZaOperation.NONE||t[o].id==ZaOperation.HELP){
continue
}
var e=(t[o].id==ZaOperation.SEP)?DwtMenuItem.SEPARATOR_STYLE:DwtMenuItem.NO_STYLE;
this.createMenuItem(t[o].id,t[o].imageId,t[o].caption,null,t[o].enabled,e,null);
this.addSelectionListener(t[o].id,t[o].listener)
}}}}};
ZaPopupMenu.prototype=new DwtMenu;
ZaPopupMenu.prototype.constructor=ZaPopupMenu;
ZaPopupMenu.prototype.toString=function(){
return"ZaPopupMenu"
};
ZaPopupMenu.prototype.addSelectionListener=function(t,e){
this._menuItems[t].addSelectionListener(e)
};
ZaPopupMenu.prototype.removeSelectionListener=function(t,e){
this._menuItems[t].removeSelectionListener(e)
};
ZaPopupMenu.prototype.popup=function(t,e,n,o){
if(t==null){
t=0
}
if(e==null){
e=Dwt.DEFAULT
}
if(n==null){
n=Dwt.DEFAULT
}
DwtMenu.prototype.popup.call(this,t,e,n,o)
};
ZaPopupMenu.prototype.getMenuItem=function(e){
return this._menuItems[e]
};
ZaPopupMenu.prototype.enable=function(o,e){
if(!(o instanceof Array)){
o=[o]
}
for(var t=0;
t<o.length;
t++){
if(this._menuItems[o[t]]){
this._menuItems[o[t]].setEnabled(e)
}}};
ZaPopupMenu.prototype.enableAll=function(e){
for(var t in this._menuItems){
this._menuItems[t].setEnabled(e)
}};
ZaPopupMenu.prototype.addMenuItem=function(t,e){
this._menuItems[t]=e
};
ZaPopupMenu.prototype.createMenuItem=function(h,s,l,t,n,r,o){
var e=this._menuItems[h]=new DwtMenuItem({
parent:this,style:r,radioGroupId:o,id:ZaId.getMenuItemId(this._contextId,ZaOperation.getStringName(h))}
);
if(s){
e.setImage(s)
}
if(l){
e.setText(l)
}
e.setEnabled(n!==false);
return e
};
ZaPopupMenu.prototype.createSeparator=function(){
new DwtMenuItem(this,DwtMenuItem.SEPARATOR_STYLE)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaAppViewMgr")){
ZaAppViewMgr=function(o,e,t){
this._shell=o;
this._controller=e;
this._appCtxt=e._appCtxt;
this._shellSz=this._shell.getSize();
this._shell.addControlListener(new AjxListener(this,this._shellControlListener));
this._needBannerLayout=false;
this._sashSupported=(window.skin&&typeof window.skin.setTreeWidth=="function");
this._sbSashSupported=(window.skin&&typeof window.skin.setSBHeight=="function");
this._currentView=null;
this._views=new Object();
this._hidden=new Array();
this._layoutStyle=new Object();
this._staleCallback=new Object();
this._compList=new Array();
this._components=new Object();
this._htmlEl=new Object();
this._containers=new Object();
this._contBounds=new Object();
this._pushCallback=new AjxCallback(this,this.pushView)
};
ZaAppViewMgr.DEFAULT=-1;
ZaAppViewMgr.RESIZE=1;
ZaAppViewMgr.BROWSE=2;
ZaAppViewMgr.OVERVIEW=3;
ZaAppViewMgr.TOOLBAR_SEPARATION=0;
ZaAppViewMgr.COMPONENT_SEPARATION=2;
ZaAppViewMgr.LAYOUT_VERTICAL=1;
ZaAppViewMgr.PENDING_VIEW="ZaAppViewMgr.PENDgING_VIEW";
ZaAppViewMgr.C_BANNER="BANNER";
ZaAppViewMgr.C_SEARCH="SEARCH";
ZaAppViewMgr.C_SEARCH_BUILDER="SEARCH BUILDER";
ZaAppViewMgr.C_SEARCH_BUILDER_TOOLBAR="SEARCH BUILDER TOOLBAR";
ZaAppViewMgr.C_SEARCH_BUILDER_SASH="SEARCH BUILDER SASH";
ZaAppViewMgr.C_CURRENT_APP="CURRENT APP";
ZaAppViewMgr.C_APP_TABS="APP TABS";
ZaAppViewMgr.C_TREE="TREE";
ZaAppViewMgr.C_TOOLBAR_TOP="TOP TOOLBAR";
ZaAppViewMgr.C_APP_CONTENT="APP CONTENT";
ZaAppViewMgr.C_STATUS="STATUS";
ZaAppViewMgr.C_SASH="SASH";
ZaAppViewMgr.C_LOGIN_MESSAGE="LOGIN_MESSAGE";
ZaAppViewMgr.CONT_ID_KEY=new Object();
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_BANNER]=ZaSettings.SKIN_LOGO_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_SEARCH]=ZaSettings.SKIN_SEARCH_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_SEARCH_BUILDER]=ZaSettings.SKIN_SEARCH_BUILDER_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_SEARCH_BUILDER_TOOLBAR]=ZaSettings.SKIN_SEARCH_BUILDER_TOOLBAR_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_SEARCH_BUILDER_SASH]=ZaSettings.SKIN_SEARCH_BUILDER_SASH_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_CURRENT_APP]=ZaSettings.SKIN_CURRENT_APP_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TREE]=ZaSettings.SKIN_TREE_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TOOLBAR_TOP]=ZaSettings.SKIN_APP_TOP_TOOLBAR_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_APP_CONTENT]=ZaSettings.SKIN_APP_MAIN_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_STATUS]=ZaSettings.SKIN_STATUS_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_SASH]=ZaSettings.SKIN_SASH_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_APP_TABS]=ZaSettings.SKIN_APP_TABS_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_LOGIN_MESSAGE]=ZaSettings.SKIN_LOGIN_MSG_ID;
ZaAppViewMgr.C_BANNER="BANNER";
ZaAppViewMgr.C_SEARCH="SEARCH";
ZaAppViewMgr.C_TREE_TOP="TREE TOP";
ZaAppViewMgr.C_TREE="TREE";
ZaAppViewMgr.C_TREE_FOOTER="TREE FOOTER";
ZaAppViewMgr.C_APP_HEADER="APP HEADER";
ZaAppViewMgr.C_APP_CONTENT="APP CONTENT";
ZaAppViewMgr.C_APP_FOOTER="APP FOOTER";
ZaAppViewMgr.C_TOOL_HEADER="TOOL HEADER";
ZaAppViewMgr.C_TOOL="TOOL";
ZaAppViewMgr.C_TOOL_FOOTER="TOOL FOOTER";
ZaAppViewMgr.CONT_ID_KEY=new Object();
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_BANNER]=ZaSettings.SKIN_LOGO_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_SEARCH]=ZaSettings.SKIN_SEARCH_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TREE_TOP]=ZaSettings.SKIN_TREE_TOP_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TREE]=ZaSettings.SKIN_TREE_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TREE_FOOTER]=ZaSettings.SKIN_TREE_FOOTER_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_APP_HEADER]=ZaSettings.SKIN_APP_HEADER_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_APP_CONTENT]=ZaSettings.SKIN_APP_MAIN_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_APP_FOOTER]=ZaSettings.SKIN_APP_MAIN_FOOTER_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TOOL_HEADER]=ZaSettings.SKIN_TOOL_HEADER_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TOOL]=ZaSettings.SKIN_TOOL_ID;
ZaAppViewMgr.CONT_ID_KEY[ZaAppViewMgr.C_TOOL_FOOTER]=ZaSettings.SKIN_TOOL_FOOTER_ID;
ZaAppViewMgr.prototype.toString=function(){
return"ZaAppViewMgr"
};
ZaAppViewMgr.prototype.getShell=function(){
return this._shell
};
ZaAppViewMgr.prototype.getCurrentView=function(){
return this._currentView
};
ZaAppViewMgr.prototype.getCurrentViewContent=function(){
var t=this._views[this._currentView];
var e=t[ZaAppViewMgr.C_APP_CONTENT];
return e
};
ZaAppViewMgr.prototype.getViewContentById=function(o){
var t=this._views[o];
if(!t){
return""
}
var e=t[ZaAppViewMgr.C_APP_CONTENT];
return e
};
ZaAppViewMgr.prototype.createView=function(e,t){
this._views[e]=t;
this.addComponents(t,false,true)
};
ZaAppViewMgr.prototype.pushView=function(e){
if(e==this._currentView){
this._setTitle(e);
return e
}
this._setViewVisible(this._currentView,false);
if(this._currentView&&(this._currentView!=e)){
this._hidden.push(this._currentView)
}
this._removeFromHidden(e);
var t=this._lastView;
this._lastView=this._currentView;
this._currentView=e;
this._setViewVisible(e,true);
return e
};
ZaAppViewMgr.prototype.popView=function(){
if(!this._currentView){
throw new AjxException("no view to pop")
}
this._setViewVisible(this._currentView,false);
this._lastView=this._currentView;
this._currentView=this._hidden.pop();
if(!this._currentView){
throw new AjxException("no view to show")
}
this._removeFromHidden(this._currentView);
this._setViewVisible(this._currentView,true);
return this._currentView
};
ZaAppViewMgr.prototype.removeHiddenView=function(e){
var o=this._hidden.length;
for(var t=0;
t<o;
t++){
if(this._hidden[t]==e){
this._hidden.splice(t,1)
}}};
ZaAppViewMgr.prototype.setView=function(t){
var e=this.pushView(t);
if(e){
this._hidden=new Array()
}
return e
};
ZaAppViewMgr.prototype.addComponents=function(n,c,e){
var h=new Array();
for(var l in n){
this._compList.push(l);
var s=n[l];
this._components[l]=s;
var t=s.getHtmlElement();
this._htmlEl[l]=t;
var o=ZaSettings.get(ZaAppViewMgr.CONT_ID_KEY[l]);
var r=document.getElementById(o);
if(!r){
continue
}
this._containers[l]=r;
if(Dwt.contains(r,t)){
throw new AjxException("element already added to container: "+l)
}
Dwt.removeChildren(r);
h.push(l);
if(!e){
s.zShow(true)
}
if(l==ZaAppViewMgr.C_SEARCH_BUILDER||l==ZaAppViewMgr.C_SEARCH_BUILDER_TOOLBAR){
DBG.println(AjxDebug.DBG1,"Enforce Z-index to hidden "+l);
s.zShow(false)
}
if(l==ZaAppViewMgr.C_SEARCH_BUILDER_SASH){
s.zShow(false);
if(this._sbSashSupported){
s.registerCallback(this._sbAppSashCallback,this)
}
s.setCursor("default")
}
if(l==ZaAppViewMgr.C_SASH){
if(this._sashSupported){
s.registerCallback(this._appTreeSashCallback,this)
}
s.setCursor("default")
}}
if(c){
this._stickToGrid(h)
}};
ZaAppViewMgr.prototype.showSearchBuilder=function(e){
skin.showSearchBuilder(e);
this._components[ZaAppViewMgr.C_SEARCH_BUILDER_TOOLBAR].zShow(e);
this._components[ZaAppViewMgr.C_SEARCH_BUILDER].zShow(e);
this._components[ZaAppViewMgr.C_SEARCH_BUILDER_SASH].zShow(e);
if(e){
this._isAdvancedSearchBuilderDisplayed=true
}
this.fitAll();
if(!e){
this._components[ZaAppViewMgr.C_SEARCH_BUILDER].setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}};
ZaAppViewMgr.prototype.fitAll=function(){
var e=[ZaAppViewMgr.C_SEARCH_BUILDER,ZaAppViewMgr.C_SEARCH_BUILDER_TOOLBAR,ZaAppViewMgr.C_SEARCH_BUILDER_SASH,ZaAppViewMgr.C_LOGIN_MESSAGE,ZaAppViewMgr.C_CURRENT_APP,ZaAppViewMgr.C_APP_TABS,ZaAppViewMgr.C_BANNER,ZaAppViewMgr.C_TREE,ZaAppViewMgr.C_SASH,ZaAppViewMgr.C_TOOLBAR_TOP,ZaAppViewMgr.C_APP_CONTENT];
e=[ZaAppViewMgr.C_BANNER,ZaAppViewMgr.C_SEARCH,ZaAppViewMgr.C_TREE_TOP,ZaAppViewMgr.C_TREE,ZaAppViewMgr.C_TREE_FOOTER,ZaAppViewMgr.C_APP_HEADER,ZaAppViewMgr.C_APP_CONTENT,ZaAppViewMgr.C_APP_FOOTER,ZaAppViewMgr.C_TOOL_HEADER,ZaAppViewMgr.C_TOOL,ZaAppViewMgr.C_TOOL_FOOTER];
this._stickToGrid(e)
};
ZaAppViewMgr.prototype._stickToGrid=function(r){
this._shell.relayout();
for(var n=0;
n<r.length;
n++){
var l=r[n];
var e=this._containers[l];
if(e){
var s=ZaAppViewMgr._getBounds(e,l);
var t=this._components[l];
if(l==ZaAppViewMgr.C_APP_CONTENT||l==ZaAppViewMgr.C_TOOLBAR_TOP){
var h=this._views[this._currentView];
t=h[l]
}
if(t&&(t.getZIndex()!=Dwt.Z_HIDDEN)){
try{
t.setBounds(s.x,s.y,s.width,s.height)
}
catch(o){
ZaApp.getInstance().getCurrentController()._handleException(o,"ZaAppViewMgr.prototype._stickToGrid",nul,false)
}
this._contBounds[l]=s;
if(t._resizeListener){
t._resizeListener()
}}}}};
ZaAppViewMgr._getBounds=function(e,o){
var t=Dwt.getBounds(e);
if(o==ZaAppViewMgr.C_TREE||o==ZaAppViewMgr.C_APP_CONTENT||o==ZaAppViewMgr.C_TOOL){
t.x=t.x+1;
t.width=t.width>2?(t.width-2):t.width
}
return t
};
ZaAppViewMgr.prototype._removeFromHidden=function(e){
var o=new Array();
for(var t=0;
t<this._hidden.length;
t++){
if(this._hidden[t]!=e){
o.push(this._hidden[t])
}}
this._hidden=o
};
ZaAppViewMgr.prototype._shellControlListener=function(n){
if(n.oldWidth!=n.newWidth||n.oldHeight!=n.newHeight){
this._shellSz.x=n.newWidth;
this._shellSz.y=n.newHeight;
var o=n.newWidth-n.oldWidth;
var h=n.newHeight-n.oldHeight;
if(this._isNewWindow){
var t=this._views[this._currentView][ZaAppViewMgr.C_APP_TABS];
if(t){
t.setSize(n.newWidth,Dwt.DEFAULT)
}
var e=this._views[this._currentView][ZaAppViewMgr.C_TOOLBAR_TOP];
if(e){
e.setSize(n.newWidth,Dwt.DEFAULT)
}
var r=this._views[this._currentView][ZaAppViewMgr.C_APP_CONTENT];
if(r){
r.setSize(n.newWidth,n.newHeight-e.getH())
}}else{
if(h){
var s=[ZaAppViewMgr.C_APP_CHOOSER,ZaAppViewMgr.C_SASH,ZaAppViewMgr.C_APP_CONTENT,ZaAppViewMgr.C_TREE];
s=[ZaAppViewMgr.C_TREE_TOP,ZaAppViewMgr.C_TREE,ZaAppViewMgr.C_TREE_FOOTER,ZaAppViewMgr.C_APP_HEADER,ZaAppViewMgr.C_APP_CONTENT,ZaAppViewMgr.C_APP_FOOTER,ZaAppViewMgr.C_TOOL_HEADER,ZaAppViewMgr.C_TOOL,ZaAppViewMgr.C_TOOL_FOOTER];
this._stickToGrid(s)
}
if(o){
var s=[ZaAppViewMgr.C_BANNER,ZaAppViewMgr.C_APP_TABS,ZaAppViewMgr.C_LOGIN_MESSAGE,ZaAppViewMgr.C_TOOLBAR_TOP,ZaAppViewMgr.C_APP_CONTENT,ZaAppViewMgr.C_SEARCH,ZaAppViewMgr.C_SEARCH_BUILDER,ZaAppViewMgr.C_SEARCH_BUILDER_TOOLBAR,ZaAppViewMgr.C_SEARCH_BUILDER_SASH];
s=[ZaAppViewMgr.C_BANNER,ZaAppViewMgr.C_SEARCH,ZaAppViewMgr.C_APP_HEADER,ZaAppViewMgr.C_APP_CONTENT,ZaAppViewMgr.C_APP_FOOTER,ZaAppViewMgr.C_TOOL_HEADER,ZaAppViewMgr.C_TOOL,ZaAppViewMgr.C_TOOL_FOOTER];
this._stickToGrid(s)
}}}};
ZaAppViewMgr.prototype._setViewVisible=function(e,t){
var n=this._views[e];
if(t){
var o=new Array();
for(var s in n){
o.push(s);
n[s].zShow(true)
}
this._stickToGrid(o);
this._setCurrentBar(e)
}else{
for(var s in n){
n[s].setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
n[s].zShow(false)
}}};
ZaAppViewMgr.prototype._setTitle=function(e){
var o=this._views[e];
var t=o[ZaAppViewMgr.C_APP_CONTENT];
var n="";
if(t&&t.getTitle){
n=t.getTitle();
if(this._components[ZaAppViewMgr.C_CURRENT_APP]&&this._components[ZaAppViewMgr.C_CURRENT_APP].setCurrentAppLabel){
this._components[ZaAppViewMgr.C_CURRENT_APP].setCurrentAppLabel(n)
}
Dwt.setTitle(n?ZabMsg.zimbraTitle+": "+n:ZabMsg.zimbraTitle)
}};
ZaAppViewMgr.prototype._setCurrentBar=function(e){
var t=this.getViewContentById(e);
var r=ZaApp.getInstance().getControllerById(e);
var s="";
var o="";
if(r&&r.getPopUpOperation){
s=r.getPopUpOperation()
}
if(t&&t.getBarImage){
o=t.getBarImage()
}
if(this._components[ZaAppViewMgr.C_APP_HEADER]){
if(this._components[ZaAppViewMgr.C_APP_HEADER].updateMenu){
this._components[ZaAppViewMgr.C_APP_HEADER].updateMenu(s,r._popupOrder)
}
if(this._components[ZaAppViewMgr.C_APP_HEADER].setTypeImg&&o){
this._components[ZaAppViewMgr.C_APP_HEADER].setTypeImg(o)
}
var n=[];
if(r&&r.getAppBarAction){
n=r.getAppBarAction()
}
var h=[];
if(r&&r.getAppBarOrder){
h=r.getAppBarOrder()
}
if(this._components[ZaAppViewMgr.C_APP_HEADER].setActionButton){
this._components[ZaAppViewMgr.C_APP_HEADER].setActionButton(n,h)
}}};
ZaAppViewMgr.prototype._appTreeSashCallback=function(n){
if(!window.skin){
return
}
var e=skin.getTreeWidth();
if(!e){
return 0
}
if(!this.treeMinSize){
this.treeMinSize=window.skin.hints.tree.minWidth||150;
this.treeMaxSize=window.skin.hints.tree.maxWidth||300
}
if(e+n>this.treeMaxSize){
n=Math.max(0,this.treeMaxSize-e)
}
if(e+n<this.treeMinSize){
n=Math.min(0,this.treeMinSize-e)
}
var t=e+n;
skin.setTreeWidth(t);
var o=this;
setTimeout(function(){
o.fitAll(true)
}
,0);
return n
};
ZaAppViewMgr.prototype._sbAppSashCallback=function(n){
if(!window.skin){
return
}
var o=skin.getSBHeight();
if(!o){
return 0
}
if(!this.sbMinSize){
this.sbMinSize=window.skin.hints.searchBuilder.minHeight||50;
this.sbMoveSize=o
}
if(o+n>this.sbMoveSize){
return 0
}
if(o+n<this.sbMinSize){
n=Math.min(0,this.sbMinSize-o)
}
var e=o+n;
skin.setSBHeight(e);
var t=this;
setTimeout(function(){
t.fitAll(true)
}
,0);
return n
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaLoginDialog")){
ZaLoginDialog=function(o,h,t,s){
t=t||"LoginScreen";
DwtComposite.call(this,{
parent:o,className:t,posStyle:DwtControl.ABSOLUTE_STYLE}
);
this._zimbraAdminLoginURL=ZaZimbraAdmin.zimbraAdminLoginURL;
this._origClassName=t;
this._xparentClassName=t+"-Transparent";
this.setBounds(0,0,"100%","100%");
var n=this.getHtmlElement();
n.style.zIndex=Dwt.Z_DIALOG+1;
n.className=t;
this.setVisible(false);
var r=ZLoginFactory.copyDefaultParams(ZaMsg);
r.showPanelBorder=true;
r.showForm=true;
r.showUserField=true;
r.showPasswordField=true;
r.showRememberMeCheckbox=false;
r.showLogOff=true;
r.logOffAction="ZaLoginDialog._loginDiffListener()";
r.loginAction="ZaLoginDialog._loginListener(this)";
r.showButton=true;
r.companyURL=ZaAppCtxt.getLogoURI();
r.copyrightText=ZaItem.getSplashScreenCopyright();
r.clientLevelNotice=ZabMsg.clientLevelNotice?ZabMsg.clientLevelNotice:"";
var e=ZLoginFactory.getLoginDialogHTML(r);
this.setContent(e)
};
ZaLoginDialog.prototype=new DwtComposite;
ZaLoginDialog.prototype.constructor=ZaLoginDialog;
ZaLoginDialog.prototype.toString=function(){
return"ZaLoginDialog"
};
ZaLoginDialog.prototype.getLoginURL=function(){
var o=AjxSoapDoc.create("GetDomainInfoRequest",ZaZimbraAdmin.URN,null);
var e=o.set("domain",location.hostname);
e.setAttribute("by","virtualHostname");
var r=new Object();
r.soapDoc=o;
r.noAuthToken=true;
var t={};
var s=ZaRequestMgr.invoke(r,t).Body.GetDomainInfoResponse;
var n={};
ZaItem.prototype.initFromJS.call(n,s.domain[0]);
return n.attrs.zimbraAdminConsoleLoginURL
};
ZaLoginDialog.prototype.registerCallback=function(e,t){
this._callback=new AjxCallback(t,e)
};
ZaLoginDialog.prototype.clearPassword=function(){
ZLoginFactory.get(ZLoginFactory.PASSWORD_ID).value=""
};
ZaLoginDialog.prototype.showNewPasswordFields=function(){
ZLoginFactory.showNewPasswordFields()
};
ZaLoginDialog.prototype.hideNewPasswordFields=function(){
ZLoginFactory.hideNewPasswordFields()
};
ZaLoginDialog.prototype.enableUnameField=function(){
ZLoginFactory.get(ZLoginFactory.USER_ID).disabled=false
};
ZaLoginDialog.prototype.disableUnameField=function(){
ZLoginFactory.get(ZLoginFactory.USER_ID).disabled=true
};
ZaLoginDialog.prototype.enablePasswordField=function(){
ZLoginFactory.get(ZLoginFactory.PASSWORD_ID).disabled=false
};
ZaLoginDialog.prototype.disablePasswordField=function(){
ZLoginFactory.get(ZLoginFactory.PASSWORD_ID).disabled=true
};
ZaLoginDialog.prototype.setError=function(e){
if(e){
ZLoginFactory.showErrorMsg(e)
}};
ZaLoginDialog.prototype.clearError=function(){
ZLoginFactory.hideErrorMsg()
};
ZaLoginDialog.prototype.setFocus=function(e){
ZLoginFactory.showUserField(e)
};
ZaLoginDialog.prototype.setVisible=function(h,s){
DwtComposite.prototype.setVisible.call(this,h);
if(h&&this._zimbraAdminLoginURL!=null&&this._zimbraAdminLoginURL.length>0){
if(window.onbeforeunload!=null){
ZaZimbraAdmin.setOnbeforeunload(ZaZimbraAdmin._confirmAuthInvalidExitMethod)
}
location.replace(this._zimbraAdminLoginURL);
return
}
for(var n=0;
n<ZLoginFactory.TAB_ORDER.length;
n++){
var o=document.getElementById(ZLoginFactory.TAB_ORDER[n]);
if(h&&o){
Dwt.associateElementWithObject(o,this)
}else{
if(o){
Dwt.disassociateElementFromObject(null,this)
}}}
if(h){
if(AjxEnv.isIE){
var r=ZLoginFactory.getLoginPanel();
var t=this.getHtmlElement();
for(var n=0;
n<r.length;
n++){
if(Dwt.contains(t,r[n])){
r[n]["onkeydown"]=ZLoginFactory.handleKeyPress
}}}else{
window.onkeypress=ZLoginFactory.handleKeyPress
}
var e=ZLoginFactory.get(ZLoginFactory.USER_ID);
if(!e.disabled){
e.focus()
}}};
ZaLoginDialog.prototype.addChild=function(t,e){
this._children.add(t)
};
ZaLoginDialog.prototype._loginSelListener=function(){
this.setCursor("wait");
var n=ZLoginFactory.get(ZLoginFactory.USER_ID).value;
if(!(n&&n.length)){
this.setError(ZaMsg.enterUsername);
return
}
if(this._callback){
var e=ZLoginFactory.get(ZLoginFactory.PASSWORD_ID).value;
var o="";
var t="";
if(ZLoginFactory.isShown(ZLoginFactory.NEW_PASSWORD_ID)&&ZLoginFactory.isShown(ZLoginFactory.PASSWORD_CONFIRM_ID)){
o=ZLoginFactory.get(ZLoginFactory.NEW_PASSWORD_ID).value;
t=ZLoginFactory.get(ZLoginFactory.PASSWORD_CONFIRM_ID).value
}
this._callback.run(n,e,o,t)
}};
ZaLoginDialog._loginListener=function(o){
var t=o;
while(t){
var e=Dwt.getObjectFromElement(t);
if(e instanceof ZaLoginDialog){
e._loginSelListener();
break
}
t=t.parentNode
}};
ZaLoginDialog._loginDiffListener=function(e){
ZmZimbraMail.logOff()
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaController")){
ZaController=function(o,e,t){
if(arguments.length==0){
return
}
this._evtMgr=new AjxEventMgr();
this._iKeyName=t;
this._appCtxt=o;
this._container=e;
this._shell=o.getShell();
this._appViews=new Object();
this._currentView=null;
this._contentView=null;
this._authenticating=false;
this.initDialogs();
this.objType=ZaEvent.S_ACCOUNT;
this._helpURL=ZaController.helpURL;
this._helpButtonText=ZabMsg.zimbraHomePage;
this._popupOperations=new Array();
this._popupOrder=new Array();
this._appbarOperation=new Array();
this._appbarOrder=new Array()
};
ZaController.CLICK_DELAY=150;
ZaController.prototype.initDialogs=function(e){
if(ZaApp.getInstance()){
this._msgDialog=ZaApp.getInstance().dialogs.msgDialog;
this._errorDialog=ZaApp.getInstance().dialogs.errorDialog;
this._errorDialog.registerCallback(DwtDialog.OK_BUTTON,this._errorDialogCallback,this);
this._msgDialog.registerCallback(DwtDialog.OK_BUTTON,this._msgDialogCallback,this)
}
this._loginDialog=this._appCtxt.getLoginDialog();
this._loginDialog.registerCallback(this.loginCallback,this)
};
ZaController.initToolbarMethods=new Object();
ZaController.initPopupMenuMethods=new Object();
ZaController.setViewMethods=new Object();
ZaController.changeActionsStateMethods=new Object();
ZaController.saveChangeCheckMethods=new Object();
ZaController.postChangeMethods=new Object();
ZaController.helpURL=location.pathname+ZaUtil.HELP_URL+"administration_console_help.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaController.prototype.toString=function(){
return"ZaController"
};
ZaController.prototype.getProgressDialog=function(){
if(!ZaApp.getInstance().dialogs.progressDialog){
ZaApp.getInstance().dialogs.progressDialog=new ZaXProgressDialog(this._appCtxt.getShell(),"300px","300px")
}
return ZaApp.getInstance().dialogs.progressDialog
};
ZaController.prototype.setDirty=function(e){};
ZaController.prototype.setCurrentView=function(e){
this._currentView=e
};
ZaController.prototype.getContentViewId=function(){
return this._contentView.__internalId
};
ZaController.prototype.setEnabled=function(e){};
ZaController.prototype.popupErrorDialog=function(s,t,o){
o=o?o:DwtMessageDialog.CRITICAL_STYLE;
this._execFrame={
func:null,args:null,restartOnError:false};
var n="";
if(t!=null){
if(t.msg){
n+=ZaMsg.ERROR_MESSAGE+"  ";
n+=AjxStringUtil.htmlEncode(t.msg);
n+="\n"
}
if(t.code){
n+=ZaMsg.ERROR_CODE+"  ";
n+=t.code;
n+="\n"
}
if(t.method){
n+="Method:  ";
n+=t.method;
n+="\n"
}
if(t.detail){
n+=ZaMsg.ERROR_DETAILS;
n+=t.detail;
n+="\n"
}
if(!n||n==""){
for(var e in t){
n+=e;
n+=": ";
try{
n+=t[e].toString()
}
catch(t){}
n+="\n"
}}}
if(!this._errorDialog){
this._errorDialog=ZaApp.getInstance().dialogs.errorDialog
}
if(this._errorDialog){
s=AjxStringUtil.htmlEncode(s);
this._errorDialog.setMessage(s,n,o,ZabMsg.zimbraAdminTitle);
if(!this._errorDialog.isPoppedUp()){
this._errorDialog.popup()
}}};
ZaController.prototype.popupMsgDialog=function(t,e){
if(!e){
this._execFrame={
func:null,args:null,restartOnError:false}
}
this._msgDialog.setMessage(t,DwtMessageDialog.INFO_STYLE,ZabMsg.zimbraAdminTitle);
if(!this._msgDialog.isPoppedUp()){
this._msgDialog.popup()
}};
ZaController.prototype.popupWarningDialog=function(t,e){
if(!e){
this._execFrame={
func:null,args:null,restartOnError:false}
}
this._msgDialog.setMessage(t,DwtMessageDialog.WARNING_STYLE,ZabMsg.zimbraAdminTitle);
if(!this._msgDialog.isPoppedUp()){
this._msgDialog.popup()
}};
ZaController.prototype.getControllerForView=function(e){
return this._appCtxt.getAppController()
};
ZaController.prototype.switchToNextView=function(e,t,o){
var n=new AjxCallback(e,t,o);
n.run()
};
ZaController.prototype._setView=function(l,h,r){
if(h){
var e=ZaAppTabGroup._TABS.size();
if(e>=ZaAppTabGroup.TAB_LIMIT){
this.popupMsgDialog(ZaMsg.too_many_tabs);
return
}}
if(ZaController.setViewMethods[this._iKeyName]){
var t=ZaController.setViewMethods[this._iKeyName];
var s=t.length;
for(var n=0;
n<s;
n++){
if(typeof(t[n])=="function"){
try{
t[n].call(this,l,h,r)
}
catch(o){
this._handleException(o,"ZaController.prototype._setView");
break
}}}}
this.changeActionsState()
};
ZaController.prototype.getMainTab=function(){
return ZaApp.getInstance().getTabGroup().getMainTab()
};
ZaController.prototype.getSearchTab=function(){
return ZaApp.getInstance().getTabGroup().getSearchTab()
};
ZaController.prototype.closeButtonListener=function(o,e,t,n,s){
if(e){
t.call(n,s)
}else{
ZaApp.getInstance().popView()
}};
ZaController.prototype._helpButtonListener=function(){
window.open(this._helpURL)
};
ZaController.prototype._showLoginDialog=function(){
ZaZimbraAdmin._killSplash();
this._authenticating=true;
this._loginDialog.setVisible(true,false);
try{
var e=null;
this._loginDialog.setFocus(e)
}
catch(t){
ZaZimbraAdmin.logOff()
}};
ZaController.prototype._handleException=function(h,e,n,d,s){
if(h.code&&(h.code==ZmCsfeException.SVC_AUTH_EXPIRED||h.code==ZmCsfeException.SVC_AUTH_REQUIRED||h.code==ZmCsfeException.NO_AUTH_TOKEN||h.code==ZmCsfeException.AUTH_TOKEN_CHANGED)){
try{
ZmCsfeCommand.noAuth=true;
if(ZaApp.getInstance()!=null){
var r=ZaApp.getInstance().dialogs;
for(var l in r){
r[l].popdown()
}}
this._execFrame={
obj:s,func:e,args:n,restartOnError:d};
this._loginDialog.registerCallback(this.loginCallback,this);
if((!ZaZimbraAdmin.isFirstRequest&&(h.code==ZmCsfeException.NO_AUTH_TOKEN||h.code==ZmCsfeException.SVC_AUTH_REQUIRED||h.code==ZmCsfeException.SVC_AUTH_EXPIRED))){
this._loginDialog.setError(ZaMsg.ERROR_SESSION_EXPIRED)
}
this._loginDialog.clearPassword();
this._showLoginDialog()
}
catch(t){
if(window.console&&window.console.log){
window.console.log(t.code)
}}}else{
this._execFrame={
obj:s,func:e,args:n,restartOnError:d};
if(!this._errorDialog){
this._errorDialog=ZaApp.getInstance().dialogs.errorDialog
}
if(this._errorDialog){
this._errorDialog.registerCallback(DwtDialog.OK_BUTTON,this._errorDialogCallback,this)
}
if(!h.code){
this.popupErrorDialog(ZaMsg.JAVASCRIPT_ERROR+" in method "+e,h)
}else{
if(h.code==ZmCsfeException.EMPTY_RESPONSE){
this.popupErrorDialog(ZabMsg.ERROR_ZCS_NOT_RUNNING,h)
}else{
if(h.code==ZmCsfeException.SOAP_ERROR){
this.popupErrorDialog(ZaMsg.SOAP_ERROR,h)
}else{
if(h.code==ZmCsfeException.NETWORK_ERROR||h.code==AjxException.NETWORK_ERROR){
this.popupErrorDialog(ZaMsg.NETWORK_ERROR,h)
}else{
if(h.code==ZmCsfeException.SVC_PARSE_ERROR){
this.popupErrorDialog(ZaMsg.PARSE_ERROR,h)
}else{
if(h.code==ZmCsfeException.SVC_PERM_DENIED){
this.popupErrorDialog(ZaMsg.PERMISSION_DENIED,h)
}else{
if(h.code==ZmCsfeException.ACCT_NO_SUCH_ACCOUNT){
this.popupErrorDialog(ZaMsg.ERROR_NO_SUCH_ACCOUNT,h)
}else{
if(h.code==ZmCsfeException.NO_SUCH_DISTRIBUTION_LIST){
this.popupErrorDialog(ZaMsg.NO_SUCH_DISTRIBUTION_LIST,h)
}else{
if(h.code==ZmCsfeException.ACCT_EXISTS){
this.popupErrorDialog(ZaMsg.ERROR_ACCOUNT_EXISTS,h)
}else{
if(h.code==ZmCsfeException.ACCT_TOO_MANY_ACCOUNTS){
this.popupErrorDialog(ZaMsg.ERROR_TOO_MANY_ACCOUNTS,h,true)
}else{
if(h.code==ZmCsfeException.VOLUME_NO_SUCH_PATH){
this.popupErrorDialog(ZaMsg.ERROR_INVALID_VOLUME_PATH,h)
}else{
if(h.code==ZmCsfeException.NO_SUCH_VOLUME){
this.popupErrorDialog(ZaMsg.ERROR_NO_SUCH_VOLUME,h)
}else{
if(h.code==ZmCsfeException.CANNOT_CHANGE_VOLUME){
this.popupErrorDialog(ZaMsg.ERROR_CANNOT_CHANGE_VOLUME,h)
}else{
if(h.code==ZmCsfeException.CANNOT_DELETE_VOLUME_IN_USE){
this.popupErrorDialog(ZaMsg.CANNOT_DELETE_VOLUME_IN_USE,h)
}else{
if(h.code==ZmCsfeException.ALREADY_EXISTS){
this.popupErrorDialog(ZaMsg.ERROR_VOLUME_ALREADY_EXISTS,h)
}else{
if(h.code==ZmCsfeException.LICENSE_ERROR){
this.popupErrorDialog(ZaMsg.ERROR_LICENSE,h)
}else{
if(h.code==ZmCsfeException.SVC_INVALID_REQUEST){
this.popupErrorDialog(ZaMsg.ERROR_INVALID_REQUEST,h)
}else{
if(h.code==ZmCsfeException.TOO_MANY_SEARCH_RESULTS){
this.popupErrorDialog(ZaMsg.ERROR_TOO_MANY_SEARCH_RESULTS,h)
}else{
if(h.code==ZmCsfeException.NO_SUCH_DOMAIN){
this.popupErrorDialog(ZaMsg.ERROR_NO_SUCH_DOMAIN,h)
}else{
if(h.code==ZmCsfeException.CSFE_SVC_ERROR||h.code==ZmCsfeException.SVC_FAILURE||(typeof(h.code)=="string"&&h.code&&h.code.match(/^(service|account|mail)\./))){
this.popupErrorDialog(ZaMsg.SERVER_ERROR,h)
}else{
if(h.code==AjxException.INVALID_PARAM){
this.popupErrorDialog(ZaMsg.ERROR_INVALID_VALUE,h);
this._errorDialog._showDetail()
}else{
var c=false;
for(var o in ZmCsfeException){
if(ZmCsfeException[o]==h.code){
this.popupErrorDialog(ZaMsg.SERVER_ERROR,h);
c=true;
break
}}
if(!c){
this.popupErrorDialog(ZaMsg.ERROR_UNKNOWN,h)
}}}}}}}}}}}}}}}}}}}}}}}};
ZaController.prototype._doAuth=function(n,e){
ZmCsfeCommand.noAuth=true;
try{
this._hideLoginDialog();
ZaZimbraAdmin.showSplash(this._shell);
var o=new AjxCallback(this,this.authCallback);
this.auth=new ZaAuthenticate(this._appCtxt);
this.auth.execute(n,e,o)
}
catch(t){
if(t.code==ZmCsfeException.NO_AUTH_TOKEN){
throw (t)
}else{
if(t.code==ZmCsfeException.ACCT_AUTH_FAILED||t.code==ZmCsfeException.SVC_PERM_DENIED||t.code==ZmCsfeException.SVC_FAILURE){
this._showLoginDialog(false);
this._loginDialog.setError(ZaMsg.ERROR_AUTH_FAILED);
return
}else{
if(t.code==ZmCsfeException.ACCT_CHANGE_PASSWORD){
this._showLoginDialog(true);
this._loginDialog.disablePasswordField(true);
this._loginDialog.disableUnameField(true);
this._loginDialog.showNewPasswordFields();
this._loginDialog.registerCallback(this.changePwdCallback,this)
}else{
this._showLoginDialog(false);
this.popupMsgDialog(ZaMsg.SERVER_ERROR,t)
}}}}};
ZaController.prototype._hideLoginDialog=function(e){
this._loginDialog.setVisible(false);
if(e){
this._loginDialog.setError(null);
this._loginDialog.clearPassword()
}};
ZaController.prototype.authCallback=function(n){
ZaController.changePwdCommand=null;
if(n.isException&&n.isException()){
var d=n.getException();
if(d.code==ZmCsfeException.ACCT_AUTH_FAILED||d.code==ZmCsfeException.SVC_PERM_DENIED||d.code==ZmCsfeException.SVC_FAILURE){
this._showLoginDialog(false);
this._loginDialog.setError(ZaMsg.ERROR_AUTH_FAILED);
this._loginDialog.clearPassword();
return
}else{
if(d.code==ZmCsfeException.ACCT_CHANGE_PASSWORD){
this._showLoginDialog(true);
this._loginDialog.setError(ZaMsg.errorPassChange);
this._loginDialog.disablePasswordField(true);
this._loginDialog.disableUnameField(true);
this._loginDialog.showNewPasswordFields();
this._loginDialog.registerCallback(this.changePwdCallback,this)
}else{
if(d.code==ZmCsfeException.PASSWORD_RECENTLY_USED||d.code==ZmCsfeException.PASSWORD_CHANGE_TOO_SOON){
this._showLoginDialog(true);
var t=d.code==ZmCsfeException.ACCT_PASS_RECENTLY_USED?ZaMsg.errorPassRecentlyUsed:(ZaMsg.errorPassChangeTooSoon);
this._loginDialog.setError(t);
this._loginDialog.clearPassword();
this._loginDialog.setFocus(null)
}else{
if(d.code==ZmCsfeException.PASSWORD_LOCKED){
this._showLoginDialog(true);
this._loginDialog.disablePasswordField(false);
this._loginDialog.disableUnameField(false);
this._loginDialog.setError(ZaMsg.errorPassLocked)
}else{
if(d.code==ZmCsfeException.MAINTENANCE_MODE){
this._showLoginDialog(false);
this._loginDialog.setError(ZaMsg.ERROR_ACC_IN_MAINTENANCE_MODE);
this._loginDialog.clearPassword()
}else{
if(d.code==ZmCsfeException.SVC_AUTH_EXPIRED){
this._showLoginDialog(true);
this._loginDialog.setError(ZaMsg.ERROR_SESSION_EXPIRED);
this._loginDialog.disableUnameField(true);
this._loginDialog.clearPassword()
}else{
if(this._msgDialog){
this.popupMsgDialog(ZaMsg.SERVER_ERROR,d)
}else{
this._showLoginDialog(true);
if(d&&this._refreshing&&d.code==ZmCsfeException.SVC_AUTH_REQUIRED){}else{
if(d&&d.msg){
this._loginDialog.setError(ZaMsg.SERVER_ERROR+" ("+d.msg+")")
}else{
this._loginDialog.setError(ZaMsg.SERVER_ERROR)
}}}}}}}}}}else{
try{
var r=n.getResponse();
var l=r.Body;
if(l.AuthResponse&&l.AuthResponse.csrfToken&&l.AuthResponse.csrfToken._content){
window.csrfToken=l.AuthResponse.csrfToken._content
}
var m=true;
ZmCsfeCommand.noAuth=false;
var u=AjxSoapDoc.create("GetInfoRequest","urn:zimbraAccount",null);
var s=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=u;
o.noSession=true;
o.noAuthToken=true;
ZaZimbraAdmin.isFirstRequest=true;
var n=s.invoke(o);
ZaZimbraAdmin.isFirstRequest=false;
ZaZimbraAdmin.initInfo(n);
ZaServerVersionInfo.load();
ZaZimbraAdmin.LOCALE_QS="";
if(ZaZimbraAdmin.LOCALE&&(ZaZimbraAdmin.LOCALE!=AjxEnv.DEFAULT_LOCALE)){
if(ZaZimbraAdmin.LOCALE!=null){
var c=ZaZimbraAdmin.LOCALE.indexOf("_");
if(c==-1){
ZaZimbraAdmin.LOCALE_QS="&language="+ZaZimbraAdmin.LOCALE
}else{
ZaZimbraAdmin.LOCALE_QS="&language="+ZaZimbraAdmin.LOCALE.substring(0,c)+"&country="+ZaZimbraAdmin.LOCALE.substring(ZaZimbraAdmin.LOCALE.length-2)
}}
ZaZimbraAdmin.reload_msg();
this.initDialogs(true)
}
if(ZaZimbraAdmin.isLanguage("ja")){
if(ZaAccountXFormView.CONTACT_TAB_ATTRS){
ZaAccountXFormView.CONTACT_TAB_ATTRS.push(ZaAccount.A_zimbraPhoneticCompany)
}
if(ZaAccountXFormView.ACCOUNT_NAME_GROUP_ATTRS){
ZaAccountXFormView.ACCOUNT_NAME_GROUP_ATTRS.push(ZaAccount.A_zimbraPhoneticFirstName,ZaAccount.A_zimbraPhoneticLastName)
}}
if(!ZaSettings.initialized){
ZaSettings.init()
}else{
ZaZimbraAdmin._killSplash()
}
if(ZaAuthenticate.processResponseMethods){
var e=ZaAuthenticate.processResponseMethods.length;
for(var h=0;
h<e;
h++){
if(typeof(ZaAuthenticate.processResponseMethods[h])=="function"){
ZaAuthenticate.processResponseMethods[h].call(this,n)
}}}
this._hideLoginDialog(true);
this._appCtxt.getAppController().startup(m)
}
catch(d){
this._handleException(d,"ZaController.prototype.authCallback")
}}
this._refreshing=false
};
ZaController.prototype.loginCallback=function(e,t){
this._doAuth(e,t)
};
ZaController.prototype.changePwdCallback=function(d,c,s,n){
if(s==null||s==""||n==null||n==""){
this._loginDialog.setError(ZaMsg.enterNewPassword);
return
}
if(s!=n){
this._loginDialog.setError(ZaMsg.bothNewPasswordsMustMatch);
return
}
var h=AjxSoapDoc.create("ChangePasswordRequest","urn:zimbraAccount");
var e=h.set("account",d);
e.setAttribute("by","name");
h.set("oldPassword",c);
h.set("password",s);
var o=null;
try{
if(ZaController.changePwdCommand){
return
}
ZaController.changePwdCommand=new ZmCsfeCommand();
o=ZaController.changePwdCommand.invoke({
soapDoc:h,noAuthToken:true,ignoreAuthToken:true,noSession:true}
).Body.ChangePasswordResponse;
if(o){
this._loginDialog.clearError();
this._loginDialog.enableUnameField();
this._loginDialog.enablePasswordField();
this._loginDialog.hideNewPasswordFields();
ZaZimbraAdmin.showSplash(this._shell);
var l=new AjxCallback(this,this.authCallback);
this.auth=new ZaAuthenticate(this._appCtxt);
this.auth.execute(d,s,l)
}}
catch(r){
ZaController.changePwdCommand=null;
if(r.code==ZmCsfeException.ACCT_PASS_RECENTLY_USED||r.code==ZmCsfeException.ACCT_PASS_CHANGE_TOO_SOON){
var t=r.code==ZmCsfeException.ACCT_PASS_RECENTLY_USED?ZaMsg.errorPassRecentlyUsed:(ZaMsg.errorPassChangeTooSoon);
this._loginDialog.setError(t);
this._loginDialog.setFocus(null)
}else{
if(r.code==ZmCsfeException.ACCT_PASS_LOCKED){
this._loginDialog.disablePasswordField(false);
this._loginDialog.disableUnameField(false);
this._loginDialog.setError(ZaMsg.errorPassLocked)
}else{
this._handleException(r,"ZaController.prototype.changePwdCallback")
}}}};
ZaController.prototype._errorDialogCallback=function(){
ZaApp.getInstance().dialogs.errorDialog.popdown();
if(this._execFrame){
if(this._execFrame.restartOnError&&!this._authenticating&&this._execFrame.method){
this._execFrame.method.apply(this,this._execFrame.args)
}
this._execFrame=null
}};
ZaController.prototype._msgDialogCallback=function(){
this._msgDialog.popdown();
if(this._execFrame){
if(this._execFrame.restartOnError&&!this._authenticating){
this._execFrame.method.apply(this,this._execFrame.args)
}
this._execFrame=null
}};
ZaController.prototype._initToolbar=function(){};
ZaController.prototype._initPopupMenu=function(){
if(ZaController.initPopupMenuMethods[this._iKeyName]){
var e=ZaController.initPopupMenuMethods[this._iKeyName];
var n=e.length;
for(var o=0;
o<n;
o++){
if(typeof(e[o])=="function"){
try{
e[o].call(this)
}
catch(t){
this._handleException(t,"ZaController.prototype._initPopupMenu")
}}}}};
ZaController.prototype.closeCnfrmDlg=function(){
if(ZaApp.getInstance().dialogs.confirmMessageDialog){
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown()
}};
ZaController.prototype.closeCnfrmDelDlg=function(){
if(ZaApp.getInstance().dialogs.confirmMessageDialog2){
ZaApp.getInstance().dialogs.confirmMessageDialog2.popdown()
}};
ZaController.prototype.getToolBar=function(){
return null
};
ZaController.prototype.addCreationListener=function(e){
this._evtMgr.addListener(ZaEvent.E_CREATE,e)
};
ZaController.prototype.removeCreationListener=function(e){
this._evtMgr.removeListener(ZaEvent.E_CREATE,e)
};
ZaController.prototype.addRemovalListener=function(e){
this._evtMgr.addListener(ZaEvent.E_REMOVE,e)
};
ZaController.prototype.removeRemovalListener=function(e){
this._evtMgr.removeListener(ZaEvent.E_REMOVE,e)
};
ZaController.prototype.addChangeListener=function(e){
this._evtMgr.addListener(ZaEvent.E_MODIFY,e)
};
ZaController.prototype.removeChangeListener=function(e){
this._evtMgr.removeListener(ZaEvent.E_MODIFY,e)
};
ZaController.prototype.addSearchListener=function(e){
this._evtMgr.addListener(ZaEvent.E_SEARCH,e)
};
ZaController.prototype.removeSearchListener=function(e){
this._evtMgr.removeListener(ZaEvent.E_SEARCH,e)
};
ZaController.prototype.fireCreationEvent=function(o){
try{
if(this._evtMgr.isListenerRegistered(ZaEvent.E_CREATE)){
var e=new ZaEvent(this.objType);
e.set(ZaEvent.E_CREATE,this);
if(o){
e.setDetails(o)
}
this._evtMgr.notifyListeners(ZaEvent.E_CREATE,e)
}}
catch(t){
this._handleException(t,"ZaXFormViewController.prototype.fireCreationEvent",o,false)
}};
ZaController.prototype.fireRemovalEvent=function(o){
try{
if(this._evtMgr.isListenerRegistered(ZaEvent.E_REMOVE)){
var e=new ZaEvent(this.objType);
e.set(ZaEvent.E_REMOVE,this);
e.setDetails(o);
this._evtMgr.notifyListeners(ZaEvent.E_REMOVE,e)
}}
catch(t){
this._handleException(t,"ZaController.prototype.fireRemovalEvent",o,false)
}};
ZaController.prototype.fireChangeEvent=function(o){
try{
if(this._evtMgr.isListenerRegistered(ZaEvent.E_MODIFY)){
var e=new ZaEvent(this.objType);
e.set(ZaEvent.E_MODIFY,this);
if(o){
e.setDetails(o)
}
this._evtMgr.notifyListeners(ZaEvent.E_MODIFY,e)
}}
catch(t){
this._handleException(t,"ZaXFormViewController.prototype.fireChangeEvent",null,false)
}};
ZaController.prototype.fireSearchEvent=function(o){
try{
if(this._evtMgr.isListenerRegistered(ZaEvent.E_SEARCH)){
var e=new ZaEvent(this.objType);
e.set(ZaEvent.E_SEARCH,this);
e.setDetails(o);
this._evtMgr.notifyListeners(ZaEvent.E_SEARCH,e)
}}
catch(t){
this._handleException(t,"ZaController.prototype.fireSearchEvent",o,false)
}};
ZaController.showTooltip=function(o,t){
var s=new DwtUiEvent(true);
s.setFromDhtmlEvent(o);
var e=DwtShell.getShell(window);
var n=e.getToolTip();
n.setContent(t.getInheritedProperty("toolTipContent"));
n.popup(s.docX,s.docY)
};
ZaController.hideTooltip=function(t){
var e=DwtShell.getShell(window);
var o=e.getToolTip();
o.popdown()
};
ZaController.prototype.selectExistingTabByItemId=function(t,e){
return false
};
ZaController.prototype.changeActionsState=function(){
if(this.changeAcStateAcId){
this.changeAcStateAcId=null
}
if(this._popupOperations){
for(var s in this._popupOperations){
if(this._popupOperations[s] instanceof ZaOperation){
this._popupOperations[s].enabled=true
}}}
if(ZaController.changeActionsStateMethods[this._iKeyName]){
var t=ZaController.changeActionsStateMethods[this._iKeyName];
var n=t.length;
for(var s=0;
s<n;
s++){
if(typeof(t[s])=="function"){
try{
t[s].call(this)
}
catch(o){
this._handleException(o,"ZaController.prototype.changeActionsState")
}}}}
if(this._actionMenu&&this._popupOperations){
for(var s in this._popupOperations){
if(this._popupOperations[s] instanceof ZaOperation&&!AjxUtil.isEmpty(this._actionMenu.getMenuItem(this._popupOperations[s].id))){
this._actionMenu.getMenuItem(this._popupOperations[s].id).setEnabled(this._popupOperations[s].enabled)
}}}
var r;
var e=ZaApp.getInstance().getCurrentController();
if(e&&this!=e){
r=false
}else{
r=true
}
var h=ZaZimbraAdmin.getInstance().getSettingMenu();
if(r&&this._popupOperations&&h){
for(var s in this._popupOperations){
if(this._popupOperations[s] instanceof ZaOperation&&!AjxUtil.isEmpty(h.getMenuItem(this._popupOperations[s].id))){
h.getMenuItem(this._popupOperations[s].id).setEnabled(this._popupOperations[s].enabled)
}}}};
ZaController.prototype.closeTabsInRemoveList=function(){
var t=ZaApp.getInstance().getTabGroup();
for(var e=0;
e<this._itemsInTabList.length;
e++){
var o=this._itemsInTabList[e];
t.removeTab(t.getTabByItemId(o.id));
this._removeList.push(o)
}
t.resetTabSizes(true)
};
ZaController.prototype._showAccountsView=function(s,l,r){
var d=null;
if(s==ZaItem.DL){
d=ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW
}else{
if(s==ZaItem.RESOURCE){
d=ZaZimbraAdmin._RESOURCE_LIST_VIEW
}else{
if(s==ZaItem.ALIAS){
d=ZaZimbraAdmin._ALIASES_LIST_VIEW
}else{
d=ZaZimbraAdmin._ACCOUNTS_LIST_VIEW
}}}
var u=ZaApp.getInstance().getAccountListController(d);
var h="";
if(s!=ZaItem.ALIAS){
if(!ZaSettings.HAVE_MORE_DOMAINS&&ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]!="TRUE"){
var e=[];
var o={
asyncMode:true,callback:this._showAccountsView.bind(this,s,l,r)};
var c=ZaApp.getInstance().getDomainList(false,o);
if(!c){
return
}
c=c.getArray();
var t=c.length;
if(t>0){
e.push("(|")
}
for(var n=0;
n<t;
n++){
e.push("(zimbraMailDeliveryAddress=*@");
e.push(c[n].name);
e.push(")");
e.push("(zimbraMailAlias=*@");
e.push(c[n].name);
e.push(")")
}
if(t>0){
e.push(")");
h=e.join("")
}}}
if(r){
h=h+r
}
u.setPageNum(1);
u.setQuery(h);
u.setSortOrder("1");
u.setSortField(ZaAccount.A_name);
u.setSearchTypes([ZaSearch.TYPES[s]]);
u.setDefaultType(s);
if(s==ZaItem.DL){
u.setFetchAttrs(ZaDistributionList.searchAttributes)
}else{
if(s==ZaItem.RESOURCE){
u.setFetchAttrs(ZaResource.searchAttributes)
}else{
if(s==ZaItem.ALIAS){
u.setFetchAttrs(ZaAlias.searchAttributes)
}else{
u.setFetchAttrs(ZaSearch.standardAttributes)
}}}
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(u,ZaAccountListController.prototype.show,[true,l.refresh])
}else{
u.show(true)
}};
ZaController.prototype.cancelBusyOverlay=function(e){
if(this._currentRequest){
this._currentRequest.cancel()
}
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,e.busyId)
};
ZaController.prototype.getPopUpOperation=function(){
if(this._popupOperations&&this._popupOperations.length>0){
return this._popupOperations
}else{
return""
}};
ZaController.prototype.getPopUpMenu=function(){
if(this._actionMenu!=null){
return this._actionMenu
}else{
return null
}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaXFormViewController")){
ZaXFormViewController=function(o,e,t){
if(arguments.length==0){
return
}
this._currentObject=null;
ZaController.call(this,o,e,t);
this.deleteMsg=ZaMsg.Q_DELETE_ACCOUNT;
this._toolbarOrder=new Array()
};
ZaXFormViewController.prototype=new ZaController();
ZaXFormViewController.prototype.constructor=ZaXFormViewController;
ZaXFormViewController.preSaveValidationMethods=new Object();
ZaXFormViewController.prototype.show=function(e){
if(!this.selectExistingTabByItemId(e.id)){
this._setView(e,true)
}};
ZaXFormViewController.prototype.handleXFormChange=function(e){
if(e&&e.form.hasErrors()&&this._toolbar){
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false)
}};
ZaXFormViewController.prototype.fireRemovalEvent=function(o){
try{
if(this._evtMgr.isListenerRegistered(ZaEvent.E_REMOVE)){
var e=new ZaEvent(this.objType);
e.set(ZaEvent.E_REMOVE,this);
e.setDetails(o);
this._evtMgr.notifyListeners(ZaEvent.E_REMOVE,e)
}}
catch(t){
this._handleException(t,"ZaXFormViewController.prototype.fireRemovalEvent",o,false)
}};
ZaXFormViewController.prototype.closeButtonListener=function(s,e,n,r,h,o){
if(this._view&&this._view.isDirty&&this._view.isDirty()){
var t=new Object();
if(e){
t.obj=r;
t.params=[h,this];
t.func=function(l){
var c=l[0];
n.call(this,c);
var d=l[1]
}
}else{
t.obj=ZaApp.getInstance();
t.params=[null,this];
t.func=function(l){
var c=l[0];
var d=l[1];
d._setSelectionAfterCloseView(o)
}
}
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_SAVE_CHANGES,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.saveAndGoAway,this,t);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.discardAndGoAway,this,t);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
if(e){
n.call(r,h)
}else{
if(this._view&&this._view._localXForm&&this._view.formDirtyLsnr){
this._view._localXForm.removeListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,this._view.formDirtyLsnr);
this._view._localXForm.removeListener(DwtEvent.XFORMS_VALUE_ERROR,this._view.formDirtyLsnr)
}
this._setSelectionAfterCloseView(o)
}}};
ZaXFormViewController.prototype._setSelectionAfterCloseView=function(r){
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
if(!r){
var t=e.getCurrentRootItem();
var o=e.getABPath(t.getData("dataItem"));
var n="";
var s=o.lastIndexOf(ZaTree.SEPERATOR);
if(s>0){
n=o.substring(0,s)
}
r=n
}
e.setSelectionByPath(r,undefined,undefined,undefined,undefined,undefined,true)
};
ZaXFormViewController.prototype.deleteButtonListener=function(e){
if(this._currentObject.id){
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(this.deleteMsg,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.deleteAndGoAway,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.closeCnfrmDlg,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
ZaApp.getInstance().popView()
}};
ZaXFormViewController.prototype.saveButtonListener=function(t){
try{
this.validateChanges()
}
catch(e){
this._handleException(e,"ZaXFormViewController.prototype.saveButtonListener",null,false)
}
return
};
ZaXFormViewController.prototype._saveChanges=function(){
return true
};
ZaXFormViewController.prototype.saveAndGoAway=function(t){
try{
this.closeCnfrmDlg();
if(this._saveChanges()){
this.fireChangeEvent(this._currentObject);
t.func.call(t.obj,t.params)
}}
catch(e){
this._handleException(e,ZaXFormViewController.prototype.saveAndGoAway,null,false)
}};
ZaXFormViewController.prototype.deleteAndGoAway=function(){
try{
if(this._currentObject.id){
this._currentObject.remove();
this.fireRemovalEvent(this._currentObject);
var h="";
switch(this._currentObject.type){
case ZaItem.ACCOUNT:h=ZaMsg.AccountDeleted;
break;
case ZaItem.DOMAIN:h=ZaMsg.DomainDeleted;
break;
case ZaItem.RESOURCE:h=ZaMsg.ResourceDeleted;
break;
case ZaItem.DL:h=ZaMsg.DLDeleted;
break;
case ZaItem.COS:h=ZaMsg.CosDeleted;
break;
default:h="";
break
}
if(h){
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(h,[this._currentObject.name]))
}}
this.closeCnfrmDlg();
ZaApp.getInstance().popView();
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
var t=e.getCurrentRootItem();
var n=e.getABPath(t.getData("dataItem"));
var s="";
var r=n.lastIndexOf(ZaTree.SEPERATOR);
if(r>0){
s=n.substring(0,r)
}
e.setSelectionByPath(s)
}
catch(o){
this.closeCnfrmDlg();
this._handleException(o,"ZaXFormViewController.prototype.deleteAndGoAway",null,false)
}};
ZaXFormViewController.prototype.discardAndGoAway=function(e){
this.closeCnfrmDlg();
e.func.call(e.obj,e.params)
};
ZaXFormViewController.prototype.runValidationStack=function(o){
try{
var t=this.validationStack.length;
if(t>0){
var n=this.validationStack[t-1];
this.validationStack.pop();
n.call(this,o)
}else{
this._saveChangesCallback(o)
}}
catch(e){
this._handleException(e,"ZaXFormViewController.prototype.runValidationStack",null,false)
}};
ZaXFormViewController.prototype.validateChanges=function(o){
this.validationStack=[];
if(ZaXFormViewController.preSaveValidationMethods[this._iKeyName]){
var t=ZaXFormViewController.preSaveValidationMethods[this._iKeyName].length;
if(t>0){
for(var e=0;
e<t;
e++){
this.validationStack.push(ZaXFormViewController.preSaveValidationMethods[this._iKeyName][e])
}}}
this.runValidationStack(o)
};
ZaXFormViewController.prototype._saveChangesCallback=function(t){
try{
if(this._saveChanges()){
this._view.setDirty(false);
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false);
this.closeCnfrmDlg();
if(typeof(this.changeActionsState)=="function"){
this.changeActionsState()
}
this._currentObject.refresh(false,true);
this.fireChangeEvent(this._currentObject);
if(t){
t.func.call(t.obj,t.params)
}else{
this._view.setObject(this._currentObject)
}}}
catch(e){
this._handleException(e,"ZaXFormViewController.prototype._saveChangesCallback",null,false)
}};
ZaXFormViewController.prototype.setDirty=function(e){
var o=ZaZimbraAdmin.getInstance().getSettingMenu();
if(!o||!this._popupOperations||!this._popupOperations[ZaOperation.SAVE]||!this._popupOperations[ZaOperation.SAVE].id){
return
}
if(!this._popupOperations){
return
}
if(!this._popupOperations[ZaOperation.SAVE]){
return
}
var t=o.getMenuItem(this._popupOperations[ZaOperation.SAVE].id);
if(AjxUtil.isEmpty(t)){
return
}
if(e){
t.setEnabled(true)
}else{
t.setEnabled(false)
}
if(e){
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,true)
}else{
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false)
}};
ZaXFormViewController.setViewMethod=function(e){
if(e.load){
e.load()
}
if(!this._UICreated){
this._createUI()
}
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setObject(e);
this._currentObject=e
};
ZaXFormViewController.prototype._createUI=function(){
this._contentView=this._view=new this.tabConstructor(this._container);
var e=new Object();
e[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),e);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaXFormViewController.prototype._findAlias=function(o){
var t=[ZaSearch.ALIASES,ZaSearch.DLS,ZaSearch.ACCOUNTS,ZaSearch.RESOURCES];
var n=new ZaSearchQuery(ZaSearch.searchAliasByNameQuery(o,t),t,null,false);
var e=ZaSearch.searchByQueryHolder(n,1,null,null);
return e.list.getArray()[0]
};
ZaXFormViewController.prototype.getAppBarAction=function(){
if(AjxUtil.isEmpty(this._appbarOperation)){
this._appbarOperation[ZaOperation.HELP]=new ZaOperation(ZaOperation.HELP,ZaMsg.TBB_Help,ZaMsg.TBB_Help_tt,"Help","Help",new AjxListener(this,this._helpButtonListener));
this._appbarOperation[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.ALTBB_Save_tt,"","",new AjxListener(this,this.saveButtonListener));
this._appbarOperation[ZaOperation.CLOSE]=new ZaOperation(ZaOperation.CLOSE,ZaMsg.TBB_Close,ZaMsg.ALTBB_Close_tt,"","",new AjxListener(this,this.closeButtonListener))
}
return this._appbarOperation
};
ZaXFormViewController.prototype.getAppBarOrder=function(){
if(AjxUtil.isEmpty(this._appbarOrder)){
this._appbarOrder.push(ZaOperation.HELP);
this._appbarOrder.push(ZaOperation.SAVE);
this._appbarOrder.push(ZaOperation.CLOSE)
}
return this._appbarOrder
};
ZaXFormViewController.prototype._helpButtonListener=function(){
var e=this._helpURL;
if(this._contentView&&this._contentView.helpMap&&this._contentView.getCurrentTab()&&this._contentView.helpMap[this._contentView.getCurrentTab()]){
e=this._contentView.helpMap[this._contentView.getCurrentTab()]
}
window.open(e)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaListViewController")){
ZaListViewController=function(o,e,t){
if(arguments.length==0){
return
}
this._currentPageNum=1;
this._currentSortOrder="1";
ZaController.call(this,o,e,t);
this.RESULTSPERPAGE=ZaSettings.RESULTSPERPAGE;
this.MAXSEARCHRESULTS=ZaSettings.MAXSEARCHRESULTS
};
ZaListViewController.prototype=new ZaController();
ZaListViewController.prototype.constructor=ZaListViewController;
ZaListViewController.prototype._nextPageListener=function(e){
if(this._currentPageNum<this.numPages){
this._currentPageNum++;
this.show()
}};
ZaListViewController.prototype._prevPageListener=function(e){
if(this._currentPageNum>1){
this._currentPageNum--;
this.show()
}};
ZaListViewController.prototype.getList=function(){
return this._list
};
ZaListViewController.prototype._updateUI=function(s,n,h,r){
if(!this._UICreated){
this._createUI(n,h)
}
if(s){
var t=new Array();
var o=s.getArray().length;
for(var e=0;
e<o;
e++){
t.push(s.getArray()[e])
}
if(o<1){}
this._contentView._bSortAsc=(this._currentSortOrder=="1");
this._contentView.set(AjxVector.fromArray(t),this._contentView._defaultColumnSortable);
this._contentView.setScrollSearchParams(this.scrollSearchParams);
this._contentView.setScrollHasMore(r)
}
this._removeList=new Array();
this.changeActionsState()
};
ZaListViewController.prototype.closeButtonListener=function(o,e,t,n,s){
if(e){
t.call(n,s)
}else{
ZaApp.getInstance().popView()
}
this._UICreated=false;
if(this._contentView){
this._contentView.dispose();
this._contentView=null
}
if(this._actionMenu){
this._actionMenu.dispose();
this._actionMenu=null
}
this._popupOperations=[]
};
ZaListViewController.prototype.multipleSearchCallback=function(n,f){
var p,k,h,t,O,b;
var s=null;
if(!f){
return
}
if(f instanceof Array&&f.length>0){
s=f
}else{
s=new Array();
s.push(f)
}
b=s.length;
O=AjxSoapDoc.create("BatchRequest","urn:zimbra");
O.setMethodAttribute("onerror","continue");
for(var w=0;
w<b;
w++){
var o=O.set("SearchDirectoryRequest",null,null,ZaZimbraAdmin.URN);
var l=O.set("query",s[w].query,o);
p=(s[w].sortBy!=undefined)?s[w].sortBy:ZaAccount.A_name;
k=(s[w].limit!=undefined)?s[w].limit:ZaAccount.RESULTSPERPAGE;
h=(s[w].offset!=undefined)?s[w].offset:"0";
t=(s[w].sortAscending!=null)?s[w].sortAscending:"1";
o.setAttribute("offset",h);
o.setAttribute("limit",k);
o.setAttribute("sortBy",p);
o.setAttribute("sortAscending",t);
if(s[w].applyCos){
o.setAttribute("applyCos",s[w].applyCos)
}else{
o.setAttribute("applyCos",false)
}
if(s[w].applyConfig){
o.setAttribute("applyConfig",s[w].applyConfig)
}else{
o.setAttribute("applyConfig","false")
}
if(s[w].domain){
o.setAttribute("domain",s[w].domain)
}
if(s[w].attrs&&s[w].attrs.length>0){
o.setAttribute("attrs",s[w].attrs.toString())
}
if(s[w].types&&s[w].types.length>0){
o.setAttribute("types",s[w].types.toString())
}
if(s[w].maxResults){
o.setAttribute("maxResults",s[w].maxResults.toString())
}}
var z=new Object();
z.soapDoc=O;
var r={
controller:this,busyMsg:ZaMsg.BUSY_REQUESTING_ACCESS_RIGHTS};
var T=ZaRequestMgr.invoke(z,r);
var c;
if(T.isException&&T.isException()){
ZaApp.getInstance().getCurrentController()._handleException(T.getException(),"ZaListViewController.prototype.multipleSearchCallback",null,false)
}else{
if(T.Body.BatchResponse.Fault){
var d=T.Body.BatchResponse.Fault;
if(d instanceof Array){
d=d[0]
}
if(d){
var v=ZmCsfeCommand.faultToEx(d);
ZaApp.getInstance().getCurrentController()._handleException(v,"ZaListViewController.prototype.multipleSearchCallback",null,false)
}}else{
var g=T.Body.BatchResponse;
if(g.SearchDirectoryResponse&&g.SearchDirectoryResponse instanceof Array){
var e=g.SearchDirectoryResponse.length;
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
this._searchTotal=0;
this._list=null;
var q=false;
for(var w=0;
w<e;
w++){
resp=g.SearchDirectoryResponse[w];
var m=new ZaItemList(n.CONS);
m.loadFromJS(resp);
if(!this._list){
this._list=m
}else{
if(this._list instanceof ZaItemList&&m.size()>0){
var u=m.getVector();
for(var y=0;
y<u.size();
y++){
var x=u.get(y);
if(!this._list.getVector().contains(x)){
this._list.add(x)
}}}}
q=resp.more|q;
this._searchTotal+=resp.searchTotal;
c=this.getSearchResultStats(resp,c)
}
var k=n.limit?n.limit:this.RESULTSPERPAGE;
this.numPages=Math.ceil(this._searchTotal/n.limit);
if(n.show){
this._show(this._list,n.openInNewTab,n.openInSearchTab,q,n.isShowBubble)
}else{
this._updateUI(this._list,n.openInNewTab,n.openInSearchTab,q)
}}}}
ZaZimbraAdmin.getInstance().getOverviewPanelController().fireSearchEvent(c)
};
ZaListViewController.prototype.getAppBarAction=function(){
if(AjxUtil.isEmpty(this._appbarOperation)){
this._appbarOperation[ZaOperation.HELP]=new ZaOperation(ZaOperation.HELP,ZaMsg.TBB_Help,ZaMsg.TBB_Help_tt,"Help","Help",new AjxListener(this,this._helpButtonListener))
}
return this._appbarOperation
};
ZaListViewController.prototype.getAppBarOrder=function(){
if(AjxUtil.isEmpty(this._appbarOrder)){
this._appbarOrder.push(ZaOperation.HELP)
}
return this._appbarOrder
};
ZaListViewController.prototype.searchCallback=function(t,o){
try{
if(t.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,t.busyId)
}
if(!o&&!this._currentRequest.cancelled){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListViewController.prototype.searchCallback"))
}
var d;
if(o&&o.isException()&&!this._currentRequest.cancelled){
ZaSearch.handleTooManyResultsException(o.getException(),"ZaListViewController.prototype.searchCallback");
this._list=new ZaItemList(t.CONS);
this._searchTotal=0;
this.numPages=0;
if(t.show){
this._show(this._list)
}else{
this._updateUI(this._list)
}}else{
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
this._list=null;
var c=new ZaItemList(t.CONS);
this._searchTotal=0;
if(o&&!o.isException()){
var n=o.getResponse().Body.SearchDirectoryResponse;
this._list=new ZaItemList(t.CONS);
c.loadFromJS(n);
if(t.resultFilter&&c.size()>0){
var u=c.getVector();
for(var s=0;
s<u.size();
s++){
var m=u.get(s);
var h=null;
if(m.type==ZaItem.ALIAS){
h=m.getAliasTargetObj()
}else{
h=m
}
for(var r in t.resultFilter){
if(h.attrs[r].indexOf(t.resultFilter[r])>=0){
this._list.add(m);
break
}}}}else{
this._list=c
}
this._searchTotal=n.searchTotal;
var e=t.limit?t.limit:this.RESULTSPERPAGE;
this.numPages=Math.ceil(this._searchTotal/t.limit);
d=this.getSearchResultStats(n)
}
if(t.show){
this._show(this._list,t.openInNewTab,t.openInSearchTab,n.more,t.isShowBubble)
}else{
this._updateUI(this._list,t.openInNewTab,t.openInSearchTab,n.more)
}}
ZaZimbraAdmin.getInstance().getOverviewPanelController().fireSearchEvent(d)
}
catch(l){
if(l.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
this._handleException(l,"ZaListViewController.prototype.searchCallback")
}else{
this.popupErrorDialog(ZaMsg.queryParseError,l);
if(this._searchField){
this._searchField.setEnabled(true)
}}}};
ZaListViewController.prototype.getSearchResultStats=function(t,o){
var e={};
if(o){
e=o
}
if(!t||!t.searchTotal){
return e
}
if(e.searchTotal){
e.searchTotal+=t.searchTotal
}else{
e.searchTotal=t.searchTotal
}
return e
};
ZaListViewController.prototype.handleChange=function(e){
if(e&&this.objType&&e.type==this.objType){
if(e.getDetails()&&this._UICreated){
this.show(false)
}}
ZaZimbraAdmin.getInstance().getOverviewPanelController().refreshRelatedTreeByEdit(e.getDetails())
};
ZaListViewController.prototype.handleCreation=function(e){
if(e&&this.objType&&e.type==this.objType){
if(e.getDetails()&&this._UICreated){
this.show(false)
}}
ZaZimbraAdmin.getInstance().getOverviewPanelController().refreshRelatedTree(e.getDetails())
};
ZaListViewController.prototype.handleRemoval=function(e){
if(e&&this.objType&&e.type==this.objType){
if(e.getDetails()&&this._UICreated){
this._currentPageNum=1;
this.show(false)
}
ZaZimbraAdmin.getInstance().refreshHistoryTreeByDelete(e.getDetails())
}};
ZaListViewController.prototype.setPageNum=function(e){
this._currentPageNum=Number(e)
};
ZaListViewController.prototype.getPageNum=function(){
return this._currentPageNum
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaItemVector")){
ZaItemVector=function(){
AjxVector.call(this,null)
};
ZaItemVector.prototype=new AjxVector;
ZaItemVector.prototype.constructor=ZaItemVector;
ZaItemVector.prototype.contains=function(t){
if(!(t instanceof ZaItem)){
throw new DwtException("Invalid parameter",DwtException.INTERNAL_ERROR,"ZaItemVector.prototype.add","ZaItemVector can contain only objects of ZaItem class and classes that extend ZaItem.")
}
for(var e=0;
e<this._array.length;
e++){
if(this._array[e].id==t.id){
return true
}}
return false
};
ZaItemVector.prototype.remove=function(t){
if(!(t instanceof ZaItem)){
throw new DwtException("Invalid parameter",DwtException.INTERNAL_ERROR,"ZaItemVector.prototype.add","ZaItemVector can contain only objects of ZaItem class and classes that extend ZaItem.")
}
for(var e=0;
e<this._array.length;
e++){
if(this._array[e].id==t.id){
this._array.splice(e,1);
return true
}}
return false
};
ZaItemVector.prototype.replace=function(o,e){
if(!(o instanceof ZaItem)){
throw new DwtException("Invalid parameter",DwtException.INTERNAL_ERROR,"ZaItemVector.prototype.replace","ZaItemVector can contain only objects of ZaItem class and classes that extend ZaItem.")
}
if(e==null||e<0||e>=this._array.length){
for(var t=0;
t<this._array.length;
t++){
if(this._array[t].id==o.id){
this._array.splice(t,1,o);
return true
}}}else{
this._array.splice(e,1,o)
}
return this.add(o)
};
ZaItemVector.prototype.add=function(t,e){
if(!(t instanceof ZaItem)){
throw new DwtException("Invalid parameter",DwtException.INTERNAL_ERROR,"ZaItemVector.prototype.add","ZaItemVector can contain only objects of ZaItem class and classes that extend ZaItem.")
}
if(e==null||e<0||e>=this._array.length){
this._array.push(t)
}else{
this._array.splice(e,0,t)
}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaItemList")){
ZaItemList=function(e){
ZaModel.call(this,true);
if(e){
this._constructor=e
}
this.loadedRights=false;
this._vector=new ZaItemVector();
this._idHash=new Object();
this._targetIdHash=new Object()
};
ZaItemList.prototype=new ZaModel;
ZaItemList.prototype.constructor=ZaItemList;
ZaItemList.prototype.toString=function(){
return"ZaItemList"
};
ZaItemList.prototype.replace=function(t,e){
this._vector.replace(t,e);
if(t.id){
this._idHash[t.id]=t
}
if(t.attrs&&t.attrs[ZaAlias.A_AliasTargetId]){
this._targetIdHash[t.attrs[ZaAlias.A_AliasTargetId]]=t
}};
ZaItemList.prototype.replaceItem=function(e){
if(e.id){
this._idHash[e.id]=e
}
if(e.attrs&&e.attrs[ZaAlias.A_AliasTargetId]){
this._targetIdHash[e.attrs[ZaAlias.A_AliasTargetId]]=e
}};
ZaItemList.prototype.add=function(t,e){
this._vector.add(t,e);
if(t.id){
this._idHash[t.id]=t
}
if(t.attrs&&t.attrs[ZaAlias.A_AliasTargetId]){
this._targetIdHash[t.attrs[ZaAlias.A_AliasTargetId]]=t
}};
ZaItemList.prototype.remove=function(e){
this._vector.remove(e);
if(e.id){
delete this._idHash[e.id]
}
if(e.attrs&&e.attrs[ZaAlias.A_AliasTargetId]&&this._targetIdHash[e.attrs[ZaAlias.A_AliasTargetId]]){
delete this._targetIdHash[e.attrs[ZaAlias.A_AliasTargetId]]
}};
ZaItemList.prototype.size=function(){
return this._vector.size()
};
ZaItemList.prototype.getArray=function(){
return this._vector.getArray()
};
ZaItemList.prototype.getVector=function(){
return this._vector
};
ZaItemList.prototype.getIdHash=function(){
return this._idHash
};
ZaItemList.prototype.getItemById=function(e){
return this._idHash[e]?this._idHash[e]:this._targetIdHash[e]?this._targetIdHash[e]:null
};
ZaItemList.prototype.clear=function(){
this._vector.removeAll();
for(var e in this._idHash){
this._idHash[e]=null
}
this._idHash=new Object();
for(var e in this._targetIdHash){
this._targetIdHash[e]=null
}
this._targetIdHash=null
};
ZaItemList.prototype.loadFromDom=function(e){
this.clear();
var t=e.childNodes;
for(var o=0;
o<t.length;
o++){
var n;
if(this._constructor){
n=new this._constructor()
}else{
n=ZaItem.getFromType(t[o].nodeName)
}
n.type=t[o].nodeName;
n.initFromDom(t[o]);
this.add(n)
}};
ZaItemList.prototype.loadFromJS=function(r){
if(!r){
return
}
for(var o in r){
if(r[o] instanceof Array){
var t=r[o];
var e=t.length;
for(var n=0;
n<e;
n++){
var s;
if(this._constructor){
s=new this._constructor()
}else{
s=ZaItem.getFromType(o)
}
s.type=o;
s.initFromJS(t[n]);
if(s instanceof ZaAlias){
s.attrs[ZaAlias.A_targetType]=t[n][ZaAlias.A_targetType];
s.attrs[ZaAlias.A_targetAccount]=t[n][ZaAlias.A_targetAccount]
}
if(this._idHash[s.id]){
this._idHash[s.id].initFromJS(t[n])
}else{
this.add(s)
}}}}};
ZaItemList.prototype._getIds=function(n){
var o=new Object();
if(!(n&&n.length)){
return o
}
var t=new Array();
for(var e=0;
e<n.length;
e++){
var s=n[e].id;
if(s){
t.push(s);
o[s]=n[e]
}}
o.string=t.join(",");
return o
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaListView")){
ZaListView=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,ZaListView.PARAMS);
var t=(e.view)?DwtId.getListViewId(e.view,e.id):DwtId.getListViewId(e.id);
e.id=t;
DwtListView.call(this,e);
if(e.scrollLoading){
Dwt.setHandler(this._getScrollDiv(),DwtEvent.ONSCROLL,ZaListView.handleScroll)
}
this.setScrollStyle(DwtControl.SCROLL);
if(this._listDiv){
this._listDiv.style.overflow="visible"
}
this.scrollSearchParams=null;
this.scrollHasMore=false
};
ZaListView.PARAMS=["parent","className","posStyle","headerList","view","id","scrollLoading"];
ZaListView.prototype=new DwtListView;
ZaListView.prototype.constructor=ZaListView;
ZaListView.prototype.toString=function(){
return"ZaListView"
};
ZaListView.ITEM_FLAG_CLICKED=DwtListView._LAST_REASON+1;
ZaListView.prototype._createItemHtml=function(e){
DwtListView.prototype._createItemHtml.call(this,e)
};
ZaListView.prototype.createHeaderHtml=function(e){
DwtListView.prototype.createHeaderHtml.call(this,e,true)
};
ZaListView.prototype.getTitle=function(){
return""
};
ZaListView.prototype.getTabToolTip=function(){
return this.getTitle()
};
ZaListView.prototype.getTabIcon=function(){
return""
};
ZaListView.prototype.getTabTitle=function(){
return this.getTitle()
};
ZaListView.prototype._mouseOverAction=function(n,h){
var t=this._getItemData(h,"type");
if(t==DwtListView.TYPE_HEADER_ITEM){
if(this._headerList[this._getItemData(h,"index")]._sortable){
h.className="DwtListView-Column DwtListView-ColumnHover";
this.setToolTipContent(AjxMessageFormat.format(ZaMsg.LST_ClickToSort_tt,[this._headerList[this._getItemData(h,"index")].getLabel()]))
}else{
this.setToolTipContent(null)
}}else{
if(t==DwtListView.TYPE_HEADER_SASH){
h.style.cursor=AjxEnv.isIE?"col-resize":"e-resize"
}else{
if(t==DwtListView.TYPE_LIST_ITEM){
var o=this.getItemFromElement(h);
if(o&&o.getToolTip){
var r="";
try{
r=o.getToolTip()
}
catch(s){
r=s.msg
}
this.setToolTipContent(r)
}}}}
return true
};
ZaListView.prototype._mouseOutAction=function(t,o){
var e=this._getItemData(o,"type");
if(e==DwtListView.TYPE_HEADER_ITEM){
if(this._headerList[this._getItemData(o,"index")]._sortable){
o.className=(o.id!=this._currentColId)?"DwtListView-Column":"DwtListView-Column DwtListView-ColumnActive"
}}else{
if(e==DwtListView.TYPE_HEADER_SASH){
o.style.cursor="auto"
}}
return true
};
ZaListView.prototype.getTooltipBase=function(e){
return null
};
ZaListView.prototype._setListEvent=function(t,n,e){
DwtListView.prototype._setListEvent.call(this,t,n,e);
var o=t.target.id.split(DwtId.SEP);
n.field=o&&o[2];
return true
};
ZaListView.prototype._sortColumn=function(e,t){
if(t){
this._list.sort(ZaItem.compareNamesAsc)
}else{
this._list.sort(ZaItem.compareNamesDesc)
}
this.setUI()
};
ZaListView.prototype._setNoResultsHtml=function(){
if(ZaSearch.TOO_MANY_RESULTS_FLAG){
var t=new Array(3);
var e=0;
t[e++]="<table width='100%' cellspacing='0' cellpadding='1'><tr><td class='NoResults'><br>";
t[e++]=ZaMsg.TooManyResults;
t[e++]="</td></tr></table>";
var o=document.createElement("div");
o.innerHTML=t.join("");
this._addRow(o)
}else{
DwtListView.prototype._setNoResultsHtml.call(this)
}};
ZaListView.prototype._getScrollDiv=function(){
return this.getHtmlElement()
};
ZaListView.prototype.setScrollSearchParams=function(e){
this.scrollSearchParams=e
};
ZaListView.prototype.setScrollHasMore=function(e){
this.scrollHasMore=e
};
ZaListView._getSearchKeyWord=function(r){
var o="";
var e="zimbraDomainName=*";
var n="@";
var s="*";
if(!r){
return o
}
var h=r.indexOf(e);
if(h<0||h>r.length-1){
return[]
}
var t=r.indexOf(s,h+e.length);
if(t>r.length-1){
return[]
}
o=r.substr(h+e.length,t-h-e.length);
h=o.indexOf(n);
if(h<0||h>r.length-1){
return[o]
}
return[o.substr(h+1,o.length),o.substr(0,h)]
};
ZaListView.prototype.searchAliasDomain=function(h,d,l,t,e){
var o=Dwt.getNextId();
var n=d;
var s="("+ZaDomain.A_domainName;
if(h.length>0){
s+="="+h[0]+"*)"
}else{
s=""
}
var c=new AjxCallback(this,this.searchAliasDomainCallback,{
busyId:o,searchQueryList:l,childQueries:h,offset:t,limit:e}
);
var r={
query:s,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,attrs:[ZaDomain.A_domainName],callback:c,controller:n,showBusy:true,busyId:o,busyMsg:ZaMsg.BUSY_SEARCHING_DOMAINS,skipCallbackIfCancelled:false};
ZaSearch.searchDirectory(r)
};
ZaListView.prototype.searchAliasDomainCallback=function(h,r){
if(h.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,h.busyId)
}
try{
if(!r){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListView.searchAliasDomainCallback"))
}
if(r.isException()){
throw (r.getException())
}else{
var e=r.getResponse().Body.SearchDirectoryResponse;
var t=new Array();
if(e.domain&&e.domain.length>0){
for(var n=0;
n<e.domain.length;
n++){
var s=e.domain[n].name;
t.push(s)
}}
this._batchSearchforDomain(t,h.searchQueryList,h.childQueries,h.offset,h.limit)
}}
catch(o){
this._handleException(o,"ZaListView.searchAliasDomainCallback",null,false)
}};
ZaListView.prototype._batchSearchforDomain=function(p,u,t,n,o){
var l;
var c=ZaSearch.ALIASES;
var f="(uid=*";
if(!t){
f+=")"
}else{
if(t&&!(t instanceof Array)){
f+=t+"*)"
}else{
if(t instanceof Array&&t.length==1){
f+=t[0]+"*)"
}else{
if(t instanceof Array&&t.length>1){
f+=t[1]+")"
}}}}
var h=ZaApp.getInstance().getSearchListController();
if(u&&u instanceof Array){
l=u
}else{
l=new Array()
}
var r=Dwt.getNextId();
var e={
limit:h.RESULTSPERPAGE,show:true,openInSearchTab:true,busyId:r};
var m=new AjxCallback(this,this.searchCallback,e);
for(var s=0;
s<p.length;
s++){
var d={
offset:n,limit:o,query:f,types:c,showBusy:true,busyId:r,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false,sortBy:h._currentSortField,attrs:ZaSearch.standardAttributes,callback:m,controller:h,domain:p[s]};
l.push(d)
}
this.multipleSearchCallback(e,l)
};
ZaListView.prototype.multipleSearchCallback=function(n,y){
var w,O,c,t,D,x;
var s=null;
if(!y){
return
}
if(y instanceof Array&&y.length>0){
s=y
}else{
s=new Array();
s.push(y)
}
x=s.length;
D=AjxSoapDoc.create("BatchRequest","urn:zimbra");
D.setMethodAttribute("onerror","continue");
for(var z=0;
z<x;
z++){
var o=D.set("SearchDirectoryRequest",null,null,ZaZimbraAdmin.URN);
var d=D.set("query",s[z].query,o);
w=(s[z].sortBy!=undefined)?s[z].sortBy:ZaAccount.A_name;
O=(s[z].limit!=undefined)?s[z].limit:ZaAccount.RESULTSPERPAGE;
c=(s[z].offset!=undefined)?s[z].offset:"0";
t=(s[z].sortAscending!=null)?s[z].sortAscending:"1";
o.setAttribute("offset",c);
o.setAttribute("limit",O);
o.setAttribute("sortBy",w);
o.setAttribute("sortAscending",t);
if(s[z].applyCos){
o.setAttribute("applyCos",s[z].applyCos)
}else{
o.setAttribute("applyCos",false)
}
if(s[z].applyConfig){
o.setAttribute("applyConfig",s[z].applyConfig)
}else{
o.setAttribute("applyConfig","false")
}
if(s[z].domain){
o.setAttribute("domain",s[z].domain)
}
if(s[z].attrs&&s[z].attrs.length>0){
o.setAttribute("attrs",s[z].attrs.toString())
}
if(s[z].types&&s[z].types.length>0){
o.setAttribute("types",s[z].types.toString())
}
if(s[z].maxResults){
o.setAttribute("maxResults",s[z].maxResults.toString())
}}
var B=new Object();
B.soapDoc=D;
var r={
busyMsg:ZaMsg.BUSY_REQUESTING_ACCESS_RIGHTS};
var C=ZaRequestMgr.invoke(B,r);
if(C.isException&&C.isException()){
ZaApp.getInstance().getCurrentController()._handleException(C.getException(),"ZaListViewController.prototype.multipleSearchCallback",null,false)
}else{
if(C.Body.BatchResponse.Fault){
var u=C.Body.BatchResponse.Fault;
if(u instanceof Array){
u=u[0]
}
if(u){
var T=ZmCsfeCommand.faultToEx(u);
ZaApp.getInstance().getCurrentController()._handleException(T,"ZaListViewController.prototype.multipleSearchCallback",null,false)
}}else{
var v=C.Body.BatchResponse;
if(v.SearchDirectoryResponse&&v.SearchDirectoryResponse instanceof Array){
var e=v.SearchDirectoryResponse.length;
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
var l=null;
var W=false;
var g=0;
for(var z=0;
z<e;
z++){
var b=v.SearchDirectoryResponse[z];
var f=new ZaItemList(n.CONS);
f.loadFromJS(b);
if(!l){
l=f
}else{
if(l instanceof ZaItemList&&f.size()>0){
var m=f.getVector();
for(var k=0;
k<m.size();
k++){
var A=m.get(k);
if(!l.getVector().contains(A)){
l.add(A)
}}}}
g+=(b.searchTotal?b.searchTotal:0);
W=b.more|W
}
if(l){
var p=new Array();
var x=l.getArray().length;
for(var h=0;
h<x;
h++){
var q=false;
for(var z=0;
z<this._list.size();
z++){
if(this._list.get(z).id==l.getArray()[h].id){
q=true;
break
}}
if(!q){
p.push(l.getArray()[h])
}}}
this.replenish(AjxVector.fromArray(p));
this.setScrollHasMore(W);
if(this.scrollSearchParams&&this.scrollSearchParams.postCallback){
this.scrollSearchParams.postCallback.run(g,W,this.getList())
}}}}};
ZaListView.prototype._loadMsg=function(n){
var o=Dwt.getNextId();
var r=new AjxCallback(this,this.searchCallback,{
CONS:null,busyId:o}
);
var t=this.scrollSearchParams;
t.offset=n.offset;
t.limit=n.limit;
t.callback=r;
t.busyId=o;
if(t&&t.scrollType=="isAliasSearch"){
var s=new Array();
s.push(t);
var e=ZaListView._getSearchKeyWord(t.query);
this.searchAliasDomain(e,t.controller,s,n.offset,n.limit)
}else{
ZaSearch.searchDirectory(t)
}};
ZaListView.prototype.searchCallback=function(o,n){
try{
if(o.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,o.busyId)
}
if(!n&&!this._currentRequest.cancelled){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListView.prototype.searchCallback"))
}
if(n&&n.isException()&&!this._currentRequest.cancelled){
ZaSearch.handleTooManyResultsException(n.getException(),"ZaListView.prototype.searchCallback")
}else{
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
var u=new ZaItemList(o.CONS);
var m=new ZaItemList(o.CONS);
var p=false;
if(n&&!n.isException()){
var s=n.getResponse().Body.SearchDirectoryResponse;
u.loadFromJS(s);
if(o.resultFilter&&u.size()>0){
var g=u.getVector();
for(var h=0;
h<g.size();
h++){
var y=g.get(h);
var c=null;
if(y.type==ZaItem.ALIAS){
c=y.getAliasTargetObj()
}else{
c=y
}
for(var l in o.resultFilter){
if(c.attrs[l].indexOf(o.resultFilter[l])>=0){
m.add(y);
break
}}}}else{
m=u
}
p=s.more
}
if(m){
var r=new Array();
var e=m.getArray().length;
for(var t=0;
t<e;
t++){
r.push(m.getArray()[t])
}
this.replenish(AjxVector.fromArray(r));
this.setScrollHasMore(p);
if(this.scrollSearchParams&&this.scrollSearchParams.postCallback){
this.scrollSearchParams.postCallback.run(s.searchTotal,s.more,this.getList())
}}}}
catch(d){
if(d.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
this._handleException(d,"ZaListView.prototype.searchCallback")
}else{
this.popupErrorDialog(ZaMsg.queryParseError,d);
if(this._searchField){
this._searchField.setEnabled(true)
}}}};
ZaListView.handleScroll=function(e){
var t=DwtUiEvent.getTarget(e);
var o=DwtControl.findControl(t);
if(o){
o._checkItemCount()
}};
ZaListView.prototype._checkItemCount=function(){
var e=this._getItemsNeeded();
if(e){
this.setScrollHasMore(false);
var t={
offset:this._list.size(),limit:e};
this._loadMsg(t)
}};
ZaListView.prototype._getItemsNeeded=function(o){
if(!o){
if(!this.scrollHasMore||!this._list){
return 0
}}
this._setRowHeight();
if(!this._rowHeight){
return 0
}
var e=new AjxCallback(null,AjxTimedAction.scheduleAction,[new AjxTimedAction(this,this._resetColWidth),10]);
var t={
scrollDiv:this._getScrollDiv(),rowHeight:this._rowHeight,threshold:this.getPagelessThreshold(),limit:this.getLimit(1),listSize:this._list.size(),sbCallback:e};
return ZaListView.getRowsNeeded(t)
};
ZaListView.getRowsNeeded=function(o){
var t=o.scrollDiv;
var s=t.scrollHeight,d=t.scrollTop,l=o.rowHeight;
var n=t.clientHeight||Dwt.getSize(t).y;
var r=n+(o.threshold*l);
var e=s-d;
if(e==n){
e=(o.listSize*l)-d;
if(d==0&&o.sbCallback){
o.sbCallback.run()
}}
var c=0;
if(e<r){
c=Math.max(Math.floor((r-e)/l),o.limit)
}
return c
};
ZaListView.prototype.getLimit=function(t){
var e=ZaSettings.RESULTSPERPAGE;
return t?e:2*e
};
ZaListView.prototype.getPagelessThreshold=function(){
return Math.ceil(this.getLimit()/5)
};
ZaListView.prototype.setHeaderList=function(e){
this._headerList=e;
this.headerColCreated=false
};
ZaListHeaderItem=function(n,h,t,o,l,e,s,r){
DwtListHeaderItem.call(this,{
field:n,text:h,icon:t,width:o,sortable:l,resizeable:s,visible:r}
);
this._sortField=e;
this._initialized=false
};
ZaListHeaderItem.prototype=new DwtListHeaderItem;
ZaListHeaderItem.prototype.constructor=ZaListHeaderItem;
ZaListHeaderItem.prototype.getSortField=function(){
return this._sortField
};
ZaListHeaderItem.prototype.getLabel=function(){
return this._label
};
ZaListView._handleColHeaderResize=function(r){
if(!this._headerSash){
this._headerSash=document.createElement("div");
var e=Dwt.getSize(this._listColDiv).y;
var h=this.getSize().y;
var n=h-4;
Dwt.setSize(this._headerSash,Dwt.DEFAULT,n);
Dwt.setPosition(this._headerSash,Dwt.ABSOLUTE_STYLE);
Dwt.setZIndex(this._headerSash,Dwt.Z_DND);
Dwt.setPosition(this._listDiv,Dwt.RELATIVE_STYLE);
Dwt.setLocation(this._listDiv,0,0);
this._headerSash.className="DwtListView-ColumnSash";
this._listDiv.appendChild(this._headerSash);
var o=-e;
Dwt.setLocation(this._headerSash,Dwt.DEFAULT,o);
this._headerSashX=r.docX
}
var t=Dwt.getLocation(this._listDiv).x;
var s=r.docX-t;
Dwt.setLocation(this._headerSash,s)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaToolBar")){
ZaToolBar=function(s,r,e,n,o,t){
if(arguments.length==0){
return
}
o=o||"ZaToolBar";
n=n||DwtControl.ABSOLUTE_STYLE;
this._barViewId=t;
DwtToolBar.call(this,{
parent:s,className:o,posStyle:n,id:ZaId.getToolbarId(this._barViewId)}
);
this._opList=r;
this._btnOrder=e;
this._buttons=new Object();
this.addMoreActions();
this._btnList=new Array();
this.init()
};
ZaToolBar.VIEW_DATA="ZaToolBar.VIEW";
ZaToolBar.prototype=new DwtToolBar;
ZaToolBar.prototype.constructor=ZaToolBar;
ZaToolBar.prototype.toString=function(){
return"ZaToolBar"
};
ZaToolBar.prototype.init=function(){
var n=this._opList;
var t=this._btnOrder;
if(!AjxUtil.isEmpty(t)&&n){
var o=t.length;
for(var e=0;
e<o;
e++){
if(n[t[e]]&&n[t[e]] instanceof ZaOperation){
if(n[t[e]].id==ZaOperation.SEP){
this._createSeparator()
}else{
if(n[t[e]].id==ZaOperation.LEFT_BRACKET){
this._createLeftBracket()
}else{
if(n[t[e]].id==ZaOperation.RIGHT_BRACKET){
this._createRightBracket()
}else{
if(n[t[e]].id==ZaOperation.NONE){
this.addFiller()
}else{
if(n[t[e]].id==ZaOperation.LABEL){
this._createLabel(n[t[e]].labelId,n[t[e]].imageId,n[t[e]].caption,n[t[e]].disImageId,n[t[e]].tt,true,n[t[e]].className)
}else{
this._createButton(n[t[e]].id,n[t[e]].imageId,n[t[e]].caption,n[t[e]].disImageId,n[t[e]].tt,true,n[t[e]].className,n[t[e]].type,n[t[e]].menuOpList);
if(n[t[e]].listener){
this.addSelectionListener(n[t[e]].id,n[t[e]].listener)
}}}}}}}}}else{
if(n){
for(var e in n){
if(n[e] instanceof ZaOperation){
if(n[e].id==ZaOperation.SEP){
this._createSeparator()
}else{
if(n[e].id==ZaOperation.LEFT_BRACKET){
this._createLeftBracket()
}else{
if(n[e].id==ZaOperation.RIGHT_BRACKET){
this._createRightBracket()
}else{
if(n[e].id==ZaOperation.NONE){
this.addFiller()
}else{
if(n[e].id==ZaOperation.LABEL){
this._createLabel(n[e].labelId,n[e].imageId,n[e].caption,n[e].disImageId,n[e].tt,true,n[e].className)
}else{
this._createButton(n[e].id,n[e].imageId,n[e].caption,n[e].disImageId,n[e].tt,true,n[e].className,n[e].type,n[e].menuOpList);
this.addSelectionListener(n[e].id,n[e].listener)
}}}}}}}}}};
ZaToolBar.prototype.addSelectionListener=function(e,t){
this._buttons[e].addSelectionListener(t)
};
ZaToolBar.prototype.removeSelectionListener=function(e,t){
this._buttons[e].removeSelectionListener(t)
};
ZaToolBar.prototype.getButton=function(e){
return this._buttons[e]
};
ZaToolBar.prototype.setData=function(t,e,o){
this._buttons[t].setData(e,o)
};
ZaToolBar.prototype.enable=function(o,e){
if(!(o instanceof Array)){
o=[o]
}
for(var t=0;
t<o.length;
t++){
if(this._buttons[o[t]]){
this._buttons[o[t]].setEnabled(e)
}}};
ZaToolBar.prototype.enableAll=function(e){
for(var t in this._buttons){
this._buttons[t].setEnabled(e)
}};
ZaToolBar.prototype.computeHeight=function(e){
var o=0;
for(var t in this._buttons){
o=Math.max(o,this._buttons[t].getSize().y)
}
return o
};
ZaToolBar.prototype.setSize=function(t,e){
var o=this.getSize();
if(t!=o.x||e!=o.y){
DwtToolBar.prototype.setSize.apply(this,arguments);
this._checkSize(t,e)
}};
ZaToolBar.prototype._checkSize=function(t,p,c,e){
var c=c||false;
var e=e||true;
var m=this._buttons[ZaOperation.MORE_ACTIONS];
var o=this.getHtmlElement();
if(!o){
return
}
for(var l in this._buttons){
var d=this._buttons[l];
if(!d){
continue
}
if(d._toggleText){
d.setText(d._toggleText);
d._toggleText=null
}
if(d==m){
d.setVisible(false)
}else{
d.setVisible(true)
}}
var h=o.firstChild.offsetWidth;
if(h>t){
var g=this.getAlwaysVisibleButtonWidths();
if(e){
m.setVisible(true);
g+=m.getW()
}
var r=null;
if(!AjxUtil.isEmpty(this._btnOrder)){
r=this._btnOrder
}else{
r=this._btnList
}
var n=r.length;
for(var s=0;
s<n;
s++){
var d=this._buttons[r[s]];
if(!d||!d.getVisible()){
continue
}
var f=d.getText();
if(f&&c){
d._toggleText=f;
d.setText("")
}
if(e){
var u=d.getW();
g+=u;
if(g>=t){
if(d!=m){
d.setVisible(false)
}else{
break
}}}
h=o.firstChild.offsetWidth;
if(h<=t){
break
}}}
this.enableMoreActionsMenuItems()
};
ZaToolBar.prototype._createButton=function(s,o,u,d,e,r,h,l,n){
if(!h){
h="DwtToolbarButton"
}
var c=this._buttons[s]=new ZaToolBarButton({
parent:this,className:h,id:ZaId.getButtonId(this._barViewId,ZaOperation.getStringName(s))}
);
if(o){
c.setImage(o)
}
if(u){
c.setText(u)
}
if(e){
c.setToolTipContent(e)
}
c.setEnabled((r)?true:false);
c.setData("_buttonId",s);
if(l==ZaOperation.TYPE_MENU){
var t=new ZaPopupMenu(c,null,null,n,this._barViewId,ZaId.MENU_DROP);
c.setMenu(t,true)
}
this._btnList.push(s);
return c
};
ZaToolBar.prototype._createLabel=function(n,o,c,l,e,s,r,t){
var h=this._buttons[n]=new ZaToolBarLabel(this,null,r);
if(o){
h.setImage(o)
}
if(c){
h.setText(c)
}
if(e){
h.setToolTipContent(e)
}
h.setEnabled((s)?true:false);
h.setData("_buttonId",n);
return h
};
ZaToolBar.prototype._createSeparator=function(){
var t=new DwtControl(this);
var e=ZaToolBar.getSeparatorHtml();
t.setContent(e)
};
ZaToolBar.getSeparatorHtml=function(){
return'<div class="vertSep"/>'
};
ZaToolBar.prototype._createLeftBracket=function(){
var t=new DwtControl(this);
var e=ZaToolBar.getLeftBracketHtml();
t.setContent(e)
};
ZaToolBar.getLeftBracketHtml=function(){
return'<div class="ZaLeftBracket"/>'
};
ZaToolBar.prototype._createRightBracket=function(){
var t=new DwtControl(this);
var e=ZaToolBar.getRightBracketHtml();
t.setContent(e)
};
ZaToolBar.getRightBracketHtml=function(){
return'<div class="ZaRightBracket"/>'
};
ZaToolBar.prototype._buttonId=function(e){
return e.getData("_buttonId")
};
ZaToolBar.prototype.addMoreActions=function(){
if(AjxUtil.isEmpty(this._btnOrder)||AjxUtil.isEmpty(this._opList)){
return
}
this._moreActionsMenuList=[];
var e=-1;
for(var t=0;
t<this._btnOrder.length;
t++){
if(this._btnOrder[t]==ZaOperation.NONE){
e=t;
break
}else{
if(this._btnOrder[t]==ZaOperation.SEP||this._btnOrder[t]==ZaOperation.LEFT_BRACKET||this._btnOrder[t]==ZaOperation.RIGHT_BRACKET){
continue
}else{
var o=this._opList[this._btnOrder[t]];
if(o!=null){
this._moreActionsMenuList.push(ZaOperation.duplicate(o))
}}}}
this._opList[ZaOperation.MORE_ACTIONS]=new ZaOperation(ZaOperation.MORE_ACTIONS,ZaMsg.TBB_MoreActions,ZaMsg.TBB_MoreActions_tt,"","",new AjxListener(this,this._moreActionsButtonListener),ZaOperation.TYPE_MENU,this._moreActionsMenuList);
this._opList[ZaOperation.MORE_ACTIONS].enabled=false;
this._opList[ZaOperation.MORE_ACTIONS].visible=false;
if(e==-1){
e=this._btnOrder.length
}
this._btnOrder.splice(e,0,ZaOperation.MORE_ACTIONS)
};
ZaToolBar.prototype.getAlwaysVisibleButtonWidths=function(){
var o=0;
var t=false;
for(var n=0;
n<this._btnOrder.length;
n++){
var e=this._buttons[this._btnOrder[n]];
if(this._btnOrder[n]==ZaOperation.NONE){
t=true
}
if(this._btnOrder[n]==ZaOperation.LABEL){
e=this._buttons[ZaOperation.SEARCH_RESULT_COUNT]
}
if(t){
if(this._btnOrder[n]==ZaOperation.SEP){
o+=5
}
if(this._btnOrder[n]==ZaOperation.LEFT_BRACKET){
o+=7
}
if(this._btnOrder[n]==ZaOperation.RIGHT_BRACKET){
o+=7
}
if(e&&e.getVisible()){
o+=e.getW()
}}}
return o
};
ZaToolBar.prototype.enableMoreActionsMenuItems=function(){
var o=this._buttons[ZaOperation.MORE_ACTIONS];
var h;
if(o){
h=o.getMenu();
h.popdown()
}
if(o&&o.getVisible()){
for(var s=0;
s<this._btnOrder.length;
s++){
var t=this._btnOrder[s];
if(this._btnOrder[s]==ZaOperation.MORE_ACTIONS){
break
}
var n=this._buttons[t];
if(!n){
continue
}
var e=n.getVisible();
var r=h.getMenuItem(t);
if(r!=null&&r!=undefined){
r.setVisible(!e);
r.setEnabled(n.getEnabled())
}}}};
ZaToolBar.prototype._moreActionsButtonListener=function(t){
var e=this._buttons[ZaOperation.MORE_ACTIONS];
var o;
if(e){
o=e.getMenu();
if(o.isPoppedUp()){
o.popdown()
}else{
e.popup()
}}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaToolBarLabel")){
ZaToolBarLabel=function(s,n,o,t,r,e){
if(arguments.length==0){
return
}
DwtLabel.call(this,s,n,o,t,r,e)
};
ZaToolBarLabel.prototype=new DwtLabel;
ZaToolBarLabel.prototype.constructor=ZaToolBarLabel;
ZaToolBarLabel.prototype._createHtmlFromTemplate=function(e,t){
DwtLabel.prototype._createHtmlFromTemplate.call(this,"admin.Widgets#ZaToolBarLabel",t)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaToolBarButton")){
ZaToolBarButton=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,ZaToolBarButton.PARAMS);
e.className=e.className||"ZaToolBarButton";
DwtButton.call(this,e)
};
ZaToolBarButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index"];
ZaToolBarButton.prototype=new DwtButton;
ZaToolBarButton.prototype.constructor=DwtButton;
ZaToolBarButton.prototype._createHtml=function(){
var e="dwt.Widgets#ZToolbarButton";
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e,t)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaOverviewPanel")){
ZaOverviewPanel=function(e){
if(arguments.length==0){
return
}
this.overviewId=e.id;
e.id=ZaId.getOverviewId(ZaId.PANEL_APP);
e=Dwt.getParams(arguments,ZaOverviewPanel.PARAMS);
e.className=e.className||"ZaOverviewPanel";
DwtComposite.call(this,e);
this.addControlListener(new AjxListener(this,this._panelControlListener));
this._createFolderTree();
this._layout()
};
ZaOverviewPanel.PARAMS=["parent","className","posStyle","id"];
ZaOverviewPanel.prototype=new DwtComposite();
ZaOverviewPanel.constructor=ZaOverviewPanel;
ZaOverviewPanel._MIN_FOLDERTREE_SIZE=100;
ZaOverviewPanel.prototype.toString=function(){
return"ZaOverviewPanel"
};
ZaOverviewPanel.prototype.getFolderTree=function(){
return this._tree
};
ZaOverviewPanel.prototype._createFolderTree=function(){
this._treePanel=new DwtComposite({
parent:this,className:"OverviewTreePanel",posStyle:DwtControl.RELATIVE_STYLE,id:ZaId.getTreeId(this.overviewId,this.type)}
);
this._treePanel.setScrollStyle(Dwt.SCROLL_Y);
this._tree=new ZaTree({
parent:this._treePanel,style:DwtTree.SINGLE_STYLE,className:"OverviewTree",posStyle:DwtControl.ABSOLUTE_STYLE,id:ZaId.getTreeId(this.overviewId,DwtTree.SINGLE_STYLE)}
)
};
ZaOverviewPanel.prototype._layout=function(){
var o=this.getSize();
var t=o.y;
var e=o.x;
this._treePanel.setBounds(0,0,e,t)
};
ZaOverviewPanel.prototype._panelControlListener=function(e){
this._layout()
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaClientCmdHandler")){
ZaClientCmdHandler=function(){
this._settings=new Object()
};
ZaClientCmdHandler.prototype.execute=function(e){
if(e[0]&&e[0].toLowerCase()=="debug"){
if(!e[1]){
return
}
if(e[1]=="t"){
var t=DBG._showTiming;
var o=t?"off":"on";
alert("Turning debug timing info "+o)
}else{
var n=e[1];
if(n){
alert("Setting Debug to level:"+n)
}else{
alert("Invalid debug level")
}}}else{
if(e[0]&&e[0].toLowerCase()=="domainsrch"){
ZaDomain.MAXSEARCHRESULTS=e[1];
alert("Setting domain search limit to:"+e[1]);
ZaApp.getInstance().searchDomains()
}else{
if(e[0]&&e[0].toLowerCase()=="pagesize"){
ZaSettings.RESULTSPERPAGE=e[1];
alert("Setting page size to:"+e[1])
}}}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaApp")){
ZaApp=function(t,e){
if(arguments.length==0){
return
}
this._name=ZaZimbraAdmin.ADMIN_APP;
this._appCtxt=t;
this._appViewMgr=t.getAppViewMgr();
this._container=e;
this._currentController=null;
this._currentViewId=null;
this._cosListChoices=null;
this._domainListChoices=null;
this._serverChoices=null;
this._serverIdChoices=null;
this._serverMap=null;
this._controllers=new Object();
this.dialogs={};
this._tabGroup=null
};
ZaApp.instance=null;
ZaApp.getInstance=function(t,e){
if(!ZaApp.instance){
if(!AjxUtil.isEmpty(t)&&!AjxUtil.isEmpty(e)){
ZaApp.instance=new ZaApp(t,e)
}}
return ZaApp.instance
};
ZaApp.prototype.constructor=ZaApp;
ZaApp.prototype.toString=function(){
return"ZaApp"
};
ZaApp.checkMyRight=function(e,c,l,y,b){
var g=AjxSoapDoc.create("CheckRightRequest",ZaZimbraAdmin.URN,null);
var h=g.set("grantee",ZaZimbraAdmin.currentUserId);
h.setAttribute("by","id");
var t=g.set("target",l);
t.setAttribute("type",e);
t.setAttribute("by",c);
var p=g.set("right",y);
var n=b.length;
if(n>0){
var f=g.set("attrs","");
for(var d=0;
d<n;
d++){
var u=g.set("a",b[d].val,f);
u.setAttribute("n",b[d].n)
}}
var r=new Object();
r.soapDoc=g;
var o={};
o.controller=ZaApp.getInstance().getCurrentController();
o.busyMsg=ZaMsg.BUSY_REQUESTING_ACCESS_RIGHTS;
try{
var s=ZaRequestMgr.invoke(r,o).Body.CheckRightResponse;
return s
}
catch(m){}};
ZaApp.prototype.initDialogs=function(){
this.dialogs.errorDialog=this._appCtxt.getErrorDialog(true);
this.dialogs.msgDialog=this._appCtxt.getMsgDialog(true);
this.dialogs.confirmMessageDialog=this._appCtxt.getConfirmMsgDialog(true);
this.dialogs.confirmMessageDialog2=this._appCtxt.getConfirmMsgDialog2(true)
};
ZaApp.prototype.getDomainAliasWizard=function(t){
var e;
if(t){
e=this.dialogs.editDomainAliasWizard=new ZaDomainAliasEditWizard(this._container,"400px","80px",ZaMsg.Title_Edit_domain_alias)
}else{
e=this.dialogs.newDomainAliasWizard=new ZaDomainAliasWizard(this._container,"400px","80px",ZaMsg.Title_Create_domain_alias)
}
return e
};
ZaApp.prototype.launch=function(n){
if(ZaSettings.DASHBOARD_VIEW&&ZaApp.prototype.getDashBoardController){
var s=ZaApp.getInstance().getDashBoardController(ZaSettings.DASHBOARD_VIEW);
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(s,ZaDashBoardController.prototype.show,true)
}else{
s.show(true)
}}else{
var e=this._appCtxt.getAppController().getOverviewPanelController();
var o=ZaTree.getPathByArray([ZaMsg.OVP_home]);
e.getOverviewPanel().getFolderTree().setSelectionByPath(o);
var t=new ZaHistory(o,ZaMsg.OVP_home);
ZaZimbraAdmin.getInstance().updateHistory(t,true)
}
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsDelegatedAdminAccount]==="TRUE"){
this.getDomainList(false,{
limit:25,asyncMode:true}
)
}};
ZaApp.prototype.getAppCtxt=function(){
return this._appCtxt
};
ZaApp.prototype.getCurrentController=function(){
var e=this._appViewMgr.getCurrentView();
return this._controllers[e]
};
ZaApp.prototype.getControllerById=function(e){
return this._controllers[e]
};
ZaApp.prototype.getStatusViewController=function(e){
if(!e){
e=ZaZimbraAdmin._STATUS
}
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaStatusViewController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.getServerStatsController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaServerStatsController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.getGlobalStatsController=function(e){
if(!e){
e=ZaZimbraAdmin._STATISTICS
}
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaGlobalStatsController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.getServerStatsListController=function(e){
if(!e){
e=ZaZimbraAdmin._SERVER_LIST_FOR_STATISTICS_VIEW
}
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaServerStatsListController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.getGlobalConfigViewController=function(e){
if(!e){
e=ZaZimbraAdmin._GLOBAL_SETTINGS
}
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaGlobalConfigViewController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.getSearchListController=function(){
if(this._controllers[ZaZimbraAdmin._SEARCH_LIST_VIEW]==null){
this._controllers[ZaZimbraAdmin._SEARCH_LIST_VIEW]=new ZaSearchListController(this._appCtxt,this._container);
this._controllers[ZaZimbraAdmin._SEARCH_LIST_VIEW].addRemovalListener(new AjxListener(this.getSearchListController(),this.getSearchListController().handleRemoval))
}
return this._controllers[ZaZimbraAdmin._SEARCH_LIST_VIEW]
};
ZaApp.prototype.getSearchBuilderController=function(){
if(this._controllers[ZaZimbraAdmin._SEARCH_BUILDER_VIEW]==null){
this._controllers[ZaZimbraAdmin._SEARCH_BUILDER_VIEW]=new ZaSearchBuilderController(this._appCtxt,this._container);
this._controllers[ZaZimbraAdmin._SEARCH_BUILDER_VIEW].addRemovalListener(new AjxListener(this.getSearchBuilderController(),this.getSearchBuilderController().handleRemoval))
}
return this._controllers[ZaZimbraAdmin._SEARCH_BUILDER_VIEW]
};
ZaApp.prototype.getSearchBuilderToolbarController=ZaApp.prototype.getSearchBuilderController;
ZaApp.prototype.getAccountListController=function(e,t){
if(!e){
e=ZaZimbraAdmin._ACCOUNTS_LIST_VIEW
}
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
if(e||t){
var o=this._controllers[e]=new ZaAccountListController(this._appCtxt,this._container,this);
o.addRemovalListener(new AjxListener(o,o.handleRemoval));
o.addCreationListener(new AjxListener(o,o.handleCreation));
return o
}}};
ZaApp.prototype.getAccountViewController=function(t){
var o=new ZaAccountViewController(this._appCtxt,this._container,this);
var e=ZaZimbraAdmin._ACCOUNTS_LIST_VIEW;
if(t){
e=ZaZimbraAdmin._ALIASES_LIST_VIEW
}
o.addChangeListener(new AjxListener(this.getAccountListController(e),ZaAccountListController.prototype.handleChange));
o.addCreationListener(new AjxListener(this.getAccountListController(e),ZaAccountListController.prototype.handleCreation));
o.addRemovalListener(new AjxListener(this.getAccountListController(e),ZaAccountListController.prototype.handleRemoval));
return o
};
ZaApp.prototype.getAdminExtListController=function(){
if(this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW]==null){
this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW]=new ZaAdminExtListController(this._appCtxt,this._container,this);
this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW].addRemovalListener(new AjxListener(this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW],this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW].handleRemoval));
this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW].addCreationListener(new AjxListener(this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW],this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW].handleCreation));
this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW].addChangeListener(new AjxListener(this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW],this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW].handleChange))
}
return this._controllers[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW]
};
ZaApp.prototype.getZimletListController=function(){
if(this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW]==null){
this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW]=new ZaZimletListController(this._appCtxt,this._container,this);
this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW].addRemovalListener(new AjxListener(this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW],this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW].handleRemoval));
this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW].addCreationListener(new AjxListener(this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW],this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW].handleCreation));
this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW].addChangeListener(new AjxListener(this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW],this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW].handleChange))
}
return this._controllers[ZaZimbraAdmin._ZIMLET_LIST_VIEW]
};
ZaApp.prototype.getZimletController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=new ZaZimletViewController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.getDistributionListController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=new ZaDLController(this._appCtxt,this._container,this);
t.addCreationListener(new AjxListener(this.getAccountListController(ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW),ZaAccountListController.prototype.handleCreation));
t.addRemovalListener(new AjxListener(this.getAccountListController(ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW),ZaAccountListController.prototype.handleRemoval));
t.addChangeListener(new AjxListener(this.getAccountListController(ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW),ZaAccountListController.prototype.handleChange));
return t
}};
ZaApp.prototype.getResourceController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=new ZaResourceController(this._appCtxt,this._container,this);
t.addCreationListener(new AjxListener(this.getAccountListController(ZaZimbraAdmin._RESOURCE_LIST_VIEW),ZaAccountListController.prototype.handleCreation));
t.addRemovalListener(new AjxListener(this.getAccountListController(ZaZimbraAdmin._RESOURCE_LIST_VIEW),ZaAccountListController.prototype.handleRemoval));
t.addChangeListener(new AjxListener(this.getAccountListController(ZaZimbraAdmin._RESOURCE_LIST_VIEW),ZaAccountListController.prototype.handleChange));
return t
}};
ZaApp.prototype.getDomainListController=function(e,t){
if(!e){
e=ZaZimbraAdmin._DOMAINS_LIST_VIEW
}
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
if(e||t){
var o=this._controllers[e]=new ZaDomainListController(this._appCtxt,this._container,this);
o.addCreationListener(new AjxListener(this,ZaApp.prototype.handleDomainCreation));
o.addRemovalListener(new AjxListener(this,ZaApp.prototype.handleDomainRemoval));
o.addChangeListener(new AjxListener(this.getDomainListController(),ZaDomainListController.prototype.handleDomainChange));
o.addRemovalListener(new AjxListener(this.getDomainListController(),o.handleRemoval));
return o
}}};
ZaApp.prototype.getDomainController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaDomainController(this._appCtxt,this._container,this);
t.addChangeListener(new AjxListener(this.getDomainListController(),ZaDomainListController.prototype.handleDomainChange));
t.addChangeListener(new AjxListener(t,ZaDomainController.prototype.handleDomainChange));
t.addCreationListener(new AjxListener(this,ZaApp.prototype.handleDomainCreation));
t.addCreationListener(new AjxListener(this.getDomainListController(),ZaDomainListController.prototype.handleCreation));
t.addRemovalListener(new AjxListener(this.getDomainListController(),this.getDomainListController().handleRemoval));
t.addRemovalListener(new AjxListener(this,ZaApp.prototype.handleDomainRemoval));
return t
}};
ZaApp.prototype.getMTAListController=function(){
if(this._controllers[ZaZimbraAdmin._POSTQ_VIEW]==null){
this._controllers[ZaZimbraAdmin._POSTQ_VIEW]=new ZaMTAListController(this._appCtxt,this._container,this)
}
return this._controllers[ZaZimbraAdmin._POSTQ_VIEW]
};
ZaApp.prototype.getMTAController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaMTAController(this._appCtxt,this._container,this);
t.addChangeListener(new AjxListener(this.getMTAListController(),ZaMTAListController.prototype.handleMTAChange));
t.addChangeListener(new AjxListener(t,ZaMTAController.prototype.handleMTAChange));
return t
}};
ZaApp.prototype.getServerListController=function(){
if(this._controllers[ZaZimbraAdmin._SERVERS_LIST_VIEW]==null){
this._controllers[ZaZimbraAdmin._SERVERS_LIST_VIEW]=new ZaServerListController(this._appCtxt,this._container,this)
}
return this._controllers[ZaZimbraAdmin._SERVERS_LIST_VIEW]
};
ZaApp.prototype.getServerController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaServerController(this._appCtxt,this._container,this);
t.addServerChangeListener(new AjxListener(this,ZaApp.prototype.handleServerChange));
t.addServerChangeListener(new AjxListener(this.getServerListController(),ZaServerListController.prototype.handleServerChange));
if(ZaSettings.TREE_ENABLED){
t.addServerChangeListener(new AjxListener(this._appCtxt.getAppController().getOverviewPanelController(),ZaOverviewPanelController.prototype.handleServerChange))
}
return t
}};
ZaApp.prototype.getCosListController=function(){
if(this._controllers[ZaZimbraAdmin._COS_LIST_VIEW]==null){
this._controllers[ZaZimbraAdmin._COS_LIST_VIEW]=new ZaCosListController(this._appCtxt,this._container,this);
this._controllers[ZaZimbraAdmin._COS_LIST_VIEW].addRemovalListener(new AjxListener(this,ZaApp.prototype.handleCosRemoval));
if(ZaSettings.TREE_ENABLED){
this._controllers[ZaZimbraAdmin._COS_LIST_VIEW].addRemovalListener(new AjxListener(this._appCtxt.getAppController().getOverviewPanelController(),ZaOverviewPanelController.prototype.handleCosRemoval))
}}
return this._controllers[ZaZimbraAdmin._COS_LIST_VIEW]
};
ZaApp.prototype.getCosController=function(){
var e=new ZaCosController(this._appCtxt,this._container,this);
e.addChangeListener(new AjxListener(this.getCosListController(),ZaCosListController.prototype.handleChange));
if(ZaSettings.TREE_ENABLED){
e.addChangeListener(new AjxListener(this._appCtxt.getAppController().getOverviewPanelController(),ZaOverviewPanelController.prototype.handleCosChange))
}
e.addCreationListener(new AjxListener(this.getCosListController(),ZaCosListController.prototype.handleCreation));
if(ZaSettings.TREE_ENABLED){
e.addCreationListener(new AjxListener(this._appCtxt.getAppController().getOverviewPanelController(),ZaOverviewPanelController.prototype.handleCosCreation))
}
e.addRemovalListener(new AjxListener(this,ZaApp.prototype.handleCosRemoval));
e.addRemovalListener(new AjxListener(this.getCosListController(),ZaCosListController.prototype.handleRemoval));
if(ZaSettings.TREE_ENABLED){
e.addRemovalListener(new AjxListener(this._appCtxt.getAppController().getOverviewPanelController(),ZaOverviewPanelController.prototype.handleCosRemoval))
}
return e
};
ZaApp.prototype.getHelpViewController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaHelpViewController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.getMigrationWizController=function(e){
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaMigrationWizController(this._appCtxt,this._container,this);
return t
}};
ZaApp.prototype.searchDomains=function(e){
var o=Dwt.getNextId();
var n=new AjxCallback(this,this.domainSearchCallback,{
busyId:o}
);
var t={
query:e,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,offset:"0",sortAscending:"1",limit:ZaDomain.MAXSEARCHRESULTS,callback:n,controller:this.getCurrentController(),showBusy:true,busyId:o,busyMsg:ZaMsg.BUSY_SEARCHING_DOMAINS,skipCallbackIfCancelled:false,attrs:[ZaDomain.A_description,ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus,ZaItem.A_zimbraId,ZaDomain.A_domainType]};
ZaSearch.searchDirectory(t)
};
ZaApp.prototype.scheduledSearchDomains=function(e){
var o=Dwt.getNextId();
var n=new AjxCallback(this,this.domainSearchCallback,{
domainItem:e,busyId:o}
);
var t={
query:this._domainQuery,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,offset:"0",sortAscending:"1",limit:ZaDomain.MAXSEARCHRESULTS,callback:n,controller:this.getCurrentController(),showBusy:true,busyId:o,busyMsg:ZaMsg.BUSY_SEARCHING_DOMAINS,skipCallbackIfCancelled:false,attrs:[ZaDomain.A_domainName,ZaItem.A_zimbraId]};
ZaSearch.searchDirectory(t)
};
ZaApp.prototype.domainSearchCallback=function(h,r){
var n=h.domainItem?h.domainItem:null;
try{
if(h.busyId){
this._appCtxt.getShell().setBusy(false,h.busyId)
}
if(!r){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListViewController.prototype.searchCallback"))
}
if(r.isException()){
ZaSearch.handleTooManyResultsException(r.getException(),"ZaApp.prototype.domainSearchCallback")
}else{
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
var e=r.getResponse().Body.SearchDirectoryResponse;
var s=new ZaItemList(ZaDomain);
s.loadFromJS(e);
if(ZaSettings.TREE_ENABLED){
this._appCtxt.getAppController().getOverviewPanelController().updateDomainList(s)
}
if(n!=null&&n instanceof XFormItem&&this._domainList.size()<=0){
n.setError(ZaMsg.ERROR_NO_SUCH_DOMAIN);
var o=new DwtXFormsEvent(this,n,n.getInstanceValue());
n.getForm().notifyListeners(DwtEvent.XFORMS_VALUE_ERROR,o)
}}}
catch(t){
if(t.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
this.getCurrentController()._handleException(t,"ZaApp.prototype.domainSearchCallback")
}else{
this.getCurrentController().popupErrorDialog(ZaMsg.queryParseError,t)
}}};
ZaApp.prototype.getDomainList=function(t,o){
if(t||this._domainList==null){
if(o&&o.asyncMode){
var e=this._getDomainListCallbackArray;
if(!e){
e=this._getDomainListCallbackArray=[]
}
e.push(o.callback);
if(e.length===1){
o.callback=this._getDomainListCallback.bind(this);
ZaDomain.getAll(false,o)
}}else{
this._domainList=ZaDomain.getAll()
}}
return this._domainList
};
ZaApp.prototype._getDomainListCallback=function(t){
this._domainList=t;
for(var e=0;
e<this._getDomainListCallbackArray.length;
e++){
if(this._getDomainListCallbackArray[e]){
this._getDomainListCallbackArray[e](t)
}}
this._getDomainListCallbackArray=[]
};
ZaApp.prototype.getSavedSearchList=function(e){
if(e||ZaSearch.SAVED_SEARCHES.length<=0){
if(ZaSearchField.canViewSavedSearch){
ZaSearch.updateSavedSearch(ZaSearch.getSavedSearches())
}}
return ZaSearch.SAVED_SEARCHES
};
ZaApp.prototype.getServerByName=function(n){
if(this._serverList==null){
this._serverList=ZaServer.getAll()
}
var t=this._serverList.getArray().length;
var o=new ZaServer(this);
for(var e=0;
e<t;
e++){
if(this._serverList.getArray()[e].attrs[ZaServer.A_ServiceHostname]==n){
return this._serverList.getArray()[e]
}}
if(e==t){
o.load("name",n)
}
return o
};
ZaApp.prototype.getServerList=function(s){
if(s||this._serverList==null){
this._serverList=ZaServer.getAll();
if(this._serverList){
var n=this._serverList.getArray();
this._mbsList=ZaItemList(ZaServer);
if(n){
var e=new Array();
var o=n.length;
for(var t=0;
t>o;
t++){
if(n[t].attrs[ZaServer.A_zimbraMailboxServiceInstalled]){
this._mbsList.add(n[t])
}}}}}
return this._serverList
};
ZaApp.prototype.getMbsList=function(e){
if(e||this._mbsList==null){
this._mbsList=ZaServer.getAllMBSs()
}
return this._mbsList
};
ZaApp.prototype.getPostQList=function(e,t){
if(e||this._postqList==null||t){
this._postqList=ZaMTA.getAll(t)
}
return this._postqList
};
ZaApp.prototype.getMailServers=function(s,r){
if(s||this._mbsList==null||r){
this._mbsList=ZaServer.getAllMBSs([ZaServer.A_ServiceHostname,ZaServer.A_description,ZaServer.A_zimbraServiceEnabled,ZaServer.A_zimbraServiceInstalled,ZaItem.A_zimbraId],r)
}
if(!r){
var e=new Array();
var n=this._mbsList.getArray();
var o=n.length;
for(var t=0;
t<o;
t++){
if(n[t].attrs[ZaServer.A_zimbraMailClientServiceEnabled]){
e.push(n[t])
}}
return e
}};
ZaApp.prototype.getServerListChoices=function(t){
if(t||this._serverList==null){
this._serverList=ZaServer.getAll()
}
if(t||this._serverChoices==null){
var n=this._serverList.getIdHash();
var o=[];
for(var e in n){
if(n[e].attrs[ZaServer.A_zimbraMailClientServiceEnabled]){
o.push(n[e])
}}
if(this._serverChoices==null){
this._serverChoices=new XFormChoices(o,XFormChoices.OBJECT_LIST,ZaServer.A_ServiceHostname,ZaServer.A_ServiceHostname)
}else{
this._serverChoices.setChoices(o);
this._serverChoices.dirtyChoices()
}}
return this._serverChoices
};
ZaApp.prototype.getServerIdListChoices=function(t){
if(t||this._serverList==null){
this._serverList=ZaServer.getAll()
}
if(t||this._serverIdChoices==null){
var s=this._serverList.getIdHash();
var o=[];
for(var e in s){
if(s[e].attrs[ZaServer.A_zimbraMailClientServiceEnabled]){
var n=new Object();
n[ZaServer.A_ServiceHostname]=s[e].attrs[ZaServer.A_ServiceHostname];
n.id=s[e].id;
o.push(n)
}}
if(this._serverIdChoices==null){
this._serverIdChoices=new XFormChoices(o,XFormChoices.OBJECT_LIST,"id",ZaServer.A_ServiceHostname)
}else{
this._serverIdChoices.setChoices(o);
this._serverIdChoices.dirtyChoices()
}}
return this._serverIdChoices
};
ZaApp.prototype.getServerMap=function(o){
if(o||this._serverList==null){
this._serverList=ZaServer.getAll()
}
if(o||this._serverMap==null){
this._serverMap=new Object();
var t=this._serverList.getArray().length;
for(var e=0;
e<t;
e++){
this._serverMap[this._serverList.getArray()[e].id]=this._serverList.getArray()[e]
}}
return this._serverMap
};
ZaApp.prototype.getCosList=function(n,h){
if(n||!this._cosList){
var s="";
if(!ZaZimbraAdmin.hasGlobalCOSSListAccess()){
var e=ZaApp.getInstance()._cosNameList;
if(AjxUtil.isEmpty(e)){
ZaApp.getInstance()._cosNameList=e=ZaCos.getEffectiveCosList(ZaZimbraAdmin.currentAdminAccount.id)
}
if(e.length==0){
this._cosList=new ZaItemList(ZaCos);
return this._cosList
}
for(var o=0;
o<e.length;
o++){
s+="("+ZaCos.A_name+"="+e[o]+")"
}
if(e.length>1){
s="(|"+s+")"
}}
var r={
query:s,types:[ZaSearch.COSES],sortBy:"id",offset:0,sortAscending:"1",limit:ZaDomain.RESULTSPERPAGE,attrs:[ZaCos.A_name,ZaCos.A_description].join(),controller:this.getCurrentController()};
this._cosList=new ZaItemList(ZaCos);
if(h){
r.callback=this._getCosListCallback.bind(this,h);
ZaSearch.searchDirectory(r)
}else{
var t=ZaSearch.searchDirectory(r).Body.SearchDirectoryResponse;
this._cosList.loadFromJS(t)
}}
return this._cosList
};
ZaApp.prototype._getCosListCallback=function(n,e){
var t=e.getResponse().Body;
if(!t){
return
}
var o=t.SearchDirectoryResponse;
if(!o){
return
}
this._cosList.loadFromJS(o);
if(n){
n(this._cosList)
}};
ZaApp.prototype.getCosListChoices=function(e){
if(e||this._cosList==null){}
if(e||this._cosListChoices==null){
if(this._cosListChoices==null){
this._cosListChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name")
}
this._cosListChoices.setChoices(this._cosList.getArray());
this._cosListChoices.dirtyChoices()
}
return this._cosListChoices
};
ZaApp.prototype.getCosListName=function(){
if(!this._cosListName){
var e=this.getCosList();
this._cosListName=AjxUtil.map(e?e.getArray():[],function(t){
return t.name
}
)
}
return this._cosListName
};
ZaApp.prototype.getDomainNameListByType=function(t){
this._domainNameList=this._domainNameList||{};
if(!this._domainNameList[t]){
this._domainNameList[t]=[];
var n=this.getDomainList();
if(n){
var s=n.getArray();
for(var e=0;
e<s.length;
e++){
var o=s[e];
if(o&&o.attrs[ZaDomain.A_domainType]===t){
this._domainNameList[t].push(o.name)
}}}}
return this._domainNameList[t]
};
ZaApp.prototype.getGlobalConfig=function(e){
if(e||this._globalConfig==null){
this._globalConfig=new ZaGlobalConfig()
}
return this._globalConfig
};
ZaApp.prototype.getInstalledSkins=function(h){
try{
if(h||this._installedSkins==null){
var r=AjxSoapDoc.create("GetAllSkinsRequest",ZaZimbraAdmin.URN,null);
var t=new Object();
t.soapDoc=r;
var s={};
s.controller=ZaApp.getInstance().getCurrentController();
try{
this._installedSkins=[];
var c=ZaRequestMgr.invoke(t,s).Body.GetAllSkinsResponse;
if(c&&c.skin){
for(var n=0;
n<c.skin.length;
n++){
this._installedSkins.push(c.skin[n].name)
}}}
catch(o){}}
return this._installedSkins
}
catch(l){
return null
}};
ZaApp.prototype.getSkinChoices=function(n){
var e=[];
for(var t=0;
t<n.length;
t++){
var o=n[t];
e.push({
label:AjxStringUtil.htmlEncode(ZaMsg["theme-"+o]||o.substr(0,1).toUpperCase()+o.substr(1)),value:o}
)
}
return e
};
ZaApp.prototype.handleDomainCreation=function(e){
if(e){
if(!ZaZimbraAdmin.hasGlobalDomainListAccess()){
ZaApp.getInstance()._domainNameList=ZaDomain.getEffectiveDomainList(ZaZimbraAdmin.currentAdminAccount.id)
}
this.searchDomains();
this.getDomainListController().show();
ZaZimbraAdmin.getInstance().getOverviewPanelController().refreshRelatedTree(e.getDetails())
}};
ZaApp.prototype.handleCosRemoval=function(t){
if(t){
if(!this._cosList){
this._cosList=ZaCos.getAll()
}else{
var o=t.getDetails();
if(o&&(o instanceof Array)){
for(var e in o){
this._cosList.remove(o[e])
}}else{
if(o&&(o instanceof ZaCos)){
this._cosList.remove(t.getDetails())
}}
ZaZimbraAdmin.getInstance().refreshHistoryTreeByDelete(t.getDetails())
}
if(this._cosListChoices==null){
this._cosListChoices=new XFormChoices(this._cosList.getArray(),XFormChoices.OBJECT_LIST,"id","name")
}else{
this._cosListChoices.setChoices(this._cosList.getArray());
this._cosListChoices.dirtyChoices()
}}};
ZaApp.prototype.handleServerChange=function(o){
if(o){
if(this._serverList){
this._serverList=ZaServer.getAll();
if(this._serverChoices==null){
this._serverChoices=new XFormChoices(this._serverList.getArray(),XFormChoices.OBJECT_LIST,ZaServer.A_ServiceHostname,ZaServer.A_ServiceHostname)
}else{
this._serverChoices.setChoices(this._serverList.getArray());
this._serverChoices.dirtyChoices()
}
this._serverMap=new Object();
var t=this._serverList.getArray().length;
for(var e=0;
e<t;
e++){
this._serverMap[this._serverList.getArray()[e].id]=this._serverList.getArray()[e]
}}}};
ZaApp.prototype.handleDomainRemoval=function(e){
if(e){
this.searchDomains()
}};
ZaApp.prototype.handleDomainChange=function(e){
if(e){
this.searchDomains()
}};
ZaApp.prototype.handleSettingsChange=function(e){
if(e){
this._globalConfig=new ZaGlobalConfig(this)
}};
ZaApp.prototype.getName=function(){
return this._name
};
ZaApp.prototype.getAppViewMgr=function(){
return this._appViewMgr
};
ZaApp.prototype.createView=function(o,t,e){
this._appViewMgr.createView(o,t);
if(e.openInNewTab){
this.createTab(e)
}else{
this.updateTab(e.tab,e.tabId)
}};
ZaApp.prototype.createTab=function(){
if(arguments.length==0){
return
}
var t;
var r=true;
var s=true;
var e=null;
if(typeof arguments[0]=="object"){
t=arguments[0]["tabId"];
r=AjxUtil.isEmpty(arguments[0]["closable"])?true:false;
s=AjxUtil.isEmpty(arguments[0]["selected"])?true:false;
e=AjxUtil.isEmpty(arguments[0]["onOpen"])?null:arguments[0]["onOpen"]
}else{
t=arguments[0]
}
var n=this.getTabGroup();
var l=this.getViewById(t)[ZaAppViewMgr.C_APP_CONTENT];
var h={
id:t,icon:l.getTabIcon(),label:l.getTabTitle(),toolTip:l.getTabToolTip()||l.getTabTitle(),closable:r,selected:s,onOpen:e};
var o=new ZaAppTab(n,h)
};
ZaApp.prototype.updateTab=function(n,e){
var o=this.getTabGroup();
if(o._searchTab&&o._searchTab==n){
this.updateSearchTab()
}else{
var r=this.getViewById(e)[ZaAppViewMgr.C_APP_CONTENT];
var t=r.getTabIcon();
var s=r.getTabTitle();
n.setToolTipContent(r.getTabToolTip()||r.getTabTitle());
n.resetLabel(s);
n.setImage(t)
}
n.setTabId(e);
if(!n.isSelected()){
o.selectTab(n)
}};
ZaApp.prototype.updateSearchTab=function(){
var e=this.getTabGroup().getSearchTab();
e.setImage(ZaSearchListView.prototype.getTabIcon());
e.resetLabel(ZaSearchListView.prototype.getTabTitle());
e.setToolTipContent(ZaSearchListView.prototype.getTabToolTip.call(this._controllers[e.getTabId()]))
};
ZaApp.prototype.pushView=function(e,t,o){
this._currentViewId=this._appViewMgr.pushView(e)
};
ZaApp.prototype.popView=function(){
var e=this._currentViewId;
this._currentViewId=this._appViewMgr.popView();
this.disposeView(e)
};
ZaApp.prototype.disposeView=function(e,o){
var t=this.getViewById(e);
if(o){
this._appViewMgr.removeHiddenView(e)
}
for(var s in t){
if(t[s] instanceof DwtComposite){
t[s].dispose()
}else{
t[s]=null
}}
if(this._controllers[e]!=null){
this._controllers[e]=null
}};
ZaApp.prototype.setView=function(e,t){
return this._appViewMgr.setView(e,t)
};
ZaApp.prototype.getViewById=function(e){
return this.getAppViewMgr()._views[e]
};
ZaApp.prototype.reset=function(e){};
ZaApp.prototype.setTabGroup=function(e){
this._tabGroup=e
};
ZaApp.prototype.getTabGroup=function(){
return this._tabGroup
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaAboutDialog")){
ZaAboutDialog=function(n,o,e,t){
if(arguments.length==0){
return
}
var s=o||"DwtBaseDialog AboutScreen";
DwtBaseDialog.call(this,n,s,"");
e=e||"579px";
t=t||"264px";
this.setSize(e,t);
this.addCloseListener();
this.addFocusBlurListener()
};
ZaAboutDialog.prototype=new DwtBaseDialog;
ZaAboutDialog.prototype.constructor=ZaAboutDialog;
ZaAboutDialog.prototype.TEMPLATE="admin.Widgets#ZaAboutDialog";
ZaAboutDialog.prototype.closeIcon="ImgAboutClose";
ZaAboutDialog.prototype.closeHoverIcon="ImgAboutCloseHover";
ZaAboutDialog.prototype._createHtmlFromTemplate=function(t,o){
o.dragId=this._dragHandleId;
o.closeIcon=this.closeIcon?this.closeIcon:"ImgAboutClose";
var e=AjxDateFormat.getDateInstance().format(ZaServerVersionInfo.buildDate);
o.version=AjxBuffer.concat(ZaMsg.splashScreenVersion," ",ZaServerVersionInfo.version," ",e);
o.copyright=ZaItem.getAboutScreenCopyright();
o.aboutBanner="ImgAboutBanner";
o.logoURL=ZaAppCtxt.getLogoURI();
DwtComposite.prototype._createHtmlFromTemplate.call(this,t,o);
this._contentEl=document.getElementById(o.id+"_content");
this._closeIconEl=document.getElementById(o.id+"_close")
};
ZaAboutDialog.prototype.addCloseListener=function(){
if(this._closeIconEl){
Dwt.setHandler(this._closeIconEl,DwtEvent.ONCLICK,AjxCallback.simpleClosure(this.popdown,this))
}};
ZaAboutDialog.prototype.addFocusBlurListener=function(){
if(this._closeIconEl&&this._closeIconEl.firstChild){
var e=AjxEnv.isIE?DwtEvent.ONMOUSEENTER:DwtEvent.ONMOUSEOVER;
var t=AjxEnv.isIE?DwtEvent.ONMOUSELEAVE:DwtEvent.ONMOUSEOUT;
Dwt.setHandler(this._closeIconEl.firstChild,e,AjxCallback.simpleClosure(this.changeCloseIcon,this,true));
Dwt.setHandler(this._closeIconEl.firstChild,t,AjxCallback.simpleClosure(this.changeCloseIcon,this,false))
}};
ZaAboutDialog.prototype.changeCloseIcon=function(e){
if(this._closeIconEl&&this._closeIconEl.firstChild){
if(e){
Dwt.delClass(this._closeIconEl.firstChild,this.closeIcon,this.closeHoverIcon)
}else{
Dwt.delClass(this._closeIconEl.firstChild,this.closeHoverIcon,this.closeIcon)
}}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaMsgDialog")){
ZaMsgDialog=function(o,t,s,n,e){
this._app=ZaApp.getInstance();
var r=e?ZaId.getDialogId(ZaId.DLG_MSG,e):ZaId.getDialogId(ZaId.DLG_MSG);
DwtMessageDialog.call(this,o,t,s,n,r)
};
ZaMsgDialog.prototype=new DwtMessageDialog;
ZaMsgDialog.prototype.constructor=ZaMsgDialog;
ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON="close tab and delete";
ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON_DESC=new DwtDialog_ButtonDescriptor(ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON,ZaMsg.bt_close_tab_delete,DwtDialog.ALIGN_RIGHT);
ZaMsgDialog.NO_DELETE_BUTTON="no delete";
ZaMsgDialog.NO_DELETE_BUTTON_DESC=new DwtDialog_ButtonDescriptor(ZaMsgDialog.NO_DELETE_BUTTON,ZaMsg.bt_no_delete,DwtDialog.ALIGN_RIGHT)
}
if(AjxPackage.define("zimbraAdmin.common.ZaErrorDialog")){
ZaErrorDialog=function(n,t){
if(!n){
return
}
var e=new DwtDialog_ButtonDescriptor(ZaErrorDialog.DETAIL_BUTTON,AjxMsg.detail,DwtDialog.ALIGN_LEFT);
var s=t?ZaId.getDialogId(ZaId.DLG_ERR,t):ZaId.getDialogId(ZaId.DLG_ERR);
DwtMessageDialog.call(this,n,null,null,[e],s);
this._detailCell=document.getElementById(this._detailCellId);
var o=this._button[ZaErrorDialog.DETAIL_BUTTON];
o.setImage("SelectPullDownArrow");
this.registerCallback(ZaErrorDialog.DETAIL_BUTTON,this._showDetail,this);
this._setAllowSelection()
};
ZaErrorDialog.prototype=new DwtMessageDialog;
ZaErrorDialog.prototype.constructor=ZaErrorDialog;
ZaErrorDialog.prototype.toString=function(){
return"ZaErrorDialog"
};
ZaErrorDialog.DETAIL_BUTTON=++DwtDialog.LAST_BUTTON;
ZaErrorDialog.prototype._detailsVisible=false;
ZaErrorDialog.prototype.CONTROLS_TEMPLATE="zimbra.Widgets#ZmErrorDialogControls";
ZaErrorDialog.prototype.reset=function(){
this.setDetailString();
DwtMessageDialog.prototype.reset.call(this)
};
ZaErrorDialog.prototype.setMessage=function(e,n,t,o){
this._msgStr=e;
this._msgStyle=t;
this._msgTitle=o;
this._detailsVisible=false;
this._button[ZaErrorDialog.DETAIL_BUTTON].setImage("SelectPullDownArrow");
DwtMessageDialog.prototype.setMessage.call(this,e,t,o);
this.setDetailString(n)
};
ZaErrorDialog.prototype.setDetailString=function(e){
if(!(this._buttonElementId[ZaErrorDialog.DETAIL_BUTTON])){
return
}
this._detailStr=e;
this._button[ZaErrorDialog.DETAIL_BUTTON].setVisible(e!=null);
if(this._detailsEl){
this._detailsEl.value=e||""
}};
ZaErrorDialog.prototype._createHtmlFromTemplate=function(e,t){
DwtMessageDialog.prototype._createHtmlFromTemplate.call(this,e,t);
this._detailsContainerEl=document.getElementById(t.id+"_details_container");
this._detailsEl=document.getElementById(t.id+"_details")
};
ZaErrorDialog.prototype._getContentHtml=function(){
this._detailCellId=Dwt.getNextId();
var t=new Array();
var e=0;
t[e++]=DwtMessageDialog.prototype._getContentHtml.call(this);
t[e++]="<div id='"+this._detailCellId+"'></div>";
return t.join("")
};
ZaErrorDialog.prototype._showDetail=function(){
this._detailsVisible=!this._detailsVisible;
var e=this._msgStr;
if(this._detailsVisible){
e+="<div style='overflow:auto;height:100px'>";
e+="<hr> "+this._detailStr;
e+="</div>"
}
DwtMessageDialog.prototype.setMessage.call(this,e,this._msgStyle,this._msgTitle);
this._button[ZaErrorDialog.DETAIL_BUTTON].setImage(this._detailsVisible?"SelectPullUpArrow":"SelectPullDownArrow")
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaTabView")){
ZaTabView=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,ZaTabView.PARAMS);
var e=t.cssClassName?t.cssClassName:"DwtTabView";
this._contextId=t.contextId?t.contextId:ZaId.TAB_UNDEF;
DwtComposite.call(this,{
parent:t.parent,className:e,posStyle:Dwt.ABSOLUTE_STYLE,id:ZaId.getTabId(this._contextId)}
);
this._iKeyName=t.iKeyName;
this._drawn=false;
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL);
this._containedObject=null;
this.setScrollStyle(Dwt.SCROLL_Y);
this._currentSubTab=[]
};
ZaTabView.PARAMS=["parent","iKeyName","cssClassName","contextId"];
ZaTabView.prototype=new DwtComposite();
ZaTabView.prototype.constructor=ZaTabView;
ZaTabView.XFormModifiers=new Object();
ZaTabView.XFormSetObjectMethods=new Object();
ZaTabView.DEFAULT_TAB=1;
ZaTabView.prototype.initForm=function(o,e,t){
if(o==null||e==null){
throw new AjxException(ZaMsg.ERROR_METADATA_NOT_DEFINED,AjxException.INVALID_PARAM,"ZaTabView.prototype._initForm")
}
this._localXModel=new XModel(o);
this._localXForm=new XForm(e,this._localXModel,t,this,ZaId.getTabViewId(this._contextId));
this._localXForm.setController(ZaApp.getInstance());
this._localXForm.draw();
this.formChangeListener=new AjxListener(this,ZaTabView.prototype.setDirty,[true]);
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_CHANGED,this.formChangeListener);
this._drawn=true
};
ZaTabView.prototype.setBounds=function(t,s,n,e){
DwtControl.prototype.setBounds.call(this,t,s,n,e);
if(this.isListenerRegistered(DwtEvent.CONTROL)){
var o=DwtShell.controlEvent;
o.reset();
this.notifyListeners(DwtEvent.CONTROL,o)
}};
ZaTabView.prototype.getMyXForm=function(n){
var s=new Object();
if(ZaTabView.XFormModifiers[this._iKeyName]){
var e=ZaTabView.XFormModifiers[this._iKeyName];
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this,s,n)
}}}
return s
};
ZaTabView.prototype.getMyForm=function(){
return this._localXForm
};
ZaTabView.prototype.getMyModel=function(){
return this._localXModel
};
ZaTabView.prototype.getObject=function(){
return this._containedObject
};
ZaTabView.prototype.setObject=function(t){
this._containedObject=new Object();
this._containedObject.attrs=new Object();
this._containedObject.type=t.type;
this._containedObject.name=t.name;
if(t.id){
this._containedObject.id=t.id
}
if(t.rights){
this._containedObject.rights=t.rights
}
if(t.setAttrs){
this._containedObject.setAttrs=t.setAttrs
}
if(t.getAttrs){
this._containedObject.getAttrs=t.getAttrs
}
if(t._defaultValues){
this._containedObject._defaultValues=t._defaultValues
}
for(var e in t.attrs){
if(t.attrs[e] instanceof Array){
this._containedObject.attrs[e]=[].concat(t.attrs[e])
}else{
this._containedObject.attrs[e]=t.attrs[e]
}}
if(!t[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=t[ZaModel.currentTab]
}
this._localXForm.setInstance(this._containedObject);
this.formDirtyLsnr=new AjxListener(ZaApp.getInstance().getCurrentController(),ZaXFormViewController.prototype.handleXFormChange);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,this.formDirtyLsnr);
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,this.formDirtyLsnr)
};
ZaTabView.ObjectModifiers={};
ZaTabView.prototype.modifyContainedObject=function(){
if(ZaTabView.ObjectModifiers[this._iKeyName]){
var e=ZaTabView.ObjectModifiers[this._iKeyName];
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this)
}}}};
ZaTabView.prototype.setEnabled=function(e){};
ZaTabView.prototype.setDirty=function(e){
ZaApp.getInstance().getCurrentController().setDirty(e);
this._isDirty=e;
EmailAddr_XFormItem.resetDomainLists.call(this)
};
ZaTabView.prototype.getCurrentTab=function(){
return this._containedObject[ZaModel.currentTab]
};
ZaTabView.prototype.getCurrentSubTab=function(){
var e=this._currentSubTab[this._containedObject[ZaModel.currentTab]];
if(e==null){
e=this._currentSubTab[this._containedObject[ZaModel.currentTab]]=ZaTabView.DEFAULT_TAB
}
return e
};
ZaTabView.prototype.swithTab=function(e){
this._containedObject[ZaModel.currentTab]=e;
this._localXForm.refresh()
};
ZaTabView.prototype.switchSubTab=function(e){
this._currentSubTab[this._containedObject[ZaModel.currentTab]]=e
};
ZaTabView.prototype.isDirty=function(){
return this._isDirty
};
ZaTabView.prototype.getTabToolTip=function(){
if(this._containedObject&&this._containedObject.name&&this._containedObject.type){
return ZaMsg.TBB_Edit+" "+this._containedObject.type+" "+this._containedObject.name
}else{
return""
}};
ZaTabView.prototype.getTabIcon=function(){
if(this._containedObject&&this._containedObject.type){
return this._containedObject.type
}else{
return""
}};
ZaTabView.prototype.getTabTitle=function(){
if(this._containedObject&&this._containedObject.name){
return this._containedObject.name
}else{
return ZaMsg.TBB_New
}};
ZaTabView.prototype.updateTab=function(){
var e=this.getAppTab();
if(e){
e.resetLabel(this.getTabTitle());
e.setImage(this.getTabIcon());
e.setToolTipContent(this.getTabToolTip())
}};
ZaTabView.prototype.getAppTab=function(){
return ZaApp.getInstance().getTabGroup().getTabById(this.__internalId)
};
ZaTabView.isTAB_ENABLED=function(r,s,o){
if(!r){
return true
}
if(AjxUtil.isEmpty(s)&&AjxUtil.isEmpty(o)){
return true
}
if(!AjxUtil.isEmpty(s)){
var t=s.length;
for(var e=0;
e<t;
e++){
if(ZaItem.hasReadPermission(s[e],r)){
return true
}}}
if(!AjxUtil.isEmpty(o)){
var n=o.length;
for(var e=0;
e<n;
e++){
if(ZaItem.hasRight(o[e],r)){
return true
}}}
return false
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaXDialog")){
ZaXDialog=function(c,s,l,d,o,r,n){
if(arguments.length==0){
return
}
this._iKeyName=r;
var e=s||"DwtDialog";
if(!this._standardButtons){
this._standardButtons=[DwtDialog.OK_BUTTON]
}
if(!this._extraButtons){
var t=new DwtDialog_ButtonDescriptor(ZaXDialog.HELP_BUTTON,ZaMsg.TBB_Help,DwtDialog.ALIGN_LEFT,new AjxCallback(this,this._helpButtonListener));
this._extraButtons=[t]
}
this._contextId=n||Dwt.getNextId(ZaId.DLG_UNDEF);
if(this.supportMinimize){
this._supportMinimize=true
}
DwtDialog.call(this,{
parent:c,className:e,title:l,standardButtons:this._standardButtons,extraButtons:this._extraButtons,id:ZaId.getDialogId(this._contextId)}
);
if(this._supportMinimize){
this.addMiniIcon();
this.addPopdownListener(new AjxListener(this,this.popdownHookListner))
}
this._app=ZaApp.getInstance();
this._localXForm=null;
this._localXModel=null;
this._drawn=false;
this._containedObject=null;
if(!d){
this._contentW="500px"
}else{
this._contentW=d
}
if(!o){
this._contentH="350px"
}else{
this._contentH=o
}
this._pageDiv=document.createElement("div");
this._pageDiv.className="ZaXWizardDialogPageDiv";
this._pageDiv.style.width=this._contentW;
this._pageDiv.style.height=this._contentH;
this._pageDiv.style.overflow="auto";
this._pageDiv.style["overflow-y"]="auto";
this._pageDiv.style["overflow-x"]="auto";
this._createContentHtml();
this._helpURL=ZaXDialog.helpURL
};
ZaXDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"administration_console_help.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaXDialog.prototype=new DwtDialog;
ZaXDialog.prototype.constructor=ZaXDialog;
ZaXDialog.TEMPLATE="admin.Widgets#ZaBaseDialog";
ZaXDialog.prototype.supportMinimize=false;
ZaXDialog.prototype.registerFinishMethod=false;
ZaXDialog.prototype.miniType=1;
ZaXDialog.prototype.cacheDialog=true;
ZaXDialog.prototype._createHtmlFromTemplate=function(e,t){
if(this._supportMinimize){
e=ZaXDialog.TEMPLATE
}
DwtDialog.prototype._createHtmlFromTemplate.call(this,e,t);
this._minEl=document.getElementById(t.id+"_minimize")
};
ZaXDialog.prototype.addMiniIcon=function(){
if(this._minEl){
this._minEl.innerHTML=AjxImg.getImageHtml("CollapseRight");
this._minEl.onclick=AjxCallback.simpleClosure(ZaXDialog.prototype.__handleMinClick,this)
}};
ZaXDialog.prototype.setTitleWidthForIE=function(){
var o=(this._contentW||"500px").replace("px","");
o-=(24+5*2);
if(o>0){
o=Dwt.__checkPxVal(o);
var e=this._htmlElId+"_title";
var t=document.getElementById(e);
if(t){
t.style.width=o
}}};
ZaXDialog.prototype.getTaskItem=function(){
var o=this.getCacheName?this.getCacheName():"";
if(!o){
o=this._iKeyName?this._iKeyName:this.toString()
}
var n=this.getTitle();
if(!n){
n=this.toString()
}
var t;
if(this.miniType==1){
t=this.constructor
}else{
t=this
}
var e=new ZaTaskItem(t,o,n,this.getObject(),this.getBounds(),this.miniType,undefined,this.getFinishBtnCallback(),this.cacheDialog);
return e
};
ZaXDialog.prototype.getFinishBtnCallback=function(t){
if(!this.registerFinishMethod){
return
}
if(!t){
t=DwtWizardDialog.FINISH_BUTTON
}
var e;
e=this._buttonDesc[t];
if(!e){
t=DwtDialog.OK_BUTTON;
e=this._buttonDesc[t]
}
if(!e){
return
}
if(!e.callback){
return
}
return{
id:t,callback:e.callback}
};
ZaXDialog.prototype.popdownHookListner=function(){
if(!this._inMin){
var e=this.getTaskItem();
ZaZimbraAdmin.getInstance().getTaskController().removeTask(e)
}};
ZaXDialog.prototype.__handleMinClick=function(){
var e=this.getTaskItem();
ZaZimbraAdmin.getInstance().getTaskController().addTask(e);
this._inMin=true;
this.popdown();
this._inMin=false
};
ZaXDialog.prototype.getTitle=function(){
return this._title
};
ZaXDialog.XFormModifiers=new Object();
ZaXDialog.HELP_BUTTON=++DwtDialog.LAST_BUTTON;
ZaXDialog.prototype.popup=function(t){
DwtDialog.prototype.popup.call(this,t);
if(AjxEnv.isIE&&this._supportMinimize){
this.setTitleWidthForIE()
}
if(this._localXForm){
var e=this._localXForm.focusFirst();
var o=this._shell.getKeyboardMgr();
if(o&&o.isEnabled()){
o.grabFocus(e)
}}};
ZaXDialog.prototype.initForm=function(o,t,e){
if(o==null||t==null){
throw new AjxException("Metadata for XForm and/or XModel are not defined",AjxException.INVALID_PARAM,"ZaXWizardDialog.prototype.initForm")
}
this._localXModel=new XModel(o);
this._localXForm=new XForm(t,this._localXModel,e,this,ZaId.getDialogViewId(this._contextId));
this._localXForm.setController(ZaApp.getInstance());
this._localXForm.draw(this._pageDiv);
this._drawn=true
};
ZaXDialog.prototype.getObject=function(){
return this._containedObject
};
ZaXDialog.prototype.setObject=function(e){
this._containedObject=e;
this._localXForm.setInstance(this._containedObject)
};
ZaXDialog.prototype.getMyXForm=function(n){
var s=new Object();
if(ZaXDialog.XFormModifiers[this._iKeyName]){
var e=ZaXDialog.XFormModifiers[this._iKeyName];
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this,s,n)
}}}
return s
};
ZaXDialog.prototype.setDirty=function(){};
ZaXDialog.prototype._createContentHtml=function(){
this._table=document.createElement("table");
this._table.border=0;
if(this._contentW){
this._table.width=this._contentW
}
this._table.cellPadding=0;
this._table.cellSpacing=0;
Dwt.associateElementWithObject(this._table,this);
this._table.backgroundColor=DwtCssStyle.getProperty(this.parent.getHtmlElement(),"background-color");
var e;
var t;
e=this._table.insertRow(0);
e.align="left";
e.vAlign="middle";
t=e.insertCell(e.cells.length);
t.align="left";
t.vAlign="middle";
t.noWrap=true;
if(this._contentW){
t.width=this._contentW
}
t.appendChild(this._pageDiv);
this._getContentDiv().appendChild(this._table)
};
ZaXDialog.prototype._helpButtonListener=function(){
window.open(this._helpURL)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaXWizardDialog")){
ZaXWizardDialog=function(d,n,l,u,t,s,r,o){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.CANCEL_BUTTON];
if(r){
this._extraButtons=r
}else{
var e=new DwtDialog_ButtonDescriptor(ZaXWizardDialog.HELP_BUTTON,ZaMsg.TBB_Help,DwtDialog.ALIGN_LEFT,new AjxCallback(this,this._helpButtonListener));
var f=new DwtDialog_ButtonDescriptor(ZaXWizardDialog.NEXT_BUTTON,AjxMsg._next,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.goNext));
var c=new DwtDialog_ButtonDescriptor(ZaXWizardDialog.PREV_BUTTON,AjxMsg._prev,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.goPrev));
var m=new DwtDialog_ButtonDescriptor(ZaXWizardDialog.FINISH_BUTTON,AjxMsg._finish,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.finishWizard));
this._extraButtons=[e,c,f,m]
}
this._contextId=o?o:ZaId.DLG_UNDEF;
if(u){
u=this._correntWidth(u)
}
ZaXDialog.call(this,d,n,l,u,t,s,this._contextId);
this._pageIx=1;
this._currentPage=1
};
ZaXWizardDialog.prototype=new ZaXDialog;
ZaXWizardDialog.prototype.constructor=ZaXWizardDialog;
ZaXWizardDialog.Z_ACTIVE_PAGE=Dwt.Z_VIEW+10;
ZaXWizardDialog.Z_HIDDEN_PAGE=Dwt.Z_HIDDEN;
ZaXWizardDialog.Z_TAB_PANEL=Dwt.Z_VIEW+20;
ZaXWizardDialog.Z_CURTAIN=Dwt.Z_CURTAIN;
ZaXWizardDialog.NEXT_BUTTON=DwtWizardDialog.NEXT_BUTTON;
ZaXWizardDialog.PREV_BUTTON=DwtWizardDialog.PREV_BUTTON;
ZaXWizardDialog.FINISH_BUTTON=DwtWizardDialog.FINISH_BUTTON;
ZaXWizardDialog.HELP_BUTTON=++DwtDialog.LAST_BUTTON;
ZaXWizardDialog.prototype.toString=function(){
return"ZaXWizardDialog"
};
ZaXWizardDialog.prototype.popdown=function(){
DwtDialog.prototype.popdown.call(this);
if(this._domains){
this._domains={}
}};
ZaXWizardDialog.prototype._correntWidth=function(e){
if(this.supportMinimize){
if(typeof(e)=="number"){
return e+100
}else{
if(typeof(e)=="string"){
var t=parseInt(e);
if(!isNaN(t)){
t=t+155;
e=t+"px";
return e
}
return e
}else{
return e
}}}else{
return e
}};
ZaXWizardDialog.prototype.goPage=function(e){
EmailAddr_XFormItem.resetDomainLists.call(this);
this._localXForm.releaseFocus();
this._localXModel.setInstanceValue(this._containedObject,ZaModel.currentStep,e);
if(this._localXForm.tabGroupIDs[e]){
this._localXForm.focusFirst(this._localXForm.tabGroupIDs[e])
}else{
this._localXForm.focusFirst()
}
this._localXForm.refresh()
};
ZaXWizardDialog.prototype.goNext=function(){
this.goPage(this._containedObject[ZaModel.currentStep]+1)
};
ZaXWizardDialog.prototype.goPrev=function(){
this.goPage(this._containedObject[ZaModel.currentStep]-1)
};
ZaXWizardDialog.prototype.finishWizard=function(){
this.popdown()
};
ZaXWizardDialog.prototype.getCurrentStep=function(){
return this._containedObject[ZaModel.currentStep]
};
ZaXWizardDialog.prototype.addPage=function(e){
var t=this._pageIx++;
return t
};
ZaXWizardDialog.prototype.initForm=function(o,e,t){
if(o==null||e==null){
throw new AjxException(ZaMsg.ERROR_METADATA_NOT_DEFINED,AjxException.INVALID_PARAM,"ZaXWizardDialog.prototype.initForm")
}
this._localXModel=new XModel(o);
this._localXForm=new XForm(e,this._localXModel,t,this,ZaId.getDialogViewId(this._contextId));
this._localXForm.setController(ZaApp.getInstance());
this._localXForm.draw(this._pageDiv);
this._drawn=true
};
ZaXWizardDialog.prototype.initForm=function(r,t,n){
if(r==null||t==null){
throw new AjxException(ZaMsg.ERROR_METADATA_NOT_DEFINED,AjxException.INVALID_PARAM,"ZaXWizardDialog.prototype.initForm")
}
var s={
items:[]};
var e=t.items[0];
e.type=_STEPCHOICE_;
e.containerCssClass="step_container";
e.colSpan=1;
var o=t.items[3];
var h=o.containerCssClass;
if(h){
h+=" step_body_container"
}else{
h="step_body_container"
}
o.containerCssClass=h;
s.tableCssStyle="width:100%;height:100%";
s.numCols=2;
s.colSizes=["150px","*"];
s.items=[e,o];
this._localXModel=new XModel(r);
this._localXForm=new XForm(s,this._localXModel,n,this,ZaId.getDialogViewId(this._contextId));
this._localXForm.setController(ZaApp.getInstance());
this._localXForm.draw(this._pageDiv);
this._drawn=true
};
ZaXWizardDialog.prototype.supportMinimize=true;
ZaXWizardDialog.prototype.getObject=function(){
return this._containedObject
};
ZaXWizardDialog.prototype.setObject=function(t){
this._containedObject=new Object();
this._containedObject.attrs=new Object();
for(var e in t.attrs){
this._containedObject.attrs[e]=t.attrs[e]
}
this._localXForm.setInstance(this._containedObject.attrs)
}
}
if(AjxPackage.define("zimbraAdmin.common.LDAPURL_XFormItem")){
LDAPURL_XFormItem=function(){};
XFormItemFactory.createItemType("_LDAPURL_","ldapurl",LDAPURL_XFormItem,Composite_XFormItem);
LDAPURL_XFormItem.prototype.numCols=5;
LDAPURL_XFormItem.prototype.nowrap=true;
LDAPURL_XFormItem.prototype._protocolPart="ldap://";
LDAPURL_XFormItem.prototype._serverPart="";
LDAPURL_XFormItem.prototype._portPart="389";
LDAPURL_XFormItem.prototype.defSSLPort="636";
LDAPURL_XFormItem.prototype.defPort="389";
LDAPURL_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
LDAPURL_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
LDAPURL_XFormItem.prototype.initializeItems=function(){
var t=this.getInheritedProperty("ldapPort");
var o=this.getInheritedProperty("ldapSSLPort");
this.defSSLPort=o?o:"636";
this.defPort=t?t:"389";
var e=this.getForm().getInstance();
if(e&&e[ZaDomain.A2_allowClearTextLDAPAuth]=="FALSE"){
this._protocolPart="ldaps://";
this._portPart=this.defSSLPort
}else{
this._protocolPart="ldap://";
this._portPart=this.defPort
}
Composite_XFormItem.prototype.initializeItems.call(this);
this.items[0].valueChangeEventSources=[this.getRefPath()];
this.items[1].valueChangeEventSources=[this.getRefPath()];
this.items[3].valueChangeEventSources=[this.getRefPath()]
};
LDAPURL_XFormItem.prototype.items=[{
type:_OUTPUT_,width:"40px",ref:".",labelLocation:_NONE_,label:null,getDisplayValue:function(t){
var o;
if(t!=null&&t.length>0){
var e=t.split(/(:\/\/)/);
if(AjxEnv.isIE){
if(e[0]=="ldap"||e[0]=="ldaps"){
o=e[0]+"://"
}}else{
if(e.length==3){
o=e[0]+e[1]
}}
this.getParentItem()._protocolPart=o
}else{
if(this.getParentItem()._protocolPart!=null){
o=this.getParentItem()._protocolPart
}else{
o="ldap://"
}}
return o
}}
,{
type:_TEXTFIELD_,width:"200px",forceUpdate:true,ref:".",labelLocation:_NONE_,label:null,required:true,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
var n="";
if(t){
var e=t.split(/[:\/]/);
if(AjxEnv.isIE){
var o=t.substring(7);
var s=o.split(":");
n=s[0]
}else{
if(e.length>=4){
n=e[3]
}}
this.getParentItem()._serverPart=n
}
return n
}
,elementChanged:function(n,t,e){
this.getParentItem()._serverPart=n;
var o=this.getParentItem()._protocolPart+n+":"+this.getParentItem()._portPart;
this.getForm().itemChanged(this.getParentItem(),o,e)
}}
,{
type:_OUTPUT_,width:"5px",labelLocation:_NONE_,label:null,value:":",ref:null}
,{
type:_TEXTFIELD_,width:"40px",forceUpdate:true,ref:".",labelLocation:_NONE_,label:null,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
var n;
if(t){
var e=t.split(/[:\/]/);
if(AjxEnv.isIE){
var o=t.substring(7);
var s=o.split(":");
n=s[1]
}else{
if(e.length>=5){
n=e[4]
}}
this.getParentItem()._portPart=n
}else{
if(this.getParentItem()._portPart){
n=this.getParentItem()._portPart
}else{
n=this.getParentItem().defPort
}}
return n
}
,elementChanged:function(n,t,e){
this.getParentItem()._portPart=n;
var o=this.getParentItem()._protocolPart+this.getParentItem()._serverPart+":"+n;
this.getForm().itemChanged(this.getParentItem(),o,e)
}}
,{
type:_CHECKBOX_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:".",labelLocation:_NONE_,label:null,visibilityChecks:[],subLabel:"",align:_RIGHT_,enableDisableChecks:[],getDisplayValue:function(o){
var e=this.getForm().getInstance();
if((o==null||o.length<=0)&&(e[ZaDomain.A2_allowClearTextLDAPAuth]&&e[ZaDomain.A2_allowClearTextLDAPAuth]=="FALSE")){
this.getParentItem()._protocolPart="ldaps://";
this.getParentItem()._portPart=this.getParentItem().defSSLPort;
return true
}
var s=false;
var n="ldap://";
if(o!=null&&o.length>0){
var t=o.split(/[:\/]/);
n=t[0]+"://"
}
this.getParentItem()._protocolPart=n;
if(n.length==8){
s=true
}
return s
}
,elementChanged:function(n,t,e){
if(n){
this.getParentItem()._protocolPart="ldaps://";
this.getParentItem()._portPart=this.getParentItem().defSSLPort
}else{
this.getParentItem()._protocolPart="ldap://";
this.getParentItem()._portPart=this.getParentItem().defPort
}
var o=this.getParentItem()._protocolPart+this.getParentItem()._serverPart+":"+this.getParentItem()._portPart;
this.getForm().itemChanged(this.getParentItem(),o,e)
}}
]
}
if(AjxPackage.define("zimbraAdmin.common.HostPort_XFormItem")){
HostPort_XFormItem=function(){};
XFormItemFactory.createItemType("_HOSTPORT_","hostport",HostPort_XFormItem,Composite_XFormItem);
HostPort_XFormItem.prototype.numCols=3;
HostPort_XFormItem.prototype.nowrap=true;
HostPort_XFormItem.prototype._serverPart="";
HostPort_XFormItem.prototype._portPart="";
HostPort_XFormItem.prototype.items=[{
type:_TEXTFIELD_,width:"200px",forceUpdate:true,ref:".",labelLocation:_NONE_,label:null,visibilityChecks:[],enableDisableChecks:[],required:true,getDisplayValue:function(t){
var o="";
if(t){
var e=t.split(":");
if(e.length>=2){
o=e[0]
}else{
o=t
}
this.getParentItem()._serverPart=o
}
return o
}
,elementChanged:function(n,t,e){
this.getParentItem()._serverPart=n;
var o="";
if(n){
o=n
}
if(this.getParentItem()._portPart){
o+=":";
o+=this.getParentItem()._portPart
}
this.getForm().itemChanged(this.getParentItem(),o,e)
}
,onClick:"Super_HostPort_XFormItem.handleClick",onMouseout:"Super_HostPort_XFormItem.handleMouseout"}
,{
type:_OUTPUT_,width:"5px",labelLocation:_NONE_,label:null,value:":"}
,{
type:_TEXTFIELD_,width:"40px",forceUpdate:true,ref:".",labelLocation:_NONE_,label:null,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
var o="";
if(t){
var e=t.split(":");
if(e.length==2){
o=e[1]
}else{
o=""
}
this.getParentItem()._portPart=o
}
return o
}
,elementChanged:function(n,t,e){
this.getParentItem()._portPart=n;
var o="";
if(this.getParentItem()._serverPart){
o=this.getParentItem()._serverPart
}
if(n){
o+=":";
o+=n
}
this.getForm().itemChanged(this.getParentItem(),o,e)
}}
]
}
if(AjxPackage.define("zimbraAdmin.common.MailQuota_XModelItem")){
MailQuota_XModelItem=function(){};
XModelItemFactory.createItemType("_MAILQUOTA_","mailquota",MailQuota_XModelItem);
MailQuota_XModelItem.prototype.validateType=XModelItem.prototype.validateNumber;
MailQuota_XModelItem.prototype.getterScope=_MODELITEM_;
MailQuota_XModelItem.prototype.setterScope=_MODELITEM_;
MailQuota_XModelItem.prototype.getter="getValue";
MailQuota_XModelItem.prototype.setter="setValue";
MailQuota_XModelItem.prototype.maxInclusive=8796093022207;
MailQuota_XModelItem.prototype.minInclusive=0;
MailQuota_XModelItem.prototype.getValue=function(ins,current,ref){
var value=null;
if(eval("ins."+ref)!=null){
value=eval("ins."+ref)/1048576;
if(value!=Math.round(value)){
value=Number(value).toFixed(2)
}}
if(typeof value=="number"&&value==0){
value="0"
}
return value
};
MailQuota_XModelItem.prototype.setValue=function(h,l,r,t){
var c=new Array();
var e=Math.round(h*1048576);
if(t.indexOf(".")>=0){
c=t.split(".")
}else{
if(t.indexOf("/")>=0){
c=t.split("/")
}else{
l[t]=e;
return e
}}
var o=c.length-1;
var s=l[c[0]];
for(var n=1;
n<o;
n++){
s=s[c[n]]
}
s[c[o]]=e;
return e
};
MailQuota2_XModelItem=function(){};
XModelItemFactory.createItemType("_MAILQUOTA_2_","mailquota_2",MailQuota2_XModelItem);
MailQuota2_XModelItem.prototype.getterScope=_MODELITEM_;
MailQuota2_XModelItem.prototype.getter="getValue";
MailQuota2_XModelItem.prototype.getValue=function(e,n,t){
var o=this.getLocalValue(e,n,t);
if(o==null){
o=this.getSuperValue(e,n,t)
}
if(o<=0){
o=ZaMsg.Unlimited
}
return o
};
MailQuota2_XModelItem.prototype.getSuperValue=function(ins,current,ref){
if(!ins){
return null
}
var _ref=ref?ref.replace("/","."):this.ref.replace("/",".");
var value=(eval("ins._defaultValues."+_ref)!=null)?Number(eval("ins._defaultValues."+_ref)/1048576).toFixed(0):0;
return value
};
MailQuota2_XModelItem.prototype.getLocalValue=function(ins,current,ref){
if(!ins){
return null
}
var _ref=ref?ref.replace("/","."):this.ref.replace("/",".");
var value=(eval("ins."+_ref)!=null)?Number(eval("ins."+_ref)/1048576).toFixed(0):null;
return value
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaSelectRadioXFormItem")){
ZaSelectRadio_XFormItem=function(){};
XFormItemFactory.createItemType("_ZASELECT_RADIO_","zaselect_radio",ZaSelectRadio_XFormItem,Composite_XFormItem);
ZaSelectRadio_XFormItem.prototype.numCols=2;
ZaSelectRadio_XFormItem.prototype.colSizes=["275px","275px"];
ZaSelectRadio_XFormItem.prototype.nowrap=false;
ZaSelectRadio_XFormItem.prototype.labelWrap=true;
ZaSelectRadio_XFormItem.prototype.items=[];
ZaSelectRadio_XFormItem.prototype.labelWidth="275px";
ZaSelectRadio_XFormItem.prototype.initializeItems=function(){
var h=this.getInheritedProperty("selectRef");
var r=this.getInheritedProperty("radioBoxLabel1");
var s=this.getInheritedProperty("radioBoxLabel2");
var l=this.getInheritedProperty("choices");
var o={
type:_RADIO_,groupname:this.id+"zimlet_select_check_grp"+h,ref:".",label:r,labelLocation:_RIGHT_,elementChanged:function(u,d,c){
if(u==true){
this.getForm().itemChanged(this.getParentItem(),null,c)
}}
,updateElement:function(c){
this.getElement().checked=!c
}};
var t={
type:_RADIO_,groupname:this.id+"zimlet_select_check_grp"+h,ref:".",label:s,labelLocation:_RIGHT_,updateElement:function(c){
this.getElement().checked=c
}
,elementChanged:function(u,d,c){}};
var e={
type:_OSELECT_CHECK_,choices:l,colSpan:3,ref:h,width:"275px",onChange:function(u,d,c){
if(this.getParentItem()&&this.getParentItem().getParentItem()&&this.getParentItem().getParentItem().getOnChangeMethod()){
return this.getParentItem().getParentItem().getOnChangeMethod().call(this,u,d,c)
}else{
return this.setInstanceValue(u)
}}
,forceUpdate:true,updateElement:function(c){
OSelect_XFormItem.prototype.updateElement.call(this,c)
}
,cssStyle:"margin-bottom:5px;margin-top:5px;border:2px inset gray;"};
var n={
type:_GROUP_,numCols:3,colSizes:["130px","15px","130px"],items:[e,{
type:_DWT_BUTTON_,label:ZaMsg.SelectAll,width:"120px",onActivate:function(d){
var c=this.getParentItem().items[0];
if(c){
c.selectAll(d)
}}}
,{
type:_CELLSPACER_,width:"15px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DeselectAll,width:"120px",onActivate:function(d){
var c=this.getParentItem().items[0];
if(c){
c.deselectAll(d)
}}}
]};
this.items=[o,t,{
type:_CELLSPACER_,width:this.labelWidth}
,n];
Composite_XFormItem.prototype.initializeItems.call(this)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaZimletSelectXFormItem")){
ZaZimletSelect_XFormItem=function(){};
XFormItemFactory.createItemType("_ZA_ZIMLET_SELECT_","za_zimlet_select",ZaZimletSelect_XFormItem,OSelect_Check_XFormItem);
ZaZimletSelect_XFormItem.prototype.initializeItems=function(){
ZaZimletSelect_XFormItem.prototype.choicePrefixes=[{
value:"!",label:ZaMsg.mandatory}
,{
value:"-",label:ZaMsg.disabled}
,{
value:"+",label:ZaMsg.enabled}
];
OSelect_Check_XFormItem.prototype.initializeItems.call(this)
};
ZaZimletSelect_XFormItem.prototype.onSubChoiceClick=function(o,e,t){
e=e||window.event;
this.subChoiceSelected(o,e,t)
};
ZaZimletSelect_XFormItem.prototype.onSubChoiceDoubleClick=function(o,e,t){
this.subChoiceSelected(o,true,e,t)
};
ZaZimletSelect_XFormItem.prototype.subChoiceSelected=function(n,e,o){
var t=this.getNormalizedValues()[n];
this.setPrefix(t,e,o)
};
ZaZimletSelect_XFormItem.prototype.getPrefixIndex=function(e){
if(!this._prefixIndexes){
this._prefixIndexes={};
var n=this.getInheritedProperty("choicePrefixes");
var o=n.length;
for(var t=0;
t<o;
t++){
this._prefixIndexes[n[t].value]=t
}}
return this._prefixIndexes[e]
};
ZaZimletSelect_XFormItem.prototype.getNormalizedInstanceValue=function(){
var c=this.getInstanceValue();
var h=new Array();
if(typeof c=="string"){
h=new String(c)
}else{
if(typeof c=="object"||c instanceof Array){
for(var l in c){
h[l]=c[l]
}}}
if(h){
if(h instanceof String){
if(h==""){
h=[]
}else{
h=h.split(",")
}}}
var t=this.getInheritedProperty("choicePrefixes");
var n=t.length;
var r=h.length;
for(var o=0;
o<r;
o++){
var s=false;
for(var e=0;
e<n;
e++){
if(h[o].substr(0,1)==t[e].value){
h[o]={
value:h[o].substr(1),prefix:h[o].substr(0,1)};
s=true;
break
}}
if(!s){
h[o]={
value:h[o],prefix:""}
}}
return h
};
ZaZimletSelect_XFormItem.prototype.setPrefix=function(l,s,h){
var e=this.getNormalizedInstanceValue();
var t=[];
var r=false;
for(var n=0;
n<e.length;
n++){
if(e[n].value==l){
e[n].prefix=h
}
t.push([e[n].prefix,e[n].value].join(""))
}
if(!t||(t.length==1&&t[0]=="")){
t=[]
}
var o=this.getModelItem();
if(o&&o.getOutputType){
if(o.getOutputType()==_STRING_){
t=t.join(o.getItemDelimiter())
}}else{
t=t.join(",")
}
this.getForm().itemChanged(this,t,s)
};
ZaZimletSelect_XFormItem.prototype.setValue=function(t,o,s,e){
var n=this.getNormalizedInstanceValue();
var d=[];
var c=false;
var r;
if(t instanceof Array||typeof t=="object"){
for(a in t){
if(typeof t[a]=="string"&&t[a].substr(0,1)!="+"&&t[a].substr(0,1)!="-"){
var l="+";
for(r=0;
r<n.length;
r++){
if(n[r].value==t[a]&&n[r].prefix){
l=n[r].prefix;
n.splice(r,1);
break
}}
t[a]=l+t[a]
}
d.push(t[a])
}}else{
for(r=0;
r<n.length;
r++){
if(n[r].value==t){
c=true;
break
}}
if(c){
n.splice(r,1)
}else{
n.push({
value:t,prefix:"+"}
)
}
for(r=0;
r<n.length;
r++){
d.push(n[r].prefix+n[r].value)
}}
if(!d||(d.length==1&&d[0]=="")){
d=[]
}
var h=this.getModelItem();
if(h&&h.getOutputType){
if(h.getOutputType()==_STRING_){
d=d.join(h.getItemDelimiter())
}}else{
d=d.join(",")
}
this.getForm().itemChanged(this,d,e)
};
ZaZimletSelect_XFormItem.prototype.getChoiceHTML=function(r,l,h,c){
var s=this.getInheritedProperty("choicePrefixes");
var o=this.getFormGlobalRef()+".getItemById('"+this.getId()+"')";
var e=this.getId();
var t=["<tr><td class=",c,' onmouseover="',o,".showToolTip('",l,"',event||window.event)\",",' onmouseout="',o,'.hideToolTip(event||window.event)">',h,"</td><td class=",c,' onclick="',o,".onChoiceClick(",r,', event||window.event)"',' ondblclick="',o,".onChoiceDoubleClick(",r,", event||window.event)\" id='",e,"_choice_",r,"'>","<table cellspacing=0 cellpadding=0><tr><td><input type=checkbox id='",e,"_choiceitem_",r,"'></td><td>",ZaMsg.Available,"</td></tr></table></td>"];
for(var n=0;
n<s.length;
n++){
t.push("<td class=",c,' onclick="',o,".onSubChoiceClick(",r,", event||window.event, '",s[n].value,"')\"",' ondblclick="',o,".onSubChoiceDoubleClick(",r,", event||window.event, '",s[n].value,"')\" id='",e,"_choice_",r,"_prefix_",n,"'>","<table cellspacing=0 cellpadding=0><tr><td><input type=radio autocomplete='off' id='",e,"_radiochoiceitem_",r,"_prefix_",n,"' name='zazimletselect_",e,"_radiogrp_",r,"'></td><td>",s[n].label,"</td></tr></table></td>")
}
t.push("</tr>");
return t.join("")
};
ZaZimletSelect_XFormItem.prototype.showToolTip=function(h,e){
var t=ZaZimlet.zimlets[h];
var s;
if(!t){
s="Unknown Zimlet"
}else{
s=ZaZimletListView.__processMessage(h,t.attrs[ZaZimlet.A_zimbraZimletDescription]);
if(s.slice(0,2)=="${"){
s=ZaMsg.Zimlet_Description_Loading
}}
var o=new DwtUiEvent(true);
o.setFromDhtmlEvent(e);
var r=DwtShell.getShell(window);
var c=r.getToolTip();
var n=new Array(20);
var l=0;
n[l++]="<table cellpadding='0' cellspacing='0' border='0'>";
n[l++]="<tr valign='center'><td colspan='2' align='left'>";
n[l++]="<div style='white-space:nowrap; overflow:hidden;width:350'>";
n[l++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
n[l++]="<tr valign='center' >";
n[l++]="<td><b>"+AjxStringUtil.htmlEncode(h)+"</b></td>";
n[l++]="<td align='right'></td></tr>";
n[l++]="<tr><td><hr style='border:none;border-top:1px solid black;height:0'></td><tr>";
n[l++]="<tr><td>"+AjxStringUtil.htmlEncode(s)+"</td></tr>";
n[l++]="</table>";
n[l++]="</div></td></tr>";
n[l++]="</table>";
c.setContent(n.join(""));
c.popup(o.docX,o.docY,null,true)
};
ZaZimletSelect_XFormItem.prototype.hideToolTip=function(t){
var e=DwtShell.getShell(window);
var o=e.getToolTip();
o.popdown()
};
ZaZimletSelect_XFormItem.prototype.hiliteChoice=function(n){
var o=this.getChoiceElements(n);
if(o){
var t=o[1];
t.className=this.getChoiceSelectedCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=true;
this.enableSubChoice(n)
}}};
ZaZimletSelect_XFormItem.prototype.dehiliteChoice=function(n){
var o=this.getChoiceElements(n);
if(o){
var t=o[1];
t.className=this.getChoiceCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=false;
this.disableSubChoice(n)
}}};
ZaZimletSelect_XFormItem.prototype.hiliteSubChoice=function(n,t){
var s=[this.getId(),"_choice_",n,"_prefix_",t].join("");
var o=this.getElement(s);
if(o){
o.className=this.getChoiceSelectedCssClass();
var e=o.getElementsByTagName("input");
if(e){
e[0].checked=true
}}};
ZaZimletSelect_XFormItem.prototype.dehiliteSubChoice=function(n,t){
var s=[this.getId(),"_choice_",n,"_prefix_",t].join("");
var o=this.getElement(s);
if(o){
o.className=this.getChoiceCssClass();
var e=o.getElementsByTagName("input");
if(e){
e[0].checked=false
}}};
ZaZimletSelect_XFormItem.prototype.disableSubChoice=function(n){
var t=this.getInheritedProperty("choicePrefixes");
for(var e=0;
e<t.length;
e++){
var r=[this.getId(),"_choice_",n,"_prefix_",e].join("");
var o=this.getElement(r);
if(o){
o.className=this.getChoiceCssClass()+"_disabled";
var s=o.getElementsByTagName("input");
if(s){
s[0].disabled=true
}}}};
ZaZimletSelect_XFormItem.prototype.enableSubChoice=function(n){
var t=this.getInheritedProperty("choicePrefixes");
for(var e=0;
e<t.length;
e++){
var r=[this.getId(),"_choice_",n,"_prefix_",e].join("");
var o=this.getElement(r);
if(o){
o.className=this.getChoiceCssClass();
var s=o.getElementsByTagName("input");
if(s){
s[0].disabled=false
}}}};
ZaZimletSelect_XFormItem.prototype.updateElement=function(){
var o=this.getElement();
o.innerHTML=this.getChoicesHTML();
var e=this.getNormalizedInstanceValue();
this.clearAllHilites();
if(e){
for(var t=0;
t<e.length;
t++){
var n=this.getChoiceNum(e[t].value);
if(n!=-1){
this.hiliteChoice(n);
if(e[t].prefix!=""){
this.hiliteSubChoice(n,this.getPrefixIndex(e[t].prefix))
}}}}
this.updateEnabledDisabled()
};
ZaZimletSelect_XFormItem.prototype.setElementEnabled=function(d){
var p=this.getNormalizedChoices();
if(!p){
return
}
var m=p.values;
if(!m){
return
}
var n=m.length;
var r=this.getInheritedProperty("choicePrefixes");
var l=r.length;
for(var h=0;
h<n;
h++){
var o=this.getElement([this.getId(),"_choiceitem_",h].join(""));
var c=this.getElement([this.getId(),"_choice_",h].join(""));
if(o){
if(d){
c.className=this.getChoiceCssClass();
o.className=this.getChoiceCssClass();
o.disabled=false
}else{
c.className=this.getChoiceCssClass()+"_disabled";
o.className=this.getChoiceCssClass()+"_disabled";
o.disabled=true;
for(var s=0;
s<l;
s++){
var e=[this.getId(),"_radiochoiceitem_",h,"_prefix_",s].join("");
var f=[this.getId(),"_choice_",h,"_prefix_",s].join("");
var t=this.getElement(e);
var u=this.getElement(f);
u.className=this.getChoiceCssClass()+"_disabled";
o.className=this.getChoiceCssClass()+"_disabled";
o.disabled=true
}}}}};
ZaZimletSelectCombo_XFormItem=function(){};
XFormItemFactory.createItemType("_ZA_ZIMLET_SELECT_COMBO_","za_zimlet_select_combo",ZaZimletSelectCombo_XFormItem,Composite_XFormItem);
ZaZimletSelectCombo_XFormItem.prototype.numCols=1;
ZaZimletSelectCombo_XFormItem.prototype.colSizes=["*"];
ZaZimletSelectCombo_XFormItem.prototype.nowrap=false;
ZaZimletSelectCombo_XFormItem.prototype.labelWrap=true;
ZaZimletSelectCombo_XFormItem.prototype.items=[];
ZaZimletSelectCombo_XFormItem.prototype.initializeItems=function(){
var r=this.getInheritedProperty("selectRef");
var h=this.getInheritedProperty("choices");
var t=this.getInheritedProperty("selectLabel");
var s=this.getInheritedProperty("selectLabelLocation");
var n=this.getInheritedProperty("choicesWidth")||"500px";
var e={
type:_ZA_ZIMLET_SELECT_,choices:h,colSpan:4,ref:r,label:t,labelLocation:s,width:n,bmolsnr:true,cssStyle:"margin-bottom:5px;margin-top:5px;border:2px inset gray;"};
var o={
type:_GROUP_,numCols:4,colSizes:["130px","5px","130px","*"],items:[e,{
type:_DWT_BUTTON_,label:ZaMsg.SelectAll,width:"120px",onActivate:function(c){
var l=this.getParentItem().items[0];
if(l){
l.selectAll(c)
}}}
,{
type:_CELLSPACER_,width:"5px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DeselectAll,width:"120px",onActivate:function(c){
var l=this.getParentItem().items[0];
if(l){
l.deselectAll(c)
}}}
,{
type:_CELLSPACER_,width:"235px"}
]};
this.items=[o];
Composite_XFormItem.prototype.initializeItems.call(this)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaCheckBoxListXFormItem")){
ZaCheckBox_List_XFormItem=function(){};
XFormItemFactory.createItemType("_ZA_CHECKBOX_LIST_","za_checkbox_list",ZaCheckBox_List_XFormItem,Composite_XFormItem);
ZaCheckBox_List_XFormItem.prototype.numCols=2;
ZaCheckBox_List_XFormItem.prototype.colSizes=["275px","275px"];
ZaCheckBox_List_XFormItem.prototype.nowrap=false;
ZaCheckBox_List_XFormItem.prototype.labelWrap=true;
ZaCheckBox_List_XFormItem.prototype.items=[];
ZaCheckBox_List_XFormItem.prototype.labelWidth="275px";
ZaCheckBox_List_XFormItem.prototype.choicesWidth="275px";
ZaCheckBox_List_XFormItem.prototype.initializeItems=function(){
var s=this.getInheritedProperty("selectRef");
var r=this.getInheritedProperty("choices");
var t=this.getInheritedProperty("selectLabel");
var n=AjxEnv.isIE?"275px":(this.getInheritedProperty("choicesWidth")||"275px");
var e={
type:_OSELECT_CHECK_,choices:r,colSpan:3,ref:s,label:t,labelLocation:_TOP_,width:n,bmolsnr:true,cssStyle:"margin-bottom:5px;margin-top:5px;border:2px inset gray;"};
var o={
type:_GROUP_,numCols:3,colSizes:["130px","15px","130px"],items:[e,{
type:_DWT_BUTTON_,label:ZaMsg.SelectAll,width:"120px",onActivate:function(l){
var h=this.getParentItem().items[0];
if(h){
h.selectAll(l)
}}}
,{
type:_CELLSPACER_,width:"15px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DeselectAll,width:"120px",onActivate:function(l){
var h=this.getParentItem().items[0];
if(h){
h.deselectAll(l)
}}}
]};
this.items=[{
type:_CELLSPACER_,width:this.labelWidth}
,o];
Composite_XFormItem.prototype.initializeItems.call(this)
}
}
if(AjxPackage.define("zimbraAdmin.common.Signature_XFormItem")){
Signature_XFormItem=function(){};
XFormItemFactory.createItemType("_SIGNATURE_","signature",Signature_XFormItem,Composite_XFormItem);
Signature_XFormItem.prototype.numCols=1;
Signature_XFormItem.prototype.nowrap=true;
Signature_XFormItem.A_zimbraSigatureName="name";
Signature_XFormItem.A_zimbraSigatureContent="content";
Signature_XFormItem.A_zimbraSigatureType="type";
Signature_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Signature_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Signature_XFormItem.prototype.initializeItems=function(){
Composite_XFormItem.prototype.initializeItems.call(this)
};
Signature_XFormItem.typeChoice=[{
value:"",label:ZaMsg.VALUE_NOT_SET}
,{
value:"text/plain",label:ZaMsg.resSignaturePlainType}
,{
value:"text/html",label:ZaMsg.resSignatureHTMLType}
];
Signature_XFormItem.prototype.items=[{
type:_TEXTFIELD_,ref:".",width:"300px",labelLocation:_LEFT_,forceUpdate:true,label:ZaMsg.Dlg_SignatureName,labelCssStyle:"width:194px",getDisplayValue:function(e){
if(e&&e.name){
val=e.name
}else{
val=""
}
return val
}
,elementChanged:function(n,t,o){
var e={};
if(t==""||!t){
t={}
}
e=ZaUtil.deepCloneObject(t);
e.name=n;
this.getForm().itemChanged(this.getParentItem(),e,o)
}}
,{
type:_TEXTAREA_,width:"300px",forceUpdate:true,ref:".",labelLocation:_LEFT_,label:ZaMsg.Dlg_SignatureContent,labelCssStyle:"width:194px",getDisplayValue:function(e){
var t;
if(e&&e.content){
t=e.content
}else{
t=""
}
return t
}
,elementChanged:function(o,t,n){
var e={};
if(t==""||!t){
t={}
}
e=ZaUtil.deepCloneObject(t);
e.content=o;
this.getForm().itemChanged(this.getParentItem(),e,n)
}}
]
}
if(AjxPackage.define("zimbraAdmin.common.Super_XFormItems")){
Cos_String_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_STRING_","cos_string",Cos_String_XModelItem);
Cos_String_XModelItem.prototype.dataType=_STRING_;
Cos_String_XModelItem.prototype.getter="getValue";
Cos_String_XModelItem.prototype.getterScope=_MODELITEM_;
Cos_String_XModelItem.prototype.setter="setLocalValue";
Cos_String_XModelItem.prototype.setterScope=_MODELITEM_;
Cos_String_XModelItem.prototype.setValueAt=function(e,h,s){
var n=new Array();
if(s.indexOf(".")>=0){
n=s.split(".")
}else{
if(s.indexOf("/")>=0){
n=s.split("/")
}else{
e[s]=h;
return h
}}
var o=n.length-1;
var r=e[n[0]];
for(var t=1;
t<o;
t++){
r=r[n[t]]
}
r[n[o]]=h
};
Cos_String_XModelItem.prototype.getValue=function(e,n,t){
var o=this.getLocalValue(e);
if(o==null){
o=this.getSuperValue(e)
}
return o
};
Cos_String_XModelItem.prototype.getSuperValue=function(ins){
if(!ins||!ins._defaultValues){
return null
}
var _ref=this.ref.replace("/",".");
return eval("ins._defaultValues."+_ref)
};
Cos_String_XModelItem.prototype.getLocalValue=function(ins,refPath){
if(!ins){
return null
}
var _ref=this.ref.replace("/",".");
return eval("ins."+_ref)
};
Cos_String_XModelItem.prototype.setLocalValue=function(o,e,n,t){
this.setValueAt(e,o,t)
};
Cos_String_XModelItem.prototype.validateType=XModelItem.prototype.validateString;
Cos_Number_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_NUMBER_","cos_number",Cos_Number_XModelItem,Cos_String_XModelItem);
Cos_Number_XModelItem.prototype.validateType=XModelItem.prototype.validateNumber;
Cos_Int_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_INT_","cos_int",Cos_Int_XModelItem,Cos_String_XModelItem);
Cos_Int_XModelItem.prototype.validateType=XModelItem.prototype.validateInt;
Cos_Enum_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_ENUM_","cos_enum",Cos_Enum_XModelItem,Cos_String_XModelItem);
Cos_Enum_XModelItem.prototype.getDefaultValue=function(){
return this.getChoices()[0]
};
Cos_Enum_XModelItem.prototype.getChoices=function(){
if(typeof this.choices=="function"){
this.choices=this.choices.call(this)
}
return this.choices
};
Cos_Enum_XModelItem.prototype.getSelection=function(){
return this.selection
};
Cos_Enum_XModelItem.prototype.validateType=function(o){
var n=this.getSelection()==_OPEN_;
if(n){
return o
}
var s=this.getChoices();
for(var t=0;
t<s.length;
t++){
var e=s[t];
if(AjxUtil.isInstance(e,Object)){
if(e.value==o){
return o
}}else{
if(e==o){
return o
}}}
throw this.getModel().getErrorMessage("didNotMatchChoice",o)
};
Cos_Enum_Polling_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_ENUM_POLLING_","cos_enum_polling",Cos_Enum_Polling_XModelItem,Cos_Enum_XModelItem);
Cos_Enum_Polling_XModelItem.prototype.getValue=function(e,s,o){
var n=this.getLocalValue(e);
if(n==null){
n=this.getSuperValue(e)
}
var t=/^([0-9])+([dhms]|ms)$/;
if(!t.test(n)){
n+="s"
}
return n
};
Cos_List_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_LIST_","list_enum",Cos_List_XModelItem,Cos_String_XModelItem);
Cos_List_XModelItem.prototype.outputType=_LIST_;
Cos_List_XModelItem.prototype.itemDelimiter=List_XModelItem.prototype.itemDelimiter;
Cos_List_XModelItem.prototype.inputDelimiter=List_XModelItem.prototype.inputDelimiter;
Cos_List_XModelItem.prototype.listItem=List_XModelItem.prototype.listItem;
Cos_List_XModelItem.prototype.getOutputType=List_XModelItem.prototype.getOutputType;
Cos_List_XModelItem.prototype.getItemDelimiter=List_XModelItem.prototype.getItemDelimiter;
Cos_List_XModelItem.prototype.getInputDelimiter=List_XModelItem.prototype.getInputDelimiter;
Cos_List_XModelItem.prototype.getListItem=List_XModelItem.prototype.getListItem;
Cos_List_XModelItem.prototype.initializeItems=List_XModelItem.prototype.initializeItems;
Cos_List_XModelItem.prototype.validateType=List_XModelItem.prototype.validateType;
Cos_List_XModelItem.prototype.getDefaultValue=List_XModelItem.prototype.getDefaultValue;
Cos_List_XModelItem.prototype.getSuperValue=function(ins){
if(!ins||!ins._defaultValues){
return null
}
var _ref=this.ref.replace("/",".");
var lst=eval("ins._defaultValues."+_ref);
if(lst){
if(this.getOutputType()==_STRING_){
if(lst instanceof Array){
return lst.join(this.getItemDelimiter())
}}else{
var retval=[];
if(!(lst instanceof Array)){
lst=[lst]
}
var cnt=lst.length;
for(var i=0;
i<cnt;
i++){
retval.push(lst[i])
}
return retval
}}};
Cos_List_XModelItem.prototype.setLocalValue=function(val,ins,current,ref){
if(val&&this.getOutputType()==_STRING_&&!(val instanceof Array)){
var value=val.split(this.getInputDelimiter());
eval("ins."+ref+" = value");
this.setValueAt(ins,value,ref)
}else{
var value=eval("ins."+ref+" = val");
this.setValueAt(ins,value,ref)
}};
Cos_List_XModelItem.prototype.getLocalValue=function(ins,refPath){
if(!ins){
return null
}
var _ref=this.ref.replace("/",".");
var value=eval("ins."+_ref);
if(value&&this.getOutputType()==_STRING_&&value instanceof Array){
return value.join(this.getItemDelimiter())
}else{
return value
}};
Cos_List_XModelItem.prototype.initializeItems=function(){
var e=this.listItem;
e.ref=e.id="#";
this.listItem=XModelItemFactory.createItem(e,this,this.getModel());
this.listItem.initializeItems()
};
Cos_List_XModelItem.prototype.validateType=function(e){
return e
};
Cos_MailQuota_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_MAILQUOTA_","cos_mailquota",Cos_MailQuota_XModelItem,Cos_Number_XModelItem);
Cos_MailQuota_XModelItem.prototype.getterScope=_MODELITEM_;
Cos_MailQuota_XModelItem.prototype.setterScope=_MODELITEM_;
Cos_MailQuota_XModelItem.prototype.getter="getValue";
Cos_MailQuota_XModelItem.prototype.setter="setLocalValue";
Cos_MailQuota_XModelItem.prototype.maxInclusive=8796093022207;
Cos_MailQuota_XModelItem.prototype.minInclusive=0;
Cos_MailQuota_XModelItem.prototype.getValue=function(e,n,t){
var o=this.getLocalValue(e,n,t);
if(o==null){
o=this.getSuperValue(e,n,t)
}
if(typeof o=="number"&&o==0){
o="0"
}
return o
};
Cos_MailQuota_XModelItem.prototype.getSuperValue=function(ins){
if(!ins){
return null
}
var _ref=this.ref.replace("/",".");
var value=null;
if((eval("ins._defaultValues."+_ref)!=null)&&(eval("ins._defaultValues."+_ref)!="")){
value=(eval("ins._defaultValues."+_ref)/1048576);
if(value!=Math.round(value)){
value=Number(value).toFixed(2)
}}
return value
};
Cos_MailQuota_XModelItem.prototype.getLocalValue=function(ins,refPath){
if(!ins){
return null
}
var _ref=this.ref.replace("/",".");
var value=null;
if(eval("ins."+_ref)!=null&&eval("ins."+_ref)!=""){
value=(eval("ins."+_ref)/1048576);
if(value!=Math.round(value)){
value=Number(value).toFixed(2)
}}
return value||eval("ins."+_ref)
};
Cos_MailQuota_XModelItem.prototype.setLocalValue=function(o,e,n,t){
if(o!=null&&o!=""){
o=Math.round(o*1048576)
}
this.setValueAt(e,o,t)
};
Cos_MLifetime_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_MLIFETIME_","cos_mlifetime",Cos_MLifetime_XModelItem,Cos_String_XModelItem);
Cos_MLifetime_XModelItem.prototype.validateType=function(t){
var o="0";
var e="d";
if(t==this.zeroValue){
o="0"
}else{
if(t!=null&&t.length>0){
var e=(t.toLowerCase()).charAt(t.length-1);
e=(e=="d"||e=="h"||e=="m"||e=="s")?e:"s";
o=parseInt(t)
}}
o=[XModelItem.prototype.validateNumber.call(this,o),e].join("");
return o
};
Cos_MInterval_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_MINTERVAL_","cos_minterval",Cos_MInterval_XModelItem,Cos_MLifetime_XModelItem);
Cos_MInterval_XModelItem.prototype.zeroValue=ZaMsg.never.toLowerCase();
Cos_HostNameOrIp_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_HOSTNAME_OR_IP_","cos_hostname_or_ip",Cos_HostNameOrIp_XModelItem,Cos_String_XModelItem);
Cos_HostNameOrIp_XModelItem.prototype.validateType=XModelItem.prototype.validateString;
Cos_HostNameOrIp_XModelItem.prototype.maxLength=256;
Cos_HostNameOrIp_XModelItem.prototype.pattern=[AjxUtil.HOST_NAME_RE,AjxUtil.IPv4_ADDRESS_RE,AjxUtil.HOST_NAME_WITH_PORT_RE];
Cos_Port_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_PORT_","cos_port",Cos_Port_XModelItem,Cos_Number_XModelItem);
Cos_Port_XModelItem.prototype.validateType=XModelItem.prototype.validateNumber;
Cos_Port_XModelItem.prototype.minInclusive=0;
Cos_Port_XModelItem.prototype.maxInclusive=65535;
Cos_Subnet_XModelItem=function(){};
XModelItemFactory.createItemType("_COS_SUBNET_","cos_subnet",Cos_Subnet_XModelItem,Cos_String_XModelItem);
Cos_Subnet_XModelItem.prototype.validateType=XModelItem.prototype.validateString;
Cos_Subnet_XModelItem.prototype.maxLength=256;
Cos_Subnet_XModelItem.prototype.pattern=[AjxUtil.IPv4_ADDRESS_RE,AjxUtil.SUBNET_RE];
Super_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_FIELD_","cos_field",Super_XFormItem,Composite_XFormItem);
Super_XFormItem.prototype.bmolsnr=true;
Super_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Super_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_XFormItem.checkIfOverWriten=function(){
if(!ZaItem.hasWritePermission.call(this)){
return false
}
if(this.getModelItem()&&this.getModelItem().getLocalValue(this.getInstance(),this.refPath)==null){
return false
}else{
if(this.getModelItem()&&(this.getModelItem().getLocalValue(this.getInstance(),this.refPath) instanceof AjxVector)&&(this.getModelItem().getLocalValue(this.getInstance(),this.refPath).size==0)){
return false
}else{
return true
}}};
Super_XFormItem.updateCss=function(o){
var t=this.getContainer();
if(this.getParentItem().getInheritedProperty("useParentTable")){
o=o-4
}
for(var e=0;
e<o;
e++){
t=t.parentNode
}
if(Super_XFormItem.checkIfOverWriten.call(this)){
if(t.className!=null&&t.className!="ZaOverride"){
this._originalClassName=t.className
}else{
this._originalClassName="xform_field_container"
}
t.className="ZaOverride"
}else{
if(this._originalClassName!=null){
t.className=this._originalClassName
}else{
t.className="xform_field_container"
}}};
Super_AnchorHelper_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_ANCHOR_HELPER_","super_anchor_helper",Super_AnchorHelper_XFormItem,Dwt_Button_XFormItem);
Super_AnchorHelper_XFormItem.prototype.containerCssClass="xform_container xform_override_btn_contaier";
Super_AnchorHelper_XFormItem.prototype.constructWidget=function(){
var r=this.widget=new DwtButton(this.getForm(),this.getCssClass());
var e=this.getHeight();
var s=this.getWidth();
var n=null;
if(s!=null||e!=null){
n=r.getHtmlElement();
if(s!=null){
n.style.width=s
}
if(e!=null){
n.style.height=e
}}
var o=this.getLabel();
if(!o){
o=this.getParentItem().getInheritedProperty("resetToSuperLabel")
}
r.setText(o);
var t=new AjxListener(this,Super_AnchorHelper_XFormItem.prototype.resetToSuperValue);
r.addSelectionListener(t);
return r
};
Super_AnchorHelper_XFormItem.prototype.resetToSuperValue=function(e){
this.getForm().itemChanged(this.getParentItem(),null,e)
};
Super_AnchorHelper_XFormItem.prototype.isBlockElement=true;
Super_Textfield_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_TEXTFIELD_","super_textfield",Super_Textfield_XFormItem,Super_XFormItem);
Super_Textfield_XFormItem.prototype.useParentTable=false;
Super_Textfield_XFormItem.prototype.txtBoxLabel=null;
Super_Textfield_XFormItem.prototype.numCols=3;
Super_Textfield_XFormItem.prototype.colSizes=["275px","275px","150px"];
Super_Textfield_XFormItem.prototype.colSpan=3;
Super_Textfield_XFormItem.prototype.nowrap=false;
Super_Textfield_XFormItem.prototype.labelWrap=true;
Super_Textfield_XFormItem.prototype.colSizes=["275px","225px","150px"];
Super_Textfield_XFormItem.prototype.labelCssStyle="border-right: 1px solid black;";
Super_Textfield_XFormItem.prototype.tableCssClass="grid_composite_table";
SuperWiz_Textfield_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_TEXTFIELD_","superwiz_textfield",SuperWiz_Textfield_XFormItem,Super_Textfield_XFormItem);
SuperWiz_Textfield_XFormItem.prototype.colSizes=["200px","250px","150px"];
SuperWiz_Textfield_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_Textfield_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
SuperWiz_Textfield_XFormItem.prototype.labelCssStyle="";
Super_Textfield_XFormItem.prototype.initializeItems=function(){
var d=this.getInheritedProperty("txtBoxLabel");
var c=this.getInheritedProperty("labelCssStyle");
var u=this.getInheritedProperty("labelCssClass");
var n=this.getInheritedProperty("textFieldCssClass");
var t=this.getInheritedProperty("textFieldCssStyle");
var l=this.getInheritedProperty("textFieldWidth");
var o=this.getInheritedProperty("toolTipContent");
var s=this.getInheritedProperty("getDisplayValue");
var r={
type:_TEXTFIELD_,ref:".",align:_LEFT_,elementChanged:function(p,f,m){
this.getForm().itemChanged(this,p,m)
}
,onChange:Composite_XFormItem.onFieldChange,toolTipContent:o,updateElement:function(m){
Super_XFormItem.updateCss.call(this,5);
Textfield_XFormItem.prototype.updateElement.call(this,m)
}
,label:d,labelCssStyle:c,labelCssClass:u,labelLocation:(d?_LEFT_:_NONE_),cssClass:n,cssStyle:t,width:l,forceUpdate:true,nowrap:this.getInheritedProperty("nowrap"),labelWrap:this.getInheritedProperty("labelWrap")};
if(s){
r.getDisplayValue=s
}
var h=this.getInheritedProperty("anchorCssStyle");
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:(h?h:"width:150px")};
this.items=[r,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_Textfield_XFormItem.prototype.items=[];
Super_Textarea_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_TEXTAREA_","super_textarea",Super_Textarea_XFormItem,Super_XFormItem);
Super_Textarea_XFormItem.prototype.useParentTable=false;
Super_Textarea_XFormItem.prototype.txtBoxLabel=null;
Super_Textarea_XFormItem.prototype.numCols=3;
Super_Textarea_XFormItem.prototype.colSizes=["275px","275px","150px"];
Super_Textarea_XFormItem.prototype.colSpan=3;
Super_Textarea_XFormItem.prototype.nowrap=false;
Super_Textarea_XFormItem.prototype.labelWrap=true;
Super_Textarea_XFormItem.prototype.colSizes=["275px","225px","150px"];
Super_Textarea_XFormItem.prototype.tableCssClass="grid_composite_table";
SuperWiz_Textarea_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_TEXTAREA_","superwiz_textarea",SuperWiz_Textarea_XFormItem,Super_Textarea_XFormItem);
SuperWiz_Textarea_XFormItem.prototype.colSizes=["200px","250px","150px"];
SuperWiz_Textarea_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_Textarea_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_Textarea_XFormItem.prototype.initializeItems=function(){
var d=this.getInheritedProperty("txtBoxLabel");
var r=this.getInheritedProperty("txtBoxLabelCssStyle");
var c=this.getInheritedProperty("textAreaCssClass");
var h=this.getInheritedProperty("textAreaCssStyle");
var n=this.getInheritedProperty("textAreaWidth");
var t=this.getInheritedProperty("toolTipContent");
var l=this.getInheritedProperty("labelCssStyle");
var u=this.getInheritedProperty("labelCssClass");
var o={
type:_TEXTAREA_,ref:".",align:_LEFT_,elementChanged:function(p,f,m){
this.getForm().itemChanged(this,p,m)
}
,onChange:Composite_XFormItem.onFieldChange,toolTipContent:t,updateElement:function(m){
Super_XFormItem.updateCss.call(this,5);
Textarea_XFormItem.prototype.updateElement.call(this,m)
}
,label:d,labelLocation:(d?_LEFT_:_NONE_),labelCssStyle:l,labelCssClass:u,cssClass:c,cssStyle:h,width:n,forceUpdate:true,nowrap:this.getInheritedProperty("nowrap"),labelWrap:this.getInheritedProperty("labelWrap")};
var s=this.getInheritedProperty("anchorCssStyle");
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:(s?s:"width:150px")};
this.items=[o,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_Textarea_XFormItem.prototype.items=[];
Super_Checkbox_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_CHECKBOX_","super_checkbox",Super_Checkbox_XFormItem,Super_XFormItem);
SuperWiz_Checkbox_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_WIZ_CHECKBOX_","super_wiz_checkbox",SuperWiz_Checkbox_XFormItem,Super_Checkbox_XFormItem);
SuperWiz_Checkbox_XFormItem.prototype.colSizes=["200px","300px","150px"];
SuperWiz_Checkbox_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_Checkbox_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
SuperWiz_Checkbox_XFormItem.prototype.labelCssStyle="";
SuperWiz_Checkbox_XFormItem.prototype.labelCssClass="";
SuperWiz_Checkbox_XFormItem.prototype.checkBoxLabelLocation=_RIGHT_;
SuperWiz_Checkbox_XFormItem.prototype.checkboxSubLabel="";
SuperWiz_Checkbox_XFormItem.prototype.checkboxAlign=_RIGHT_;
Super_Checkbox_XFormItem.prototype.useParentTable=false;
Super_Checkbox_XFormItem.prototype.numCols=3;
Super_Checkbox_XFormItem.prototype.colSizes=["275px","275px","*"];
Super_Checkbox_XFormItem.prototype.nowrap=false;
Super_Checkbox_XFormItem.prototype.labelWrap=true;
Super_Checkbox_XFormItem.prototype.checkboxSubLabel=null;
Super_Checkbox_XFormItem.prototype.labelCssStyle="border-right: 1px solid black;";
Super_Checkbox_XFormItem.prototype.labelCssClass="gridGroupBodyLabel";
Super_Checkbox_XFormItem.prototype.tableCssClass="grid_composite_table";
Super_Checkbox_XFormItem.prototype.colSizes=["275px","225px","*"];
Super_Checkbox_XFormItem.prototype.initializeItems=function(){
var h=this.getInheritedProperty("anchorCssStyle");
var n=this.getInheritedProperty("checkboxSubLabel");
var c=this.getInheritedProperty("labelCssClass");
var d={
type:_CHECKBOX_,ref:".",labelCssClass:c,subLabel:n,onChange:Composite_XFormItem.onFieldChange,updateElement:function(u){
Super_XFormItem.updateCss.call(this,5);
Checkbox_XFormItem.prototype.updateElement.call(this,u)
}
,trueValue:this.getInheritedProperty("trueValue"),falseValue:this.getInheritedProperty("falseValue"),forceUpdate:true};
var r=this.getInheritedProperty("checkBoxElementChanged");
if(r){
d.elementChanged=r
}
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:"width:150px"};
var s=this.getInheritedProperty("customOvewriteChecks");
if(s){
e.visibilityChecks=s
}
if(h){
e.cssStyle=h
}
var o=this.getInheritedProperty("checkBoxLabel");
if(o){
d.label=o;
d.labelWrap=this.getInheritedProperty("labelWrap");
d.labelCssStyle=this.getInheritedProperty("labelCssStyle");
this.numCols=3;
this.colSpan=this.getInheritedProperty("conSpan")||3
}
var l=this.getInheritedProperty("checkBoxLabelLocation");
if(l){
d.labelLocation=l
}
var t=this.getInheritedProperty("checkboxAlign");
if(l){
d.align=t
}
this.items=[d,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_Checkbox_XFormItem.prototype.items=[];
Super_HostPort_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_HOSTPORT_","super_hostport",Super_HostPort_XFormItem,Super_XFormItem);
Super_HostPort_XFormItem.prototype.colSizes=["275px","275px","150px"];
Super_HostPort_XFormItem.prototype.useParentTable=false;
Super_HostPort_XFormItem.prototype.numCols=3;
Super_HostPort_XFormItem.prototype.colSpan=3;
Super_HostPort_XFormItem.prototype.initializeItems=function(){
var n={
type:_HOSTPORT_,ref:".",onChange:Composite_XFormItem.onFieldChange,onClick:"Super_HostPort_XFormItem.handleClick",onMouseout:"Super_HostPort_XFormItem.handleMouseout",updateElement:function(s){
Super_XFormItem.updateCss.call(this,5);
XFormItem.prototype.updateElement.call(this,s)
}};
var t={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:"width:150px"};
var o=this.getInheritedProperty("anchorCssStyle");
if(o){
t.cssStyle=o
}
var e=this.getInheritedProperty("textBoxLabel");
if(e){
n.label=e
}
this.items=[n,t];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_HostPort_XFormItem.prototype.items=[];
Super_HostPort_XFormItem.handleClick=function(t,s){
var o=s||this;
o=o.getParentItem();
var n=o.getInheritedProperty("onClick");
if(n!=null&&n!=""){
var e=new Function("event","item","return "+n+"( event, item);");
e(t,o)
}};
Super_HostPort_XFormItem.handleMouseout=function(t,s){
var o=s||this;
o=o.getParentItem();
var n=o.getInheritedProperty("onMouseout");
if(n!=null&&n!=""){
var e=new Function("event","item","return "+n+"(event, item);");
e(t,o)
}};
Super_DwtChooser_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_DWT_CHOOSER_","super_dwt_chooser",Super_DwtChooser_XFormItem,Super_XFormItem);
Super_DwtChooser_XFormItem.prototype.numCols=1;
Super_DwtChooser_XFormItem.prototype.sorted=true;
Super_DwtChooser_XFormItem.prototype.layoutStyle=DwtChooser.HORIZ_STYLE;
Super_DwtChooser_XFormItem.prototype.sourceRef=".";
Super_DwtChooser_XFormItem.prototype.widgetClass=DwtChooser;
Super_DwtChooser_XFormItem.prototype.align=_CENTER_;
Super_DwtChooser_XFormItem.prototype.initializeItems=function(){
var n=this.getInheritedProperty("anchorCssStyle");
var l=this.getInheritedProperty("sorted");
var f=this.getInheritedProperty("layoutStyle");
var c=this.getInheritedProperty("sourceRef");
var e=this.getInheritedProperty("widgetClass");
var h=this.getInheritedProperty("tableWidth");
var d=this.getInheritedProperty("labelWidth");
var r=this.getInheritedProperty("splitButtons");
var o=this.getInheritedProperty("resetToSuperLabel");
var m=this.getInheritedProperty("listWidth");
var t=this.getInheritedProperty("listHeight");
var s={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],cssSyle:(n?n:"width:150px;"),onChange:Composite_XFormItem.onFieldChange,label:o,align:_CENTER_,containerCssStyle:"width:90%;float:center;align:center;text-align:center;"};
var u={
type:_DWT_CHOOSER_,ref:".",onChange:Composite_XFormItem.onFieldChange,updateElement:function(p){
Super_XFormItem.updateCss.call(this,5);
this.updateWidget(p,true,Super_DwtChooser_XFormItem.getElemValue)
}
,listSize:"90%",sorted:l,layoutStyle:f,sourceRef:c,widgetClass:e,tableWidth:(h?h:null),labelWidth:(d?d:null),listWidth:(m?m:null),listHeight:(t?t:null),splitButtons:(r?r:null)};
this.items=[{
type:_GROUP_,align:_CENTER_,ref:".",width:"100%",numCols:3,colSizes:["*","200px","*"],items:[{
type:_CELLSPACER_}
,s,{
type:_CELLSPACER_}
],onChange:this.getInheritedProperty("onChange")}
,u];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_DwtChooser_XFormItem.getElemValue=function(){
return this.toString()
};
Super_DwtChooser_XFormItem.prototype.items=[];
Zimlet_SelectCheck_XFormItem=function(){};
XFormItemFactory.createItemType("_ZIMLET_SELECT_CHECK_","zimlet_select_check",Zimlet_SelectCheck_XFormItem,Super_XFormItem);
Zimlet_SelectCheck_XFormItem.prototype.numCols=2;
Zimlet_SelectCheck_XFormItem.prototype.colSizes=["275px","275px"];
Zimlet_SelectCheck_XFormItem.prototype.nowrap=false;
Zimlet_SelectCheck_XFormItem.prototype.labelWrap=true;
Zimlet_SelectCheck_XFormItem.prototype.items=[];
Zimlet_SelectCheck_XFormItem.prototype.labelWidth="275px";
Zimlet_SelectCheck_XFormItem.prototype.initializeItems=function(){
var s=this.getInheritedProperty("selectRef");
var t=this.getInheritedProperty("checkBoxLabel");
var r=this.getInheritedProperty("choices");
var o={
type:_CHECKBOX_,ref:".",label:t,labelLocation:_RIGHT_,elementChanged:function(c,l,h){
if(!c){
this.getForm().itemChanged(this.getParentItem(),null,h)
}}
,updateElement:function(h){
this.getElement().checked=h
}};
var e={
type:_OSELECT_CHECK_,choices:r,colSpan:3,ref:s,width:"275px",onChange:function(c,l,h){
if(this.getParentItem()&&this.getParentItem().getParentItem()&&this.getParentItem().getParentItem().getOnChangeMethod()){
return this.getParentItem().getParentItem().getOnChangeMethod().call(this,c,l,h)
}else{
return this.setInstanceValue(c)
}}
,forceUpdate:true,updateElement:function(h){
OSelect_XFormItem.prototype.updateElement.call(this,h)
}
,cssStyle:"margin-bottom:5px;margin-top:5px;border:2px inset gray;"};
var n={
type:_GROUP_,numCols:3,colSizes:["130px","15px","130px"],items:[e,{
type:_DWT_BUTTON_,label:ZaMsg.SelectAll,width:"120px",onActivate:function(l){
var h=this.getParentItem().items[0];
if(h){
h.selectAll(l)
}}}
,{
type:_CELLSPACER_,width:"15px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DeselectAll,width:"120px",onActivate:function(l){
var h=this.getParentItem().items[0];
if(h){
h.deselectAll(l)
}}}
]};
this.items=[o,{
type:_CELLSPACER_,width:this.labelWidth}
,n];
Composite_XFormItem.prototype.initializeItems.call(this)
};
SuperSelect_Check_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_SELECT_CHECK_","super_select_check",SuperSelect_Check_XFormItem,Super_XFormItem);
SuperSelect_Check_XFormItem.prototype.numCols=2;
SuperSelect_Check_XFormItem.prototype.colSizes=["275px","275px"];
SuperSelect_Check_XFormItem.prototype.nowrap=false;
SuperSelect_Check_XFormItem.prototype.labelWrap=true;
SuperSelect_Check_XFormItem.prototype.items=[];
SuperSelect_Check_XFormItem.prototype.labelWidth="275px";
SuperSelect_Check_XFormItem.prototype.initializeItems=function(){
var r=this.getInheritedProperty("selectRef");
var o=this.getInheritedProperty("limitLabel");
var h=this.getInheritedProperty("choices");
var n={
type:_RADIO_,groupname:this.id+"zimlet_select_check_grp"+r,ref:".",label:ZaMsg.NAD_UseCosSettings,labelLocation:_RIGHT_,elementChanged:function(d,c,l){
if(d==true){
this.getForm().itemChanged(this.getParentItem(),null,l)
}}
,updateElement:function(){
this.getElement().checked=!this.getModelItem().getLocalValue(this.getInstance(),this.refPath)
}};
var t={
type:_RADIO_,groupname:this.id+"zimlet_select_check_grp"+r,ref:".",label:o,labelLocation:_RIGHT_,updateElement:function(){
this.getElement().checked=this.getModelItem().getLocalValue(this.getInstance(),this.refPath)
}
,elementChanged:function(p,f,m){
var l=this.getModelItem().getSuperValue(this.getInstance());
var c=[];
if(l){
var u=l.length;
for(var d=0;
d<u;
d++){
c.push(l[d])
}}
this.getForm().itemChanged(this.getParentItem(),c,m)
}};
var e={
type:_OSELECT_CHECK_,choices:h,colSpan:3,ref:r,width:"275px",onChange:function(d,c,l){
if(this.getParentItem()&&this.getParentItem().getParentItem()&&this.getParentItem().getParentItem().getOnChangeMethod()){
return this.getParentItem().getParentItem().getOnChangeMethod().call(this,d,c,l)
}else{
return this.setInstanceValue(d)
}}
,forceUpdate:true,updateElement:function(d){
if(!(d instanceof Array)){
d=[d]
}
var c=d.length;
for(var l=c-1;
l>=0;
l--){
if(d[l]==ZaZimlet.NULL_ZIMLET){
d.splice(l,1);
break
}}
OSelect_XFormItem.prototype.updateElement.call(this,d)
}
,cssStyle:"margin-bottom:5px;margin-top:5px;border:2px inset gray;"};
var s={
type:_GROUP_,numCols:3,colSizes:["130px","15px","130px"],items:[e,{
type:_DWT_BUTTON_,label:ZaMsg.SelectAll,width:"120px",onActivate:function(c){
var l=this.getParentItem().items[0];
if(l){
l.selectAll(c)
}}}
,{
type:_CELLSPACER_,width:"15px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DeselectAll,width:"120px",onActivate:function(c){
var l=this.getParentItem().items[0];
if(l){
l.deselectAll(c)
}}}
]};
this.items=[n,t,{
type:_CELLSPACER_,width:this.labelWidth}
,s];
Composite_XFormItem.prototype.initializeItems.call(this)
};
SuperWiz_Select_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_WIZ_SELECT_CHECK_","super_wiz_select_check",SuperWiz_Select_XFormItem,SuperSelect_Check_XFormItem);
SuperWiz_Select_XFormItem.prototype.numCols=2;
SuperWiz_Select_XFormItem.prototype.colSizes=["200px","275px"];
SuperWiz_Select_XFormItem.prototype.labelWidth="200px";
SuperZimlet_Select_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_ZIMLET_SELECT_","super_zimlet_select",SuperZimlet_Select_XFormItem,Super_XFormItem);
SuperZimlet_Select_XFormItem.prototype.numCols=2;
SuperZimlet_Select_XFormItem.prototype.colSizes=["275px","*"];
SuperZimlet_Select_XFormItem.prototype.nowrap=false;
SuperZimlet_Select_XFormItem.prototype.labelWrap=true;
SuperZimlet_Select_XFormItem.prototype.items=[];
SuperZimlet_Select_XFormItem.prototype.labelWidth="275px";
SuperZimlet_Select_XFormItem.prototype.colSizes=["100px","*"];
SuperZimlet_Select_XFormItem.prototype.labelWidth="100px";
SuperZimlet_Select_XFormItem.prototype.initializeItems=function(){
var r=this.getInheritedProperty("selectRef");
var o=this.getInheritedProperty("limitLabel");
var h=this.getInheritedProperty("choices");
var n={
type:_RADIO_,groupname:this.id+"zimlet_select_check_grp"+r,ref:".",label:ZaMsg.NAD_UseCosSettings,labelLocation:_RIGHT_,elementChanged:function(d,c,l){
if(d==true){
this.getForm().itemChanged(this.getParentItem(),null,l)
}}
,updateElement:function(){
this.getElement().checked=!this.getModelItem().getLocalValue(this.getInstance(),this.refPath)
}};
var t={
type:_RADIO_,groupname:this.id+"zimlet_select_check_grp"+r,ref:".",label:o,labelLocation:_RIGHT_,updateElement:function(){
this.getElement().checked=this.getModelItem().getLocalValue(this.getInstance(),this.refPath)
}
,elementChanged:function(p,f,m){
var l=this.getModelItem().getSuperValue(this.getInstance());
var c=[];
if(l){
var u=l.length;
for(var d=0;
d<u;
d++){
c.push(l[d])
}}
this.getForm().itemChanged(this.getParentItem(),c,m)
}};
var e={
type:_ZA_ZIMLET_SELECT_,choices:h,colSpan:4,ref:r,label:"",labelLocation:_NONE_,width:"500px",cssStyle:"margin-bottom:5px;margin-top:5px;border:2px inset gray;"};
var s={
type:_GROUP_,numCols:4,colSizes:["130px","15px","130px"],items:[e,{
type:_DWT_BUTTON_,label:ZaMsg.SelectAll,width:"120px",onActivate:function(c){
var l=this.getParentItem().items[0];
if(l){
l.selectAll(c)
}}}
,{
type:_CELLSPACER_,width:"5px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DeselectAll,width:"120px",onActivate:function(c){
var l=this.getParentItem().items[0];
if(l){
l.deselectAll(c)
}}}
,{
type:_CELLSPACER_,width:"235px"}
]};
this.items=[n,t,{
type:_CELLSPACER_,width:this.labelWidth}
,s];
Composite_XFormItem.prototype.initializeItems.call(this)
};
SuperWiz_Zimlet_Select_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_WIZ_ZIMLET_SELECT_","super_wiz_zimlet_select",SuperWiz_Zimlet_Select_XFormItem,SuperZimlet_Select_XFormItem);
SuperWiz_Zimlet_Select_XFormItem.prototype.numCols=2;
SuperWiz_Zimlet_Select_XFormItem.prototype.colSizes=["50px","*"];
SuperWiz_Zimlet_Select_XFormItem.prototype.labelWidth="50px";
Super_Select1_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_SELECT1_","super_select1",Super_Select1_XFormItem,Super_XFormItem);
Super_Select1_XFormItem.prototype.labelCssClass="xform_label_left";
Super_Select1_XFormItem.prototype.labelCssStyle="width:269px";
Super_Select1_XFormItem.prototype.colSizes=["275px","150px"];
Super_Select1_XFormItem.prototype.nowrap=false;
Super_Select1_XFormItem.prototype.labelWrap=true;
Super_Select1_XFormItem.prototype.trueValue="TRUE";
Super_Select1_XFormItem.prototype.falseValue="FALSE";
Super_Select1_XFormItem.prototype.colSizes=["225px","150px"];
Super_Select1_XFormItem.prototype.initializeItems=function(){
var s={
type:_OSELECT1_,ref:".",onChange:Composite_XFormItem.onFieldChange,forceUpdate:true,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
OSelect1_XFormItem.prototype.updateElement.call(this,l)
}};
var t={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange};
var r=this.getInheritedProperty("anchorCssStyle");
if(r){
t.cssStyle=r
}else{
t.cssStyle="width:150px"
}
var h=this.getInheritedProperty("choices");
if(h){
s.choices=h
}
var n=this.getInheritedProperty("editable");
if(n){
s.editable=n
}
var o=this.getInheritedProperty("inputSize");
if(o){
s.inputSize=o
}
var e=this.getInheritedProperty("valueWidth");
if(e){
s.width=e
}
this.items=[s,t];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_Select1_XFormItem.prototype.useParentTable=false;
Super_Select1_XFormItem.prototype.numCols=2;
Super_Select1_XFormItem.prototype.items=[];
SuperWiz_Select1_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_SELECT1_","superwiz_select1",SuperWiz_Select1_XFormItem,Super_Select1_XFormItem);
SuperWiz_Select1_XFormItem.prototype.labelCssClass="xform_label_left ZaWizLabel";
SuperWiz_Select1_XFormItem.prototype.labelCssStyle="width:194px";
SuperWiz_Select1_XFormItem.prototype.colSizes=["250px","*"];
SuperWiz_Select1_XFormItem.prototype.valueWidth="auto";
SuperWiz_Select1_XFormItem.prototype.nowrap=false;
SuperWiz_Select1_XFormItem.prototype.labelWrap=true;
SuperWiz_Select1_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_Select1_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_Dwt_ColorPicker_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_DWT_COLORPICKER_","super_dwt_colorpicker",Super_Dwt_ColorPicker_XFormItem,Super_XFormItem);
Super_Dwt_ColorPicker_XFormItem.prototype.labelCssClass="xform_label_left";
Super_Dwt_ColorPicker_XFormItem.prototype.labelCssStyle="width:275px";
Super_Dwt_ColorPicker_XFormItem.prototype.colSizes=["275px","150px"];
Super_Dwt_ColorPicker_XFormItem.prototype.nowrap=false;
Super_Dwt_ColorPicker_XFormItem.prototype.labelWrap=true;
Super_Dwt_ColorPicker_XFormItem.prototype.useParentTable=false;
Super_Dwt_ColorPicker_XFormItem.prototype.numCols=2;
Super_Dwt_ColorPicker_XFormItem.prototype.colSizes=["225px","150px"];
Super_Dwt_ColorPicker_XFormItem.prototype.initializeItems=function(){
var e=this.getInheritedProperty("buttonImage");
var t=this.getInheritedProperty("width");
this.items=[{
type:_DWT_COLORPICKER_,ref:".",onChange:Composite_XFormItem.onFieldChange,forceUpdate:true,buttonImage:e,width:t,elementChanged:function(r,s,n){
this.getForm().itemChanged(this,r,n)
}
,updateElement:function(n){
Super_XFormItem.updateCss.call(this,5);
Dwt_ColorPicker_XFormItem.prototype.updateWidget.call(this,n)
}}
,{
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange}
];
var o=this.getInheritedProperty("anchorCssStyle");
if(o){
this.getItems()[1].cssStyle=o
}else{
this.getItems()[1].cssStyle="width:150px"
}
Composite_XFormItem.prototype.initializeItems.call(this)
};
SuperWiz_Dwt_ColorPicker_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_DWT_COLORPICKER_","superwiz_dwt_colorpicker",SuperWiz_Dwt_ColorPicker_XFormItem,Super_Dwt_ColorPicker_XFormItem);
SuperWiz_Dwt_ColorPicker_XFormItem.prototype.labelCssClass="xform_label_left ZaWizLabel";
SuperWiz_Dwt_ColorPicker_XFormItem.prototype.labelCssStyle="width:200px";
SuperWiz_Dwt_ColorPicker_XFormItem.prototype.colSizes=["250px","150px"];
SuperWiz_Dwt_ColorPicker_XFormItem.prototype.nowrap=false;
SuperWiz_Dwt_ColorPicker_XFormItem.prototype.labelWrap=true;
Super_Lifetime_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_LIFETIME_","super_lifetime",Super_Lifetime_XFormItem,Super_XFormItem);
Super_Lifetime_XFormItem.prototype.nowrap=false;
Super_Lifetime_XFormItem.prototype.labelWrap=true;
Super_Lifetime_XFormItem.prototype.numCols=4;
Super_Lifetime_XFormItem.prototype.colSpan=4;
Super_Lifetime_XFormItem.prototype.colSizes=["275px","70px","205px","*"];
Super_Lifetime_XFormItem.prototype.useParenttable=false;
Super_Lifetime_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Super_Lifetime_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_Lifetime_XFormItem.prototype.colSizes=["275px","70px","155px","*"];
Super_Lifetime_XFormItem.prototype.labelCssStyle="border-right: 1px solid black;";
Super_Lifetime_XFormItem.prototype.tableCssClass="grid_composite_table";
Super_Lifetime_XFormItem.prototype.initializeItems=function(){
var o=this.getInheritedProperty("txtBoxLabel");
var t=this.getInheritedProperty("labelCssClass");
var n=this.getInheritedProperty("toolTipContent");
var h={
type:_TEXTFIELD_,ref:".",label:o,toolTipContent:n,nowrap:this.getInheritedProperty("nowrap"),labelWrap:this.getInheritedProperty("labelWrap"),labelCssStyle:this.getLabelCssStyle(),labelCssClass:t,labelLocation:(o?_LEFT_:_NONE_),cssClass:"admin_xform_number_input",getDisplayValue:function(l){
var c="";
if(l!=null&&l.length>0){
if(l.length>1){
c=parseInt(l)
}else{
if(l=="0"){
c="0"
}else{
c=""
}}}
this.getParentItem()._numericPart=c;
return((typeof l==="undefined"||c=="0")?this.getModelItem().zeroValue:c)
}
,elementChanged:function(d,c,l){
if(d==this.getModelItem().zeroValue){
d=0
}
var u=d;
if(AjxUtil.isNumeric(d)){
u=d+this.getParentItem()._stringPart
}
this.getForm().itemChanged(this,u,l)
}
,onChange:Composite_XFormItem.onFieldChange,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
Textfield_XFormItem.prototype.updateElement.call(this,l)
}};
var s={
type:_OSELECT1_,ref:".",choices:ZaModel.getTimeChoices(),getDisplayValue:function(c){
var d="d";
if(c!=null&&c.length>0){
if(c.length>1){
var l=(c.toLowerCase()).charAt(c.length-1);
d=(l=="d"||l=="h"||l=="m"||l=="s")?l:"s"
}else{
if(c=="0"){
d="d"
}else{
d="s"
}}}
this.getParentItem()._stringPart=d;
return d
}
,elementChanged:function(u,c,l){
var d=this.getParentItem()._numericPart+u;
this.getForm().itemChanged(this.getParentItem(),d,l)
}
,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
OSelect1_XFormItem.prototype.updateElement.call(this,l)
}
,label:null,labelLocation:_NONE_,forceUpdate:true};
var r=this.getInheritedProperty("anchorCssStyle");
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:(r?r:"width:150px")};
this.items=[h,s,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_Lifetime_XFormItem.prototype.items=[];
SuperWiz_Lifetime_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_LIFETIME_","superwiz_lifetime",SuperWiz_Lifetime_XFormItem,Super_Lifetime_XFormItem);
SuperWiz_Lifetime_XFormItem.prototype.colSizes=["200px","80px","120px","150px"];
SuperWiz_Lifetime_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_Lifetime_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
SuperWiz_Lifetime_XFormItem.prototype.labelCssStyle="";
Super_Lifetime1_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_LIFETIME1_","super_lifetime1",Super_Lifetime1_XFormItem,Super_XFormItem);
Super_Lifetime1_XFormItem.prototype.nowrap=false;
Super_Lifetime1_XFormItem.prototype.labelWrap=true;
Super_Lifetime1_XFormItem.prototype.numCols=4;
Super_Lifetime1_XFormItem.prototype.colSpan=4;
Super_Lifetime1_XFormItem.prototype.colSizes=["275px","65px'","210px","*"];
Super_Lifetime1_XFormItem.prototype.useParenttable=false;
Super_Lifetime1_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Super_Lifetime1_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_Lifetime1_XFormItem.prototype.colSizes=["275px","65px'","160px","*"];
SuperWiz_Lifetime1_XFormItem=function(){};
SuperWiz_Lifetime1_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
SuperWiz_Lifetime1_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
XFormItemFactory.createItemType("_SUPERWIZ_LIFETIME1_","superwiz_lifetime1",SuperWiz_Lifetime1_XFormItem,Super_Lifetime1_XFormItem);
SuperWiz_Lifetime1_XFormItem.prototype.colSizes=["200px","80px","120px","150px"];
Super_Lifetime1_XFormItem.prototype.initializeItems=function(){
var t=this.getInheritedProperty("txtBoxLabel");
var h=this.getInheritedProperty("labelCssStyle");
var o=this.getInheritedProperty("toolTipContent");
var r={
type:_TEXTFIELD_,ref:".",label:t,toolTipContent:o,nowrap:this.getInheritedProperty("nowrap"),labelWrap:this.getInheritedProperty("labelWrap"),labelCssStyle:h||this.getLabelCssStyle(),labelLocation:(t?_LEFT_:_NONE_),cssClass:"admin_xform_number_input",getDisplayValue:function(l){
var c="1";
if(l!=null&&l.length>0){
if(l.length>1){
c=l.substr(0,l.length-1)
}else{
if(l=="0"){
c="0"
}else{
c="1"
}}}
this.getParentItem()._numericPart=c;
return c
}
,elementChanged:function(d,c,l){
var u=d+this.getParentItem()._stringPart;
this.getForm().itemChanged(this,u,l)
}
,onChange:Composite_XFormItem.onFieldChange,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
Textfield_XFormItem.prototype.updateElement.call(this,l)
}};
var n={
type:_OSELECT1_,ref:".",choices:ZaModel.getTimeChoices1(),getDisplayValue:function(l){
var c="d";
if(l!=null&&l.length>0){
if(l.length>1){
c=l.substr(l.length-1,1)
}else{
if(l!="0"){
c=(l=="d"||l=="h"||l=="m"||l=="s")?l:"d"
}}}
this.getParentItem()._stringPart=c;
return c
}
,elementChanged:function(u,c,l){
var d=this.getParentItem()._numericPart+u;
this.getForm().itemChanged(this.getParentItem(),d,l)
}
,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
OSelect1_XFormItem.prototype.updateElement.call(this,l)
}
,label:null,labelLocation:_NONE_,forceUpdate:true};
var s=this.getInheritedProperty("anchorCssStyle");
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:(s?s:"width:150px")};
this.items=[r,n,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_Lifetime1_XFormItem.prototype.items=[];
Super_Lifetime2_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_LIFETIME2_","super_lifetime2",Super_Lifetime2_XFormItem,Super_Lifetime1_XFormItem);
Super_Lifetime2_XFormItem.prototype.nowrap=false;
Super_Lifetime2_XFormItem.prototype.labelWrap=true;
Super_Lifetime2_XFormItem.prototype.numCols=4;
Super_Lifetime2_XFormItem.prototype.colSpan=4;
Super_Lifetime2_XFormItem.prototype.colSizes=["275px","65px'","210px","*"];
Super_Lifetime2_XFormItem.prototype.useParenttable=false;
Super_Lifetime2_XFormItem.prototype._stringPart="d";
Super_Lifetime2_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Super_Lifetime2_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_Lifetime2_XFormItem.prototype.colSizes=["275px","65px'","160px","*"];
SuperWiz_Lifetime2_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_LIFETIME2_","superwiz_lifetime2",SuperWiz_Lifetime2_XFormItem,Super_Lifetime2_XFormItem);
SuperWiz_Lifetime2_XFormItem.prototype.colSizes=["200px","80px","120px","150px"];
SuperWiz_Lifetime2_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_Lifetime2_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_Lifetime2_XFormItem.prototype.initializeItems=function(){
var o=this.getInheritedProperty("txtBoxLabel");
var t=this.getInheritedProperty("labelCssClass");
var n=this.getInheritedProperty("toolTipContent");
var h={
type:_TEXTFIELD_,ref:".",label:o,toolTipContent:n,nowrap:this.getInheritedProperty("nowrap"),labelWrap:this.getInheritedProperty("labelWrap"),labelCssStyle:this.getLabelCssStyle(),labelCssClass:t,labelLocation:(o?_LEFT_:_NONE_),cssClass:"admin_xform_number_input",getDisplayValue:function(l){
var c="1";
if(l!=null&&l.length>0){
if(l.length>1){
c=l.substr(0,l.length-1)
}else{
if(l=="0"){
c="0"
}else{
c="1"
}}}
this.getParentItem()._numericPart=c;
this.getParentItem()._stringPart="d";
return c
}
,elementChanged:function(d,c,l){
var u=d+"d";
this.getForm().itemChanged(this,u,l)
}
,onChange:Composite_XFormItem.onFieldChange,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
Textfield_XFormItem.prototype.updateElement.call(this,l)
}};
var s={
type:_OUTPUT_,ref:null,label:null,labelLocation:_NONE_,value:"d",getDisplayValue:function(l){
return AjxMsg.days
}};
var r=this.getInheritedProperty("anchorCssStyle");
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:(r?r:"width:150px")};
this.items=[h,s,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_Lifetime2_XFormItem.prototype.items=[];
Super_LifetimeMinutes_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_LIFETIME_MINUTES_","super_lifetime_minutes",Super_LifetimeMinutes_XFormItem,Super_Lifetime1_XFormItem);
Super_LifetimeMinutes_XFormItem.prototype.nowrap=false;
Super_LifetimeMinutes_XFormItem.prototype.labelWrap=true;
Super_LifetimeMinutes_XFormItem.prototype.numCols=4;
Super_LifetimeMinutes_XFormItem.prototype.colSpan=4;
Super_LifetimeMinutes_XFormItem.prototype.colSizes=["275px","80px","120px","150px"];
Super_LifetimeMinutes_XFormItem.prototype.useParenttable=false;
Super_LifetimeMinutes_XFormItem.prototype._stringPart="d";
Super_LifetimeMinutes_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
Super_LifetimeMinutes_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
SuperWiz_LifetimeMinutes_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_LIFETIME_MINUTES_","superwiz_lifetime2",SuperWiz_LifetimeMinutes_XFormItem,Super_LifetimeMinutes_XFormItem);
SuperWiz_LifetimeMinutes_XFormItem.prototype.colSizes=["200px","80px","120px","150px"];
SuperWiz_LifetimeMinutes_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_LifetimeMinutes_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Super_LifetimeMinutes_XFormItem.prototype.initializeItems=function(){
var o=this.getInheritedProperty("txtBoxLabel");
var t=this.getInheritedProperty("labelCssClass");
var n=this.getInheritedProperty("toolTipContent");
var h={
type:_TEXTFIELD_,ref:".",label:o,toolTipContent:n,nowrap:this.getInheritedProperty("nowrap"),labelWrap:this.getInheritedProperty("labelWrap"),labelCssStyle:this.getLabelCssStyle(),labelCssClass:t,labelLocation:(o?_LEFT_:_NONE_),cssClass:"admin_xform_number_input",getDisplayValue:function(l){
var c="1";
if(l!=null&&l.length>0){
if(l.length>1){
c=l.substr(0,l.length-1)
}else{
if(l=="0"){
c="0"
}else{
c="1"
}}}
this.getParentItem()._numericPart=c;
this.getParentItem()._stringPart="m";
return c
}
,elementChanged:function(d,c,l){
var u=d+"m";
this.getForm().itemChanged(this,u,l)
}
,onChange:Composite_XFormItem.onFieldChange,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
Textfield_XFormItem.prototype.updateElement.call(this,l)
}};
var s={
type:_OUTPUT_,ref:null,label:null,labelLocation:_NONE_,value:"m",getDisplayValue:function(l){
return AjxMsg.minutes
}};
var r=this.getInheritedProperty("anchorCssStyle");
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:(r?r:"width:150px")};
this.items=[h,s,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_LifetimeMinutes_XFormItem.prototype.items=[];
TopGrouper_XFormItem.prototype.colSizes=["275px","275px"];
TopGrouper_XFormItem.prototype.numCols=2;
ZACheckbox_XFormItem=function(){};
XFormItemFactory.createItemType("_ZA_CHECKBOX_","za_checkbox",ZACheckbox_XFormItem,Checkbox_XFormItem);
ZATopGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZA_TOP_GROUPER_","za_top_grouper",ZATopGrouper_XFormItem,TopGrouper_XFormItem);
ZATopGrouper_XFormItem.prototype.numCols=2;
ZATopGrouper_XFormItem.prototype.colSizes=["275px","auto"];
ZATopGrouper_XFormItem.isGroupVisible=function(r,o,s){
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
return true
}
if(!s){
s=this.getInstance()
}
if(!s){
return false
}
if(!s.getAttrs){
return false
}
if(!r&&!o){
return true
}
if(r){
var t=r.length;
for(var e=0;
e<t;
e++){
if(ZaItem.hasReadPermission(r[e],s)){
return true
}}}
if(o){
var n=o.length;
for(var e=0;
e<n;
e++){
if(ZaItem.hasRight(o[e],s)){
return true
}}}
return false
};
ZAPlainGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZA_PLAIN_GROUPER_","za_plain_grouper",ZAPlainGrouper_XFormItem,Group_XFormItem);
ZAPlainGrouper_XFormItem.prototype.colSizes=["100%"];
ZAPlainGrouper_XFormItem.prototype.numCols=1;
ZAPlainGrouper_XFormItem.prototype.width="100%";
ZAPlainGrouper_XFormItem.prototype.gridLabelCss="gridGroupBodyLabel";
ZAPlainGrouper_XFormItem.prototype.initializeItems=function(){
var n=this.getInheritedProperty("gridLabelCss");
var o=this.getItems();
var t;
if(o.length==1&&o[0].type=="group"){
o[0].border=1;
if(o[0].colSizes.length>1){
o[0].colSizes[o[0].colSizes.length-1]="100%"
}
t=o[0].items
}else{
t=o
}
for(var e=0;
e<t.length;
e++){
if(t[e].label||t[e].txtBoxLabel){
t[e].labelCssClass=n
}}
Group_XFormItem.prototype.initializeItems.call(this)
};
ZAWizTopGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZAWIZ_TOP_GROUPER_","zawiz_top_grouper",ZAWizTopGrouper_XFormItem,BaseTopGrouper_XFormItem);
ZAWizTopGrouper_XFormItem.prototype.numCols=2;
ZAWizTopGrouper_XFormItem.prototype.colSizes=["200px","auto"];
ZAWizTopGrouper_XFormItem.isGroupVisible=function(r,s,o){
if(!r){
return true
}
if(!s&&!o){
return true
}
if(s){
var t=s.length;
for(var e=0;
e<t;
e++){
if(ZaItem.hasWritePermission(s[e],r)){
return true
}}}
if(o){
var n=o.length;
for(var e=0;
e<n;
e++){
if(ZaItem.hasRight(o[e],r)){
return true
}}}
return false
};
ZAGroup_XFormItem=function(){};
XFormItemFactory.createItemType("_ZAGROUP_","zagroup",ZAGroup_XFormItem,Group_XFormItem);
ZAGroup_XFormItem.prototype.numCols=2;
ZAGroup_XFormItem.prototype.colSizes=["275px","275px"];
ZAGroup_XFormItem.prototype.border=1;
ZAGroup_XFormItem.prototype.width="100%";
ZAGroup_XFormItem.prototype.cssStyle="margin-top:20px;margin-bottom:0px;padding-bottom:0px;";
ZAGroup_XFormItem.isGroupVisible=function(r,s,o){
if(!r){
r=this.getInstance()
}
if(!r){
return true
}
if(!s&&!o){
return true
}
if(s){
var t=s.length;
for(var e=0;
e<t;
e++){
if(ZaItem.hasReadPermission(s[e],r)||ZaItem.hasWritePermission(s[e],r)){
return true
}}}
if(o){
var n=o.length;
for(var e=0;
e<n;
e++){
if(ZaItem.hasRight(o[e],r)){
return true
}}}
return false
};
ZAGroup_XFormItem.prototype.initializeItems=function(){
var o=this.getInheritedProperty("gridLabelCss")||"gridGroupBodyLabel";
var t=this.getItems();
if(t){
for(var e=0;
e<t.length;
e++){
if(t[e].type=="radio"){
continue
}
if(t[e].label||t[e].txtBoxLabel){
t[e].labelCssClass=o
}}}
Group_XFormItem.prototype.initializeItems.call(this)
};
ZAWizGroup_XFormItem=function(){};
XFormItemFactory.createItemType("_ZAWIZGROUP_","zawizgroup",ZAWizGroup_XFormItem,Group_XFormItem);
ZAWizGroup_XFormItem.prototype.numCols=2;
ZAWizGroup_XFormItem.prototype.colSizes=["125px","450px"];
ZAWizGroup_XFormItem.prototype.cssStyle="margin-top:20px;margin-bottom:0px;padding-bottom:0px;";
ZARightGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZARIGHT_GROUPER_","zaright_grouper",ZARightGrouper_XFormItem,Grouper_XFormItem);
ZARightGrouper_XFormItem.prototype.borderCssClass="RightGrouperBorder";
ZALeftGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZALEFT_GROUPER_","zaleft_grouper",ZALeftGrouper_XFormItem,Grouper_XFormItem);
ZALeftGrouper_XFormItem.prototype.borderCssClass="LeftGrouperBorder";
ZACenterGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZACENTER_GROUPER_","zacenter_grouper",ZACenterGrouper_XFormItem,Grouper_XFormItem);
ZACenterGrouper_XFormItem.prototype.borderCssClass="CenterGrouperBorder";
ZAAllScreenGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZAALLSCREEN_GROUPER_","zaallscreen_grouper",ZAAllScreenGrouper_XFormItem,Grouper_XFormItem);
ZAAllScreenGrouper_XFormItem.prototype.borderCssClass="AllScreenGrouperBorder";
ZASmallCenterGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_ZASMALL_CENTER_GROUPER_","zasmall_center_grouper",ZASmallCenterGrouper_XFormItem,Grouper_XFormItem);
ZASmallCenterGrouper_XFormItem.prototype.borderCssClass="CenterGrouperBorder";
ZASmallCenterGrouper_XFormItem.prototype.labelCssClass="SmallRadioGrouperLabel";
ZATabCase_XFormItem=function(){
Case_XFormItem.call(this)
};
XFormItemFactory.createItemType("_ZATABCASE_","zatabcase",ZATabCase_XFormItem,Case_XFormItem);
ZATabCase_XFormItem.prototype.caseVarRef=ZaModel.currentTab;
ZATabCase_XFormItem.prototype.visibilityChangeEventSources=[ZaModel.currentTab];
ZATabCase_XFormItem.prototype.align=_LEFT_;
ZATabCase_XFormItem.prototype.valign=_TOP_;
ZATabCase_XFormItem.prototype.paddingStyle="padding-left:15px;";
ZATabCase_XFormItem.prototype.width="98%";
ZATabCase_XFormItem.prototype.getTabLevel=function(){
return this.getInheritedProperty("tabLevel")||1
};
ZATabCase_XFormItem.prototype.getHeaderLevel=function(){
return this.getInheritedProperty("headerLevel")||1
};
ZATabCase_XFormItem.prototype.getHMargin=function(){
return this.getInheritedProperty("hMargin")||0
};
ZATabCase_XFormItem.prototype.getCustomPaddingStyle=function(){
return this.getInheritedProperty("paddingStyle")
};
ZATabCase_XFormItem.prototype.getCustomHeight=function(){
try{
var t=this.getForm();
var c=this.getTabLevel();
var m=this.getHeaderLevel();
var e=this.getForm().parent.getHtmlElement();
var h=parseInt(e.style.height);
if(isNaN(h)){
h=e.clientHeight?e.clientHeight:e.offsetHeight
}
var s=t.getItemsById("xform_header");
var n=0;
if(s){
var o=s[0];
if(o){
if(o.getContainer()){
o=o.getContainer()
}else{
o=o.getElement()
}
n=o.clientHeight?o.clientHeight:o.offsetHeight
}}
var d=t.getItemsById("xform_tabbar");
var l=0;
if(d){
var u=d[0];
if(u){
if(u.getContainer()){
u=u.getContainer()
}else{
u=u.getElement()
}
l=u.clientHeight?u.clientHeight:u.offsetHeight
}}
var p=n*m;
var f=l*c;
if(h<=0||h<(p+f+2)){
return"100%"
}else{
return h-p-f-2
}}
catch(r){}
return"100%"
};
ZATabCase_XFormItem.prototype.getCustomWidth=function(){
try{
var s=this.getForm();
var r=this.getForm().parent.getHtmlElement();
var t=parseInt(r.style.width);
if(isNaN(t)){
t=r.clientWidth?r.clientWidth:r.offsetWidth
}
if(t<=0){
return"100%"
}else{
var n=t-this.getHMargin();
if(this.cacheInheritedMethod("getCustomPaddingStyle","$getCustomPaddingStyle")){
var e=this.cacheInheritedMethod("getCustomPaddingStyle","$getCustomPaddingStyle").call(this);
if(e&&!AjxEnv.isIE){
n=n-15
}}
return n
}}
catch(o){}
return"100%"
};
ZATabCase_XFormItem.prototype.resizeHdlr=function(){
try{
var o=this.getElement();
var e=this.cacheInheritedMethod("getCustomHeight","$getCustomHeight").call(this);
var n=this.cacheInheritedMethod("getCustomWidth","$getCustomWidth").call(this);
Dwt.setSize(o,n,e)
}
catch(t){
alert(t)
}};
SuperTabCase_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_TABCASE_","super_tabcase",SuperTabCase_XFormItem,ZATabCase_XFormItem);
SuperTabCase_XFormItem.prototype.loadDataMethods=[];
SuperTabCase_XFormItem.prototype.show=function(e){
var n=this.getInheritedProperty("loadDataMethods");
if(n&&n instanceof Array){
var o=n.length;
for(var t=0;
t<o;
t++){
if(n[t]==null){
continue
}
if(typeof(n[t])=="function"){
n[t].call(this)
}else{
if(n[t] instanceof Array){
var s=n[t].shift();
if(!s||!s.apply){
continue
}
s.apply(this,n[t]);
n[t].unshift(s)
}}}}
Case_XFormItem.prototype.show.call(this,e)
};
SuperRepeat_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_REPEAT_","super_repeat",SuperRepeat_XFormItem,Super_XFormItem);
SuperRepeat_XFormItem.prototype.numCols=2;
SuperRepeat_XFormItem.prototype.colSizes=["275px","275px"];
SuperRepeat_XFormItem.prototype.nowrap=false;
SuperRepeat_XFormItem.prototype.labelWrap=true;
SuperRepeat_XFormItem.prototype.items=[];
SuperRepeat_XFormItem.prototype.labelWidth="275px";
SuperRepeat_XFormItem.prototype.initializeItems=function(){
var o=this.getInheritedProperty("repeatItems");
var t={
type:_REPEAT_,items:o,ref:".",label:null,labelLocation:_NONE_,repeatInstance:this.getRepeatInstance(),showAddButton:this.getShowAddButton(),showRemoveButton:this.getShowRemoveButton(),addButtonLabel:this.getInheritedProperty("addButtonLabel"),removeButtonLabel:this.getInheritedProperty("removeButtonLabel"),removeButtonCSSStyle:this.getInheritedProperty("removeButtonCSSStyle"),addButtonWidth:this.getInheritedProperty("addButtonWidth"),removeButtonWidth:this.getInheritedProperty("removeButtonWidth"),showAddOnNextRow:AjxUtil.isEmpty(this.getInheritedProperty("showAddOnNextRow"))?true:this.getInheritedProperty("showAddOnNextRow"),alwaysShowAddButton:false,updateElement:function(s){
Super_XFormItem.updateCss.call(this,5);
Repeat_XFormItem.prototype.updateElement.call(this,s)
}
,bmolsnr:true};
var n=this.getInheritedProperty("anchorCssStyle");
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange,cssStyle:(n?n:"width:150px")};
this.items=[t,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_DynSelect_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPER_DYNSELECT_","super_dynselect",Super_DynSelect_XFormItem,Super_XFormItem);
Super_DynSelect_XFormItem.prototype.labelCssClass="xform_label_left";
Super_DynSelect_XFormItem.prototype.labelCssStyle="width:275px";
Super_DynSelect_XFormItem.prototype.colSizes=["275px","150px"];
Super_DynSelect_XFormItem.prototype.nowrap=false;
Super_DynSelect_XFormItem.prototype.labelWrap=true;
Super_DynSelect_XFormItem.prototype.trueValue="TRUE";
Super_DynSelect_XFormItem.prototype.falseValue="FALSE";
Super_DynSelect_XFormItem.prototype.initializeItems=function(){
var n={
type:_DYNSELECT_,ref:".",onChange:Composite_XFormItem.onFieldChange,forceUpdate:true,errorLocation:_PARENT_,updateElement:function(l){
Super_XFormItem.updateCss.call(this,5);
DynSelect_XFormItem.prototype.updateElement.call(this,l)
}};
var e={
type:_SUPER_ANCHOR_HELPER_,ref:".",visibilityChecks:[Super_XFormItem.checkIfOverWriten],visibilityChangeEventSources:[this.getRefPath()],onChange:Composite_XFormItem.onFieldChange};
var s=this.getInheritedProperty("anchorCssStyle");
if(s){
e.cssStyle=s
}else{
e.cssStyle="width:150px"
}
var h=this.getInheritedProperty("choices");
if(h){
n.choices=h
}
var o=this.getInheritedProperty("slctToolTipContent");
if(o){
n.toolTipContent=o
}
var r=this.getInheritedProperty("dataFetcherClass");
if(r){
n.dataFetcherClass=r
}
var t=this.getInheritedProperty("dataFetcherMethod");
if(t){
n.dataFetcherMethod=t
}
this.items=[n,e];
Composite_XFormItem.prototype.initializeItems.call(this)
};
Super_DynSelect_XFormItem.prototype.useParentTable=false;
Super_DynSelect_XFormItem.prototype.numCols=2;
Super_DynSelect_XFormItem.prototype.items=[];
SuperWiz_DynSelect_XFormItem=function(){};
XFormItemFactory.createItemType("_SUPERWIZ_DYNSELECT_","superwiz_dynselect",SuperWiz_DynSelect_XFormItem,Super_DynSelect_XFormItem);
SuperWiz_DynSelect_XFormItem.prototype.labelCssClass="xform_label_left ZaWizLabel";
SuperWiz_DynSelect_XFormItem.prototype.labelCssStyle="width:200px";
SuperWiz_DynSelect_XFormItem.prototype.colSizes=["250px","150px"];
SuperWiz_DynSelect_XFormItem.prototype.nowrap=false;
SuperWiz_DynSelect_XFormItem.prototype.labelWrap=true;
SuperWiz_DynSelect_XFormItem.prototype.visibilityChecks=[ZaItem.hasWritePermission];
SuperWiz_DynSelect_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
Categorized_DynSelect_XFormItem=function(){};
XFormItemFactory.createItemType("_CATEGORIZED_DYNSELECT_","categorized_dynselect",Categorized_DynSelect_XFormItem,DynSelect_XFormItem);
Categorized_DynSelect_XFormItem.prototype.itemCSS="ZaCategorizedSearchItem "+DynSelect_XFormItem.prototype.cssClass;
Categorized_DynSelect_XFormItem.TYPE_LABEL="label";
Categorized_DynSelect_XFormItem.TYPE_SEARCH="search";
Categorized_DynSelect_XFormItem.prototype.changeChoicesCallback=function(o,e,t){
DynSelect_XFormItem.prototype.changeChoicesCallback.call(this,this._enrichChoices(o),e,t)
};
Categorized_DynSelect_XFormItem.prototype.getChoicesHTML=function(){
var n=this.choices.getChoiceObject();
if(!n){
return""
}
var t=new AjxBuffer();
this.outputChoicesHTMLStart(t);
var o=this.getChoiceCssClass();
for(var e=0;
e<n.length;
e++){
t.append("",this.getChoiceHTML(e,o))
}
this.outputChoicesHTMLEnd(t);
return t.toString()
};
Categorized_DynSelect_XFormItem.prototype.getChoiceHTML=function(r,e){
var s=this.choices.getChoiceObject()[r];
if(s.type==Categorized_DynSelect_XFormItem.TYPE_LABEL){
return this._getLabelHTML(s.name)
}
var o="onSearchClick";
var t=s.name;
if(s.type!=Categorized_DynSelect_XFormItem.TYPE_SEARCH){
o="onChoiceClick";
if(s.attrs.displayName){
t=s.attrs.displayName+" "+t
}}
var n=this.getFormGlobalRef()+".getItemById('"+this.getId()+"')";
return AjxBuffer.concat('<tr><td><div id="',this.getId(),"_choice_",r,'" ','class="',e,'"',' onmouseover="',n,".onChoiceOver(",r,', event||window.event)"',' onmouseout="',n,".onChoiceOut(",r,', event||window.event)"',' onclick="',n,".",o,"(",r,')"'," itemnum = '",r,"'",">",this._tailorLabel(t),"</div></td></tr>")
};
Categorized_DynSelect_XFormItem.prototype.onChoiceClick=function(e,o){
var t=this.choices.getChoiceObject()[e];
if(!t){
return
}
if(t.type==ZaItem.ACCOUNT||t.type==ZaItem.DL||t.type==ZaItem.RESOURCE||t.type==ZaItem.ALIAS){
ZaApp.getInstance().getAccountListController()._editItem(t);
this.hideMenu();
return
}
if(t.type==ZaItem.DOMAIN){
ZaApp.getInstance().getDomainListController()._editItem(t);
this.hideMenu();
return
}
if(t.type==ZaItem.COS){
ZaApp.getInstance().getCosListController()._editItem(t);
this.hideMenu();
return
}};
Categorized_DynSelect_XFormItem.prototype.onSearchClick=function(s,e){
var o=this.choices.getChoiceObject()[s];
if(o.target||o.target==""){
var t=ZaApp.getInstance().getSearchListController();
var n=t._searchField;
n.searchSelectedType=o.target;
n.restoreSearchFilter();
ZaSearchField.srchButtonHndlr.call(this,o.target);
return
}};
Categorized_DynSelect_XFormItem.prototype.getChoiceCssClass=function(){
return this.itemCSS+"_choice"
};
Categorized_DynSelect_XFormItem.prototype.getChoiceSelectedCssClass=function(){
return this.itemCSS+"_choice_selected"
};
Categorized_DynSelect_XFormItem.prototype.processEntryKey=function(){
if(this.isSelecting||this.menuUp){
if(this.__currentHiliteItem>0){
var t=this.choices.getChoiceObject()[this.__currentHiliteItem];
if(t.type==Categorized_DynSelect_XFormItem.TYPE_SEARCH){
this.onSearchClick(this.__currentHiliteItem);
return
}else{
if(t.type!=Categorized_DynSelect_XFormItem.TYPE_LABEL){
this.onChoiceClick(this.__currentHiliteItem);
this._searchFieldValue("");
return
}}}}
var o=this.getInstanceValue();
var e=this.getInheritedProperty("entryKeyMethod");
if(e instanceof AjxCallback){
e.run(this,o)
}};
Categorized_DynSelect_XFormItem.prototype.hiliteNextChoice=function(){
do{
DynSelect_XFormItem.prototype.hiliteNextChoice.call(this);
var e=this.choices.getChoiceObject()[this.__currentHiliteItem]
}
while(e.type==Categorized_DynSelect_XFormItem.TYPE_LABEL)
};
Categorized_DynSelect_XFormItem.prototype.hilitePreviousChoice=function(){
do{
DynSelect_XFormItem.prototype.hilitePreviousChoice.call(this);
var e=this.choices.getChoiceObject()[this.__currentHiliteItem]
}
while(e.type==Categorized_DynSelect_XFormItem.TYPE_LABEL)
};
Categorized_DynSelect_XFormItem.prototype._enrichChoices=function(n){
if(n.length<=0){
return n
}
var o={};
for(var t=0;
t<n.length;
t++){
o[n[t].type]=1;
n[t].value=""
}
var h=this._searchFieldValue();
var e='"'+h+'"';
n.splice(0,0,{
type:Categorized_DynSelect_XFormItem.TYPE_LABEL,name:ZaMsg.SearchBestMatches,value:h}
);
n.push({
type:Categorized_DynSelect_XFormItem.TYPE_LABEL,name:"&nbsp;",value:h}
);
n.push({
type:Categorized_DynSelect_XFormItem.TYPE_LABEL,name:ZaMsg.SearchFullResultsFor,value:h}
);
n.push({
type:Categorized_DynSelect_XFormItem.TYPE_SEARCH,name:e,value:h,target:""}
);
for(var r in o){
if(o.hasOwnProperty(r)){
var s=ZaSearch.TYPES[r];
n.push({
type:Categorized_DynSelect_XFormItem.TYPE_SEARCH,name:AjxMessageFormat.format(ZaMsg["SearchAll_"+s],[e]),value:h,target:s}
)
}}
return n
};
Categorized_DynSelect_XFormItem.prototype._getLabelHTML=function(e){
return AjxBuffer.concat("<tr><td><div class='ZaCategorizedSearchLabel'>",e,"</div></td></tr>")
};
Categorized_DynSelect_XFormItem.prototype._tailorLabel=function(t){
var o=Dwt.getBounds(this.getContainer()).width-20;
var e=Math.floor((o-30)/5.5);
if(e<t.length){
t=t.substring(0,(e-3))+"..."
}
return t
};
Categorized_DynSelect_XFormItem.prototype._searchFieldValue=function(o){
var e=ZaApp.getInstance().getSearchListController();
var t=e._searchField;
if(arguments.length==0){
return t.getSearchFieldElement().value
}
t.getSearchFieldElement().value=o
};
Ip_XModelItem=function(){};
XModelItemFactory.createItemType("_IP_","ip",Ip_XModelItem,String_XModelItem);
Ip_XModelItem.EXACT_IP_ADDRESS_RE=/^((25[0-5]|2[0-4]\d|(1\d|[1-9])?\d)\.){3}(25[0-5]|2[0-4]\d|(1\d|[1-9])\d|[1-9])$/;
Ip_XModelItem.prototype.validateType=function(e){
if(e){
if(!AjxUtil.isString(e)){
throw this.getModel().getErrorMessage("notAString",e)
}
if(Ip_XModelItem.EXACT_IP_ADDRESS_RE.test(e)){
return e
}else{
throw ZaMsg.ERROR_INVALID_IP_ADDR
}}};
Ip_XModelItem.prototype.maxLength=64;
Collaborated_Select_XFormItem=function(){};
XFormItemFactory.createItemType("_COLLAB_SELECT_","collaborated_select",Collaborated_Select_XFormItem,Repeat_XFormItem);
Collaborated_Select_XFormItem.prototype.initializeItems=function(){
this.colSelect=this._findColSelect(this.getItems());
if(!this.colSelect){
return
}
this.colSelect.ancestorId=this.id;
this.colSelect.onChange=Collaborated_Select_XFormItem.selectChanged;
var t=this.colSelect.choices;
var e=new XFormChoices(t.getChoiceObject(),t._type,t._valueProperty,t._labelProperty);
this.colSelect.choices=e;
this.choiceItems=t.getChoiceObject();
this.__ownChoices=e;
this.__valueProperty=t._valueProperty;
this.__availNum=this.choiceItems.length;
this.__selected=[];
this.__excluded=[];
if(this.colSelect.required==true){
this.getAddButton().visibilityChecks.push(Collaborated_Select_XFormItem.isAddButtonVisible)
}
Repeat_XFormItem.prototype.initializeItems.call(this)
};
Collaborated_Select_XFormItem.prototype.getFilterMethod=function(){
return this.cacheInheritedMethod("filterMethod","$filterMethod")
};
Collaborated_Select_XFormItem.prototype.updateElement=function(t){
if(this.__origInstance!=this.getForm().getInstance()){
this.__origInstance=this.getForm().getInstance();
if(this.getFilterMethod()&&AjxUtil.isFunction(this.getFilterMethod())){
var e=this.getFilterMethod().call(this,this.getForm().getInstance());
this.filterOrigItems(e);
this.resetChoices()
}else{
this.resetChoices(true)
}}
Repeat_XFormItem.prototype.updateElement.call(this,t)
};
Collaborated_Select_XFormItem.prototype.resetChoices=function(e){
if(!this.colSelect){
return
}
this.__selected=[];
if(e){
this.__excluded=[];
this.__availNum=this.choiceItems.length
}
this._updateChoices()
};
Collaborated_Select_XFormItem.selectChanged=function(t,s,n){
var o=n.getItemById(this.__attributes.ancestorId);
var r=this.getInstanceValue();
this.setInstanceValue(t);
o._markSelected(t,r);
var e=new AjxTimedAction(o,Collaborated_Select_XFormItem.prototype._updateChoices,[]);
AjxTimedAction.scheduleAction(e,ZaController.CLICK_DELAY)
};
Collaborated_Select_XFormItem.isAddButtonVisible=function(){
if(!this.getParentItem().getParentItem().colSelect){
return true
}
return(this.getParentItem().getInstanceCount()<this.getParentItem().getParentItem().__availNum)
};
Collaborated_Select_XFormItem.prototype.filterOrigItems=function(n){
if(!this.choiceItems||!(this.choiceItems instanceof Array)||!n){
return
}
if(!(n instanceof Array)){
n=[n]
}
var t=0;
for(var e=0;
e<this.choiceItems.length;
e++){
this.__excluded[e]=false;
for(var o=0;
o<n.length;
o++){
if(this.choiceItems[e][this.__valueProperty]==n[o]){
this.__excluded[e]=true;
t++;
break
}}}
this.__availNum-=t
};
Collaborated_Select_XFormItem.prototype.addRowButtonClicked=function(e){
Repeat_XFormItem.prototype.addRowButtonClicked.call(this,e);
this._updateChoices()
};
Collaborated_Select_XFormItem.prototype.removeRowButtonClicked=function(e){
var t=this.getInstanceValue()[e];
var o=t[this.colSelect.ref];
this._markSelected(null,o);
this._updateChoices();
Repeat_XFormItem.prototype.removeRowButtonClicked.call(this,e)
};
Collaborated_Select_XFormItem.prototype._updateChoices=function(){
this.__ownChoices.setChoices(this._getSelectable());
this.__ownChoices.dirtyChoices()
};
Collaborated_Select_XFormItem.prototype._findColSelect=function(n){
if(!n){
return
}
if(n.type=="oselect1"){
if(n.colSelect){
return n
}
return
}
var t;
if(n.items&&n.items instanceof Array){
t=n.items
}else{
if(n instanceof Array){
t=n
}}
if(t){
for(var o=0;
o<t.length;
o++){
var e=this._findColSelect(t[o]);
if(e){
return e
}}}};
Collaborated_Select_XFormItem.prototype._markSelected=function(t,e){
for(var o=0;
o<this.choiceItems.length;
o++){
if(this.choiceItems[o][this.__valueProperty]==e){
this.__selected[o]=false
}}
for(var o=0;
o<this.choiceItems.length;
o++){
if(this.choiceItems[o][this.__valueProperty]==t){
this.__selected[o]=true
}}};
Collaborated_Select_XFormItem.prototype._getSelectable=function(){
var e=[];
for(var t=0;
t<this.choiceItems.length;
t++){
if(this.__excluded[t]){
continue
}
if(this.__selected[t]){
continue
}
e.push(this.choiceItems[t])
}
return e
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaSplashScreen")){
ZaSplashScreen=function(o){
var t="LoginScreen";
DwtComposite.call(this,{
parent:o,className:t,posStyle:DwtControl.ABSOLUTE_STYLE}
);
this._origClassName=t;
this._xparentClassName=t+"-Transparent";
this.setBounds(0,0,"100%","100%");
var n=this.getHtmlElement();
n.style.zIndex=Dwt.Z_SPLASH;
n.className=t;
this.setVisible(false);
var s=ZLoginFactory.copyDefaultParams(ZaMsg);
s.showPanelBorder=true;
s.showForm=true;
s.showUserField=false;
s.showPasswordField=false;
s.showRememberMeCheckbox=false;
s.showLogOff=false;
s.showButton=false;
s.showLoading=true;
s.companyURL=ZaAppCtxt.getLogoURI();
s.copyrightText=ZaItem.getSplashScreenCopyright();
s.clientLevelNotice=ZabMsg.clientLevelNotice?ZabMsg.clientLevelNotice:"";
var e=ZLoginFactory.getLoginDialogHTML(s);
this.setContent(e)
};
ZaSplashScreen.prototype=new DwtComposite;
ZaSplashScreen.prototype.constructor=ZaSplashScreen;
ZaSplashScreen.prototype.toString=function(){
return"ZaSplashScreen"
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaCurrentAppToolBar")){
ZaCurrentAppToolBar=function(t,e,o){
DwtToolBar.call(this,t,e,Dwt.ABSOLUTE_STYLE);
this._currentAppLabel=new ZaToolBarLabel(this,DwtLabel.IMAGE_LEFT|DwtLabel.ALIGN_LEFT,"currentAppLabel");
this._currentTitle=null;
this._lastWidth=null;
this._currentWidth=null;
this.addFiller()
};
ZaCurrentAppToolBar.prototype=new DwtToolBar;
ZaCurrentAppToolBar.prototype.constructor=ZaCurrentAppToolBar;
ZaCurrentAppToolBar.prototype.toString=function(){
return"ZaCurrentAppToolBar"
};
ZaCurrentAppToolBar.prototype._resizeListener=function(){
if(!this._currentTitle){
return
}
if(!this._currentWidth&&!this._lastWidth){
this._lastWidth=this._currentWidth=this.getBounds().width;
this.setCurrentAppLabel(this._currentTitle)
}else{
this._currentWidth=this.getBounds().width;
if(this._lastWidth!=this._currentWidth){
this._lastWidth=this._currentWidth;
this.setCurrentAppLabel(this._currentTitle)
}}};
ZaCurrentAppToolBar.prototype.setCurrentAppLabel=function(n){
this._currentTitle=n;
if(!this._currentWidth&&!this._lastWidth){
this._lastWidth=this._currentWidth=this.getBounds().width
}
var o=ZaCurrentAppToolBar.getWidth(n);
if(o>(this._currentWidth-10)){
var t=this._currentWidth-ZaCurrentAppToolBar.getWidth("...")-10;
var e=Math.floor(t*(n.length)/o);
n=n.substring(0,(e-3))+"..."
}
this._currentAppLabel.setText(n)
};
ZaCurrentAppToolBar.WIDTH={};
ZaCurrentAppToolBar._cacheSize=0;
ZaCurrentAppToolBar.MAX_CACHE_SIZE=10;
ZaCurrentAppToolBar.getWidth=function(s){
if(!ZaCurrentAppToolBar._testSpan){
var n=ZaCurrentAppToolBar._testSpan=document.createElement("SPAN");
n.style.position=Dwt.ABSOLUTE_STYLE;
var o=DwtShell.getShell(window).getHtmlElement();
o.appendChild(n);
Dwt.setLocation(n,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
n.style.fontWeight="bold";
n.style.fontSize="13px"
}
var t=ZaCurrentAppToolBar.WIDTH;
if(t[s]){
return t[s]
}
if(ZaCurrentAppToolBar._cacheSize>=ZaCurrentAppToolBar.MAX_CACHE_SIZE){
ZaCurrentAppToolBar.WIDTH={};
ZaCurrentAppToolBar._cacheSize=0
}
var n=ZaCurrentAppToolBar._testSpan;
n.innerHTML=s;
var e=t[s]=Dwt.getSize(n).x;
ZaCurrentAppToolBar._cacheSize++;
return e
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaCrtAppTreeHeader")){
ZaCrtAppTreeHeader=function(o,t,n){
var e=t||"ZaCtrAppTreeHeader";
DwtButton.call(this,o,"",e,Dwt.ABSOLUTE_STYLE);
this.preObj=null;
this._historyMgr=ZaZimbraAdmin.getInstance().getHisotryMgr();
this._historyMgr.addChangeListener(new AjxListener(this,this.updateMenu));
this.menu=new ZaPopupMenu(this);
this.menu.setWidth(150);
this.setMenu(this.menu)
};
ZaCrtAppTreeHeader.prototype=new DwtButton;
ZaCrtAppTreeHeader.prototype.constructor=ZaCrtAppTreeHeader;
ZaCrtAppTreeHeader.prototype._dropDownImg="";
ZaCrtAppTreeHeader.prototype._dropDownDepImg="";
ZaCrtAppTreeHeader.prototype._dropDownHovImg="";
ZaCrtAppTreeHeader.defaultImg="CollapseLeft";
ZaCrtAppTreeHeader.normalBgImg="ImgArrowShapeNormal";
ZaCrtAppTreeHeader.hoverBgImg="ImgArrowShapeHover";
ZaCrtAppTreeHeader.prototype.toString=function(){
return"ZaCrtAppTreeHeader"
};
ZaCrtAppTreeHeader.prototype.TEMPLATE="admin.Widgets#ZaTreeHeaderButton";
ZaCrtAppTreeHeader.prototype._createHtmlFromTemplate=function(e,t){
t.bgImg=ZaCrtAppTreeHeader.normalBgImg;
DwtButton.prototype._createHtmlFromTemplate.call(this,e,t);
this._tabelEl=document.getElementById(t.id+"_table");
this._arrowEl=document.getElementById(t.id+"_doubleArrow");
this._imgEl=document.getElementById(t.id+"_img")
};
ZaCrtAppTreeHeader.prototype.setRightImg=function(t){
if(!this._imgEl){
return
}
var e=t||ZaCrtAppTreeHeader.defaultImg;
this._imgEl.innerHTML=AjxImg.getImageHtml(e)
};
ZaCrtAppTreeHeader.prototype._handleClick=function(t){
if(this._isArrowEvent(t)){
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
e.setSelectionByPath(this.preObj.path,false)
}};
ZaCrtAppTreeHeader.prototype._getPreviousObject=function(s){
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
var h=e.getCurrentRootItem();
var o=h.getData("dataItem");
var s=e.getABPath(o);
var r=ZaTree.getPathItems(s);
if(r.length>1){
if(r[1]==ZaMsg.OVP_search){
r=[r[0]]
}else{
r.pop()
}}
var t=r[r.length-1];
var n=ZaTree.getPathByArray(r);
return new ZaHistory(n,t)
};
ZaCrtAppTreeHeader.prototype._showHoverImage=function(e){
if(this._tabelEl){
if(e){
Dwt.delClass(this._tabelEl,ZaCrtAppTreeHeader.normalBgImg,ZaCrtAppTreeHeader.hoverBgImg)
}else{
Dwt.delClass(this._tabelEl,ZaCrtAppTreeHeader.hoverBgImg,ZaCrtAppTreeHeader.normalBgImg)
}}};
ZaCrtAppTreeHeader.prototype._isDropDownEvent=function(s){
if(this._dropDownEventsEnabled&&this._dropDownEl){
var n=s.docX;
var r=Dwt.toWindow(this._dropDownEl,0,0,window).x;
var e=true;
if(n<r){
e=false
}
var t=true;
if(this._imgEl){
var o=Dwt.toWindow(this._imgEl,0,0,window).x;
if(n>=o){
t=false
}}
return e&&t
}
return false
};
ZaCrtAppTreeHeader.prototype._isArrowEvent=function(n){
if(this._arrowEl&&this._textEl){
var s=Dwt.getBounds(this._arrowEl);
var o=Dwt.getBounds(this._textEl);
var r=s.x;
var e=o.x+o.width;
var t=n.docX;
if(t<r){
return false
}
if(t>=e){
return false
}
return true
}
return false
};
ZaCrtAppTreeHeader.prototype.setText=function(t){
this.preObj=this._getPreviousObject();
var e=this.getDisplayContent(this.preObj.displayName);
DwtLabel.prototype.setText.call(this,e)
};
ZaCrtAppTreeHeader.prototype.getDisplayContent=function(s){
var n=s;
if(s){
var h=Dwt.getSize(this._textEl);
var o=AjxStringUtil.getWidth(s);
if(o>h.x){
var r=s.length;
var t=h.x-AjxStringUtil.getWidth("...");
var e=Math.floor(t*r/o);
n=s.substring(0,e)+"..."
}}
return n
};
ZaCrtAppTreeHeader.prototype.popup=function(n){
n=n||this.getMenu();
if(!n){
return
}
var m=n.parent;
var l=m.getBounds();
var u=n.shell.getSize();
var e=n.getSize();
var f=m.getHtmlElement();
var o=Dwt.toWindow(f,0,0);
var t=(f.style.borderLeftWidth=="")?0:parseInt(f.style.borderLeftWidth);
var d;
var h=m._dropDownEl;
if(!h){
d=o.x+t
}else{
var s=Dwt.toWindow(h,0,0);
d=s.x
}
d=((d+e.x)>=u.x)?u.x-e.x:d;
var c;
var r=(f.style.borderTopWidth=="")?0:parseInt(f.style.borderTopWidth);
r+=(f.style.borderBottomWidth=="")?0:parseInt(f.style.borderBottomWidth);
c=o.y+l.height+r;
n.popup(0,d,c)
};
ZaCrtAppTreeHeader.searchHistoryCache={};
ZaCrtAppTreeHeader.isFound=function(e){
if(!ZaCrtAppTreeHeader.searchHistoryCache[e]){
ZaCrtAppTreeHeader.searchHistoryCache[e]=true;
return false
}
return true
};
ZaCrtAppTreeHeader.prototype.createMenu=function(){
var s=0;
var e;
var l=new AjxListener(this,this.goToTreeItemListener);
var n=this._historyMgr.getAllHistory();
ZaCrtAppTreeHeader.searchHistoryCache={};
if(n.size()>20){
var o=n.size()-1;
var r=0;
for(o=n.size()-1;
o>=0;
o--){
var h=n.get(o);
if(!h.isShowInHistory){
continue
}
if(ZaCrtAppTreeHeader.isFound(h.path)){
continue
}
r++;
if(r==20){
break
}}
if(o>0){
s=o
}}
var h;
if(s>0){
h=n.get(0);
e=new DwtMenuItem({
parent:this.menu,style:DwtMenuItem.NO_STYLE,id:ZaId.getMenuItemId(this._contextId,s+h.path)}
);
e.setText(h.displayName);
e.setData("history",h);
e.addSelectionListener(l);
s=s+1
}
ZaCrtAppTreeHeader.searchHistoryCache={};
var t=s;
for(s=n.size()-1;
s>=t;
s--){
h=n.get(s);
if(!h.isShowInHistory){
continue
}
if(ZaCrtAppTreeHeader.isFound(h.path)){
continue
}
e=new DwtMenuItem({
parent:this.menu,style:DwtMenuItem.NO_STYLE,id:ZaId.getMenuItemId(this._contextId,s+h.path)}
);
e.setText(h.displayName);
e.setEnabled(h.enabled);
e.setData("history",h);
e.addSelectionListener(l)
}
this.menu.createSeparator();
e=new DwtMenuItem({
parent:this.menu,style:DwtMenuItem.NO_STYLE,id:ZaId.getMenuItemId(this._contextId,"clearHistory")}
);
e.setText(ZaMsg.LBL_Treeheader_clearHistory);
e.setData("history",h);
e.addSelectionListener(new AjxListener(this,this.clearHistory))
};
ZaCrtAppTreeHeader.prototype.updateMenu=function(){
this.menu.removeChildren();
this.createMenu()
};
ZaCrtAppTreeHeader.prototype.goToTreeItemListener=function(e){
var t=e.item.getData("history");
t.goToView()
};
ZaCrtAppTreeHeader.prototype.clearHistory=function(e){
this._historyMgr.removeHistory()
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaServerVersionInfo")){
ZaServerVersionInfo=function(){};
ZaServerVersionInfo.load=function(){
if(!ZaServerVersionInfo._loaded){
var t=AjxSoapDoc.create("BatchRequest","urn:zimbra");
t.setMethodAttribute("onerror","continue");
var o=t.set("GetVersionInfoRequest",null,null,ZaZimbraAdmin.URN);
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=t;
s.noAuthToken=true;
var n=r.invoke(s).Body.BatchResponse;
var e=n.GetVersionInfoResponse[0];
ZaServerVersionInfo.buildDate=this._parseDateTime(e.info[0].buildDate);
ZaServerVersionInfo.host=e.info[0].host;
ZaServerVersionInfo.release=e.info[0].release;
ZaServerVersionInfo.version=e.info[0].version
}};
ZaServerVersionInfo._parseDate=function(t){
var o=new Date();
o.setHours(0,0,0,0);
var s=parseInt(t.substr(0,4),10);
var n=parseInt(t.substr(4,2),10);
var e=parseInt(t.substr(6,2),10);
o.setFullYear(s);
o.setMonth(n-1);
o.setMonth(n-1);
o.setDate(e);
return o
};
ZaServerVersionInfo._parseDateTime=function(e){
var n=ZaServerVersionInfo._parseDate(e);
var t=parseInt(e.substr(9,2),10);
var o=parseInt(e.substr(11,2),10);
n.setHours(t,o,0,0);
return n
}
}
if(AjxPackage.define("zimbraAdmin.common.MenuButton_XFormItem")){
MenuButton_XFormItem=function(){};
XFormItemFactory.createItemType("_MENU_BUTTON_","menu_button",MenuButton_XFormItem,Dwt_Button_XFormItem);
MenuButton_XFormItem.prototype.constructWidget=function(){
var t=Dwt_Button_XFormItem.prototype.constructWidget.call(this);
var e=this.getNormalizedValues();
if(e&&e.length){
var o=new ZaPopupMenu(t,null,null,e);
t.setMenu(o)
}
return t
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaAutoCompleteListView")){
var i=1;
ZaAutoCompleteListView=function(r){
var o=r.className?r.className:"autoCompleteList";
DwtComposite.call(this,r.parent,o,DwtControl.ABSOLUTE_STYLE);
var s=null;
try{
this.shell.getData(ZaAppCtxt.LABEL).getApp()
}
catch(n){}
var t=r.dataLoaderClass;
this._dataLoaderObject=new t();
this._dataLoaderMethod=r.dataLoaderMethod;
this._dataLoading=false;
this._data=null;
this._matchValue=r.matchValue?r.matchValue:"inputFieldCompleteValue";
this._matchText=r.matchText?r.matchText:"matchListFieldText";
this._inputFieldXFormItem=r.inputFieldXFormItem;
this._inputFieldXForm=this._inputFieldXFormItem.getForm();
this._inputFieldElement=this._inputFieldXFormItem.getElement();
this._locCallback=r.locCallback;
this._compCallback=r.compCallback;
this._separator=(r.separator!=null)?r.separator:";";
this._setMouseEventHdlrs();
this.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));
this.addListener(DwtEvent.ONMOUSEOVER,new AjxListener(this,this._mouseOverListener));
this._addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._outsideListener=new AjxListener(this,this._outsideMouseDownListener);
this._acInterval=300;
this._acAction=new AjxTimedAction(null,this._autocompleteAction);
this._acActionId=-1;
if(AjxEnv.isFirefox){
this._focusAction=new AjxTimedAction(null,this._focus)
}
this._internalId=AjxCore.assignId(this);
this._numChars=0;
this._matches=new AjxVector();
this._done=new Object();
this.setVisible(false);
this.handle(this._inputFieldElement)
};
ZaAutoCompleteListView.prototype=new DwtComposite;
ZaAutoCompleteListView.DELIMS=[",",";","\n","\r","\t"];
ZaAutoCompleteListView.IS_DELIM=new Object();
for(var i=0;
i<ZaAutoCompleteListView.DELIMS.length;
i++){
ZaAutoCompleteListView.IS_DELIM[ZaAutoCompleteListView.DELIMS[i]]=true
}
ZaAutoCompleteListView.onKeyDown=function(n){
var o=DwtUiEvent.getTargetWithProp(n,"id");
var t=o&&AjxCore.objectWithId(o._acListViewId);
if(t){
t._inputLength=o.value.length
}
var e=DwtKeyEvent.getCharCode(n);
return(e==DwtKeyEvent.KEY_TAB||e==DwtKeyEvent.KEY_ESCAPE)?ZaAutoCompleteListView.onKeyUp(n):true
};
ZaAutoCompleteListView.onKeyUp=function(r){
r=DwtUiEvent.getEvent(r);
if(r.type=="keyup"){
var o=DwtUiEvent.getTargetWithProp(r,"id")
}
var n=AjxCore.objectWithId(o._acListViewId);
var t=o.id;
var c=DwtKeyEvent.getCharCode(r);
if(AjxEnv.isIE&&r.type=="keyup"&&(c==9||c==27)){
return true
}
var l=o.value;
r.inputLengthChanged=(l.length!=n._inputLength);
var d;
if(n._inputFieldXFormItem){
DBG.println(AjxDebug.DBG1,"Set the inputField "+n._inputFieldXFormItem.refPath+" value: "+l);
d=n._inputFieldXFormItem.getInstanceValue();
var s=n._inputFieldXFormItem.getOnChangeMethod();
if(s!=null&&typeof(s)=="function"){
s.call(n._inputFieldXFormItem,l,r,n._inputFieldXForm)
}else{
n._inputFieldXFormItem.setInstanceValue(l)
}}
if(n._acActionId!=-1){
AjxTimedAction.cancelAction(n._acActionId);
n._acActionId=-1
}
if(c==16||c==17||c==18){
return true
}
if(r.altKey||r.ctrlKey){
return true
}
if(!l){
n.reset();
return true
}
if(c==37||c==39){
return true
}
if((c==9)&&!n.size()){
return true
}
if(r.inputLengthChanged||(c==3||c==9||c==13)){
n._numChars++
}
var e=(n.getVisible()&&(n._numChars==1)&&((c==3||c==9||c==13)||(!r.shiftKey&&(c==59||c==186||c==188))));
if(e||(c==27||c==38||c==40)){
n.handleAction(c,e);
if(AjxEnv.isFirefox&&c==9){
n._focusAction.args=[o];
AjxTimedAction.scheduleAction(n._focusAction,0)
}
DwtUiEvent.setBehaviour(r,true,false);
return false
}
if(!r.inputLengthChanged&&(c!=3&&c!=13&&c!=9&&c!=8&&c!=46)){
return true
}
var h=new DwtKeyEvent();
DwtKeyEvent.copy(h,r);
h.aclv=n;
h.element=o;
n._acAction.obj=n;
n._acAction.args=[h];
n._acActionId=AjxTimedAction.scheduleAction(n._acAction,n._acInterval);
var u=d;
if(n._inputFieldXFormItem){
u=n._inputFieldXFormItem.getInstanceValue()
}
if(n._inputFieldXForm){
n._inputFieldXForm.setIsDirty(true,n._inputFieldXFormItem);
n._inputFieldXForm.notifyListeners(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new DwtXFormsEvent(n._inputFieldXForm,n._inputFieldXFormItem,true));
if(u!=d){
n._inputFieldXForm.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,new DwtXFormsEvent(n._inputFieldXForm,n._inputFieldXFormItem,true))
}}
return true
};
ZaAutoCompleteListView.prototype.toString=function(){
return"ZaAutoCompleteListView"
};
ZaAutoCompleteListView.prototype.handle=function(e){
e._acListViewId=this._internalId;
Dwt.setHandler(e,DwtEvent.ONKEYDOWN,ZaAutoCompleteListView.onKeyDown);
Dwt.setHandler(e,DwtEvent.ONKEYUP,ZaAutoCompleteListView.onKeyUp)
};
ZaAutoCompleteListView.prototype.autocomplete=function(e,o){
this.reset();
this._element=e;
this._loc=o;
var t=e.value;
this._autocomplete(t)
};
ZaAutoCompleteListView.prototype.reset=function(){
this._matches.removeAll();
this.show(false)
};
ZaAutoCompleteListView.prototype.handleAction=function(n,t){
if(t){
this._update()
}else{
if(n==38||n==40){
var e=this._getSelectedIndex();
var o=this.size();
if(o<=1){
return
}
var s;
if(n==40&&(e<o-1)){
s=e+1;
this._setSelected(s)
}else{
if(n==38&&(e>0)){
s=e-1;
this._setSelected(s)
}}}else{
if(n==27){
this.reset()
}}}};
ZaAutoCompleteListView.prototype._autocompleteAction=function(n){
try{
var o=n.element;
var t=n.aclv;
t._acActionId=-1;
t._numChars=0;
if(this._locCallback){
var s=this._locCallback.run(n);
t.autocomplete(o,s)
}}
catch(e){}};
ZaAutoCompleteListView.prototype.show=function(e,t){
if(e){
this._popup(t)
}else{
this._popdown()
}};
ZaAutoCompleteListView.prototype._nextChunk=function(t,n){
while(t.charAt(n)==" "){
n++
}
for(var e=n;
e<t.length;
e++){
var o=t.charAt(e);
if(ZaAutoCompleteListView.IS_DELIM[o]){
return{
text:t,str:t.substring(n,e),start:n,end:e,delim:true}
}}
return{
text:t,str:t.substring(n,e),start:n,end:e,delim:false}
};
ZaAutoCompleteListView.prototype._autocomplete=function(e){
if(!(e&&e.length)||(this._done[e])){
return
}
this._removeAll();
if(!this._dataLoading){
var t=new AjxCallback(this,this.dataLoadedCallback);
this._dataLoading=true;
this._dataLoaderMethod.call(this._dataLoaderObject,e,t)
}};
ZaAutoCompleteListView.prototype._complete=function(n){
var t=this._getSelected();
if(!t){
return
}
var s=this._start;
var e=hasDelim?this._end+1:this._end;
var o=t[this._matchValue];
this._done[o]=true;
return{
text:newText,start:s+o.length+this._separator.length,match:t}
};
ZaAutoCompleteListView.prototype._updateField=function(e){
var t=this._element;
t.value=e[this._matchValue];
t.focus();
this.reset();
this._inputFieldXFormItem.setInstanceValue(e[this._matchValue]);
if(this._inputFieldXForm){
this._inputFieldXForm.setIsDirty(true,this._inputFieldXFormItem);
this._inputFieldXForm.notifyListeners(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new DwtXFormsEvent(this._inputFieldXForm,this._inputFieldXFormItem,true));
this._inputFieldXForm.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,new DwtXFormsEvent(this._inputFieldXForm,this._inputFieldXFormItem,true))
}
if(this._compCallback){
this._compCallback.run(e,this._inputFieldXFormItem)
}};
ZaAutoCompleteListView.prototype._update=function(){
var e=this._getSelected();
if(!e){
return
}
this._updateField(e)
};
ZaAutoCompleteListView.prototype._mouseDownListener=function(e){
e=DwtUiEvent.getEvent(e);
var o=DwtUiEvent.getTarget(e);
if(!o||o._pos==null){
return
}
if(e.button==DwtMouseEvent.LEFT){
this._setSelected(o._pos);
if(this.isListenerRegistered(DwtEvent.SELECTION)){
var t=DwtShell.selectionEvent;
DwtUiEvent.copy(t,e);
t.match=o._match;
t.detail=0;
this.notifyListeners(DwtEvent.SELECTION,t);
return true
}}};
ZaAutoCompleteListView.prototype._mouseOverListener=function(e){
e=DwtUiEvent.getEvent(e);
var t=DwtUiEvent.getTarget(e);
if(!t||t._pos==null){
return
}
this._setSelected(t._pos)
};
ZaAutoCompleteListView.prototype._addSelectionListener=function(e){
this._eventMgr.addListener(DwtEvent.SELECTION,e)
};
ZaAutoCompleteListView.prototype._listSelectionListener=function(e){
this._update()
};
ZaAutoCompleteListView.prototype._set=function(n){
var r=this.getHtmlElement();
r.innerHTML="";
var e=this._matches.size();
for(var o=0;
o<e;
o++){
var t=this._matches.get(o);
if(t){
var s=document.createElement("div");
s._pos=o;
s[DwtListView._STYLE_CLASS]="Row";
s[DwtListView._SELECTED_STYLE_CLASS]=s[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
s[DwtListView._STYLE_CLASS]="ZaAutoCompleteListRow";
s.className=s[DwtListView._STYLE_CLASS];
s.innerHTML=AjxStringUtil.htmlEncode(t[this._matchText]);
r.appendChild(s)
}}
this._selected=n||0;
this._setSelected(this._selected)
};
ZaAutoCompleteListView.prototype._popup=function(e){
this.setLocation(e.x,e.y);
this.setSize(Dwt.getSize(this._inputFieldElement).x-2);
this.setVisible(true);
this.setZIndex(Dwt.Z_DIALOG_MENU);
ZaAutoCompleteListView._activeAcList=this;
DwtEventManager.addListener(DwtEvent.ONMOUSEDOWN,ZaAutoCompleteListView._outsideMouseDownListener);
this.shell._setEventHdlrs([DwtEvent.ONMOUSEDOWN]);
this.shell.addListener(DwtEvent.ONMOUSEDOWN,this._outsideListener)
};
ZaAutoCompleteListView.prototype._popdown=function(){
this.setZIndex(Dwt.Z_HIDDEN);
this.setVisible(false);
ZaAutoCompleteListView._activeAcList=null;
DwtEventManager.removeListener(DwtEvent.ONMOUSEDOWN,ZaAutoCompleteListView._outsideMouseDownListener);
this.shell._setEventHdlrs([DwtEvent.ONMOUSEDOWN],true);
this.shell.removeListener(DwtEvent.ONMOUSEDOWN,this._outsideListener)
};
ZaAutoCompleteListView.prototype._setSelected=function(s){
var o=this.getHtmlElement().childNodes;
if(!o){
return
}
var e=o.length;
for(var t=0;
t<e;
t++){
var r=o[t];
var n=r.className;
if(t==s&&n!=r[DwtListView._SELECTED_STYLE_CLASS]){
r.className=r[DwtListView._SELECTED_STYLE_CLASS]
}else{
if(n!=r[DwtListView._STYLE_CLASS]){
r.className=r[DwtListView._STYLE_CLASS]
}}}
this._selected=s
};
ZaAutoCompleteListView.prototype._append=function(e){
this._matches.add(e)
};
ZaAutoCompleteListView.prototype._removeAll=function(){
this._matches.removeAll();
var e=this.getHtmlElement();
while(e.hasChildNodes()){
e.removeChild(e.firstChild)
}};
ZaAutoCompleteListView.prototype.size=function(){
return this._matches.size()
};
ZaAutoCompleteListView.prototype._getSelectedIndex=function(){
return this._selected
};
ZaAutoCompleteListView.prototype._getSelected=function(){
return this._matches.get(this._selected)
};
ZaAutoCompleteListView.prototype.dataLoadedCallback=function(n){
if(n&&n.length>0){
var e=n.length;
for(var o=0;
o<e;
o++){
var t=n[o];
this._append(t)
}}else{
this._dataLoading=false;
return
}
this._set();
this.show(true,this._loc);
this._dataLoading=false
};
ZaAutoCompleteListView.prototype._focus=function(e){
e.focus()
};
ZaAutoCompleteListView._outsideMouseDownListener=function(t){
var e=ZaAutoCompleteListView._activeAcList;
if(e.getVisible()){
var o=DwtControl.getTargetControl(t);
if(o!=e){
e.show(false);
t._stopPropagation=false;
t._returnValue=true
}}}
}
if(AjxPackage.define("zimbraAdmin.common.AutoComplete_XFormItem")){
AutoCompleteList_XFormItem=function(){};
XFormItemFactory.createItemType("_AUTO_COMPLETE_LIST_","auto_complete_list",AutoCompleteList_XFormItem,WidgetAdaptor_XFormItem);
AutoCompleteList_XFormItem.prototype.widgetClass=ZaAutoCompleteListView;
AutoCompleteList_XFormItem.prototype.constructWidget=function(){
var e=this.getInheritedProperty("widgetClass");
var s=new AjxCallback(this,this._getAcListLoc);
var n=new AjxCallback(this,this.getInheritedProperty("compCallback"));
var o={
parent:this.getForm().shell,className:this.getCssClass(),dataLoaderClass:this.getInheritedProperty("dataLoaderClass"),dataLoaderMethod:this.getInheritedProperty("dataLoaderMethod"),matchValue:this.getInheritedProperty("matchValue"),matchText:this.getInheritedProperty("matchText"),inputFieldXFormItem:this.getForm().getItemsById(this.getInheritedProperty("inputFieldElementId"))[0],locCallback:s,compCallback:n,separator:""};
var t=new e(o);
return t
};
AutoCompleteList_XFormItem.prototype.insertWidget=function(t,o,e){
return
};
AutoCompleteList_XFormItem.prototype.updateWidget=function(e){};
AutoCompleteList_XFormItem.prototype._getAcListLoc=function(o){
var t=o.element;
var n=Dwt.getLocation(t);
var e=Dwt.getSize(t).y;
return(new DwtPoint(n.x,n.y+e))
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaKeyMap")){
ZaKeyMap=function(){
DwtKeyMap.call(this);
this._map.ZaGlobal={
"Alt+Shift+D,0":ZaKeyMap.DBG_NONE,"Ctrl+Shift+D,0":ZaKeyMap.DBG_NONE,"Alt+Shift+D,1":ZaKeyMap.DBG_1,"Ctrl+Shift+D,1":ZaKeyMap.DBG_1,"Alt+Shift+D,2":ZaKeyMap.DBG_2,"Ctrl+Shift+D,2":ZaKeyMap.DBG_2,"Alt+Shift+D,3":ZaKeyMap.DBG_3,"Ctrl+Shift+D,3":ZaKeyMap.DBG_3,"Alt+S":ZaKeyMap.SAVE,"Ctrl+S":ZaKeyMap.SAVE,Del:ZaKeyMap.DEL,Backspace:ZaKeyMap.DEL,Esc:ZaKeyMap.CANCEL,ArrowRight:ZaKeyMap.NEXT_PAGE,ArrowLeft:ZaKeyMap.PREV_PAGE}
};
ZaKeyMap.prototype=new DwtKeyMap(true);
ZaKeyMap.prototype.constructor=ZaKeyMap;
var i=0;
ZaKeyMap.CANCEL=i++;
ZaKeyMap.DBG_NONE=i++;
ZaKeyMap.DBG_1=i++;
ZaKeyMap.DBG_2=i++;
ZaKeyMap.DBG_3=i++;
ZaKeyMap.DEL=i++;
ZaKeyMap.NEXT_CONV=i++;
ZaKeyMap.NEXT_PAGE=i++;
ZaKeyMap.PREV_CONV=i++;
ZaKeyMap.PREV_PAGE=i++;
ZaKeyMap.SAVE=i++;
delete i
}
if(AjxPackage.define("zimbraAdmin.common.ACLXFormItem")){
ACLXFormItem=function(){};
XFormItemFactory.createItemType("_ACL_","acl",ACLXFormItem,Composite_XFormItem);
ACLXFormItem.prototype.numCols=6;
ACLXFormItem.prototype.nowrap=true;
ACLXFormItem.prototype.visibleBoxes={
r:true,w:true,a:true,i:true,d:true,x:true};
ACLXFormItem.prototype.initializeItems=function(){
var e=this.getInheritedProperty("visibleBoxes");
this.items=[];
if(e.r){
this.items.push({
type:_CHECKBOX_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:".",labelLocation:_RIGHT_,label:ZaMsg.ACL_R,subLabel:"",align:_RIGHT_,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
return(t&&t.r==1)
}
,elementChanged:function(s,n,o){
var t=Object();
if(n){
t.w=n.w;
t.a=n.a;
t.i=n.i;
t.d=n.d;
t.x=n.x
}else{
t={
r:0,w:0,i:0,d:0,a:0,x:0}
}
t.r=s?1:0;
this.getForm().itemChanged(this.getParentItem(),t,o)
}}
)
}
if(e.w){
this.items.push({
type:_CHECKBOX_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:".",labelLocation:_RIGHT_,label:ZaMsg.ACL_W,subLabel:"",align:_RIGHT_,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
return(t&&t.w==1)
}
,elementChanged:function(s,n,o){
var t=Object();
if(n){
t.r=n.r;
t.a=n.a;
t.i=n.i;
t.d=n.d;
t.x=n.x
}else{
t={
r:0,w:0,i:0,d:0,a:0,x:0}
}
t.w=s?1:0;
this.getForm().itemChanged(this.getParentItem(),t,o)
}}
)
}
if(e.d){
this.items.push({
type:_CHECKBOX_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:".",labelLocation:_RIGHT_,label:ZaMsg.ACL_D,subLabel:"",align:_RIGHT_,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
return(t&&t.d==1)
}
,elementChanged:function(s,n,o){
var t=Object();
if(n){
t.w=n.w;
t.a=n.a;
t.i=n.i;
t.r=n.r;
t.x=n.x
}else{
t={
r:0,w:0,i:0,d:0,a:0,x:0}
}
t.d=s?1:0;
this.getForm().itemChanged(this.getParentItem(),t,o)
}}
)
}
if(e.i){
this.items.push({
type:_CHECKBOX_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:".",labelLocation:_RIGHT_,label:ZaMsg.ACL_I,subLabel:"",align:_RIGHT_,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
return(t&&t.i==1)
}
,elementChanged:function(s,n,o){
var t=Object();
if(n){
t.w=n.w;
t.a=n.a;
t.r=n.r;
t.d=n.d;
t.x=n.x
}else{
t={
r:0,w:0,i:0,d:0,a:0,x:0}
}
t.i=s?1:0;
this.getForm().itemChanged(this.getParentItem(),t,o)
}}
)
}
if(e.x){
this.items.push({
type:_CHECKBOX_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:".",labelLocation:_RIGHT_,label:ZaMsg.ACL_X,subLabel:"",align:_RIGHT_,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
return(t&&t.x==1)
}
,elementChanged:function(s,n,o){
var t=Object();
if(n){
t.w=n.w;
t.a=n.a;
t.i=n.i;
t.d=n.d;
t.r=n.r
}else{
t={
r:0,w:0,i:0,d:0,a:0,x:0}
}
t.x=s?1:0;
this.getForm().itemChanged(this.getParentItem(),t,o)
}}
)
}
if(e.a){
this.items.push({
type:_CHECKBOX_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:".",labelLocation:_RIGHT_,label:ZaMsg.ACL_A,subLabel:"",align:_RIGHT_,visibilityChecks:[],enableDisableChecks:[],getDisplayValue:function(t){
return(t&&t.a==1)
}
,elementChanged:function(s,n,o){
var t=Object();
if(n){
t.w=n.w;
t.r=n.r;
t.i=n.i;
t.d=n.d;
t.x=n.x
}else{
t={
r:0,w:0,i:0,d:0,a:0,x:0}
}
t.a=s?1:0;
this.getForm().itemChanged(this.getParentItem(),t,o)
}}
)
}
Composite_XFormItem.prototype.initializeItems.call(this)
};
ACLXFormItem.prototype.items=[]
}
if(AjxPackage.define("zimbraAdmin.common.ZaSkinPoolChooser")){
ZaSkinPoolChooser=function(e){
if(arguments.length==0){
return
}
DwtChooser.call(this,e)
};
ZaSkinPoolChooser.prototype=new DwtChooser;
ZaSkinPoolChooser.prototype.constructor=ZaSkinPoolChooser;
ZaSkinPoolChooser.prototype._createHtml=function(){
this._sourceListViewDivId=Dwt.getNextId();
this._targetListViewDivId=Dwt.getNextId();
this._buttonsDivId=Dwt.getNextId();
this._removeButtonDivId=Dwt.getNextId();
if(this._allButtons){
this._addAllButtonDivId=Dwt.getNextId();
this._removeAllButtonDivId=Dwt.getNextId()
}
var o=[];
var e=0;
o[e++]="<table cellspacing=0 cellpadding=0 border=0 width=100%>";
o[e++]="<colgroup><col width='40%'/><col width='20%'/><col width='40%'/> </colgroup>";
o[e++]="<tbody>";
o[e++]="<tr><td style='text-align:center' class='xform_label'>"+ZaMsg.NAD_zimbraInstalledSkin+"</td><td>&nbsp;</td><td style='text-align:center'  class='xform_label'>"+ZaMsg.NAD_zimbraAvailableSkin+"</td</tr>";
o[e++]="<tr>";
o[e++]="<td align='center' style='text-align:center' id='";
o[e++]=this._sourceListViewDivId;
o[e++]="'></td>";
o[e++]="<td valign='middle' style='text-align:center' id='";
o[e++]=this._buttonsDivId;
o[e++]="'>";
if(this._allButtons){
o[e++]="<div id='";
o[e++]=this._addAllButtonDivId;
o[e++]="'></div><br>"
}
for(var t=0;
t<this._buttonInfo.length;
t++){
var n=this._buttonInfo[t].id;
o[e++]="<div id='";
o[e++]=this._buttonDivId[n];
o[e++]="'></div><br>"
}
o[e++]="<br><div id='";
o[e++]=this._removeButtonDivId;
o[e++]="'></div>";
if(this._allButtons){
o[e++]="<br><div id='";
o[e++]=this._removeAllButtonDivId;
o[e++]="'></div><br>"
}
o[e++]="</td>";
o[e++]="<td align='center' style='text-align:center' id='";
o[e++]=this._targetListViewDivId;
o[e++]="'></td>";
o[e++]="</tr></tbody></table>";
this.getHtmlElement().innerHTML=o.join("")
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaZimletPoolChooser")){
ZaZimletPoolChooser=function(e){
if(arguments.length==0){
return
}
DwtChooser.call(this,e)
};
ZaZimletPoolChooser.prototype=new DwtChooser;
ZaZimletPoolChooser.prototype.constructor=ZaZimletPoolChooser;
ZaZimletPoolChooser.prototype._createHtml=function(){
this._sourceListViewDivId=Dwt.getNextId();
this._targetListViewDivId=Dwt.getNextId();
this._buttonsDivId=Dwt.getNextId();
this._removeButtonDivId=Dwt.getNextId();
if(this._allButtons){
this._addAllButtonDivId=Dwt.getNextId();
this._removeAllButtonDivId=Dwt.getNextId()
}
var o=[];
var e=0;
o[e++]="<table cellspacing=0 cellpadding=0 border=0 width=100%>";
o[e++]="<colgroup><col width='40%'/><col width='20%'/><col width='40%'/> </colgroup>";
o[e++]="<tbody>";
o[e++]="<tr><td style='text-align:center' class='xform_label'>"+ZaMsg.NAD_zimbraInstalledZimlets+"</td><td>&nbsp;</td><td style='text-align:center'  class='xform_label'>"+ZaMsg.NAD_zimbraAvailableZimlets+"</td</tr>";
o[e++]="<tr>";
o[e++]="<td align='center' style='text-align:center' id='";
o[e++]=this._sourceListViewDivId;
o[e++]="'></td>";
o[e++]="<td valign='middle' style='text-align:center' id='";
o[e++]=this._buttonsDivId;
o[e++]="'>";
if(this._allButtons){
o[e++]="<div id='";
o[e++]=this._addAllButtonDivId;
o[e++]="'></div><br>"
}
for(var t=0;
t<this._buttonInfo.length;
t++){
var n=this._buttonInfo[t].id;
o[e++]="<div id='";
o[e++]=this._buttonDivId[n];
o[e++]="'></div><br>"
}
o[e++]="<br><div id='";
o[e++]=this._removeButtonDivId;
o[e++]="'></div>";
if(this._allButtons){
o[e++]="<br><div id='";
o[e++]=this._removeAllButtonDivId;
o[e++]="'></div><br>"
}
o[e++]="</td>";
o[e++]="<td align='center' style='text-align:center' id='";
o[e++]=this._targetListViewDivId;
o[e++]="'></td>";
o[e++]="</tr></tbody></table>";
this.getHtmlElement().innerHTML=o.join("")
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaXProgressDialog")){
ZaXProgressDialog=function(o,e,t){
if(arguments.length==0){
return
}
ZaXDialog.call(this,o,null,ZaMsg.Progress_Title,e,t,"ZaXProgressDialog");
this.initForm(ZaXProgressDialog.myXModel,this.getMyXForm());
this._containedObject={
numTotal:100,numDone:0,progressMsg:""}
};
ZaXProgressDialog.prototype=new ZaXDialog;
ZaXProgressDialog.prototype.constructor=ZaXProgressDialog;
ZaXProgressDialog.prototype.popup=function(){
DwtDialog.prototype.popup.call(this)
};
ZaXProgressDialog.prototype.popdown=function(){
DwtDialog.prototype.popdown.call(this)
};
ZaXProgressDialog.prototype.enableOk=function(e){
this._button[DwtDialog.OK_BUTTON].setEnabled(e)
};
ZaXProgressDialog.prototype.setProgress=function(e){
this._localXForm.setInstance(e);
this._localXForm.refresh()
};
ZaXProgressDialog.prototype.getMyXForm=function(){
var e={
numCols:2,align:_CENTER_,cssStyle:"text-align:center",items:[{
type:_DWT_ALERT_,ref:"progressMsg",content:null,colSpan:"*",iconVisible:true,align:_CENTER_,style:DwtAlert.INFORMATION}
,{
type:_DWT_PROGRESS_BAR_,label:ZaMsg.NAD_Progress,maxValue:null,maxValueRef:"numTotal",ref:"numDone",valign:_CENTER_,align:_CENTER_,wholeCssClass:"progressbar",progressCssClass:"progressused"}
]};
return e
};
ZaXProgressDialog.myXModel={
items:[{
id:"numTotal",ref:"numTotal",type:_NUMBER_}
,{
id:"numDone",ref:"numDone",type:_NUMBER_}
,{
id:"progressMsg",ref:"progressMsg",type:_STRING_}
]}
}
if(AjxPackage.define("zimbraAdmin.common.ZaAppTabGroup")){
ZaAppTabGroup=function(e,t){
if(arguments.length==0){
return
}
DwtComposite.call(this,{
parent:e,className:"ZaAppTabGroup",posStyle:Dwt.ABSOLUTE_STYLE,id:ZaId.getTabId(ZaId.TAB_GROUP,t)}
);
this._created=false;
this._mainTab=null;
this._currentTab=null;
this._currentTabWidth=0;
this._createUI(t);
this._visibleStartTab=0;
this._numberOfVisibleTabs=0
};
ZaAppTabGroup.prototype=new DwtComposite();
ZaAppTabGroup.prototype.constructor=ZaAppTabGroup;
ZaAppTabGroup._TABS=new AjxVector();
ZaAppTabGroup.TAB_LIMIT=10;
ZaAppTabGroup.prototype.getTabs=function(){
return ZaAppTabGroup._TABS
};
ZaAppTabGroup.prototype._createUI=function(t){
if(this._created){
return
}else{
if(t){
this.reparentHtmlElement(t)
}
this._leftArrow=new DwtComposite(this,null,DwtControl.ABSOLUTE_STYLE);
AjxImg.setImage(this._leftArrow.getHtmlElement(),"LeftArrow");
this._leftArrow.setDisplay("none");
this._rightArrow=new DwtComposite(this,null,DwtControl.ABSOLUTE_STYLE);
AjxImg.setImage(this._rightArrow.getHtmlElement(),"RightArrow");
this._rightArrow.setDisplay("none");
this.setArrowHandler();
var e={
closable:false,mainId:ZaId.TAB_MAIN,selected:true};
this._mainTab=new ZaAppTab(this,e);
this._currentTab=this._mainTab;
this._created=true;
ZaApp.getInstance().setTabGroup(this)
}};
ZaAppTabGroup.prototype.setCurrentTabWidth=function(e){
this._currentTabWidth=e
};
ZaAppTabGroup.prototype.getCurrentTabWidth=function(){
return this._currentTabWidth
};
ZaAppTabGroup.prototype.getArrowY=function(){
return -4
};
ZaAppTabGroup.prototype._resizeListener=function(){
this.resetTabSizes(true)
};
ZaAppTabGroup.prototype.resetTabSizes=function(d){
var f=0;
var m=this.getTabWidth();
var u=m-7;
this.setCurrentTabWidth(u);
var l=this.getTabHeight();
var s=this.getW();
if(this._leftArrow.getVisible()){
s-=16;
f+=16
}
if(this._rightArrow.getVisible()){
s-=16
}
var r=false;
var h;
var c;
for(var o=0;
o<ZaAppTabGroup._TABS.size();
o++){
var t=ZaAppTabGroup._TABS.get(o);
t.setBounds(f,c,u,l);
t.resetLabel(t.getTitle());
if(f&&s&&((f+u)>s)){
t.setVisible(false);
if(t.isSelected()&&d){
r=true;
h=o
}}else{
t.setVisible(true)
}
f=f+u+7
}
if(this._leftArrow.getVisible()){
this._leftArrow.setLocation(0,this.getArrowY())
}else{
this._leftArrow.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}
if(this._rightArrow.getVisible()){
this._rightArrow.setLocation(this.getW()-16,this.getArrowY())
}else{
this._rightArrow.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}
if(r&&d){
var e;
if(h<this._visibleStartTab){
e=h-this._visibleStartTab
}else{
e=h-(this._visibleStartTab+this._numberOfVisibleTabs-1)
}
this.shift(e)
}};
ZaAppTabGroup.prototype.shift=function(h){
if(!this._numberOfVisibleTabs){
return
}
var t=ZaAppTabGroup._TABS.size();
if(this._numberOfVisibleTabs+this._visibleStartTab+h>t){
h=t-this._numberOfVisibleTabs-this._visibleStartTab
}
if(!h){
return
}else{
if(h>0){
this._leftArrow.setEnabled(true);
AjxImg.setImage(this._leftArrow.getHtmlElement(),"LeftArrow")
}else{
if(h<0){
this._rightArrow.setEnabled(true);
AjxImg.setImage(this._rightArrow.getHtmlElement(),"RightArrow")
}}}
var r=0;
var s=this.getW();
this._leftArrow.setLocation(r,this.getArrowY());
this._rightArrow.setLocation(s-20,this.getArrowY());
r+=20;
this._visibleStartTab+=h;
for(var o=0;
o<t;
o++){
var e=ZaAppTabGroup._TABS.get(o);
if((o>=this._visibleStartTab)&&(o<=(this._visibleStartTab+this._numberOfVisibleTabs-1))){
e.setVisible(true);
e.setLocation(r);
if(o+1==t){
this._rightArrow.setEnabled(false);
AjxImg.setImage(this._rightArrow.getHtmlElement(),"rightArrowDis")
}
if(o==0){
this._leftArrow.setEnabled(false);
AjxImg.setImage(this._leftArrow.getHtmlElement(),"LeftArrowDis")
}
r+=this.getCurrentTabWidth()+7
}else{
e.setVisible(false)
}}};
ZaAppTabGroup.prototype.setArrowHandler=function(){
Dwt.setHandler(this._leftArrow.getHtmlElement(),DwtEvent.ONMOUSEDOWN,ZaAppTabGroup._leftArrowMouseDownHdlr);
Dwt.setHandler(this._leftArrow.getHtmlElement(),DwtEvent.ONMOUSEUP,ZaAppTabGroup._leftArrowMouseUpHdlr);
Dwt.setHandler(this._leftArrow.getHtmlElement(),DwtEvent.ONMOUSEOVER,ZaAppTabGroup._arrowMouseOverHdlr);
Dwt.setHandler(this._leftArrow.getHtmlElement(),DwtEvent.ONMOUSEOUT,ZaAppTabGroup._arrowMouseOutHdlr);
Dwt.setHandler(this._rightArrow.getHtmlElement(),DwtEvent.ONMOUSEDOWN,ZaAppTabGroup._rightArrowMouseDownHdlr);
Dwt.setHandler(this._rightArrow.getHtmlElement(),DwtEvent.ONMOUSEUP,ZaAppTabGroup._rightArrowMouseUpHdlr);
Dwt.setHandler(this._rightArrow.getHtmlElement(),DwtEvent.ONMOUSEOVER,ZaAppTabGroup._arrowMouseOverHdlr);
Dwt.setHandler(this._rightArrow.getHtmlElement(),DwtEvent.ONMOUSEOUT,ZaAppTabGroup._arrowMouseOutHdlr)
};
ZaAppTabGroup._arrowMouseOverHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t.getEnabled()){
t.setCursor("pointer")
}};
ZaAppTabGroup._arrowMouseOutHdlr=function(e){
var t=DwtControl.getTargetControl(e);
t.setCursor("default")
};
ZaAppTabGroup._leftArrowMouseDownHdlr=function(e){
var t=DwtControl.getTargetControl(e);
AjxImg.setImage(this,"LeftArrowDis");
if(t.getEnabled()){
t.parent.shift(-1)
}};
ZaAppTabGroup._rightArrowMouseDownHdlr=function(e){
var t=DwtControl.getTargetControl(e);
AjxImg.setImage(this,"rightArrowDis");
if(t.getEnabled()){
t.parent.shift(1)
}};
ZaAppTabGroup._leftArrowMouseUpHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t.getEnabled()){
t.setCursor("pointer");
AjxImg.setImage(this,"LeftArrow")
}};
ZaAppTabGroup._rightArrowMouseUpHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t.getEnabled()){
t.setCursor("pointer");
AjxImg.setImage(this,"RightArrow")
}};
ZaAppTabGroup.prototype.getTabWidth=function(){
var e;
var t=ZaAppTab.DEFAULT_MIN_WIDTH;
var o=ZaAppTab.DEFAULT_MAX_WIDTH;
var r=this.getW();
if(this._leftArrow.getVisible()){
r-=23
}
if(this._rightArrow.getVisible()){
r-=19
}
if(r>0){
if(r>t){
var s=ZaAppTabGroup._TABS.size();
this._numberOfVisibleTabs=s;
var h=Math.floor(r/(s<=0?1:s));
if(h>=t&&h<=o){
e=h
}else{
if(h>o){
e=o
}else{
if(h<t){
var n=this._numberOfVisibleTabs=Math.floor(r/t);
e=Math.floor(r/n);
if((!this._leftArrow.getVisible())||(!this._rightArrow.getVisible())){
this._leftArrow.setVisible(true);
this._rightArrow.setVisible(true);
e=this.getTabWidth()
}
return e
}}}}else{
e=r
}}else{
e=ZaAppTab.DEFAULT_MAX_WIDTH
}
if(this._leftArrow.getVisible()||this._rightArrow.getVisible()){
this._leftArrow.setVisible(false);
this._rightArrow.setVisible(false);
e=this.getTabWidth()
}
return e
};
ZaAppTabGroup.prototype.addTab=function(t,e){
ZaAppTabGroup._TABS.add(t);
if(e){
this.resetTabSizes()
}
return true
};
ZaAppTabGroup.prototype.removeTab=function(t,e){
if(t==this._searchTab){
this._searchTab=null;
var o=ZaApp.getInstance().getSearchListController();
if(o){
o.reset()
}}
ZaAppTabGroup._TABS.remove(t);
t.dispose();
if(e){
this.resetTabSizes()
}};
ZaAppTabGroup.prototype.removeCurrentTab=function(t){
var e=this.getCurrentTab();
this.removeTab(e,t);
this.selectTab(this.getTabById(ZaApp.getInstance()._currentViewId))
};
ZaAppTabGroup.prototype.selectTab=function(o){
if(this.getCurrentTab()==o){
return
}
for(var t=0;
t<ZaAppTabGroup._TABS.size();
t++){
var e=ZaAppTabGroup._TABS.get(t);
if(e==o){
e.setSelectState();
this._currentTab=e;
if(t<this._visibleStartTab){
this.shift(t-this._visibleStartTab)
}else{
if(t>(this._numberOfVisibleTabs+this._visibleStartTab-1)){
this.shift(t-(this._numberOfVisibleTabs+this._visibleStartTab-1))
}}}else{
if(e.isSelected()){
e.setUnselectState()
}}}};
ZaAppTabGroup.prototype.getTabById=function(o){
for(var t=0;
t<ZaAppTabGroup._TABS.size();
t++){
var e=ZaAppTabGroup._TABS.get(t);
if(e.getTabId()==o){
return e
}}};
ZaAppTabGroup.prototype.getTabHeight=function(){
var e=this.getH();
if(e>0){
return e
}else{
return ZaAppTab.DEFAULT_HEIGHT
}};
ZaAppTabGroup.prototype.getCurrentTab=function(){
return this._currentTab
};
ZaAppTabGroup.prototype.getMainTab=function(){
return this._mainTab
};
ZaAppTabGroup.prototype.getSearchTab=function(){
if(this._searchTab){
return this._searchTab
}else{
var e={
closable:true,selected:true};
this._searchTab=new ZaAppTab(this,e);
return this._searchTab
}};
ZaAppTabGroup.prototype.size=function(){
return ZaAppTabGroup._TABS.size()
};
ZaAppTabGroup.prototype.getTabByItemId=function(s,n){
for(var t=0;
t<ZaAppTabGroup._TABS.size();
t++){
var o=ZaAppTabGroup._TABS.get(t);
var e=o.getAppView();
if(e&&e._containedObject&&e._containedObject.id&&e.constructor){
if(s==e._containedObject.id&&(e.constructor==n||!n)){
return o
}}}};
ZaAppTabGroup.getDirtyTabTitles=function(){
var e=[];
for(var o=0;
o<ZaAppTabGroup._TABS.size();
o++){
var n=ZaAppTabGroup._TABS.get(o);
var t=n.getAppView();
if(t&&t.isDirty&&t.isDirty()){
e.push(n.getTitle())
}}
return e
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaAppTab")){
ZaAppTab=function(s,r){
if(arguments.length==0){
return
}
DwtButton.call(this,{
parent:s,className:"ZaAppTabButton",posStyle:Dwt.ABSOLUTE_STYLE,id:r.mainId?ZaId.getTabId(r.mainId,r.id):r.id}
);
this.removeListener(DwtEvent.ONMOUSEOVER,this._mouseOverListenerObj);
this._tabId=r.id||ZaApp.getInstance()._currentViewId;
var t=r.width||s.getTabWidth();
var n=r.height||s.getTabHeight();
this.setSize(t,n);
if(r.label){
this.setText(r.label);
this._title=r.label
}
if(r.icon){
this.setImage(r.icon)
}
if(r.toolTip&&r.toolTip.length>0){
this.setToolTipContent(r.toolTip)
}
this._closable=false;
if(r.closable==true){
this.addCloseCell()
}
var o=new AjxListener(this,ZaAppTab.prototype._selListener);
this.addSelectionListener(o);
if(r.onOpen&&r.onOpen instanceof AjxListener){
this.addSelectionListener(r.onOpen)
}
var e=new AjxListener(this,ZaAppTab.prototype._mouseoutListener);
this.addListener(DwtEvent.ONMOUSEOUT,e);
if(s.addTab(this,true)){
this._selected=r.selected;
if(this._selected){
s.selectTab(this)
}}
this._addPopupMenu()
};
ZaAppTab.prototype=new DwtButton;
ZaAppTab.prototype.constructor=ZaAppTab;
ZaAppTab.DEFAULT_HEIGHT=22;
ZaAppTab.DEFAULT_MAX_WIDTH=200;
ZaAppTab.DEFAULT_MIN_WIDTH=100;
ZaAppTab.prototype.getTitle=function(){
return this._title
};
ZaAppTab.prototype._addPopupMenu=function(){
this._popupOperations=[];
this._actionOpClose=new ZaOperation(ZaOperation.CLOSE_TAB,ZaMsg.tab_close,null,null,null,new AjxListener(this,ZaAppTab.prototype.closeTab));
this._popupOperations.push(this._actionOpClose);
this._actionOpCloseOthers=new ZaOperation(ZaOperation.CLOSE_OTHER_TAB,ZaMsg.tab_close_others,null,null,null,new AjxListener(this,ZaAppTab.prototype.closeOtherTabs));
this._popupOperations.push(this._actionOpCloseOthers);
this._actionOpCloseAll=new ZaOperation(ZaOperation.CLOSE_ALL_TAB,ZaMsg.tab_close_all,null,null,null,new AjxListener(this,ZaAppTab.prototype.closeAllTabs));
this._popupOperations.push(this._actionOpCloseAll);
this._actionMenu=new ZaPopupMenu(this,"ActionMenu",null,this._popupOperations);
var e=new AjxListener(this,ZaAppTab.prototype._mouseRightClickListener);
this.addListener(DwtEvent.ACTION,e);
this._tabMouseUpListener=new AjxListener(this,ZaAppTab.prototype._tabMouseupListener);
this.addListener(DwtEvent.ONMOUSEUP,this._tabMouseUpListener)
};
ZaAppTab.prototype.getAppView=function(){
var e=ZaApp.getInstance().getViewById(this._tabId);
if(e){
return e[ZaAppViewMgr.C_APP_CONTENT]
}else{
return null
}};
ZaAppTab.prototype._selListener=function(e){
DBG.println(AjxDebug.DBG1,"ZaAppTab.prototype._selListenr");
this.parent.selectTab(this)
};
ZaAppTab.prototype._mouseoutListener=function(e){
this.restoreOrginState()
};
ZaAppTab.prototype._tabMouseupListener=function(e){
if(e.button==DwtMouseEvent.RIGHT){
if(this.isListenerRegistered(DwtEvent.ACTION)){
this.notifyListeners(DwtEvent.ACTION,e)
}}};
ZaAppTab.prototype._mouseRightClickListener=function(o){
var t=this.parent;
var e=t.getTabs();
var s=e.size();
if(s<=1){
this._actionMenu.enableAll(false)
}else{
if(s<=2&&this!=t.getMainTab()){
this._actionMenu.enable(ZaOperation.CLOSE_TAB,true);
this._actionMenu.enable(ZaOperation.CLOSE_ALL_TAB,true);
this._actionMenu.enable(ZaOperation.CLOSE_OTHER_TAB,false)
}else{
this._actionMenu.enableAll(true)
}}
this._actionMenu.popup(0,o.docX,o.docY)
};
ZaAppTab.prototype.setSelectState=function(){
this._selected=true;
this.setDisplayState(DwtControl.SELECTED);
this.removeListener(DwtEvent.ONMOUSEUP,this._mouseUpListenerObj);
var e=this.getTabId();
if(e!=ZaApp.getInstance()._currentViewId){
ZaApp.getInstance().pushView(e)
}
if(this._closeCell){
AjxImg.setImage(this._closeCell,"Close")
}};
ZaAppTab.prototype.setUnselectState=function(){
this._selected=false;
this.setDisplayState(DwtControl.NORMAL);
this.addListener(DwtEvent.ONMOUSEUP,this._mouseUpListenerObj);
if(this._closeCell){
AjxImg.setDisabledImage(this._closeCell,"Close")
}};
ZaAppTab.prototype.restoreOrginState=function(){
if(this._selected){
this.setDisplayState(DwtControl.SELECTED)
}else{
this.setDisplayState(DwtControl.NORMAL)
}};
ZaAppTab.prototype.setTabId=function(e){
this._tabId=e
};
ZaAppTab.prototype.getTabId=function(){
return this._tabId
};
ZaAppTab.prototype.isSelected=function(){
return this._selected
};
ZaAppTab.prototype.resetLabel=function(e){
e=e||this.getText();
if(!e){
return
}else{
this._title=e
}
var o=this.parent.getCurrentTabWidth();
if(this._closable){
o-=20
}
var t=Math.floor((o-30)/5.5);
if(t<e.length){
this.setText(e.substring(0,(t-3))+"...")
}else{
this.setText(e)
}};
ZaAppTab.prototype.addCloseCell=function(){
this._closable=true;
this._closeCell=this._row.insertCell(this._row.cells.length);
this._closeCell.className="Icon";
AjxImg.setImage(this._closeCell,"Close");
Dwt.setHandler(this._closeCell,DwtEvent.ONMOUSEDOWN,ZaAppTab._closeCellMouseDownHdlr);
Dwt.setHandler(this._closeCell,DwtEvent.ONMOUSEUP,ZaAppTab._closeCellMouseUpHdlr);
Dwt.setHandler(this._closeCell,DwtEvent.ONMOUSEOVER,ZaAppTab._closeCellMouseOverHdlr);
Dwt.setHandler(this._closeCell,DwtEvent.ONMOUSEOUT,ZaAppTab._closeCellMouseOutHdlr)
};
ZaAppTab._closeCellMouseDownHdlr=function(e){
var t=DwtControl.getTargetControl(e)
};
ZaAppTab._closeCellMouseUpHdlr=function(e){
var t=DwtControl.getTargetControl(e);
t.closeTab()
};
ZaAppTab.prototype.closeTab=function(){
if(this._actionMenu&&this._actionMenu.isPoppedUp()){
this._actionMenu.popdown()
}
if(this._closable){
var e=this.getTabId();
var t=ZaApp.getInstance().getControllerById(e);
if(e==ZaApp.getInstance()._currentViewId){
t.closeButtonListener()
}else{
t.closeButtonListener(null,true,ZaAppTab.prototype.closeHiddenTab,this)
}}};
ZaAppTab.prototype.closeOtherTabs=function(){
if(this._actionMenu&&this._actionMenu.isPoppedUp()){
this._actionMenu.popdown()
}
var o=ZaAppTabGroup.getDirtyTabTitles();
if(o.length>0){
ZaApp.getInstance().getCurrentController().popupMsgDialog(AjxMessageFormat.format(ZaMsg.tab_close_warning,[o.join("<br />")]));
return
}else{
if(ZaAppTabGroup.getDirtyTabTitles){
var r=this.parent
}
var s=r.getTabs();
var h=[];
for(var n=0;
n<s.size();
n++){
var e=s.get(n);
if((e!=this)&&(e._closable)){
h.push(e)
}}
for(var t=0;
t<h.length;
t++){
h[t].closeTab()
}
if(h.length>0){
r.selectTab(this)
}}};
ZaAppTab.prototype.closeAllTabs=function(){
if(this._actionMenu&&this._actionMenu.isPoppedUp()){
this._actionMenu.popdown()
}
var o=ZaAppTabGroup.getDirtyTabTitles();
if(o.length>0){
ZaApp.getInstance().getCurrentController().popupMsgDialog(AjxMessageFormat.format(ZaMsg.tab_close_warning,[o.join("<br />")]));
return
}else{
var r=this.parent;
var s=r.getTabs();
var h=[];
for(var n=0;
n<s.size();
n++){
var e=s.get(n);
if(e._closable){
h.push(e)
}}
for(var t=0;
t<h.length;
t++){
h[t].closeTab()
}
if(h.length>0&&s.size()>0){
r.selectTab(s.get(0))
}}};
ZaAppTab.prototype.closeHiddenTab=function(){
var e=this.getTabId();
if(e==ZaApp.getInstance()._currentViewId){
ZaApp.getInstance().popView()
}else{
this.parent.removeTab(this,true);
ZaApp.getInstance().disposeView(e,true)
}};
ZaAppTab._closeCellMouseOverHdlr=function(e){
var t=DwtControl.getTargetControl(e);
AjxImg.setImage(t._closeCell,"Close");
t._mainToolTip=t.getToolTipContent();
t.setToolTipContent(ZaMsg.ALTBB_Close_tt)
};
ZaAppTab._closeCellMouseOutHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t.isSelected()){
AjxImg.setImage(t._closeCell,"Close")
}else{
AjxImg.setDisabledImage(t._closeCell,"Close")
}
t.setToolTipContent(t._mainToolTip)
};
ZaAppTab.prototype._createHtmlFromTemplate=function(e,t){
DwtButton.prototype._createHtmlFromTemplate.call(this,"admin.Widgets#ZaAppTab",t);
this._row=document.getElementById(t.id+"_row")
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaRequestMgr")){
ZaRequestMgr=function(){};
ZaRequestMgr.invoke=function(n,t){
var o=new ZmCsfeCommand();
var h=(t!=null?t.controller:null);
var r=!(t.delay===null||t.delay===undefined)?t.delay:500;
var e=t.busyId?t.busyId:Dwt.getNextId();
if(!n.asyncMode&&h||(t.showBusy&&h)){
h._shell.setBusyDialogText(t.busyMsg!=null?t.busyMsg:ZaMsg.splashScreenLoading);
h._currentRequest=o;
var c=new AjxCallback(h,h.cancelBusyOverlay,t);
h._shell.setBusy(true,e,true,r,c)
}
try{
ZaZimbraAdmin.getInstance().cancelNoOp();
n.noAuthToken=true;
var s=o.invoke(n);
if(!n.asyncMode&&h){
h._shell.setBusy(false,e,false)
}
if(!n.asyncMode){
ZaZimbraAdmin.getInstance().scheduleNoOp();
return s
}}
catch(l){
if(l&&l.code&&!(l.code==ZmCsfeException.SVC_AUTH_EXPIRED||l.code==ZmCsfeException.SVC_AUTH_REQUIRED||l.code==ZmCsfeException.NO_AUTH_TOKEN||l.code==ZmCsfeException.AUTH_TOKEN_CHANGED)){
ZaZimbraAdmin.getInstance().scheduleNoOp()
}
if(!n.asyncMode&&h||(t.showBusy&&h)){
h._shell.setBusy(false,e)
}
throw l
}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaActionStatusView")){
ZaActionStatusView=function(o,t,e,n){
DwtControl.call(this,{
parent:o,className:(t||"ZaActionStatus"),posStyle:e,id:n}
);
this._toast=this._standardToast=new ZaToast(this,ZaId.TOAST);
this._statusQueue=[]
};
ZaActionStatusView.prototype=new DwtControl;
ZaActionStatusView.prototype.constructor=ZaActionStatusView;
ZaActionStatusView.LEVEL_INFO=1;
ZaActionStatusView.LEVEL_WARNING=2;
ZaActionStatusView.LEVEL_CRITICAL=3;
ZaActionStatusView.MSG_PARAMS=["msg","level","detail","transitions","toast","force","dismissCallback","finishCallback"];
ZaActionStatusView.prototype.toString=function(){
return"ZaActionStatusView"
};
ZaActionStatusView.prototype.setStatusMsg=function(o){
o=Dwt.getParams(arguments,ZaActionStatusView.MSG_PARAMS);
if(typeof o=="string"){
o={
msg:o}
}
var e={
msg:o.msg,level:o.level||ZaActionStatusView.LEVEL_INFO,detail:o.detail,date:new Date(),transitions:o.transitions,toast:o.toast||this._standardToast,dismissCallback:(o.dismissCallback instanceof AjxCallback)?o.dismissCallback:null,finishCallback:(o.finishCallback instanceof AjxCallback)?o.finishCallback:null,dismissed:false};
if(o.force){
for(var t=0;
t<this._statusQueue.length;
t++){
this._statusQueue[t].dismissed=true
}}
this._statusQueue.push(e);
if(!this._toast.isPoppedUp()){
this._updateStatusMsg()
}else{
if(o.force){
this.dismissStatusMsg()
}}};
ZaActionStatusView.prototype.nextStatus=function(){
if(this._statusQueue.length>0){
this._updateStatusMsg();
return true
}
return false
};
ZaActionStatusView.prototype.dismissStatusMsg=function(t){
if(t){
for(var e=0;
e<this._statusQueue.length;
e++){
this._statusQueue[e].dismissed=true
}}
this._toast.dismiss()
};
ZaActionStatusView.getClass=function(e){
switch(e.level){
case ZaActionStatusView.LEVEL_CRITICAL:return"ZaToastCrit";
case ZaActionStatusView.LEVEL_WARNING:return"ZaToastWarn";
default:return"ZaToastInfo"
}};
ZaActionStatusView.getImageHtml=function(e){
switch(e.level){
case ZaActionStatusView.LEVEL_CRITICAL:return"Critical";
case ZaActionStatusView.LEVEL_WARNING:return"Warning";
default:return"Success"
}};
ZaActionStatusView.prototype._updateStatusMsg=function(){
var e=this._statusQueue.shift();
if(!e){
return
}
if(e.dismissed){
if(e.dismissCallback){
e.dismissCallback.run()
}
this.nextStatus()
}else{
var o=ZaActionStatusView.getClass(e);
var t=ZaActionStatusView.getImageHtml(e);
this._toast=e.toast;
this._toast.popup(o,e.msg,t,null,e.transitions,e.dismissCallback,e.finishCallback)
}};
ZaToast=function(e,t){
if(arguments.length==0){
return
}
DwtComposite.call(this,{
parent:e.shell,className:"ZaToast",posStyle:Dwt.ABSOLUTE_STYLE,id:t}
);
this._statusView=e;
this._createHtml();
this._funcs={};
this.popdown();
this._funcs.position=AjxCallback.simpleClosure(this.__position,this);
this._funcs.show=AjxCallback.simpleClosure(this.__show,this);
this._funcs.hide=AjxCallback.simpleClosure(this.__hide,this);
this._funcs.pause=AjxCallback.simpleClosure(this.__pause,this);
this._funcs.hold=AjxCallback.simpleClosure(this.__hold,this);
this._funcs.idle=AjxCallback.simpleClosure(this.__idle,this);
this._funcs.fade=AjxCallback.simpleClosure(this.__fade,this);
this._funcs["fade-in"]=this._funcs.fade;
this._funcs["fade-out"]=this._funcs.fade;
this._funcs.slide=AjxCallback.simpleClosure(this.__slide,this);
this._funcs["slide-in"]=this._funcs.slide;
this._funcs["slide-out"]=this._funcs.slide;
this._funcs.next=AjxCallback.simpleClosure(this.transition,this)
};
ZaToast.prototype=new DwtComposite;
ZaToast.prototype.constructor=ZaToast;
ZaToast.prototype.toString=function(){
return"ZaToast"
};
ZaToast.FADE={
type:"fade"};
ZaToast.FADE_IN={
type:"fade-in"};
ZaToast.FADE_OUT={
type:"fade-out"};
ZaToast.SLIDE={
type:"slide"};
ZaToast.SLIDE_IN={
type:"slide-in"};
ZaToast.SLIDE_OUT={
type:"slide-out"};
ZaToast.PAUSE={
type:"pause"};
ZaToast.HOLD={
type:"hold"};
ZaToast.IDLE={
type:"idle"};
ZaToast.SHOW={
type:"show"};
ZaToast.DEFAULT_TRANSITIONS=[ZaToast.FADE_IN,ZaToast.PAUSE,ZaToast.FADE_OUT];
ZaToast.DEFAULT_STATE={};
ZaToast.DEFAULT_STATE.position={
location:"C"};
ZaToast.DEFAULT_STATE.pause={
duration:3200};
ZaToast.DEFAULT_STATE.hold={};
ZaToast.DEFAULT_STATE.fade={
duration:100,multiplier:1};
ZaToast.DEFAULT_STATE["fade-in"]={
start:0,end:99,step:10,duration:200,multiplier:1};
ZaToast.DEFAULT_STATE["fade-out"]={
start:99,end:0,step:-10,duration:200,multiplier:1};
ZaToast.DEFAULT_STATE.slide={
duration:100,multiplier:1};
ZaToast.DEFAULT_STATE["slide-in"]={
start:-40,end:0,step:1,duration:100,multiplier:1};
ZaToast.DEFAULT_STATE["slide-out"]={
start:0,end:-40,step:-1,duration:100,multiplier:1};
ZaToast.LEVEL_RE=/\b(ZaToastCrit|ZaToastWarn|ZaToastInfo)\b/g;
ZaToast.DISMISSABLE_STATES=[ZaToast.HOLD];
ZaToast.prototype.TEMPLATE="admin.Widgets#ZaToast";
ZaToast.prototype.dispose=function(){
this._textEl=null;
this._iconEl=null;
this._detailEl=null;
DwtComposite.prototype.dispose.call(this)
};
ZaToast.prototype.popup=function(e,c,r,s,n,o,d){
this.__clear();
this._poppedUp=true;
this._dismissed=false;
this._dismissCallback=o;
this._finishCallback=d;
var t=this.getHtmlElement();
Dwt.delClass(t,ZaToast.LEVEL_RE,e||"ZaToastInfo");
if(this._textEl){
this._textEl.innerHTML=c||""
}
if(this._iconEl){
AjxImg.setImage(this._iconEl,r,false)
}
var l=s||"C";
var h=n||ZaToast.DEFAULT_TRANSITIONS;
h=[].concat({
type:"position",location:l}
,h,{
type:"hide"}
);
this._transitions=h;
this.transition()
};
ZaToast.prototype.popdown=function(){
this.__clear();
Dwt.setLocation(this.getHtmlElement(),Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._poppedUp=false;
if(!this._dismissed){
if(this._finishCallback){
this._finishCallback.run()
}}
this._dismissed=false
};
ZaToast.prototype.isPoppedUp=function(){
return this._poppedUp
};
ZaToast.prototype.transition=function(){
if(this._pauseTimer){
clearTimeout(this._pauseTimer);
this._pauseTimer=null
}
if(this._held){
this._held=false
}
var o=this._transitions&&this._transitions.shift();
if(!o){
this._poppedUp=false;
if(!this._statusView.nextStatus()){
this.popdown()
}
return
}
var t=this._state=this._createState(o);
var e=this.getHtmlElement();
Dwt.setLocation(e,t.x,t.y);
this._funcs[o.type||"next"]()
};
ZaToast.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t);
Dwt.setZIndex(this.getHtmlElement(),Dwt.Z_TOAST)
};
ZaToast.prototype._createHtmlFromTemplate=function(e,t){
DwtComposite.prototype._createHtmlFromTemplate.call(this,e,t);
this._textEl=document.getElementById(t.id+"_text");
this._iconEl=document.getElementById(t.id+"_icon");
this._detailEl=document.getElementById(t.id+"_detail")
};
ZaToast.prototype._createState=function(s){
var o=AjxUtil.createProxy(s);
var n=ZaToast.DEFAULT_STATE[o.type];
for(var e in n){
if(!o[e]){
o[e]=n[e]
}}
var t=this.getHtmlElement();
switch(o.type){
case"fade-in":Dwt.setOpacity(t,0);
Dwt.setLocation(t,null,null);
o.value=o.start;
break;
case"fade-out":case"fade":Dwt.setLocation(t,null,null);
o.value=o.start;
break;
case"slide-in":case"slide-out":case"slide":Dwt.setLocation(t,null,-36);
Dwt.setOpacity(t,100);
o.value=o.start;
break
}
return o
};
ZaToast.prototype.__clear=function(){
clearTimeout(this._actionId);
clearInterval(this._actionId);
this._actionId=-1
};
ZaToast.prototype.__position=function(){
var l=this._state.location||"C";
var s;
s="skin_container_toaster";
var t=this.getHtmlElement();
var e=Dwt.byId(s)||this.shell.getHtmlElement();
var n=Dwt.getSize(e);
var c=Dwt.getSize(t);
var h=(n.x-c.x)/2;
var r=(n.y-c.y)/2;
switch(l.toUpperCase()){
case"N":r=0-c.y;
break;
case"S":r=n.y-c.y;
break;
case"E":h=n.x-c.x;
break;
case"W":h=0;
break;
case"NE":h=n.x-c.x;
r=0;
break;
case"NW":h=0;
r=0;
break;
case"SE":h=n.x-c.x;
r=n.y-c.y;
break;
case"SW":h=0;
r=n.y-c.y;
break;
case"C":default:break
}
var o=Dwt.toWindow(e);
h+=o.x;
r+=o.y;
h=(h>0)?h:0;
r=(r>0)?r:0;
Dwt.setLocation(t,h,r);
this._funcs.next()
};
ZaToast.prototype.__show=function(){
var e=this.getHtmlElement();
Dwt.setVisible(e,true);
Dwt.setVisibility(e,true);
this._funcs.next()
};
ZaToast.prototype.__hide=function(){
var e=this.getHtmlElement();
Dwt.setLocation(e,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._funcs.next()
};
ZaToast.prototype.__pause=function(){
if(this._dismissed&&ZaToast.__mayDismiss(ZaToast.PAUSE)){
this._funcs.next()
}else{
this._pauseTimer=setTimeout(this._funcs.next,this._state.duration)
}};
ZaToast.prototype.__hold=function(){
if(this._dismissed&&ZaToast.__mayDismiss(ZaToast.HOLD)!=-1){
this._funcs.next()
}else{
this._held=true
}};
ZaToast.__mayDismiss=function(e){
return AjxUtil.indexOf(ZaToast.DISMISSABLE_STATES,e)!=-1
};
ZaToast.prototype.dismiss=function(){
if(!this._dismissed&&this._poppedUp){
var e=(this._pauseTimer&&ZaToast.__mayDismiss(ZaToast.PAUSE))||(this._held&&ZaToast.__mayDismiss(ZaToast.HOLD));
if(e){
this._funcs.next()
}
this._dismissed=true;
if(this._dismissCallback instanceof AjxCallback){
this._dismissCallback.run()
}}};
ZaToast.prototype.__idle=function(){
if(!this._idleTimer){
this._idleTimer=new DwtIdleTimer(0,new AjxCallback(this,this.__idleCallback))
}else{
this._idleTimer.resurrect(0)
}};
ZaToast.prototype.__idleCallback=function(e){
if(!e){
this.transition();
this._idleTimer.kill()
}};
ZaToast.prototype.__move=function(){
this._funcs.next()
};
ZaToast.prototype.__fade=function(){
var t=this._state.value;
var n=this._state.step;
if(AjxEnv.isIE){
if(AjxEnv.isIE5_5up){
try{
var o=this.getHtmlElement();
o.style.visibility=n>0?"hidden":"visible";
var r=this._state.duration/1000;
o.style.filter="progid:DXImageTransform.Microsoft.Fade(duration="+r+",overlap=1.0)";
o.filters[0].Apply();
o.style.visibility=n>0?"visible":"hidden";
o.filters[0].Play()
}
catch(s){}}
setTimeout(this._funcs.next,0);
return
}
var h=n>0?t>=this._state.end:t<=this._state.end;
if(h){
t=this._state.end
}
var o=this.getHtmlElement();
Dwt.setOpacity(o,t);
if(h){
this.__clear();
setTimeout(this._funcs.next,0);
return
}
if(this._actionId==-1){
var r=this._state.duration;
var l=r/Math.abs(n);
this._actionId=setInterval(this._funcs.fade,l)
}
this._state.value+=n;
this._state.step*=this._state.multiplier
};
ZaToast.prototype.__slide=function(){
var n=this._state.value;
var t=this._state.step;
var s=t>0?n>=this._state.end:n<=this._state.end;
if(s){
n=this._state.end
}
var e=this.getHtmlElement();
Dwt.setLocation(e,null,n);
if(s){
this.__clear();
setTimeout(this._funcs.next,0);
return
}
if(this._actionId==-1){
var o=this._state.duration;
var r=o/Math.abs(t);
this._actionId=setInterval(this._funcs.slide,r)
}
this._state.value+=t;
this._state.step*=this._state.multiplier
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaTreeItem")){
ZaTreeItem=function(e){
if(arguments.length==0){
return
}
e.expandNodeImage=e.expandNodeImage||"Blank_16";
e.collapseNodeImage=e.collapseNodeImage||"AdminCollapse";
e.arrowDisabled=true;
e=Dwt.getParams(arguments,ZaTreeItem.PARAMS);
this._parentInTree=e.parent;
this._countParam=e.count;
this.forceNode=(e.forceNode===undefined?false:e.forceNode);
DwtTreeItem.call(this,e)
};
ZaTreeItem.PARAMS=["parent","index","text","imageInfo","deferred","className","posStyle","forceNotifySelection","forceNotifyAction","count","forceNode"];
ZaTreeItem.prototype=new DwtTreeItem;
ZaTreeItem.prototype.constructor=ZaTreeItem;
ZaTreeItem.prototype.TEMPLATE="admin.Widgets#ZaTreeItem";
ZaTreeItem.prototype.dispose=function(){
this._countCell=null;
DwtTreeItem.prototype.dispose.call(this)
};
ZaTreeItem.prototype.toString=function(){
return"ZaTreeItem"
};
ZaTreeItem.prototype._initialize=function(e,s,o){
o=o||this.forceNode;
DwtTreeItem.prototype._initialize.call(this,e,s,o);
this._countCell=document.getElementById(this._htmlElId+"_countCell");
if(this._countCell&&(this._countInfoParam!==undefined)){
this._countCell.innerHTML=this._countInfoParam;
this._countCell.className="AdminTreeItem-Count";
this._countInfo=this._countInfoParam
}
if(this._nodeCell){
var n=AjxImg.getImageElement(this._nodeCell);
if(n){
Dwt.clearHandler(n,DwtEvent.ONMOUSEDOWN);
Dwt.clearHandler(n,DwtEvent.ONMOUSEUP)
}}
if(this._arrowDisabled){
var t=document.getElementById(this._htmlElId+"_table");
t.style.tableLayout="fixed";
t.style.width="100%";
this._textCell.style.width="100%"
}
this._adjustText()
};
ZaTreeItem.prototype._adjustText=function(){
this.setToolTipContent(this._text)
};
ZaTreeItem.prototype.setText=function(e){
if(this._initialized){
if(!e){
e=""
}
this._text=this._textCell.innerHTML=e;
this._adjustText()
}else{
this._textParam=e
}};
ZaTreeItem.prototype.getCount=function(){
return this._countInfo
};
ZaTreeItem.prototype.setCount=function(e){
if(this._initialized){
if(this._countCell){
this._countCell.innerHTML=e;
this._countCell.className="AdminTreeItem-Count"
}
this._countInfo=e
}else{
this._countInfoParam=e
}};
ZaTreeItem.prototype.setExpanded=function(e,o,t){
if(e){
this._realizeDeferredChildren()
}
if(this.getNumChildren()){
if(this._expanded!=e){
this._expand(e,null,true)
}}};
ZaTreeItem.prototype.isClickOnItem=function(n){
var e=n.docX;
var s=n.docY;
var t=Dwt.getBounds(this._itemDiv);
var o=(t.x<=n.docX)&&(n.docX<=t.x+t.width)&&(location.y<=n.docY)&&(n.docY<=t.y+t.height);
return o
};
ZaTreeEvent=function(o,t,e){
if(arguments.length==0){
return
}
this.oldPath=o;
this.newPath=t;
this.details=e
};
ZaTreeEvent.prototype=new DwtEvent();
ZaTreeEvent.prototype.consturctor=ZaTreeEvent;
ZaTreeEvent.prototype.toString=function(){
return"ZaTreeEvent"
};
ZaTreeEvent.ONDRAW="ondraw";
ZaTreeEvent.ONDESTROY="ondestroy";
ZaTreeItemData=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,ZaTreeItemData.PARAMS);
this.parent=e.parent;
this.parentObject=e.parentObject||"";
this.relatedObject=e.relatedObject||[];
this.recentObject=e.recentObject||[];
this.type=e.type||0;
if(this.type==1){
this.path=e.path
}
this.id=e.id;
this.className=e.className||"AdminTreeItem";
this.text=e.text;
this.image=e.image;
this.siblings=new AjxVector();
this.forceNode=e.forceNode;
this.isShowHistory=(e.isShowHistory===undefined?true:e.isShowHistory);
this.index=e.index;
this.defaultSelectedItem=e.defaultSelectedItem;
this.count=e.count;
this.canShowOnRoot=(e.canShowOnRoot===undefined?true:e.canShowOnRoot);
this.mappingId=e.mappingId;
this.callback=e.callback;
this.buildPath=(e.buildPath?e.buildPath:undefined);
this._data={};
this.childrenData=new AjxVector();
this._eventMgr=new AjxEventMgr()
};
ZaTreeItemData.PARAMS=["parent","id","text","image","index","count","mappingId","callback","relatedObject","recentObject","type","path","canShowOnRoot","forceNode","isShowHistory","buildPath","className","defaultSelectedItem"];
ZaTreeItemData.prototype.addChild=function(t,e){
this.childrenData.add(t,e);
t.parentObject=this
};
ZaTreeItemData.prototype.addSilbings=function(t,e){
this.siblings.add(t,e)
};
ZaTreeItemData.prototype.setData=function(e,t){
this._data[e]=t
};
ZaTreeItemData.prototype.getData=function(e){
return this._data[e]
};
ZaTreeItemData.prototype.removeChild=function(t,e){
this.childrenData.remove(t)
};
ZaTreeItemData.prototype.isLeaf=function(){
var t=this.childrenData.size()==0;
var e=!this.canShowOnRoot;
return(t||e)
};
ZaTreeItemData.prototype.getChildrenNum=function(){
return this.childrenData.size()
};
ZaTreeItemData.prototype.isAlias=function(t,e){
if(this.type==1){
return true
}else{
return false
}};
ZaTreeItemData.prototype.getRealPath=function(t,e){
return this.path
};
ZaTreeItemData.prototype.addRelatedObject=function(e){
this.relatedObject=e
};
ZaTreeItemData.prototype.addRecentObject=function(e){
this.recentObject=e
};
ZaTreeItemData.prototype.addListener=function(e,t){
this._eventMgr.addListener(e,t)
};
ZaTreeItemData.prototype.notifyListeners=function(e,t){
return this._eventMgr.notifyListeners(e,t)
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaTree")){
ZaTree=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,ZaTree.PARAMS);
e.style=DwtTree.SINGLE_STYLE;
DwtTree.call(this,e);
this._rootData=new ZaTreeItemData();
this.currentShowItem=null
};
ZaTree.PARAMS=["parent","style","className","posStyle"];
ZaTree.prototype=new DwtTree;
ZaTree.prototype.constructor=ZaTree;
ZaTree.prototype.toString=function(){
return"ZaTree"
};
ZaTree.prototype._expandUp=function(e){
return
};
ZaTree.prototype.getContainer=function(){
return this._container
};
ZaTree.prototype.setRootData=function(e){
this._rootData=e
};
ZaTree.prototype.getRootData=function(e){
return this._rootData
};
ZaTree.prototype.addTreeItemData=function(o){
var n=this.getPathItems(o.parent);
var t;
var e=this.getTreeItemData(this._rootData,n,0);
if(e){
e.addChild(o);
t=true
}else{
t=false
}
return t
};
ZaTree.prototype.getTreeItemData=function(t,h,r){
if(h.length==r){
return""
}
var n=h[r];
if(t.text!=n){
return""
}
var s=r+1;
if(h.length==s){
return t
}
if(t.childrenData.size()==0){
return""
}
var e="";
var o;
for(o=0;
o<t.childrenData.size();
o++){
e=this.getTreeItemData(t.childrenData.get(o),h,s);
if(e){
break
}}
return e
};
ZaTree.prototype.getTreeItemDataByPath=function(t){
var o=this.getPathItems(t);
var e=this.getTreeItemData(this._rootData,o,0);
return e
};
ZaTree.SEPERATOR="%";
ZaTree.prototype.getPathItems=function(n){
var e=n.split(ZaTree.SEPERATOR);
var t=[];
for(var o=0;
o<e.length;
o++){
if(e[o]){
t.push(e[o])
}}
return t
};
ZaTree.getPathItems=ZaTree.prototype.getPathItems;
ZaTree.prototype.setSelection=function(n,r,c,e){
if(!n){
return
}
var l=this._selectedItems.getArray();
var h=this._selectedItems.size();
var d;
var t=0;
var s=false;
for(var o=0;
o<h;
o++){
if(l[o]==n){
s=true
}else{
l[o]._setSelected(false);
this._selectedItems.remove(l[o]);
if(d==null){
d=new Array()
}
if(!AjxUtil.isEmpty(l[o])){
d[t++]=l[o]
}}}
if(d&&!r){
this._notifyListeners(DwtEvent.SELECTION,d,DwtTree.ITEM_DESELECTED,null,this._selEv,c)
}
if(s){
return
}
this._selectedItems.add(n);
if(n._setSelected(true,e)&&!r){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,null,this._selEv,c)
}};
ZaTree.prototype.setSelectionByPath=function(y,t,u,b,s,d,c){
var e=this.getTreeItemDataByPath(y);
if(e.isAlias()){
y=e.getRealPath();
t=false
}
var g=this._getBuildNode(e);
if(g.isNeed){
if(this.currentRoot&&!c){
var l=new ZaTreeEvent(g.oldPath,g.newPath);
var f=this.currentRoot.getData("dataItem").notifyListeners(ZaTreeEvent.ONDESTROY,l);
if(f===false){
return
}}
this.buildTree(g.resultItem)
}else{
var m=this._selectedItems.getArray();
var o=this._selectedItems.size();
if(o>0){
for(var r=0;
r<o;
r++){
m[r]._setSelected(false)
}}}
this._selectedItems.removeAll();
var h=this.getTreeItemByPath(y);
var n=this._getSelectedItem(h);
this._selectedItems.add(n);
if(n._setSelected(true,s)&&!u){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,null,this._selEv,b,d)
}
this._updateHistory(h,t);
var p=g.isNeed?g.resultItem:e;
if(p.callback&&p.callback instanceof AjxCallback){
p.callback.run()
}};
ZaTree.prototype._getBuildNode=function(s){
var e={
isNeed:true,resultItem:s};
if(!this.currentRoot){
return e
}
var o=this.currentRoot.getData("dataItem");
var n=this.getABPath(o);
if(s.buildPath){
e.resultItem=this.getTreeItemDataByPath(s.buildPath)
}else{
if(s.isLeaf()&&s.parentObject){
e.resultItem=s.parentObject
}else{
e.resultItem=s
}}
var t=this.getABPath(e.resultItem);
e.newPath=t;
if(n==t){
e.isNeed=false
}else{
e.oldPath=n
}
return e
};
ZaTree.prototype._getSelectedItem=function(o){
var t=o.getData("dataItem").defaultSelectedItem;
if(!t){
return o
}
var e=o.getItems();
if(e.length>0){
return e[t-1]
}
return o
};
ZaTree.prototype.getSelectedItem=function(e){
return this._getSelectedItem(e)
};
ZaTree.prototype.getTreeItemByPath=function(u){
if(!u){
return null
}
if(!this.currentRoot){
return null
}
var l=this.getChildren();
for(var n=0;
n<l.length;
n++){
var t=l[n];
var r=t.getData("dataItem");
var d=this.getABPath(r);
if(d==u){
return t
}
var e=t.getChildren();
for(var s=0;
s<e.length;
s++){
var o=e[s];
var c=o.getText();
var h=d+ZaTree.SEPERATOR+c;
if(u==h){
return o
}}}
return null
};
ZaTree.prototype.buildTree=function(n){
this.clearItems();
this.curentRoot=null;
this.currentRelated=null;
this.currentRoot=this._buildNodeItem(n,true);
this.currentRoot.setExpanded(true);
if(n.relatedObject.length!=0){
this.currentRelated=this._buildNodeItem(this._getDefaultRelated(n));
this.currentRelated.setExpanded(true)
}
if(n.recentObject.length!=0){
this.currentRecented=this._buildNodeItem(this._getDefaultRecentObjects(n),false,true);
this.currentRecented.setExpanded(true)
}
for(var e=0;
e<n.siblings.size();
e++){
var o=n.siblings.get(e);
var t=this._buildNodeItem(o);
t.setExpanded(true)
}
return this.currentRoot
};
ZaTree.prototype.renameTreeItem=function(l,e){
var o=this.getTreeItemDataByPath(l);
if(!o){
return
}
var h=this.getTreeItemByPath(l);
if(h){
h.setText(e)
}
o.text=e;
var t=this.getPathItems(o.parent);
t.push(e);
var r=this.getPathByArray(t);
for(var s=0;
s<o.childrenData.size();
s++){
var n=o.childrenData.get(s);
n.parent=r
}
return r
};
ZaTree.prototype.removeTreeItem=function(o){
var e=this.getTreeItemDataByPath(o);
if(!e){
return
}
var t=this.getTreeItemByPath(o);
if(t){
t.parent.removeChildren(t)
}
e.parentObject.removeChildren(e)
};
ZaTree.prototype.removeAllChild=function(s){
var e=this.getTreeItemDataByPath(s);
if(!e){
return
}
var n=this.getTreeItemByPath(s);
if(n){
var o=[];
o=n.getChildren();
for(var t=0;
t<o.length;
t++){
n.removeChild(o[t]);
o[t]=null
}
o=[]
}
e.childrenData.removeAll()
};
ZaTree.prototype._getDefaultRelated=function(o){
var n=new ZaTreeItemData({
parent:o.parent,id:o.id+"_related",text:ZaMsg.OVP_related}
);
o.addChild(n);
for(var t=0;
t<o.relatedObject.length;
t++){
var e=o.relatedObject[t];
e.parent=o.parent+ZaTree.SEPERATOR+ZaMsg.OVP_related;
n.addChild(e)
}
return n
};
ZaTree.prototype._getDefaultRecentObjects=function(n){
var o=new ZaTreeItemData({
parent:n.parent,id:n.id+"_recent",text:ZaMsg.OVP_recent}
);
n.addChild(o);
for(var t=0;
t<n.recentObject.length;
t++){
var e=n.recentObject[t];
e.parent=n.parent+ZaTree.SEPERATOR+ZaMsg.OVP_recent;
o.addChild(e)
}
return o
};
ZaTree.prototype._buildNodeItem=function(d,r,u){
var e,t,f,c;
var s;
if(d.text==ZaMsg.OVP_home){
s="homeRootOverviewHeader"
}else{
if(r){
s="rootOverviewHeader"
}else{
s="overviewHeader"
}}
c=new ZaTreeItem({
parent:this,className:s,id:d.id,forceNotifySelection:true}
);
c.enableSelection(false);
c.setText(d.text);
c.setImage(d.image);
c.setData(ZaOverviewPanelController._TID,d.mappingId);
c.setData("dataItem",d);
for(f in d._data){
c.setData(f,d._data[f])
}
var l,h,o;
for(l=0;
l<d.childrenData.size();
l++){
var n=d.childrenData.get(l);
if(r){
if(n.text==ZaMsg.OVP_related){
continue
}
if(n.text==ZaMsg.OVP_recent){
continue
}}
if(n.forceNode!==undefined){
o=n.forceNode
}else{
o=n.childrenData.size()>0?true:false
}
e=new ZaTreeItem({
parent:c,className:n.className,id:n.id,forceNode:o}
);
e.setCount(n.count);
e.setText(n.text);
e.setImage(n.image);
e.setData(ZaOverviewPanelController._TID,n.mappingId);
e.setData("dataItem",n);
if(u){
var m=(AjxEnv.isIE)?DwtEvent.ONMOUSELEAVE:DwtEvent.ONMOUSEOUT;
e.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(e,ZaTree._highlightItemOn));
e.addListener(DwtEvent.ONMOUSEUP,new AjxListener(e,ZaTree._highlightItemOff));
e.addListener(m,new AjxListener(e,ZaTree._highlightItemOff))
}
for(f in n._data){
e.setData(f,n._data[f])
}}
return c
};
ZaTree._highlightItemOff=function(t){
var e=this;
e._setSelected(false)
};
ZaTree._highlightItemOn=function(t){
var e=this;
e._setSelected(true)
};
ZaTree.prototype._itemClicked=function(u,r){
var s;
var h=this._selectedItems.getArray();
var t=this._selectedItems.size();
var c=u.getData("dataItem");
var e=c.isShowHistory;
var n=c.isAlias();
if(n){
var l=c.image;
c=this.getTreeItemDataByPath(c.getRealPath());
if(!c.image){
c.image=l
}
this._updateHistoryObj(c)
}
if(c.isLeaf()&&!n){
if(t>0){
for(s=0;
s<t;
s++){
h[s]._setSelected(false)
}
this._notifyListeners(DwtEvent.SELECTION,this._selectedItems.getArray(),DwtTree.ITEM_DESELECTED,r,this._selEv);
this._selectedItems.removeAll()
}
this._selectedItems.add(u);
if(u._setSelected(true)){
this._updateHistory(u,true,e);
this._notifyListeners(DwtEvent.SELECTION,[u],DwtTree.ITEM_SELECTED,r,this._selEv)
}}else{
var d;
if(!c.isLeaf()){
d=c
}else{
d=c.parentObject
}
this.buildTree(d);
this._selectedItems.removeAll();
var o;
if(c.isLeaf()){
o=this.getTreeItemByPath(this.getABPath(c))
}else{
o=this._getSelectedItem(this.getCurrentRootItem())
}
this._selectedItems.add(o);
if(o._setSelected(true)){
if(!n){
if(c.isLeaf()){
this._updateHistory(o,true,e)
}else{
this._updateHistory(this.getCurrentRootItem(),true,e)
}}else{
this._updateHistory(u,true,e)
}
this._notifyListeners(DwtEvent.SELECTION,[o],DwtTree.ITEM_SELECTED,r,this._selEv)
}
if(d.callback&&d.callback instanceof AjxCallback){
d.callback.run()
}}};
ZaTree.prototype._notifyListeners=function(h,e,s,o,t,r,n){
if(this.isListenerRegistered(h)){
if(o){
DwtUiEvent.copy(t,o)
}
t.items=e;
if(e.length==1){
t.item=e[0]
}
t.detail=s;
t.kbNavEvent=r;
t.refresh=n;
this.notifyListeners(h,t);
if(h==DwtEvent.SELECTION){
this.shell.notifyGlobalSelection(t)
}}};
ZaTree.prototype._updateHistory=function(o,h,e){
var r=o.getText();
var t=o.getData("dataItem");
var s=this.getABPath(t);
var n=new ZaHistory(s,r,undefined,e);
ZaZimbraAdmin.getInstance().updateHistory(n,h)
};
ZaTree.prototype._updateHistoryObj=function(e){
var d=e.text;
var h=ZaItem.ACCOUNT;
var u=this.getABPath(e);
switch(e.image){
case"Account":h=ZaItem.ACCOUNT;
break;
case"COS":h=ZaItem.COS;
break;
case"Domain":h=ZaItem.DOMAIN;
break;
case"Resource":h=ZaItem.RESOURCE;
break;
case"DistributionList":h=ZaItem.DL;
break;
case"AccountAlias":h=ZaItem.ALIAS;
break;
case"Server":h=ZaItem.SERVER;
break;
case"RightObject":h=ZaItem.RIGHT;
break;
default:h=null
}
var n=new ZaHistory(u,d,h);
var c=ZaZimbraAdmin.getInstance().getHisotryMgr();
c.addHistoryObj(n);
var o=c.getAllHistoryObj().getArray();
var t=null;
var s=null;
var l=[];
for(var r=o.length-1;
r>-1;
r--){
if(o[r].type==ZaItem.ACCOUNT){
s="Account"
}else{
if(o[r].type==ZaItem.COS){
s="COS"
}else{
if(o[r].type==ZaItem.DOMAIN){
s="Domain"
}else{
if(o[r].type==ZaItem.RESOURCE){
s="Resource"
}else{
if(o[r].type==ZaItem.DL){
s="DistributionList"
}else{
if(o[r].type==ZaItem.ALIAS){
s="AccountAlias"
}else{
if(o[r].type==ZaItem.SERVER){
s="Server"
}else{
if(o[r].type==ZaItem.RIGHT){
s="RightObject"
}}}}}}}}
t=new ZaTreeItemData({
text:o[r].displayName,type:1,image:s,forceNode:(r+1!=o.length),path:o[r].path}
);
l.push(t)
}
e.recentObject=l
};
ZaTree.prototype.getABPath=function(n){
var o=[];
var e=n;
while(e){
o.unshift(e.text);
e=e.parentObject
}
var t=this.getPathByArray(o);
return t
};
ZaTree.prototype.getPathByArray=function(e){
if(e.length==0){
return""
}
return e.join(ZaTree.SEPERATOR)
};
ZaTree.prototype.getCurrentRootItem=function(){
return this.currentRoot
};
ZaTree.prototype.getCurrentSelectedItems=function(){
return this._selectedItems
};
ZaTree.prototype.clearItems=function(){
var t=this.getItems();
var e=t.length;
for(var o=0;
o<e;
o++){
this.removeChild(t[0])
}
this._getContainerElement().innerHTML=""
};
ZaTree.getPathByArray=ZaTree.prototype.getPathByArray
}
if(AjxPackage.define("zimbraAdmin.common.ZaCurrentAppBar")){
ZaCurrentAppBar=function(t,e,o){
DwtButton.call(this,t,"",e,Dwt.ABSOLUTE_STYLE);
this._removeUnwantedEvent();
this._currentPathItems=new Array();
this.menu=new ZaPopupMenu(this,"ActionMenu",null,[],ZaId.CURRENT_APP_BAR,ZaId.MENU_POP,[]);
this.menu.setWidth(Dwt.__checkPxVal(150,true));
this.actionButtons={};
this.itemElArray=[];
this.setMenu(this.menu);
this.setSettingImg();
this.clearTypeImg()
};
ZaCurrentAppBar.prototype=new DwtButton;
ZaCurrentAppBar.prototype.constructor=ZaCurrentAppBar;
ZaCurrentAppBar.defaultImg="Configure";
ZaCurrentAppBar.prototype.toString=function(){
return"ZaCurrentAppBar"
};
ZaCurrentAppBar.prototype.TEMPLATE="admin.Widgets#ZaCurrentAppBar";
ZaCurrentAppBar.prototype.ACTION_ITEM_TEMPLATE="dwt.Widgets#ZToolbarItem";
ZaCurrentAppBar.prototype._createHtmlFromTemplate=function(e,t){
DwtButton.prototype._createHtmlFromTemplate.call(this,e,t);
this._typeImgEl=document.getElementById(t.id+"_typeimg");
this._settingImgEl=document.getElementById(t.id+"_settingimg");
this._actionEl=document.getElementById(t.id+"_action");
this._actionItemsEl=document.getElementById(t.id+"_actionitems")
};
ZaCurrentAppBar.prototype.setSettingImg=function(t){
if(!this._settingImgEl){
return
}
var e=t||ZaCurrentAppBar.defaultImg;
this._settingImgEl.innerHTML=AjxImg.getImageHtml(e)
};
ZaCurrentAppBar.prototype.clearSettingImg=function(){
if(!this._settingImgEl){
return
}
this._settingImgEl.innerHTML=""
};
ZaCurrentAppBar.prototype.setTypeImg=function(e){
if(!this._typeImgEl){
return
}
if(!e){
return
}
this._typeImgEl.innerHTML=AjxImg.getImageHtml(e);
if(!Dwt.getVisible(this._typeImgEl)){
Dwt.setVisible(this._typeImgEl,true)
}};
ZaCurrentAppBar.prototype.clearTypeImg=function(){
if(!this._typeImgEl){
return
}
this._typeImgEl.innerHTML="";
if(Dwt.getVisible(this._typeImgEl)){
Dwt.setVisible(this._typeImgEl,false)
}};
ZaCurrentAppBar.prototype.setText=function(o){
var n="";
var e=o.split(ZaTree.SEPERATOR);
this._currentPathItems=e;
for(var t=0;
t<e.length;
t++){
n+=this._getSinglePathItem(e[t]);
if(t!=e.length-1){
n+="-"
}}
DwtButton.prototype.setText.call(this,n)
};
ZaCurrentAppBar.prototype.setActionButton=function(e,t){
if(AjxUtil.isEmpty(e)){
this._clearActionButton()
}else{
this._addActionButton(e,t)
}};
ZaCurrentAppBar.prototype._addActionButton=function(s,r){
this._clearActionButton();
var e;
if(AjxUtil.isEmpty(r)){
for(var t in s){
e=this._createActionButton(s[t].id,s[t].imageId,s[t].caption,s[t].disImageId,s[t].tt,true,s[t].className,s[t].type,s[t].menuOpList);
e.addSelectionListener(s[t].listener)
}}else{
var t;
for(var o in r){
t=r[o];
if(s[t]){
e=this._createActionButton(s[t].id,s[t].imageId,s[t].caption,s[t].disImageId,s[t].tt,true,s[t].className,s[t].type,s[t].menuOpList);
e.addSelectionListener(s[t].listener)
}}}
var n=Dwt.getBounds(this._actionItemsEl).width;
this.setActionItemWidth(n)
};
ZaCurrentAppBar.prototype._createActionButton=function(s,t,u,d,e,r,h,l,n){
if(!h){
h="DwtToolbarButton"
}
var c=this.actionButtons[s]=new ZaToolBarButton({
parent:this,className:h,id:ZaId.getButtonId("ZaCurrentAppBar",ZaOperation.getStringName(s))}
);
if(t){
c.setImage(t)
}
if(u){
c.setText(u)
}
if(e){
c.setToolTipContent(e)
}
c.setEnabled((r)?true:false);
c.setData("_buttonId",s);
var o=this._createActionItemContainer();
o.appendChild(c.getHtmlElement());
this._addActionItem(o);
return c
};
ZaCurrentAppBar.prototype._createActionItemContainer=function(){
var n=this.itemElArray.length+1;
var s=[this._htmlElId,"item",n].join("_");
var o={
id:this._htmlElId,itemId:s};
var t=AjxTemplate.expand(this.ACTION_ITEM_TEMPLATE,o);
var e=AjxStringUtil.calcDIV();
e.innerHTML=t;
return e.firstChild.rows[0].cells[0]
};
ZaCurrentAppBar.prototype._addActionItem=function(t){
var e=this.itemElArray.length;
this.itemElArray.splice(e,0,t);
this._actionItemsEl.appendChild(t)
};
ZaCurrentAppBar.prototype._clearActionButton=function(){
for(var t=0;
t<this.itemElArray.length;
t++){
this.itemElArray[t]=undefined
}
this.itemElArray=[];
while(this._actionItemsEl.firstChild){
var o=this._actionItemsEl.removeChild(this._actionItemsEl.firstChild);
o=null
}
for(var e in this.actionButtons){
this.actionButtons[e]=undefined
}
this.actionButtons={};
this.setActionItemWidth(0)
};
ZaCurrentAppBar.prototype.setActionItemWidth=function(e){
this._actionEl.style.width=Dwt.__checkPxVal(e)
};
ZaCurrentAppBar.prototype.enableButton=function(t,e){
if(!this.actionButtons[t]){
return
}
this.actionButtons[t].setEnabled(e)
};
ZaCurrentAppBar.spanItemClass="";
ZaCurrentAppBar.prototype._getSinglePathItem=function(t){
var o=new Array(10);
var e=0;
o[e++]="<span class=";
o[e++]=ZaCurrentAppBar.spanItemClass;
o[e++]=">";
o[e++]=t;
o[e++]="</span>";
return o.join("")
};
ZaCurrentAppBar.prototype.popup=function(n){
n=n||this.getMenu();
if(!n){
return
}
var m=n.parent;
var l=m.getBounds();
var u=n.shell.getSize();
var e=n.getSize();
var f=m.getHtmlElement();
var o=Dwt.toWindow(f,0,0);
var t=(f.style.borderLeftWidth=="")?0:parseInt(f.style.borderLeftWidth);
var d;
var h=m._dropDownEl;
if(!h){
d=o.x+t
}else{
var s=Dwt.toWindow(h,0,0);
d=s.x+20
}
d=((d-e.x)>=0)?d-e.x:d;
if(d>13){
d=d-13
}
var c;
var r=(f.style.borderTopWidth=="")?0:parseInt(f.style.borderTopWidth);
r+=(f.style.borderBottomWidth=="")?0:parseInt(f.style.borderBottomWidth);
c=o.y+l.height+r;
n.popup(0,d,c)
};
ZaCurrentAppBar.prototype.setDisplayState=function(t,e){
if(t==DwtControl.HOVER||t==DwtControl.ACTIVE||t==DwtControl.FOCUSED){
t=DwtControl.NORMAL
}
if(this._selected&&t!=DwtControl.SELECTED&&!e){
t=[DwtControl.SELECTED,t].join(" ")
}
DwtLabel.prototype.setDisplayState.call(this,t)
};
ZaCurrentAppBar.prototype._isDropDownEvent=function(o){
if(this._dropDownEventsEnabled&&this._dropDownEl){
var t=o.docX;
if(this._settingImgEl){
var e=Dwt.toWindow(this._settingImgEl,0,0,window).x;
if(t>=e){
return true
}}}
return false
};
ZaCurrentAppBar.prototype._handleClick=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=true;
e.setToDhtmlEvent(t);
return false
};
ZaCurrentAppBar.prototype._removeUnwantedEvent=function(){
var t=[].concat(AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]);
for(var e=0;
e<t.length;
e++){
this.removeListener(t[e],this._listeners[t[e]])
}};
ZaCurrentAppBar.prototype.updateMenu=function(s,o){
var e=this.getMenu();
var t=false;
if(e){
t=e.isPoppedUp();
this.setMenu();
this.menu=null;
try{
e.dispose();
delete e
}
catch(n){}}
if(s){
this.menu=new ZaPopupMenu(this,"ActionMenu",null,s,ZaId.CURRENT_APP_BAR,ZaId.MENU_POP,o);
this.menu.setWidth(Dwt.__checkPxVal(150,true));
this.setSettingImg();
this.setMenu(this.menu)
}else{
this.clearSettingImg()
}
if(t){
this.popup()
}};
ZaCurrentAppBar.prototype.getMenu=function(){
return this.menu
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaHistoryMgr")){
ZaHistoryMgr=function(){
this._history=new AjxVector();
this._historyObj=new AjxVector();
this._evtMgr=new AjxEventMgr();
this._currentLocation=0
};
ZaHistoryMgr.MAX_HISTROY_OBJ=5;
ZaHistoryMgr.prototype.toString=function(){
return"ZaHistoryMgr"
};
ZaHistoryMgr.prototype.constructor=ZaHistoryMgr;
ZaHistoryMgr.prototype.addHistory=function(t){
var e=this._history.getLast();
if(e&&e.equal(t)){
return
}
if(window.console&&window.console.log){
window.console.log("Add History "+t.path)
}
this._history.add(t);
this._currentLocation=this._history.size()-1;
this._evtMgr.notifyListeners(ZaEvent.L_MODIFY,this._history)
};
ZaHistoryMgr.prototype.findHistoryByName=function(e){
var n=new AjxVector();
var t=0;
for(var o=this._history.size()-1;
o>=0&&t<20;
o--){
if(!this._history.get(o).isShowInHistory){
continue
}
if(this._history.get(o).displayName==e){
n.add(this._history.get(o))
}
t++
}
return n
};
ZaHistoryMgr.prototype.deleteHistoryObjByName=function(e){
for(var t=0;
t<this._historyObj.size();
t++){
if(this._historyObj.get(t).displayName==e){
return this._historyObj.removeAt(t)
}}};
ZaHistoryMgr.prototype.refreshHistory=function(){
this._evtMgr.notifyListeners(ZaEvent.L_MODIFY,this._history)
};
ZaHistoryMgr.prototype.addHistoryObj=function(t){
if(AjxUtil.isEmpty(t.type)){
return
}
if(!ZaHistoryMgr.isAllowedRecentedObject(t.path)){
return
}
var e=this._historyObj.get(this._historyObj.size()-1);
if(e&&e.path==t.path){
return
}
var o=this.findHistoryObj(t);
if(o>-1){
this._historyObj.removeAt(o)
}
if(this._historyObj.size()+1>ZaHistoryMgr.MAX_HISTROY_OBJ){
this._historyObj.removeAt(0)
}
this._historyObj.add(t)
};
ZaHistoryMgr.prototype.findHistoryObj=function(t){
if(!t){
return -1
}
for(var e=0;
e<this._historyObj._array.length;
e++){
if(this._historyObj._array[e].displayName==t.displayName){
return e
}}
return -1
};
ZaHistoryMgr.isAllowedRecentedObject=function(h){
var o=false;
var r=ZaTree.getPathItems(h);
var e;
var s=ZaHistoryMgr.getAllowedRecenctObject();
for(var n=0;
n<s.length;
n++){
e=ZaTree.getPathItems(s[n]);
for(var t=0;
t<e.length;
t++){
if(r[t]!=e[t]){
break
}}
if(t==e.length){
o=true;
break
}}
return o
};
ZaHistoryMgr.getAllowedRecenctObject=function(){
if(!ZaHistoryMgr._allowedRecentObject){
ZaHistoryMgr._allowedRecentObject=[[ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts].join(ZaTree.SEPERATOR),[ZaMsg.OVP_home,ZaMsg.OVP_configure].join(ZaTree.SEPERATOR)]
}
return ZaHistoryMgr._allowedRecentObject
};
ZaHistoryMgr.prototype.removeHistory=function(){
var e=this._history.size();
if(e==1){
return false
}
for(var t=1;
t<e;
t++){
this._history._array[t]=null
}
this._history._array.length=1;
this._currentLocation=0;
this._evtMgr.notifyListeners(ZaEvent.L_MODIFY,this._history);
return true
};
ZaHistoryMgr.prototype.getAllHistory=function(){
return this._history
};
ZaHistoryMgr.prototype.getAllHistoryObj=function(){
return this._historyObj
};
ZaHistoryMgr.prototype.getPrevious=function(){
if(!this.isPrevious()){
return""
}
return this._history.get(--this._currentLocation)
};
ZaHistoryMgr.prototype.getNext=function(){
if(!this.isNext()){
return""
}
return this._history.get(++this._currentLocation)
};
ZaHistoryMgr.prototype.isPrevious=function(){
if(this._currentLocation==0){
return false
}else{
return true
}};
ZaHistoryMgr.prototype.isNext=function(){
if(this._currentLocation==this._history.size()-1){
return false
}else{
return true
}};
ZaHistoryMgr.prototype.getLatestHistory=function(){
return this._history.getLast()
};
ZaHistoryMgr.prototype.getCurrentyHistory=function(){
return this._history.get(this._currentLocation)
};
ZaHistoryMgr.prototype.addChangeListener=function(e){
return this._evtMgr.addListener(ZaEvent.L_MODIFY,e)
};
ZaHistoryMgr.prototype.removeChangeListener=function(e){
return this._evtMgr.removeListener(ZaEvent.L_MODIFY,e)
};
ZaHistory=function(s,t,n,e,o){
this.path=s;
this.displayName=t;
this.type=n;
this.isShowInHistory=(e===undefined)?true:e;
this.viewMethod=(o instanceof AjxCallback)?o:new AjxCallback(this,this.defaultGoToView);
this.enabled=true
};
ZaHistory.prototype.goToView=function(e){
if(this.viewMethod){
this.viewMethod.run(e)
}};
ZaHistory.prototype.defaultGoToView=function(t){
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
e.setSelectionByPath(this.path,false,undefined,undefined,undefined,t)
};
ZaHistory.prototype.equal=function(e){
return this.path==e.path
};
ZaHistory.prototype.setEnabled=function(e){
this.enabled=e
};
ZaHistory.prototype.getEnabled=function(){
return this.enabled
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaUploader")){
ZaUploader=function(){};
ZaUploader.prototype.constructor=ZaUploader;
ZaUploader.prototype.toString=function(){
return"ZaUploader"
};
ZaUploader.prototype._upload=function(fileElementIds,url,callback){
var cnt=fileElementIds.length;
for(var i=0;
i<cnt;
i++){
var element=document.getElementById(fileElementIds[i]);
if(element&&element.files&&element.files.length>0){
var file=element.files[0];
if(file){
var fileName=file.name||file.fileName;
var req=new XMLHttpRequest();
req.open("POST",url,true);
req.setRequestHeader("Cache-Control","no-cache");
req.setRequestHeader("X-Requested-With","XMLHttpRequest");
req.setRequestHeader("Content-Type",(file.type||"application/octet-stream")+";");
req.setRequestHeader("Content-Disposition",'attachment; filename="'+AjxUtil.convertToEntities(fileName)+'"');
if(window.csrfToken){
req.setRequestHeader("X-Zimbra-Csrf-Token",window.csrfToken)
}
var uploadResults=[];
req.onreadystatechange=function(req,fileName,callback){
if(req.readyState===4){
var response=null;
var aid=null;
var status=req.status;
if(status===200){
var resp=eval("["+req.responseText+"]");
response=resp.length&&resp[2];
if(response){
response=response[0];
if(response){
uploadResults.push({
aid:response.aid,filename:fileName}
);
if(i==cnt){
callback.run(status,uploadResults)
}}}}else{
callback.run(status,uploadResults)
}}}
.bind(this,req,fileName,callback);
req.send(file);
delete req
}else{
throw (new AjxException(ZaMsg.ERROR_INVALID_FILE_NAME,AjxException.UNKNOWN,"ZaUploader.prototype.upload"))
}}}};
ZaUploader.upload=function(s,e,n){
if(!AjxUtil.isArrayLike(e)){
e=[e]
}
if(AjxEnv.supportsHTML5File){
var o=new ZaUploader();
o._upload(e,appContextPath+"/../service/upload?fmt=extended,raw",s)
}else{
this.setUploadManager(new AjxPost(this.getUploadFrameId()));
var t=this.getUploadManager();
window._uploadManager=t;
t.execute(new AjxCallback(this,function(h,r){
var l=[];
if(AjxUtil.isArrayLike(r)){
l=r
}else{
var u="";
if(e[0]){
var d=document.getElementById(e[0]);
var c=d.files[0];
if(c){
u=c.name||c.fileName
}}
l.push({
aid:r,filename:u}
)
}
s.run(h,l)
}
),document.getElementById(n));
return
}}
}
if(AjxPackage.define("zimbraAdmin.common.ZaOverviewPanelController")){
ZaOverviewPanelController=function(t,e){
ZaController.call(this,t,e,"ZaOverviewPanelController");
this._init(t,e);
this._setView()
};
ZaOverviewPanelController.prototype=new ZaController;
ZaOverviewPanelController.prototype.constructor=ZaOverviewPanelController;
ZaOverviewPanelController.overviewTreeListeners=new Object();
ZaOverviewPanelController.treeModifiers=new Array();
ZaOverviewPanelController._TID="TID";
ZaOverviewPanelController._OBJ_ID="OBJ_ID";
ZaOverviewPanelController.prototype.toString=function(){
return"ZaOverviewPanelController"
};
ZaOverviewPanelController.prototype.getOverviewPanel=function(){
if(!this._overviewPanel){
this._setView()
}
return this._overviewPanel
};
ZaOverviewPanelController.prototype.handleCosCreation=function(e){
return
};
ZaOverviewPanelController.prototype.handleCosChange=function(e){
return
};
ZaOverviewPanelController.prototype.handleCosRemoval=function(e){
return
};
ZaOverviewPanelController.prototype.handleSearchFinished=function(e){
this.refreshSearchTree(e)
};
ZaOverviewPanelController.prototype.removeCosTreeItems=function(e){
return
};
ZaOverviewPanelController.prototype.searchDomains=function(){
var r=Dwt.getNextId();
var e=ZaApp.getInstance().getDomainListController();
e._currentQuery="";
if(!ZaZimbraAdmin.hasGlobalDomainListAccess()){
var o=ZaApp.getInstance()._domainNameList;
if(!o||!(o instanceof Array)||o.length==0){
ZaApp.getInstance()._domainList=new ZaItemList(ZaDomain);
return
}
if(o&&o instanceof Array){
for(var t=0;
t<o.length;
t++){
e._currentQuery+="("+ZaDomain.A_domainName+"="+o[t]+")"
}
if(o.length>1){
e._currentQuery="(|"+e._currentQuery+")"
}}}
var s={
query:e._currentQuery,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,offset:"0",sortAscending:"1",limit:ZaDomain.MAXSEARCHRESULTS,attrs:[ZaDomain.A_description,ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus,ZaItem.A_zimbraId,ZaDomain.A_domainType]};
var n=ZaSearch.searchDirectory(s);
this.domainSearchCallback(s,n)
};
ZaOverviewPanelController.prototype.domainSearchCallback=function(s,n){
try{
if(!n){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaOverviewPanelController.prototype.domainSearchCallback"))
}
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
var e=n.Body.SearchDirectoryResponse;
var o=new ZaItemList(ZaDomain);
o.loadFromJS(e);
if(e.more){
ZaSettings.HAVE_MORE_DOMAINS=true
}
this.updateDomainList(o)
}
catch(t){
if(t.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaOverviewPanelController.prototype.searchCallback")
}else{
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.queryParseError,t)
}}};
ZaOverviewPanelController.prototype.updateSavedSearchTreeList=function(){
var p=this._overviewPanel.getFolderTree();
var h=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_savedSearch]);
p.removeAllChild(h);
try{
var f=ZaApp.getInstance().getSavedSearchList();
if(f&&f.length){
var o=f.length;
for(var n=0;
n<o;
n++){
var c=new ZaTreeItemData({
parent:h,id:ZaId.getTreeItemId(ZaId.PANEL_APP,"currentSearch",null,n+1),text:f[n].name,buildPath:this.getSearchItemPath(),mappingId:ZaZimbraAdmin._SEARCH_HOME_VIEW}
);
c.setData("name",f[n].name);
c.setData("query",f[n].query);
p.addTreeItemData(c)
}
var r=p.getTreeItemByPath(h);
if(r){
var u=p.getTreeItemDataByPath(h);
var e,s,t,m;
for(var l=0;
l<u.childrenData.size();
l++){
s=u.childrenData.get(l);
if(s.forceNode!==undefined){
t=s.forceNode
}else{
t=s.childrenData.size()>0?true:false
}
e=new ZaTreeItem({
parent:r,className:"AdminTreeItem",id:s.id,forceNode:t}
);
e.setCount(s.count);
e.setText(s.text);
e.setImage(s.image);
e.setData(ZaOverviewPanelController._TID,s.mappingId);
e.setData("dataItem",s);
for(m in s._data){
e.setData(m,s._data[m])
}}
r.setExpanded(true)
}}}
catch(d){
this._handleException(d,"ZaOverviewPanelController.prototype._buildNewFolderTree",null,false)
}
return
};
ZaOverviewPanelController.prototype.updateDomainList=function(e){
return
};
ZaOverviewPanelController.prototype.setCurrentDomain=function(e){
this._currentDomain=e
};
ZaOverviewPanelController.prototype.getCurrentDomain=function(){
return this._currentDomain
};
ZaOverviewPanelController.prototype._init=function(t,e){
this._overviewPanel=null;
this._addressesTi=null;
this._configTi=null;
this._monitoringTi=null;
this._cosTi=null;
this._domainsTi=null;
this._serversTi=null;
this.statusTi=null;
this._savedSearchTi=null;
this._currentDomain="";
this._app=ZaApp.getInstance();
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DOMAIN_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._domainsMap=new Object()
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SERVER_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._serversMap=new Object()
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SERVER_STATS_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._serversStatsMap=new Object()
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.COS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._cosMap=new Object()
}
this._mailqMap=new Object();
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SAVE_SEARCH]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._savedSearchMapArr=[]
}};
ZaOverviewPanelController.prototype._setView=function(){
this._overviewPanel=new ZaOverviewPanel({
parent:this._container,className:"OverviewPanel",posStyle:DwtControl.ABSOLUTE_STYLE,id:ZaId.PANEL_APP}
);
this._overviewPanel.setScrollStyle(DwtControl.SCROLL);
ZaSearch.loadPredefinedSearch();
this._buildNewFolderTree();
this._overviewPanel.zShow(true)
};
ZaId.PANEL_HOME="Home";
ZaOverviewPanelController.prototype._buildNewFolderTree=function(){
var v=this._overviewPanel.getFolderTree();
var p;
var j=new AjxListener(this,this._overviewTreeListener);
v.addSelectionListener(j);
var k=ZaApp.getInstance().getPostQList().getArray();
var n=ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI];
var C=ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI];
var f=ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI];
var x=ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI];
if(!n){
for(var O=0;
O<ZaSettings.OVERVIEW_MONITORING_ITEMS.length;
O++){
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.OVERVIEW_MONITORING_ITEMS[O]]){
n=true;
break
}}}
if(!C){
for(var O=0;
O<ZaSettings.OVERVIEW_MANAGER_ACCOUNT_ITEMS.length;
O++){
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.OVERVIEW_MANAGER_ACCOUNT_ITEMS[O]]){
C=true;
break
}}}
if(!f){
for(var O=0;
O<ZaSettings.OVERVIEW_ADMIN_ITEMS.length;
O++){
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.OVERVIEW_ADMIN_ITEMS[O]]){
f=true;
break
}}}
if(!x){
for(var O=0;
O<ZaSettings.OVERVIEW_TOOLS_ITEMS.length;
O++){
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.OVERVIEW_TOOLS_ITEMS[O]]){
x=true;
break
}}}
var B=new ZaTreeItemData({
parent:"",id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,true),text:ZaMsg.OVP_home,mappingId:ZaZimbraAdmin._HOME_VIEW,image:"Home"}
);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._HOME_VIEW]=ZaOverviewPanelController.homeTreeListener;
v.setRootData(B);
if(n){
var M=new ZaTreeItemData({
parent:ZaMsg.OVP_home,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"monHV"),text:ZaMsg.OVP_monitor,defaultSelectedItem:1,className:"AdminHomeTreeItem",mappingId:ZaZimbraAdmin._MONITOR_HOME_VIEW,image:"Monitor"}
);
v.addTreeItemData(M);
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.GLOBAL_STATUS_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_monitor]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"monHV",null,"overviewStatusHV"),text:ZaMsg.OVP_status,mappingId:ZaZimbraAdmin._SERVER_STATUS_VIEW}
);
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SERVER_STATUS_VIEW]=ZaOverviewPanelController.statusTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SERVER_STATS_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this.addSubTabsToParentTreeItem(M,ZaGlobalStatsView.prototype.getTabChoices(),ZaZimbraAdmin._SERVER_STATISTICS_VIEW,true);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SERVER_STATISTICS_VIEW]=ZaOverviewPanelController.statsTreeListener;
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_monitor]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"monHV",null,"serverListForStatisticsHV"),text:ZaMsg.OVP_statistics,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._SERVER_LIST_FOR_STATISTICS_VIEW}
);
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SERVER_LIST_FOR_STATISTICS_VIEW]=ZaOverviewPanelController.serverListForStatisticsTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.MAILQ_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
try{
if(k&&k.length){
var T=k.length;
var R;
if(T>1){
R=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_monitor]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"monHV",null,"postQueueHV"),text:ZaMsg.OVP_postq,mappingId:ZaZimbraAdmin._POSTQ_VIEW}
);
v.addTreeItemData(R);
for(var h=0;
h<T;
h++){
var F=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_monitor,ZaMsg.OVP_postq]),id:DwtId._makeId(R.id,h+1),text:k[h].name,mappingId:ZaZimbraAdmin._POSTQ_BY_SERVER_VIEW}
);
F.setData(ZaOverviewPanelController._OBJ_ID,k[h].id);
this._mailqMap[k[h].id]=F;
v.addTreeItemData(F)
}
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._POSTQ_VIEW]=ZaOverviewPanelController.postqTreeListener
}else{
R=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_monitor]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"monHV",null,"postQueueHV"),text:ZaMsg.OVP_postq,mappingId:ZaZimbraAdmin._POSTQ_BY_SERVER_VIEW}
);
R.setData(ZaOverviewPanelController._OBJ_ID,k[0].id);
v.addTreeItemData(R)
}
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._POSTQ_BY_SERVER_VIEW]=ZaOverviewPanelController.postqByServerTreeListener
}}
catch(W){
this._handleException(W,"ZaOverviewPanelController.prototype._buildFolderTree",null,false)
}}}
if(C){
var S=new AjxCallback(this,ZaOverviewPanelController.manageAccountTreeListener);
var y=new ZaTreeItemData({
parent:ZaMsg.OVP_home,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"manActHV"),text:ZaMsg.OVP_manageAccounts,className:"AdminHomeTreeItem",callback:S,defaultSelectedItem:1,image:"ManageAccounts"}
);
v.addTreeItemData(y);
if(y){
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts]);
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var o=new ZaTreeItemData({
parent:e,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"actLstHV"),text:ZaMsg.OVP_accounts,count:0,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._ACCOUNTS_LIST_VIEW}
);
o.setData("TreeItemType",ZaItem.ACCOUNT);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._ACCOUNTS_LIST_VIEW]=ZaOverviewPanelController.accountListTreeListener;
v.addTreeItemData(o)
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ALIAS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var t=new ZaTreeItemData({
parent:e,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"aliaLstHV"),text:ZaMsg.OVP_aliases,count:0,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._ALIASES_LIST_VIEW}
);
t.setData("TreeItemType",ZaItem.ALIAS);
v.addTreeItemData(t);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._ALIASES_LIST_VIEW]=ZaOverviewPanelController.aliasListTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DL_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var z=new ZaTreeItemData({
parent:e,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"dlLstHV"),text:ZaMsg.OVP_distributionLists,count:0,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW}
);
z.setData("TreeItemType",ZaItem.DL);
v.addTreeItemData(z);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW]=ZaOverviewPanelController.dlListTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.RESOURCE_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var A=new ZaTreeItemData({
parent:e,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"resLstHV"),text:ZaMsg.OVP_resources,count:0,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._RESOURCE_VIEW}
);
A.setData("TreeItemType",ZaItem.RESOURCE);
v.addTreeItemData(A);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._RESOURCE_VIEW]=ZaOverviewPanelController.resourceListTreeListener
}}}
if(f){
u=this._configure=new ZaTreeItemData({
parent:ZaMsg.OVP_home,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"adminHV"),text:ZaMsg.OVP_configure,defaultSelectedItem:1,className:"AdminHomeTreeItem",mappingId:ZaZimbraAdmin._ADMINISTRATION_HOME_VIEW,image:"Administration"}
);
v.addTreeItemData(u);
if(this._configure){
p=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure]);
if(!ZaZimbraAdmin.hasGlobalCOSSListAccess()){
if(!ZaApp.getInstance()._domainNameList){
ZaApp.getInstance()._domainNameList=ZaDomain.getEffectiveDomainList(ZaZimbraAdmin.currentAdminAccount.id)
}}
if(!ZaZimbraAdmin.hasGlobalDomainListAccess()){
if(!ZaApp.getInstance()._cosNameList){
ZaApp.getInstance()._cosNameList=ZaCos.getEffectiveCosList(ZaZimbraAdmin.currentAdminAccount.id)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.COS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
u=new ZaTreeItemData({
parent:p,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_CONFIGURATION,null,ZaId.TREEITEM_COS),text:ZaMsg.OVP_cos,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._COS_LIST_VIEW}
);
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._COS_LIST_VIEW]=ZaOverviewPanelController.cosListTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DOMAIN_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
u=new ZaTreeItemData({
parent:p,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_CONFIGURATION,null,ZaId.TREEITEM_DOMAINS),text:ZaMsg.OVP_domains,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._DOMAINS_LIST_VIEW}
);
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DOMAINS_LIST_VIEW]=ZaOverviewPanelController.domainListTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SERVER_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
try{
var r=ZaApp.getInstance().getServerList().getArray();
if(r&&r.length){
var T=r.length;
var s;
if(T>0){
s=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_CONFIGURATION,null,"serverHV"),text:ZaMsg.OVP_servers,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._SERVERS_LIST_VIEW}
);
v.addTreeItemData(s);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SERVERS_LIST_VIEW]=ZaOverviewPanelController.serverListTreeListener
}else{
s=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_CONFIGURATION,null,"serverHV"),text:ZaMsg.OVP_serverSettings,image:"Server",mappingId:ZaZimbraAdmin._SERVER_VIEW}
);
s.setData(ZaOverviewPanelController._OBJ_ID,r[0].id);
v.addTreeItemData(s);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SERVER_VIEW]=ZaOverviewPanelController.serverTreeListener
}}}
catch(W){
this._handleException(W,"ZaOverviewPanelController.prototype._buildNewFolderTree",null,false)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.GLOBAL_CONFIG_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
u=new ZaTreeItemData({
parent:p,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_CONFIGURATION,null,ZaId.TREEITEM_GSET),text:ZaMsg.OVP_global,forceNode:true,mappingId:ZaZimbraAdmin._GLOBAL_SETTINGS}
);
u.addListener(ZaTreeEvent.ONDESTROY,new AjxListener(this,this.saveBeforeExit));
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._GLOBAL_SETTINGS]=ZaOverviewPanelController.globalSettingsTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ZIMLET_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
u=new ZaTreeItemData({
parent:p,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_CONFIGURATION,null,ZaId.TREEITEM_ZIMLETS),text:ZaMsg.OVP_zimlets,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._ZIMLET_LIST_VIEW}
);
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._ZIMLET_LIST_VIEW]=ZaOverviewPanelController.zimletListTreeListener
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ADMIN_ZIMLET_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
u=new ZaTreeItemData({
parent:p,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_CONFIGURATION,null,ZaId.TREEITEM_ADMINEXT),text:ZaMsg.OVP_adminZimlets,canShowOnRoot:false,forceNode:false,mappingId:ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW}
);
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW]=ZaOverviewPanelController.adminExtListTreeListener
}}}
if(x){
u=new ZaTreeItemData({
parent:ZaMsg.OVP_home,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"magHV"),text:ZaMsg.OVP_toolMig,className:"AdminHomeTreeItem",defaultSelectedItem:1,mappingId:ZaZimbraAdmin._MIGRATION_HOME_VIEW,image:"ToolsAndMigration"}
);
v.addTreeItemData(u);
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_toolMig]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"magHV",null,"download"),text:ZaMsg.goToMigrationWiz,mappingId:ZaZimbraAdmin._DOWNLOAD_VIEW}
);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DOWNLOAD_VIEW]=ZaOverviewPanelController.downloadTreeListener;
v.addTreeItemData(u)
}
u=new ZaTreeItemData({
parent:ZaMsg.OVP_home,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"searchHV"),text:ZaMsg.OVP_search,className:"AdminHomeTreeItem",mappingId:ZaZimbraAdmin._SEARCH_HOME_VIEW,image:"SearchAll"}
);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SEARCH_HOME_VIEW]=ZaOverviewPanelController.newSearchListTreeListener;
v.addTreeItemData(u);
p=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search]);
var m=new ZaTreeItemData({
parent:p,id:ZaId.getTreeItemId(ZaId.PANEL_APP,"searchHV",null,"currentSearch"),text:ZaMsg.OVP_search,defaultSelectedItem:1,image:"SearchAll",mappingId:ZaZimbraAdmin._SEARCH_HOME_VIEW}
);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SEARCH_HOME_VIEW]=ZaOverviewPanelController.newSearchListTreeListener;
v.addTreeItemData(m);
this.setSearchItemPath(ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_search]));
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_search]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"currentSearch",null,"allResult"),text:ZaMsg.OVP_allSearchResult,mappingId:ZaZimbraAdmin._SEARCH_RESULT_VIEW}
);
v.addTreeItemData(u);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SEARCH_RESULT_VIEW]=ZaOverviewPanelController.searchResultTreeListener;
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_search]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"currentSearch",null,"accountResult"),text:ZaMsg.OVP_accountSearchResult,mappingId:ZaZimbraAdmin._SEARCH_RESULT_VIEW}
);
u.setData("TreeItemType",ZaItem.ACCOUNT);
v.addTreeItemData(u);
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_search]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"currentSearch",null,"aliasResult"),text:ZaMsg.OVP_aliasSearchResult,mappingId:ZaZimbraAdmin._SEARCH_RESULT_VIEW}
);
u.setData("TreeItemType",ZaItem.ALIAS);
v.addTreeItemData(u);
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_search]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"currentSearch",null,"domainResult"),text:ZaMsg.OVP_domainSearchResult,mappingId:ZaZimbraAdmin._SEARCH_RESULT_VIEW}
);
u.setData("TreeItemType",ZaItem.DOMAIN);
v.addTreeItemData(u);
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_search]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"currentSearch",null,"dlResult"),text:ZabMsg.OVP_dlSearchResult,mappingId:ZaZimbraAdmin._SEARCH_RESULT_VIEW}
);
u.setData("TreeItemType",ZaItem.DL);
v.addTreeItemData(u);
var d=new ZaTreeItemData({
parent:p,canShowOnRoot:false,id:ZaId.getTreeItemId(ZaId.PANEL_APP,"searchHV",null,"searchOption"),text:ZaMsg.OVP_searchOption}
);
v.addTreeItemData(d);
m.addSilbings(d);
var b=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_searchOption]);
var q=ZaApp.getInstance().getSearchBuilderController().getFilterTreeItems();
for(var O=0;
O<q.length;
O++){
u=new ZaTreeItemData({
parent:b,canShowOnRoot:false,id:ZaId.getTreeItemId(ZaId.PANEL_APP,"searchOption",null,O+1),mappingId:ZaZimbraAdmin._SEARCH_FILTER_VIEW,buildPath:this.getSearchItemPath(),text:q[O].text}
);
u.setData("filterType",q[O].filterType);
v.addTreeItemData(u)
}
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._SEARCH_FILTER_VIEW]=ZaSearchBuilderController.searchFilterTreeListener;
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SAVE_SEARCH]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var g=new ZaTreeItemData({
parent:p,id:ZaId.getTreeItemId(ZaId.PANEL_APP,"searchHV",null,"savedSearch"),canShowOnRoot:false,text:ZaMsg.OVP_savedSearch}
);
v.addTreeItemData(g);
m.addSilbings(g);
try{
var w=ZaApp.getInstance().getSavedSearchList();
if(w&&w.length){
var c=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_savedSearch]);
this._savedSearchPath=c;
var T=w.length;
for(var h=0;
h<T;
h++){
var F=new ZaTreeItemData({
parent:c,id:ZaId.getTreeItemId(ZaId.PANEL_APP,"currentSearch",null,h+1),text:w[h].name,buildPath:this.getSearchItemPath(),mappingId:ZaZimbraAdmin._SEARCH_HOME_VIEW}
);
F.setData("name",w[h].name);
F.setData("query",w[h].query);
v.addTreeItemData(F)
}}}
catch(W){
this._handleException(W,"ZaOverviewPanelController.prototype._buildNewFolderTree",null,false)
}}
u=new ZaTreeItemData({
parent:ZaMsg.OVP_home,id:ZaId.getTreeItemId(ZaId.PANEL_APP,ZaId.PANEL_HOME,null,"helpCenter"),text:ZaMsg.zimbraHelpCenter,className:"AdminHomeTreeItem",defaultSelectedItem:1,mappingId:ZaZimbraAdmin._HELP_CENTER_HOME_VIEW,image:"Help"}
);
v.addTreeItemData(u);
u=new ZaTreeItemData({
parent:ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.zimbraHelpCenter]),id:ZaId.getTreeItemId(ZaId.PANEL_APP,"helpCenter",null,"helpCenter"),text:ZaMsg.zimbraHelpCenter,mappingId:ZaZimbraAdmin._HELP_CENTER_VIEW}
);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._HELP_CENTER_VIEW]=ZaZimbraAdmin.prototype._helpListener;
v.addTreeItemData(u);
if(ZaOverviewPanelController.treeModifiers){
var D=ZaOverviewPanelController.treeModifiers;
var T=D.length;
for(var O=0;
O<T;
O++){
if(typeof(D[O])=="function"){
D[O].call(this,v)
}}}};
ZaOverviewPanelController.prototype._overviewTreeListener=function(n){
try{
var o=null;
var e=n.item.getData(ZaOverviewPanelController._TID);
if(e!=null&&ZaOverviewPanelController.overviewTreeListeners[e]&&typeof(ZaOverviewPanelController.overviewTreeListeners[e])=="function"){
o=ZaOverviewPanelController.overviewTreeListeners[e]
}
if(o){
if(n.detail==DwtTree.ITEM_SELECTED){
o.call(this,n)
}else{
if(n.detail==DwtTree.ITEM_ACTIONED){
if(e==ZaZimbraAdmin._SEARCH_LIST_VIEW||e==ZaZimbraAdmin._SEARCH_HOME_VIEW){
o.call(this,n)
}}}}}
catch(t){
if(!t){
t=new ZmCsfeException("Unknown error",AjxException.UNKNOWN_ERROR,"ZaOverviewPanelController.prototype._overviewTreeListener","Unknown error")
}
this._handleException(t,"ZaOverviewPanelController.prototype._overviewTreeListener",null,false)
}};
ZaOverviewPanelController.prototype.setSearchItemPath=function(e){
this._searchItemPath=e
};
ZaOverviewPanelController.prototype.getSearchItemPath=function(e){
return this._searchItemPath
};
ZaOverviewPanelController.homeTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getHomeViewController(),ZaHomeController.prototype.show,null)
}else{
ZaApp.getInstance().getHomeViewController().show()
}
this._modifySearchMenuButton()
};
ZaOverviewPanelController.cosTreeListener=function(t){
var o=ZaApp.getInstance().getCosList(true).getItemById(t.item.getData(ZaOverviewPanelController._OBJ_ID));
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getCosController(),ZaCosController.prototype.show,o)
}else{
ZaApp.getInstance().getCosController().show(o)
}
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos]);
var n=t.item.getData("skipHistory");
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,o.name,null,(n=="TRUE"),false,o)
};
ZaOverviewPanelController.domainTreeListener=function(n){
var s=new ZaDomain();
s.id=n.item.getData(ZaOverviewPanelController._OBJ_ID);
s.attrs[ZaItem.A_zimbraId]=n.item.getData(ZaOverviewPanelController._OBJ_ID);
s.load("id",s.id);
var o=(s.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.local);
var t=(s.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.alias);
if(ZaApp.getInstance().getCurrentController()){
if(o){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getDomainController(),ZaDomainController.prototype.show,s)
}else{
if(t){
ZaApp.getInstance().getDomainAliasWizard(true).editDomainAlias(s,false)
}}}else{
if(o){
ZaApp.getInstance().getDomainController().show(s)
}else{
if(t){
ZaApp.getInstance().getDomainAliasWizard(true).editDomainAlias(s,false)
}}}
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_domains]);
var r=n.item.getData("skipHistory");
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,s.name,null,(r=="TRUE"),false,s)
};
ZaOverviewPanelController.serverTreeListener=function(e){
var t=new ZaServer();
t.id=e.item.getData(ZaOverviewPanelController._OBJ_ID);
t.attrs[ZaItem.A_zimbraId]=e.item.getData(ZaOverviewPanelController._OBJ_ID);
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getServerController(),ZaServerController.prototype.show,t)
}else{
ZaApp.getInstance().getServerController().show(ZaApp.getInstance().getServerList(true).getItemById(e.item.getData(ZaOverviewPanelController._OBJ_ID)))
}};
ZaOverviewPanelController.statsByServerTabTreeListener=function(o){
var e=o.item.parent.getData("viewId");
var t=ZaApp.getInstance().getServerStatsController(e);
ZaOverviewPanelController.switchToSubTabForNonXFormView(t,o.item)
};
ZaOverviewPanelController.statsByServerTreeListener=function(s){
var r=new ZaServer();
var e=s.item.getData("viewId");
ZaApp.getInstance().getAppViewMgr().pushView(e);
var h=ZaApp.getInstance().getAppViewMgr().getViewContentById(e);
var o=ZaApp.getInstance().getControllerById(e);
var t=h._containedObject;
var n=t.id;
r.id=r.attrs[ZaItem.A_zimbraId]=n;
r.load("id",n,false,true);
o.show(r,true)
};
ZaOverviewPanelController.statusTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getStatusViewController(),ZaStatusViewController.prototype.show,null)
}else{
ZaApp.getInstance().getStatusViewController().show()
}};
ZaOverviewPanelController.statsTreeListener=function(t){
var e=ZaApp.getInstance().getCurrentController();
var o=ZaApp.getInstance().getGlobalStatsController();
if(e){
e.switchToNextView(o,ZaGlobalStatsController.prototype.show,null)
}else{
o.show()
}
ZaOverviewPanelController.switchToSubTabForNonXFormView(o,t.item)
};
ZaOverviewPanelController.switchToSubTabForNonXFormView=function(o,n){
var e=n.getData("tabValue");
var t=ZaApp.getInstance().getAppViewMgr().getViewContentById(o.getContentViewId());
t.switchToTab(e)
};
ZaOverviewPanelController.serverListForStatisticsTreeListener=function(t){
var e=ZaApp.getInstance().getCurrentController();
var n=ZaApp.getInstance().getServerStatsListController();
var o=ZaServer.getAll([ZaServer.A_description,ZaServer.A_ServiceHostname,ZaItem.A_zimbraId]);
if(e){
e.switchToNextView(n,ZaServerStatsListController.prototype.show,o)
}else{
n.show(o)
}};
ZaOverviewPanelController.serverListTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getServerListController(),ZaServerListController.prototype.show,ZaServer.getAll([ZaServer.A_description,ZaServer.A_ServiceHostname,ZaItem.A_zimbraId]))
}else{
ZaApp.getInstance().getServerListController().show(ZaServer.getAll([ZaServer.A_description,ZaServer.A_ServiceHostname,ZaItem.A_zimbraId]))
}};
ZaOverviewPanelController.globalSettingsTreeListener=function(o){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getGlobalConfigViewController(),ZaGlobalConfigViewController.prototype.show,ZaApp.getInstance().getGlobalConfig())
}else{
ZaApp.getInstance().getGlobalConfigViewController().show(ZaApp.getInstance().getGlobalConfig())
}
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure]);
var t=o.item.getText();
this.addObjectItem(e,t,undefined,true,true,o.item,undefined,true)
};
ZaOverviewPanelController.domainListTreeListener=function(n){
var t=ZaApp.getInstance().getDomainListController();
t._currentQuery="";
var l=null;
var e=n.item.getData(ZaOverviewPanelController._TID);
if(e==ZaZimbraAdmin._COS_DOMAIN_LIST_VIEW){
var r=n.item.getData("cosItem");
l="("+ZaDomain.A_domainDefaultCOSId+"="+r.id+")";
if(r.name=="default"){
l="(|(!("+ZaDomain.A_domainDefaultCOSId+"=*))"+l+")"
}else{
if(r.name=="defaultExternal"){
l="(|(!("+ZaDomain.A_domainDefaultExternalUserCOSId+"=*))"+l+")"
}}}else{
if(e==ZaZimbraAdmin._DOMAIN_ALIAS_LIST_VIEW){
var s=n.item.getData("domainItem");
l="("+ZaDomain.A_zimbraDomainAliasTargetId+"="+s.id+")"
}}
if(l){
t._currentQuery=l
}
if(!ZaZimbraAdmin.isGlobalAdmin()){
var h=ZaApp.getInstance()._domainNameList;
if(h&&h instanceof Array&&h.length>0){
for(var o=0;
o<h.length;
o++){
t._currentQuery+="("+ZaDomain.A_domainName+"="+h[o]+")"
}
if(h.length>1){
t._currentQuery="(|"+t._currentQuery+")"
}}}
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(t,ZaDomainListController.prototype.show,true)
}else{
t.show(true)
}
this._modifySearchMenuButton(ZaItem.DOMAIN)
};
ZaOverviewPanelController.aliasListTreeListener=function(t){
if((t.item.getData(ZaOverviewPanelController._TID)==ZaZimbraAdmin._ACCOUNT_ALIAS_LIST_VIEW)||t.item.getData(ZaOverviewPanelController._TID)==ZaZimbraAdmin._DL_ALIAS_LIST_VIEW){
var e=t.item.getData("aliasTargetId");
var o="("+ZaAlias.A_AliasTargetId+"="+e+")";
this._showAccountsView(ZaItem.ALIAS,t,o)
}else{
this._showAccountsView(ZaItem.ALIAS,t)
}
this._modifySearchMenuButton(ZaItem.ALIAS)
};
ZaOverviewPanelController.dlListTreeListener=function(o){
var s=o.item.getData(ZaAccount.A2_memberOf);
if(s){
var e=s[ZaAccount.A2_directMemberList];
var r=s[ZaAccount.A2_indirectMemberList];
var n="";
var h="";
for(var t=0;
t<(e.length+r.length);
t++){
if(t<e.length){
h=e[t].id
}else{
h=r[t-e.length].id
}
n+="("+ZaItem.A_zimbraId+"="+h+")"
}
n="(|"+n+")";
this._showAccountsView(ZaItem.DL,o,n)
}else{
this._showAccountsView(ZaItem.DL,o)
}
this._modifySearchMenuButton(ZaItem.DL)
};
ZaOverviewPanelController.accountListTreeListener=function(e){
if(e.item.getData(ZaOverviewPanelController._TID)==ZaZimbraAdmin._COS_ACCOUNT_LIST_VIEW){
var t=e.item.getData("cosItem");
var o="("+ZaAccount.A_COSId+"="+t.id+")";
if(t.name=="default"){
o="(|(&(!("+ZaAccount.A_COSId+"=*))(!("+ZaAccount.A_zimbraIsExternalVirtualAccount+"=TRUE)))"+o+")"
}else{
if(t.name=="defaultExternal"){
o="(|(&(!("+ZaAccount.A_COSId+"=*))("+ZaAccount.A_zimbraIsExternalVirtualAccount+"=TRUE))"+o+")"
}}
this._showAccountsView(ZaItem.ACCOUNT,e,o)
}else{
this._showAccountsView(ZaItem.ACCOUNT,e)
}
this._modifySearchMenuButton(ZaItem.ACCOUNT)
};
ZaOverviewPanelController.resourceListTreeListener=function(e){
this._showAccountsView(ZaItem.RESOURCE,e);
this._modifySearchMenuButton(ZaItem.RESOURCE)
};
ZaOverviewPanelController.searchListTreeListener=function(t){
var n=ZaApp.getInstance().getSearchListController()._searchField;
var e=t.item.getData("name");
var o=t.item.getData("query");
if(t.detail==DwtTree.ITEM_SELECTED){
if(o){
n.selectSavedSearch(e,o)
}else{
n.invokeCallback()
}}else{
if(t.detail==DwtTree.ITEM_ACTIONED){
n._currentSavedSearch={
name:e,query:o};
n.getSavedSearchActionMenu().popup(0,t.docX,t.docY)
}}};
ZaOverviewPanelController.newSearchListTreeListener=function(n){
var u=this.getOverviewPanel().getFolderTree();
var l=u.getABPath(n.item.getData("dataItem"));
if(l==ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search])){
var d=this.getSearchItemPath();
u.setSelectionByPath(d,true,true)
}
var s=ZaApp.getInstance().getSearchListController();
var c=s._searchField;
var e=n.item.getData("name");
var o=n.item.getData("query");
if(n.detail==DwtTree.ITEM_SELECTED){
if(o){
c.setCurrentSavedSearch({
name:e,query:o}
);
c.selectSavedSearch(e,o)
}else{
c.setCurrentSavedSearch({}
);
var h=c.getCurrentSearchQuery();
var r=c.getSearchFieldElement().value;
if(c.searchSelectedType&&c.searchSelectedType.length>0){
r+=" In "+c.searchSelectedType
}
var t={
type:1,unique:true,disableForSearch:false,query:h.query,searchType:h.types,displayName:r};
if(!s._uiContainer){
s._show()
}
s._uiContainer.removeAllBubbles(true);
s._uiContainer.addBubble(t)
}}
if(n.detail==DwtTree.ITEM_ACTIONED&&o){
c._currentSavedSearch={
name:e,query:o};
c.getSavedSearchActionMenu().popup(0,n.docX,n.docY)
}};
ZaOverviewPanelController.searchResultTreeListener=function(n){
if(n.detail==DwtTree.ITEM_SELECTED){
var t=n.item.getData("TreeItemType");
var s=ZaApp.getInstance().getSearchListController();
s.reset();
var c=s._searchField;
var l=s._contentView;
var o=false;
if(t==ZaItem.ACCOUNT){
if(c._containedObject[ZaSearch.A_fAccounts]=="FALSE"){
l.set();
o=true
}else{
c.accFilterSelectedFromResults()
}}else{
if(t==ZaItem.ALIAS){
if(c._containedObject[ZaSearch.A_fAliases]=="FALSE"){
l.set();
o=true
}else{
c.aliasFilterSelectedFromResults()
}}else{
if(t==ZaItem.DOMAIN){
if(c._containedObject[ZaSearch.A_fDomains]=="FALSE"){
l.set();
o=true
}else{
c.domainFilterSelectedFromResults()
}}else{
if(t==ZaItem.DL){
if(c._containedObject[ZaSearch.A_fdistributionlists]=="FALSE"){
l.set();
o=true
}else{
c.dlFilterSelectedFromResults()
}}else{}}}}
c.setCurrentSavedSearch({}
);
var h=c.getCurrentSearchQuery();
var r=c.getSearchFieldElement().value;
if(c.searchSelectedType&&c.searchSelectedType.length>0){
r+=" In "+c.searchSelectedType;
if(t&&t.length>0){
r+=" & "+t
}}else{
if(t&&t.length>0){
r+=" In "+t
}}
var e={
type:1,unique:true,disableForSearch:o,query:h.query,searchType:h.types,displayName:r};
if(!s._uiContainer){
s._show()
}
s._uiContainer.removeAllBubbles(true);
s._uiContainer.addBubble(e,o);
c.restoreSearchFilter()
}};
ZaOverviewPanelController.downloadTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getMigrationWizController(),ZaMigrationWizController.prototype.show,null)
}else{
ZaApp.getInstance().getMigrationWizController().show()
}};
ZaOverviewPanelController.zimletListTreeListener=function(e){
ZaZimlet.getAll(ZaZimlet.EXCLUDE_EXTENSIONS,new AjxCallback(ZaOverviewPanelController._zimletListTreeListener))
};
ZaOverviewPanelController._zimletListTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getZimletListController(),ZaZimletListController.prototype.show,e)
}else{
ZaApp.getInstance().getZimletListController().show(e)
}};
ZaOverviewPanelController.adminExtListTreeListener=function(e){
ZaZimlet.getAll(ZaZimlet.EXCLUDE_MAIL,new AjxCallback(ZaOverviewPanelController._adminExtListTreeListener))
};
ZaOverviewPanelController._adminExtListTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getAdminExtListController(),ZaAdminExtListController.prototype.show,e)
}else{
ZaApp.getInstance().getAdminExtListController().show(e)
}};
ZaOverviewPanelController.cosListTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getCosListController(),ZaCosListController.prototype.show,true)
}else{
ZaApp.getInstance().getCosListController().show(true)
}
this._modifySearchMenuButton(ZaItem.COS)
};
ZaOverviewPanelController.postqTreeListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getMTAListController(),ZaMTAListController.prototype.show,ZaMTA.getAll())
}else{
ZaApp.getInstance().getMTAListController().show(ZaServer.getAll())
}};
ZaOverviewPanelController.postqByServerTreeListener=function(e){
var t=ZaApp.getInstance().getPostQList().getItemById(e.item.getData(ZaOverviewPanelController._OBJ_ID));
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getMTAController(),ZaMTAController.prototype.show,t)
}else{
ZaApp.getInstance().getMTAController().show(t)
}};
ZaOverviewPanelController.accountStatCallback=function(n){
var t=this._overviewPanel.getFolderTree().getCurrentRootItem().getItems();
for(var o=0;
o<t.length;
o++){
var s=t[o];
var e=s.getData("TreeItemType");
s.setCount(n[e])
}};
ZaOverviewPanelController.manageAccountTreeListener=function(s){
var o=[];
var e=this._overviewPanel.getFolderTree().getCurrentRootItem().getItems();
for(var t=0;
t<e.length;
t++){
var h=e[t];
if(h){
var n=h.getData("TreeItemType");
if(!AjxUtil.isEmpty(n)){
o.push(n)
}}}
var r=new AjxCallback(this,ZaOverviewPanelController.accountStatCallback);
ZaSearch.getObjectCounts(o,r)
};
ZaOverviewPanelController.accountListInDomainTreeListener=function(e){
var t=e.item.getData("domainItem");
ZaDomain.searchAccountsInDomain(t.name)
};
ZaOverviewPanelController.memberListInDLTreeListener=function(l){
var s=l.item.getData("dlItem");
var e=s[ZaDistributionList.A2_memberList];
var h="";
if(e.length>0){
for(var t=0;
t<e.length;
t++){
h+="("+ZaAccount.A_mail+"="+e[t][ZaAccount.A_name]+")"
}
if(e.length>1){
h="(|"+h+")"
}
var r=[ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.ALIASES];
var n=ZaApp.getInstance().getSearchListController();
var o=Dwt.getNextId();
var d=new AjxCallback(n,n.searchCallback,{
limit:n.RESULTSPERPAGE,show:true,busyId:o}
);
n.fetchAttrs=ZaSearch.standardAttributes;
var c={
query:h,types:r,attrs:n.fetchAttrs,callback:d,controller:n,showBusy:true,busyId:o,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false};
n.setQuery(h);
n.setSearchTypes(r);
ZaSearch.searchDirectory(c)
}};
ZaOverviewPanelController.prototype.refreshAccountTree=function(){
var n=ZaMsg.OVP_home+ZaTree.SEPERATOR+ZaMsg.OVP_manageAccounts;
var e=this.getOverviewPanel().getFolderTree();
var t=e.getCurrentRootItem();
var o=e.getABPath(t.getData("dataItem"));
if(n==o){
ZaOverviewPanelController.manageAccountTreeListener.call(this)
}};
ZaOverviewPanelController.prototype.refreshSearchTree=function(c){
var e=c.getDetails();
if(!e){
return
}
var n=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_search,ZaMsg.OVP_search]);
var m=this.getOverviewPanel().getFolderTree();
var d=m.getCurrentRootItem();
var u=m.getABPath(d.getData("dataItem"));
if(n!=u){
return
}
var r=d.getItems();
var o=m.getCurrentSelectedItems().get(0);
var h;
var l;
if(o){
l=o.getData("TreeItemType")
}
if(l){
h=e.searchTotal;
h=h||0;
o.setCount(h);
return
}
for(var s=0;
s<r.length;
s++){
var t=r[s];
l=t.getData("TreeItemType");
if(l){
h=e[l];
h=h||0;
if(e.more){
h=h+"+"
}}else{
h=e.searchTotal||0
}
t.setCount(h)
}};
ZaOverviewPanelController.manageRelatedTreeListener=function(t,r){
var e=this.getOverviewPanel().getFolderTree();
if(t.length==0){
return""
}
var s=t.join(ZaTree.SEPERATOR);
var o=e.getCurrentRootItem();
var n=e.getABPath(o.getData("dataItem"));
if(n==s){
var h=e.getTreeItemDataByPath(s);
if(h){
h.addRelatedObject(this.getRelatedList(s,r))
}
ZaOverviewPanelController.updateRelatedTreeListener.call(this,t)
}};
ZaOverviewPanelController.updateRelatedTreeListener=function(h){
var d=this.getOverviewPanel().getFolderTree();
if(h.length==0){
return""
}
var n=h.join(ZaTree.SEPERATOR);
var l=ZaTree.SEPERATOR+ZaMsg.OVP_related;
var r=d.getTreeItemDataByPath(n);
d.buildTree(r);
var o=d.getCurrentSelectedItems().getArray();
var e=o?o[0]:null;
var t=e?d.getABPath(e.getData("dataItem")):null;
var c=d.getTreeItemByPath(t)||d.getSelectedItem(r);
var s=false;
if(t.indexOf(n+l)==-1){
s=true
}
d.setSelection(c,s)
};
ZaOverviewPanelController.prototype.refreshRelatedTree=function(f,o,g,r){
try{
var q=AjxUtil.toArray(f);
var s={};
var u={};
var c={};
var w={};
var z,j,n,d,T,k,p,y,t,h;
for(var b=0;
b<q.length;
b++){
var x=q[b];
if(AjxUtil.isEmpty(x)){
continue
}
if(x.type==ZaItem.ACCOUNT){
if(!o){
n=ZaAccount.prototype.getCurrentCos.call(x);
j=n[ZaAccount.A_name];
if(typeof(u[j])=="undefined"){
u[j]=1;
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos,j],n)
}
if(typeof(u["default"])=="undefined"){
u["default"]=1;
k=ZaCos.getCosByName("default");
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos,"default"],k)
}
if(typeof(u.defaultExternal)=="undefined"){
u.defaultExternal=1;
k=ZaCos.getCosByName("defaultExternal");
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos,"defaultExternal"],k)
}}}
if(x.type==ZaItem.ALIAS){
if(!r){
var l=x.targetObj;
var m=l[ZaAccount.A_name];
if(l.type==ZaItem.ACCOUNT){
if(typeof(w[m])=="undefined"){
w[m]=1;
l.load();
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts,ZaMsg.OVP_accounts,m],l)
}}
if(l.type==ZaItem.DL){
if(typeof(c[m])=="undefined"){
c[m]=1;
l.load();
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts,ZaMsg.OVP_distributionLists,m],l)
}}}}
if(x.type==ZaItem.ACCOUNT){
if(!r){
if(!AjxUtil.isEmpty(x[ZaAccount.A2_memberOf])&&!AjxUtil.isEmpty(x[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList])){
var e=x[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
for(var b=0;
b<e.length;
b++){
t=e[b][ZaAccount.A_name];
if(typeof(c[t])=="undefined"){
c[t]=1;
y=new ZaDistributionList(e[b]["id"],t);
y.load();
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts,ZaMsg.OVP_distributionLists,t],y)
}}}}}
if(x.type==ZaItem.DL){
if(!r){
if(x[ZaDistributionList.A2_numMembers]>0){
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts,ZaMsg.OVP_distributionLists,x.name],x)
}}}
if(!g&&(x.type==ZaItem.ACCOUNT||x.type==ZaItem.ALIAS||x.type==ZaItem.DL||x.type==ZaItem.RESOURCE)){
d=ZaAccount.getDomain(x[ZaAccount.A_name]);
if(typeof(s[d])=="undefined"){
T=ZaDomain.getDomainByName(d);
s[d]=1;
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_domains,d],T)
}}
if(x.type==ZaItem.DOMAIN){
if(!o&&x.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.local){
z=x.attrs[ZaDomain.A_domainDefaultCOSId];
n=ZaCos.getCosById(z);
if(!n){
n=ZaCos.getCosByName("default")
}
j=n[ZaAccount.A_name];
if(typeof(u[j])=="undefined"){
u[j]=1;
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos,j],n)
}
if(typeof(u["default"])=="undefined"){
u["default"]=1;
k=ZaCos.getCosByName("default");
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos,"default"],k)
}}else{
if(!g&&x.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.alias){
d=x.attrs[ZaDomain.A_zimbraMailCatchAllForwardingAddress];
d=d.replace("@","");
if(typeof(s[d])=="undefined"){
T=ZaDomain.getDomainByName(d);
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_domains,d],T)
}}}}}}
catch(v){
ZaApp.getInstance().getCurrentController()._handleException(v,"ZaOverviewPanelController.prototype.refreshRelatedTree")
}};
ZaOverviewPanelController.prototype.refreshRelatedTreeByEdit=function(t){
try{
if(AjxUtil.isEmpty(t)){
return
}
if(t.type==ZaItem.DL){
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts,ZaMsg.OVP_distributionLists,t[ZaAccount.A_name]],t)
}
if(t.type==ZaItem.DOMAIN&&t.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.local&&t.createGalAccount){
ZaOverviewPanelController.manageRelatedTreeListener.call(this,[ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_domains,t[ZaAccount.A_name]],t)
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaOverviewPanelController.prototype.refreshRelatedTreeByEdit")
}};
ZaOverviewPanelController.prototype._modifySearchMenuButton=function(t){
var e=ZaApp.getInstance().getSearchListController();
if(!e||!e._searchField){
return
}
if(t){
switch(t){
case ZaItem.ACCOUNT:e._searchField.accFilterSelected();
break;
case ZaItem.ALIAS:e._searchField.aliasFilterSelected();
break;
case ZaItem.DL:e._searchField.dlFilterSelected();
break;
case ZaItem.RESOURCE:e._searchField.resFilterSelected();
break;
case ZaItem.DOMAIN:e._searchField.domainFilterSelected();
break;
case ZaItem.COS:e._searchField.cosFilterSelected();
break
}}else{
e._searchField.allFilterSelected()
}};
ZaOverviewPanelController.prototype.addAccountItem=function(s,r){
var n=s.type;
var t=ZaMsg.OVP_accounts;
if(n==ZaItem.ACCOUNT){
t=ZaMsg.OVP_accounts
}else{
if(n==ZaItem.DL){
t=ZaMsg.OVP_distributionLists
}else{
if(n==ZaItem.RESOURCE){
t=ZaMsg.OVP_resources
}else{
if(n==ZaItem.ALIAS){
if(s.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_ACCOUNT){
t=ZaMsg.OVP_accounts
}else{
if(s.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_DL){
t=ZaMsg.OVP_distributionLists
}else{
if(s.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_RESOURCE){
t=ZaMsg.OVP_resources
}}}}}}}
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts,t]);
var o=s.name;
this.addObjectItem(e,o,r,false,false,s,undefined,true)
};
ZaOverviewPanelController.prototype.saveBeforeExit=function(t){
var e=ZaApp.getInstance().getCurrentController();
if(e instanceof ZaXFormViewController){
e.closeButtonListener(undefined,undefined,undefined,undefined,undefined,t.newPath);
return false
}};
ZaOverviewPanelController.prototype.addObjectItem=function(c,x,k,l,u,n,r,v){
if(!k){
k=ZaApp.getInstance().getAppViewMgr().getCurrentViewContent();
if(!k||!k.getTabChoices||!k.getTabChoices()){
return false
}}
var m=c+ZaTree.SEPERATOR+x;
var d=this.getOverviewPanel().getFolderTree();
var p,e,w;
var b=false;
var s=false;
var o=d.getTreeItemDataByPath(m);
if(!o){
b=s=true
}else{
if(o.getChildrenNum()<=0){
s=true
}}
var g=new ZaHistory(m,x,n?n.type:null);
ZaZimbraAdmin.getInstance().getHisotryMgr().addHistoryObj(g);
if(b){
var t=d.getTreeItemDataByPath(c);
var h=t.getChildrenNum();
var f=t.id;
if(!r||!(w=r.mainNode)){
p=ZaZimbraAdmin._XFORM_VIEW;
e=ZaOverviewPanelController.xformTreeListener
}else{
p=w.mappingId;
e=w.handler
}
o=new ZaTreeItemData({
parent:c,mappingId:p,id:DwtId._makeId(f,h+1),image:(n?this.getIconByType(n.type):null),defaultSelectedItem:1,text:x}
);
d.addTreeItemData(o);
o.addRelatedObject(this.getRelatedList(c,n));
o.addRecentObject(this.getRecentList());
if(v){
o.addListener(ZaTreeEvent.ONDESTROY,new AjxListener(this,this.saveBeforeExit))
}
ZaOverviewPanelController.overviewTreeListeners[p]=e
}else{
o.addRelatedObject(this.getRelatedList(c,n));
o.addRecentObject(this.getRecentList())
}
var y=ZaApp.getInstance().getAppViewMgr().getCurrentView();
o.setData("viewId",y);
if(s){
if(!r||!(w=r.tabNodes)){
p=ZaZimbraAdmin._XFORM_TAB_VIEW;
e=ZaOverviewPanelController.xformTabTreeListener
}else{
p=w.mappingId;
e=w.handler
}
this.addSubTabsToParentTreeItem(o,k.getTabChoices(),p);
ZaOverviewPanelController.overviewTreeListeners[p]=e
}
d.setSelectionByPath(m,!l,u);
return true
};
ZaOverviewPanelController.prototype.addSubTabsToParentTreeItem=function(t,d,c,e){
var n,l,r;
var u=this.getOverviewPanel().getFolderTree();
var o=u.getABPath(t);
var s=e?true:false;
if(d&&d.length>0){
t.setData("firstTab",d[0].value);
for(var h=0;
h<d.length;
h++){
l=d[h];
r=DwtId._makeId(t.id,h+1);
n=new ZaTreeItemData({
parent:o,id:r,isShowHistory:s,text:l.label,mappingId:c}
);
n.setData("tabValue",l.value);
u.addTreeItemData(n)
}}};
ZaOverviewPanelController.xformTabTreeListener=function(s){
var t=s.item.parent.getData("viewId");
var e=s.item.getData("tabValue");
if(AjxUtil.isEmpty(t)||AjxUtil.isEmpty(e)){
return
}
ZaApp.getInstance().getAppViewMgr().pushView(t);
var r=ZaApp.getInstance().getAppViewMgr().getViewContentById(t);
if(AjxUtil.isEmpty(r)){
return
}
if(s.refresh){
var n=ZaApp.getInstance().getControllerById(t);
if(!AjxUtil.isEmpty(n)){
var o=n._currentObject;
if(o&&o.refresh){
o.refresh(false,true);
r.setObject(o)
}}}
if(!AjxUtil.isEmpty(r._localXForm)){
r._localXForm.setInstanceValue(e,ZaModel.currentTab)
}};
ZaOverviewPanelController.xformTreeListener=function(s){
var t=s.item.getData("viewId");
var e=s.item.getData("firstTab");
if(AjxUtil.isEmpty(t)||AjxUtil.isEmpty(e)){
return
}
ZaApp.getInstance().getAppViewMgr().pushView(t);
var r=ZaApp.getInstance().getAppViewMgr().getViewContentById(t);
if(AjxUtil.isEmpty(r)){
return
}
if(s.refresh){
var n=ZaApp.getInstance().getControllerById(t);
if(!AjxUtil.isEmpty(n)){
var o=n._currentObject;
if(o&&o.refresh){
o.refresh(false,true);
r.setObject(o)
}}}
if(!AjxUtil.isEmpty(r._localXForm)){
r._localXForm.setInstanceValue(e,ZaModel.currentTab)
}};
ZaOverviewPanelController.prototype.getRelatedList=function(e,t){
if(!t||!t.getRelatedList){
return[]
}
return t.getRelatedList(e)
};
ZaOverviewPanelController.prototype.getRecentList=function(){
var s=ZaZimbraAdmin.getInstance().getHisotryMgr();
var t=s.getAllHistoryObj().getArray();
var e=[];
var n=null;
var r=null;
for(var o=t.length-1;
o>-1;
o--){
r=this.getIconByType(t[o].type);
n=new ZaTreeItemData({
text:t[o].displayName,type:1,image:r,isShowHistory:false,forceNode:(o+1!=t.length),path:t[o].path}
);
e.push(n)
}
return e
};
ZaOverviewPanelController.prototype.getIconByType=function(e){
var t=null;
if(e==ZaItem.ACCOUNT){
t="Account"
}else{
if(e==ZaItem.COS){
t="COS"
}else{
if(e==ZaItem.DOMAIN){
t="Domain"
}else{
if(e==ZaItem.RESOURCE){
t="Resource"
}else{
if(e==ZaItem.DL){
t="DistributionList"
}else{
if(e==ZaItem.ALIAS){
t="AccountAlias"
}else{
if(e==ZaItem.SERVER){
t="Server"
}else{
if(e==ZaItem.RIGHT){
t="RightObject"
}}}}}}}}
return t
}
}
if(AjxPackage.define("zimbraAdmin.common.ZaOperation")){
ZaOperation=function(o,c,d,t,n,r,l,s,h,e){
this.id=o;
this.caption=c;
this.tt=d;
this.listener=r;
this.imageId=t;
this.disImageId=n;
this.type=(l==null)?ZaOperation.TYPE_BUTTON:l;
this.menuOpList=s;
this.className=h;
this.labelId=e;
this.enabled=true;
this.visible=true
};
ZaOperation.prototype.toString=function(){
return"ZaOperation"
};
ZaOperation.prototype.setEnabled=function(e){
this.enabled=e
};
ZaOperation.prototype.setVisible=function(e){
this.visible=e
};
ZaOperation.duplicate=function(n){
var o=n.id;
var u=n.caption;
var m=n.tt;
var l=n.listener;
var t=n.imageId;
var s=n.disImageId;
var d=n.type;
var r=n.menuOpList;
var c=n.className;
var e=n.labelId;
var h=new ZaOperation(o,u,m,t,s,l,d,r,c,e);
return h
};
ZaOperation.TYPE_BUTTON=1;
ZaOperation.TYPE_MENU=2;
ZA_OP_INDEX=0;
ZaOperation.NONE=++ZA_OP_INDEX;
ZaOperation.SEP=++ZA_OP_INDEX;
ZaOperation.NEW=++ZA_OP_INDEX;
ZaOperation.DELETE=++ZA_OP_INDEX;
ZaOperation.REFRESH=++ZA_OP_INDEX;
ZaOperation.EDIT=++ZA_OP_INDEX;
ZaOperation.CHNG_PWD=++ZA_OP_INDEX;
ZaOperation.CLOSE=++ZA_OP_INDEX;
ZaOperation.SAVE=++ZA_OP_INDEX;
ZaOperation.NEW_WIZARD=++ZA_OP_INDEX;
ZaOperation.NEW_ALIAS=++ZA_OP_INDEX;
ZaOperation.NEW_DL=++ZA_OP_INDEX;
ZaOperation.NEW_RESOURCE=++ZA_OP_INDEX;
ZaOperation.NEW_ADMIN=++ZA_OP_INDEX;
ZaOperation.PAGE_FORWARD=++ZA_OP_INDEX;
ZaOperation.PAGE_BACK=++ZA_OP_INDEX;
ZaOperation.DUPLICATE=++ZA_OP_INDEX;
ZaOperation.GAL_WIZARD=++ZA_OP_INDEX;
ZaOperation.AUTH_WIZARD=++ZA_OP_INDEX;
ZaOperation.AUTOPROV_WIZARD=++ZA_OP_INDEX;
ZaOperation.VIEW_MAIL=++ZA_OP_INDEX;
ZaOperation.MOVE_ALIAS=++ZA_OP_INDEX;
ZaOperation.NEW_MENU=++ZA_OP_INDEX;
ZaOperation.HELP=++ZA_OP_INDEX;
ZaOperation.REINDEX_MAILBOX=++ZA_OP_INDEX;
ZaOperation.LABEL=++ZA_OP_INDEX;
ZaOperation.VIEW=++ZA_OP_INDEX;
ZaOperation.SEARCH_ACCOUNTS=++ZA_OP_INDEX;
ZaOperation.SEARCH_ALIASES=++ZA_OP_INDEX;
ZaOperation.SEARCH_DLS=++ZA_OP_INDEX;
ZaOperation.SEARCH_DOMAINS=++ZA_OP_INDEX;
ZaOperation.SEARCH_RESOURCES=++ZA_OP_INDEX;
ZaOperation.SEARCH_COSES=++ZA_OP_INDEX;
ZaOperation.SEARCH_ALL=++ZA_OP_INDEX;
ZaOperation.FLUSH=++ZA_OP_INDEX;
ZaOperation.HOLD=++ZA_OP_INDEX;
ZaOperation.REQUEUE=++ZA_OP_INDEX;
ZaOperation.RELEASE=++ZA_OP_INDEX;
ZaOperation.INIT_NOTEBOOK=++ZA_OP_INDEX;
ZaOperation.CHECK_MX_RECORD=++ZA_OP_INDEX;
ZaOperation.SEARCH_RESULT_COUNT=++ZA_OP_INDEX;
ZaOperation.SEARCH_BY_ADDESS_TYPE=++ZA_OP_INDEX;
ZaOperation.SEARCH_BY_DOMAIN=++ZA_OP_INDEX;
ZaOperation.SEARCH_BY_SERVER=++ZA_OP_INDEX;
ZaOperation.SEARCH_BY_BASIC=++ZA_OP_INDEX;
ZaOperation.SEARCH_BY_REMOVE_ALL=++ZA_OP_INDEX;
ZaOperation.SEARCH_BY_ADVANCED=++ZA_OP_INDEX;
ZaOperation.SEARCH_BY_COS=++ZA_OP_INDEX;
ZaOperation.DEPLOY_ZIMLET=++ZA_OP_INDEX;
ZaOperation.CLOSE_TAB=++ZA_OP_INDEX;
ZaOperation.CLOSE_OTHER_TAB=++ZA_OP_INDEX;
ZaOperation.CLOSE_ALL_TAB=++ZA_OP_INDEX;
ZaOperation.TOGGLE=++ZA_OP_INDEX;
ZaOperation.DOWNLOAD_SERVER_CONFIG=++ZA_OP_INDEX;
ZaOperation.DOWNLOAD_GLOBAL_CONFIG=++ZA_OP_INDEX;
ZaOperation.VIEW_DOMAIN_ACCOUNTS=++ZA_OP_INDEX;
ZaOperation.FLUSH_CACHE=++ZA_OP_INDEX;
ZaOperation.MORE_ACTIONS=++ZA_OP_INDEX;
ZaOperation.EXPIRE_SESSION=++ZA_OP_INDEX;
ZaOperation.ADD_DOMAIN_ALIAS=++ZA_OP_INDEX;
ZaOperation.INSTALL_DOMAIN_CERT=++ZA_OP_INDEX;
ZaOperation.LOGOFF=++ZA_OP_INDEX;
ZaOperation.LEFT_BRACKET=++ZA_OP_INDEX;
ZaOperation.RIGHT_BRACKET=++ZA_OP_INDEX;
var ZaOpList=["UNKNOWN","NONE","SEP","NEW","DELETE","REFRESH","EDIT","CHNG_PWD","CLOSE","SAVE","NEW_ACCT","NEW_ALIAS","NEW_DL","NEW_RESOURCE","NEW_ADMIN","PAGE_FORWARD","PAGE_BACK","DUPLICATE","GAL_WIZARD","AUTH_WIZARD","AUTOPROV_WIZARD","VIEW_MAIL","MOVE_ALIAS","NEW_MENU","HELP","REINDEX_MAILBOX","LABEL","VIEW","SEARCH_ACCOUNTS","SEARCH_ALIASES","SEARCH_DLS","SEARCH_DOMAINS","SEARCH_RESOURCES","SEARCH_COSES","SEARCH_ALL","FLUSH","HOLD","REQUEUE","RELEASE","INIT_NOTEBOOK","CHECK_MX_RECORD","SEARCH_RESULT_COUNT","SEARCH_BY_ADDESS_TYPE","SEARCH_BY_DOMAIN","SEARCH_BY_SERVER","SEARCH_BY_BASIC","SEARCH_BY_REMOVE_ALL","SEARCH_BY_ADVANCED","SEARCH_BY_COS","DEPLOY_ZIMLET","CLOSE_TAB","CLOSE_OTHER_TAB","CLOSE_ALL_TAB","TOGGLE","DOWNLOAD_SERVER_CONFIG","DOWNLOAD_GLOBAL_CONFIG","VIEW_DOMAIN_ACCOUNTS","FLUSH_CACHE","MORE_ACTIONS","EXPIRE_SESSION","ADD_DOMAIN_ALIAS","INSTALL_DOMAIN_CERT","LOGOFF","LEFT_BRACKET","RIGHT_BRACKET"];
ZaOperation.getStringName=function(e){
if(e<0||e>=ZaOpList.length){
return"UNKNOWN_"+e
}
return ZaOpList[e]
}
}
if(AjxPackage.define("zimbraAdmin.home.controller.ZaHomeController")){
ZaHomeController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaHomeController");
this._UICreated=false;
this.objType=ZaEvent.S_HOME;
this.tabConstructor=ZaHomeXFormView
};
ZaHomeController.prototype=new ZaXFormViewController();
ZaHomeController.prototype.constructor=ZaHomeController;
ZaHomeController.prototype.toString=function(){
return"ZaHomeController"
};
ZaApp.prototype.getHomeViewController=function(e){
if(!e){
e=ZaZimbraAdmin._HOME_VIEW
}
if(e&&this._controllers[e]!=null){
return this._controllers[e]
}else{
var t=this._controllers[e]=new ZaHomeController(this._appCtxt,this._container,this);
return t
}};
ZaHomeController.prototype.show=function(e){
if(!this._UICreated){
this._contentView=this._view=new this.tabConstructor(this._container,e);
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
ZaApp.getInstance()._controllers[this.getContentViewId()]=this;
this._UICreated=true
}
e=new ZaHome();
e.load("","",true);
e[ZaModel.currentTab]="1";
e[ZaModel.currentStep]=1;
this._currentObject=e;
this._view.setObject(e);
ZaApp.getInstance().pushView(this.getContentViewId());
e.schedulePostLoading()
};
ZaHomeController.prototype.setInstanceValue=function(t,e){
var o=this._view._localXForm;
o.setInstanceValue(t,e)
};
ZaHomeController.prototype.showWarningPanel=function(){
var e=this._view._localXForm;
if(e.getInstanceValue(ZaHome.A2_showWarningPanel)!=true){
e.setInstanceValue(true,ZaHome.A2_showWarningPanel)
}};
ZaHomeController.prototype.getAppBarAction=function(){
if(AjxUtil.isEmpty(this._appbarOperation)){
this._appbarOperation[ZaOperation.HELP]=new ZaOperation(ZaOperation.HELP,ZaMsg.TBB_Help,ZaMsg.TBB_Help_tt,"Help","Help",new AjxListener(this,this._helpButtonListener))
}
return this._appbarOperation
};
ZaHomeController.prototype.getAppBarOrder=function(){
if(AjxUtil.isEmpty(this._appbarOrder)){
this._appbarOrder.push(ZaOperation.HELP)
}
return this._appbarOrder
}
}
if(AjxPackage.define("zimbraAdmin.accounts.controller.ZaAccountListController")){
ZaAccountListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaAccountListController");
this._popupOperations=new Object();
this._currentPageNum=1;
this._currentQuery=null;
this._currentSortField=ZaAccount.A_uid;
this._currentSortOrder="1";
this.searchTypes=[ZaSearch.ALIASES,ZaSearch.DLS,ZaSearch.ACCOUNTS,ZaSearch.RESOURCES];
this.pages=new Object();
this._searchPanel=null;
this._searchField=null;
this._defaultType=ZaItem.ACCOUNT;
this._helpURL=ZaAccountListController.helpURL;
this._helpButtonText=ZaMsg.helpManageAccounts;
this.objType=ZaEvent.S_ACCOUNT;
this.fetchAttrs=ZaSearch.standardAttributes
};
ZaAccountListController.prototype=new ZaListViewController();
ZaAccountListController.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/provisioning_accounts.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaController.initPopupMenuMethods.ZaAccountListController=new Array();
ZaController.changeActionsStateMethods.ZaAccountListController=new Array();
ZaAccountListController.prototype.show=function(o,e){
if(o&&!e){
var t=this._contentView&&this._contentView.getList();
if(t){
return this._show(t,false,false,this._contentView.scrollHasMore)
}}
var s=Dwt.getNextId();
var r=new AjxCallback(this,this.searchCallback,{
limit:this.RESULTSPERPAGE,CONS:null,show:o,busyId:s}
);
this._currentQuery="(&"+this._currentQuery+"(!("+ZaAccount.A_zimbraIsSystemAccount+"=TRUE)))";
var n={
query:this._currentQuery,types:this.searchTypes,sortBy:this._currentSortField,offset:this.RESULTSPERPAGE*(this._currentPageNum-1),sortAscending:this._currentSortOrder,limit:this.RESULTSPERPAGE,maxResults:0,attrs:[this.fetchAttrs,ZaAccount.A_zimbraIsDelegatedAdminAccount,ZaAccount.A_zimbraIsAdminAccount,ZaAccount.A_zimbraIsSystemResource,ZaAccount.A_zimbraIsSystemAccount,ZaAccount.A_zimbraIsExternalVirtualAccount].join(),callback:r,controller:this,showBusy:true,busyId:s,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false};
this.scrollSearchParams={
query:this._currentQuery,types:this.searchTypes,sortBy:this._currentSortField,sortAscending:this._currentSortOrder,attrs:[this.fetchAttrs,ZaAccount.A_zimbraIsDelegatedAdminAccount,ZaAccount.A_zimbraIsAdminAccount,ZaAccount.A_zimbraIsSystemResource,ZaAccount.A_zimbraIsSystemAccount,ZaAccount.A_zimbraIsExternalVirtualAccount].join(),controller:this,showBusy:true,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false};
ZaSearch.searchDirectory(n)
};
ZaAccountListController.prototype._show=function(t,e,n,o){
this._updateUI(t,e,n,o);
this.updatePopupMenu();
ZaApp.getInstance().pushView(this.getContentViewId(),e,n);
return
};
ZaAccountListController.prototype.setDefaultType=function(e){
this._defaultType=e;
if(e==ZaItem.ACCOUNT){
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/provisioning_accounts.htm?locid="+AjxEnv.DEFAULT_LOCALE
}else{
if(e==ZaItem.ALIAS){
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/creating_a_mail_aliases.htm?locid="+AjxEnv.DEFAULT_LOCALE
}else{
if(e==ZaItem.DL){
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/distribution_lists.htm?locid="+AjxEnv.DEFAULT_LOCALE
}else{
if(e==ZaItem.RESOURCE){
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/managing_resource.htm?locid="+AjxEnv.DEFAULT_LOCALE
}}}}};
ZaAccountListController.prototype.updatePopupMenu=function(){
var e=this._defaultType;
if(e==ZaItem.ACCOUNT&&this.showNewAccount){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ACTBB_New_tt,"NewAccount","AccountDis",new AjxListener(this,ZaAccountListController.prototype._newAccountListener))
}else{
if(e==ZaItem.ALIAS&&this.showNewAlias){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ALTBB_New_tt,"AccountAlias","AccountDis",new AjxListener(this,ZaAccountListController.prototype._newAliasListener))
}else{
if(e==ZaItem.DL&&this.showNewDL){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ALTBB_New_tt,"DistributionList","DistributionListDis",new AjxListener(this,ZaAccountListController.prototype._newDistributionListListener))
}else{
if(e==ZaItem.RESOURCE&&this.showNewCalRes){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ALTBB_New_tt,"Resource","ResourceDis",new AjxListener(this,ZaAccountListController.prototype._newResourceListener))
}}}}};
ZaAccountListController.prototype.handleRemoval=function(e){
ZaZimbraAdmin.getInstance().getOverviewPanelController().refreshAccountTree();
ZaListViewController.prototype.handleRemoval.call(this,e)
};
ZaAccountListController.prototype.handleCreation=function(e){
ZaZimbraAdmin.getInstance().getOverviewPanelController().refreshAccountTree();
ZaListViewController.prototype.handleCreation.call(this,e)
};
ZaAccountListController.prototype.set=function(e){
this.show(e)
};
ZaAccountListController.prototype.setPageNum=function(e){
this._currentPageNum=Number(e)
};
ZaAccountListController.prototype.getPageNum=function(){
return this._currentPageNum
};
ZaAccountListController.prototype.getTotalPages=function(){
return this.numPages
};
ZaAccountListController.prototype.setFetchAttrs=function(e){
this.fetchAttrs=e
};
ZaAccountListController.prototype.getFetchAttrs=function(){
return this.fetchAttrs
};
ZaAccountListController.prototype.setQuery=function(e){
this._currentQuery=e
};
ZaAccountListController.prototype.getQuery=function(){
return this._currentQuery
};
ZaAccountListController.prototype.setSearchTypes=function(e){
this.searchTypes=e
};
ZaAccountListController.prototype.getSearchTypes=function(){
return this.searchTypes
};
ZaAccountListController.prototype.setSortOrder=function(e){
if(e===true){
this._currentSortOrder="1"
}else{
if(e===false){
this._currentSortOrder="0"
}else{
this._currentSortOrder=e
}}};
ZaAccountListController.prototype.getSortOrder=function(){
return this._currentSortOrder
};
ZaAccountListController.prototype.setSortField=function(e){
this._currentSortField=e
};
ZaAccountListController.prototype.getSortField=function(){
return this._currentSortField
};
ZaAccountListController.initPopupMenuMethod=function(){
this.showNewAccount=false;
this.showNewDL=false;
this.showNewCalRes=false;
this.showNewAlias=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
this.showNewAccount=true;
this.showNewDL=true;
this.showNewCalRes=true;
this.showNewAlias=true
}else{
this.showNewAccount=ZaZimbraAdmin.canCreateAccount();
this.showNewCalRes=ZaZimbraAdmin.canCreateCalRes;
this.showNewDL=ZaZimbraAdmin.canCreateDL();
this.showNewAlias=ZaZimbraAdmin.canCreateAlias()
}
if(this.showNewAccount&&this._defaultType==ZaItem.ACCOUNT){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ACTBB_New_tt,"NewAccount","AccountDis",new AjxListener(this,ZaAccountListController.prototype._newAccountListener))
}else{
if(this.showNewCalRes&&this._defaultType==ZaItem.RESOURCE){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ALTBB_New_tt,"Resource","ResourceDis",new AjxListener(this,ZaAccountListController.prototype._newResourceListener))
}else{
if(this.showNewDL&&this._defaultType==ZaItem.DL){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ALTBB_New_tt,"DistributionList","DistributionListDis",new AjxListener(this,ZaAccountListController.prototype._newDistributionListListener))
}else{
if(this.showNewAlias&&this._defaultType==ZaItem.ALIAS){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW_MENU,ZaMsg.TBB_New,ZaMsg.ALTBB_New_tt,"AccountAlias","AccountDis",new AjxListener(this,ZaAccountListController.prototype._newAliasListener))
}}}}
if(this.showNewAccount||this.showNewCalRes||this.showNewDL||this.showNewAlias){
this._popupOrder.push(ZaOperation.NEW_MENU)
}
this._popupOperations[ZaOperation.EDIT]=new ZaOperation(ZaOperation.EDIT,ZaMsg.TBB_Edit,ZaMsg.ACTBB_Edit_tt,"Edit","EditDis",new AjxListener(this,ZaAccountListController.prototype._editButtonListener));
this._popupOrder.push(ZaOperation.EDIT);
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.ACTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,ZaAccountListController.prototype._deleteButtonListener));
this._popupOrder.push(ZaOperation.DELETE);
if(this._defaultType==ZaItem.ACCOUNT){
this._popupOperations[ZaOperation.CHNG_PWD]=new ZaOperation(ZaOperation.CHNG_PWD,ZaMsg.ACTBB_ChngPwd,ZaMsg.ACTBB_ChngPwd_tt,"Padlock","PadlockDis",new AjxListener(this,ZaAccountListController.prototype._chngPwdListener));
this._popupOperations[ZaOperation.EXPIRE_SESSION]=new ZaOperation(ZaOperation.EXPIRE_SESSION,ZaMsg.ACTBB_ExpireSessions,ZaMsg.ACTBB_ExpireSessions_tt,"ExpireSession","ExpireSessionDis",new AjxListener(this,ZaAccountListController.prototype._expireSessionListener));
this._popupOrder.push(ZaOperation.CHNG_PWD);
this._popupOrder.push(ZaOperation.EXPIRE_SESSION)
}
if(this._defaultType==ZaItem.ALIAS){
this._popupOperations[ZaOperation.MOVE_ALIAS]=new ZaOperation(ZaOperation.MOVE_ALIAS,ZaMsg.ACTBB_MoveAlias,ZaMsg.ACTBB_MoveAlias_tt,"MoveAlias","MoveAlias",new AjxListener(this,ZaAccountListController.prototype._moveAliasListener));
this._popupOperations[ZaOperation.EXPIRE_SESSION]=new ZaOperation(ZaOperation.EXPIRE_SESSION,ZaMsg.ACTBB_ExpireSessions,ZaMsg.ACTBB_ExpireSessions_tt,"ExpireSession","ExpireSessionDis",new AjxListener(this,ZaAccountListController.prototype._expireSessionListener));
this._popupOrder.push(ZaOperation.MOVE_ALIAS);
this._popupOrder.push(ZaOperation.EXPIRE_SESSION)
}};
ZaController.initPopupMenuMethods.ZaAccountListController.push(ZaAccountListController.initPopupMenuMethod);
ZaAccountListController.prototype._createUI=function(e,o){
this._contentView=new ZaAccountListView(this._container,this._defaultType);
ZaApp.getInstance()._controllers[this.getContentViewId()]=this;
this._newDLListener=new AjxListener(this,ZaAccountListController.prototype._newDistributionListListener);
this._newAcctListener=new AjxListener(this,ZaAccountListController.prototype._newAccountListener);
this._newResListener=new AjxListener(this,ZaAccountListController.prototype._newResourceListener);
this._newALListener=new AjxListener(this,ZaAccountListController.prototype._newAliasListener);
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_ACCTLIST,ZaId.MENU_POP);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
if(!ZaApp.getInstance().dialogs.ConfirmMessageDialog){
ZaApp.getInstance().dialogs.ConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_ACCTLIST+"_ConfirmMessage")
}
this._UICreated=true
};
ZaAccountListController.prototype.closeButtonListener=function(o,e,t,n,s){
if(e){
t.call(n,s)
}else{
ZaApp.getInstance().popView()
}};
ZaAccountListController.prototype._newAccountListener=function(o){
try{
EmailAddr_XFormItem.resetDomainLists.call(this);
var e=new ZaAccount();
e.loadNewObjectDefaults("name",ZaSettings.myDomainName);
e.rights[ZaAccount.GET_ACCOUNT_MEMBERSHIP_RIGHT]=true;
if(!ZaApp.getInstance().dialogs.newAccountWizard){
ZaApp.getInstance().dialogs.newAccountWizard=new ZaNewAccountXWizard(this._container,e)
}else{
ZaApp.getInstance().dialogs.newAccountWizard.updateAccountType()
}
ZaApp.getInstance().dialogs.newAccountWizard.setObject(e);
ZaApp.getInstance().dialogs.newAccountWizard.popup()
}
catch(t){
this._handleException(t,"ZaAccountListController.prototype._newAccountListener",null,false)
}};
ZaAccountListController.prototype._newAliasListener=function(o){
try{
EmailAddr_XFormItem.resetDomainLists.call(this);
var t=new ZaAlias();
t.getAttrs={
all:true};
t.setAttrs={
all:true};
t._defaultValues={
attrs:{}};
t.rights={};
if(!ZaApp.getInstance().dialogs.newAliasDialog){
ZaApp.getInstance().dialogs.newAliasDialog=new ZaNewAliasXDialog(this._container,"550px","100px",ZaMsg.New_Alias_Title);
ZaApp.getInstance().dialogs.newAliasDialog.registerCallback(DwtDialog.OK_BUTTON,ZaAlias.prototype.addAlias,t,ZaApp.getInstance().dialogs.newAliasDialog._localXForm)
}
ZaApp.getInstance().dialogs.newAliasDialog.setObject(t);
ZaApp.getInstance().dialogs.newAliasDialog.popup()
}
catch(e){
this._handleException(e,"ZaAccountListController.prototype._newAliasListener",null,false)
}};
ZaAccountListController.prototype._newDistributionListListener=function(o){
try{
EmailAddr_XFormItem.resetDomainLists.call(this);
var t=new ZaDistributionList();
t.rights={};
t._defaultValues={
attrs:{}};
t.loadNewObjectDefaults("name",ZaSettings.myDomainName);
t.rights[ZaDistributionList.RENAME_DL_RIGHT]=true;
t.rights[ZaDistributionList.REMOVE_DL_MEMBER_RIGHT]=true;
t.rights[ZaDistributionList.ADD_DL_MEMBER_RIGHT]=true;
t.rights[ZaDistributionList.GET_DL_MEMBERSHIP_RIGHT]=true;
if(!ZaApp.getInstance().dialogs.newDLWizard){
ZaApp.getInstance().dialogs.newDLWizard=new ZaNewDLXWizard(this._container,t)
}
ZaApp.getInstance().dialogs.newDLWizard.setObject(t);
ZaApp.getInstance().dialogs.newDLWizard.popup()
}
catch(e){
this._handleException(e,"ZaAccountListController.prototype._newDistributionListListener",null,false)
}};
ZaAccountListController.prototype._newResourceListener=function(o){
try{
EmailAddr_XFormItem.resetDomainLists.call(this);
var e=new ZaResource();
e.loadNewObjectDefaults("name",ZaSettings.myDomainName);
if(!ZaApp.getInstance().dialogs.newResourceWizard){
ZaApp.getInstance().dialogs.newResourceWizard=new ZaNewResourceXWizard(this._container)
}
ZaApp.getInstance().dialogs.newResourceWizard.setObject(e);
ZaApp.getInstance().dialogs.newResourceWizard.popup()
}
catch(t){
this._handleException(t,"ZaAccountListController.prototype._newResourceListener",null,false)
}};
ZaAccountListController.prototype._listSelectionListener=function(t){
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
if(t.item){
this._editItem(t.item)
}}else{
if(this.changeAcStateAcId){
AjxTimedAction.cancelAction(this.changeAcStateAcId);
this.changeAcStateAcId=null
}
var e=new AjxTimedAction(this,ZaController.prototype.changeActionsState,[t]);
this.changeAcStateAcId=AjxTimedAction.scheduleAction(e,ZaController.CLICK_DELAY)
}};
ZaAccountListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaAccountListController.prototype._editButtonListener=function(t){
EmailAddr_XFormItem.resetDomainLists.call(this);
if(this._contentView.getSelectionCount()==1){
var e=this._contentView.getSelection()[0];
this._editItem(e)
}};
ZaAccountListController.prototype._editItem=function(n){
if(this.changeAcStateAcId){
AjxTimedAction.cancelAction(this.changeAcStateAcId);
this.changeAcStateAcId=null
}
var s=n.id;
if((n.type==ZaItem.ALIAS)&&n.attrs&&n.attrs[ZaAlias.A_AliasTargetId]){
s=n.attrs[ZaAlias.A_AliasTargetId]
}
var o=n.type;
var r=ZaAccountXFormView;
if(o==ZaItem.ACCOUNT){
r=ZaAccountXFormView
}else{
if(o==ZaItem.DL){
r=ZaDLXFormView
}else{
if(o==ZaItem.RESOURCE){
r=ZaResourceXFormView
}else{
if(o==ZaItem.ALIAS){
if(n.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_ACCOUNT){
r=ZaAccountXFormView
}else{
if(n.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_DL){
r=ZaDLXFormView
}else{
if(n.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_RESOURCE){
r=ZaResourceXFormView
}}}}}}}
try{
if(!this.selectExistingTabByItemId(s,r)){
if(o==ZaItem.ACCOUNT){
ZaApp.getInstance().getAccountViewController().show(n,true)
}else{
if(o==ZaItem.DL){
ZaApp.getInstance().getDistributionListController().show(n,true)
}else{
if(o==ZaItem.ALIAS){
var t=n.getAliasTargetObj();
if(n.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_ACCOUNT){
ZaApp.getInstance().getAccountViewController().show(t,true)
}else{
if(n.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_DL){
ZaApp.getInstance().getDistributionListController().show(t,true)
}else{
if(n.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_RESOURCE){
ZaApp.getInstance().getResourceController(s).show(t,true)
}}}}else{
if(o==ZaItem.RESOURCE){
ZaApp.getInstance().getResourceController(s).show(n,true)
}}}}
ZaZimbraAdmin.getInstance().getOverviewPanelController().addAccountItem(n)
}}
catch(e){
if(e.msg){
ZaApp.getInstance().dialogs.errorMsgDlg=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.OK_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_ACCTLIST+"_errorMsg");
ZaApp.getInstance().dialogs.errorMsgDlg.setMessage(e.msg,null,DwtMessageDialog.TITLE[DwtMessageDialog.WARNING_STYLE]);
ZaApp.getInstance().dialogs.errorMsgDlg.popup()
}}};
ZaAccountListController.prototype._chngPwdListener=function(s){
try{
if(this._contentView.getSelectionCount()==1){
this._chngPwdDlg=new ZaAccChangePwdXDlg(ZaApp.getInstance().getAppCtxt().getShell(),"400px","90px");
var n=this._contentView.getSelection()[0];
n.loadEffectiveRights("id",n.id,false);
this._chngPwdDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountListController._changePwdOKCallback,this,n);
if(n.name!=undefined&&n.name.length>80){
this._chngPwdDlg.setTitle(ZaMsg.CHNP_Title+" ("+n.name.substring(1,80)+"...)")
}else{
if(n.name!=undefined){
this._chngPwdDlg.setTitle(ZaMsg.CHNP_Title+" ("+n.name+")")
}else{
this._chngPwdDlg.setTitle(ZaMsg.CHNP_Title)
}}
var h=new Object();
h[ZaAccount.A2_confirmPassword]="";
h.attrs={};
h.attrs[ZaAccount.A_password]="";
h.attrs[ZaAccount.A_zimbraPasswordMustChange]=false;
h.getAttrs=n.getAttrs;
h.setAttrs=n.setAttrs;
this._chngPwdDlg.setObject(h);
this._chngPwdDlg.popup()
}}
catch(t){
if(t.code&&(t.code==ZmCsfeException.SVC_AUTH_EXPIRED||t.code==ZmCsfeException.SVC_AUTH_REQUIRED||t.code==ZmCsfeException.NO_AUTH_TOKEN||t.code==ZmCsfeException.AUTH_TOKEN_CHANGED)){
try{
var e=false;
if(ZaApp.getInstance()!=null&&(t.code==ZmCsfeException.SVC_AUTH_EXPIRED||t.code==ZmCsfeException.AUTH_TOKEN_CHANGED)){
ZmCsfeCommand.noAuth=true;
var r=ZaApp.getInstance().dialogs;
if(r!=undefined){
for(var l in r){
r[l].popdown()
}}
this._loginDialog.registerCallback(this.loginCallback,this);
this._loginDialog.setError(ZaMsg.ERROR_SESSION_EXPIRED);
this._loginDialog.clearPassword()
}else{
this._loginDialog.setError(null);
e=false
}
this._loginDialog.setReloginMode(e);
this._showLoginDialog(e)
}
catch(o){
if(window.console&&window.console.log){
console.log(o.code)
}}}else{
this._handleException(t,"ZaAccountListController._chngPwdListenerLauncher",null,false)
}}};
ZaAccountListController.prototype._expireSessionListener=function(o){
try{
if(this._contentView.getSelectionCount()==1){
var t=this._contentView.getSelection()[0];
if((t.type==ZaItem.ALIAS)&&(t.attrs[ZaAlias.A_targetType]==ZaItem.ACCOUNT)){
if(!t.targetObj){
t.targetObj=t.getAliasTargetObj()
}
t=t.targetObj
}
t.loadEffectiveRights("id",t.id,false);
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraAuthTokenValidityValue,t)){
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.WARN_EXPIRE_SESSIONS,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaAccountListController.prototype.expireSessions,this,[t]);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.closeCnfrmDlg,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.popupMsgDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_PERMISSION_FOR_OPERATION_ON,[t.name?t.name:t.attrs[ZaAccount.A_accountName]]),true)
}}}
catch(e){
this._handleException(e,"ZaAccountListController._expireSessionListener",null,false)
}};
ZaAccountListController.prototype.expireSessions=function(o){
try{
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown();
mods={};
mods[ZaAccount.A_zimbraAuthTokenValidityValue]=(!o.attrs[ZaAccount.A_zimbraAuthTokenValidityValue]?1:((parseInt(o.attrs[ZaAccount.A_zimbraAuthTokenValidityValue])+1)%9));
o.modify(mods,o);
if(ZaZimbraAdmin.currentAdminAccount.id==o.id){
var e={
msg:ZaMsg.EX_EXPIRE_OWN_SESSIONS,code:ZmCsfeException.SVC_AUTH_EXPIRED,method:null,detail:"",data:"",trace:""};
throw new ZmCsfeException(e)
}
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.SessionInvalid,[o.name]))
}
catch(t){
this._handleException(t,"ZaAccountListController.expireSessions",null,false)
}};
ZaAccountListController._viewMailListenerLauncher=function(u){
try{
var h;
var c;
if(u.type==ZaItem.ACCOUNT||u.type==ZaItem.RESOURCE){
h=ZaAccount.getViewMailLink(u.id);
c=u.id
}else{
if(u.type==ZaItem.ALIAS&&u.attrs[ZaAlias.A_AliasTargetId]){
h=ZaAccount.getViewMailLink(u.attrs[ZaAlias.A_AliasTargetId]);
c=u.attrs[ZaAlias.A_AliasTargetId];
u=new ZaAccount()
}else{
return
}}
if(!u[ZaAccount.A2_publicMailURL]){
u.load("id",c)
}
if(!u[ZaAccount.A2_publicMailURL]){
u[ZaAccount.A2_publicMailURL]=["http://",ZaAccount.getDomain(u[ZaAccount.A_name]),":7070"].join("")
}
var n=u[ZaAccount.A2_publicMailURL];
if(Ip_XModelItem.EXACT_IP_ADDRESS_RE.test(location.hostname)&&n){
try{
var g=n.indexOf("//");
if(g!=-1){
g=g+2
}else{
g=0
}
var l=n.indexOf(":",g);
if(l==-1){
l=n.indexOf("/",g)
}
var e;
if(l!=-1){
e=n.substring(g,l)
}else{
e=n.substring(g)
}
var p=ZaServer.getAll().getArray();
var o="";
if(p.length>1){
var y=false;
for(var r=0;
r<p.length;
r++){
if(!p[r].attrs[ZaServer.A_zimbraMailboxServiceEnabled]){
continue
}
if(p[r].attrs[ZaServer.A_ServiceHostname]==e){
y=true
}
if(!y&&p[r].attrs[ZaServer.A_Pop3BindAddress]){
for(var s=0;
s<p[r].attrs[ZaServer.A_Pop3BindAddress].length;
s++){
if(p[r].attrs[ZaServer.A_Pop3BindAddress][s]==e){
y=true;
break
}}}
if(y){
p[r].load();
if(p[r].nifs){
for(var s=0;
s<p[r].nifs.length;
s++){
if(p[r].nifs[s].attrs.addr&&(p[r].nifs[s].attrs.addr!="127.0.0.1")){
o=p[r].nifs[s].attrs.addr
}
break
}}
break
}}}else{
o=location.hostname
}
if(e&&o){
n=n.replace(e,o)
}}
catch(t){}}
if(!h.authToken||!h.lifetime){
throw new AjxException(ZaMsg.ERROR_FAILED_TO_GET_CREDENTIALS,AjxException.UNKNOWN,"ZaAccountListController.prototype._viewMailListener")
}
var f=[n,"/service/preauth?authtoken=",h.authToken,"&isredirect=1&adminPreAuth=1"].join("");
f=AjxStringUtil.trim(f,true);
var d=window.open(f,"_blank")
}
catch(m){
this._handleException(m,"ZaAccountListController._viewMailListenerLauncher",null,false)
}};
ZaAccountListController.prototype._deleteButtonListener=function(r){
this._removeList=new Array();
this._itemsInTabList=[];
this._haveAliases=false;
this._haveAccounts=false;
this._haveDls=false;
this._haveDomains=false;
this._haveCoses=false;
if(this._contentView.getSelectionCount()>0){
var s=this._contentView.getSelection();
var o=s.length;
for(var t=0;
t<o;
t++){
var n=s[t];
if(n){
if(ZaApp.getInstance().getTabGroup()&&ZaApp.getInstance().getTabGroup().getTabByItemId(n.id)){
this._itemsInTabList.push(n)
}else{
this._removeList.push(n);
if(!this._haveAliases&&n.type==ZaItem.ALIAS){
this._haveAliases=true
}else{
if(!this._haveAccounts&&n.type==ZaItem.ACCOUNT){
this._haveAccounts=true
}else{
if(!this._haveDls&&n.type==ZaItem.DL){
this._haveDls=true
}else{
if(!this._haveDomains&&n.type==ZaItem.DOMAIN){
this._haveDomains=true
}else{
if(!this._haveCoses&&n.type==ZaItem.COS){
this._haveCoses=true
}}}}}}}}
if(this._haveDomains&&!(this._haveAliases||this._haveAccounts||this._haveDls||this._haveCoses)){
var e=ZaApp.getInstance().getDomainListController();
e._deleteButtonListener(r);
return
}}
if(this._itemsInTabList.length>0){
if(!ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog){
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.CANCEL_BUTTON],[ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON_DESC,ZaMsgDialog.NO_DELETE_BUTTON_DESC],ZaId.CTR_PREFIX+ZaId.VIEW_ACCTLIST+"_ConfirmDeleteItemsInTab")
}
var h=ZaMsg.dl_warning_delete_accounts_in_tab;
h+=ZaAccountListController.getDlMsgFromList(this._itemsInTabList);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.setMessage(h,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.registerCallback(ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON,ZaAccountListController.prototype._closeTabsBeforeRemove,this);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.registerCallback(ZaMsgDialog.NO_DELETE_BUTTON,ZaAccountListController.prototype._deleteAccountsInRemoveList,this);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.popup()
}else{
this._deleteAccountsInRemoveList()
}};
ZaAccountListController.prototype._closeTabsBeforeRemove=function(){
this.closeTabsInRemoveList();
this._deleteAccountsInRemoveList()
};
ZaAccountListController.prototype._deleteAccountsInRemoveList=function(){
if(ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog){
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.popdown()
}
if(this._removeList.length>0){
var o;
if(this._haveDls&&!(this._haveAccounts||this._haveAliases||this._haveDomains||this._haveCoses)){
o=ZaMsg.Q_DELETE_DLS
}else{
if(this._haveAccounts&&!(this._haveDls||this._haveAliases||this._haveDomains||this._haveCoses)){
o=ZaMsg.Q_DELETE_ACCOUNTS
}else{
if(this._haveAliases&&!(this._haveDls||this._haveAccounts||this._haveDomains||this._haveCoses)){
o=ZaMsg.Q_DELETE_ALIASES
}else{
if(this._haveDomains&&!(this._haveAliases||this._haveAccounts||this._haveDls||this._haveCoses)){
o=ZaMsg.Q_DELETE_DOMAINS
}else{
if(this._haveCoses&&!(this._haveAliases||this._haveAccounts||this._haveDomains||this._haveDls)){
o=ZaMsg.Q_DELETE_COSES
}else{
o=ZaMsg.Q_DELETE_OBJECTS
}}}}}
o+=ZaAccountListController.getDlMsgFromList(this._removeList);
var t=this._removeList.length;
var n=[];
for(var e=0;
e<t;
e++){
if(this._removeList[e].attrs[ZaAccount.A_zimbraIsSystemResource]&&this._removeList[e].attrs[ZaAccount.A_zimbraIsSystemResource]=="TRUE"){
o+="<br/>";
o+=ZaMsg.WARN_DELETING_SYSTEM_RESOURCES;
break
}}
ZaApp.getInstance().dialogs.confirmMessageDialog2.setMessage(o,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.YES_BUTTON,ZaAccountListController.prototype._deleteAccountsCallback,this);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.NO_BUTTON,ZaAccountListController.prototype._donotDeleteAccountsCallback,this);
ZaApp.getInstance().dialogs.confirmMessageDialog2.popup()
}};
ZaAccountListController.getDlMsgFromList=function(t){
var s="<br><ul>";
var n=0;
for(var o in t){
if(n>19){
s+="<li>...</li>";
break
}
s+="<li>";
var r=t[o].attrs[ZaAccount.A_displayname]?AjxStringUtil.htmlEncode(t[o].attrs[ZaAccount.A_displayname]):t[o].name;
if(r.length>50){
var h=0;
var e=50;
do{
if(e>=r.length){
s+=r.slice(h)
}else{
s+=r.slice(h,e)
}
h=e;
e+=50;
s+="<br />"
}
while(h<r.length)
}else{
s+=r
}
s+="</li>";
n++
}
s+="</ul>";
return s
};
ZaAccountListController.prototype._deleteAccountsCallback=function(){
ZaApp.getInstance().dialogs.removeProgressDlg=new DeleteAcctsPgrsDlg(this._container,"500px","300px");
ZaApp.getInstance().dialogs.confirmMessageDialog2.popdown();
ZaApp.getInstance().dialogs.removeProgressDlg.popup();
ZaApp.getInstance().dialogs.removeProgressDlg.setObject(this._removeList);
ZaApp.getInstance().dialogs.removeProgressDlg.startDeletingAccounts();
if(this._haveCoses){
var e=ZaApp.getInstance()._appCtxt.getAppController().getOverviewPanelController();
e.removeCosTreeItems(this._removeList)
}};
ZaAccountListController.prototype._donotDeleteAccountsCallback=function(){
this._removeList=new Array();
ZaApp.getInstance().dialogs.confirmMessageDialog2.popdown()
};
ZaAccountListController._changePwdOKCallback=function(c){
if(this._chngPwdDlg){
try{
if(!this._chngPwdDlg.getPassword()||this._chngPwdDlg.getPassword().length<1){
ZaApp.getInstance().dialogs.errorMsgDlg=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.OK_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_ACCTLIST+"_errorMsg");
ZaApp.getInstance().dialogs.errorMsgDlg.setMessage(ZaMsg.ERROR_PASSWORD_REQUIRED,null,DwtMessageDialog.TITLE[DwtMessageDialog.CRITICAL_STYLE]);
ZaApp.getInstance().dialogs.errorMsgDlg.popup()
}else{
if(this._chngPwdDlg.getPassword()!=this._chngPwdDlg.getConfirmPassword()){
ZaApp.getInstance().dialogs.errorMsgDlg=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.OK_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_ACCTLIST+"_errorMsg");
ZaApp.getInstance().dialogs.errorMsgDlg.setMessage(ZaMsg.ERROR_PASSWORD_MISMATCH,null,DwtMessageDialog.TITLE[DwtMessageDialog.CRITICAL_STYLE]);
ZaApp.getInstance().dialogs.errorMsgDlg.popup()
}else{
var h=null;
var o=null;
var s=null;
c.refresh(true,false);
if(c.attrs[ZaAccount.A_zimbraMinPwdLength]!=null){
s=c.attrs[ZaAccount.A_zimbraMinPwdLength]
}
if(c.attrs[ZaAccount.A_zimbraMaxPwdLength]!=null){
o=c.attrs[ZaAccount.A_zimbraMaxPwdLength]
}
if(s==null){
s=c._defaultValues[ZaAccount.A_zimbraMinPwdLength]
}
if(o==null){
s=c._defaultValues[ZaAccount.A_zimbraMaxPwdLength]
}
if(o==null){
o=Number.POSITIVE_INFINITY
}
if(s==null){
s=1
}
var r=this._chngPwdDlg.getPassword();
if(r.length<s||AjxStringUtil.trim(r).length<s){
var e;
if(s>1){
e=String(ZaMsg.NAD_passMinLengthMsg_p).replace("{0}",s)
}else{
e=String(ZaMsg.NAD_passMinLengthMsg_s).replace("{0}",s)
}
ZaApp.getInstance().dialogs.errorMsgDlg=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.OK_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_ACCTLIST+"_errorMsg");
ZaApp.getInstance().dialogs.errorMsgDlg.setMessage(ZaMsg.ERROR_PASSWORD_TOOSHORT+"<br>"+e,null,DwtMessageDialog.CRITICAL_STYLE,null);
ZaApp.getInstance().dialogs.errorMsgDlg.popup()
}else{
if(AjxStringUtil.trim(r).length>o){
ZaApp.getInstance().dialogs.errorMsgDlg=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.OK_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_ACCTLIST+"_errorMsg");
var d;
if(o>1){
d=String(ZaMsg.NAD_passMinLengthMsg_p).replace("{0}",s)
}else{
d=String(ZaMsg.NAD_passMinLengthMsg_s).replace("{0}",s)
}
ZaApp.getInstance().dialogs.errorMsgDlg.setMessage(ZaMsg.ERROR_PASSWORD_TOOLONG+"<br>"+d,null,DwtMessageDialog.CRITICAL_STYLE,null);
ZaApp.getInstance().dialogs.errorMsgDlg.popup()
}else{
c.changePassword(r);
this._chngPwdDlg.popdown();
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.PasswordModified,[c.name]))
}}}}
if(this._chngPwdDlg.getMustChangePassword()){
var l=new Object();
l[ZaAccount.A_zimbraPasswordMustChange]="TRUE";
c.modify(l)
}}
catch(n){
if(n.code==ZmCsfeException.ACCT_INVALID_PASSWORD){
var t=ZaMsg.ERROR_PASSWORD_INVALID;
if(n.detail){
t+="<br>Details:<br>";
t+=n.detail
}
ZaApp.getInstance().dialogs.errorDialog.setMessage(t,null,DwtMessageDialog.CRITICAL_STYLE,null);
ZaApp.getInstance().dialogs.errorDialog.popup()
}else{
this._handleException(n,"ZaAccountListController._changePwdOKCallback",null,false)
}
return
}}};
ZaAccountListController.prototype.getPopUpOperation=function(){
return this._popupOperations
};
ZaAccountListController.changeActionsStateMethod=function(){
var s=this._contentView.getSelectionCount();
if(s==1){
var r=this._contentView.getSelection()[0];
if(r){
if(r.type==ZaItem.ALIAS||r.type==ZaItem.DL){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}
if(((r.type==ZaItem.ALIAS)&&(r.attrs[ZaAlias.A_targetType]==ZaItem.DL))||(r.type==ZaItem.DL)){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}
if((r.type==ZaItem.ALIAS)&&(r.attrs[ZaAlias.A_targetType]==ZaItem.RESOURCE)){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}
if(r.type==ZaItem.DL){
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}
if(!ZaItem.hasRight(ZaAccount.RIGHT_DELETE_DL,r)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}
if(r.type==ZaItem.ALIAS&&r.attrs[ZaAlias.A_targetType]==ZaItem.DL){
if(!ZaItem.hasRight(ZaDistributionList.REMOVE_DL_ALIAS_RIGHT,r.getAliasTargetObj())){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}
if(r.type==ZaItem.ACCOUNT){
var t=false;
var n=ZaAccount.getDomain(r.toString());
var h=ZaAccountXFormView.isAuthfromInternal(n);
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(r.rights)){
r.loadEffectiveRights("id",r.id,false)
}}
if(!t){
if(!ZaItem.hasRight(ZaAccount.DELETE_ACCOUNT_RIGHT,r)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasAnyRight([ZaAccount.SET_PASSWORD_RIGHT,ZaAccount.CHANGE_PASSWORD_RIGHT],r)&&h){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}
if(!ZaItem.hasWritePermission(ZaAccount.A_zimbraAuthTokenValidityValue,r)){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}}else{
if(!h){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}}}else{
if((r.type==ZaItem.ALIAS)&&(r.attrs[ZaAlias.A_targetType]==ZaItem.ACCOUNT)){
if(!r.targetObj){
r.targetObj=r.getAliasTargetObj()
}
var t=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(r.targetObj.rights)){
r.targetObj.loadEffectiveRights("id",r.id,false)
}}
if(!t){
if(!ZaItem.hasRight(ZaAccount.DELETE_ACCOUNT_RIGHT,r.targetObj)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasAnyRight([ZaAccount.SET_PASSWORD_RIGHT,ZaAccount.CHANGE_PASSWORD_RIGHT],r.targetObj)){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}}}else{
if((r.type==ZaItem.ALIAS)&&(r.attrs[ZaAlias.A_targetType]==ZaItem.RESOURCE)){
if(!r.targetObj){
r.targetObj=r.getAliasTargetObj()
}
var t=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(r.targetObj.rights)){
r.targetObj.loadEffectiveRights("id",r.id,false)
}}
if(!t){
if(!t){
if(!ZaItem.hasRight(ZaResource.DELETE_CALRES_RIGHT,r.targetObj)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasRight(ZaResource.SET_CALRES_PASSWORD_RIGHT,r.targetObj)){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}}}}else{
if(r.type==ZaItem.RESOURCE){
var t=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(r.rights)){
r.loadEffectiveRights("id",r.id,false)
}}
if(!t){
if(!ZaItem.hasRight(ZaResource.DELETE_CALRES_RIGHT,r)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasRight(ZaResource.SET_CALRES_PASSWORD_RIGHT,r)){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}}}}}}}else{
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}else{
if(s>1){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}}else{
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}}}
for(var o=0;
o<s;
o++){
var e=this._contentView.getSelection()[o];
if(e&&e.type==ZaItem.ACCOUNT){
if(e.attrs[ZaAccount.A_zimbraIsSystemAccount]=="TRUE"){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}};
ZaController.changeActionsStateMethods.ZaAccountListController.push(ZaAccountListController.changeActionsStateMethod);
ZaAccountListController.prototype._moveAliasListener=function(o){
try{
var t;
var t=this._contentView.getSelection()[0];
if(!t||t.type!=ZaItem.ALIAS){
return
}
if(!ZaApp.getInstance().dialogs.moveAliasDialog){
ZaApp.getInstance().dialogs.moveAliasDialog=new MoveAliasXDialog(this._container,"400px","300px")
}
ZaApp.getInstance().dialogs.moveAliasDialog.setAlias(t);
ZaApp.getInstance().dialogs.moveAliasDialog.popup()
}
catch(e){
this._handleException(e,"ZaAccountListController.prototype._moveAliasListener",null,false)
}
return
}
}
if(AjxPackage.define("zimbraAdmin.accounts.controller.ZaAccountViewController")){
ZaAccountViewController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaAccountViewController");
this._UICreated=false;
this.objType=ZaEvent.S_ACCOUNT;
this._helpURL=[location.pathname,ZaUtil.HELP_URL,ZaAccountViewController.helpURL,"?locid=",AjxEnv.DEFAULT_LOCALE].join("");
this._helpButtonText=ZaMsg.helpEditAccounts;
this.deleteMsg=ZaMsg.Q_DELETE_ACCOUNT;
this.tabConstructor=ZaAccountXFormView
};
ZaAccountViewController.prototype=new ZaXFormViewController();
ZaAccountViewController.prototype.constructor=ZaAccountViewController;
ZaAccountViewController.helpURL="managing_accounts/editing_accounts.htm";
ZaController.changeActionsStateMethods.ZaAccountViewController=new Array();
ZaController.setViewMethods.ZaAccountViewController=new Array();
ZaController.initToolbarMethods.ZaAccountViewController=new Array();
ZaController.initPopupMenuMethods.ZaAccountViewController=new Array();
ZaXFormViewController.preSaveValidationMethods.ZaAccountViewController=new Array();
ZaAccountViewController.prototype.show=function(o,t,e){
this._setView(o,t,e)
};
ZaAccountViewController.initPopupMenuMethod=function(){
var e=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
e=true
}else{
e=ZaZimbraAdmin.canCreateAccount()
}
this._popupOperations[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.ALTBB_Save_tt,"Save","SaveDis",new AjxListener(this,this.saveButtonListener));
this._popupOperations[ZaOperation.CLOSE]=new ZaOperation(ZaOperation.CLOSE,ZaMsg.TBB_Close,ZaMsg.ALTBB_Close_tt,"Close","CloseDis",new AjxListener(this,this.closeButtonListener));
if(e){
this._popupOperations[ZaOperation.NEW_MENU]=new ZaOperation(ZaOperation.NEW,ZaMsg.TBB_New,ZaMsg.ACTBB_New_tt,"Account","AccountDis",new AjxListener(this,ZaAccountViewController.prototype._newButtonListener));
this._popupOrder.push(ZaOperation.NEW_MENU)
}
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.ACTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,this.deleteButtonListener));
this._popupOrder.push(ZaOperation.SAVE);
this._popupOrder.push(ZaOperation.CLOSE);
this._popupOrder.push(ZaOperation.DELETE);
this._popupOperations[ZaOperation.EXPIRE_SESSION]=new ZaOperation(ZaOperation.EXPIRE_SESSION,ZaMsg.ACTBB_ExpireSessions,ZaMsg.ACTBB_ExpireSessions_tt,"ExpireSession","ExpireSessionDis",new AjxListener(this,ZaAccountViewController.prototype._expireSessionListener));
this._popupOrder.push(ZaOperation.EXPIRE_SESSION);
if(ZaItem.hasRight(ZaAccount.REINDEX_MBX_RIGHT,this._currentObject)){
this._popupOperations[ZaOperation.REINDEX_MAILBOX]=new ZaOperation(ZaOperation.REINDEX_MAILBOX,ZaMsg.ACTBB_ReindexMbx,ZaMsg.ACTBB_ReindexMbx_tt,"ReindexMailboxes","ReindexMailboxes",new AjxListener(this,ZaAccountViewController.prototype._reindexMbxListener));
this._popupOrder.push(ZaOperation.REINDEX_MAILBOX)
}};
ZaController.initPopupMenuMethods.ZaAccountViewController.push(ZaAccountViewController.initPopupMenuMethod);
ZaAccountViewController.prototype.deleteButtonListener=function(e){
if(this._currentObject.id){
if(this._currentObject[ZaAccount.A2_zimbra_ds]||this._currentObject[ZaAccount.A2_ldap_ds]){
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(AjxMessageFormat.format(ZaMsg.WARN_DELETING_GAL_SYNC,[this._currentObject.name]),DwtMessageDialog.WARNING_STYLE)
}else{
if(this._currentObject.attrs[ZaAccount.A_zimbraIsSystemResource]&&this._currentObject.attrs[ZaAccount.A_zimbraIsSystemResource]=="TRUE"){
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(AjxMessageFormat.format(ZaMsg.WARN_DELETING_SYSTEM_RESOURCE,[this._currentObject.name]),DwtMessageDialog.WARNING_STYLE)
}else{
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(this.deleteMsg,DwtMessageDialog.INFO_STYLE)
}}
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.deleteAndGoAway,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.closeCnfrmDlg,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
ZaApp.getInstance().popView()
}};
ZaAccountViewController.setViewMethod=function(o){
try{
this._currentObject=o;
this._initPopupMenu();
if(!o[ZaModel.currentTab]){
o[ZaModel.currentTab]="1"
}
try{
if(!AjxUtil.isEmpty(o.id)){
var t=o.isExternal;
o.refresh(false,true);
o.isExternal=t
}
this._contentView=this._view=new this.tabConstructor(this._container,o);
var n=new Object();
n[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),n);
ZaApp.getInstance()._controllers[this.getContentViewId()]=this;
ZaApp.getInstance().pushView(this.getContentViewId())
}
catch(e){
this._handleException(e,null,null,false);
if(e.code==ZmCsfeException.SVC_PERM_DENIED){
if(this._contentView&&this.getContentViewId()){
ZaApp.getInstance().popView()
}
return
}}
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false);
this._view.setDirty(false);
o.attrs[ZaAccount.A_password]=null;
o[ZaModel.currentTab]="1";
this._view.setObject(o)
}
catch(e){
this._handleException(e,"ZaAccountViewController.prototype._setView",null,false)
}
this._cosChanged=false;
this._domainsChanged=false
};
ZaController.setViewMethods.ZaAccountViewController.push(ZaAccountViewController.setViewMethod);
ZaAccountViewController.changeActionsStateMethod=function(){
if(!this._currentObject){
return
}
var n=true;
if(!ZaItem.hasRight(ZaAccount.DELETE_ACCOUNT_RIGHT,this._currentObject)){
n=false
}
var h=this._view.getObject();
if(h.attrs!=null&&h.attrs[ZaAccount.A_mail]!=null){
var s=h.attrs[ZaAccount.A_mail];
var o=h.name;
var r=ZaAccount.getDomain(o);
var e=ZaDomain.getDomainByName(r);
if(s=="admin@"+r||s=="root@"+r||s=="postmaster@"+r||s=="domainadmin@"+r){
n=false
}
if(e.attrs[ZaDomain.A_zimbraGalAccountId]){
if(s==e.attrs[ZaDomain.A_zimbraGalAccountId]){
n=false
}}
if(ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraSpamAccount]){
if(s==ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraSpamAccount].toString()){
n=false
}}
if(ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraHamAccount]){
if(s==ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraHamAccount].toString()){
n=false
}}
if(ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraAmavisQAccount]){
if(s==ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraAmavisQAccount].toString()){
n=false
}}
if(ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraWikiAccount]){
if(s==ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraWikiAccount].toString()){
n=false
}}
if(h.attrs[ZaAccount.A_isCCAccount]){
n=false
}}
if(h.attrs&&h.attrs[ZaAccount.A_zimbraIsSystemAccount]=="TRUE"){
n=false
}
if(!n){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=n
}}
if(!ZaItem.hasRight(ZaAccount.REINDEX_MBX_RIGHT,this._currentObject)){
if(this._popupOperations[ZaOperation.REINDEX_MAILBOX]){
this._popupOperations[ZaOperation.REINDEX_MAILBOX].enabled=n
}}
if(!ZaItem.hasWritePermission(ZaAccount.A_zimbraAuthTokenValidityValue,this._currentObject)){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}
var t=(this._view&&this._view.isDirty());
if(this._popupOperations[ZaOperation.SAVE]){
this._popupOperations[ZaOperation.SAVE].enabled=t
}
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false)
};
ZaController.changeActionsStateMethods.ZaAccountViewController.push(ZaAccountViewController.changeActionsStateMethod);
ZaAccountViewController.prototype._saveChanges=function(){
if(this._view.getMyForm().hasErrors()){
var x=this._view.getMyForm().getItemsInErrorState();
var p=ZaMsg.CORRECT_ERRORS;
p+="<br><ul>";
var y=0;
for(var q in x){
if(y>19){
p+="<li>...</li>";
break
}
if(q=="size"){
continue
}
var l=x[q].getInheritedProperty("msgName");
if(!l&&x[q].getParentItem()){
l=x[q].getParentItem().getInheritedProperty("msgName")
}
if(l){
if(l.substring(l.length-1,1)==":"){
l=l.substring(0,l.length-1)
}}
if(l){
p+="<li>";
p+=l;
p+="</li>"
}
y++
}
p+="</ul>";
this.popupMsgDialog(p,true);
return false
}
var j=this._view.getObject();
if(j.attrs==null){
this._errorDialog.setMessage(ZaMsg.ERROR_UNKNOWN,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}
var h=new Object();
if(!AjxUtil.isEmpty(j.attrs[ZaAccount.A_COSId])&&!ZaItem.ID_PATTERN.test(j.attrs[ZaAccount.A_COSId])){
var t=ZaCos.getCosByName(j.attrs[ZaAccount.A_COSId]);
if(t){
j.attrs[ZaAccount.A_COSId]=t.id;
j._defaultValues=t
}else{
this.popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[j.attrs[ZaAccount.A_COSId]]));
return false
}}
if(!ZaAccount.checkValues(j)){
return false
}
if(j.attrs[ZaAccount.A_password]!=null&&j[ZaAccount.A2_confirmPassword]!=null&&j.attrs[ZaAccount.A_password].length>0){
try{
this._currentObject.changePassword(j.attrs[ZaAccount.A_password])
}
catch(w){
this.popupErrorDialog(ZaMsg.FAILED_SAVE_ACCOUNT,w);
return false
}}
if(j[ZaAccount.A2_autoCos]=="TRUE"){
j.attrs[ZaAccount.A_COSId]=""
}
for(var k in j.attrs){
if(k==ZaAccount.A_password||k==ZaAccount.A_zimbraMailAlias||k==ZaItem.A_objectClass||k==ZaAccount.A2_mbxsize||k==ZaAccount.A_mail||k==ZaItem.A_zimbraId||k==ZaAccount.A_zimbraAvailableSkin||k==ZaAccount.A_zimbraZimletAvailableZimlets||k==ZaItem.A_zimbraACE||k==ZaAccount.A_uid){
continue
}
if(!ZaItem.hasWritePermission(k,j)){
continue
}
if((this._currentObject.attrs[k]!=j.attrs[k])&&!(this._currentObject.attrs[k]==undefined&&j.attrs[k]==="")){
if(j.attrs[k] instanceof Array){
if(!this._currentObject.attrs[k]){
this._currentObject.attrs[k]=[]
}
if(!(this._currentObject.attrs[k] instanceof Array)){
this._currentObject.attrs[k]=[this._currentObject.attrs[k]]
}
if(j.attrs[k].join(",").valueOf()!=this._currentObject.attrs[k].join(",").valueOf()){
h[k]=j.attrs[k]
}}else{
h[k]=j.attrs[k]
}}}
if(ZaTabView.isTAB_ENABLED(this._currentObject,ZaAccountXFormView.SKIN_TAB_ATTRS,ZaAccountXFormView.SKIN_TAB_RIGHTS)){
if(j.attrs[ZaAccount.A_zimbraAvailableSkin]!=null){
if(!(j.attrs[ZaAccount.A_zimbraAvailableSkin] instanceof Array)){
h[ZaAccount.A_zimbraAvailableSkin]=[j.attrs[ZaAccount.A_zimbraAvailableSkin]]
}else{
var g=j.attrs[ZaAccount.A_zimbraAvailableSkin].length;
h[ZaAccount.A_zimbraAvailableSkin]=[];
for(var y=0;
y<g;
y++){
h[ZaAccount.A_zimbraAvailableSkin].push(j.attrs[ZaAccount.A_zimbraAvailableSkin][y])
}}}else{
if(this._currentObject.attrs[ZaAccount.A_zimbraAvailableSkin]!=null){
h[ZaAccount.A_zimbraAvailableSkin]=""
}}}
if(ZaTabView.isTAB_ENABLED(this._currentObject,ZaAccountXFormView.ZIMLET_TAB_ATTRS,ZaAccountXFormView.ZIMLET_TAB_RIGHTS)){
if(j.attrs[ZaAccount.A_zimbraZimletAvailableZimlets]!=null){
if(!(j.attrs[ZaAccount.A_zimbraZimletAvailableZimlets] instanceof Array)){
h[ZaAccount.A_zimbraZimletAvailableZimlets]=[j.attrs[ZaAccount.A_zimbraZimletAvailableZimlets]]
}else{
var g=j.attrs[ZaAccount.A_zimbraZimletAvailableZimlets].length;
if(g==0){
if(this._currentObject.attrs[ZaAccount.A_zimbraZimletAvailableZimlets]==null||!(this._currentObject.attrs[ZaAccount.A_zimbraZimletAvailableZimlets].length==1&&this._currentObject.attrs[ZaAccount.A_zimbraZimletAvailableZimlets][0]==ZaZimlet.NULL_ZIMLET)){
h[ZaAccount.A_zimbraZimletAvailableZimlets]=[ZaZimlet.NULL_ZIMLET]
}}else{
h[ZaAccount.A_zimbraZimletAvailableZimlets]=[];
for(var y=0;
y<g;
y++){
h[ZaAccount.A_zimbraZimletAvailableZimlets].push(j.attrs[ZaAccount.A_zimbraZimletAvailableZimlets][y])
}}}}else{
if(this._currentObject.attrs[ZaAccount.A_zimbraZimletAvailableZimlets]!=null){
h[ZaAccount.A_zimbraZimletAvailableZimlets]=""
}}}
if(this._currentObject[ZaModel.currentTab]!=j[ZaModel.currentTab]){
this._currentObject[ZaModel.currentTab]=j[ZaModel.currentTab]
}
try{
this._currentObject.modify(h,j)
}
catch(w){
if(w.code==ZmCsfeException.ACCT_EXISTS){
this.popupErrorDialog(ZaMsg.FAILED_CREATE_ACCOUNT_1,w)
}else{
if(w.code==ZmCsfeException.NO_SUCH_COS){
this.popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[j.attrs[ZaAccount.A_COSId]]),w)
}else{
this._handleException(w,"ZaAccountViewController.prototype._saveChanges",null,false)
}}
return false
}
if(j.attrs[ZaAccount.A_zimbraMailTransport]){
var d=j.attrs[ZaAccount.A_zimbraMailTransport];
if(!this.isLegalofMailTransport(d)){
return false
}}
var b=-1;
var u=-1;
if(ZaTabView.isTAB_ENABLED(this._currentObject,ZaAccountXFormView.ALIASES_TAB_ATTRS,ZaAccountXFormView.ALIASES_TAB_RIGHTS)){
if(j.attrs[ZaAccount.A_zimbraMailAlias]){
if(typeof j.attrs[ZaAccount.A_zimbraMailAlias]=="string"){
var n=j.attrs[ZaAccount.A_zimbraMailAlias];
j.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
j.attrs[ZaAccount.A_zimbraMailAlias].push(n)
}
b=j.attrs[ZaAccount.A_zimbraMailAlias].length-1
}
if(this._currentObject.attrs[ZaAccount.A_zimbraMailAlias]){
if(typeof this._currentObject.attrs[ZaAccount.A_zimbraMailAlias]=="string"){
var n=this._currentObject.attrs[ZaAccount.A_zimbraMailAlias];
this._currentObject.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
this._currentObject.attrs[ZaAccount.A_zimbraMailAlias].push(n)
}
u=this._currentObject.attrs[ZaAccount.A_zimbraMailAlias].length-1
}
for(var e=b;
e>=0;
e--){
for(var f=u;
f>=0;
f--){
if(j.attrs[ZaAccount.A_zimbraMailAlias][e]==this._currentObject.attrs[ZaAccount.A_zimbraMailAlias][f]){
j.attrs[ZaAccount.A_zimbraMailAlias].splice(e,1);
this._currentObject.attrs[ZaAccount.A_zimbraMailAlias].splice(f,1);
break
}}}
if(u!=-1){
u=this._currentObject.attrs[ZaAccount.A_zimbraMailAlias].length
}
try{
for(var r=0;
r<u;
r++){
this._currentObject.removeAlias(this._currentObject.attrs[ZaAccount.A_zimbraMailAlias][r])
}}
catch(w){
this._handleException(w,"ZaAccountViewController.prototype._saveChanges",null,false);
return false
}
if(b!=-1){
b=j.attrs[ZaAccount.A_zimbraMailAlias].length
}
var m="";
var s=0;
try{
for(var r=0;
r<b;
r++){
try{
if(j.attrs[ZaAccount.A_zimbraMailAlias][r]){
if(j.attrs[ZaAccount.A_zimbraMailAlias][r].indexOf("@")!=j.attrs[ZaAccount.A_zimbraMailAlias][r].lastIndexOf("@")){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_ALIAS_INVALID,[j.attrs[ZaAccount.A_zimbraMailAlias][r]]),null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
break
}
this._currentObject.addAlias(j.attrs[ZaAccount.A_zimbraMailAlias][r])
}}
catch(w){
if(w.code==ZmCsfeException.ACCT_EXISTS){
var o=this._findAlias(j.attrs[ZaAccount.A_zimbraMailAlias][r]);
switch(o.type){
case ZaItem.DL:if(o.name==j.attrs[ZaAccount.A_zimbraMailAlias][r]){
m+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS3,[o.name])
}else{
m+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS4,[o.name,j.attrs[ZaAccount.A_zimbraMailAlias][r]])
}
break;
case ZaItem.ACCOUNT:if(o.name==j.attrs[ZaAccount.A_zimbraMailAlias][r]){
m+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS2,[o.name])
}else{
m+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS1,[o.name,j.attrs[ZaAccount.A_zimbraMailAlias][r]])
}
break;
case ZaItem.RESOURCE:if(o.name==j.attrs[ZaAccount.A_zimbraMailAlias][r]){
m+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS5,[o.name])
}else{
m+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS6,[o.name,j.attrs[ZaAccount.A_zimbraMailAlias][r]])
}
break;
default:m+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS0,[j.attrs[ZaAccount.A_zimbraMailAlias][r]]);
break
}
s++
}else{
throw (w)
}}}
if(s==1){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.WARNING_ALIAS_EXISTS,[m]),"",DwtMessageDialog.WARNING_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup()
}else{
if(s>1){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.WARNING_ALIASES_EXIST,[m]),"",DwtMessageDialog.WARNING_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup()
}}}
catch(w){
this.popupErrorDialog(ZaMsg.FAILED_ADD_ALIASES,w);
return false
}}
var c=null;
if(this._currentObject&&j.name!=this._currentObject.name){
c=j.name
}
if(c){
try{
this._currentObject.rename(c)
}
catch(w){
if(w.code==ZmCsfeException.ACCT_EXISTS){
this.popupErrorDialog(ZaMsg.FAILED_RENAME_ACCOUNT_1,w)
}else{
this._handleException(w,"ZaAccountViewController.prototype._saveChanges",null,false)
}
return false
}}
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.AccountModified,[this._currentObject.name]));
return true
};
ZaAccountViewController.prototype.getPopUpOperation=function(){
return this._popupOperations
};
ZaAccountViewController.prototype._newButtonListener=function(o){
try{
var e=new ZaAccount();
e.loadNewObjectDefaults("name",ZaSettings.myDomainName);
if(!ZaApp.getInstance()._newAccountWizard){
ZaApp.getInstance()._newAccountWizard=new ZaNewAccountXWizard(this._container,e)
}else{
ZaApp.getInstance()._newAccountWizard.updateAccountType()
}
ZaApp.getInstance()._newAccountWizard.setObject(e);
ZaApp.getInstance()._newAccountWizard.popup()
}
catch(t){
this._handleException(t,"ZaAccountViewController.prototype._newButtonListener",null,false)
}};
ZaAccountViewController.prototype._expireSessionListener=function(o){
try{
if(this._currentObject){
var t=this._currentObject;
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraAuthTokenValidityValue,t)){
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.WARN_EXPIRE_SESSIONS,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaAccountListController.prototype.expireSessions,this,[t]);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.closeCnfrmDlg,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.popupMsgDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_PERMISSION_FOR_OPERATION_ON,[t.name?t.name:t.attrs[ZaAccount.A_accountName]]),true)
}}}
catch(e){
this._handleException(e,"ZaAccountViewController.prototype._expireSessionListener",null,false)
}};
ZaAccountViewController.prototype._reindexMbxListener=function(t){
try{
if(!ZaApp.getInstance().dialogs.reindexWizard){
ZaApp.getInstance().dialogs.reindexWizard=new ReindexMailboxXDialog(this._container)
}
var o=new ZaReindexMailbox();
o.mbxId=this._currentObject.id;
ZaApp.getInstance().dialogs.reindexWizard.setObject(o);
ZaApp.getInstance().dialogs.reindexWizard.popup()
}
catch(e){
this._handleException(e,"ZaAccountViewController.prototype._reindexMbxListener",null,false)
}};
ZaAccountViewController.prototype._viewMailListener=function(t){
try{
if(this._currentObject&&this._currentObject.id){
ZaAccountListController._viewMailListenerLauncher.call(this,this._currentObject)
}}
catch(e){
this._handleException(e,"ZaAccountViewController.prototype._viewMailListener",null,false)
}};
ZaAccountViewController.prototype._handleException=function(e,r,n,t,o){
if(e.code==ZmCsfeException.SVC_WRONG_HOST){
var s=ZaMsg.ERROR_WRONG_HOST;
if(e.detail){
s+="<br>Details:<br>";
s+=e.detail
}
this._errorDialog.setMessage(s,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup()
}else{
if(e.code==ZmCsfeException.ACCT_EXISTS){
this._errorDialog.setMessage(ZaMsg.ERROR_ACCOUNT_EXISTS,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup()
}else{
ZaController.prototype._handleException.call(this,e,r,n,t,o)
}}};
ZaAccountViewController.prototype.isLegalofMailTransport=function(o){
if(!o){
return false
}
var t=new RegExp("(lmtp|smtp|LMTP|SMTP)\\:[\\w\\.\\-]+\\:[0-9]+$");
var e=t.exec(o);
if(e!=null){
return true
}else{
this._errorDialog.setMessage(ZaMsg.ERROR_MAILTRANSPORT_INVALID,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup()
}
return false
}
}
if(AjxPackage.define("zimbraAdmin.cos.controller.ZaCosListController")){
ZaCosListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaCosListController");
this.objType=ZaEvent.S_COS;
this._defaultType=ZaItem.COS;
this._currentSortField=ZaCos.A_name;
this._currentPageNum=1;
this._currentSortOrder="1";
this._helpURL=location.pathname+ZaUtil.HELP_URL+"cos/class_of_service.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageCOS;
this._currentQuery="";
this.fetchAttrs=[ZaCos.A_name,ZaCos.A_description].join();
this.RESULTSPERPAGE=ZaDomain.RESULTSPERPAGE;
this.MAXSEARCHRESULTS=ZaDomain.MAXSEARCHRESULTS
};
ZaCosListController.prototype=new ZaListViewController();
ZaCosListController.prototype.constructor=ZaCosListController;
ZaController.initToolbarMethods.ZaCosListController=new Array();
ZaController.initPopupMenuMethods.ZaCosListController=new Array();
ZaController.changeActionsStateMethods.ZaCosListController=new Array();
ZaCosListController.prototype.show=function(n,o){
if(!ZaZimbraAdmin.hasGlobalCOSSListAccess()&&this._currentQuery==""){
var e=ZaApp.getInstance()._cosNameList;
if(!e||!(e instanceof Array)||e.length==0){
this._list=new ZaItemList(ZaCos);
this.numPages=0;
this._searchTotal=0;
if(n){
this._show(this._list)
}else{
this._updateUI(this._list)
}
return
}
for(var t=0;
t<e.length;
t++){
this._currentQuery+="("+ZaCos.A_name+"="+e[t]+")"
}
if(e.length>1){
this._currentQuery="(|"+this._currentQuery+")"
}}
var r=Dwt.getNextId();
o=o?o:false;
var h=new AjxCallback(this,this.searchCallback,{
openInNewTab:o,limit:this.RESULTSPERPAGE,CONS:null,show:n,busyId:r}
);
var s={
query:this._currentQuery,types:[ZaSearch.COSES],sortBy:this._currentSortField,offset:this.RESULTSPERPAGE*(this._currentPageNum-1),sortAscending:this._currentSortOrder,limit:this.RESULTSPERPAGE,callback:h,attrs:this.fetchAttrs,controller:this,showBusy:true,busyId:r,busyMsg:ZaMsg.BUSY_SEARCHING_COSES,skipCallbackIfCancelled:false};
this.scrollSearchParams={
query:this._currentQuery,types:[ZaSearch.COSES],sortBy:this._currentSortField,sortAscending:this._currentSortOrder,attrs:this.fetchAttrs,controller:this,showBusy:true,busyMsg:ZaMsg.BUSY_SEARCHING_COSES,skipCallbackIfCancelled:false};
ZaSearch.searchDirectory(s)
};
ZaCosListController.prototype.searchCallback=function(o,t){
ZaListViewController.prototype.searchCallback.call(this,o,t);
var e=ZaApp.getInstance();
e._cosList=this._list;
e._cosListName=undefined
};
ZaCosListController.prototype._show=function(t,e,n,o){
this._updateUI(t,e,n,o);
ZaApp.getInstance().pushView(this.getContentViewId(),e,n);
return
};
ZaCosListController.initPopupMenuMethod=function(){
if(ZaZimbraAdmin.canCreateCos()){
this._popupOperations[ZaOperation.NEW]=new ZaOperation(ZaOperation.NEW,ZaMsg.TBB_New,ZaMsg.COSTBB_New_tt,"NewCOS","NewCOSDis",new AjxListener(this,ZaCosListController.prototype._newButtonListener));
this._popupOperations[ZaOperation.DUPLICATE]=new ZaOperation(ZaOperation.DUPLICATE,ZaMsg.TBB_Duplicate,ZaMsg.COSTBB_Duplicate_tt,"DuplicateCOS","DuplicateCOSDis",new AjxListener(this,ZaCosListController.prototype._duplicateButtonListener))
}
this._popupOperations[ZaOperation.EDIT]=new ZaOperation(ZaOperation.EDIT,ZaMsg.TBB_Edit,ZaMsg.COSTBB_Edit_tt,"Properties","PropertiesDis",new AjxListener(this,ZaCosListController.prototype._editButtonListener));
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.COSTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,ZaCosListController.prototype._deleteButtonListener))
};
ZaController.initPopupMenuMethods.ZaCosListController.push(ZaCosListController.initPopupMenuMethod);
ZaCosListController.initToolbarMethod=function(){};
ZaController.initToolbarMethods.ZaCosListController.push(ZaCosListController.initToolbarMethod);
ZaCosListController.prototype._createUI=function(e,o){
this._contentView=new ZaCosListView(this._container,this._defaultType);
ZaApp.getInstance()._controllers[this.getContentViewId()]=this;
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_COSLIST,ZaId.MENU_POP);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._removeConfirmMessageDialog=ZaApp.getInstance().dialogs.removeConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_COSLIST+"_removeConfirm");
this._UICreated=true
};
ZaCosListController.prototype._refreshButtonListener=function(e){
this.refresh()
};
ZaCosListController.prototype._duplicateButtonListener=function(n){
if(this._contentView&&(this._contentView.getSelectionCount()==1)){
var e=new ZaCos();
var o=this._contentView.getSelection()[0];
if(o){
if(o.id){
o.load("id",o.id)
}
if(o.attrs){
for(var t in o.attrs){
if((t==ZaItem.A_objectClass)||(t==ZaItem.A_zimbraId)||(t==ZaCos.A_name)||(t==ZaCos.A_description)||(t==ZaCos.A_zimbraNotes)||(t==ZaItem.A_zimbraCreateTimestamp)){
continue
}
if((typeof o.attrs[t]=="object")||(o.attrs[t] instanceof Array)){
e.attrs[t]=AjxUtil.createProxy(o.attrs[t],3)
}else{
e.attrs[t]=o.attrs[t]
}}}
e.attrs[ZaCos.A_zimbraNotes]=AjxMessageFormat.format(ZaMsg.COSTBB_DuplicatingFrom_tt,[o.attrs[ZaCos.A_name]]);
if(o.getAttrs){
e.getAttrs=o.getAttrs
}
if(o.setAttrs){
e.setAttrs=o.setAttrs
}
if(o.rights){
e.rights=o.rights
}}
ZaCosListController.showMe.call(this,e)
}};
ZaCosListController.prototype._newButtonListener=function(o){
var e=new ZaCos();
var n=ZaCos.getCosByName("default");
e.loadNewObjectDefaults();
e.rights[ZaCos.RENAME_COS_RIGHT]=true;
e.rights[ZaCos.CREATE_COS_RIGHT]=true;
for(var t in n.attrs){
if((t==ZaItem.A_objectClass)||(t==ZaItem.A_zimbraId)||(t==ZaCos.A_name)||(t==ZaCos.A_description)||(t==ZaCos.A_notes)||(t==ZaItem.A_zimbraCreateTimestamp)){
continue
}
e.attrs[t]=n.attrs[t]
}
ZaCosListController.showMe.call(this,e)
};
ZaCosListController.prototype._listSelectionListener=function(t){
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
if(t.item){
ZaApp.getInstance().getCosController().show(t.item);
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.item.name,null,false,false,t.item,undefined,true)
}}else{
this.changeActionsState()
}};
ZaCosListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaCosListController.prototype._editButtonListener=function(t){
if(this._contentView.getSelectionCount()==1){
var e=this._contentView.getSelection()[0];
this._editItem(e)
}};
ZaCosListController.prototype._editItem=function(t){
ZaApp.getInstance().getCosController().show(t);
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.name,null,false,false,t)
};
ZaCosListController.prototype._deleteButtonListener=function(s){
this._removeList=new Array();
this._itemsInTabList=[];
if(this._contentView.getSelectionCount()>0){
var n=this._contentView.getSelection();
var t=n.length;
for(var e=0;
e<t;
e++){
var o=n[e];
if(o){
if(o.name){
o.name=AjxStringUtil.htmlEncode(o.name)
}
if(o.attrs&&o.attrs[ZaCos.A_name]){
o.attrs[ZaCos.A_name]=AjxStringUtil.htmlEncode(o.attrs[ZaCos.A_name])
}
if(ZaApp.getInstance().getTabGroup()&&ZaApp.getInstance().getTabGroup().getTabByItemId(o.id)){
this._itemsInTabList.push(o)
}else{
this._removeList.push(o)
}}}}
if(this._itemsInTabList.length>0){
if(!ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog){
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.CANCEL_BUTTON],[ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON_DESC,ZaMsgDialog.NO_DELETE_BUTTON_DESC],ZaId.CTR_PREFIX+ZaId.VIEW_COSLIST+"_ConfirmDeleteItemsInTab")
}
var r=ZaMsg.dl_warning_delete_accounts_in_tab;
r+=ZaCosListController.getDlMsgFromList(this._itemsInTabList);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.setMessage(r,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.registerCallback(ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON,ZaCosListController.prototype._closeTabsBeforeRemove,this);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.registerCallback(ZaMsgDialog.NO_DELETE_BUTTON,ZaCosListController.prototype._deleteCosInRemoveList,this);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.popup()
}else{
this._deleteCosInRemoveList()
}};
ZaCosListController.prototype._closeTabsBeforeRemove=function(){
this.closeTabsInRemoveList();
this._deleteCosInRemoveList()
};
ZaCosListController.prototype._deleteCosInRemoveList=function(){
if(ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog){
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.popdown()
}
if(this._removeList.length){
var e=ZaMsg.Q_DELETE_COSES;
e+=ZaCosListController.getDlMsgFromList(this._removeList);
this._removeConfirmMessageDialog.setMessage(e,DwtMessageDialog.INFO_STYLE);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaCosListController.prototype._deleteCosCallback,this);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,ZaCosListController.prototype._donotDeleteCosCallback,this);
this._removeConfirmMessageDialog.popup()
}};
ZaCosListController.getDlMsgFromList=function(t){
dlgMsg="<br><ul>";
var n=0;
for(var o in t){
if(n>19){
dlgMsg+="<li>...</li>";
break
}
dlgMsg+="<li>";
if(t[o].name.length>50){
var e=49;
var s=0;
while(e<t[o].name.length){
dlgMsg+=t[o].name.slice(s,e);
s=e+1;
if(s>=(t[o].name.length)){
break
}
e=(t[o].name.length<=(e+50))?t[o].name.length-1:(e+50);
dlgMsg+="<br>"
}}else{
dlgMsg+=t[o].name
}
dlgMsg+="</li>";
n++
}
dlgMsg+="</ul>";
return dlgMsg
};
ZaCosListController.prototype._deleteCosCallback=function(){
var o=new Array();
for(var t in this._removeList){
if(this._removeList[t]){
try{
this._removeList[t].remove();
o.push(this._removeList[t])
}
catch(e){
this._removeConfirmMessageDialog.popdown();
this._handleException(e,ZaCosListController.prototype._deleteCosCallback,null,false);
return
}}
if(this._list){
this._list.remove(this._removeList[t])
}}
this.fireRemovalEvent(o);
this._removeConfirmMessageDialog.popdown();
if(this._contentView){
this._contentView.setUI()
}
this.show()
};
ZaCosListController.prototype._donotDeleteCosCallback=function(){
this._removeList=new Array();
this._removeConfirmMessageDialog.popdown()
};
ZaCosListController.changeActionsStateMethod=function(r,s){
if(!this._contentView){
return
}
var o=this._contentView.getSelectionCount();
var h=false;
if(o>=1){
var e=this._contentView.getSelectedItems().getArray();
for(var t in e){
var n=this._contentView.getItemFromElement(e[t]);
if(n){
if(n.name=="default"){
h=true;
break
}}}}
if(o==1){
var n=this._contentView.getSelection()[0];
if(n){
if(h){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}else{
if(AjxUtil.isEmpty(n.rights)){
n.loadEffectiveRights("id",n.id,false)
}
if(!ZaItem.hasRight(ZaCos.DELETE_COS_RIGHT,n)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}}}else{
if(o>1){
if(h){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(this._popupOperations[ZaOperation.DUPLICATE]&&this._popupOperations[ZaOperation.DUPLICATE].enabled){
this._popupOperations[ZaOperation.DUPLICATE].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}}else{
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}
if(this._popupOperations[ZaOperation.DUPLICATE]&&this._popupOperations[ZaOperation.DUPLICATE].enabled){
this._popupOperations[ZaOperation.DUPLICATE].enabled=false
}}}};
ZaController.changeActionsStateMethods.ZaCosListController.push(ZaCosListController.changeActionsStateMethod);
ZaCosListController.showMe=function(e){
if(!ZaApp.getInstance().dialogs.newCosXWizard){
ZaApp.getInstance().dialogs.newCosXWizard=new ZaNewCosXWizard(this._container,e)
}
ZaApp.getInstance().dialogs.newCosXWizard.setObject(e);
ZaApp.getInstance().dialogs.newCosXWizard.popup()
}
}
if(AjxPackage.define("zimbraAdmin.cos.controller.ZaCosController")){
ZaCosController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaCosController");
this._UICreated=false;
this._helpURL=[location.pathname,ZaUtil.HELP_URL,ZaCosController.helpURL,"?locid=",AjxEnv.DEFAULT_LOCALE].join("");
this._helpButtonText=ZaMsg.helpEditCOS;
this.deleteMsg=ZaMsg.Q_DELETE_COS;
this.objType=ZaEvent.S_COS;
this.tabConstructor=ZaCosXFormView
};
ZaCosController.helpURL="cos/creating_classes_of_service.htm";
ZaCosController.prototype=new ZaXFormViewController();
ZaCosController.prototype.constructor=ZaCosController;
ZaController.initPopupMenuMethods.ZaCosController=new Array();
ZaController.setViewMethods.ZaCosController=new Array();
ZaController.changeActionsStateMethods.ZaCosController=new Array();
ZaCosController.prototype.show=function(e){
if(!this.selectExistingTabByItemId(e.id)){
this._setView(e,true)
}};
ZaCosController.changeActionsStateMethod=function(){
if(this._currentObject.name=="default"){
this._popupOperations[ZaOperation.DELETE].enabled=false
}else{
if(!ZaItem.hasRight(ZaCos.DELETE_COS_RIGHT,this._currentObject)){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
var e=(this._view&&this._view.isDirty());
if(this._popupOperations[ZaOperation.SAVE]){
this._popupOperations[ZaOperation.SAVE].enabled=e
}};
ZaController.changeActionsStateMethods.ZaCosController.push(ZaCosController.changeActionsStateMethod);
ZaCosController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.COSTBB_Save_tt,"Save","SaveDis",new AjxListener(this,this.saveButtonListener));
if(ZaZimbraAdmin.canCreateCos()){
this._popupOperations[ZaOperation.NEW]=new ZaOperation(ZaOperation.NEW,ZaMsg.TBB_New,ZaMsg.COSTBB_New_tt,"NewCOS","NewCOSDis",new AjxListener(this,ZaCosController.prototype._newButtonListener,[true]))
}
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.COSTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,this.deleteButtonListener))
};
ZaController.initPopupMenuMethods.ZaCosController.push(ZaCosController.initPopupMenuMethod);
ZaCosController.setViewMethod=function(t){
try{
t[ZaModel.currentTab]="1";
if(t.id){
t.load("id",t.id)
}
this._currentObject=t;
this._initPopupMenu();
this._contentView=this._view=new this.tabConstructor(this._container,t);
var o=new Object();
o[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),o);
ZaApp.getInstance()._controllers[this.getContentViewId()]=this;
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setDirty(false);
this._view.setObject(t)
}
catch(e){
this._handleException(e,"ZaCosController.prototype._setView",null,false)
}};
ZaController.setViewMethods.ZaCosController.push(ZaCosController.setViewMethod);
ZaCosController.prototype._saveChanges=function(){
if(this._view.getMyForm().hasErrors()){
var t=this._view.getMyForm().getItemsInErrorState();
var c=ZaMsg.CORRECT_ERRORS;
c+="<br><ul>";
var r=0;
for(var m in t){
if(r>19){
c+="<li>...</li>";
break
}
if(m=="size"){
continue
}
var u=t[m].getInheritedProperty("msgName");
if(!u&&t[m].getParentItem()){
u=t[m].getParentItem().getInheritedProperty("msgName")
}
if(u){
if(u.substring(u.length-1,1)==":"){
u=u.substring(0,u.length-1)
}}
if(u){
c+="<li>";
c+=u;
c+="</li>"
}
r++
}
c+="</ul>";
this.popupMsgDialog(c,true);
return false
}
var s=this._view.getObject();
var h=false;
if(!ZaCos.checkValues(s)){
return false
}
var p=new Object();
if(!s.id){
h=true
}
for(var d in s.attrs){
if(d==ZaItem.A_objectClass||d==ZaItem.A_zimbraId||d==ZaCos.A_zimbraAvailableSkin||d==ZaCos.A_zimbraZimletAvailableZimlets||d==ZaCos.A_zimbraMailHostPool||d==ZaItem.A_zimbraACE||d==ZaItem.A_zimbraCreateTimestamp){
continue
}
if(!ZaItem.hasWritePermission(d,s)){
continue
}
if(h||(this._currentObject.attrs[d]!=s.attrs[d])){
p[d]=s.attrs[d]
}}
if(s.attrs[ZaCos.A_zimbraMailHostPool]!=null){
var f=[];
if(!(s.attrs[ZaCos.A_zimbraMailHostPool] instanceof Array)){
f=[s.attrs[ZaCos.A_zimbraMailHostPool]]
}else{
var o=s.attrs[ZaCos.A_zimbraMailHostPool].length;
f=[];
for(var r=0;
r<o;
r++){
f.push(s.attrs[ZaCos.A_zimbraMailHostPool][r])
}}
if(!h&&this._currentObject.attrs[ZaCos.A_zimbraMailHostPool]!=null){
if(this._currentObject.attrs[ZaCos.A_zimbraMailHostPool] instanceof Array){
if(f.join(",")!=this._currentObject.attrs[ZaCos.A_zimbraMailHostPool].join(",")){
p[ZaCos.A_zimbraMailHostPool]=f
}}else{
if(f.join(",")!=[this._currentObject.attrs[ZaCos.A_zimbraMailHostPool]].join(",")){
p[ZaCos.A_zimbraMailHostPool]=f
}}}else{
p[ZaCos.A_zimbraMailHostPool]=f
}}else{
if(this._currentObject.attrs[ZaCos.A_zimbraMailHostPool]!=null){
p[ZaCos.A_zimbraMailHostPool]=""
}}
if(s.attrs[ZaCos.A_zimbraAvailableSkin]!=null){
var f=[];
if(!(s.attrs[ZaCos.A_zimbraAvailableSkin] instanceof Array)){
f=[s.attrs[ZaCos.A_zimbraAvailableSkin]]
}else{
var o=s.attrs[ZaCos.A_zimbraAvailableSkin].length;
f=[];
for(var r=0;
r<o;
r++){
f.push(s.attrs[ZaCos.A_zimbraAvailableSkin][r])
}}
if(this._currentObject.attrs[ZaCos.A_zimbraAvailableSkin]!=null){
if(this._currentObject.attrs[ZaCos.A_zimbraAvailableSkin] instanceof Array){
if(f.join(",")!=this._currentObject.attrs[ZaCos.A_zimbraAvailableSkin].join(",")){
p[ZaCos.A_zimbraAvailableSkin]=f
}}else{
if(f.join(",")!=[this._currentObject.attrs[ZaCos.A_zimbraAvailableSkin]].join(",")){
p[ZaCos.A_zimbraAvailableSkin]=f
}}}else{
p[ZaCos.A_zimbraAvailableSkin]=f
}}else{
if(this._currentObject.attrs[ZaCos.A_zimbraAvailableSkin]!=null){
p[ZaCos.A_zimbraAvailableSkin]=""
}}
if(s.attrs[ZaCos.A_zimbraZimletAvailableZimlets]!=null){
var f=[];
if(!(s.attrs[ZaCos.A_zimbraZimletAvailableZimlets] instanceof Array)){
f=[s.attrs[ZaCos.A_zimbraZimletAvailableZimlets]]
}else{
var o=s.attrs[ZaCos.A_zimbraZimletAvailableZimlets].length;
f=[];
for(var r=0;
r<o;
r++){
f.push(s.attrs[ZaAccount.A_zimbraZimletAvailableZimlets][r])
}}
if(h){
p[ZaCos.A_zimbraZimletAvailableZimlets]=f
}else{
if(this._currentObject.attrs[ZaCos.A_zimbraZimletAvailableZimlets]!=null){
if(this._currentObject.attrs[ZaCos.A_zimbraZimletAvailableZimlets] instanceof Array){
if(f.join(",")!=this._currentObject.attrs[ZaCos.A_zimbraZimletAvailableZimlets].join(",")){
p[ZaCos.A_zimbraZimletAvailableZimlets]=f
}}else{
if(f.join(",")!=[this._currentObject.attrs[ZaCos.A_zimbraZimletAvailableZimlets]].join(",")){
p[ZaCos.A_zimbraZimletAvailableZimlets]=f
}}}else{
p[ZaCos.A_zimbraZimletAvailableZimlets]=f
}}}else{
if(this._currentObject.attrs[ZaCos.A_zimbraZimletAvailableZimlets]!=null){
p[ZaCos.A_zimbraZimletAvailableZimlets]=""
}}
if(!h){
if(s.name!=this._currentObject.name){
if(this._currentObject.name=="default"||this._currentObject.name=="defaultExternal"){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.FAILED_RENAME_COS_DEFAULT,this._currentObject.name),null,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup();
return false
}
newName=s.name;
try{
this._currentObject.rename(newName)
}
catch(l){
var n="";
for(var e in l){
n=n+e+" - "+l[e]+"\n"
}
if(l.code==ZmCsfeException.COS_EXISTS){
this._errorDialog.setMessage(ZaMsg.FAILED_RENAME_COS_1,n,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup()
}else{
this._handleException(l,"ZaCosController.prototype._saveChanges",null,false)
}
return false
}}}
if(this._currentObject[ZaModel.currentTab]!=s[ZaModel.currentTab]){
this._currentObject[ZaModel.currentTab]=s[ZaModel.currentTab]
}
try{
if(h){
this._currentObject.create(s.name,p);
this.fireCreationEvent(this._currentObject);
this._toolbar.getButton(ZaOperation.DELETE).setEnabled(true);
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.CosCreated,[s.name]))
}else{
this._currentObject.modify(p);
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.CosModified,[this._currentObject.name]))
}}
catch(l){
var n="";
for(var e in l){
if(l[e] instanceof Function){
continue
}
n=n+e+" - "+l[e]+"\n"
}
if(l.code==ZmCsfeException.COS_EXISTS){
this._errorDialog.setMessage(ZaMsg.FAILED_CREATE_COS_1,n,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup()
}else{
this._handleException(l,"ZaCosController.prototype._saveChanges",null,false)
}
return false
}
return true
};
ZaCosController.prototype.newCos=function(){
var e=new ZaCos();
var o=ZaCos.getCosByName("default");
for(var t in o.attrs){
if((t==ZaItem.A_objectClass)||(t==ZaItem.A_zimbraId)||(t==ZaCos.A_name)||(t==ZaCos.A_description)||(t==ZaCos.A_notes)||(t=ZaItem.A_zimbraCreateTimestamp)){
continue
}
e.attrs[t]=o.attrs[t]
}
this._setView(e,true)
};
ZaCosController.prototype._newButtonListener=function(o,t){
if(o){
ZaCosListController.prototype._newButtonListener.call(this)
}else{
if(this._view.isDirty()){
var e=new Object();
e.params=null;
e.obj=this;
e.func=ZaCosController.prototype.newCos;
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_SAVE_CHANGES,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.saveAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.discardAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.newCos()
}}}
}
if(AjxPackage.define("zimbraAdmin.domains.controller.ZaDomainListController")){
ZaDomainListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaDomainListController");
this._helpURL=ZaDomainListController.helpURL;
this._helpButtonText=ZaMsg.helpManageDomains;
this._currentQuery="";
this._currentPageNum=1;
this._currentSortField=ZaDomain.A_domainName;
this.objType=ZaEvent.S_DOMAIN;
this._defaultType=ZaItem.DOMAIN;
this.RESULTSPERPAGE=ZaDomain.RESULTSPERPAGE;
this.MAXSEARCHRESULTS=ZaDomain.MAXSEARCHRESULTS
};
ZaDomainListController.prototype=new ZaListViewController();
ZaDomainListController.prototype.constructor=ZaDomainListController;
ZaDomainListController.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/managing_domains.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaController.initToolbarMethods.ZaDomainListController=new Array();
ZaController.initPopupMenuMethods.ZaDomainListController=new Array();
ZaController.changeActionsStateMethods.ZaDomainListController=new Array();
ZaDomainListController.prototype.show=function(o,t){
if(!ZaZimbraAdmin.hasGlobalDomainListAccess()&&this._currentQuery==""){
var n=ZaApp.getInstance()._domainNameList;
if(n&&(n instanceof Array)&&n.length>0){
for(var e=0;
e<n.length;
e++){
this._currentQuery+="("+ZaDomain.A_domainName+"="+n[e]+")"
}
if(n.length>1){
this._currentQuery="(|"+this._currentQuery+")"
}}else{
this._list=new ZaItemList(ZaDomain);
this.numPages=0;
this._searchTotal=0;
if(o){
this._show(this._list)
}else{
this._updateUI(this._list)
}
return
}}
var r=Dwt.getNextId();
var h=new AjxCallback(this,this.searchCallback,{
openInNewTab:t,limit:ZaDomain.RESULTSPERPAGE,CONS:ZaDomain,show:o,busyId:r}
);
var s={
query:this._currentQuery,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,offset:this.RESULTSPERPAGE*(this._currentPageNum-1),sortAscending:"1",limit:this.RESULTSPERPAGE,callback:h,controller:this,showBusy:true,busyId:r,busyMsg:ZaMsg.BUSY_SEARCHING_DOMAINS,skipCallbackIfCancelled:false,attrs:[ZaDomain.A_description,ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus,ZaItem.A_zimbraId,ZaDomain.A_domainType]};
this.scrollSearchParams={
query:this._currentQuery,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,sortAscending:"1",controller:this,showBusy:true,busyMsg:ZaMsg.BUSY_SEARCHING_DOMAINS,skipCallbackIfCancelled:false,attrs:[ZaDomain.A_description,ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus,ZaItem.A_zimbraId,ZaDomain.A_domainType]};
ZaSearch.searchDirectory(s)
};
ZaDomainListController.prototype._show=function(t,e,n,o){
this._updateUI(t,e,n,o);
ZaApp.getInstance().pushView(this.getContentViewId(),e,n);
return
};
ZaDomainListController.prototype.getList=function(){
return this._list
};
ZaDomainListController.prototype.set=function(e){
this.show(e)
};
ZaDomainListController.prototype.handleDomainChange=function(t){
if(t){
var e=t.getDetails();
if(e){
if(this._list){
this._list.replace(e)
}
if(this._contentView){
this._contentView.setUI()
}
if(ZaApp.getInstance().getCurrentController()==this){
this.show()
}else{
if(this.objType&&t.type==this.objType&&this._UICreated){
this.show(false)
}}
this.changeActionsState();
ZaZimbraAdmin.getInstance().getOverviewPanelController().refreshRelatedTreeByEdit(t.getDetails())
}}};
ZaDomainListController.initPopupMenuMethod=function(){
if(ZaZimbraAdmin.canCreateTopDomain()){
this._popupOperations[ZaOperation.NEW]=new ZaOperation(ZaOperation.NEW,ZaMsg.TBB_New,ZaMsg.DTBB_New_tt,"Domain","DomainDis",new AjxListener(this,ZaDomainListController.prototype._newButtonListener))
}
this._popupOperations[ZaOperation.EDIT]=new ZaOperation(ZaOperation.EDIT,ZaMsg.TBB_Edit,ZaMsg.DTBB_Edit_tt,"Edit","EditDis",new AjxListener(this,ZaDomainListController.prototype._editButtonListener));
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.DTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,ZaDomainListController.prototype._deleteButtonListener));
if(ZaZimbraAdmin.canCreateTopDomain()){
this._popupOperations[ZaOperation.ADD_DOMAIN_ALIAS]=new ZaOperation(ZaOperation.ADD_DOMAIN_ALIAS,ZaMsg.TBB_AddDomainAlias,ZaMsg.DTBB_addDomainAlias_tt,"DomainAlias","DomainAliasDis",new AjxListener(this,ZaDomainListController.prototype._addDomainAliasListener))
}
this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS]=new ZaOperation(ZaOperation.VIEW_DOMAIN_ACCOUNTS,ZaMsg.Domain_view_accounts,ZaMsg.Domain_view_accounts_tt,"Search","SearchDis",new AjxListener(this,this.viewAccountsButtonListener));
this._popupOperations[ZaOperation.GAL_WIZARD]=new ZaOperation(ZaOperation.GAL_WIZARD,ZaMsg.DTBB_GAlConfigWiz,ZaMsg.DTBB_GAlConfigWiz_tt,"GALWizard","GALWizardDis",new AjxListener(this,ZaDomainListController.prototype._galWizButtonListener));
this._popupOperations[ZaOperation.AUTH_WIZARD]=new ZaOperation(ZaOperation.AUTH_WIZARD,ZaMsg.DTBB_AuthConfigWiz,ZaMsg.DTBB_AuthConfigWiz_tt,"AuthWizard","AuthWizardDis",new AjxListener(this,ZaDomainListController.prototype._authWizButtonListener))
};
ZaController.initPopupMenuMethods.ZaDomainListController.push(ZaDomainListController.initPopupMenuMethod);
ZaDomainListController.prototype._createUI=function(e,o){
this._contentView=new ZaDomainListView(this._container,this._defaultType);
ZaApp.getInstance()._controllers[this.getContentViewId()]=this;
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_DMLIST,ZaId.MENU_POP);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._initDeleteDialogs();
this._UICreated=true
};
ZaDomainListController.prototype._initDeleteDialogs=function(){
if(!this._removeConfirmMessageDialog){
this._removeConfirmMessageDialog=ZaApp.getInstance().dialogs.removeConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_DMLIST+"_removeConfirm")
}
if(!this._forceRemoveMessageDialog){
this._forceRemoveMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_DMLIST+"_forceRemoveConfirm");
this._forceRemoveMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaDomainListController.prototype._forceDeleteDomainCallback,this);
this._forceRemoveMessageDialog.registerCallback(DwtDialog.NO_BUTTON,ZaDomainListController.prototype._donotForceDeleteDomainsCallback,this);
this._forceRemoveMessageDialog._button[DwtDialog.YES_BUTTON].setText(ZaMsg.FORCE_DELETE_BUTTON)
}};
ZaDomainListController.prototype._fireDomainCreationEvent=function(o){
try{
if(this._evtMgr.isListenerRegistered(ZaEvent.E_CREATE)){
var e=new ZaEvent(ZaEvent.S_DOMAIN);
e.set(ZaEvent.E_CREATE,this);
e.setDetails(o);
this._evtMgr.notifyListeners(ZaEvent.E_CREATE,e)
}}
catch(t){
this._handleException(t,"ZaDomainListController.prototype._fireDomainCreationEvent",o,false)
}};
ZaDomainListController.prototype._fireDomainChangeEvent=function(o){
try{
if(this._evtMgr.isListenerRegistered(ZaEvent.E_MODIFY)){
var e=new ZaEvent(ZaEvent.S_DOMAIN);
e.set(ZaEvent.E_MODIFY,this);
e.setDetails(o);
this._evtMgr.notifyListeners(ZaEvent.E_MODIFY,e)
}}
catch(t){
this._handleException(t,"ZaDomainListController.prototype._fireDomainChangeEvent",o,false)
}};
ZaDomainListController.prototype._listSelectionListener=function(o){
if(o.detail==DwtListView.ITEM_DBL_CLICKED){
if(o.item){
var t=o.item;
if(t.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.local){
ZaApp.getInstance().getDomainController().show(t)
}else{
if(t.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.alias){
ZaApp.getInstance().getDomainAliasWizard(true).editDomainAlias(t,true)
}}
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_domains]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.name,null,false,false,t,undefined,true)
}}else{
this.changeActionsState()
}};
ZaDomainListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaDomainListController.prototype._editButtonListener=function(t){
if(this._contentView.getSelectionCount()==1){
var e=this._contentView.getSelection()[0];
this._editItem(e)
}};
ZaDomainListController.prototype._editItem=function(t){
if(t.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.local){
ZaApp.getInstance().getDomainController().show(t)
}else{
if(t.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.alias){
ZaApp.getInstance().getDomainAliasWizard(true).editDomainAlias(t,true)
}}
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_domains]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.name,null,false,false,t,undefined,true)
};
ZaDomainListController.prototype._addDomainAliasListener=function(t){
var o=new ZaDomain();
if(this._contentView.getSelectionCount()==1){
var e=this._contentView.getSelection()[0];
o[ZaDomain.A2_zimbraDomainAliasTarget]=e
}
var n=ZaApp.getInstance().getDomainAliasWizard();
n.registerCallback(DwtDialog.OK_BUTTON,ZaDomain.prototype.createDomainAlias,o,n._localXForm);
n.setObject(o);
n.popup()
};
ZaDomainListController.prototype._newButtonListener=function(t){
try{
var o=new ZaDomain();
o.getAttrs={
all:true};
o.loadNewObjectDefaults("name","domain.tld");
if(!ZaApp.getInstance().dialogs.ZaNewDomainXWizard){
ZaApp.getInstance().dialogs.ZaNewDomainXWizard=new ZaNewDomainXWizard(this._container,o)
}
this._newDomainWizard=ZaApp.getInstance().dialogs.ZaNewDomainXWizard;
this._newDomainWizard.registerCallback(DwtWizardDialog.FINISH_BUTTON,ZaDomainListController.prototype._finishNewButtonListener,this,null);
this._newDomainWizard.setObject(o);
this._newDomainWizard.popup()
}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._newButtonListener",null,false)
}};
ZaDomainListController.prototype._galWizButtonListener=function(o){
try{
if(this._contentView.getSelectionCount()==1){
var t=this._contentView.getSelection()[0];
this._openConfigGAL(t)
}}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._showGalWizard",null,false)
}};
ZaDomainListController.prototype._openConfigGAL=function(e){
this._currentObject=e;
e.load("name",e.attrs[ZaDomain.A_domainName],false,true);
ZaApp.getInstance().dialogs.ZaGALConfigXWizard=new ZaGALConfigXWizard(this._container,e);
this._galWizard=ZaApp.getInstance().dialogs.ZaGALConfigXWizard;
e._extid=ZaUtil.getItemUUid();
e._editObject=e;
this._galWizard.setObject(e);
this._galWizard.popup()
};
ZaDomainListController.prototype._authWizButtonListener=function(o){
try{
if(this._contentView.getSelectionCount()==1){
var t=this._contentView.getSelection()[0];
this._openAuthWiz(t)
}}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._showAuthWizard",null,false)
}};
ZaDomainListController.prototype._openAuthWiz=function(e){
this._currentObject=e;
e.load("name",e.attrs[ZaDomain.A_domainName],false,true);
this._authWizard=ZaApp.getInstance().dialogs.ZaTaskAuthConfigWizard=new ZaTaskAuthConfigWizard(this._container);
e._extid=ZaUtil.getItemUUid();
e._editObject=e;
this._authWizard.setObject(e);
this._authWizard.popup()
};
ZaDomainListController.prototype._autoProvWizButtonListener=function(o){
try{
if(this._contentView.getSelectionCount()==1){
var t=this._contentView.getSelection()[0];
this._currentObject=t;
t.load("name",t.attrs[ZaDomain.A_domainName],false,true);
if(!this._autoProvWizard){
if(ZaApp.getInstance().dialogs.ZaTaskAutoProvDialog){
this._autoProvWizard=ZaApp.getInstance().dialogs.ZaTaskAutoProvDialog
}else{
this._autoProvWizard=ZaApp.getInstance().dialogs.ZaTaskAutoProvDialog=new ZaTaskAutoProvDialog(this._container,ZaMsg.NAD_AutoProvConfigTitle)
}}
t._extid=ZaUtil.getItemUUid();
t._editObject=t;
this._autoProvWizard.registerCallback(DwtDialog.OK_BUTTON,ZaTaskAutoProvDialog.prototype.finishWizard,this._autoProvWizard,null);
t.currentTab="1";
this._autoProvWizard.setObject(t);
this._autoProvWizard.popup()
}}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._autoProvWizButtonListener",null,false)
}};
ZaDomainListController.prototype._deleteButtonListener=function(r){
this._initDeleteDialogs();
this._removeList=new Array();
this._itemsInTabList=[];
var s=ZaApp.getInstance().getCurrentController()._contentView;
if(s.getSelectionCount()>0){
var n=s.getSelection();
var t=n.length;
for(var e=0;
e<t;
e++){
var o=n[e];
if(o){
if(ZaApp.getInstance().getTabGroup()&&ZaApp.getInstance().getTabGroup().getTabByItemId(o.id)){
this._itemsInTabList.push(o)
}else{
this._removeList.push(o)
}}}}
if(this._itemsInTabList.length>0){
if(!ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog){
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.CANCEL_BUTTON],[ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON_DESC,ZaMsgDialog.NO_DELETE_BUTTON_DESC],ZaId.CTR_PREFIX+ZaId.VIEW_DMLIST+"_ConfirmDeleteItemsInTab")
}
var h=ZaMsg.dl_warning_delete_accounts_in_tab;
h+=ZaDomainListController.getDlMsgFromList(this._itemsInTabList);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.setMessage(h,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.registerCallback(ZaMsgDialog.CLOSE_TAB_DELETE_BUTTON,ZaDomainListController.prototype._closeTabsBeforeRemove,this);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.registerCallback(ZaMsgDialog.NO_DELETE_BUTTON,ZaDomainListController.prototype._deleteDomainInRemoveList,this);
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.popup()
}else{
this._deleteDomainInRemoveList()
}};
ZaDomainListController.prototype.viewAccountsButtonListener=function(o){
if(this._contentView.getSelectionCount()==1){
var t=this._contentView.getSelection()[0];
var e=t.name;
ZaDomain.searchAccountsInDomain(e)
}};
ZaDomainListController.prototype._closeTabsBeforeRemove=function(){
this.closeTabsInRemoveList();
this._deleteDomainInRemoveList()
};
ZaDomainListController.prototype._deleteDomainInRemoveList=function(){
if(ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog){
ZaApp.getInstance().dialogs.ConfirmDeleteItemsInTabDialog.popdown()
}
if(this._removeList.length){
var e=ZaMsg.Q_DELETE_DOMAINS;
e+=ZaDomainListController.getDlMsgFromList(this._removeList);
this._removeConfirmMessageDialog.setMessage(e,DwtMessageDialog.INFO_STYLE);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaDomainListController.prototype._deleteDomainsCallback,this);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,ZaDomainListController.prototype._donotDeleteDomainsCallback,this);
this._removeConfirmMessageDialog.popup()
}};
ZaDomainListController.getDlMsgFromList=function(t){
var s=0;
var n="<br><ul>";
for(var o in t){
if(s>19){
n+="<li>...</li>";
break
}
n+="<li>";
if(t[o].name.length>50){
var e=49;
var r=0;
while(e<t[o].name.length){
n+=t[o].name.slice(r,e);
r=e+1;
if(r>=(t[o].name.length)){
break
}
e=(t[o].name.length<=(e+50))?t[o].name.length-1:(e+50);
n+="<br>"
}}else{
n+=t[o].name
}
n+="</li>";
s++
}
n+="</ul>";
return n
};
ZaDomainListController.prototype._deleteDomainsCallback=function(){
if(!this._successRemList){
this._successRemList=new Array()
}
for(var t=0;
t<this._removeList.length;
t++){
if(this._removeList[t]&&AjxUtil.indexOf(this._successRemList,this._removeList[t])==-1){
try{
this._removeList[t].remove();
this._successRemList.push(this._removeList[t])
}
catch(e){
this._removeConfirmMessageDialog.popdown();
if(e.code==ZmCsfeException.DOMAIN_NOT_EMPTY&&ZaZimbraAdmin.haveTargetRight(ZaItem.ACCOUNT,ZaAccount.DELETE_ACCOUNT_RIGHT,this._removeList[t].name)&&ZaZimbraAdmin.haveTargetRight(ZaItem.ACCOUNT,ZaAccount.RIGHT_LIST_ACCOUNT,this._removeList[t].name)){
this._forceDeleteDomain(this._removeList[t])
}else{
if(e.code==ZmCsfeException.DOMAIN_NOT_EMPTY){
this.popupErrorDialog(ZaMsg.ERROR_DOMAIN_NOT_EMPTY)
}else{
this._handleException(e,"ZaDomainListController.prototype._deleteDomainsCallback",null,false)
}}
return
}
if(this._list){
this._list.remove(this._removeList[t])
}}}
ZaApp.getInstance().getCurrentController().fireRemovalEvent(this._successRemList);
this._successRemList=null;
this._removeConfirmMessageDialog.popdown()
};
ZaDomainListController.prototype._donotDeleteDomainsCallback=function(){
this._removeList=new Array();
this._removeConfirmMessageDialog.popdown()
};
ZaDomainListController.prototype._getAllAccountDomain=function(s){
if(s){
var l=Dwt.getNextId();
var n=[ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.ALIASES,ZaSearch.RESOURCES];
var h={
query:"",domain:s,types:n,attrs:AjxBuffer.concat(ZaAlias.searchAttributes,",",ZaDistributionList.searchAttributes,",",ZaResource.searchAttributes,",",ZaSearch.standardAttributes),controller:ZaApp.getInstance().getCurrentController(),showBusy:true,busyId:l,busyMsg:ZaMsg.BUSY_SEARCHING};
var r=ZaSearch.searchDirectory(h);
if(r&&r.Body.SearchDirectoryResponse){
var t=r.Body.SearchDirectoryResponse;
var o=new ZaItemList(ZaAccount);
o.loadFromJS(t);
return o.getArray()
}else{
return null
}}else{
var e=ZaApp.getInstance().getCurrentController();
e.popupErrorDialog(ZaMsg.ERROR_NO_DOMAIN_NAME)
}
return null
};
ZaDomainListController.prototype._forceDeleteDomain=function(r){
var e=this._getAllAccountDomain(r.name);
if(e&&e.length>0){
var s=0;
var n=0;
for(var o=0;
o<e.length;
o++){
if(e[o].attrs[ZaAccount.A_zimbraIsSystemAccount]=="TRUE"){
s++
}else{
n++
}}
this._forceRemoveAccountList=e;
this._forceRemoveDomain=r;
var t=AjxMessageFormat.format(ZaMsg.Q_FORCE_DELETE_DOMAIN,[r.name,s,n]);
t+=ZaDomainListController.getDlMsgFromList(this._forceRemoveAccountList);
this._forceRemoveMessageDialog.setMessage(t,DwtMessageDialog.INFO_STYLE);
this._forceRemoveMessageDialog.popup()
}};
ZaDomainListController.prototype._forceDeleteDomainCallback=function(){
this._forceRemoveMessageDialog.popdown();
var e=this._forceRemoveAccountList;
var n=this._forceRemoveDomain;
if(!e||!n){
return
}
try{
for(var o=0;
o<e.length;
o++){
e[o].remove()
}
this._forceRemoveAccountList=null;
this._deleteDomainsCallback()
}
catch(t){
this._handleException(t,"ZaDomainListController.prototype._forceDeleteDomainCallback",null,false)
}};
ZaDomainListController.prototype._donotForceDeleteDomainsCallback=function(){
this._forceRemoveMessageDialog.popdown();
if(this._forceRemoveDomain){
AjxUtil.arrayRemove(this._removeList,this._forceRemoveDomain);
this._deleteDomainsCallback()
}};
ZaDomainListController.changeActionsStateMethod=function(){
if(!this._contentView){
return
}
var e=this._contentView.getSelectionCount();
if(e==1){
var t=this._contentView.getSelection()[0];
if(t){
if(t.attrs[ZaDomain.A_domainType]=="alias"){
if(this._popupOperations[ZaOperation.ADD_DOMAIN_ALIAS]){
this._popupOperations[ZaOperation.ADD_DOMAIN_ALIAS].enabled=false
}
if(this._popupOperations[ZaOperation.AUTOPROV_WIZARD]){
this._popupOperations[ZaOperation.AUTOPROV_WIZARD].enabled=false
}}
if(t.attrs[ZaDomain.A_zimbraDomainStatus]==ZaDomain.DOMAIN_STATUS_SHUTDOWN){
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.AUTH_WIZARD]){
this._popupOperations[ZaOperation.AUTH_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.AUTOPROV_WIZARD]){
this._popupOperations[ZaOperation.AUTOPROV_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.GAL_WIZARD]){
this._popupOperations[ZaOperation.GAL_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS]){
this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS].enabled=false
}}else{
if(AjxUtil.isEmpty(t.rights)){
t.loadEffectiveRights("id",t.id,false)
}
if(!(ZaDomain.canConfigureGal(t))){
if(this._popupOperations[ZaOperation.GAL_WIZARD]){
this._popupOperations[ZaOperation.GAL_WIZARD].enabled=false
}}
if(!(ZaDomain.canConfigureAuth(t))){
if(this._popupOperations[ZaOperation.AUTH_WIZARD]){
this._popupOperations[ZaOperation.AUTH_WIZARD].enabled=false
}}
if(!(ZaDomain.canConfigureAutoProv(t))){
if(this._popupOperations[ZaOperation.AUTOPROV_WIZARD]){
this._popupOperations[ZaOperation.AUTOPROV_WIZARD].enabled=false
}}
if(!t.rights[ZaDomain.RIGHT_DELETE_DOMAIN]){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}}}else{
if(e>1){
if(this._popupOperations[ZaOperation.AUTH_WIZARD]){
this._popupOperations[ZaOperation.AUTH_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.AUTOPROV_WIZARD]){
this._popupOperations[ZaOperation.AUTOPROV_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.GAL_WIZARD]){
this._popupOperations[ZaOperation.GAL_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS]){
this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS].enabled=false
}}else{
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}
if(this._popupOperations[ZaOperation.AUTH_WIZARD]){
this._popupOperations[ZaOperation.AUTH_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.AUTOPROV_WIZARD]){
this._popupOperations[ZaOperation.AUTOPROV_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.GAL_WIZARD]){
this._popupOperations[ZaOperation.GAL_WIZARD].enabled=false
}
if(this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS]){
this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS].enabled=false
}}}};
ZaController.changeActionsStateMethods.ZaDomainListController.push(ZaDomainListController.changeActionsStateMethod);
ZaDomainListController.prototype._finishNewButtonListener=function(o){
try{
var s=this._newDomainWizard.getObject();
var n=ZaItem.create(s,ZaDomain,"ZaDomain");
if(n!=null){
this._newDomainWizard.popdown();
this._fireDomainCreationEvent(n);
var e=new ZaEvent(ZaEvent.S_DOMAIN);
e.set(ZaEvent.E_CREATE,this);
e.setDetails(n);
this.handleCreation(e);
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.DomainCreated,[n.name]))
}}
catch(t){
if(t.code==ZmCsfeException.DOMAIN_EXISTS){
this.popupErrorDialog(ZaMsg.ERROR_DOMAIN_EXISTS,t)
}else{
this._handleException(t,"ZaDomainListController.prototype._finishNewButtonListener",null,false)
}}
return
};
ZaDomainListController.prototype.notifyAllOpenTabs=function(e){
this._currentObject=e;
this._notifyAllOpenTabs()
};
ZaDomainListController.prototype._notifyAllOpenTabs=function(){
var o="<br><ul>";
var t=false;
for(var s=0;
s<ZaAppTabGroup._TABS.size();
s++){
var r=ZaAppTabGroup._TABS.get(s);
var n=r.getAppView();
if(n&&n._containedObject&&n._containedObject.name){
var c=n._containedObject.name;
var e=c.indexOf("@");
var h=null;
if(e>0){
h=c.substring(e+1)
}
if((h!=null&&h==this._currentObject.attrs[ZaDomain.A_domainName])||(h==null&&c==this._currentObject.attrs[ZaDomain.A_domainName])){
o+="<li>"+c+"</li>";
t=true
}}}
o+="</ul></br>";
if(t){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.WARN_CHANGE_AUTH_METH+o)
}};
ZaDomainListController.prototype._finishAuthButtonListener=function(t){
try{
ZaDomain.modifyAuthSettings.call(this._currentObject,this._authWizard.getObject());
this._fireDomainChangeEvent(this._currentObject);
this._authWizard.popdown();
this._notifyAllOpenTabs()
}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._finishAuthButtonListener",null,false)
}
return
};
ZaDomainListController.prototype._finishAutoProvButtonListener=function(t){
try{
if(!this._autoProvWizard._checkGeneralConfig()||!this._autoProvWizard._checkEagerConfig()||!this._autoProvWizard._checkLazyConfig()){
return
}
var o=this._autoProvWizard.getObject();
this._autoProvWizard._combineConfigureValues(o);
ZaDomain.modifyAutoPovSettings.call(this._currentObject,o);
this._fireDomainChangeEvent(this._currentObject);
this._autoProvWizard.popdown();
this._notifyAllOpenTabs()
}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._finishAutoProvButtonListener",null,false)
}
return
};
ZaDomainListController.prototype._finishGalButtonListener=function(t){
try{
ZaDomain.modifyGalSettings.call(this._currentObject,this._galWizard.getObject());
this._fireDomainChangeEvent(this._currentObject);
this._galWizard.popdown()
}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._finishGalButtonListener",null,false)
}
return
};
ZaDomainListController.prototype.searchCallback=function(o,t){
ZaListViewController.prototype.searchCallback.call(this,o,t);
var e=ZaApp.getInstance();
e._domainList=this.getList();
e._domainNameList=undefined
}
}
if(AjxPackage.define("zimbraAdmin.servers.controller.ZaServerListController")){
ZaServerListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaServerListController");
this._toolbarOperations=new Array();
this._popupOperations=new Array();
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/managing_servers.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageServers
};
ZaServerListController.prototype=new ZaListViewController();
ZaServerListController.prototype.constructor=ZaServerListController;
ZaController.initToolbarMethods.ZaServerListController=new Array();
ZaController.initPopupMenuMethods.ZaServerListController=new Array();
ZaController.changeActionsStateMethods.ZaServerListController=new Array();
ZaServerListController.prototype.show=function(t,e){
if(!this._UICreated){
this._createUI()
}
if(t!=null){
this._contentView.set(t.getVector())
}
ZaApp.getInstance().pushView(this.getContentViewId());
if(t!=null){
this._list=t
}
this.changeActionsState()
};
ZaServerListController.initToolbarMethod=function(){
this._toolbarOperations[ZaOperation.EDIT]=new ZaOperation(ZaOperation.EDIT,ZaMsg.TBB_Edit,ZaMsg.SERTBB_Edit_tt,"Properties","PropertiesDis",new AjxListener(this,ZaServerListController.prototype._editButtonListener));
this._toolbarOperations[ZaOperation.FLUSH_CACHE]=new ZaOperation(ZaOperation.FLUSH_CACHE,ZaMsg.SERTBB_FlushCache,ZaMsg.SERTBB_FlushCache_tt,"FlushCache","FlushCache",new AjxListener(this,ZaServerListController.prototype._flushCacheButtonListener));
this._toolbarOperations[ZaOperation.NONE]=new ZaOperation(ZaOperation.NONE);
this._toolbarOperations[ZaOperation.HELP]=new ZaOperation(ZaOperation.HELP,ZaMsg.TBB_Help,ZaMsg.TBB_Help_tt,"Help","Help",new AjxListener(this,this._helpButtonListener));
this._toolbarOrder.push(ZaOperation.EDIT);
this._toolbarOrder.push(ZaOperation.FLUSH_CACHE);
this._toolbarOrder.push(ZaOperation.NONE);
this._toolbarOrder.push(ZaOperation.HELP)
};
ZaController.initToolbarMethods.ZaServerListController.push(ZaServerListController.initToolbarMethod);
ZaServerListController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.EDIT]=new ZaOperation(ZaOperation.EDIT,ZaMsg.TBB_Edit,ZaMsg.SERTBB_Edit_tt,"Properties","PropertiesDis",new AjxListener(this,ZaServerListController.prototype._editButtonListener));
this._popupOperations[ZaOperation.FLUSH_CACHE]=new ZaOperation(ZaOperation.FLUSH_CACHE,ZaMsg.SERTBB_FlushCache,ZaMsg.SERTBB_FlushCache_tt,"FlushCache","FlushCache",new AjxListener(this,ZaServerListController.prototype._flushCacheButtonListener))
};
ZaController.initPopupMenuMethods.ZaServerListController.push(ZaServerListController.initPopupMenuMethod);
ZaServerListController.prototype._createUI=function(){
try{
var t=new Object();
this._contentView=new ZaServerListView(this._container);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_SERLIST,ZaId.MENU_POP);
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
catch(e){
this._handleException(e,"ZaServerListController.prototype._createUI",null,false);
return
}};
ZaServerListController.prototype._flushCacheButtonListener=function(r){
try{
if(this._contentView.getSelectionCount()>0){
var s=this._contentView.getSelection();
if(s&&s.length){
srvList=[];
srvList._version=1;
var n=[];
for(var o=0;
o<s.length;
o++){
var e=s[o];
e.status=0;
srvList.push(e);
n.push(e.id)
}
obj={
statusMessage:null,flushZimlet:true,flushSkin:true,flushLocale:true,serverList:srvList,status:0,name:(n.length>1?ZaMsg.multiple_servers:srvList[0].name),_uuid:(n.length>1?n.join("__"):n[0])};
obj._uuid=n.join("__");
ZaApp.getInstance().dialogs.flushCacheDialog=new ZaFlushCacheXDialog(this._container,{
id:(n.length>1?n.join("__"):n[0]),name:(n.length>1?ZaMsg.multiple_servers:srvList[0].name)}
);
ZaApp.getInstance().dialogs.flushCacheDialog.setObject(obj);
ZaApp.getInstance().dialogs.flushCacheDialog.popup()
}}}
catch(t){
this._handleException(t,"ZaServerListController.prototype._flushCacheButtonListener",null,false)
}
return
};
ZaServerListController.prototype.set=function(e){
this.show(e)
};
ZaServerListController.prototype.handleServerChange=function(t){
if(t){
var e=t.getDetails();
if(e){
if(this._list){
this._list.replace(e)
}
if(this._contentView){
this._contentView.setUI()
}
if(ZaApp.getInstance().getCurrentController()==this){
this.show()
}
this.changeActionsState()
}}};
ZaServerListController.prototype._newButtonListener=function(e){
var t=new ZaServer();
ZaApp.getInstance().getServerController().show(t)
};
ZaServerListController.prototype._listSelectionListener=function(t){
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
if(t.item){
this._selectedItem=t.item;
ZaApp.getInstance().getServerController().show(t.item);
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_servers]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.item.name,null,false,false,t.item,undefined,true)
}}else{
this.changeActionsState()
}};
ZaServerListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaServerListController.prototype._editButtonListener=function(o){
if(this._contentView.getSelectionCount()==1){
var t=this._contentView.getSelection()[0];
ZaApp.getInstance().getServerController().show(t);
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_servers]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.name,null,false,false,t)
}};
ZaServerListController.prototype.getPopUpOperation=function(){
return this._popupOperations
};
ZaServerListController.changeActionsStateMethod=function(){
if(this._contentView){
var t=this._contentView.getSelectionCount();
var o=true;
var n=this._contentView.getSelection();
if(n){
var t=n.length;
for(var e=0;
e<t;
e++){
if(!ZaItem.hasRight(ZaServer.FLUSH_CACHE_RIGHT,n[e])||!n[e].attrs[ZaServer.A_zimbraMailboxServiceEnabled]||!n[e].attrs[ZaServer.A_zimbraMailboxServiceInstalled]){
o=false;
break
}}}
if(t==1){
if(!o){
if(this._toolbarOperations[ZaOperation.FLUSH_CACHE]){
this._toolbarOperations[ZaOperation.FLUSH_CACHE].enabled=false
}
if(this._popupOperations[ZaOperation.FLUSH_CACHE]){
this._popupOperations[ZaOperation.FLUSH_CACHE].enabled=false
}}}else{
if(t>1){
if(this._toolbarOperations[ZaOperation.EDIT]){
this._toolbarOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(!o){
if(this._toolbarOperations[ZaOperation.FLUSH_CACHE]){
this._toolbarOperations[ZaOperation.FLUSH_CACHE].enabled=false
}
if(this._popupOperations[ZaOperation.FLUSH_CACHE]){
this._popupOperations[ZaOperation.FLUSH_CACHE].enabled=false
}}}else{
if(t<1){
if(this._toolbarOperations[ZaOperation.EDIT]){
this._toolbarOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._toolbarOperations[ZaOperation.FLUSH_CACHE]){
this._toolbarOperations[ZaOperation.FLUSH_CACHE].enabled=false
}
if(this._popupOperations[ZaOperation.FLUSH_CACHE]){
this._popupOperations[ZaOperation.FLUSH_CACHE].enabled=false
}}}}}};
ZaController.changeActionsStateMethods.ZaServerListController.push(ZaServerListController.changeActionsStateMethod)
}
if(AjxPackage.define("zimbraAdmin.servers.controller.ZaServerController")){
ZaServerController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaServerController");
this._UICreated=false;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/managing_servers.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageServers;
this._toolbarOperations=new Array();
this._popupOperations=new Array();
this.deleteMsg=ZaMsg.Q_DELETE_SERVER;
this.objType=ZaEvent.S_SERVER;
this.tabConstructor=ZaServerXFormView
};
ZaServerController.prototype=new ZaXFormViewController();
ZaServerController.prototype.constructor=ZaServerController;
ZaController.initToolbarMethods.ZaServerController=new Array();
ZaController.initPopupMenuMethods.ZaServerController=new Array();
ZaController.setViewMethods.ZaServerController=new Array();
ZaController.changeActionsStateMethods.ZaServerController=new Array();
ZaXFormViewController.preSaveValidationMethods.ZaServerController=new Array();
ZaServerController.prototype.show=function(e){
if(!this.selectExistingTabByItemId(e.id)){
this._setView(e,true)
}};
ZaServerController.changeActionsStateMethod=function(){
var e=(this._view&&this._view.isDirty());
if(this._popupOperations[ZaOperation.SAVE]){
this._popupOperations[ZaOperation.SAVE].enabled=e
}};
ZaController.changeActionsStateMethods.ZaServerController.push(ZaServerController.changeActionsStateMethod);
ZaServerController.prototype.setEnabled=function(e){};
ZaServerController.prototype.addServerChangeListener=function(e){
this._evtMgr.addListener(ZaEvent.E_MODIFY,e)
};
ZaServerController.prototype.removeServerChangeListener=function(e){
this._evtMgr.removeListener(ZaEvent.E_MODIFY,e)
};
ZaServerController.initPopupMethod=function(){
this._popupOperations[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.SERTBB_Save_tt,"Save","SaveDis",new AjxListener(this,this.saveButtonListener));
this._popupOperations[ZaOperation.FLUSH_CACHE]=new ZaOperation(ZaOperation.FLUSH_CACHE,ZaMsg.SERTBB_FlushCache,ZaMsg.SERTBB_FlushCache_tt,"FlushCache","FlushCache",new AjxListener(this,ZaServerController.prototype.flushCacheButtonListener));
this._popupOperations[ZaOperation.DOWNLOAD_SERVER_CONFIG]=new ZaOperation(ZaOperation.DOWNLOAD_SERVER_CONFIG,ZaMsg.TBB_DownloadConfig,ZaMsg.SERTBB_DownloadConfig_tt,"DownloadServerConfig","DownloadServerConfig",new AjxListener(this,this.downloadConfigButtonListener))
};
ZaController.initPopupMenuMethods.ZaServerController.push(ZaServerController.initPopupMethod);
ZaServerController.setViewMethod=function(e){
e.load("id",e.id,false,true);
if(!this._UICreated){
this._createUI(e)
}
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setDirty(false);
this._view.setObject(e);
this._currentObject=e
};
ZaController.setViewMethods.ZaServerController.push(ZaServerController.setViewMethod);
ZaServerController.prototype._createUI=function(e){
this._contentView=this._view=new this.tabConstructor(this._container,e);
this._initPopupMenu();
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaServerController.prototype.getPopUpOperation=function(){
return this._popupOperations
};
ZaServerController.prototype._saveChanges=function(){
var e=this._view.getObject();
if(this._currentObject[ZaModel.currentTab]!=e[ZaModel.currentTab]){
this._currentObject[ZaModel.currentTab]=e[ZaModel.currentTab]
}
this._currentObject.modify(e);
this._view.setDirty(false);
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.ServerModified,[this._currentObject.name]));
return true
};
ZaServerController.prototype.validateMyNetworks=function(T){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraMtaMyNetworks,this._currentObject)){
this.runValidationStack(T);
return
}
var u=this._view.getObject();
if(!u.attrs.hasOwnProperty(ZaServer.A_zimbraMtaMyNetworks)){
this.runValidationStack(T);
return
}
var h=[];
var c=[];
var g=0;
if(this._currentObject.nifs&&this._currentObject.nifs.length){
g=this._currentObject.nifs.length;
for(var k=0;
k<g;
k++){
if(this._currentObject.nifs[k]&&this._currentObject.nifs[k].attrs&&this._currentObject.nifs[k].attrs.addr&&this._currentObject.nifs[k].attrs.mask){
try{
var z=ZaIPUtil.isValidIP(this._currentObject.nifs[k].attrs.addr);
var r=ZaIPUtil.getNetBit(this._currentObject.nifs[k].attrs.mask);
var b=ZaIPUtil.getNetworkAddr(z,r);
var l=ZaIPUtil.isValidIP(this._currentObject.nifs[k].attrs.addr);
var f=ZaIPUtil.getNetBit(this._currentObject.nifs[k].attrs.mask);
var o=ZaIPUtil.getNetworkAddr(l,f);
h.push(b);
c.push(o)
}
catch(x){}}}}
var t=g;
if(u.attrs[ZaServer.A_zimbraMtaMyNetworks]){
u.attrs[ZaServer.A_zimbraMtaMyNetworks]=AjxStringUtil.trim(u.attrs[ZaServer.A_zimbraMtaMyNetworks],true);
var d=u.attrs[ZaServer.A_zimbraMtaMyNetworks].split(/[\s,]+/);
var v=d.length;
var s=[];
var p=[];
var O;
var m;
for(var k=0;
k<v;
k++){
if(d[k]!=null&&d[k].length>2){
if(d[k].indexOf("!")==0){
m=d[k].substr(1);
if(d[k].indexOf("/")>0){
try{
O=ZaIPUtil.isValidCIDR(m)
}
catch(x){
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_NOT_CIDR,[m]),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}
p.push(O);
for(var w=(g-1);
w>=0;
w--){
if(ZaIPUtil.isInSubNet(O,c[w].ipData)){
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_LOCAL_ADDR_EXCLUDED,[c[w].ipData.src,d[k]]),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}}}else{
try{
var e=ZaIPUtil.isValidIP(m)
}
catch(x){
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_EXCLUDE_ADDR,[m]),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}
for(var w=(g-1);
w>=0;
w--){
var y=1;
try{
y=ZaIPUtil.compareIP(c[w].ipData,e)
}
catch(x){}
if(y===0){
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_LOCAL_ADDR_EXCLUDED,[c[w].ipData.src,d[k]]),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}}}}else{
m=d[k];
try{
O=ZaIPUtil.isValidCIDR(m)
}
catch(x){
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_NOT_CIDR,[m]),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}
s.push(O);
for(var w=(t-1);
w>=0;
w--){
try{
if(ZaIPUtil.isInSubNet(O,h[w].ipData)){
h.splice(w,1);
t--
}}
catch(x){}}}}else{
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_NOT_CIDR,[d[k]]),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}}
if(d.length<1){
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_NO_VALID_SUBNETS,[u.attrs[ZaServer.A_zimbraMtaMyNetworks]]),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}
if(t>0){
var q=[];
for(var n=0;
n<t;
n++){
q.push(h[n].ipData.src)
}
throw new AjxException(AjxMessageFormat.format(ZaMsg.ERROR_MISSING_LOCAL,q.join(",")),AjxException.INVALID_PARAM,"ZaServerController.prototype.validateMyNetworks")
}}
this.runValidationStack(T)
};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validateMyNetworks);
ZaServerController.prototype.validateMTA=function(n){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraSmtpHostname,this._currentObject)){
this.runValidationStack(n);
return
}
var o=this._view.getObject();
if((AjxUtil.isEmpty(o.attrs[ZaServer.A_zimbraSmtpHostname]))&&!AjxUtil.isEmpty(this._currentObject.attrs[ZaServer.A_zimbraSmtpHostname])){
if(ZaApp.getInstance().dialogs.confirmMessageDialog){
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown()
}
ZaApp.getInstance().dialogs.confirmMessageDialog=new ZaMsgDialog(this._view.shell,null,[DwtDialog.YES_BUTTON,DwtDialog.CANCEL_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_STATUS+"_confirmMessage");
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(AjxMessageFormat.format(ZaMsg.WARNING_RESETING_SMTP_HOST,[o._defaultValues.attrs[ZaServer.A_zimbraSmtpHostname].join(", "),o._defaultValues.attrs[ZaServer.A_zimbraSmtpHostname].join(", ")]),DwtMessageDialog.WARNING_STYLE);
var e;
var t=ZaServerController.prototype.runValidationStack;
if(!n||!n.func){
e=null
}else{
e=n
}
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,t,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.runValidationStack(n);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validateMTA);
ZaServerController.prototype.validateVolumeChanges=function(n){
if(!ZaItem.hasRight(ZaServer.MANAGE_VOLUME_RIGHT,this._currentObject)){
this.runValidationStack(n);
return
}
var o=this._view.getObject();
if(o[ZaServer.A_RemovedVolumes]&&o[ZaServer.A_RemovedVolumes].length>0){
if(ZaApp.getInstance().dialogs.confirmMessageDialog){
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown()
}
ZaApp.getInstance().dialogs.confirmMessageDialog=new ZaMsgDialog(this._view.shell,null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_STATUS+"_confirmMessage");
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_DELETE_VOLUMES,DwtMessageDialog.WARNING_STYLE);
var e;
var t=ZaServerController.prototype.runValidationStack;
if(!n||!n.func){
e=null
}else{
e=n
}
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,t,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.runValidationStack(n);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validateVolumeChanges);
ZaServerController.changeProxyPorts=function(){
if(ZaApp.getInstance().dialogs.confirmMessageDialog){
var e=ZaApp.getInstance().dialogs.confirmMessageDialog.getObject();
if(e){
if(e.selectedChoice==0){
this._view.getObject().attrs[e.fieldRef]=e.defVal
}else{
if(e.selectedChoice==2){
this._view.getObject().attrs[ZaServer.A_zimbraMailProxyServiceEnabled]=false
}}}}
ZaServerController.prototype.runValidationStack.call(this)
};
ZaServerController.prototype.validateImapBindPort=function(t){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraImapBindPort,this._currentObject)){
this.runValidationStack(t);
return
}
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_zimbraImapBindPort]!=ZaServer.DEFAULT_IMAP_PORT_ZCS&&(e.attrs[ZaServer.A_zimbraImapBindPort]!=null))||(e.attrs[ZaServer.A_zimbraImapBindPort]==null&&(e._defaultValues.attrs[ZaServer.A_zimbraImapBindPort]!=ZaServer.DEFAULT_IMAP_PORT_ZCS))){
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.IMAP_Port,e.attrs[ZaServer.A_zimbraImapBindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.IMAP_Port,ZaServer.DEFAULT_IMAP_PORT_ZCS]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.IMAP_Port,e.attrs[ZaServer.A_zimbraImapBindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_zimbraImapBindPort;
o.defVal=ZaServer.DEFAULT_IMAP_PORT_ZCS;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validateImapBindPort);
ZaServerController.prototype.validateImapSSLBindPort=function(t){
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_ImapSSLBindPort]!=ZaServer.DEFAULT_IMAP_SSL_PORT_ZCS&&(e.attrs[ZaServer.A_ImapSSLBindPort]!=null))||(e.attrs[ZaServer.A_ImapSSLBindPort]==null&&(e._defaultValues.attrs[ZaServer.A_ImapSSLBindPort]!=ZaServer.DEFAULT_IMAP_SSL_PORT_ZCS))){
o.defVal=ZaServer.DEFAULT_IMAP_SSL_PORT_ZCS;
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.IMAP_Port,e.attrs[ZaServer.A_ImapSSLBindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.IMAP_SSLPort,ZaServer.DEFAULT_IMAP_SSL_PORT_ZCS]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.IMAP_SSLPort,e.attrs[ZaServer.A_ImapSSLBindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_ImapSSLBindPort;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validateImapSSLBindPort);
ZaServerController.prototype.validatePop3BindPort=function(t){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraPop3BindPort,this._currentObject)){
this.runValidationStack(t);
return
}
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_zimbraPop3BindPort]!=ZaServer.DEFAULT_POP3_PORT_ZCS&&(e.attrs[ZaServer.A_zimbraPop3BindPort]!=null))||(e.attrs[ZaServer.A_zimbraPop3BindPort]==null&&(e._defaultValues.attrs[ZaServer.A_zimbraPop3BindPort]!=ZaServer.DEFAULT_POP3_PORT_ZCS))){
o.defVal=ZaServer.DEFAULT_POP3_PORT_ZCS;
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.NAD_POP_Port,e.attrs[ZaServer.A_zimbraPop3BindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.NAD_POP_Port,ZaServer.DEFAULT_POP3_PORT_ZCS]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.NAD_POP_Port,e.attrs[ZaServer.A_zimbraPop3BindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_zimbraPop3BindPort;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validatePop3BindPort);
ZaServerController.prototype.validatePop3BindAddress=function(o){
if(!ZaItem.hasWritePermission(ZaServer.A_Pop3BindAddress,this._currentObject)){
this.runValidationStack(o);
return
}
var t=this._view.getObject();
if(t.attrs[ZaServer.A_Pop3BindAddress]!=this._currentObject.attrs[ZaServer.A_Pop3BindAddress]){
if(!ZaApp.getInstance().dialogs.confirmSaveDialog){
var e=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.VIEW_STATUS+"_confirmSavePopAddr");
e.setMessage(ZaMsg.NAD_POP_Address_Warning,DwtMessageDialog.WARNING_STYLE);
e.registerCallback(DwtDialog.YES_BUTTON,ZaServerController._confirmSavePop3BindAddress,this,null);
ZaApp.getInstance().dialogs.confirmSaveDialog=e
}
ZaApp.getInstance().dialogs.confirmSaveDialog.popup()
}else{
this.runValidationStack(o);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validatePop3BindAddress);
ZaServerController._confirmSavePop3BindAddress=function(){
if(ZaApp.getInstance().dialogs.confirmSaveDialog){
ZaApp.getInstance().dialogs.confirmSaveDialog.popdown()
}
ZaServerController.prototype.runValidationStack.call(this)
};
ZaServerController.prototype.validatePop3SSLBindPort=function(t){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraPop3SSLBindPort,this._currentObject)){
this.runValidationStack(t);
return
}
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_zimbraPop3SSLBindPort]!=ZaServer.DEFAULT_POP3_SSL_PORT_ZCS&&(e.attrs[ZaServer.A_zimbraPop3SSLBindPort]!=null))||(e.attrs[ZaServer.A_zimbraPop3SSLBindPort]==null&&(e._defaultValues.attrs[ZaServer.A_zimbraPop3SSLBindPort]!=ZaServer.DEFAULT_POP3_SSL_PORT_ZCS))){
o.defVal=ZaServer.DEFAULT_POP3_SSL_PORT_ZCS;
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.NAD_POP_SSL_Port,e.attrs[ZaServer.A_zimbraPop3SSLBindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.NAD_POP_SSL_Port,ZaServer.DEFAULT_POP3_SSL_PORT_ZCS]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.NAD_POP_SSL_Port,e.attrs[ZaServer.A_zimbraPop3SSLBindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_zimbraPop3SSLBindPort;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validatePop3SSLBindPort);
ZaServerController.prototype.validateImapProxyBindPort=function(t){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraImapProxyBindPort,this._currentObject)){
this.runValidationStack(t);
return
}
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_zimbraImapProxyBindPort]!=ZaServer.DEFAULT_IMAP_PORT&&(e.attrs[ZaServer.A_zimbraImapProxyBindPort]!=null))||(e.attrs[ZaServer.A_zimbraImapProxyBindPort]==null&&(e._defaultValues.attrs[ZaServer.A_zimbraImapProxyBindPort]!=ZaServer.DEFAULT_IMAP_PORT))){
o.defVal=ZaServer.DEFAULT_IMAP_PORT;
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.IMAP_Proxy_Port,e.attrs[ZaServer.A_zimbraImapProxyBindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.IMAP_Proxy_Port,ZaServer.DEFAULT_IMAP_PORT]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.IMAP_Proxy_Port,e.attrs[ZaServer.A_zimbraImapProxyBindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_zimbraImapProxyBindPort;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validateImapProxyBindPort);
ZaServerController.prototype.validateImapSSLProxyBindPort=function(t){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraImapSSLProxyBindPort,this._currentObject)){
this.runValidationStack(t);
return
}
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_zimbraImapSSLProxyBindPort]!=ZaServer.DEFAULT_IMAP_SSL_PORT&&(e.attrs[ZaServer.A_zimbraImapSSLProxyBindPort]!=null))||(e.attrs[ZaServer.A_zimbraImapSSLProxyBindPort]==null&&(e._defaultValues.attrs[ZaServer.A_zimbraImapSSLProxyBindPort]!=ZaServer.DEFAULT_IMAP_SSL_PORT))){
o.defVal=ZaServer.DEFAULT_IMAP_SSL_PORT;
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.IMAP_SSL_Proxy_Port,e.attrs[ZaServer.A_zimbraImapSSLProxyBindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.IMAP_SSL_Proxy_Port,ZaServer.DEFAULT_IMAP_SSL_PORT]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.IMAP_SSL_Proxy_Port,e.attrs[ZaServer.A_zimbraImapSSLProxyBindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_zimbraImapSSLProxyBindPort;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validateImapSSLProxyBindPort);
ZaServerController.prototype.validatePop3ProxyBindPort=function(t){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraPop3ProxyBindPort,this._currentObject)){
this.runValidationStack(t);
return
}
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_zimbraPop3ProxyBindPort]!=ZaServer.DEFAULT_POP3_PORT&&(e.attrs[ZaServer.A_zimbraPop3ProxyBindPort]!=null))||(e.attrs[ZaServer.A_zimbraPop3ProxyBindPort]==null&&(e._defaultValues.attrs[ZaServer.A_zimbraPop3ProxyBindPort]!=ZaServer.DEFAULT_POP3_PORT))){
o.defVal=ZaServer.DEFAULT_POP3_PORT;
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.NAD_POP_proxy_Port,e.attrs[ZaServer.A_zimbraPop3ProxyBindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.NAD_POP_proxy_Port,ZaServer.DEFAULT_POP3_PORT]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.NAD_POP_proxy_Port,e.attrs[ZaServer.A_zimbraPop3ProxyBindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_zimbraPop3ProxyBindPort;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validatePop3ProxyBindPort);
ZaServerController.prototype.validatePop3SSLProxyBindPort=function(t){
if(!ZaItem.hasWritePermission(ZaServer.A_zimbraPop3SSLProxyBindPort,this._currentObject)){
this.runValidationStack(t);
return
}
var e=this._view.getObject();
var o={
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:"",fieldRef:""};
if((e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]!=this._currentObject.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailProxyServiceEnabled]==true)){
if((e.attrs[ZaServer.A_zimbraPop3SSLProxyBindPort]!=ZaServer.DEFAULT_POP3_SSL_PORT&&(e.attrs[ZaServer.A_zimbraPop3SSLProxyBindPort]!=null))||(e.attrs[ZaServer.A_zimbraPop3SSLProxyBindPort]==null&&(e._defaultValues.attrs[ZaServer.A_zimbraPop3SSLProxyBindPort]!=ZaServer.DEFAULT_POP3_SSL_PORT))){
o.defVal=ZaServer.DEFAULT_POP3_SSL_PORT;
o.warningMsg=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning,[ZaMsg.NAD_POP_SSL_proxy_Port,e.attrs[ZaServer.A_zimbraPop3SSLProxyBindPort]]);
o.choice1Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP1,[ZaMsg.NAD_POP_SSL_proxy_Port,ZaServer.DEFAULT_POP3_SSL_PORT]);
o.choice2Label=AjxMessageFormat.format(ZaMsg.Server_WrongPortWarning_OP2,[ZaMsg.NAD_POP_SSL_proxy_Port,e.attrs[ZaServer.A_zimbraPop3SSLProxyBindPort]]);
o.choice3Label=ZaMsg.Server_WrongPortWarning_OP3;
o.fieldRef=ZaServer.A_zimbraPop3SSLProxyBindPort;
ZaServerController.showPortWarning.call(this,t,o)
}else{
this.runValidationStack(t);
return
}}else{
this.runValidationStack(t);
return
}};
ZaXFormViewController.preSaveValidationMethods.ZaServerController.push(ZaServerController.prototype.validatePop3SSLProxyBindPort);
ZaServerController.showPortWarning=function(o,t){
if(ZaApp.getInstance().dialogs.confirmMessageDialog){
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown()
}
ZaApp.getInstance().dialogs.confirmMessageDialog=new ZaProxyPortWarningXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Server_WrongPortWarningTitle);
ZaApp.getInstance().dialogs.confirmMessageDialog.setObject(t);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.OK_BUTTON,ZaServerController.changeProxyPorts,this,null);
var e;
if(!o||!o.func){
e=null
}else{
e=o
}
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
};
ZaServerController.prototype.saveButtonListener=function(t){
try{
this.validateChanges()
}
catch(e){
this._handleException(e,"ZaServerController.prototype.saveButtonListener",null,false)
}};
ZaServerController.prototype.downloadConfigButtonListener=function(e){
window.open(["/service/collectconfig/?host=",this._currentObject.attrs[ZaServer.A_ServiceHostname]].join(""))
};
ZaServerController.prototype.flushCacheButtonListener=function(o){
try{
srvList=[];
srvList._version=1;
var e=this._currentObject;
e.status=0;
srvList.push(e);
obj={
statusMessage:null,flushZimlet:true,flushSkin:true,flushLocale:true,serverList:srvList,status:0,_uuid:e.id,name:e.name};
ZaApp.getInstance().dialogs.flushCacheDialog=new ZaFlushCacheXDialog(this._container,e);
ZaApp.getInstance().dialogs.flushCacheDialog.setObject(obj);
ZaApp.getInstance().dialogs.flushCacheDialog.popup()
}
catch(t){
this._handleException(t,"ZaServerController.prototype.flushCacheButtonListener",null,false)
}
return
}
}
if(AjxPackage.define("zimbraAdmin.adminext.controller.ZaAdminExtListController")){
ZaAdminExtListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaAdminExtListController");
this._popupOperations=new Array();
this.objType=ZaEvent.S_ZIMLET;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"admin_console_misc/enhancing_the_zimbra_admin_console_user_interface.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpAdminExtensions
};
ZaAdminExtListController.prototype=new ZaListViewController();
ZaAdminExtListController.prototype.constructor=ZaAdminExtListController;
ZaController.initPopupMenuMethods.ZaAdminExtListController=new Array();
ZaController.changeActionsStateMethods.ZaAdminExtListController=new Array();
ZaAdminExtListController.prototype.show=function(t,e){
if(!this._UICreated){
this._createUI()
}
if(t!=null&&t instanceof ZaItemList){
this._list=t
}else{
this._list=ZaZimlet.getAll(ZaZimlet.EXCLUDE_MAIL,new AjxCallback(this,this.show));
return
}
this._contentView.set(this._list.getVector());
ZaApp.getInstance().pushView(this.getContentViewId());
this._removeList=new Array();
this.changeActionsState()
};
ZaAdminExtListController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.DEPLOY_ZIMLET]=new ZaOperation(ZaOperation.DEPLOY_ZIMLET,ZaMsg.TBB_DeployNew,ZaMsg.TBB_DeployNew_tt,"Deploy","Deploy",new AjxListener(this,this.deployZimletListener));
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Undeploy,ZaMsg.DTBB_Undeploy_tt,"Undeploy","Undeploy",new AjxListener(this,this._undeployButtonListener));
this._popupOrder.push(ZaOperation.DEPLOY_ZIMLET);
this._popupOrder.push(ZaOperation.DELETE)
};
ZaController.initPopupMenuMethods.ZaAdminExtListController.push(ZaAdminExtListController.initPopupMenuMethod);
ZaAdminExtListController.prototype.deployZimletListener=function(o){
try{
this._deployZimletWizard=new ZaZimletDeployXWizard(this._container);
var e=new ZaZimlet();
this._deployZimletWizard.setObject(e);
this._deployZimletWizard.popup()
}
catch(t){
this._handleException(t,"ZaAdminExtListController.prototype.deployZimletListener",null,false)
}
return
};
ZaAdminExtListController.prototype._createUI=function(){
try{
var t=new Object();
this._contentView=new ZaAdminExtListView(this._container);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_AELIST,ZaId.MENU_POP);
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._removeConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_AELIST+"_removeConfirm");
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
catch(e){
this._handleException(e,"ZaAdminExtListController.prototype._createUI",null,false);
return
}};
ZaAdminExtListController.prototype.set=function(e){
this.show(e)
};
ZaAdminExtListController.prototype._listSelectionListener=function(t){
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
if(t.item){
this._selectedItem=t.item;
ZaApp.getInstance().getZimletController().show(t.item);
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_adminZimlets]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.item.name,null,false,false,t.item)
}}else{
this.changeActionsState()
}};
ZaAdminExtListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaAdminExtListController.prototype._editButtonListener=function(e){};
ZaAdminExtListController.prototype._undeployButtonListener=function(r){
this._removeList=new Array();
if(this._contentView.getSelectionCount()>0){
var s=this._contentView.getSelection();
var n=s.length;
for(var o=0;
o<n;
o++){
if(s[o]){
this._removeList.push(s[o])
}}}
if(this._removeList.length){
var t;
t=ZaMsg.Q_UNDEPLOY_ADMIN_EXTENSIONS;
t+="<br>";
for(var o in this._removeList){
if(i>19){
t+="<li>...</li>";
break
}
t+="<li>";
if(this._removeList[o].name.length>50){
var e=49;
var h=0;
while(e<this._removeList[o].name.length){
t+=this._removeList[o].name.slice(h,e);
h=e+1;
if(h>=(this._removeList[o].name.length)){
break
}
e=(this._removeList[o].name.length<=(e+50))?this._removeList[o].name.length-1:(e+50);
t+="<br>"
}}else{
t+=this._removeList[o].name
}
t+="</li>";
i++
}
t+="</ul>";
this._removeConfirmMessageDialog.setMessage(t,DwtMessageDialog.INFO_STYLE);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaAdminExtListController.prototype._undeployZimletsCallback,this);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,ZaAdminExtListController.prototype._donotUndeployZimletsCallback,this);
this._removeConfirmMessageDialog.popup()
}};
ZaAdminExtListController.prototype._undeployZimletsCallback=function(){
var o=new Array();
for(var t in this._removeList){
if(this._removeList[t]){
try{
this._removeList[t].remove();
o.push(this._removeList[t])
}
catch(e){
this._removeConfirmMessageDialog.popdown();
this._handleException(e,"ZaAdminExtListController.prototype._undeployZimletsCallback",null,false);
return
}}
this._list.remove(this._removeList[t])
}
this.fireRemovalEvent(o);
this._removeConfirmMessageDialog.popdown();
this._contentView.setUI();
this.show()
};
ZaAdminExtListController.prototype._donotUndeployZimletsCallback=function(){
this._removeList=new Array();
this._removeConfirmMessageDialog.popdown()
};
ZaAdminExtListController.changeActionsStateMethod=function(){
var o=this._contentView.getSelectionCount();
if(o==1){
var n=this._contentView.getSelection();
if(n[0].attrs[ZaZimlet.A_zimbraAdminExtDisableUIUndeploy]&&n[0].attrs[ZaZimlet.A_zimbraAdminExtDisableUIUndeploy]=="TRUE"){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}else{
if(o>1){
var n=this._contentView.getSelection();
var o=n.length;
var t=false;
for(var e=0;
e<o;
e++){
if(!t){
if(n[e].attrs[ZaZimlet.A_zimbraAdminExtDisableUIUndeploy]&&n[e].attrs[ZaZimlet.A_zimbraAdminExtDisableUIUndeploy]=="TRUE"){
t=true
}}
if(t){
break
}}
if(t){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}else{
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}};
ZaController.changeActionsStateMethods.ZaAdminExtListController.push(ZaAdminExtListController.changeActionsStateMethod)
}
if(AjxPackage.define("zimbraAdmin.zimlets.controller.ZaZimletListController")){
ZaZimletListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaZimletListController");
this._toolbarOperations=new Array();
this._popupOperations=new Array();
this.objType=ZaEvent.S_ZIMLET;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"zimlets/about_zimlets.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageZimlets
};
ZaZimletListController.prototype=new ZaListViewController();
ZaZimletListController.prototype.constructor=ZaZimletListController;
ZaController.initPopupMenuMethods.ZaZimletListController=new Array();
ZaController.changeActionsStateMethods.ZaZimletListController=new Array();
ZaZimletListController.prototype.show=function(t,e){
if(!this._UICreated){
this._createUI()
}
if(t!=null&&t instanceof ZaItemList){
this._list=t
}else{
this._list=ZaZimlet.getAll(ZaZimlet.EXCLUDE_EXTENSIONS,new AjxCallback(this,this.show));
return
}
this._contentView.set(this._list.getVector());
ZaApp.getInstance().pushView(this.getContentViewId());
this._removeList=new Array();
this.changeActionsState()
};
ZaZimletListController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.DEPLOY_ZIMLET]=new ZaOperation(ZaOperation.DEPLOY_ZIMLET,ZaMsg.TBB_DeployNew,ZaMsg.TBB_DeployNew_tt,"Deploy","Deploy",new AjxListener(this,this.deployZimletListener));
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Undeploy,ZaMsg.DTBB_Undeploy_tt,"Undeploy","Undeploy",new AjxListener(this,this._undeployButtonListener));
this._popupOperations[ZaOperation.TOGGLE]=new ZaOperation(ZaOperation.TOGGLE,ZaMsg.TBB_Toggle,ZaMsg.TBB_Toggle_tt,"ToggleStatus","ToggleStatus",new AjxListener(this,this._toggleButtonListener));
this._popupOrder.push(ZaOperation.DEPLOY_ZIMLET);
this._popupOrder.push(ZaOperation.DELETE);
this._popupOrder.push(ZaOperation.TOGGLE)
};
ZaController.initPopupMenuMethods.ZaZimletListController.push(ZaZimletListController.initPopupMenuMethod);
ZaZimletListController.prototype._toggleButtonListener=function(s){
try{
var n=this._contentView.getSelection();
var o=n.length;
for(var t=0;
t<o;
t++){
if(n[t]){
n[t].enable(!n[t].isEnabled(),new AjxCallback(this,this.fireChangeEvent,n[t]))
}}}
catch(e){
this._handleException(e,"ZaZimletListController.prototype._toggleZimletListener",null,false)
}
return
};
ZaZimletListController.prototype.deployZimletListener=function(o){
try{
this._deployZimletWizard=new ZaZimletDeployXWizard(this._container);
var e=new ZaZimlet();
this._deployZimletWizard.setObject(e);
this._deployZimletWizard.popup()
}
catch(t){
this._handleException(t,"ZaZimletListController.prototype.deployZimletListener",null,false)
}
return
};
ZaZimletListController.prototype._createUI=function(){
try{
var t=new Object();
this._contentView=new ZaZimletListView(this._container);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_ZIMLIST,ZaId.MENU_POP);
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._removeConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_ZIMLIST+"_removeConfirm");
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
catch(e){
this._handleException(e,"ZaZimletListController.prototype._createUI",null,false);
return
}};
ZaZimletListController.prototype.set=function(e){
this.show(e)
};
ZaZimletListController.prototype._listSelectionListener=function(t){
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
if(t.item){
this._selectedItem=t.item;
ZaApp.getInstance().getZimletController().show(t.item);
var e=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_zimlets]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(e,t.item.name,null,false,false,t.item)
}}else{
this.changeActionsState()
}};
ZaZimletListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaZimletListController.prototype._editButtonListener=function(e){};
ZaZimletListController.prototype._undeployButtonListener=function(r){
this._removeList=new Array();
if(this._contentView.getSelectionCount()>0){
var s=this._contentView.getSelection();
var n=s.length;
for(var o=0;
o<n;
o++){
if(s[o]){
this._removeList.push(s[o])
}}}
if(this._removeList.length){
var t;
t=ZaMsg.Q_UNDEPLOY_ZIMLETS;
t+="<br>";
for(var o in this._removeList){
if(i>19){
t+="<li>...</li>";
break
}
t+="<li>";
if(this._removeList[o].name.length>50){
var e=49;
var h=0;
while(e<this._removeList[o].name.length){
t+=this._removeList[o].name.slice(h,e);
h=e+1;
if(h>=(this._removeList[o].name.length)){
break
}
e=(this._removeList[o].name.length<=(e+50))?this._removeList[o].name.length-1:(e+50);
t+="<br>"
}}else{
t+=this._removeList[o].name
}
t+="</li>";
i++
}
t+="</ul>";
this._removeConfirmMessageDialog.setMessage(t,DwtMessageDialog.INFO_STYLE);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaZimletListController.prototype._undeployZimletsCallback,this);
this._removeConfirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,ZaZimletListController.prototype._donotUndeployZimletsCallback,this);
this._removeConfirmMessageDialog.popup()
}};
ZaZimletListController.prototype._undeployZimletsCallback=function(){
var o=new Array();
for(var t in this._removeList){
if(this._removeList[t]){
try{
this._removeList[t].remove();
o.push(this._removeList[t])
}
catch(e){
this._removeConfirmMessageDialog.popdown();
this._handleException(e,"ZaZimletListController.prototype._undeployZimletsCallback",null,false);
return
}}
this._list.remove(this._removeList[t])
}
this.fireRemovalEvent(o);
this._removeConfirmMessageDialog.popdown();
this._contentView.setUI();
this.show()
};
ZaZimletListController.prototype._donotUndeployZimletsCallback=function(){
this._removeList=new Array();
this._removeConfirmMessageDialog.popdown()
};
ZaZimletListController.changeActionsStateMethod=function(){
var t=this._contentView.getSelectionCount();
var o=[];
var e=[];
if(t<1){
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}
if(this._popupOperations[ZaOperation.TOGGLE]){
this._popupOperations[ZaOperation.TOGGLE].enabled=false
}}};
ZaController.changeActionsStateMethods.ZaZimletListController.push(ZaZimletListController.changeActionsStateMethod)
}
if(AjxPackage.define("zimbraAdmin.zimlets.controller.ZaZimletViewController")){
ZaZimletViewController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaZimletViewController");
this._UICreated=false;
this.objType=ZaEvent.S_ZIMLET;
this._helpURL=ZaAccountViewController.helpURL;
this.deleteMsg=ZaMsg.Q_DELETE_ACCOUNT;
this.tabConstructor=ZaZimletXFormView
};
ZaZimletViewController.prototype=new ZaXFormViewController();
ZaZimletViewController.prototype.constructor=ZaZimletViewController;
ZaZimletViewController.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/provisioning_accounts.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaController.initToolbarMethods.ZaZimletViewController=new Array();
ZaController.setViewMethods.ZaZimletViewController=new Array();
ZaController.initPopupMenuMethods.ZaZimletViewController=new Array();
ZaZimletViewController.prototype.show=function(t,e){
if(!this.selectExistingTabByItemId(t.id)){
this._setView(t,true)
}};
ZaZimletViewController.setViewMethod=function(e){
e.load("name",e.name);
if(!this._UICreated){
this._createUI()
}
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setDirty(false);
e[ZaModel.currentTab]="1";
this._view.setObject(e);
this._currentObject=e
};
ZaController.setViewMethods.ZaZimletViewController.push(ZaZimletViewController.setViewMethod);
ZaZimletViewController.prototype._createUI=function(){
this._contentView=this._view=new this.tabConstructor(this._container);
this._initPopupMenu();
var e=new Object();
e[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),e);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaZimletViewController.prototype.getAppBarAction=function(){
if(AjxUtil.isEmpty(this._appbarOperation)){
this._appbarOperation[ZaOperation.HELP]=new ZaOperation(ZaOperation.HELP,ZaMsg.TBB_Help,ZaMsg.TBB_Help_tt,"Help","Help",new AjxListener(this,this._helpButtonListener));
this._appbarOperation[ZaOperation.CLOSE]=new ZaOperation(ZaOperation.CLOSE,ZaMsg.TBB_Close,ZaMsg.ALTBB_Close_tt,"","",new AjxListener(this,this.closeButtonListener))
}
return this._appbarOperation
};
ZaZimletViewController.prototype.getAppBarOrder=function(){
if(AjxUtil.isEmpty(this._appbarOrder)){
this._appbarOrder.push(ZaOperation.HELP);
this._appbarOrder.push(ZaOperation.CLOSE)
}
return this._appbarOrder
};
ZaZimletViewController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.CLOSE]=new ZaOperation(ZaOperation.CLOSE,ZaMsg.TBB_Close,ZaMsg.DTBB_Close_tt,"Close","CloseDis",new AjxListener(this,this.closeButtonListener));
this._popupOrder.push(ZaOperation.CLOSE)
};
ZaController.initPopupMenuMethods.ZaZimletViewController.push(ZaZimletViewController.initPopupMenuMethod)
}
if(AjxPackage.define("zimbraAdmin.domains.controller.ZaDomainController")){
ZaDomainController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaDomainController");
this._UICreated=false;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/managing_domains.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpEditDomains;
this._toolbarOperations=new Array();
this.deleteMsg=ZaMsg.Q_DELETE_DOMAIN;
this.objType=ZaEvent.S_DOMAIN;
this.tabConstructor=ZaDomainXFormView
};
ZaDomainController.prototype=new ZaXFormViewController();
ZaDomainController.prototype.constructor=ZaDomainController;
ZaController.changeActionsStateMethods.ZaDomainController=new Array();
ZaController.initToolbarMethods.ZaDomainController=new Array();
ZaController.initPopupMenuMethods.ZaDomainController=new Array();
ZaController.setViewMethods.ZaDomainController=new Array();
ZaController.saveChangeCheckMethods.ZaDomainController=new Array();
ZaController.postChangeMethods.ZaDomainController=new Array();
ZaDomainController.prototype.show=function(e){
if(!this.selectExistingTabByItemId(e.id)){
this._setView(e,true)
}};
ZaDomainController.changeActionsStateMethod=function(){
var e=(this._view&&this._view.isDirty());
if(this._popupOperations[ZaOperation.SAVE]){
this._popupOperations[ZaOperation.SAVE].enabled=e
}};
ZaController.changeActionsStateMethods.ZaDomainController.push(ZaDomainController.changeActionsStateMethod);
ZaDomainController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.DTBB_Save_tt,"Save","SaveDis",new AjxListener(this,this.saveButtonListener));
if(ZaZimbraAdmin.canCreateDomain()){
this._popupOperations[ZaOperation.NEW]=new ZaOperation(ZaOperation.NEW,ZaMsg.TBB_New,ZaMsg.DTBB_New_tt,"Domain","DomainDis",new AjxListener(this,this._newButtonListener))
}
this._popupOperations[ZaOperation.VIEW_DOMAIN_ACCOUNTS]=new ZaOperation(ZaOperation.VIEW_DOMAIN_ACCOUNTS,ZaMsg.Domain_view_accounts,ZaMsg.Domain_view_accounts_tt,"Search","SearchDis",new AjxListener(this,this.viewAccountsButtonListener));
if(ZaDomain.canConfigureGal(this._currentObject)){
this._popupOperations[ZaOperation.GAL_WIZARD]=new ZaOperation(ZaOperation.GAL_WIZARD,ZaMsg.DTBB_GAlConfigWiz,ZaMsg.DTBB_GAlConfigWiz_tt,"GALWizard","GALWizardDis",new AjxListener(this,ZaDomainController.prototype._galWizButtonListener))
}
if(ZaDomain.canConfigureAuth(this._currentObject)){
this._popupOperations[ZaOperation.AUTH_WIZARD]=new ZaOperation(ZaOperation.AUTH_WIZARD,ZaMsg.DTBB_AuthConfigWiz,ZaMsg.DTBB_AuthConfigWiz_tt,"AuthWizard","AuthWizardDis",new AjxListener(this,ZaDomainController.prototype._authWizButtonListener))
}
if(ZaItem.hasRight(ZaDomain.RIGHT_CHECK_MX_RECORD,this._currentObject)){
this._popupOperations[ZaOperation.CHECK_MX_RECORD]=new ZaOperation(ZaOperation.CHECK_MX_RECORD,ZaMsg.DTBB_CheckMX,ZaMsg.DTBB_CheckMX_tt,"ReindexMailboxes","ReindexMailboxes",new AjxListener(this,ZaDomainController.prototype._checkMXButtonListener))
}};
ZaController.initPopupMenuMethods.ZaDomainController.push(ZaDomainController.initPopupMenuMethod);
ZaDomainController.setViewMethod=function(e){
e.load("id",e.id,false,true);
this._currentObject=e;
this._createUI(e);
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setDirty(false);
this._view.setObject(e)
};
ZaController.setViewMethods.ZaDomainController.push(ZaDomainController.setViewMethod);
ZaDomainController.prototype._createUI=function(e){
this._contentView=this._view=new this.tabConstructor(this._container,e);
this._initPopupMenu();
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaDomainController.prototype._saveChanges=function(){
var w=this._view.getObject();
if(w.attrs==null){
this._errorDialog.setMessage(ZaMsg.ERROR_UNKNOWN,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}
var s=new Object();
var g=false;
var b=false;
var l=false;
var t=false;
this._currentObject.mods=s;
if(!(AjxUtil.isEmpty(w[ZaAccount.A_zimbraMailCatchAllAddress])&&AjxUtil.isEmpty(this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress]))&&(w[ZaAccount.A_zimbraMailCatchAllAddress]!=this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress])){
l=true
}
if(ZaController.saveChangeCheckMethods.ZaDomainController){
var p=ZaController.saveChangeCheckMethods.ZaDomainController;
var u=p.length;
for(var m=0;
m<u&&!g;
m++){
if(typeof(p[m])=="function"){
g=p[m].call(this,s,w,this._currentObject)
}}}
for(var y in w.attrs){
if(y==ZaItem.A_zimbraId||y==ZaDomain.A_domainName||y==ZaDomain.A_domainType||y==ZaItem.A_zimbraACE){
continue
}
if(!ZaItem.hasWritePermission(y,w)){
continue
}
if(!(AjxUtil.isEmpty(this._currentObject.attrs[y])&&AjxUtil.isEmpty(w.attrs[y]))){
if(w.attrs[y] instanceof Array){
if(!(this._currentObject.attrs[y] instanceof Array)||(this._currentObject.attrs[y]&&w.attrs[y]&&w.attrs[y].join(",").valueOf()!=this._currentObject.attrs[y].join(",").valueOf())||(this._currentObject.attrs[y]==null&&w.attrs[y]!=null)||(this._currentObject.attrs[y]!=null&&(w.attrs[y]==null||w.attrs[y].length==0))){
s[y]=w.attrs[y];
g=true
}}else{
if(w.attrs[y]!=this._currentObject.attrs[y]){
s[y]=w.attrs[y];
g=true;
if(y==ZaDomain.A_zimbraSkinForegroundColor||y==ZaDomain.A_zimbraSkinBackgroundColor||y==ZaDomain.A_zimbraSkinSecondaryColor||y==ZaDomain.A_zimbraSkinSelectionColor||y==ZaDomain.A_zimbraSkinLogoURL||y==ZaDomain.A_zimbraSkinLogoLoginBanner||y==ZaDomain.A_zimbraSkinLogoAppBanner){
t=true
}}}}}
if(!this.checkCertKeyValid(w.attrs[ZaDomain.A_zimbraSSLCertificate],w.attrs[ZaDomain.A_zimbraSSLPrivateKey])){
return false
}
if(w.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]){
var e=AjxStringUtil.htmlEncode(w.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]);
var r=true;
var c=null;
if(e&&e instanceof Array){
for(var m=0;
m<e.length&&r;
m++){
if(e[m].indexOf("@")==-1){
r=false;
c=e[m]
}}}else{
if(e){
if(e.indexOf("@")==-1){
r=false;
c=e
}}}
if(!r){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_MSG_EmailValidReg,c),null,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup();
return r
}}
if(!g){
if(w[ZaDomain.A2_gal_sync_accounts]&&w[ZaDomain.A2_gal_sync_accounts][0]){
if(w[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds]&&w[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs&&this._currentObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds]&&this._currentObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs){
if(this._currentObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]!=w[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]){
g=true
}}}}
if(!g){
if(w[ZaDomain.A2_gal_sync_accounts]&&w[ZaDomain.A2_gal_sync_accounts][0]){
if(w[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds]&&w[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs&&this._currentObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds]&&this._currentObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs){
if(this._currentObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]!=w[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]){
g=true
}}}}
if(g||l){
try{
if(b){
var o=new ZaAccount();
o.load(ZaAccount.A_name,this._currentObject.attrs[ZaDomain.A_zimbraNotebookAccount]);
o.rename(w.attrs[ZaDomain.A_zimbraNotebookAccount])
}
if(l){
if(!AjxUtil.isEmpty(this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress])&&!AjxUtil.isEmpty(this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress].id)){
ZaAccount.modifyCatchAll(this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress].id,"")
}else{
if(this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress]&&ZaItem.ID_PATTERN.test(this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress])){
ZaAccount.modifyCatchAll(this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress],"")
}}
if(!AjxUtil.isEmpty(w[ZaAccount.A_zimbraMailCatchAllAddress])&&!AjxUtil.isEmpty(w[ZaAccount.A_zimbraMailCatchAllAddress].id)){
ZaAccount.modifyCatchAll(w[ZaAccount.A_zimbraMailCatchAllAddress].id,this._currentObject.attrs[ZaDomain.A_domainName])
}else{
if(w[ZaAccount.A_zimbraMailCatchAllAddress]&&ZaItem.ID_PATTERN.test(w[ZaAccount.A_zimbraMailCatchAllAddress])){
ZaAccount.modifyCatchAll(w[ZaAccount.A_zimbraMailCatchAllAddress],this._currentObject.attrs[ZaDomain.A_domainName])
}}
if(!AjxUtil.isEmpty(w[ZaAccount.A_zimbraMailCatchAllAddress])&&!AjxUtil.isEmpty(w[ZaAccount.A_zimbraMailCatchAllAddress].id)){
this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress]=w[ZaAccount.A_zimbraMailCatchAllAddress]
}else{
if(!AjxUtil.isEmpty(w[ZaAccount.A_zimbraMailCatchAllAddress])&&ZaItem.ID_PATTERN.test(w[ZaAccount.A_zimbraMailCatchAllAddress])){
var h=new ZaAccount(ZaApp.getInstance());
h.load("id",w[ZaAccount.A_zimbraMailCatchAllAddress],false,true);
this._currentObject[ZaAccount.A_zimbraMailCatchAllAddress]=h
}}}
if(g){
try{
this._currentObject.modify(s,w)
}
catch(f){
this._handleException(f,"ZaAccountViewController.prototype._saveChanges",null,false);
return false
}}
if(t){
try{
var d=ZaApp.getInstance().getMailServers();
var n=[];
var u=d.length;
for(var m=0;
m<u;
m++){
if(ZaItem.hasRight(ZaServer.FLUSH_CACHE_RIGHT,d[m])){
n.push(d[m])
}}
if(n.length>0){
ZaApp.getInstance().dialogs.confirmMessageDialog2.setMessage(ZaMsg.Domain_flush_cache_q,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.YES_BUTTON,this.openFlushCacheDlg,this,[n]);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.NO_BUTTON,this.closeCnfrmDelDlg,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog2.popup()
}}
catch(f){
if(f.code==ZmCsfeException.SVC_PERM_DENIED){
return
}else{
throw (f)
}}}
if(this._currentObject[ZaModel.currentTab]!=w[ZaModel.currentTab]){
this._currentObject[ZaModel.currentTab]=w[ZaModel.currentTab]
}
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.DomainModified,[this._currentObject.name]));
return true
}
catch(f){
this._handleException(f,"ZaDomainController.prototype._saveChanges")
}}else{
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.DomainModified,[this._currentObject.name]));
return true
}};
ZaDomainController.prototype.openFlushCacheDlg=function(e){
ZaApp.getInstance().dialogs.confirmMessageDialog2.popdown();
e._version=1;
var o=[];
for(var t=0;
t<e.length;
t++){
e[t]["status"]=0;
o.push(e[t].id)
}
obj={
statusMessage:null,flushZimlet:false,flushSkin:true,flushLocale:false,serverList:e,status:0,_uuid:(o.length>1?o.join("__"):o[0]),name:(o.length>1?ZaMsg.multiple_servers:e[0].name)};
ZaApp.getInstance().dialogs.flushCacheDialog=new ZaFlushCacheXDialog(this._container,{
id:(o.length>1?o.join("__"):o[0]),name:(o.length>1?ZaMsg.multiple_servers:e[0].name)}
);
ZaApp.getInstance().dialogs.flushCacheDialog.setObject(obj);
ZaApp.getInstance().dialogs.flushCacheDialog.popup()
};
ZaDomainController.prototype.newDomain=function(){
var e="";
if(!this._currentDomainName){
this._currentDomainName=this._currentObject.attrs[ZaDomain.A_domainName]
}
if(this._currentDomainName){
e="."+this._currentDomainName
}
this._currentObject=new ZaDomain();
this._currentObject.getAttrs={
all:true};
this._currentObject.loadNewObjectDefaults("name","foo"+e);
this._currentObject.attrs[ZaDomain.A_domainName]=e;
this._showNewDomainWizard()
};
ZaDomainController.prototype._showNewDomainWizard=function(){
try{
if(!ZaApp.getInstance().dialogs.newDomainWizard){
ZaApp.getInstance().dialogs.newDomainWizard=new ZaNewDomainXWizard(this._container,this._currentObject)
}
this._newDomainWizard=ZaApp.getInstance().dialogs.newDomainWizard;
this._newDomainWizard.registerCallback(DwtWizardDialog.FINISH_BUTTON,ZaDomainController.prototype._finishNewButtonListener,this,null);
this._newDomainWizard.setObject(this._currentObject);
this._newDomainWizard.popup()
}
catch(e){
this._handleException(e,"ZaDomainController.prototype._showNewDomainWizard",null,false)
}};
ZaDomainController.prototype._newButtonListener=function(t){
if(this._view.isDirty()){
var e=new Object();
e.params=null;
e.obj=ZaApp.getInstance().getDomainController();
e.func=ZaDomainController.prototype.newDomain;
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_SAVE_CHANGES,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.saveAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.discardAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.newDomain()
}};
ZaDomainController.prototype.viewAccountsButtonListener=function(t){
var e=this._view.getObject().name;
ZaDomain.searchAccountsInDomain(e)
};
ZaDomainController.prototype._galWizButtonListener=function(t){
try{
this._galWizard=ZaApp.getInstance().dialogs.galWizard=new ZaGALConfigXWizard(this._container,this._currentObject);
this._currentObject._extid=ZaUtil.getItemUUid();
this._currentObject._editObject=this._currentObject;
this._galWizard.setObject(this._currentObject);
this._galWizard.popup()
}
catch(e){
this._handleException(e,"ZaDomainController.prototype._showGalWizard",null,false)
}};
ZaDomainController.prototype._authWizButtonListener=function(t){
try{
if(!this._authWizard){
this._authWizard=ZaApp.getInstance().dialogs.authWizard=new ZaTaskAuthConfigWizard(this._container);
this._currentObject._extid=ZaUtil.getItemUUid();
this._currentObject._editObject=this._currentObject
}
this._authWizard.setObject(this._currentObject);
this._authWizard.popup()
}
catch(e){
this._handleException(e,"ZaDomainController.prototype._showAuthWizard",null,false)
}};
ZaDomainController.prototype._autoProvWizButtonListener=function(t){
try{
if(!this._autoProvWizard){
if(ZaApp.getInstance().dialogs.autoProvWizard){
this._autoProvWizard=ZaApp.getInstance().dialogs.autoProvWizard
}else{
this._autoProvWizard=ZaApp.getInstance().dialogs.autoProvWizard=new ZaTaskAutoProvDialog(this._container,ZaMsg.NAD_AutoProvConfigTitle)
}}
this._currentObject._extid=ZaUtil.getItemUUid();
this._currentObject._editObject=this._currentObject;
this._autoProvWizard.registerCallback(DwtDialog.OK_BUTTON,ZaTaskAutoProvDialog.prototype.finishWizard,this._autoProvWizard,null);
this._currentObject.currentTab="1";
this._autoProvWizard.setObject(this._currentObject);
this._autoProvWizard.popup()
}
catch(e){
this._handleException(e,"ZaDomainController.prototype._autoProvWizButtonListener",null,false)
}};
ZaDomainController.prototype._finishGalButtonListener=function(t){
try{
ZaDomain.modifyGalSettings.call(this._currentObject,this._galWizard.getObject());
this.fireChangeEvent(this._currentObject);
this._view.setObject(this._currentObject);
this._galWizard.popdown()
}
catch(e){
this._handleException(e,"ZaDomainController.prototype._finishGalButtonListener",null,false)
}
return
};
ZaDomainController.prototype._notifyAllOpenTabs=function(){
var o="<br><ul>";
var t=false;
for(var s=0;
s<ZaAppTabGroup._TABS.size();
s++){
var r=ZaAppTabGroup._TABS.get(s);
var n=r.getAppView();
if(n&&n._containedObject&&n._containedObject.name){
var c=n._containedObject.name;
var e=c.indexOf("@");
var h=null;
if(e>0){
h=c.substring(e+1)
}
if(h!=null&&h==this._currentObject.attrs[ZaDomain.A_domainName]){
o+="<li>"+c+"</li>";
t=true
}}}
o+="</ul></br>";
if(t){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.WARN_CHANGE_AUTH_METH+o)
}};
ZaDomainController.prototype._finishAuthButtonListener=function(t){
try{
ZaDomain.modifyAuthSettings.call(this._currentObject,this._authWizard.getObject());
this.fireChangeEvent(this._currentObject);
this._view.setObject(this._currentObject);
this._authWizard.popdown();
this._notifyAllOpenTabs()
}
catch(e){
this._handleException(e,"ZaDomainController.prototype._finishAuthButtonListener",null,false)
}
return
};
ZaDomainController.prototype._finishAutoProvButtonListener=function(t){
try{
if(!this._autoProvWizard._checkGeneralConfig()||!this._autoProvWizard._checkEagerConfig()||!this._autoProvWizard._checkLazyConfig()){
return
}
var o=this._autoProvWizard.getObject();
this._autoProvWizard._combineConfigureValues(o);
ZaDomain.modifyAutoPovSettings.call(this._currentObject,o);
this._view.setObject(this._currentObject);
this._autoProvWizard.popdown();
this._notifyAllOpenTabs()
}
catch(e){
this._handleException(e,"ZaDomainController.prototype._finishAutoProvButtonListener",null,false)
}
return
};
ZaDomainController.prototype._finishNewButtonListener=function(t){
try{
var n=this._newDomainWizard.getObject();
var o=ZaItem.create(n,ZaDomain,"ZaDomain");
o.load("id",o.id,false,true);
if(o!=null){
this.fireCreationEvent(o);
if(o.rights&&o.rights[ZaDomain.RIGHT_DELETE_DOMAIN]){
if(this._toolbar&&this._toolbar.getButton(ZaOperation.DELETE)){
this._toolbar.getButton(ZaOperation.DELETE).setEnabled(true)
}}
this._newDomainWizard.popdown()
}}
catch(e){
if(e.code==ZmCsfeException.DOMAIN_EXISTS){
this.popupErrorDialog(ZaMsg.ERROR_DOMAIN_EXISTS,e)
}else{
this._handleException(e,"ZaDomainController.prototype._finishNewButtonListener",null,false)
}}
return
};
ZaDomainController.prototype._checkMXButtonListener=function(e){
var t=new AjxCallback(this,this.checkMXCallback);
ZaDomain.checkDomainMXRecord(this._currentObject,t)
};
ZaDomainController.prototype.checkMXCallback=function(s){
if(!s){
return
}
if(s.isException()){
this.popupErrorDialog(AjxMessageFormat.format(ZaMsg.failedToGetMXRecords,[this._currentObject.name]));
return
}
var t=s.getResponse().Body.CheckDomainMXRecordResponse;
if(t.code[0]._content=="Ok"){
this.popupMsgDialog(ZaMsg.MX_RecordCheckSuccess)
}else{
var e=[];
e.push(ZaMsg.foundTheseMXRecords);
if(t.entry&&t.entry.length>0){
var n=t.entry.length;
for(var o=0;
o<n;
o++){
e.push(t.entry[o]._content)
}}
this._errorDialog.setMessage(t.message[0]._content,e.join("<br/>"),DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup()
}};
ZaDomainController.prototype._handleException=function(e,s,n,t,o){
if(e.code==ZmCsfeException.DOMAIN_NOT_EMPTY){
this.popupErrorDialog(ZaMsg.ERROR_DOMAIN_NOT_EMPTY)
}else{
if(e.code==ZmCsfeException.DOMAIN_EXISTS){
this.popupErrorDialog(ZaMsg.ERROR_DOMAIN_EXISTS)
}else{
ZaController.prototype._handleException.call(this,e,s,n,t,o)
}}};
ZaDomainController.prototype.checkCertKeyValid=function(o,t){
if(o&&t){
var n={
type:"comm",cert:o,prvkey:t};
resp=ZaCert.verifyCertKey(ZaApp.getInstance(),n);
if(!resp){
this._errorDialog.setMessage(ZaMsg.SERVER_ERROR,ZaMsg.ERROR_DOMAIN_CERT_VERIFY,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup();
return false
}
var e=resp.verifyResult;
if(e=="false"){
this._errorDialog.setMessage(ZaMsg.ERROR_DOMAIN_CERT_KEY_VERIFY,ZaMsg.ALERT_DOMAIN_CERT_KEY,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup();
return false
}else{
if(e=="invalid"){
this._errorDialog.setMessage(ZaMsg.ERROR_DOMAIN_CERT_KEY_INVALID,null,DwtMessageDialog.CRITICAL_STYLE,ZaMsg.zimbraAdminTitle);
this._errorDialog.popup();
return false
}else{
if(e=="true"){
return true
}else{
return false
}}}}else{
if(!o&&t){
this._errorDialog.setMessage(ZaMsg.ERROR_DOMAIN_CERT_MISSING,null,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup();
return false
}else{
if(o&&!t){
this._errorDialog.setMessage(ZaMsg.ERROR_DOMAIN_KEY_MISSING,null,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup();
return false
}}}
return true
};
ZaDomainController.prototype.handleDomainChange=function(o){
var e=ZaController.postChangeMethods.ZaDomainController;
for(var t in e){
var n=e[t];
if(typeof(n)=="function"){
n.call(this,o)
}}}
}
if(AjxPackage.define("zimbraAdmin.status.controller.ZaStatusViewController")){
ZaStatusViewController=function(t,e){
ZaController.call(this,t,e,"ZaStatusViewController");
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/monitoring_zimbra_collaboration_suite.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpEditDomains;
this._popupOperations=new Array();
this._UICreated=false
};
ZaStatusViewController.prototype=new ZaController();
ZaStatusViewController.prototype.constructor=ZaStatusViewController;
ZaController.initToolbarMethods.ZaStatusViewController=new Array();
ZaController.initPopupMenuMethods.ZaStatusViewController=new Array();
ZaStatusViewController.prototype.show=function(n){
try{
this._createUI(n);
var o=new ZaStatus();
o.load();
var s=o.getStatusVector();
this._contentView.set(s);
ZaApp.getInstance().pushView(this.getContentViewId());
var e=new Date()
}
catch(t){
this._handleException(t,"ZaStatusViewController.prototype.show",null,false);
return
}};
ZaStatusViewController.prototype.getAppBarAction=function(){
if(AjxUtil.isEmpty(this._appbarOperation)){
this._appbarOperation[ZaOperation.HELP]=new ZaOperation(ZaOperation.HELP,ZaMsg.TBB_Help,ZaMsg.TBB_Help_tt,"Help","Help",new AjxListener(this,this._helpButtonListener))
}
return this._appbarOperation
};
ZaStatusViewController.prototype.getAppBarOrder=function(){
if(AjxUtil.isEmpty(this._appbarOrder)){
this._appbarOrder.push(ZaOperation.HELP)
}
return this._appbarOrder
};
ZaStatusViewController.prototype._createUI=function(t){
try{
var o=new Object();
this._contentView=new ZaServicesListView(this._container);
this._initPopupMenu();
if(this._popupOperations&&this._popupOperations.length){
this._acctionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_STATUSLIST,ZaId.MENU_POP)
}
o[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),o);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
catch(e){
this._handleException(e,"ZaStatusViewController.prototype._createUI",null,false);
return
}};
ZaStatusViewController.prototype.refreshListener=function(){
this.show()
};
ZaStatusViewController.prototype._handleException=function(e,s,n,t,o){
if(e.code&&e.code==ZmCsfeException.SVC_AUTH_REQUIRED){
this.popupErrorDialog(ZaMsg.SERVER_ERROR,e)
}else{
ZaController.prototype._handleException.call(this,e,s,n,t,o)
}}
}
if(AjxPackage.define("zimbraAdmin.statistics.controller.ZaGlobalStatsController")){
ZaGlobalStatsController=function(t,e){
this._toolbarOperations=new Array();
this._toolbarOrder=new Array();
ZaController.call(this,t,e,"ZaGlobalStatsController");
this._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/checking_usage_statistics.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpCheckStatistics;
this.tabConstructor=ZaGlobalStatsView
};
ZaGlobalStatsController.prototype=new ZaController();
ZaGlobalStatsController.prototype.constructor=ZaGlobalStatsController;
ZaController.setViewMethods.ZaGlobalStatsController=[];
ZaGlobalStatsController.prototype.show=function(){
this._setView();
ZaApp.getInstance().pushView(this.getContentViewId());
var t=new Object();
try{
t[ZaModel.currentTab]="1";
this._contentView.setObject(t)
}
catch(e){
this._handleException(e,"ZaGlobalConfigViewController.prototype.show",null,false)
}
this._currentObject=t
};
ZaGlobalStatsController.setViewMethod=function(){
if(!this._contentView){
this._contentView=new this.tabConstructor(this._container);
var e=new Object();
e[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),e);
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}};
ZaController.setViewMethods.ZaGlobalStatsController.push(ZaGlobalStatsController.setViewMethod);
ZaGlobalStatsController.prototype.refreshListener=function(t){
var e=this._contentView._tabs[this._contentView._currentTabKey]["view"];
if(e&&e.showMe){
e.showMe(2)
}}
}
if(AjxPackage.define("zimbraAdmin.statistics.controller.ZaServerStatsController")){
ZaServerStatsController=function(t,e){
this._toolbarOperations=new Array();
this._toolbarOrder=new Array();
ZaController.call(this,t,e,"ZaServerStatsController");
this._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/checking_usage_statistics.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpCheckStatistics;
this.tabConstructor=ZaServerStatsView
};
ZaServerStatsController.prototype=new ZaController();
ZaServerStatsController.prototype.constructor=ZaServerStatsController;
ZaController.setViewMethods.ZaServerStatsController=[];
ZaServerStatsController.prototype.show=function(o,t,e){
if(!this.selectExistingTabByItemId(o.id)){
this._setView(o,t,e)
}};
ZaServerStatsController.setViewMethod=function(t,e){
if(!this._contentView){
this._view=this._contentView=new this.tabConstructor(this._container);
var o=new Object();
o[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),o);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
ZaApp.getInstance().pushView(this.getContentViewId());
this._contentView.setObject(t)
};
ZaController.setViewMethods.ZaServerStatsController.push(ZaServerStatsController.setViewMethod);
ZaServerStatsController.prototype._prevPageListener=function(n){
var r=this.getCurrentStatsView();
var t=this._contentView._mbxPage;
var s=this._contentView._sessionPage;
if(r==t){
var e=t._view;
var o=e.getInstance();
t.updateMbxLists(o,null,o.offset-ZaServerMBXStatsPage.MBX_DISPLAY_LIMIT,null,null)
}
if(r==s){
s._pageListener(true)
}};
ZaServerStatsController.prototype._nextPageListener=function(n){
var r=this.getCurrentStatsView();
var t=this._contentView._mbxPage;
var s=this._contentView._sessionPage;
if(r==t){
var e=t._view;
var o=e.getInstance();
t.updateMbxLists(o,null,o.offset+ZaServerMBXStatsPage.MBX_DISPLAY_LIMIT,null,null)
}
if(r==s){
s._pageListener()
}};
ZaServerStatsController.prototype.getCurrentStatsView=function(){
return this._contentView._tabs[this._contentView._currentTabKey].view
};
ZaServerStatsController.prototype.refreshListener=function(t){
var e=this._contentView._tabs[this._contentView._currentTabKey]["view"];
if(e&&e.showMe){
e.showMe(2)
}};
ZaServerStatsListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaServerStatsListController");
this._popupOperations=new Array();
this._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/checking_usage_statistics.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpCheckStatistics
};
ZaServerStatsListController.prototype=new ZaListViewController();
ZaServerStatsListController.prototype.constructor=ZaServerStatsListController;
ZaController.initPopupMenuMethods.ZaServerStatsListController=new Array();
ZaController.changeActionsStateMethods.ZaServerStatsListController=new Array();
ZaServerStatsListController.prototype.show=function(e){
if(!this._UICreated){
this._createUI()
}
if(e!=null){
this._contentView.set(e.getVector())
}
ZaApp.getInstance().pushView(this.getContentViewId());
if(e!=null){
this._list=e
}
this.changeActionsState()
};
ZaServerStatsListController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.VIEW]=new ZaOperation(ZaOperation.VIEW,ZaMsg.TBB_View,ZaMsg.PQTBB_View_tt,"Properties","PropertiesDis",new AjxListener(this,ZaServerStatsListController.prototype._viewButtonListener));
this._popupOperations[ZaOperation.VIEW].enabled=false
};
ZaController.initPopupMenuMethods.ZaServerStatsListController.push(ZaServerStatsListController.initPopupMenuMethod);
ZaServerStatsListController.prototype._createUI=function(){
try{
var t=new Object();
this._contentView=new ZaServerListView(this._container);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_SERLIST,ZaId.MENU_POP);
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
catch(e){
this._handleException(e,"ZaServerStatsListController.prototype._createUI",null,false)
}};
ZaServerStatsListController.prototype.set=function(e){
this.show(e)
};
ZaServerStatsListController.prototype.handleServerChange=function(t){
if(t){
var e=t.getDetails();
if(e){
if(this._list){
this._list.replace(e)
}
if(this._contentView){
this._contentView.setUI()
}
if(ZaApp.getInstance().getCurrentController()==this){
this.show()
}
this.changeActionsState()
}}};
ZaServerStatsListController.mappingId2handlerMap=null;
ZaServerStatsListController._getMapForMappingId2handler=function(){
if(!ZaServerStatsListController.mappingId2handlerMap){
ZaServerStatsListController.mappingId2handlerMap={
mainNode:{
mappingId:ZaZimbraAdmin._STATISTICS_BY_SERVER,handler:ZaOverviewPanelController.statsByServerTreeListener}
,tabNodes:{
mappingId:ZaZimbraAdmin._SERVER_STATISTICS_TAB_VIEW,handler:ZaOverviewPanelController.statsByServerTabTreeListener}}
}
return ZaServerStatsListController.mappingId2handlerMap
};
ZaServerStatsListController.parentPathInTree=null;
ZaServerStatsListController._getparentPathInTree=function(){
if(!ZaServerStatsListController.parentPathInTree){
ZaServerStatsListController.parentPathInTree=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_monitor,ZaMsg.OVP_statistics])
}
return ZaServerStatsListController.parentPathInTree
};
ZaServerStatsListController.prototype._listSelectionListener=function(t){
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
var e=t.item;
this._switchToSubItem(e)
}else{
this.changeActionsState()
}};
ZaServerStatsListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaServerStatsListController.prototype._viewButtonListener=function(t){
if(this._contentView.getSelectionCount()==1){
var e=this._contentView.getSelection()[0];
this._switchToSubItem(e)
}};
ZaServerStatsListController.prototype._switchToSubItem=function(o){
if(o){
this._selectedItem=o;
ZaApp.getInstance().getServerStatsController().show(o);
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController();
var t=ZaServerStatsListController._getparentPathInTree();
var n=ZaServerStatsListController._getMapForMappingId2handler();
e.addObjectItem(t,o.name,null,false,false,o,n)
}};
ZaServerStatsListController.changeActionsStateMethod=function(){
var e=this._contentView;
if(!e){
return
}
var t=(e.getSelectionCount()==1&&e.getSelection()[0]!=null);
if(this._popupOperations[ZaOperation.VIEW]){
this._popupOperations[ZaOperation.VIEW].enabled=t
}};
ZaController.changeActionsStateMethods.ZaServerStatsListController.push(ZaServerStatsListController.changeActionsStateMethod)
}
if(AjxPackage.define("zimbraAdmin.globalconfig.controller.ZaGlobalConfigViewController")){
ZaGlobalConfigViewController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaGlobalConfigViewController");
this._UICreated=false;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_global_settings/global_settings.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageGlobalSettings;
this.objType=ZaEvent.S_GLOBALCONFIG;
this.tabConstructor=GlobalConfigXFormView
};
ZaGlobalConfigViewController.prototype=new ZaXFormViewController();
ZaGlobalConfigViewController.prototype.constructor=ZaGlobalConfigViewController;
ZaController.initToolbarMethods.ZaGlobalConfigViewController=new Array();
ZaController.initPopupMenuMethods.ZaGlobalConfigViewController=new Array();
ZaController.setViewMethods.ZaGlobalConfigViewController=[];
ZaController.changeActionsStateMethods.ZaGlobalConfigViewController=[];
ZaXFormViewController.preSaveValidationMethods.ZaGlobalConfigViewController=new Array();
ZaController.saveChangeCheckMethods.ZaGlobalConfigViewController=new Array();
ZaGlobalConfigViewController.prototype.addSettingsChangeListener=function(e){
this._evtMgr.addListener(ZaEvent.E_MODIFY,e)
};
ZaGlobalConfigViewController.prototype.show=function(t,e){
this._setView(t,false)
};
ZaGlobalConfigViewController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.ALTBB_Save_tt,"Save","SaveDis",new AjxListener(this,this.saveButtonListener));
this._popupOperations[ZaOperation.DOWNLOAD_GLOBAL_CONFIG]=new ZaOperation(ZaOperation.DOWNLOAD_GLOBAL_CONFIG,ZaMsg.TBB_DownloadConfig,ZaMsg.GLOBTBB_DownloadConfig_tt,"DownloadGlobalConfig","DownloadGlobalConfig",new AjxListener(this,this.downloadConfigButtonListener))
};
ZaController.initPopupMenuMethods.ZaGlobalConfigViewController.push(ZaGlobalConfigViewController.initPopupMenuMethod);
ZaGlobalConfigViewController.setViewMethod=function(t){
try{
t.load()
}
catch(e){
this._handleException(e,"ZaGlobalConfigViewController.prototype.show",null,false)
}
if(!t[ZaModel.currentTab]){
t[ZaModel.currentTab]="1"
}
if(!this._UICreated){
this._createUI(t)
}
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setDirty(false);
this._view.setObject(t);
this._currentObject=t
};
ZaController.setViewMethods.ZaGlobalConfigViewController.push(ZaGlobalConfigViewController.setViewMethod);
ZaGlobalConfigViewController.prototype._createUI=function(e){
this._contentView=this._view=new this.tabConstructor(this._container,e);
this._initPopupMenu();
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaGlobalConfigViewController.prototype.setEnabled=function(e){
this._view.setEnabled(e)
};
ZaGlobalConfigViewController.changeActionsStateMethod=function(){
var e=(this._view&&this._view.isDirty());
if(this._popupOperations[ZaOperation.SAVE]){
this._popupOperations[ZaOperation.SAVE].enabled=e
}};
ZaController.changeActionsStateMethods.ZaGlobalConfigViewController.push(ZaGlobalConfigViewController.changeActionsStateMethod);
ZaGlobalConfigViewController.prototype.downloadConfigButtonListener=function(e){
window.open("/service/collectldapconfig/")
};
ZaGlobalConfigViewController.prototype._saveChanges=function(){
var B=this._view.getObject();
var h=false;
if(B.attrs==null){
this._errorDialog.setMessage(ZaMsg.ERROR_UNKNOWN,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}
if(ZaItem.hasWritePermission(ZaGlobalConfig.A_zimbraSmtpPort,B)){
if(!AjxUtil.isNonNegativeLong(B.attrs[ZaGlobalConfig.A_zimbraSmtpPort])){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.NAD_SmtpPort]),null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}}
if(ZaItem.hasWritePermission(ZaGlobalConfig.A_zimbraDefaultDomainName,B)){
if(B.attrs[ZaGlobalConfig.A_zimbraDefaultDomainName]){
if(B.attrs[ZaGlobalConfig.A_zimbraDefaultDomainName]!=this._currentObject.attrs[ZaGlobalConfig.A_zimbraDefaultDomainName]){
var I=new ZaDomain();
try{
I.load("name",B.attrs[ZaGlobalConfig.A_zimbraDefaultDomainName])
}
catch(D){
if(D.code==ZmCsfeException.NO_SUCH_DOMAIN){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_WRONG_DOMAIN_IN_GS,[B.attrs[ZaGlobalConfig.A_zimbraDefaultDomainName]]),null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}else{
throw (D)
}}}}}
if(ZaItem.hasWritePermission(ZaGlobalConfig.A_zimbraGalMaxResults,B)){
if(!AjxUtil.isNonNegativeLong(B.attrs[ZaGlobalConfig.A_zimbraGalMaxResults])){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraGalMaxResults]),null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}}
if(ZaItem.hasWritePermission(ZaGlobalConfig.A_zimbraScheduledTaskNumThreads,B)){
if(B.attrs[ZaGlobalConfig.A_zimbraScheduledTaskNumThreads]&&!AjxUtil.isPositiveInt(B.attrs[ZaGlobalConfig.A_zimbraScheduledTaskNumThreads])){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.NAD_zimbraScheduledTaskNumThreads]),null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}}
if(ZaItem.hasWritePermission(ZaGlobalConfig.A_zimbraMtaRestriction,B)){
var k=[];
for(var Y=0;
Y<ZaGlobalConfig.MTA_RESTRICTIONS.length;
Y++){
var d=ZaGlobalConfig.MTA_RESTRICTIONS[Y];
if(B.attrs["_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_"+d]){
k.push(d)
}}
var f=k.length>0;
if(B.attrs[ZaGlobalConfig.A_zimbraMtaRestriction]){
var e=AjxUtil.isString(B.attrs[ZaGlobalConfig.A_zimbraMtaRestriction])?[B.attrs[ZaGlobalConfig.A_zimbraMtaRestriction]]:B.attrs[ZaGlobalConfig.A_zimbraMtaRestriction];
f=AjxStringUtil.getAsString(k.sort())!=AjxStringUtil.getAsString(e.sort());
if(!f){
for(var Y=0;
Y<e.length;
Y++){
var d=e[Y];
if(!B.attrs["_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_"+d]){
f=true;
break
}}}}
var E=B.attrs[ZaGlobalConfig.A_zimbraMtaPolicyService];
var F=this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaPolicyService];
var j=E.length;
if((j!=F.length)||(E.join("")!=F.join(""))){
f=true
}
for(var b=0;
b<j;
b++){
var w=E[b];
if(w){
k.push("check_policy_service "+w)
}}
var H=B.attrs[ZaGlobalConfig.A_zimbraMtaRejectRblClient];
var y=this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaRejectRblClient];
var C=H.length;
if((C!=y.length)||(H.join("")!=y.join(""))){
f=true
}
for(var b=0;
b<C;
b++){
var o=H[b];
if(o){
k.push("reject_rbl_client "+o)
}}
var m=B.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblClient];
var v=this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblClient];
var z=m.length;
if((z!=v.length)||(m.join("")!=v.join(""))){
f=true
}
for(var b=0;
b<z;
b++){
var l=m[b];
if(l){
k.push("reject_rhsbl_client "+l)
}}
var O=B.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient];
var g=this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient];
var q=O.length;
if((q!=g.length)||(O.join("")!=g.join(""))){
f=true
}
for(var b=0;
b<q;
b++){
var c=O[b];
if(c){
k.push("reject_rhsbl_reverse_client "+c)
}}
var A=B.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblSender];
var R=this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblSender];
var s=A.length;
if((s!=R.length)||(A.join("")!=R.join(""))){
f=true
}
for(var b=0;
b<s;
b++){
var S=A[b];
if(S){
k.push("reject_rhsbl_sender "+S)
}}
if(f){
B.attrs[ZaGlobalConfig.A_zimbraMtaRestriction]=k
}}
if(B.attrs[ZaGlobalConfig.A_zimbraMailAddressValidationRegex]){
var x=B.attrs[ZaGlobalConfig.A_zimbraMailAddressValidationRegex];
var M=true;
var t=null;
if(x&&x instanceof Array){
for(var Y=0;
Y<x.length&&M;
Y++){
if(x[Y].indexOf("@")==-1){
M=false;
t=x[Y]
}}}else{
if(x){
if(x.indexOf("@")==-1){
M=false;
t=x
}}}
if(!M){
this._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_MSG_EmailValidReg,t),null,DwtMessageDialog.CRITICAL_STYLE,ZabMsg.zimbraAdminTitle);
this._errorDialog.popup();
return M
}}
var n=new Object();
if(ZaController.saveChangeCheckMethods.ZaGlobalConfigViewController){
var T=ZaController.saveChangeCheckMethods.ZaGlobalConfigViewController;
var p=T.length;
for(var Y=0;
Y<p;
Y++){
if(typeof(T[Y])=="function"){
T[Y].call(this,n,B,this._currentObject)
}}}
for(var G in B.attrs){
if(G==ZaItem.A_objectClass||G==ZaGlobalConfig.A_zimbraAccountClientAttr||G==ZaGlobalConfig.A_zimbraServerInheritedAttr||G==ZaGlobalConfig.A_zimbraDomainInheritedAttr||G==ZaGlobalConfig.A_zimbraCOSInheritedAttr||G==ZaGlobalConfig.A_zimbraGalLdapAttrMap||G==ZaGlobalConfig.A_zimbraGalLdapFilterDef||/^_/.test(G)||G==ZaGlobalConfig.A_zimbraMtaBlockedExtension||G==ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension||G==ZaItem.A_zimbraACE){
continue
}
if(!ZaItem.hasWritePermission(G,B)){
continue
}
if((this._currentObject.attrs[G]!=B.attrs[G])&&!(this._currentObject.attrs[G]==undefined&&B.attrs[G]==="")){
if(B.attrs[G] instanceof Array){
if(!this._currentObject.attrs[G]){
this._currentObject.attrs[G]=[]
}else{
if(!(this._currentObject.attrs[G] instanceof Array)){
this._currentObject.attrs[G]=[this._currentObject.attrs[G]]
}}
if(B.attrs[G].join(",").valueOf()!=this._currentObject.attrs[G].join(",").valueOf()){
if(G===ZaGlobalConfig.A_zimbraMtaRestriction){
var r=ZaGlobalConfigViewController.getMTARestCustomAttributes(this._currentObject.attrs[G]);
B.attrs[G]=AjxUtil.mergeArrays(B.attrs[G],r);
AjxUtil.dedup(B.attrs[G])
}
n[G]=B.attrs[G]
}}else{
n[G]=B.attrs[G]
}}}
if(ZaItem.hasWritePermission(ZaGlobalConfig.A_zimbraMtaBlockedExtension,B)){
if(!AjxUtil.isEmpty(B.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension])){
if(((!this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension]||!this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension].length))||(B.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension].join("")!=this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension].join(""))){
n[ZaGlobalConfig.A_zimbraMtaBlockedExtension]=B.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension]
}}else{
if(AjxUtil.isEmpty(B.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension])&&!AjxUtil.isEmpty(this._currentObject.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension])){
n[ZaGlobalConfig.A_zimbraMtaBlockedExtension]=""
}}}
if(this._currentObject[ZaModel.currentTab]!=B[ZaModel.currentTab]){
this._currentObject[ZaModel.currentTab]=B[ZaModel.currentTab]
}
this._currentObject.modify(n,B);
if(n.hasOwnProperty(ZaGlobalConfig.A_zimbraSkinForegroundColor)||n.hasOwnProperty(ZaGlobalConfig.A_zimbraSkinBackgroundColor)||n.hasOwnProperty(ZaGlobalConfig.A_zimbraSkinSecondaryColor)||n.hasOwnProperty(ZaGlobalConfig.A_zimbraSkinSelectionColor)||n.hasOwnProperty(ZaGlobalConfig.A_zimbraSkinLogoURL)||n.hasOwnProperty(ZaGlobalConfig.A_zimbraSkinLogoLoginBanner)||n.hasOwnProperty(ZaGlobalConfig.A_zimbraSkinLogoAppBanner)){
try{
var W=ZaApp.getInstance().getMailServers();
var u=[];
var p=W.length;
for(var Y=0;
Y<p;
Y++){
if(ZaItem.hasRight(ZaServer.FLUSH_CACHE_RIGHT,W[Y])){
u.push(W[Y])
}}
if(u.length>0){
ZaApp.getInstance().dialogs.confirmMessageDialog2.setMessage(ZaMsg.Domain_flush_cache_q,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.YES_BUTTON,this.openFlushCacheDlg,this,[u]);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.NO_BUTTON,this.closeCnfrmDelDlg,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog2.popup()
}}
catch(D){
this._handleException(D,"ZaGlobalConfigViewController.prototype._saveChange",null,false);
return false
}}
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(ZaMsg.GlobalConfigModified);
return true
};
ZaGlobalConfigViewController.prototype.validateMyNetworks=ZaServerController.prototype.validateMyNetworks;
ZaXFormViewController.preSaveValidationMethods.ZaGlobalConfigViewController.push(ZaGlobalConfigViewController.prototype.validateMyNetworks);
ZaGlobalConfigViewController.prototype.openFlushCacheDlg=function(e){
ZaApp.getInstance().dialogs.confirmMessageDialog2.popdown();
e._version=1;
var o=[];
for(var t=0;
t<e.length;
t++){
e[t]["status"]=0;
o.push(e[t].id)
}
obj={
statusMessage:null,flushZimlet:false,flushSkin:true,flushLocale:false,serverList:e,status:0,_uuid:(o.length>1?o.join("__"):o[0]),name:(o.length>1?ZaMsg.multiple_servers:e[0].name)};
ZaApp.getInstance().dialogs.flushCacheDialog=new ZaFlushCacheXDialog(this._container,{
id:(o.length>1?o.join("__"):o[0]),name:(o.length>1?ZaMsg.multiple_servers:e[0].name)}
);
ZaApp.getInstance().dialogs.flushCacheDialog.setObject(obj);
ZaApp.getInstance().dialogs.flushCacheDialog.popup()
};
ZaGlobalConfigViewController.getMTARestCustomAttributes=function(e){
var s=ZaGlobalConfig.MTA_RESTRICTIONS;
var c=["policy_service","reject_rbl_client","reject_rhsbl_client","reject_rhsbl_reverse_client","reject_rhsbl_sender"];
s=AjxUtil.mergeArrays(s,c);
var l=e.length;
var h=AjxStringUtil.getAsString(s);
var t=[];
for(var n=0;
n<l;
n++){
var r=e[n];
var o=r.substring(0,r.indexOf(" "));
if(h.indexOf(r)===-1&&c.indexOf(o)===-1){
t.push(r)
}}
return t
}
}
if(AjxPackage.define("zimbraAdmin.dl.controller.ZaDLController")){
ZaDLController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaDLController");
this._UICreated=false;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/distribution_lists.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpEditDL;
this.deleteMsg=ZaMsg.Q_DELETE_DL;
this.objType=ZaEvent.S_ACCOUNT;
this.tabConstructor=ZaDLXFormView;
this._removeAliasArr=[];
this._addAliasArr=[]
};
ZaDLController.prototype=new ZaXFormViewController();
ZaDLController.prototype.constructor=ZaDLController;
ZaController.initToolbarMethods.ZaDLController=new Array();
ZaController.initPopupMenuMethods.ZaDLController=new Array();
ZaController.setViewMethods.ZaDLController=[];
ZaController.changeActionsStateMethods.ZaDLController=new Array();
ZaDLController.prototype.toString=function(){
return"ZaDLController"
};
ZaDLController.prototype.show=function(o,t,e){
this._setView(o,t,e);
o.schedulePostLoading(this)
};
ZaDLController.setViewMethod=function(o){
try{
var e=false;
if(o.id==null){
e=true
}
o.refresh(e,true);
this._createUI(o);
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setDirty(false);
o[ZaModel.currentTab]="1";
this._view.setObject(o);
this._currentObject=o
}
catch(t){
this._handleException(t,"ZaDLController.prototype.show",null,false)
}};
ZaController.setViewMethods.ZaDLController.push(ZaDLController.setViewMethod);
ZaDLController.changeActionsStateMethod=function(){
var e=(this._view&&this._view.isDirty());
if(this._popupOperations[ZaOperation.SAVE]){
this._popupOperations[ZaOperation.SAVE].enabled=e
}
if(!this._currentObject.id||!ZaItem.hasRight(ZaAccount.RIGHT_DELETE_DL,this._currentObject)){
this._popupOperations[ZaOperation.DELETE].enabled=false
}};
ZaController.changeActionsStateMethods.ZaDLController.push(ZaDLController.changeActionsStateMethod);
ZaDLController.initToolbarMethod=function(){};
ZaController.initToolbarMethods.ZaDLController.push(ZaDLController.initToolbarMethod);
ZaDLController.initPopupMenuMethod=function(){
var e=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
e=true
}else{
e=ZaZimbraAdmin.canCreateDL()
}
this._popupOperations[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.ALTBB_Save_tt,"Save","SaveDis",new AjxListener(this,this.saveButtonListener));
this._popupOperations[ZaOperation.CLOSE]=new ZaOperation(ZaOperation.CLOSE,ZaMsg.TBB_Close,ZaMsg.ALTBB_Close_tt,"Close","CloseDis",new AjxListener(this,this.closeButtonListener));
if(e){
this._popupOperations[ZaOperation.NEW]=new ZaOperation(ZaOperation.NEW,ZaMsg.TBB_New,ZaMsg.DLTBB_New_tt,"DistributionList","DistributionListDis",new AjxListener(this,this.newButtonListener,[true]))
}
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.DLTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,this.deleteButtonListener));
if(e){
this._popupOrder.push(ZaOperation.NEW)
}
this._popupOrder.push(ZaOperation.DELETE);
this._popupOrder.push(ZaOperation.SAVE);
this._popupOrder.push(ZaOperation.CLOSE);
this._popupOrder.push(ZaOperation.SEP)
};
ZaController.initPopupMenuMethods.ZaDLController.push(ZaDLController.initPopupMenuMethod);
ZaDLController.prototype.getPopUpOperation=function(){
return this._popupOperations
};
ZaDLController.prototype.newDl=function(){
var e=new ZaDistributionList();
this.show(e)
};
ZaDLController.prototype.newButtonListener=function(o,t){
if(o){
ZaAccountListController.prototype._newDistributionListListener.call(this)
}else{
if(this._view.isDirty()){
var e=new Object();
e.params=null;
e.obj=this;
e.func=ZaDLController.prototype.newDl;
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_SAVE_CHANGES,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.saveAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.discardAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.newDl()
}}};
ZaDLController.prototype._createUI=function(e){
this._contentView=this._view=new this.tabConstructor(this._container,e);
this._initPopupMenu();
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._removeConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_DL+"_removeConfirm");
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaDLController.prototype._saveChanges=function(){
var t=false;
var r=null;
var o;
try{
if(this._view.getMyForm().hasErrors()){
var e=this._view.getMyForm().getItemsInErrorState();
var h=ZaMsg.CORRECT_ERRORS;
h+="<br><ul>";
var n=0;
for(var c in e){
if(n>19){
h+="<li>...</li>";
break
}
if(c=="size"){
continue
}
var l=e[c].getInheritedProperty("msgName");
if(!l&&e[c].getLabel()){
l=e[c].getLabel()
}else{
if(!l&&e[c].getParentItem()){
if(e[c].getParentItem().getInheritedProperty("msgName")){
l=e[c].getParentItem().getInheritedProperty("msgName")
}else{
l=e[c].getParentItem().getLabel()
}}}
if(l){
if(l.substring(l.length-1,1)==":"){
l=l.substring(0,l.length-1)
}}
if(l){
h+="<li>";
h+=l;
h+="</li>"
}
n++
}
h+="</ul>";
this.popupMsgDialog(h,true);
return false
}
o=this._view.getObject();
if(!ZaDistributionList.checkValues(o)){
return t
}
if(this._currentObject[ZaModel.currentTab]!=o[ZaModel.currentTab]){
this._currentObject[ZaModel.currentTab]=o[ZaModel.currentTab]
}
if(this._currentObject.id){
this._currentObject.schedulePostLoading(this);
this._currentObject.modify(null,o);
if(this._currentObject&&o.name!=this._currentObject.name&&this._currentObject.id){
r=o.name
}
if(r){
try{
this._currentObject.rename(r)
}
catch(s){
if(s.code==ZmCsfeException.DISTRIBUTION_LIST_EXISTS){
this.popupErrorDialog(ZaMsg.FAILED_RENAME_DL_1,s)
}else{
this.popupErrorDialog(ZaMsg.FAILED_RENAME_DL,s)
}
return t
}}
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.DLModified,[this._currentObject.name]))
}else{
this._currentObject=ZaItem.create(o,ZaDistributionList,"ZaDistributionList");
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.DLCreated,[this._currentObject.name]));
ZaApp.getInstance().getAccountListController().fireCreationEvent(this._currentObject)
}}
catch(s){
if(s.code==ZmCsfeException.ACCT_EXISTS||s.code==ZmCsfeException.DISTRIBUTION_LIST_EXISTS){
this.popupErrorDialog(ZaMsg.ERROR_dlWithThisNameExists,s)
}else{
this._handleException(s,"ZaDLController.prototype._saveChanges",null,false)
}
return false
}
return true
}
}
if(AjxPackage.define("zimbraAdmin.resource.controller.ZaResourceController")){
ZaResourceController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaResourceController");
this._UICreated=false;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/managing_resource.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageResourceAccount;
this.deleteMsg=ZaMsg.Q_DELETE_RES;
this.objType=ZaEvent.S_ACCOUNT;
this.tabConstructor=ZaResourceXFormView
};
ZaResourceController.prototype=new ZaXFormViewController();
ZaResourceController.prototype.constructor=ZaResourceController;
ZaController.initToolbarMethods.ZaResourceController=new Array();
ZaController.initPopupMenuMethods.ZaResourceController=new Array();
ZaController.setViewMethods.ZaResourceController=[];
ZaController.changeActionsStateMethods.ZaResourceController=new Array();
ZaResourceController.prototype.toString=function(){
return"ZaResourceController"
};
ZaResourceController.prototype.setDirty=function(e){
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,e)
};
ZaResourceController.prototype.handleXFormChange=function(e){
if(e&&e.form.hasErrors()){
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false)
}};
ZaResourceController.prototype.show=function(o,t,e){
this._setView(o,t,e)
};
ZaResourceController.changeActionsStateMethod=function(){
var e=(this._view&&this._view.isDirty());
if(this._popupOperations[ZaOperation.SAVE]){
this._popupOperations[ZaOperation.SAVE].enabled=e
}};
ZaController.changeActionsStateMethods.ZaResourceController.push(ZaResourceController.changeActionsStateMethod);
ZaResourceController.setViewMethod=function(t){
this._createUI(t);
try{
ZaApp.getInstance().pushView(this.getContentViewId());
if(t.id){
t.load("id",t.id,null)
}
this._view.setDirty(false);
t[ZaModel.currentTab]="1";
this._view.setObject(t);
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false);
this._currentObject=t
}
catch(e){
this._handleException(e,"ZaResourceController.prototype.show",null,false)
}};
ZaController.setViewMethods.ZaResourceController.push(ZaResourceController.setViewMethod);
ZaResourceController.initPopupMenuMethod=function(){
var e=false;
if(ZaSettings.HAVE_MORE_DOMAINS||ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
e=true
}else{
e=ZaZimbraAdmin.canCreateCalRes()
}
this._popupOperations[ZaOperation.SAVE]=new ZaOperation(ZaOperation.SAVE,ZaMsg.TBB_Save,ZaMsg.ALTBB_Save_tt,"Save","SaveDis",new AjxListener(this,this.saveButtonListener));
this._popupOperations[ZaOperation.CLOSE]=new ZaOperation(ZaOperation.CLOSE,ZaMsg.TBB_Close,ZaMsg.ALTBB_Close_tt,"Close","CloseDis",new AjxListener(this,this.closeButtonListener));
if(e){
this._popupOperations[ZaOperation.NEW]=new ZaOperation(ZaOperation.NEW,ZaMsg.TBB_New,ZaMsg.RESTBB_New_tt,"Resource","ResourceDis",new AjxListener(this,this.newButtonListener))
}
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.RESTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,this.deleteButtonListener));
this._popupOrder.push(ZaOperation.NEW);
this._popupOrder.push(ZaOperation.SAVE);
this._popupOrder.push(ZaOperation.CLOSE);
this._popupOrder.push(ZaOperation.DELETE)
};
ZaController.initPopupMenuMethods.ZaResourceController.push(ZaResourceController.initPopupMenuMethod);
ZaResourceController.prototype.getPopUpOperation=function(){
return this._popupOperations
};
ZaResourceController.prototype.newResource=function(){
try{
var e=new ZaResource();
e.loadNewObjectDefaults("name",ZaSettings.myDomainName);
if(!ZaApp.getInstance().dialogs.newResourceWizard){
ZaApp.getInstance().dialogs.newResourceWizard=new ZaNewResourceXWizard(this._container)
}
ZaApp.getInstance().dialogs.newResourceWizard.setObject(e);
ZaApp.getInstance().dialogs.newResourceWizard.popup()
}
catch(t){
this._handleException(t,"ZaResourceController.prototype.newResource",null,false)
}};
ZaResourceController.prototype.newButtonListener=function(t){
if(this._view.isDirty()){
var e=new Object();
e.params=null;
e.obj=this;
e.func=ZaResourceController.prototype.newResource;
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_SAVE_CHANGES,DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.saveAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.discardAndGoAway,this,e);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
this.newResource()
}};
ZaResourceController.prototype._createUI=function(e){
this._contentView=this._view=new this.tabConstructor(this._container,e);
this._initPopupMenu();
var t=new Object();
t[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._removeConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.VIEW_RES+"_removeConfirm");
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaResourceController.prototype._saveChanges=function(){
if(this._view.getMyForm().hasErrors()){
var e=this._view.getMyForm().getItemsInErrorState();
var r=ZaMsg.CORRECT_ERRORS;
r+="<br><ul>";
var o=0;
for(var c in e){
if(o>19){
r+="<li>...</li>";
break
}
if(c=="size"){
continue
}
var l=e[c].getInheritedProperty("msgName");
if(!l&&e[c].getParentItem()){
l=e[c].getParentItem().getInheritedProperty("msgName")
}
if(l){
if(l.substring(l.length-1,1)==":"){
l=l.substring(0,l.length-1)
}}
if(l){
r+="<li>";
r+=l;
r+="</li>"
}
o++
}
r+="</ul>";
this.popupMsgDialog(r,true);
return false
}
var t=this._view.getObject();
var s=null;
if(t.attrs==null){
this._errorDialog.setMessage(ZaMsg.ERROR_UNKNOWN,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}
ZaResource.prototype.setLdapAttrsFromSchedulePolicy.call(t);
if(this._currentObject&&t.name!=this._currentObject.name){
if(!AjxUtil.isValidEmailNonReg(t.name)){
this._errorDialog.setMessage(ZaMsg.ERROR_ACCOUNT_NAME_INVALID,null,DwtMessageDialog.CRITICAL_STYLE,null);
this._errorDialog.popup();
return false
}
s=t.name
}
var u=new Object();
if(!ZaResource.checkValues(t)){
return false
}
if(ZaItem.hasAnyRight([ZaResource.SET_CALRES_PASSWORD_RIGHT,ZaResource.CHANGE_CALRES_PASSWORD_RIGHT],t)){
if(t.attrs[ZaResource.A_password]!=null&&t[ZaResource.A2_confirmPassword]!=null&&t.attrs[ZaResource.A_password].length>0){
try{
this._currentObject.changePassword(t.attrs[ZaResource.A_password])
}
catch(n){
this.popupErrorDialog(ZaMsg.FAILED_SAVE_ACCOUNT,n);
return false
}}}
var d=new Object();
if(t[ZaResource.A2_autoCos]=="TRUE"){
t.attrs[ZaResource.A_COSId]=""
}
if(s){
d.newName=s;
try{
this._currentObject.rename(s)
}
catch(n){
if(n.code==ZmCsfeException.ACCT_EXISTS){
this.popupErrorDialog(ZaMsg.FAILED_RENAME_ACCOUNT_1,n)
}else{
this._handleException(n,"ZaResourceController.prototype._saveChanges",null,false)
}
return false
}}
for(var h in t.attrs){
if(h==ZaResource.A_password||h==ZaItem.A_objectClass||h==ZaResource.A_mail||h==ZaItem.A_zimbraId||h==ZaItem.A_zimbraACE){
continue
}
if(!ZaItem.hasWritePermission(h,t)){
continue
}
if((this._currentObject.attrs[h]!=t.attrs[h])&&!(this._currentObject.attrs[h]==undefined&&t.attrs[h]==="")){
if(h==ZaResource.A_uid){
continue
}
if(h==ZaResource.A_COSId&&!AjxUtil.isEmpty(t.attrs[ZaResource.A_COSId])&&!ZaItem.ID_PATTERN.test(t.attrs[ZaResource.A_COSId])){
this.popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[t.attrs[ZaResource.A_COSId]]),null);
return false
}
if(t.attrs[h] instanceof Array&&this._currentObject.attrs[h] instanceof Array){
if(t.attrs[h].join(",").valueOf()!=this._currentObject.attrs[h].join(",").valueOf()){
u[h]=t.attrs[h]
}}else{
u[h]=t.attrs[h]
}}}
if(this._currentObject[ZaModel.currentTab]!=t[ZaModel.currentTab]){
this._currentObject[ZaModel.currentTab]=t[ZaModel.currentTab]
}
try{
this._currentObject.modify(u)
}
catch(n){
if(n.code==ZmCsfeException.ACCT_EXISTS){
this.popupErrorDialog(ZaMsg.FAILED_CREATE_ACCOUNT_1,n)
}else{
if(n.code==ZmCsfeException.NO_SUCH_COS){
this.popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[t.attrs[ZaResource.A_COSId]]),n)
}else{
this._handleException(n,"ZaResourceController.prototype._saveChanges",null,false)
}}
return false
}
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.ResourceModified,[this._currentObject.name]));
return true
}
}
if(AjxPackage.define("zimbraAdmin.helpdesk.controller.ZaHelpViewController")){
ZaHelpViewController=function(t,e){
ZaController.call(this,t,e,"ZaHelpViewController");
this.tabConstructor=ZaHelpView
};
ZaHelpViewController.prototype=new ZaController();
ZaHelpViewController.prototype.constructor=ZaHelpViewController;
ZaController.initToolbarMethods.ZaHelpViewController=new Array();
ZaHelpViewController.prototype.show=function(e){
if(!this._contentView){
var t=new Object();
this._contentView=new this.tabConstructor(this._container);
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
ZaApp.getInstance().pushView(this.getContentViewId())
}
}
if(AjxPackage.define("zimbraAdmin.helpdesk.controller.ZaMWizController")){
ZaMigrationWizController=function(t,e){
ZaController.call(this,t,e,"ZaMigrationWizController");
this.tabConstructor=ZaMigrationWizView
};
ZaMigrationWizController.prototype=new ZaController();
ZaMigrationWizController.prototype.constructor=ZaMigrationWizController;
ZaMigrationWizController.prototype.show=function(e){
if(!this._contentView){
var t=new Object();
this._contentView=new this.tabConstructor(this._container);
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
ZaApp.getInstance().pushView(this.getContentViewId())
}
}
if(AjxPackage.define("zimbraAdmin.mta.controller.ZaMTAListController")){
ZaMTAListController=function(t,e){
ZaController.call(this,t,e,"ZaMTAListController");
this._toolbarOperations=new Array();
this._popupOperations=new Array();
this.MTAPool=[];
this._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/monitoring_zimbra_mta_mail_queues.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageMailQueue
};
ZaMTAListController.prototype=new ZaController();
ZaMTAListController.prototype.constructor=ZaMTAListController;
ZaController.initToolbarMethods.ZaMTAListController=new Array();
ZaController.initPopupMenuMethods.ZaMTAListController=new Array();
ZaController.changeActionsStateMethods.ZaMTAListController=new Array();
ZaMTAListController.prototype.show=function(l,h){
if(!this._UICreated){
this._createUI()
}
if(l!=null){
this._contentView.set(l.getVector());
this.MTAPool=[];
var r=l.getArray();
var t=r.length;
for(var e=0;
e<t;
e++){
this.MTAPool.push(r[e])
}
var s=0;
var n=[];
var o=t>5?5:t;
for(s=0;
s<o;
s++){
n[s]=this.MTAPool.shift()
}
ZaMTA._quecountsArr=new Array();
for(s=o-1;
s>=0;
s--){
n[s].load("id",n[s].id,false,true)
}}
ZaApp.getInstance().pushView(this.getContentViewId());
this._removeList=new Array();
if(l!=null){
this._list=l
}
this.changeActionsState()
};
ZaMTAListController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.VIEW]=new ZaOperation(ZaOperation.VIEW,ZaMsg.TBB_View,ZaMsg.PQTBB_View_tt,"Properties","PropertiesDis",new AjxListener(this,ZaMTAListController.prototype._viewButtonListener))
};
ZaController.initPopupMenuMethods.ZaMTAListController.push(ZaMTAListController.initPopupMenuMethod);
ZaMTAListController.prototype._createUI=function(){
try{
var t=new Object();
this._contentView=new ZaMTAListView(this._container);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_MTALIST,ZaId.MENU_POP);
t[ZaAppViewMgr.C_APP_CONTENT]=this._contentView;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),t);
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._removeConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_MTALIST+"_removeConfirm");
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
}
catch(e){
this._handleException(e,"ZaMTAListController.prototype._createUI",null,false);
return
}};
ZaMTAListController.prototype.getList=function(){
return this._list
};
ZaMTAListController.prototype.set=function(e){
this.show(e)
};
ZaMTAListController.prototype._listSelectionListener=function(e){
if(e.detail==DwtListView.ITEM_DBL_CLICKED){
if(e.item){
this._selectedItem=e.item;
ZaApp.getInstance().getMTAController().show(e.item)
}}else{
this.changeActionsState()
}};
ZaMTAListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaMTAListController.prototype._viewButtonListener=function(t){
if(this._contentView.getSelectionCount()==1){
var e=this._contentView.getSelection()[0];
ZaApp.getInstance().getMTAController().show(e)
}};
ZaMTAListController.changeActionsState=function(){
var e=this._contentView.getSelectionCount();
if(e!=1){
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}}};
ZaController.changeActionsStateMethods.ZaMTAListController.push(ZaMTAListController.changeActionsStateMethod);
ZaMTAListController.prototype.handleMTAChange=function(t){
if(t&&this._contentView){
if(t.getDetail("obj")){
this._contentView.setUI();
if(this.MTAPool.length){
var e=this.MTAPool.shift();
e.load()
}}}};
ZaMTAListController.prototype.getQCounts=function(){
this.MTAPool=[];
var r=this._list.getArray();
var t=r.length;
for(var e=0;
e<t;
e++){
this.MTAPool.push(r[e])
}
var s=t>5?5:t;
var n=0;
var o=[];
for(n=0;
n<s;
n++){
o[n]=this.MTAPool.shift()
}
ZaMTA._quecountsArr=new Array();
for(n=s-1;
n>=0;
n--){
o[n].load()
}};
ZaMTAListController.prototype.refreshListener=function(){
this.getQCounts()
}
}
if(AjxPackage.define("zimbraAdmin.mta.controller.ZaMTAController")){
ZaMTAController=function(t,e){
ZaXFormViewController.call(this,t,e,"ZaMTAController");
this._UICreated=false;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/monitoring_zimbra_mta_mail_queues.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.helpManageMailQueue;
this._toolbarOperations=new Array();
this._popupOperations=new Array();
this.objType=ZaEvent.S_MTA;
this.tabConstructor=ZaMTAXFormView
};
ZaMTAController.prototype=new ZaXFormViewController();
ZaMTAController.prototype.constructor=ZaMTAController;
ZaController.initToolbarMethods.ZaMTAController=new Array();
ZaController.initPopupMenuMethods.ZaMTAController=new Array();
ZaController.setViewMethods.ZaMTAController=new Array();
ZaController.changeActionsStateMethods.ZaMTAController=new Array();
ZaMTAController.prototype.show=function(e){
if(!this.selectExistingTabByItemId(e.id)){
this._setView(e,true);
this.setDirty(false)
}};
ZaMTAController.setViewMethod=function(e){
e.load();
if(!this._UICreated){
this._createUI()
}
ZaApp.getInstance().pushView(this.getContentViewId());
this._view.setDirty(false);
this._view.setObject(e);
this._currentObject=e
};
ZaController.setViewMethods.ZaMTAController.push(ZaMTAController.setViewMethod);
ZaMTAController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.FLUSH]=new ZaOperation(ZaOperation.FLUSH,ZaMsg.TBB_FlushQs,ZaMsg.TBB_TBB_FlushQs_tt,"FlushAllQueues","FlushAllQueues",new AjxListener(this,this.flushListener))
};
ZaController.initPopupMenuMethods.ZaMTAController.push(ZaMTAController.initPopupMenuMethod);
ZaMTAController.prototype._createUI=function(){
this._contentView=this._view=new this.tabConstructor(this._container);
this._initPopupMenu();
var e=new Object();
e[ZaAppViewMgr.C_APP_CONTENT]=this._view;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),e);
this._UICreated=true;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this
};
ZaMTAController.prototype.flushListener=function(){
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_FLUSH_QUEUES,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.flushQueues,this);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.closeCnfrmDlg,this,null);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
};
ZaMTAController.prototype.flushQueues=function(){
try{
this._currentObject.flushQueues()
}
catch(e){
this._handleException(e,"ZaMTAController.prototype.flushQueues")
}
this.closeCnfrmDlg()
};
ZaMTAController.prototype.handleMTAChange=function(t){
if(t&&this._view&&(this._view.__internalId==ZaApp.getInstance().getAppViewMgr().getCurrentView())){
if(t.getDetail("obj")&&(t.getDetail("obj") instanceof ZaMTA)){
if(this._currentObject&&this._currentObject[ZaItem.A_zimbraId]==t.getDetail("obj")[ZaItem.A_zimbraId]){
this._currentObject=t.getDetail("obj");
var n=t.getDetail("qName");
if(n&&t.getDetail("poll")){
var o=0;
if(t.getDetail("offset")!=undefined){
if(t.getDetail("offset")>0){
o=t.getDetail("offset")/ZaMTA.RESULTSPERPAGE
}}
this._currentObject[n][ZaMTA.A_pageNum]=o;
if(this._currentObject[n][ZaMTA.A_Status]==ZaMTA.STATUS_SCANNING){
var e=new AjxTimedAction(this._currentObject,ZaMTA.prototype.getMailQStatus,n,t.getDetail("query"),t.getDetail("offset"),t.getDetail("limit"),t.getDetail("force"));
AjxTimedAction.scheduleAction(e,ZaMTA.POLL_INTERVAL)
}}
this._view.setObject(this._currentObject)
}}}}
}
if(AjxPackage.define("zimbraAdmin.search.controller.ZaSearchListController")){
ZaSearchListController=function(t,e){
ZaListViewController.call(this,t,e,"ZaSearchListController");
this._toolbarOperations=new Array();
this._popupOperations=new Array();
this._popupOperationsOnAppBar=new Array();
this._currentPageNum=1;
this._currentQuery=null;
this._currentDomain=null;
this._currentSortField=ZaAccount.A_uid;
this._currentSortOrder="1";
this.searchTypes=[ZaSearch.ALIASES,ZaSearch.DLS,ZaSearch.ACCOUNTS,ZaSearch.RESOURCES,ZaSearch.DOMAINS,ZaSearch.COSES];
this.pages=new Object();
this._searchPanel=null;
this._searchField=null;
this._helpURL=ZaSearchListController.helpURL;
this._helpButtonText=ZaMsg.helpManageAccounts;
this._UICreated=false;
this._readFromQuery=false;
this._isAdvancedSearch=false;
this._searchFieldInput=null;
this.objType=ZaEvent.S_ACCOUNT;
this.fetchAttrs=ZaSearch.standardAttributes;
this.searchResultFilter=[ZaAccount.A_accountStatus];
this._filterObj=null
};
ZaSearchListController.prototype=new ZaListViewController();
ZaSearchListController.prototype.constructor=ZaSearchListController;
ZaSearchListController.helpURL=location.pathname+ZaUtil.HELP_URL+"search/search.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaController.initToolbarMethods.ZaSearchListController=new Array();
ZaController.initPopupMenuMethods.ZaSearchListController=new Array();
ZaController.changeActionsStateMethods.ZaSearchListController=new Array();
ZaSearchListController.prototype.show=function(n){
var r=Dwt.getNextId();
var l=new AjxCallback(this,this.searchCallback,{
limit:this.RESULTSPERPAGE,CONS:null,show:n,busyId:r,resultFilter:this._filterObj}
);
var s={
query:this._currentQuery,types:this.searchTypes,sortBy:this._currentSortField,offset:this.RESULTSPERPAGE*(this._currentPageNum-1),sortAscending:this._currentSortOrder,limit:this.RESULTSPERPAGE,attrs:this.fetchAttrs,callback:l,controller:this,showBusy:true,busyId:r,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false};
var h=new Array();
var o=false;
for(var t=0;
this.searchTypes&&t<this.searchTypes.length;
t++){
if(this.searchTypes[t]==ZaSearch.ALIASES){
o=true
}}
if(o&&!this._currentDomain){
h.push(s);
var e=ZaSearchListController._getSearchKeyWord(this._currentQuery);
ZaSearchListController.searchAliasDomain(e,this,h)
}else{
if(this._currentDomain){
s.domain=this._currentDomain
}
ZaSearch.searchDirectory(s)
}};
ZaSearchListController.version=1;
ZaSearchListController.prototype._show=function(s,n,r,e,o){
this._updateUI(s,n,r,e);
ZaApp.getInstance().pushView(this.getContentViewId());
if(o){
this._uiContainer.setQueryFieldVisible(true)
}else{
this._uiContainer.setQueryFieldVisible(false)
}
var t=this._uiContainer.getQueryFormBubbles();
t=t?t:"";
this._uiContainer.setQueryField(t)
};
ZaSearchListController.prototype.getSearchPanel=function(){
if(!this._searchPanel){
this._searchPanel=new DwtComposite(ZaApp.getInstance().getAppCtxt().getShell(),"SearchPanel",DwtControl.ABSOLUTE_STYLE,null,ZaId.getOverviewId(ZaId.PANEL_APPSEARCH));
this._searchToolBar=new ZaSearchToolBar(this._searchPanel,null,ZaId.PANEL_APPSEARCH);
this._searchField=this._searchToolBar.getSearchField();
this._searchField.registerCallback(ZaSearchListController.prototype._searchFieldCallback,this);
this._searchPanel.zShow(true)
}
return this._searchPanel
};
ZaSearchListController.prototype.set=function(e){
this.show(e)
};
ZaSearchListController.prototype.setPageNum=function(e){
this._currentPageNum=Number(e)
};
ZaSearchListController.prototype.getPageNum=function(){
return this._currentPageNum
};
ZaSearchListController.prototype.getTotalPages=function(){
return this.numPages
};
ZaSearchListController.prototype.setFetchAttrs=function(e){
this.fetchAttrs=e
};
ZaSearchListController.prototype.getFetchAttrs=function(){
return this.fetchAttrs
};
ZaSearchListController.prototype.setQuery=function(e){
this._currentQuery=e
};
ZaSearchListController.prototype.getQuery=function(){
return this._currentQuery
};
ZaSearchListController.prototype.setSearchTypes=function(e){
this.searchTypes=e
};
ZaSearchListController.prototype.getSearchTypes=function(){
return this.searchTypes
};
ZaSearchListController.prototype.setSortOrder=function(e){
this._currentSortOrder=e
};
ZaSearchListController.prototype.getSortOrder=function(){
return this._currentSortOrder
};
ZaSearchListController.prototype.setSortField=function(e){
this._currentSortField=e
};
ZaSearchListController.prototype.getSortField=function(){
return this._currentSortField
};
ZaSearchListController.prototype._batchSearchforDomain=function(f,d,t,s){
var h;
var l=ZaSearch.ALIASES;
var m="(uid=*";
if(!t){
m+=")"
}else{
if(t&&!(t instanceof Array)){
m+=t+"*)"
}else{
if(t instanceof Array&&t.length==1){
m+=t[0]+"*)"
}else{
if(t instanceof Array&&t.length>1){
m+=t[1]+")"
}}}}
var r=ZaApp.getInstance().getSearchListController();
if(d&&d instanceof Array){
h=d
}else{
h=new Array()
}
var n=Dwt.getNextId();
var e={
limit:r.RESULTSPERPAGE,show:true,openInSearchTab:true,busyId:n,isShowBubble:s};
var u=new AjxCallback(r,r.searchCallback,e);
for(var o=0;
o<f.length;
o++){
var c={
query:m,types:l,showBusy:true,busyId:n,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false,sortBy:r._currentSortField,attrs:ZaSearch.standardAttributes,callback:u,controller:r,domain:f[o]};
h.push(c)
}
r.multipleSearchCallback(e,h)
};
ZaSearchListController.searchAliasDomainCallback=function(h,r){
if(h.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,h.busyId)
}
try{
if(!r){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaSearchListController.searchAliasDomainCallback"))
}
if(r.isException()){
throw (r.getException())
}else{
var e=r.getResponse().Body.SearchDirectoryResponse;
var t=new Array();
if(e.domain&&e.domain.length>0){
for(var n=0;
n<e.domain.length;
n++){
var s=e.domain[n].name;
t.push(s)
}}
ZaSearchListController.prototype._batchSearchforDomain(t,h.searchQueryList,h.childQueries,h.isShowBubble)
}}
catch(o){
this._handleException(o,"ZaSearchListController.searchAliasDomainCallback",null,false)
}};
ZaSearchListController.searchAliasDomain=function(r,c,h,t){
var e=Dwt.getNextId();
var o=c?c:this;
var n="("+ZaDomain.A_domainName;
if(r.length>0){
n+="="+r[0]+"*)"
}else{
n=""
}
var l=new AjxCallback(o,ZaSearchListController.searchAliasDomainCallback,{
busyId:e,searchQueryList:h,childQueries:r,isShowBubble:t}
);
var s={
query:n,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,attrs:[ZaDomain.A_domainName],callback:l,controller:o,showBusy:true,busyId:e,busyMsg:ZaMsg.BUSY_SEARCHING_DOMAINS,skipCallbackIfCancelled:false};
ZaSearch.searchDirectory(s)
};
ZaSearchListController._getSearchKeyWord=function(r){
var o="";
var e="zimbraDomainName=*";
var n="@";
var s="*";
if(!r){
return o
}
var h=r.indexOf(e);
if(h<0||h>r.length-1){
return[]
}
var t=r.indexOf(s,h+e.length);
if(t>r.length-1){
return[]
}
o=r.substr(h+e.length,t-h-e.length);
h=o.indexOf(n);
if(h<0||h>r.length-1){
return[o]
}
return[o.substr(h+1,o.length),o.substr(0,h)]
};
ZaSearchListController.prototype._searchFieldCallback=function(t){
var l=new Array();
if(this.setSearchTypes){
this.setSearchTypes(t.types)
}
this._currentQuery=t.query;
this._currentSortField=t.sortBy;
var n=Dwt.getNextId();
var c=new AjxCallback(this,this.searchCallback,{
limit:this.RESULTSPERPAGE,show:true,openInSearchTab:true,busyId:n,resultFilter:this._filterObj,isShowBubble:t.isShowBubble}
);
var e=new AjxCallback(this,this.updateSearchTree);
var h={
query:this._currentQuery,types:t.types,showBusy:true,busyId:n,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false,sortBy:t.sortBy,offset:this.RESULTSPERPAGE*(this._currentPageNum-1),sortAscending:this._currentSortOrder,limit:this.RESULTSPERPAGE,attrs:ZaSearch.standardAttributes,callback:c,controller:this};
var s=false;
for(var o=0;
t.types&&o<t.types.length;
o++){
if(t.types[o]==ZaSearch.ALIASES){
s=true
}}
if(s){
this.scrollSearchParams={
query:this._currentQuery,types:t.types,showBusy:true,busyId:n,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false,sortBy:t.sortBy,sortAscending:this._currentSortOrder,attrs:ZaSearch.standardAttributes,controller:this,scrollType:"isAliasSearch",postCallback:e};
l.push(h);
var r=ZaSearchListController._getSearchKeyWord(t.query);
ZaSearchListController.searchAliasDomain(r,this,l,t.isShowBubble)
}else{
this.scrollSearchParams={
query:this._currentQuery,types:t.types,showBusy:true,busyId:n,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false,sortBy:t.sortBy,sortAscending:this._currentSortOrder,attrs:ZaSearch.standardAttributes,controller:this,postCallback:e};
ZaSearch.searchDirectory(h)
}};
ZaSearchListController.initPopupMenuMethod=function(){
this._popupOperations[ZaOperation.EDIT]=new ZaOperation(ZaOperation.EDIT,ZaMsg.TBB_Edit,ZaMsg.ACTBB_Edit_tt,"Edit","EditDis",new AjxListener(this,ZaSearchListController.prototype._editButtonListener));
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.ACTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,ZaSearchListController.prototype._deleteButtonListener));
this._popupOperations[ZaOperation.CHNG_PWD]=new ZaOperation(ZaOperation.CHNG_PWD,ZaMsg.ACTBB_ChngPwd,ZaMsg.ACTBB_ChngPwd_tt,"Padlock","PadlockDis",new AjxListener(this,ZaAccountListController.prototype._chngPwdListener));
this._popupOperations[ZaOperation.EXPIRE_SESSION]=new ZaOperation(ZaOperation.EXPIRE_SESSION,ZaMsg.ACTBB_ExpireSessions,ZaMsg.ACTBB_ExpireSessions_tt,"ExpireSession","ExpireSessionDis",new AjxListener(this,ZaAccountListController.prototype._expireSessionListener));
this._popupOperations[ZaOperation.MOVE_ALIAS]=new ZaOperation(ZaOperation.MOVE_ALIAS,ZaMsg.ACTBB_MoveAlias,ZaMsg.ACTBB_MoveAlias_tt,"MoveAlias","MoveAlias",new AjxListener(this,ZaAccountListController.prototype._moveAliasListener))
};
ZaController.initPopupMenuMethods.ZaSearchListController.push(ZaSearchListController.initPopupMenuMethod);
ZaSearchListController.prototype.reset=function(){
this._currentPageNum=1;
this._currentQuery=null;
this._currentSortField=ZaAccount.A_uid;
this._currentSortOrder="1";
this.pages=new Object();
this.objType=ZaEvent.S_ACCOUNT
};
ZaSearchListController.prototype._createUI=function(){
this._uiContainer=new ZaSearchXFormView(this._container);
this._contentView=this._uiContainer.widget;
ZaApp.getInstance()._controllers[this.getContentViewId()]=this;
this._newDLListener=new AjxListener(this,ZaSearchListController.prototype._newDistributionListListener);
this._newAcctListener=new AjxListener(this,ZaSearchListController.prototype._newAccountListener);
this._newResListener=new AjxListener(this,ZaSearchListController.prototype._newResourceListener);
var e=new Object();
e[ZaAppViewMgr.C_APP_CONTENT]=this._uiContainer;
ZaApp.getInstance().getAppViewMgr().createView(this.getContentViewId(),e);
this._initPopupMenu();
this._actionMenu=new ZaPopupMenu(this._contentView,"ActionMenu",null,this._popupOperations,ZaId.VIEW_SCHLIST,ZaId.MENU_POP);
this._initPopupMenuAtAppBar();
this._contentView.addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._contentView.addActionListener(new AjxListener(this,this._listActionListener));
this._removeConfirmMessageDialog=ZaApp.getInstance().dialogs.ConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_SCHLIST+"_ConfirmMessage");
this._UICreated=true
};
ZaSearchListController.prototype.closeButtonListener=function(n,t,o,s,r){
if(t){
o.call(s,r)
}else{
ZaApp.getInstance().popView()
}
if(this._searchField){
var e=this._searchField._localXForm;
var h=e.getItemsById(ZaSearch.A_query)[0];
h.getElement().value=""
}};
ZaSearchListController.prototype._newAccountListener=function(o){
try{
var e=new ZaAccount();
if(!ZaApp.getInstance().dialogs.newAccountWizard){
ZaApp.getInstance().dialogs.newAccountWizard=new ZaNewAccountXWizard(this._container)
}
ZaApp.getInstance().dialogs.newAccountWizard.setObject(e);
ZaApp.getInstance().dialogs.newAccountWizard.popup()
}
catch(t){
this._handleException(t,"ZaSearchListController.prototype._newAccountListener",null,false)
}};
ZaSearchListController.prototype._newDistributionListListener=function(o){
try{
var t=new ZaDistributionList();
ZaApp.getInstance().getDistributionListController().show(t)
}
catch(e){
this._handleException(e,"ZaSearchListController.prototype._newDistributionListListener",null,false)
}};
ZaSearchListController.prototype._newResourceListener=function(o){
try{
var e=new ZaResource();
if(!ZaApp.getInstance().dialogs.newResourceWizard){
ZaApp.getInstance().dialogs.newResourceWizard=new ZaNewResourceXWizard(this._container)
}
ZaApp.getInstance().dialogs.newResourceWizard.setObject(e);
ZaApp.getInstance().dialogs.newResourceWizard.popup()
}
catch(t){
this._handleException(t,"ZaSearchListController.prototype._newResourceListener",null,false)
}};
ZaSearchListController.prototype._listSelectionListener=function(e){
if(e.detail==DwtListView.ITEM_DBL_CLICKED){
if(e.item){
this._editItem(e.item)
}}else{
this.changeActionsState()
}};
ZaSearchListController.prototype._listActionListener=function(e){
this.changeActionsState();
this._actionMenu.popup(0,e.docX,e.docY)
};
ZaSearchListController.prototype._editButtonListener=function(t){
if(this._contentView.getSelectionCount()==1){
var e=this._contentView.getSelection()[0];
this._editItem(e)
}};
ZaSearchListController.prototype._deleteButtonListener=function(e){
ZaAccountListController.prototype._deleteButtonListener.call(this,e)
};
ZaSearchListController.prototype._deleteAccountsInRemoveList=function(e){
ZaAccountListController.prototype._deleteAccountsInRemoveList.call(this,e)
};
ZaSearchListController.prototype._editItem=function(o){
var t=o.type;
if(t==ZaItem.ACCOUNT){
ZaApp.getInstance().getAccountViewController().show(o)
}else{
if(t==ZaItem.DL){
ZaApp.getInstance().getDistributionListController().show(o)
}else{
if(t==ZaItem.ALIAS){
var e=o.getAliasTargetObj();
if(o.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_ACCOUNT){
ZaApp.getInstance().getAccountViewController().show(e,true)
}else{
if(o.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_DL){
ZaApp.getInstance().getDistributionListController().show(e,true)
}}}else{
if(t==ZaItem.RESOURCE){
ZaApp.getInstance().getResourceController().show(o)
}else{
if(t==ZaItem.DOMAIN){
if(o.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.local){
ZaApp.getInstance().getDomainController().show(o)
}else{
if(o.attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.alias){
ZaApp.getInstance().getDomainAliasWizard(true).editDomainAlias(o,true)
}}}else{
if(t==ZaItem.COS){
ZaApp.getInstance().getCosController().show(o)
}}}}}}
ZaZimbraAdmin.getInstance().getOverviewPanelController().addAccountItem(o)
};
ZaSearchListController.changeActionsStateMethod=function(){
var n=this._contentView.getSelectionCount();
if(n==1){
var s=this._contentView.getSelection()[0];
if(s){
if(s.type!=ZaItem.ALIAS){
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}}
if(s.type==ZaItem.ALIAS||s.type==ZaItem.DL){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}
if(((s.type==ZaItem.ALIAS)&&(s.attrs[ZaAlias.A_targetType]==ZaItem.DL))||(s.type==ZaItem.DL)){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}else{
if(s.type==ZaItem.DL){
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}}else{
if(s.type==ZaItem.ACCOUNT){
var t=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(s.rights)){
s.loadEffectiveRights("id",s.id,false)
}}
if(!t){
if(!ZaItem.hasRight(ZaAccount.DELETE_ACCOUNT_RIGHT,s)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasAnyRight([ZaAccount.SET_PASSWORD_RIGHT,ZaAccount.CHANGE_PASSWORD_RIGHT],s)){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}
if(!ZaItem.hasWritePermission(ZaAccount.A_zimbraAuthTokenValidityValue,s)){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}}}else{
if((s.type==ZaItem.ALIAS)&&(s.attrs[ZaAlias.A_targetType]==ZaItem.ACCOUNT)){
if(!s.targetObj){
s.targetObj=s.getAliasTargetObj()
}
var t=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(s.targetObj.rights)){
s.targetObj.loadEffectiveRights("id",s.id,false)
}}
if(!t){
if(!ZaItem.hasRight(ZaAccount.DELETE_ACCOUNT_RIGHT,s.targetObj)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasAnyRight([ZaAccount.SET_PASSWORD_RIGHT,ZaAccount.CHANGE_PASSWORD_RIGHT],s.targetObj)){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}
if(!ZaItem.hasWritePermission(ZaAccount.A_zimbraAuthTokenValidityValue,s.targetObj)){
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}}}else{
if((s.type==ZaItem.ALIAS)&&(s.attrs[ZaAlias.A_targetType]==ZaItem.RESOURCE)){
if(!s.targetObj){
s.targetObj=s.getAliasTargetObj()
}
var t=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(s.targetObj.rights)){
s.targetObj.loadEffectiveRights("id",s.id,false)
}}
if(!t){
if(!ZaItem.hasRight(ZaResource.DELETE_CALRES_RIGHT,s.targetObj)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasRight(ZaResource.SET_CALRES_PASSWORD_RIGHT,s.targetObj)){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}}}else{
if(s.type==ZaItem.RESOURCE){
var t=false;
if(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=true
}else{
if(AjxUtil.isEmpty(s.rights)){
s.loadEffectiveRights("id",s.id,false)
}}
if(!t){
if(!ZaItem.hasRight(ZaResource.DELETE_CALRES_RIGHT,s)){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}
if(!ZaItem.hasRight(ZaResource.SET_CALRES_PASSWORD_RIGHT,s)){
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}}}else{
if(s.type==ZaItem.DOMAIN||s.type==ZaItem.COS){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}}}}}}}}}else{
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}else{
if(n>1){
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}}else{
if(this._popupOperations[ZaOperation.EXPIRE_SESSION]){
this._popupOperations[ZaOperation.EXPIRE_SESSION].enabled=false
}
if(this._popupOperations[ZaOperation.EDIT]){
this._popupOperations[ZaOperation.EDIT].enabled=false
}
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}
if(this._popupOperations[ZaOperation.CHNG_PWD]){
this._popupOperations[ZaOperation.CHNG_PWD].enabled=false
}
if(this._popupOperations[ZaOperation.MOVE_ALIAS]){
this._popupOperations[ZaOperation.MOVE_ALIAS].enabled=false
}}}
for(var o=0;
o<n;
o++){
var e=this._contentView.getSelection()[o];
if(e&&e.type==ZaItem.ACCOUNT){
if(e.attrs[ZaAccount.A_zimbraIsSystemAccount]=="TRUE"){
if(this._popupOperations[ZaOperation.DELETE]){
this._popupOperations[ZaOperation.DELETE].enabled=false
}}}}};
ZaController.changeActionsStateMethods.ZaSearchListController.push(ZaSearchListController.changeActionsStateMethod);
ZaSearchListController.prototype.getSearchResultStats=function(t,o){
var e={};
if(o){
e=o
}
if(!t||!t.searchTotal){
return e
}
if(t.more||((o&&o.more))){
e.more=true
}
if(e.searchTotal){
e.searchTotal+=t.searchTotal
}else{
e.searchTotal=t.searchTotal
}
if(t[ZaItem.ACCOUNT] instanceof Array){
if(e[ZaItem.ACCOUNT]){
e[ZaItem.ACCOUNT]+=t[ZaItem.ACCOUNT].length
}else{
e[ZaItem.ACCOUNT]=t[ZaItem.ACCOUNT].length
}}
if(t[ZaItem.ALIAS] instanceof Array){
if(e[ZaItem.ALIAS]){
e[ZaItem.ALIAS]+=t[ZaItem.ALIAS].length
}else{
e[ZaItem.ALIAS]=t[ZaItem.ALIAS].length
}}
if(t[ZaItem.DOMAIN] instanceof Array){
if(e[ZaItem.DOMAIN]){
e[ZaItem.DOMAIN]+=t[ZaItem.DOMAIN].length
}else{
e[ZaItem.DOMAIN]=t[ZaItem.DOMAIN].length
}}
if(t[ZaItem.DL] instanceof Array){
if(e[ZaItem.DL]){
e[ZaItem.DL]+=t[ZaItem.DL].length
}else{
e[ZaItem.DL]=t[ZaItem.DL].length
}}
return e
};
ZaSearchListController.prototype.updateSearchTree=function(o,r,n){
if(!n){
return""
}
var s=n.getArray();
var e={};
e.searchTotal=o;
e.more=r;
e[ZaItem.ACCOUNT]=0;
e[ZaItem.DOMAIN]=0;
e[ZaItem.DL]=0;
for(var t=0;
t<s.length;
t++){
if(s[t].type==ZaItem.ACCOUNT){
e[ZaItem.ACCOUNT]++
}else{
if(s[t].type==ZaItem.DOMAIN){
e[ZaItem.DOMAIN]++
}else{
if(s[t].type==ZaItem.DL){
e[ZaItem.DL]++
}}}}
ZaZimbraAdmin.getInstance().getOverviewPanelController().fireSearchEvent(e)
};
ZaSearchListController.prototype._initPopupMenuAtAppBar=function(){
if(AjxUtil.isEmpty(this._popupOrder)){
for(var e in this._popupOperations){
this._popupOrder.push(e)
}
for(var e in this._popupOperationsOnAppBar){
this._popupOrder.push(e)
}}
for(var e in this._popupOperations){
this._popupOperationsOnAppBar[e]=this._popupOperations[e]
}};
ZaSearchListController.prototype.getPopUpOperation=function(){
return this._popupOperationsOnAppBar
}
}
if(AjxPackage.define("zimbraAdmin.search.controller.ZaSearchBuilderController")){
ZaSearchBuilderController=function(t,e){
ZaController.call(this,t,e,"ZaSearchBuilderController");
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/monitoring_zimbra_collaboration_suite.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._helpButtonText=ZaMsg.zimbraHelpCenter;
this._option_views=[];
this._searchBuildPanel=null;
this._searchBuildTBPanel=null;
this._searchBuilderVisible=false;
this._query=null;
this._searchTypes=null;
this._objTypeOptionViewPosition=-1;
this._serverOptionViewPosition=-1;
this._numberOfDomainOptions=0;
this._cosids=null
};
ZaSearchBuilderController.prototype=new ZaController();
ZaSearchBuilderController.prototype.constructor=ZaSearchBuilderController;
ZaSearchBuilderController.prototype.getSearchBuilderPanel=function(){
if(!this._searchBuildPanel){
DBG.println(AjxDebug.DBG3,"Initializing the search builder option panel.");
this._searchBuildPanel=new ZaSearchBuilderView(ZaApp.getInstance().getAppCtxt().getShell());
this.addOptionView(ZaSearchOption.BASIC_TYPE_ID)
}
return this._searchBuildPanel
};
ZaSearchBuilderController.prototype.getSearchBuilderTBPanel=function(){
if(!this._searchBuildTBPanel){
DBG.println(AjxDebug.DBG3,"Initialize the search builder toolbar panel.");
this._searchBuildTBPanel=new ZaSearchBuilderToolbarView(ZaApp.getInstance().getAppCtxt().getShell())
}
return this._searchBuildTBPanel
};
ZaSearchBuilderController.prototype.toggleVisible=function(){
this._searchBuilderVisible=!this._searchBuilderVisible
};
ZaSearchBuilderController.prototype.isSBVisible=function(){
return this._searchBuilderVisible
};
ZaSearchBuilderController.prototype.isAdvancedSearch=function(e){
var t=/\([^\(\)\=]+=[^\(\)\=]+\)/;
if(e.match(t)!=null){
return true
}
return false
};
ZaSearchBuilderController.handleOptions=function(h,e,t){
var n=ZaApp.getInstance().getSearchBuilderController();
var d=ZaApp.getInstance().getSearchListController()._searchField;
var l=e.charCode;
if(l==13||l==3){
d.invokeCallback()
}else{
this.setInstanceValue(h);
var s;
if(h=="TRUE"){
s="FALSE"
}
var o=this.getRef();
if(s=="FALSE"&&o==ZaSearchOption.A_objTypeAccountDomainAdmin){
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountAdmin);
this.setInstanceValue(s,ZaSearchOption.A_objTypeSystemAccount)
}else{
if(s=="FALSE"&&o==ZaSearchOption.A_objTypeAccountAdmin){
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountDomainAdmin);
this.setInstanceValue(s,ZaSearchOption.A_objTypeSystemAccount)
}else{
if(s=="FALSE"&&o==ZaSearchOption.A_objTypeSystemAccount){
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountAdmin);
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountDomainAdmin)
}}}
if((o==ZaSearchOption.A_enableAccountLastLoginTime_From||o==ZaSearchOption.A_enableAccountLastLoginTime_To)&&(h=="TRUE")){
var r;
if(o==ZaSearchOption.A_enableAccountLastLoginTime_From){
r=ZaSearchOption.A_accountLastLoginTime_From
}
if(o==ZaSearchOption.A_enableAccountLastLoginTime_To){
r=ZaSearchOption.A_accountLastLoginTime_To
}
var c=this.getInstanceValue(r);
if(!c){
this.setInstanceValue(new Date(),r)
}}
n.setQuery()
}};
ZaSearchBuilderController.filterDomains=function(o,t,e){
if(AjxUtil.isEmpty(o)||AjxStringUtil.trim(o)==""){
return
}
this.setInstanceValue(o);
var s=Dwt.getNextId();
var r=new AjxCallback(this,ZaSearchBuilderController.optionFilterCallback,{
busyId:s}
);
var n={
query:"("+ZaDomain.A_domainName+"=*"+o+"*)",types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,attrs:[ZaDomain.A_domainName],applyCos:"0",callback:r,controller:ZaApp.getInstance().getCurrentController(),showBusy:true,busyId:s,busyMsg:ZaMsg.BUSY_SEARCHING_DOMAINS,skipCallbackIfCancelled:false};
ZaSearch.searchDirectory(n)
};
ZaSearchBuilderController.filterCOSES=function(o,t,e){
if(AjxUtil.isEmpty(o)||AjxStringUtil.trim(o)==""){
return
}
this.setInstanceValue(o);
var s=Dwt.getNextId();
var r=new AjxCallback(this,ZaSearchBuilderController.optionCosFilterCallback,{
busyId:s}
);
var n={
query:"("+ZaCos.A_name+"=*"+o+"*)",types:[ZaSearch.COSES],sortBy:ZaCos.A_name,attrs:[ZaCos.A_name],applyCos:"0",callback:r,controller:ZaApp.getInstance().getCurrentController(),showBusy:true,busyId:s,busyMsg:ZaMsg.BUSY_SEARCHING_COSES,skipCallbackIfCancelled:false};
ZaSearch.searchDirectory(n)
};
ZaSearchBuilderController.prototype.listAllServers=function(){
var s=this._option_views[this._option_views.length-1];
var o=s._localXForm;
var e=o.getInstance();
var n=ZaServer.getAll().getArray();
var r=new Array(n.length);
for(var t=0;
t<r.length;
t++){
r[t]=n[t].name
}
e.options[ZaSearchOption.A_serverList]=r;
e.options[ZaSearchOption.A_serverListChecked]=new AjxVector();
o.refresh()
};
ZaSearchBuilderController.prototype.updateServerFilter=function(o){
var r=o;
var n=r._localXForm;
var e=n.getInstance();
var s=ZaServer.getAll().getArray();
var h=new Array(s.length);
for(var t=0;
t<h.length;
t++){
h[t]=s[t].name
}
e.options[ZaSearchOption.A_serverList]=h;
e.options[ZaSearchOption.A_serverListChecked]=new AjxVector();
n.refresh()
};
ZaSearchBuilderController.filterSelectionListener=function(r){
var l=r.target;
if(l.type&&l.type=="checkbox"){
var s=this.getRef();
var n=l.value;
var o=this.getForm();
var e=o.getInstance();
var h=null;
if(s==ZaSearchOption.A_domainList){
h=e.options[ZaSearchOption.A_domainListChecked]
}else{
if(s==ZaSearchOption.A_serverList){
h=e.options[ZaSearchOption.A_serverListChecked]
}else{
if(s==ZaSearchOption.A_cosList){
h=e.options[ZaSearchOption.A_cosListChecked]
}}}
var t=o.parent._controller;
if(l.checked){
h.remove(n)
}else{
h.add(n)
}
t.setQuery()
}};
ZaSearchBuilderController.optionFilterCallback=function(l,h){
DBG.println(AjxDebug.DBG3,"Check for the filter results ... ");
if(l.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,l.busyId)
}
var r=this.getForm();
try{
if(!h){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListViewController.prototype.searchCallback"))
}
if(h.isException()){
throw (h.getException())
}else{
var t=h.getResponse().Body.SearchDirectoryResponse;
if(t.domain&&t.domain.length>0){
var e=new Array(t.domain.length);
for(var n=0;
n<e.length;
n++){
if(t.domain[n]){
e[n]=t.domain[n].name
}}
var s=t.searchTotal;
this.setInstanceValue(e,"/options/"+ZaSearchOption.A_domainList);
this.setInstanceValue(new AjxVector(),"/options/"+ZaSearchOption.A_domainListChecked);
r.refresh()
}else{
this.setInstanceValue([],"/options/"+ZaSearchOption.A_domainList);
this.setInstanceValue(new AjxVector(),"/options/"+ZaSearchOption.A_domainListChecked);
r.refresh()
}}}
catch(o){
if(o.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
r.parent._controller._handleException(o,"ZaSearchBuilderController.optionFilterCallback")
}else{
r.parent._controller.popupErrorDialog(ZaMsg.queryParseError,o)
}}};
ZaSearchBuilderController.optionCosFilterCallback=function(l,h){
if(l.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,l.busyId)
}
var s=this.getForm();
var e=ZaApp.getInstance().getSearchBuilderController();
try{
if(!h){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListViewController.prototype.searchCallback"))
}
if(h.isException()){
throw (h.getException())
}else{
var t=h.getResponse().Body.SearchDirectoryResponse;
if(t.cos&&t.cos.length>0){
var r=new Array(t.cos.length);
e._cosids=new Array(t.cos.length);
for(var n=0;
n<r.length;
n++){
r[n]=t.cos[n].name;
e._cosids[r[n]]=t.cos[n].id
}
this.setInstanceValue(r,"/options/"+ZaSearchOption.A_cosList);
this.setInstanceValue(new AjxVector(),"/options/"+ZaSearchOption.A_cosListChecked);
s.refresh()
}else{
this.setInstanceValue([],"/options/"+ZaSearchOption.A_cosList);
this.setInstanceValue(new AjxVector(),"/options/"+ZaSearchOption.A_cosListChecked);
s.refresh()
}}}
catch(o){
if(o.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
s.parent._controller._handleException(o,"ZaSearchBuilderController.optionCosFilterCallback")
}else{
s.parent._controller.popupErrorDialog(ZaMsg.queryParseError,o)
}}};
ZaSearchBuilderController.prototype.handleSpecialQueries=function(){
var o=this.getOptionViews();
this._includeNeverLoggedInAccts=false;
this._includeObjectWithoutCosId=false;
for(var t=0;
t<o.length;
t++){
var n=o[t]._optionId;
var e=o[t]._localXForm.getInstance();
if(this._includeNeverLoggedInAccts==false&&e[ZaSearchOption.A_includeNeverLoginedAccounts]&&e[ZaSearchOption.A_includeNeverLoginedAccounts]=="TRUE"){
this._includeNeverLoggedInAccts=true
}
if(this._includeObjectWithoutCosId==false&&e[ZaSearchOption.A2_cosNotSet]&&e[ZaSearchOption.A2_cosNotSet]=="TRUE"){
this._includeObjectWithoutCosId=true
}}};
ZaSearchBuilderController.prototype.setQuery=function(){
this.handleSpecialQueries();
var c=this.getOptionViews();
this._query=null;
this._searchTypes=null;
this._filterObj={};
this._filterObj[ZaSearchOption.BASIC_TYPE_ID]=[];
this._filterObj[ZaSearchOption.OBJECT_TYPE_ID]=[];
this._filterObj[ZaSearchOption.DOMAIN_ID]=[];
this._filterObj[ZaSearchOption.SERVER_ID]=[];
this._filterObj[ZaSearchOption.ADVANCED_ID]=[];
this._filterObj[ZaSearchOption.COS_ID]=[];
for(var n=0;
n<c.length;
n++){
var o=c[n]._optionId;
var u=c[n]._localXForm.getInstance();
var m=u.options;
var e=[];
if(o==ZaSearchOption.COS_ID&&this._includeObjectWithoutCosId&&(!m[ZaSearchOption.A_cosListChecked]||m[ZaSearchOption.A_cosListChecked].size()==0)){
e.push("(!("+ZaAccount.A_COSId+"=*))")
}
for(var d in m){
var l=m[d];
if(l!=null){
var r=null;
if(l instanceof Date){
l=ZaUtil.getAdminServerDateTime(l,true)
}
if(d==ZaSearchOption.A_accountLastLoginTime_From){
if(u[ZaSearchOption.A_enableAccountLastLoginTime_From]=="TRUE"){
d=ZaAccount.A_zimbraLastLogonTimestamp;
r=">="
}else{
continue
}}
if(d==ZaSearchOption.A_accountLastLoginTime_To){
if(u[ZaSearchOption.A_enableAccountLastLoginTime_To]=="TRUE"){
d=ZaAccount.A_zimbraLastLogonTimestamp;
r="<="
}else{
continue
}}
if((l.length>0)||((l instanceof AjxVector)&&(l.size()>0))){
this._addFilter(e,d,l,r)
}}}
this._filterObj[o].push(e)
}
this._query=this.getQueryFromFilters();
this._searchTypes=this.getSearchTypesFromFilters();
DBG.println(AjxDebug.DBG1,"Current Query String = "+this._query);
var h=ZaApp.getInstance().getSearchListController()._searchField._localXForm;
var t=h.getInstance();
var s=h.getItemsById(ZaSearch.A_query)[0];
if(this.isSBVisible()){
s.toolTipContent=ZaMsg.tt_advancedSearchField;
t[ZaSearch.A_query]=this._query
}else{
s.toolTipContent=null;
t[ZaSearch.A_query]=""
}
h.refresh()
};
ZaSearchBuilderController.prototype._addFilter=function(o,t,s,r){
if(s instanceof String){
s=String(s).replace(/([\\\\\\*\\(\\)])/g,"\\$1")
}
var n=null;
var e=ZaApp.getInstance().getSearchListController();
if(t==ZaSearchOption.A_domainFilter||t==ZaSearchOption.A_domainList||t==ZaSearchOption.A_serverList||t==ZaSearchOption.A_cosFilter||t==ZaSearchOption.A_cosList){}else{
if(t==ZaSearchOption.A_objTypeAccount){
if(s=="TRUE"&&(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])){
o.push(ZaSearch.ACCOUNTS)
}}else{
if(t==ZaSearchOption.A_objTypeDl){
if(s=="TRUE"&&(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DL_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])){
o.push(ZaSearch.DLS)
}}else{
if(t==ZaSearchOption.A_objTypeAlias){
if(s=="TRUE"&&(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ALIAS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])){
o.push(ZaSearch.ALIASES)
}}else{
if(t==ZaSearchOption.A_objTypeResource){
if(s=="TRUE"&&(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.RESOURCE_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])){
o.push(ZaSearch.RESOURCES)
}}else{
if(t==ZaSearchOption.A_objTypeSystemAccount){
if(s=="TRUE"){
n="("+t+"="+s+")"
}}else{
if(t==ZaSearchOption.A_objTypeAccountAdmin){
if(s=="TRUE"){
n="("+t+"="+s+")"
}}else{
if(ZaSearchOption.A_objTypeAccountDomainAdmin&&t==ZaSearchOption.A_objTypeAccountDomainAdmin){
if(s=="TRUE"){
n="("+t+"="+s+")"
}}else{
if(t==ZaSearchOption.A_domainListChecked){
if(s.size()>0){
n=ZaSearchBuilderController.getOrFilter4ListArray(s.getArray(),ZaSearchOption.DOMAIN_ID)
}}else{
if(t==ZaSearchOption.A_serverListChecked){
if(s.size()>0){
n=ZaSearchBuilderController.getOrFilter4ListArray(s.getArray(),ZaSearchOption.SERVER_ID)
}}else{
if(t==ZaSearchOption.A_cosListChecked){
if(s.size()>0){
n=ZaSearchBuilderController.getCosFilter4ListArray(s.getArray())
}}else{
if(t==ZaAccount.A_zimbraLastLogonTimestamp){
n="("+t+r+s+")"
}else{
if(t==ZaSearchOption.A_zimbraMailForwardingAddress){
n="("+t+"=*"+s+"*)";
n+="("+ZaSearchOption.A_zimbraPrefMailForwardingAddress+"=*"+s+"*)";
n="(|"+n+")"
}else{
if(e.searchResultFilter.indexOf(t)>=0){
if(!e._filterObj||!(e._filterObj instanceof Object)){
e._filterObj={}
}
e._filterObj[t]=s
}else{
n="("+t+"=*"+s+"*)"
}}}}}}}}}}}}}}
if(n!=null&&n.length>0){
DBG.println(AjxDebug.DBG1,"Add entry "+n);
o.push(n)
}};
ZaSearchBuilderController.prototype.getSearchTypesFromFilters=function(){
var e=this._filterObj[ZaSearchOption.OBJECT_TYPE_ID];
if(this._objTypeOptionViewPosition<0){
return ZaSearchOption.getDefaultObjectTypes()
}else{
if(e!=null&&e.length>0){
return e
}else{
return[]
}}};
ZaSearchBuilderController.prototype.getQueryFromFilters=function(){
var n="";
var t=0;
for(var e in this._filterObj){
if(e!=ZaSearchOption.OBJECT_TYPE_ID){
var o=this.getOrFilter4SameOptionType(this._filterObj[e],e);
if(o!=null&&o.length>0){
n+=o;
t++
}}}
if(t>1){
n="(&"+n+")"
}
return n
};
ZaSearchBuilderController.prototype.getOrFilter4SameOptionType=function(e,n){
var s="";
var o=0;
if(n==ZaSearchOption.ADVANCED_ID){
if(this._includeNeverLoggedInAccts){
s+="(!("+ZaAccount.A_zimbraLastLogonTimestamp+"=*))";
o++
}}
for(var t=0;
t<e.length;
t++){
s+=this.getAndFilter4EntriesInOneOption(e[t]);
o++
}
if(o>1){
s="(|"+s+")"
}
DBG.println(AjxDebug.DBG3,"Same Option Type Filter = "+s);
return s
};
ZaSearchBuilderController.prototype.getAndFilter4EntriesInOneOption=function(e){
var t=e.join("");
if(e.length>1){
t="(&"+t+")"
}
DBG.println(AjxDebug.DBG3,"One Option Type Filter = "+t);
return t
};
ZaSearchBuilderController.getOrFilter4ListArray=function(e,n){
var o="";
for(var t=0;
t<e.length;
t++){
if(n==ZaSearchOption.DOMAIN_ID){
o+="("+ZaAccount.A_mailDeliveryAddress+"=*@"+e[t]+")("+ZaAccount.A_zimbraMailAlias+"=*@"+e[t]+")"
}else{
if(n==ZaSearchOption.SERVER_ID){
o+="("+ZaAccount.A_mailHost+"="+e[t]+")"
}}}
if(e.length>1||(e.length>0&&n==ZaSearchOption.DOMAIN_ID)){
o="(|"+o+")"
}
return o
};
ZaSearchBuilderController.getCosFilter4ListArray=function(e){
var n="";
var t=ZaApp.getInstance().getSearchBuilderController();
var s=t._cosids;
if(t._includeObjectWithoutCosId){
n+="(!("+ZaAccount.A_COSId+"=*))"
}
if(s&&s.length>0){
for(var o=0;
o<e.length&&o<s.length;
o++){
n+="("+ZaAccount.A_COSId+"="+s[e[o]]+")"
}}
if(s.length>1||(s.length==1&&t._includeObjectWithoutCosId)){
n="(|"+n+")"
}
return n
};
ZaSearchBuilderController.prototype.getQuery=function(){
return this._query
};
ZaSearchBuilderController.prototype.getAddressTypes=function(){
return this._searchTypes
};
ZaSearchBuilderController.prototype.addOptionView=function(n){
var e=this._option_views.length;
var t=this._searchBuildPanel||this.getSearchBuilderPanel();
var o=ZaSearchOptionView.WIDTH;
if(n==ZaSearchOption.BASIC_TYPE_ID){
o=ZaSearchOptionView.BASIC_OPTION_WIDTH
}else{
if(n==ZaSearchOption.ADVANCED_ID){
o=ZaSearchOptionView.ADVANCED_OPTION_WIDTH
}else{
if(n==ZaSearchOption.OBJECT_TYPE_ID){
if(this._objTypeOptionViewPosition>=0){
return
}else{
this._objTypeOptionViewPosition=e
}}else{
if(n==ZaSearchOption.SERVER_ID){
if(this._serverOptionViewPosition>=0){
return
}else{
this._serverOptionViewPosition=e
}}else{
if(n==ZaSearchOption.DOMAIN_ID){
o=ZaSearchOptionView.DOMAIN_OPTION_WIDTH
}else{
if(n==ZaSearchOption.COS_ID){
o=ZaSearchOptionView.COS_OPTION_WIDTH
}}}}}}
this._option_views.push(new ZaSearchOptionView(t,n,o,e))
};
ZaSearchBuilderController.prototype.removeAllOptionViews=function(){
for(var e=this._option_views.length-1;
e>=0;
e--){
this.removeOptionView(e)
}};
ZaSearchBuilderController.prototype.removeOptionView=function(o,n){
var r=this._option_views[o];
var h=r.getY();
r.dispose();
this._option_views.splice(o,1);
if(r._optionId==ZaSearchOption.OBJECT_TYPE_ID){
this._objTypeOptionViewPosition=-1;
this._searchBuildTBPanel.getButton(ZaOperation.SEARCH_BY_ADDESS_TYPE).setEnabled(true)
}else{
if(r._optionId==ZaSearchOption.SERVER_ID){
this._serverOptionViewPosition=-1;
this._searchBuildTBPanel.getButton(ZaOperation.SEARCH_BY_SERVER).setEnabled(true)
}}
if(n){
var t=this._option_views.length;
for(var s=o;
s<t;
s++){
var e=this._searchBuildPanel.getNextOptionX(s);
this._option_views[s].setLocation(e,h);
this._option_views[s].setPosition(s)
}
this.setQuery()
}};
ZaSearchBuilderController.prototype.getOptionViews=function(){
return this._option_views
};
ZaSearchBuilderController.newHandleOptions=function(h,e,t){
var l=e.charCode;
if(l==13||l==3){}else{
this.setInstanceValue(h);
var s;
if(h=="TRUE"){
s="FALSE"
}
var o=this.getRef();
if(s=="FALSE"&&o==ZaSearchOption.A_objTypeAccountDomainAdmin){
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountAdmin);
this.setInstanceValue(s,ZaSearchOption.A_objTypeSystemAccount)
}else{
if(s=="FALSE"&&o==ZaSearchOption.A_objTypeAccountAdmin){
if(ZaSearchOption.A_objTypeAccountDomainAdmin){
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountDomainAdmin)
}
this.setInstanceValue(s,ZaSearchOption.A_objTypeSystemAccount)
}else{
if(s=="FALSE"&&o==ZaSearchOption.A_objTypeSystemAccount){
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountAdmin);
if(ZaSearchOption.A_objTypeAccountDomainAdmin){
this.setInstanceValue(s,ZaSearchOption.A_objTypeAccountDomainAdmin)
}}}}
if((o==ZaSearchOption.A_enableAccountLastLoginTime_From||o==ZaSearchOption.A_enableAccountLastLoginTime_To)&&(h=="TRUE")){
var r;
if(o==ZaSearchOption.A_enableAccountLastLoginTime_From){
r=ZaSearchOption.A_accountLastLoginTime_From
}
if(o==ZaSearchOption.A_enableAccountLastLoginTime_To){
r=ZaSearchOption.A_accountLastLoginTime_To
}
var c=this.getInstanceValue(r);
if(!c){
this.setInstanceValue(new Date(),r)
}}
if(o==ZaSearchOption.A2_status_active||o==ZaSearchOption.A2_status_closed||o==ZaSearchOption.A2_status_locked||o==ZaSearchOption.A2_status_lockout||o==ZaSearchOption.A2_status_pending||o==ZaSearchOption.A2_status_maintenance){
var n=[];
if(this.getInstanceValue(ZaSearchOption.A2_status_active)=="TRUE"){
n.push(ZaAccount.ACCOUNT_STATUS_ACTIVE)
}
if(this.getInstanceValue(ZaSearchOption.A2_status_closed)=="TRUE"){
n.push(ZaAccount.ACCOUNT_STATUS_CLOSED)
}
if(this.getInstanceValue(ZaSearchOption.A2_status_locked)=="TRUE"){
n.push(ZaAccount.ACCOUNT_STATUS_LOCKED)
}
if(this.getInstanceValue(ZaSearchOption.A2_status_lockout)=="TRUE"){
n.push(ZaAccount.ACCOUNT_STATUS_LOCKOUT)
}
if(this.getInstanceValue(ZaSearchOption.A2_status_pending)=="TRUE"){
n.push(ZaAccount.ACCOUNT_STATUS_PENDING)
}
if(this.getInstanceValue(ZaSearchOption.A2_status_maintenance)=="TRUE"){
n.push(ZaAccount.ACCOUNT_STATUS_MAINTENANCE)
}
this.setInstanceValue(n,ZaSearchOption.A2_status_list)
}}};
ZaSearchBuilderController.prototype.newHandleSpecialQueries=function(){
var o=this.getFilterDialogArray();
this._includeNeverLoggedInAccts=false;
this._includeObjectWithoutCosId=false;
for(var t=0;
t<o.length;
t++){
var n=o[t]._optionId;
var e=o[t]._localXForm.getInstance();
if(this._includeNeverLoggedInAccts==false&&e[ZaSearchOption.A_includeNeverLoginedAccounts]&&e[ZaSearchOption.A_includeNeverLoginedAccounts]=="TRUE"){
this._includeNeverLoggedInAccts=true
}
if(this._includeObjectWithoutCosId==false&&e[ZaSearchOption.A2_cosNotSet]&&e[ZaSearchOption.A2_cosNotSet]=="TRUE"){
this._includeObjectWithoutCosId=true
}}};
ZaSearchBuilderController.prototype.setNewQuery=function(r){
this.newHandleSpecialQueries();
var d=this.getFilterDialogArray();
this._query=null;
this._searchTypes=null;
this._filterObj=null;
var n=r._optionId;
var m=r._localXForm.getInstance();
var f=m.options;
var e=[];
if(n==ZaSearchOption.COS_FILTER_ID&&this._includeObjectWithoutCosId&&(!f[ZaSearchOption.A_cosListChecked]||f[ZaSearchOption.A_cosListChecked].size()==0)){
e.push("(!("+ZaAccount.A_COSId+"=*))")
}
for(var u in f){
var c=f[u];
if(c!=null){
var s=null;
if(c instanceof Date){
c=ZaUtil.getAdminServerDateTime(c,true)
}
if(u==ZaSearchOption.A_accountLastLoginTime_From){
if(m[ZaSearchOption.A_enableAccountLastLoginTime_From]=="TRUE"){
u=ZaAccount.A_zimbraLastLogonTimestamp;
s=">="
}else{
continue
}}
if(u==ZaSearchOption.A_accountLastLoginTime_To){
if(m[ZaSearchOption.A_enableAccountLastLoginTime_To]=="TRUE"){
u=ZaAccount.A_zimbraLastLogonTimestamp;
s="<="
}else{
continue
}}
if((c.length>0)||((c instanceof AjxVector)&&(c.size()>0))){
this._newAddFilter(e,u,c,s)
}}}
var l=ZaApp.getInstance().getSearchListController();
if(l._uiContainer){
var h=this.newGetOrFilter4SameOptionType([e],n);
var o=false;
if(n==ZaSearchOption.SERVER_FILTER_ID){
o=true
}
var t={
type:2,unique:o,query:h,optionalType:n,displayName:this.getFilterTypeName(r._optionId)};
l._uiContainer.addBubble(t)
}};
ZaSearchBuilderController.prototype.getFilterTypeName=function(t){
var e;
switch(t){
case ZaSearchOption.BASIC_FILTER_ID:e=ZaMsg.OVP_basicFilter;
break;
case ZaSearchOption.STATUS_FILTER_ID:e=ZaMsg.OVP_statutsFilter;
break;
case ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID:e=ZaMsg.OVP_lltFilter;
break;
case ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID:e=ZaMsg.OVP_eeaFilter;
break;
case ZaSearchOption.COS_FILTER_ID:e=ZaMsg.OVP_cosFilter;
break;
case ZaSearchOption.SERVER_FILTER_ID:e=ZaMsg.OVP_serverFilter;
break;
case ZaSearchOption.DOMAIN_FILTER_ID:e=ZaMsg.OVP_domainFilter;
break
}
return e
};
ZaSearchBuilderController.prototype._newAddFilter=function(o,t,s,r){
if(s instanceof String){
s=String(s).replace(/([\\\\\\*\\(\\)])/g,"\\$1")
}
var n=null;
var e=ZaApp.getInstance().getSearchListController();
if(t==ZaSearchOption.A_domainFilter||t==ZaSearchOption.A_domainList||t==ZaSearchOption.A_serverList||t==ZaSearchOption.A_cosFilter||t==ZaSearchOption.A_cosList||t==ZaSearchOption.A2_status_active||t==ZaSearchOption.A2_status_closed||t==ZaSearchOption.A2_status_locked||t==ZaSearchOption.A2_status_lockout||t==ZaSearchOption.A2_status_pending||t==ZaSearchOption.A2_status_maintenance){}else{
if(t==ZaSearchOption.A_objTypeSystemAccount){
if(s=="TRUE"){
n="("+t+"="+s+")"
}}else{
if(t==ZaSearchOption.A_objTypeAccountAdmin){
if(s=="TRUE"){
n="("+t+"="+s+")"
}}else{
if(ZaSearchOption.A_objTypeAccountDomainAdmin&&t==ZaSearchOption.A_objTypeAccountDomainAdmin){
if(s=="TRUE"){
n="("+t+"="+s+")"
}}else{
if(t==ZaSearchOption.A_domainListChecked){
if(s.size()>0){
n=ZaSearchBuilderController.newGetOrFilter4ListArray(s.getArray(),ZaSearchOption.DOMAIN_FILTER_ID)
}}else{
if(t==ZaSearchOption.A_serverListChecked){
if(s.size()>0){
n=ZaSearchBuilderController.newGetOrFilter4ListArray(s.getArray(),ZaSearchOption.SERVER_FILTER_ID)
}}else{
if(t==ZaSearchOption.A_cosListChecked){
if(s.size()>0){
n=ZaSearchBuilderController.newGetCosFilter4ListArray(s.getArray())
}}else{
if(t==ZaSearchOption.A2_status_list){
if(s.length>0){
n=ZaSearchBuilderController.newGetOrFilter4ListArray(s,ZaSearchOption.STATUS_FILTER_ID)
}}else{
if(t==ZaAccount.A_zimbraLastLogonTimestamp){
n="("+t+r+s+")"
}else{
if(t==ZaSearchOption.A_zimbraMailForwardingAddress){
n="("+t+"=*"+s+"*)";
n+="("+ZaSearchOption.A_zimbraPrefMailForwardingAddress+"=*"+s+"*)";
n="(|"+n+")"
}else{
n="("+t+"=*"+s+"*)"
}}}}}}}}}}
if(n!=null&&n.length>0){
o.push(n)
}};
ZaSearchBuilderController.prototype.newGetQueryFromFilters=function(){
var n="";
var t=0;
for(var e in this._filterObj){
var o=this.newGetOrFilter4SameOptionType(this._filterObj[e],e);
if(o!=null&&o.length>0){
n+=o;
t++
}}
if(t>1){
n="(&"+n+")"
}
return n
};
ZaSearchBuilderController.prototype.newGetOrFilter4SameOptionType=function(e,n){
var s="";
var o=0;
if(n==ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID){
if(this._includeNeverLoggedInAccts){
s+="(!("+ZaAccount.A_zimbraLastLogonTimestamp+"=*))";
o++
}}
for(var t=0;
t<e.length;
t++){
s+=this.newGetAndFilter4EntriesInOneOption(e[t]);
o++
}
if(o>1){
s="(|"+s+")"
}
return s
};
ZaSearchBuilderController.prototype.newGetAndFilter4EntriesInOneOption=function(e){
var t=e.join("");
if(e.length>1){
t="(&"+t+")"
}
return t
};
ZaSearchBuilderController.newGetOrFilter4ListArray=function(e,n){
var o="";
for(var t=0;
t<e.length;
t++){
if(n==ZaSearchOption.DOMAIN_FILTER_ID){
o+="("+ZaAccount.A_mailDeliveryAddress+"=*@"+e[t]+")("+ZaAccount.A_zimbraMailAlias+"=*@"+e[t]+")"
}else{
if(n==ZaSearchOption.SERVER_FILTER_ID){
o+="("+ZaAccount.A_mailHost+"="+e[t]+")"
}else{
if(n==ZaSearchOption.STATUS_FILTER_ID){
o+="("+ZaAccount.A_accountStatus+"="+e[t]+")"
}}}}
if(e.length>1||(e.length>0&&n==ZaSearchOption.DOMAIN_FILTER_ID)){
o="(|"+o+")"
}
return o
};
ZaSearchBuilderController.newGetCosFilter4ListArray=function(e){
var n="";
var t=ZaApp.getInstance().getSearchBuilderController();
var s=t._cosids;
if(t._includeObjectWithoutCosId){
n+="(!("+ZaAccount.A_COSId+"=*))"
}
if(s&&s.length>0){
for(var o=0;
o<e.length&&o<s.length;
o++){
n+="("+ZaAccount.A_COSId+"="+s[e[o]]+")"
}}
if(s.length>1||(s.length==1&&t._includeObjectWithoutCosId)){
n="(|"+n+")"
}
return n
};
ZaSearchBuilderController.prototype.getFilterTreeItems=function(){
return[{
text:ZaMsg.OVP_basicFilter,filterType:ZaSearchOption.BASIC_FILTER_ID}
,{
text:ZaMsg.OVP_statutsFilter,filterType:ZaSearchOption.STATUS_FILTER_ID}
,{
text:ZaMsg.OVP_lltFilter,filterType:ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID}
,{
text:ZaMsg.OVP_eeaFilter,filterType:ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID}
,{
text:ZaMsg.OVP_cosFilter,filterType:ZaSearchOption.COS_FILTER_ID}
,{
text:ZaMsg.OVP_serverFilter,filterType:ZaSearchOption.SERVER_FILTER_ID}
,{
text:ZaMsg.OVP_domainFilter,filterType:ZaSearchOption.DOMAIN_FILTER_ID}
]
};
ZaSearchBuilderController.searchFilterTreeListener=function(h){
var e=h.item.getData("filterType");
var s={};
var o=h.item.getBounds();
s.x=o.x+o.width;
s.y=o.y;
var r;
var n=ZaApp.getInstance().getSearchBuilderController();
var l=false;
switch(e){
case ZaSearchOption.BASIC_FILTER_ID:r=n.getFilterDialogByType(ZaSearchOption.BASIC_FILTER_ID);
break;
case ZaSearchOption.SERVER_FILTER_ID:r=n.getFilterDialogByType(ZaSearchOption.SERVER_FILTER_ID,true);
n.updateServerFilter(r);
l=true;
break;
case ZaSearchOption.COS_FILTER_ID:r=n.getFilterDialogByType(ZaSearchOption.COS_FILTER_ID);
break;
case ZaSearchOption.DOMAIN_FILTER_ID:r=n.getFilterDialogByType(ZaSearchOption.DOMAIN_FILTER_ID);
break;
case ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID:r=n.getFilterDialogByType(ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID);
break;
case ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID:r=n.getFilterDialogByType(ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID);
break;
case ZaSearchOption.STATUS_FILTER_ID:r=n.getFilterDialogByType(ZaSearchOption.STATUS_FILTER_ID);
break
}
if(r){
ZaSearchBuilderController.currentPopupDialog=r;
if(!l){
r._localXForm.setInstance(ZaSearchOption.getDefaultInstance(r._optionId))
}
r.popup(s);
var c=DwtOutsideMouseEventMgr.INSTANCE;
var t={
id:"ZaOptionView",obj:r,outsideListener:ZaSearchBuilderController.getOutsideListener()};
c.startListening(t)
}};
ZaSearchBuilderController.filterDialogSet={};
ZaSearchBuilderController.currentPopupDialog=undefined;
ZaSearchBuilderController.outSideListener=undefined;
ZaSearchBuilderController.prototype.getFilterDialogArray=function(){
var e=[];
for(var t in ZaSearchBuilderController.filterDialogSet){
if(ZaSearchBuilderController.filterDialogSet[t]){
e.push(ZaSearchBuilderController.filterDialogSet[t])
}}
return e
};
ZaSearchBuilderController.getOutsideListener=function(){
if(!ZaSearchBuilderController.outSideListener){
ZaSearchBuilderController.outSideListener=new AjxListener(null,ZaSearchBuilderController.outsideListener)
}
return ZaSearchBuilderController.outSideListener
};
ZaSearchBuilderController.outsideListener=function(o,e){
if(ZaSearchBuilderController.currentPopupDialog){
if(ZaSearchBuilderController._isChildMenuClicked(o.target)){
return
}
ZaSearchBuilderController.currentPopupDialog.popdown();
var t=DwtOutsideMouseEventMgr.INSTANCE;
t.stopListening({
id:"ZaOptionView",obj:ZaSearchBuilderController.currentPopupDialog}
);
ZaSearchBuilderController.currentPopupDialog=undefined
}};
ZaSearchBuilderController._isChildMenuClicked=function(e){
while(e&&e.className!="DwtShell"){
if(e.className=="DwtMenu"){
return true
}
e=e.parentElement?e.parentElement:e.parentNode
}
return false
};
ZaSearchBuilderController.prototype.getFilterDialogByType=function(n,t){
if(!ZaSearchBuilderController.filterDialogSet[n]||t){
var e,o;
if(n==ZaSearchOption.SERVER_FILTER_ID){
e=ZaSearchOptionView.WIDTH+10;
o=150
}else{
if(n==ZaSearchOption.COS_FILTER_ID){
e=ZaSearchOptionView.COS_OPTION_WIDTH
}else{
if(n==ZaSearchOption.DOMAIN_FILTER_ID){
e=ZaSearchOptionView.DOMAIN_OPTION_WIDTH;
o=150
}else{
if(n==ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID){
e=240;
o=60
}}}}
ZaSearchBuilderController.filterDialogSet[n]=new ZaSearchOptionDialog(ZaApp.getInstance().getAppCtxt().getShell(),n,e,o);
ZaSearchBuilderController.filterDialogSet[n].registerCallback(DwtDialog.OK_BUTTON,this.filterOKListener,this,n)
}
return ZaSearchBuilderController.filterDialogSet[n]
};
ZaSearchBuilderController.prototype.filterOKListener=function(o){
var e=this.getFilterDialogByType(o);
e.popdown();
e._controller.setNewQuery(e);
var t=DwtOutsideMouseEventMgr.INSTANCE;
t.stopListening({
id:"ZaOptionView",obj:e}
);
ZaSearchBuilderController.currentPopupDialog=undefined
}
}
if(AjxPackage.define("zimbraAdmin.task.controller.ZaTaskController")){
ZaTaskController=function(t,e){
ZaController.call(this,t,e,"ZaTaskController");
this._workingInProcess=new AjxVector();
this._workingInProcess.getArray()._version=1;
this._runningTask=new AjxVector();
this._runningTask.getArray()._version=1;
this._notification={
_msgNames:{}}
};
ZaTaskController.prototype=new ZaController();
ZaTaskController.prototype.constructor=ZaTaskController;
ZaTaskController.prototype.getTaskHeaderPanel=function(){
if(!this._taskHeadPanel){
this._taskHeadPanel=new ZaTaskHeaderPanel(this._container)
}
return this._taskHeadPanel
};
ZaTaskController.prototype.getTaskContentPanel=function(e){
if(!this._taskContentPanel){
if(!e){
e=new ZaTask();
e.load(false,false,true);
e[ZaModel.currentTab]="1";
e[ZaModel.currentStep]=1
}
this._taskContentPanel=new ZaTaskContentView(this._container,e);
this._taskContentPanel.setObject(e)
}
return this._taskContentPanel
};
ZaTaskController.prototype.addTask=function(o){
var t;
var s;
if(o.type==1){
t=this._workingInProcess;
s=ZaTask.A_workingInProcess
}else{
t=this._runningTask;
s=ZaTask.A_runningTask
}
var n=t.indexOfLike(o,o.getData);
t.getArray()._version=t.getArray()._version+1;
if(n==-1){
t.add(o,undefined,true);
this._taskContentPanel._localXForm.setInstanceValue(t.getArray(),s)
}else{
var e=t.get(n);
o.displayName=e.displayName;
t.replace(n,o);
this._taskContentPanel._localXForm.setInstanceValue(t.getArray(),s)
}};
ZaTaskController.prototype.removeTask=function(t){
var e;
var n;
if(t.type==1){
e=this._workingInProcess;
n=ZaTask.A_workingInProcess
}else{
e=this._runningTask;
n=ZaTask.A_runningTask
}
var o=e.indexOfLike(t,t.getData);
if(o!=-1){
e.getArray()._version=e.getArray()._version+1;
e.removeAt(o);
this._taskContentPanel._localXForm.setInstanceValue(e.getArray(),n)
}};
ZaTaskController.prototype.setExpanded=function(t){
var e;
if(t){
e=ZaSkin.hints.rightTask.maxWidth||220
}else{
e=ZaSkin.hints.rightTask.minWidth||20
}
window.skin.setToolWidth(e);
window.skin._reflowApp();
this._taskContentPanel._localXForm.setInstanceValue(t,ZaTask.A2_isExpanded)
};
ZaTaskController.prototype.setInstanceValue=function(t,e){
if(this._taskContentPanel&&this._taskContentPanel._localXForm){
this._taskContentPanel._localXForm.setInstanceValue(t,e)
}};
ZaTaskController.prototype.getInstanceValue=function(e){
if(this._taskContentPanel&&this._taskContentPanel._localXForm){
return this._taskContentPanel._localXForm.getInstanceValue(e)
}
return null
};
ZaTaskController.prototype.increaseNotificationCount=function(t){
if(AjxUtil.isEmpty(t)){
return
}
if(!this._notification._msgNames[t]){
this._notification._msgNames[t]=true;
var e=this.getInstanceValue(ZaTask.A2_notificationCount)||0;
this.setInstanceValue(++e,ZaTask.A2_notificationCount)
}};
ZaTaskController.prototype.decreaseNotificationCount=function(t){
if(AjxUtil.isEmpty(t)){
return
}
if(this._notification._msgNames[t]){
this._notification._msgNames[t]=false;
var e=this.getInstanceValue(ZaTask.A2_notificationCount)||0;
if(e>0){
this.setInstanceValue(--e,ZaTask.A2_notificationCount)
}}}
}
if(AjxPackage.define("zimbraAdmin.home.model.ZaHome")){
ZaHome=function(){
ZaItem.call(this,"ZaHome");
this._init()
};
ZaItem.loadMethods.ZaHome=new Array();
ZaItem.initMethods.ZaHome=new Array();
ZaHome.postLoadDataFunction=new Array();
ZaHome.prototype=new ZaItem;
ZaHome.prototype.constructor=ZaHome;
ZaHome.A2_version="version";
ZaHome.A2_account="account";
ZaHome.A2_serverNum="serverNum";
ZaHome.A2_accountNum="accountNum";
ZaHome.A2_cosNum="cosNum";
ZaHome.A2_domainNum="domainNum";
ZaHome.A2_lastCleanup="lastCleanup";
ZaHome.A2_lastCleanupTime="lastCleanupTime";
ZaHome.A2_lastLogPurge="lastLogPurge";
ZaHome.A2_lastLogPurgeTime="lastLogPurgeTime";
ZaHome.A2_DBCheckType="dbCheckType";
ZaHome.A2_DBCheckMessage="dbCheckMessage";
ZaHome.A2_serviceStatus="serviceStatus";
ZaHome.A2_serviceStatusMessage="serviceStatusMessage";
ZaHome.A2_serviceDetailedMessage="serviceDetailedMessage";
ZaHome.A2_activeSession="activeSession";
ZaHome.A2_queueLength="queueLength";
ZaHome.A2_messageCount="messageCount";
ZaHome.A2_messageVolume="messageVolume";
ZaHome.A2_showWarningPanel="showWarningPanel";
ZaHome.A2_maintenanceItemNum="maintenanceItemNum";
ZaHome.initMethod=function(){
this.attrs=new Object();
this.type=ZaItem.HOME
};
ZaItem.initMethods.ZaHome.push(ZaHome.initMethod);
ZaHome.loadMethod=function(){
var e=new Date();
var t=AjxDateFormat.getDateInstance(AjxDateFormat.LONG);
var o=t.format(e);
this.attrs[ZaHome.A2_account]=ZaZimbraAdmin.currentAdminAccount.attrs.mail;
this.attrs[ZaHome.A2_version]=ZaServerVersionInfo.version;
this.attrs[ZaHome.A2_accountNum]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_cosNum]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_domainNum]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_serverNum]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_activeSession]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_lastCleanup]=true;
this.attrs[ZaHome.A2_lastCleanupTime]=o;
this.attrs[ZaHome.A2_lastLogPurge]=true;
this.attrs[ZaHome.A2_lastLogPurgeTime]=o;
this.attrs[ZaHome.A2_DBCheckType]=true;
this.attrs[ZaHome.A2_DBCheckMessage]=ZaMsg.LBL_HomeStatusOK;
this.attrs[ZaHome.A2_serviceStatusMessage]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_serviceDetailedMessage]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_queueLength]=ZaMsg.MSG_HomeLoading;
this.attrs[ZaHome.A2_messageCount]="120/h";
this.attrs[ZaHome.A2_messageVolume]="34MB/h";
this.attrs[ZaHome.A2_showWarningPanel]=false;
this.attrs[ZaHome.A2_maintenanceItemNum]=1
};
ZaItem.loadMethods.ZaHome.push(ZaHome.loadMethod);
ZaHome.updateMaintenanceNum=function(){
var e=1;
try{
var o=ZaApp.getInstance().getHomeViewController();
var n=o._view._localXForm.getItemsById("maintenance_grp");
e=n[0].items.length
}
catch(t){}
ZaApp.getInstance().getHomeViewController().setInstanceValue(e,ZaHome.A2_maintenanceItemNum)
};
ZaHome.postLoadDataFunction.push(ZaHome.updateMaintenanceNum);
ZaHome.accountStatCallback=function(e){
ZaApp.getInstance().getHomeViewController().setInstanceValue(e[ZaItem.ACCOUNT],ZaHome.A2_accountNum)
};
ZaHome.loadAccountNum=function(){
var e=new AjxCallback(ZaHome.accountStatCallback);
ZaSearch.getObjectCounts([ZaItem.ACCOUNT],e)
};
ZaHome.postLoadDataFunction.push(ZaHome.loadAccountNum);
ZaHome.loadServerServerNum=function(){
var o=AjxSoapDoc.create("GetAllServersRequest",ZaZimbraAdmin.URN,null);
o.getMethod().setAttribute("applyConfig","false");
var e=new AjxCallback(this,this.updateServerNum);
var s=new Object();
s.soapDoc=o;
s.asyncMode=true;
s.callback=e;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_SERVER};
var n=ZaRequestMgr.invoke(s,t);
return n
};
ZaHome.postLoadDataFunction.push(ZaHome.loadServerServerNum);
ZaHome.prototype.updateServerNum=function(n){
var e=1;
try{
var n=n.getResponse().Body.GetAllServersResponse;
var o=new ZaItemList(ZaServer);
o.loadFromJS(n);
e=o.size()
}
catch(t){}
ZaApp.getInstance().getHomeViewController().setInstanceValue(e,ZaHome.A2_serverNum)
};
ZaHome.domainStatCallback=function(e){
ZaApp.getInstance().getHomeViewController().setInstanceValue(e[ZaItem.DOMAIN],ZaHome.A2_domainNum)
};
ZaHome.loadDomainNum=function(){
var e=new AjxCallback(ZaHome.domainStatCallback);
ZaSearch.getObjectCounts([ZaItem.DOMAIN],e)
};
ZaHome.postLoadDataFunction.push(ZaHome.loadDomainNum);
ZaHome.loadCosNum=function(){
var t=function(o){
ZaApp.getInstance().getHomeViewController().setInstanceValue(o.size(),ZaHome.A2_cosNum)
};
try{
ZaApp.getInstance().getCosList(true,t)
}
catch(e){}};
ZaHome.postLoadDataFunction.push(ZaHome.loadCosNum);
ZaHome.prototype.updateCosNum=function(t){
var e=1;
ZaApp.getInstance().getHomeViewController().setInstanceValue(e,ZaHome.A2_cosNum)
};
ZaHome.loadStatusfo=function(){
try{
var o=ZaApp.getInstance().getGlobalConfig().attrs[ZaServer.A_zimbraLogHostname];
if(o){
var n=AjxSoapDoc.create("GetServiceStatusRequest",ZaZimbraAdmin.URN,null);
var e=new AjxCallback(this,this.updateServiceStatus);
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=n;
s.asyncMode=true;
s.noAuthToken=true;
s.callback=e;
r.invoke(s)
}else{
this.updateServiceStatus()
}}
catch(t){
this.attrs[ZaHome.A2_serviceStatusMessage]=ZaMsg.LBL_HOmeStatusUnknown;
this.attrs[ZaHome.A2_serviceDetailedMessage]=ZaMsg.LBL_HomeDetailedServiceUnknown
}};
ZaHome.postLoadDataFunction.push(ZaHome.loadStatusfo);
ZaHome.prototype.updateServiceStatus=function(o){
var s=new ZaStatus();
if(o){
o=o.getResponse().Body.GetServiceStatusResponse;
s.initFromJS(o)
}
var t;
var d=ZaMsg.LBL_HOmeStatusUnknown;
var c=ZaMsg.LBL_HomeDetailedServiceUnknown;
try{
var n=s.getStatusVector();
var r;
if(n.size()>0){
t=true;
d=ZaMsg.LBL_HomeStatusRunning;
for(var h=0;
h<n.size();
h++){
r=n.get(h);
if(r.status!=1){
t=false;
d=ZaMsg.LBL_HomeStatusFailed;
c=ZaMsg.LBL_HomeDetailedServiceNotRunning;
break
}}}}
catch(l){}
var e=ZaApp.getInstance().getHomeViewController();
e.setInstanceValue(t,ZaHome.A2_serviceStatus);
e.setInstanceValue(d,ZaHome.A2_serviceStatusMessage);
e.setInstanceValue(c,ZaHome.A2_serviceDetailedMessage);
if(t!=true&&ZaHomeXFormView.showStatusInfo()){
e.showWarningPanel()
}};
ZaHome.startLoadingSessions=function(){
ZaHome.totalSession=0;
var e=new AjxCallback(this,ZaHome.startLoadingSessionsCallback);
ZaApp.getInstance().getMailServers(false,e)
};
ZaHome.postLoadDataFunction.push(ZaHome.startLoadingSessions);
ZaHome.startLoadingSessionsCallback=function(s){
if(s.getResponse()&&s.getResponse().Body&&s.getResponse().Body.GetAllServersResponse){
var o=new ZaItemList(ZaServer);
o.loadFromJS(s.getResponse().Body.GetAllServersResponse);
var t=o.getArray();
for(var e=0;
e<t.length;
e++){
var n=t[e];
var r=new AjxCallback(this,ZaHome.loadActiveSession,n);
n.loadEffectiveRights("id",n.id,true,r)
}}};
ZaHome.totalSession=0;
ZaHome.loadActiveSession=function(t,h){
if(h&&h.getResponse()&&h.getResponse().Body&&h.getResponse().Body.GetEffectiveRightsResponse&&t){
t.initEffectiveRightsFromJS(h.getResponse().Body.GetEffectiveRightsResponse);
var d=["soap","admin","imap"];
for(var s=0;
s<d.length;
s++){
if(ZaItem.hasRight(ZaServer.RIGHT_GET_SESSIONS,t)){
var e=new AjxCallback(this,ZaHome.loadOneSessionNumer);
try{
var c=AjxSoapDoc.create("GetSessionsRequest",ZaZimbraAdmin.URN,null);
var n={};
n.type=d[s];
c.getMethod().setAttribute("type",n.type);
n.fresh=1;
c.getMethod().setAttribute("refresh",n.fresh);
c.getMethod().setAttribute("limit",ZaServerSessionStatsPage.PAGE_LIMIT);
n.offset=0;
c.getMethod().setAttribute("offset",n.offset);
n.sortBy="nameAsc";
c.getMethod().setAttribute("sortBy",n.sortBy);
var r=new ZmCsfeCommand();
n.soapDoc=c;
n.asyncMode=true;
n.noAuthToken=true;
n.callback=e;
var o=r.invoke(n)
}
catch(l){
e.run()
}}}}};
ZaHome.loadOneSessionNumer=function(t){
if(t&&t.getException&&!t.getException()){
t=t.getResponse();
if(t&&t.Body&&t.Body.GetSessionsResponse){
var e=t.Body.GetSessionsResponse;
ZaHome.totalSession+=e.total
}}
this.updateSessionNum(ZaHome.totalSession)
};
ZaHome.prototype.updateSessionNum=function(e){
ZaApp.getInstance().getHomeViewController().setInstanceValue(e,ZaHome.A2_activeSession)
};
ZaHome.startLoadingMTAS=function(){
ZaHome.totalSession=0;
var s=ZaApp.getInstance().getPostQList();
if(s){
var t=s.getArray();
for(var e=0;
e<t.length;
e++){
var o=t[e];
var n=ZaHome.loadQueueLength.bind(this,o);
o.loadEffectiveRights("id",o.id,true,n)
}}};
ZaHome.postLoadDataFunction.push(ZaHome.startLoadingMTAS);
ZaHome.totalQueueLength=0;
ZaHome.loadQueueLength=function(e,s){
if(s&&s.getResponse()&&s.getResponse().Body&&s.getResponse().Body.GetEffectiveRightsResponse&&e){
e.initEffectiveRightsFromJS(s.getResponse().Body.GetEffectiveRightsResponse);
if(ZaItem.hasRight(ZaServer.MANAGE_MAIL_QUEUE_RIGHT,e)){
var n=false;
var c=new AjxCallback(this,ZaHome.loadOneQueueNumber);
try{
var l=AjxSoapDoc.create("GetMailQueueInfoRequest",ZaZimbraAdmin.URN,null);
var r=l.set("server","");
r.setAttribute("name",e.name);
var t=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=l;
o.asyncMode=true;
o.noAuthToken=true;
o.callback=c;
t.invoke(o)
}
catch(h){}}}};
ZaHome.loadOneQueueNumber=function(n){
if(n&&n.getException&&!n.getException()){
n=n.getResponse();
var t=n.Body;
if(t&&t.GetMailQueueInfoResponse.server&&t.GetMailQueueInfoResponse.server[0]){
var e=t.GetMailQueueInfoResponse.server[0].queue;
for(var o in e){
if(e[o].n){
ZaHome.totalQueueLength+=parseInt(e[o].n)
}}}}
this.updateQueueLength(ZaHome.totalQueueLength)
};
ZaHome.prototype.updateQueueLength=function(e){
ZaApp.getInstance().getHomeViewController().setInstanceValue(e,ZaHome.A2_queueLength)
};
ZaHome.prototype.schedulePostLoading=function(){
var e=new AjxTimedAction(this,ZaHome.prototype.startPostLoading);
AjxTimedAction.scheduleAction(e,100)
};
ZaHome.prototype.startPostLoading=function(){
for(var e=0;
e<ZaHome.postLoadDataFunction.length;
e++){
ZaHome.postLoadDataFunction[e].call(this)
}};
ZaHome.myXModel={
items:[{
id:ZaHome.A2_version,type:_STRING_,ref:"attrs/"+ZaHome.A2_version}
,{
id:ZaHome.A2_account,type:_STRING_,ref:"attrs/"+ZaHome.A2_account}
,{
id:ZaHome.A2_domainNum,type:_STRING_,ref:"attrs/"+ZaHome.A2_domainNum}
,{
id:ZaHome.A2_cosNum,type:_STRING_,ref:"attrs/"+ZaHome.A2_cosNum}
,{
id:ZaHome.A2_serverNum,type:_STRING_,ref:"attrs/"+ZaHome.A2_serverNum}
,{
id:ZaHome.A2_accountNum,type:_STRING_,ref:"attrs/"+ZaHome.A2_accountNum}
,{
id:ZaHome.A2_lastCleanupTime,type:_STRING_,ref:"attrs/"+ZaHome.A2_lastCleanupTime}
,{
id:ZaHome.A2_lastCleanup,type:_ENUM_,ref:"attrs/"+ZaHome.A2_lastCleanupTime,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaHome.A2_lastLogPurgeTime,type:_STRING_,ref:"attrs/"+ZaHome.A2_lastLogPurgeTime}
,{
id:ZaHome.A2_lastLogPurge,type:_ENUM_,ref:"attrs/"+ZaHome.A2_lastLogPurge,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaHome.A2_DBCheckMessage,type:_STRING_,ref:"attrs/"+ZaHome.A2_DBCheckMessage}
,{
id:ZaHome.A2_DBCheckType,type:_ENUM_,ref:"attrs/"+ZaHome.A2_DBCheckType,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaHome.A2_serviceStatusMessage,type:_STRING_,ref:"attrs/"+ZaHome.A2_serviceStatusMessage}
,{
id:ZaHome.A2_serviceDetailedMessage,type:_STRING_,ref:"attrs/"+ZaHome.A2_serviceDetailedMessage}
,{
id:ZaHome.A2_serviceStatus,type:_ENUM_,ref:"attrs/"+ZaHome.A2_serviceStatus,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaHome.A2_activeSession,type:_STRING_,ref:"attrs/"+ZaHome.A2_activeSession}
,{
id:ZaHome.A2_queueLength,type:_STRING_,ref:"attrs/"+ZaHome.A2_queueLength}
,{
id:ZaHome.A2_messageCount,type:_NUMBER_,ref:"attrs/"+ZaHome.A2_messageCount}
,{
id:ZaHome.A2_messageVolume,type:_NUMBER_,ref:"attrs/"+ZaHome.A2_messageVolume}
,{
id:ZaHome.A2_showWarningPanel,type:_ENUM_,ref:"attrs/"+ZaHome.A2_showWarningPanel,choices:ZaModel.BOOLEAN_CHOICES1}
,{
id:ZaHome.A2_maintenanceItemNum,type:_NUMBER_,ref:"attrs/"+ZaHome.A2_maintenanceItemNum}
]}
}
if(AjxPackage.define("zimbraAdmin.accounts.model.ZaDataSource")){
ZaDataSource=function(e){
if(e){
return
}
ZaItem.call(this,"ZaDataSource");
this._init();
this.type=ZaItem.DATASOURCE
};
ZaDataSource.prototype=new ZaItem;
ZaDataSource.prototype.constructor=ZaDataSource;
ZaDataSource.DS_TYPE_GAL="gal";
ZaDataSource.GAL_TYPE_ZIMBRA="zimbra";
ZaDataSource.GAL_TYPE_LDAP="ldap";
ZaDataSource.A_zimbraGalLdapAttrMap="zimbraGalLdapAttrMap";
ZaDataSource.A_zimbraGalSyncLdapURL="zimbraGalSyncLdapURL";
ZaDataSource.A_zimbraGalSyncLdapSearchBase="zimbraGalSyncLdapSearchBase";
ZaDataSource.A_zimbraGalSyncLdapFilter="zimbraGalSyncLdapFilter";
ZaDataSource.A_zimbraGalSyncLdapAuthMech="zimbraGalSyncLdapAuthMech";
ZaDataSource.A_zimbraGalSyncLdapBindDn="zimbraGalSyncLdapBindDn";
ZaDataSource.A_zimbraGalSyncLdapBindPassword="zimbraGalSyncLdapBindPassword";
ZaDataSource.A_zimbraGalSyncLdapKerberos5Principal="zimbraGalSyncLdapKerberos5Principal";
ZaDataSource.A_zimbraGalSyncLdapKerberos5Keytab="zimbraGalSyncLdapKerberos5Keytab";
ZaDataSource.A_zimbraGalSyncLdapPageSize="zimbraGalSyncLdapPageSize";
ZaDataSource.A_zimbraGalSyncInternalSearchBase="zimbraGalSyncInternalSearchBase";
ZaDataSource.A_zimbraGalSyncLdapStartTlsEnabled="zimbraGalSyncLdapStartTlsEnabled";
ZaDataSource.A_zimbraGalLastSuccessfulSyncTimestamp="zimbraGalLastSuccessfulSyncTimestamp";
ZaDataSource.A_zimbraGalLastFailedSyncTimestamp="zimbraGalLastFailedSyncTimestamp";
ZaDataSource.A_zimbraGalStatus="zimbraGalStatus";
ZaDataSource.A_zimbraGalType="zimbraGalType";
ZaDataSource.A_zimbraGalSyncTimestampFormat="zimbraGalSyncTimestampFormat";
ZaDataSource.A_zimbraDataSourceType="zimbraDataSourceType";
ZaDataSource.A_zimbraDataSourcePollingInterval="zimbraDataSourcePollingInterval";
ZaDataSource.myXModel={
items:[{
id:ZaDataSource.A_zimbraDataSourceType,type:_STRING_,ref:"attrs/"+ZaDataSource.A_zimbraDataSourceType}
,{
id:ZaDataSource.A_zimbraGalType,type:_STRING_,ref:"attrs/"+ZaDataSource.A_zimbraGalType}
,{
id:ZaDataSource.A_zimbraGalSyncLdapURL,type:_LIST_,listItem:{
type:_SHORT_URL_}
,ref:"attrs/"+ZaDataSource.A_zimbraGalSyncLdapURL}
,{
id:ZaDataSource.A_zimbraGalSyncLdapFilter,type:_STRING_,ref:"attrs/"+ZaDataSource.A_zimbraGalSyncLdapFilter,required:true}
,{
id:ZaDataSource.A_zimbraGalSyncInternalSearchBase,type:_STRING_,ref:"attrs/"+ZaDataSource.A_zimbraGalSyncInternalSearchBase}
,{
id:ZaDataSource.A_zimbraGalSyncLdapBindDn,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDataSource.A_zimbraGalSyncLdapBindDn}
,{
id:ZaDataSource.A_zimbraGalSyncLdapBindPassword,type:_STRING_,ref:"attrs/"+ZaDataSource.A_zimbraGalSyncLdapBindPassword}
,{
id:ZaDataSource.A_zimbraGalSyncLdapStartTlsEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDataSource.A_zimbraGalSyncLdapStartTlsEnabled}
,{
id:ZaDataSource.A_zimbraGalSyncLdapAuthMech,type:_STRING_,ref:"attrs/"+ZaDataSource.A_zimbraGalSyncLdapAuthMech}
,{
id:ZaDataSource.A_zimbraDataSourcePollingInterval,type:_MLIFETIME_,ref:"attrs/"+ZaDataSource.A_zimbraDataSourcePollingInterval}
]}
}
if(AjxPackage.define("zimbraAdmin.accounts.model.ZaAccount")){
ZaAccount=function(e){
if(e){
return
}
ZaItem.call(this,"ZaAccount");
this._init();
this.type=ZaItem.ACCOUNT
};
ZaAccount.prototype=new ZaItem;
ZaAccount.prototype.constructor=ZaAccount;
ZaItem.loadMethods.ZaAccount=new Array();
ZaItem.initMethods.ZaAccount=new Array();
ZaItem.modifyMethods.ZaAccount=new Array();
ZaItem.createMethods.ZaAccount=new Array();
ZaItem.ObjectModifiers.ZaAccount=[];
ZaItem.modelExtensions.ZaAccount=new Array();
ZaItem.getRelatedMethods.ZaAccount=new Array();
ZaAccount.renameMethods=new Array();
ZaAccount.changePasswordMethods=new Array();
ZaAccount.A_name="name";
ZaAccount.A_uid="uid";
ZaAccount.A_accountName="cn";
ZaAccount.A_firstName="givenName";
ZaAccount.A_lastName="sn";
ZaAccount.A_mail="mail";
ZaAccount.A_password="password";
ZaAccount.A_description="description";
ZaAccount.A_telephoneNumber="telephoneNumber";
ZaAccount.A_homePhone="homePhone";
ZaAccount.A_mobile="mobile";
ZaAccount.A_pager="pager";
ZaAccount.A_displayname="displayName";
ZaAccount.A_country="co";
ZaAccount.A_company="company";
ZaAccount.A_title="title";
ZaAccount.A_facsimileTelephoneNumber="facsimileTelephoneNumber";
ZaAccount.A_initials="initials";
ZaAccount.A_city="l";
ZaAccount.A_orgUnit="ou";
ZaAccount.A_office="physicalDeliveryOfficeName";
ZaAccount.A_street="street";
ZaAccount.A_zip="postalCode";
ZaAccount.A_state="st";
ZaAccount.A_mailDeliveryAddress="zimbraMailDeliveryAddress";
ZaAccount.A_accountStatus="zimbraAccountStatus";
ZaAccount.A_notes="zimbraNotes";
ZaAccount.A_zimbraMailQuota="zimbraMailQuota";
ZaAccount.A_mailHost="zimbraMailHost";
ZaAccount.A_zimbraMailTransport="zimbraMailTransport";
ZaAccount.A_COSId="zimbraCOSId";
ZaAccount.A_zimbraPhoneticFirstName="zimbraPhoneticFirstName";
ZaAccount.A_zimbraPhoneticLastName="zimbraPhoneticLastName";
ZaAccount.A_zimbraPhoneticCompany="zimbraPhoneticCompany";
ZaAccount.A_zimbraIsAdminAccount="zimbraIsAdminAccount";
ZaAccount.A_zimbraIsDelegatedAdminAccount="zimbraIsDelegatedAdminAccount";
ZaAccount.A_zimbraIsExternalVirtualAccount="zimbraIsExternalVirtualAccount";
ZaAccount.A_zimbraIsSystemAccount="zimbraIsSystemAccount";
ZaAccount.A_zimbraMinPwdLength="zimbraPasswordMinLength";
ZaAccount.A_zimbraMaxPwdLength="zimbraPasswordMaxLength";
ZaAccount.A_zimbraPasswordMinUpperCaseChars="zimbraPasswordMinUpperCaseChars";
ZaAccount.A_zimbraPasswordMinLowerCaseChars="zimbraPasswordMinLowerCaseChars";
ZaAccount.A_zimbraPasswordMinPunctuationChars="zimbraPasswordMinPunctuationChars";
ZaAccount.A_zimbraPasswordMinNumericChars="zimbraPasswordMinNumericChars";
ZaAccount.A_zimbraPasswordMinDigitsOrPuncs="zimbraPasswordMinDigitsOrPuncs";
ZaAccount.A_zimbraMinPwdAge="zimbraPasswordMinAge";
ZaAccount.A_zimbraMaxPwdAge="zimbraPasswordMaxAge";
ZaAccount.A_zimbraEnforcePwdHistory="zimbraPasswordEnforceHistory";
ZaAccount.A_zimbraMailAlias="zimbraMailAlias";
ZaAccount.A_zimbraMailForwardingAddress="zimbraMailForwardingAddress";
ZaAccount.A_zimbraPasswordMustChange="zimbraPasswordMustChange";
ZaAccount.A_zimbraPasswordLocked="zimbraPasswordLocked";
ZaAccount.A_zimbraContactMaxNumEntries="zimbraContactMaxNumEntries";
ZaAccount.A_zimbraMailForwardingAddressMaxLength="zimbraMailForwardingAddressMaxLength";
ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs="zimbraMailForwardingAddressMaxNumAddrs";
ZaAccount.A_zimbraAttachmentsBlocked="zimbraAttachmentsBlocked";
ZaAccount.A_zimbraQuotaWarnPercent="zimbraQuotaWarnPercent";
ZaAccount.A_zimbraQuotaWarnInterval="zimbraQuotaWarnInterval";
ZaAccount.A_zimbraQuotaWarnMessage="zimbraQuotaWarnMessage";
ZaAccount.A_zimbraIsSystemResource="zimbraIsSystemResource";
ZaAccount.A_zimbraExcludeFromCMBSearch="zimbraExcludeFromCMBSearch";
ZaAccount.A_zimbraAdminAuthTokenLifetime="zimbraAdminAuthTokenLifetime";
ZaAccount.A_zimbraAuthTokenValidityValue="zimbraAuthTokenValidityValue";
ZaAccount.A_zimbraAuthTokenLifetime="zimbraAuthTokenLifetime";
ZaAccount.A_zimbraMailMessageLifetime="zimbraMailMessageLifetime";
ZaAccount.A_zimbraMailSpamLifetime="zimbraMailSpamLifetime";
ZaAccount.A_zimbraMailTrashLifetime="zimbraMailTrashLifetime";
ZaAccount.A_zimbraMailIdleSessionTimeout="zimbraMailIdleSessionTimeout";
ZaAccount.A_zimbraAvailableSkin="zimbraAvailableSkin";
ZaAccount.A_zimbraZimletAvailableZimlets="zimbraZimletAvailableZimlets";
ZaAccount.A_zimbraDataSourceMinPollingInterval="zimbraDataSourceMinPollingInterval";
ZaAccount.A_zimbraDataSourcePop3PollingInterval="zimbraDataSourcePop3PollingInterval";
ZaAccount.A_zimbraDataSourceImapPollingInterval="zimbraDataSourceImapPollingInterval";
ZaAccount.A_zimbraDataSourceCalendarPollingInterval="zimbraDataSourceCalendarPollingInterval";
ZaAccount.A_zimbraDataSourceRssPollingInterval="zimbraDataSourceRssPollingInterval";
ZaAccount.A_zimbraDataSourceCaldavPollingInterval="zimbraDataSourceCaldavPollingInterval";
ZaAccount.A_zimbraProxyAllowedDomains="zimbraProxyAllowedDomains";
ZaAccount.A_zimbraIsCCAccount="zimbraIsCustomerCareAccount";
ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled="zimbraPrefAppleIcalDelegationEnabled";
ZaAccount.A_zimbraPrefCalendarShowPastDueReminders="zimbraPrefCalendarShowPastDueReminders";
ZaAccount.A_zimbraPrefCalendarToasterEnabled="zimbraPrefCalendarToasterEnabled";
ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf="zimbraPrefCalendarAllowCancelEmailToSelf";
ZaAccount.A_zimbraPrefCalendarAllowPublishMethodInvite="zimbraPrefCalendarAllowPublishMethodInvite";
ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite="zimbraPrefCalendarAllowForwardedInvite";
ZaAccount.A_zimbraPrefCalendarReminderFlashTitle="zimbraPrefCalendarReminderFlashTitle";
ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges="zimbraPrefCalendarNotifyDelegatedChanges";
ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek="zimbraPrefCalendarFirstDayOfWeek";
ZaAccount.A_zimbraPrefCalendarInitialView="zimbraPrefCalendarInitialView";
ZaAccount.A_zimbraPrefCalendarForwardInvitesTo="zimbraPrefCalendarForwardInvitesTo";
ZaAccount.A_zimbraPrefClientType="zimbraPrefClientType";
ZaAccount.A_zimbraPrefTimeZoneId="zimbraPrefTimeZoneId";
ZaAccount.A_zimbraAllowAnyFromAddress="zimbraAllowAnyFromAddress";
ZaAccount.A_zimbraAllowFromAddress="zimbraAllowFromAddress";
ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal="zimbraPrefCalendarAlwaysShowMiniCal";
ZaAccount.A_zimbraPrefCalendarUseQuickAdd="zimbraPrefCalendarUseQuickAdd";
ZaAccount.A_zimbraPrefSaveToSent="zimbraPrefSaveToSent";
ZaAccount.A_zimbraPrefMailSignature="zimbraPrefMailSignature";
ZaAccount.A_zimbraPrefMailSignatureEnabled="zimbraPrefMailSignatureEnabled";
ZaAccount.A_zimbraPrefSentMailFolder="zimbraPrefSentMailFolder";
ZaAccount.A_zimbraPrefGroupMailBy="zimbraPrefGroupMailBy";
ZaAccount.A_zimbraPrefIncludeSpamInSearch="zimbraPrefIncludeSpamInSearch";
ZaAccount.A_zimbraPrefIncludeTrashInSearch="zimbraPrefIncludeTrashInSearch";
ZaAccount.A_zimbraPrefMailInitialSearch="zimbraPrefMailInitialSearch";
ZaAccount.A_zimbraMaxMailItemsPerPage="zimbraMaxMailItemsPerPage";
ZaAccount.A_zimbraPrefMailItemsPerPage="zimbraPrefMailItemsPerPage";
ZaAccount.A_zimbraPrefMailPollingInterval="zimbraPrefMailPollingInterval";
ZaAccount.A_zimbraPrefAutoSaveDraftInterval="zimbraPrefAutoSaveDraftInterval";
ZaAccount.A_zimbraPrefMailFlashTitle="zimbraPrefMailFlashTitle";
ZaAccount.A_zimbraPrefMailFlashIcon="zimbraPrefMailFlashIcon";
ZaAccount.A_zimbraPrefMailSoundsEnabled="zimbraPrefMailSoundsEnabled";
ZaAccount.A_zimbraPrefMailToasterEnabled="zimbraPrefMailToasterEnabled";
ZaAccount.A_zimbraMailMinPollingInterval="zimbraMailMinPollingInterval";
ZaAccount.A_zimbraPrefOutOfOfficeFromDate="zimbraPrefOutOfOfficeFromDate";
ZaAccount.A_zimbraPrefOutOfOfficeUntilDate="zimbraPrefOutOfOfficeUntilDate";
ZaAccount.A_zimbraPrefOutOfOfficeReply="zimbraPrefOutOfOfficeReply";
ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled="zimbraPrefOutOfOfficeReplyEnabled";
ZaAccount.A_zimbraPrefReplyToAddress="zimbraPrefReplyToAddress";
ZaAccount.A_zimbraPrefUseKeyboardShortcuts="zimbraPrefUseKeyboardShortcuts";
ZaAccount.A_zimbraMemberOf="zimbraMemberOf";
ZaAccount.A_zimbraPrefComposeInNewWindow="zimbraPrefComposeInNewWindow";
ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat="zimbraPrefForwardReplyInOriginalFormat";
ZaAccount.A_zimbraPrefAutoAddAddressEnabled="zimbraPrefAutoAddAddressEnabled";
ZaAccount.A_zimbraPrefComposeFormat="zimbraPrefComposeFormat";
ZaAccount.A_zimbraPrefMessageViewHtmlPreferred="zimbraPrefMessageViewHtmlPreferred";
ZaAccount.A_zimbraPrefNewMailNotificationAddress="zimbraPrefNewMailNotificationAddress";
ZaAccount.A_zimbraPrefNewMailNotificationEnabled="zimbraPrefNewMailNotificationEnabled";
ZaAccount.A_zimbraPrefOutOfOfficeReply="zimbraPrefOutOfOfficeReply";
ZaAccount.A_zimbraPrefShowSearchString="zimbraPrefShowSearchString";
ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar="zimbraPrefUseTimeZoneListInCalendar";
ZaAccount.A_zimbraPrefImapSearchFoldersEnabled="zimbraPrefImapSearchFoldersEnabled";
ZaAccount.A_zimbraPrefMailForwardingAddress="zimbraPrefMailForwardingAddress";
ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled="zimbraPrefMailLocalDeliveryDisabled";
ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime="zimbraPrefCalendarApptReminderWarningTime";
ZaAccount.A_zimbraPrefSkin="zimbraPrefSkin";
ZaAccount.A_zimbraPrefGalAutoCompleteEnabled="zimbraPrefGalAutoCompleteEnabled";
ZaAccount.A_zimbraPrefWarnOnExit="zimbraPrefWarnOnExit";
ZaAccount.A_zimbraPrefShowSelectionCheckbox="zimbraPrefShowSelectionCheckbox";
ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize="zimbraPrefHtmlEditorDefaultFontSize";
ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily="zimbraPrefHtmlEditorDefaultFontFamily";
ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor="zimbraPrefHtmlEditorDefaultFontColor";
ZaAccount.A_zimbraMailSignatureMaxLength="zimbraMailSignatureMaxLength";
ZaAccount.A_zimbraPrefDisplayExternalImages="zimbraPrefDisplayExternalImages";
ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration="zimbraPrefOutOfOfficeCacheDuration";
ZaAccount.A_zimbraPrefMailDefaultCharset="zimbraPrefMailDefaultCharset";
ZaAccount.A_zimbraPrefLocale="zimbraPrefLocale";
ZaAccount.A_zimbraJunkMessagesIndexingEnabled="zimbraJunkMessagesIndexingEnabled";
ZaAccount.A_zimbraPrefMailSendReadReceipts="zimbraPrefMailSendReadReceipts";
ZaAccount.A_zimbraPrefReadReceiptsToAddress="zimbraPrefReadReceiptsToAddress";
ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit="zimbraPrefAdminConsoleWarnOnExit";
ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled="zimbraPrefMandatorySpellCheckEnabled";
ZaAccount.A_zimbraPrefMessageIdDedupingEnabled="zimbraPrefMessageIdDedupingEnabled";
ZaAccount.A_zimbraPrefItemsPerVirtualPage="zimbraPrefItemsPerVirtualPage",ZaAccount.A_zimbraFeatureManageZimlets="zimbraFeatureManageZimlets";
ZaAccount.A_zimbraFeatureImportFolderEnabled="zimbraFeatureImportFolderEnabled";
ZaAccount.A_zimbraFeatureExportFolderEnabled="zimbraFeatureExportFolderEnabled";
ZaAccount.A_zimbraDumpsterEnabled="zimbraDumpsterEnabled";
ZaAccount.A_zimbraMailDumpsterLifetime="zimbraMailDumpsterLifetime";
ZaAccount.A_zimbraDumpsterUserVisibleAge="zimbraDumpsterUserVisibleAge";
ZaAccount.A_zimbraDumpsterPurgeEnabled="zimbraDumpsterPurgeEnabled";
ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled="zimbraPrefCalendarReminderSoundsEnabled";
ZaAccount.A_zimbraPrefCalendarSendInviteDeniedAutoReply="zimbraPrefCalendarSendInviteDeniedAutoReply";
ZaAccount.A_zimbraPrefCalendarAutoAddInvites="zimbraPrefCalendarAutoAddInvites";
ZaAccount.A_zimbraPrefCalendarApptVisibility="zimbraPrefCalendarApptVisibility";
ZaAccount.A_zimbraFeatureReadReceiptsEnabled="zimbraFeatureReadReceiptsEnabled";
ZaAccount.A_zimbraFeatureMailPriorityEnabled="zimbraFeatureMailPriorityEnabled";
ZaAccount.A_zimbraFeatureImapDataSourceEnabled="zimbraFeatureImapDataSourceEnabled";
ZaAccount.A_zimbraFeaturePop3DataSourceEnabled="zimbraFeaturePop3DataSourceEnabled";
ZaAccount.A_zimbraFeatureMailSendLaterEnabled="zimbraFeatureMailSendLaterEnabled";
ZaAccount.A_zimbraFeatureIdentitiesEnabled="zimbraFeatureIdentitiesEnabled";
ZaAccount.A_zimbraFeatureMailForwardingEnabled="zimbraFeatureMailForwardingEnabled";
ZaAccount.A_zimbraFeatureContactsEnabled="zimbraFeatureContactsEnabled";
ZaAccount.A_zimbraFeatureCalendarEnabled="zimbraFeatureCalendarEnabled";
ZaAccount.A_zimbraFeatureTasksEnabled="zimbraFeatureTasksEnabled";
ZaAccount.A_zimbraFeatureTaggingEnabled="zimbraFeatureTaggingEnabled";
ZaAccount.A_zimbraFeaturePeopleSearchEnabled="zimbraFeaturePeopleSearchEnabled";
ZaAccount.A_zimbraFeatureAdvancedSearchEnabled="zimbraFeatureAdvancedSearchEnabled";
ZaAccount.A_zimbraFeatureSavedSearchesEnabled="zimbraFeatureSavedSearchesEnabled";
ZaAccount.A_zimbraFeatureConversationsEnabled="zimbraFeatureConversationsEnabled";
ZaAccount.A_zimbraFeatureChangePasswordEnabled="zimbraFeatureChangePasswordEnabled";
ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled="zimbraFeatureInitialSearchPreferenceEnabled";
ZaAccount.A_zimbraFeatureFiltersEnabled="zimbraFeatureFiltersEnabled";
ZaAccount.A_zimbraFeatureGalEnabled="zimbraFeatureGalEnabled";
ZaAccount.A_zimbraFeatureMAPIConnectorEnabled="zimbraFeatureMAPIConnectorEnabled";
ZaAccount.A_zimbraFeatureSharingEnabled="zimbraFeatureSharingEnabled";
ZaAccount.A_zimbraPublicSharingEnabled="zimbraPublicSharingEnabled";
ZaAccount.A_zimbraExternalSharingEnabled="zimbraExternalSharingEnabled";
ZaAccount.A_zimbraFeatureBriefcasesEnabled="zimbraFeatureBriefcasesEnabled";
ZaAccount.A_zimbraFeatureHtmlComposeEnabled="zimbraFeatureHtmlComposeEnabled";
ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled="zimbraFeatureGalAutoCompleteEnabled";
ZaAccount.A_zimbraImapEnabled="zimbraImapEnabled";
ZaAccount.A_zimbraPop3Enabled="zimbraPop3Enabled";
ZaAccount.A_zimbraFeatureSkinChangeEnabled="zimbraFeatureSkinChangeEnabled";
ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled="zimbraFeatureOutOfOfficeReplyEnabled";
ZaAccount.A_zimbraFeatureNewMailNotificationEnabled="zimbraFeatureNewMailNotificationEnabled";
ZaAccount.A_zimbraHideInGal="zimbraHideInGal";
ZaAccount.A_zimbraMailCanonicalAddress="zimbraMailCanonicalAddress";
ZaAccount.A_zimbraMailCatchAllAddress="zimbraMailCatchAllAddress";
ZaAccount.A_zimbraFeatureOptionsEnabled="zimbraFeatureOptionsEnabled";
ZaAccount.A_zimbraFeatureMailEnabled="zimbraFeatureMailEnabled";
ZaAccount.A_zimbraFeatureGroupCalendarEnabled="zimbraFeatureGroupCalendarEnabled";
ZaAccount.A_zimbraFeatureFlaggingEnabled="zimbraFeatureFlaggingEnabled";
ZaAccount.A_zimbraForeignPrincipal="zimbraForeignPrincipal";
ZaAccount.A_zimbraPasswordLockoutEnabled="zimbraPasswordLockoutEnabled";
ZaAccount.A_zimbraPasswordLockoutDuration="zimbraPasswordLockoutDuration";
ZaAccount.A_zimbraPasswordLockoutMaxFailures="zimbraPasswordLockoutMaxFailures";
ZaAccount.A_zimbraPasswordLockoutFailureLifetime="zimbraPasswordLockoutFailureLifetime";
ZaAccount.A_zimbraAdminConsoleUIComponents="zimbraAdminConsoleUIComponents";
ZaAccount.A_zimbraAuthLdapExternalDn="zimbraAuthLdapExternalDn";
ZaAccount.A_zimbraFreebusyExchangeUserOrg="zimbraFreebusyExchangeUserOrg";
ZaAccount.A_zimbraFeatureManageSMIMECertificateEnabled="zimbraFeatureManageSMIMECertificateEnabled";
ZaAccount.A_zimbraFeatureSMIMEEnabled="zimbraFeatureSMIMEEnabled";
ZaAccount.A_zimbraFeatureEwsEnabled="zimbraFeatureEwsEnabled";
ZaAccount.A_zimbraFeatureTouchClientEnabled="zimbraFeatureTouchClientEnabled";
ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled="zimbraFeatureWebClientOfflineAccessEnabled";
ZaAccount.A_zimbraFeatureDistributionListFolderEnabled="zimbraFeatureDistributionListFolderEnabled";
ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled="zimbraFeatureCalendarReminderDeviceEmailEnabled";
ZaAccount.A_zimbraLastLogonTimestamp="zimbraLastLogonTimestamp";
ZaAccount.A_zimbraPasswordModifiedTime="zimbraPasswordModifiedTime";
ZaAccount.ACCOUNT_STATUS_ACTIVE="active";
ZaAccount.ACCOUNT_STATUS_MAINTENANCE="maintenance";
ZaAccount.ACCOUNT_STATUS_LOCKED="locked";
ZaAccount.ACCOUNT_STATUS_LOCKOUT="lockout";
ZaAccount.ACCOUNT_STATUS_CLOSED="closed";
ZaAccount.ACCOUNT_STATUS_PENDING="pending";
ZaAccount.A2_ldap_ds="ldap_ds";
ZaAccount.A2_zimbra_ds="zimbra_ds";
ZaAccount.A2_datasources="datasources";
ZaAccount.A2_confirmPassword="confirmPassword";
ZaAccount.A2_mbxsize="mbxSize";
ZaAccount.A2_quota="quota2";
ZaAccount.A2_autodisplayname="autodisplayname";
ZaAccount.A2_autoMailServer="automailserver";
ZaAccount.A2_autoCos="autoCos";
ZaAccount.A2_myCOS="mycos";
ZaAccount.A2_newAlias="newalias";
ZaAccount.A2_aliases="aliases";
ZaAccount.A2_forwarding="forwardings";
ZaAccount.A2_memberOf="memberOf";
ZaAccount.A2_directMemberList="directMemberList";
ZaAccount.A2_indirectMemberList="indirectMemberList";
ZaAccount.A2_nonMemberList="nonMemberList";
ZaAccount.A2_nonMemberListSelected="nonMemberListSelected";
ZaAccount.A2_indirectMemberListSelected="indirectMemberListSelected";
ZaAccount.A2_directMemberListSelected="directMemberListSelected";
ZaAccount.A2_showSameDomain="showSameDomain";
ZaAccount.A2_domainLeftAccounts="leftDomainAccounts";
ZaAccount.A2_publicMailURL="publicMailURL";
ZaAccount.A2_adminSoapURL="adminSoapURL";
ZaAccount.A2_soapURL="soapURL";
ZaAccount.MAXSEARCHRESULTS=ZaSettings.MAXSEARCHRESULTS;
ZaAccount.RESULTSPERPAGE=ZaSettings.RESULTSPERPAGE;
ZaAccount.A2_accountTypes="accountTypes";
ZaAccount.A2_currentAccountType="currentAccountType";
ZaAccount.A2_alias_selection_cache="alias_selection_cache";
ZaAccount.A2_fwdAddr_selection_cache="fwdAddr_selection_cache";
ZaAccount.A2_calFwdAddr_selection_cache="calFwdAddr_selection_cache";
ZaAccount.A2_fp_selection_cache="fp_selection_cache";
ZaAccount.A2_errorMessage="errorMessage";
ZaAccount.A2_warningMessage="warningMessage";
ZaAccount.A2_showAccountTypeMsg="showAccountTypeMsg";
ZaAccount.A2_isExternalAuth="isExternalAuth";
ZaAccount.SET_PASSWORD_RIGHT="setAccountPassword";
ZaAccount.CHANGE_PASSWORD_RIGHT="changeAccountPassword";
ZaAccount.RENAME_ACCOUNT_RIGHT="renameAccount";
ZaAccount.REINDEX_MBX_RIGHT="reindexMailbox";
ZaAccount.DELETE_ACCOUNT_RIGHT="deleteAccount";
ZaAccount.GET_MBX_DUMP_RIGHT="getMailboxDump";
ZaAccount.VIEW_MAIL_RIGHT="adminLoginAs";
ZaAccount.ADD_ACCOUNT_ALIAS_RIGHT="addAccountAlias";
ZaAccount.REMOVE_ACCOUNT_ALIAS_RIGHT="removeAccountAlias";
ZaAccount.GET_ACCOUNT_MEMBERSHIP_RIGHT="getAccountMembership";
ZaAccount.GET_MAILBOX_INFO_RIGHT="getMailboxInfo";
ZaAccount.GET_ACCOUNT_INFO_RIGHT="getAccountInfo";
ZaAccount.RIGHT_VIEW_ADMINUI_COMPONENTS="viewAccountAdminUI";
ZaAccount.RIGHT_DELETE_DL="deleteDistributionList";
ZaAccount.RIGHT_LIST_ACCOUNT="listAccount";
ZaAccount.checkValues=function(O){
if(ZaItem.hasWritePermission(ZaAccount.A_name,O)&&(O.name==null||O.name.length<1)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_NAME_REQUIRED);
return false
}
if(ZaItem.hasWritePermission(ZaAccount.A_name,O)&&(O.name.length>255)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_NAME_TOOLONG);
return false
}
if(ZaItem.hasWritePermission(ZaAccount.A_lastName,O)&&(O.attrs[ZaAccount.A_lastName]==null||O.attrs[ZaAccount.A_lastName].length<1)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_LAST_NAME_REQUIRED);
return false
}
if(ZaItem.hasWritePermission(ZaAccount.A_name,O)&&!AjxUtil.isValidEmailNonReg(O.name)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_NAME_INVALID);
return false
}
var h=Number.POSITIVE_INFINITY;
var d=0;
var T=Number.POSITIVE_INFINITY;
var o=0;
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdLength,O)&&O.attrs[ZaAccount.A_zimbraMinPwdLength]!=""&&O.attrs[ZaAccount.A_zimbraMinPwdLength]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraMinPwdLength])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMinPwdLength]));
return false
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdLength,O)&&O.attrs[ZaAccount.A_zimbraMaxPwdLength]!=""&&O.attrs[ZaAccount.A_zimbraMaxPwdLength]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraMaxPwdLength])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMaxPwdLength]));
return false
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdLength,O)&&O.attrs[ZaAccount.A_zimbraMaxPwdLength]){
O.attrs[ZaAccount.A_zimbraMaxPwdLength]=parseInt(O.attrs[ZaAccount.A_zimbraMaxPwdLength])
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdLength,O)&&O.attrs[ZaAccount.A_zimbraMinPwdLength]){
O.attrs[ZaAccount.A_zimbraMinPwdLength]=parseInt(O.attrs[ZaAccount.A_zimbraMinPwdLength])
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdAge,O)&&O.attrs[ZaAccount.A_zimbraMinPwdAge]!=""&&O.attrs[ZaAccount.A_zimbraMinPwdAge]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraMinPwdAge])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMinPwdAge]));
return false
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdAge,O)&&O.attrs[ZaAccount.A_zimbraMaxPwdAge]!=""&&O.attrs[ZaAccount.A_zimbraMaxPwdAge]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraMaxPwdAge])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMaxPwdAge]));
return false
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdAge,O)&&O.attrs[ZaAccount.A_zimbraMinPwdAge]){
O.attrs[ZaAccount.A_zimbraMinPwdAge]=parseInt(O.attrs[ZaAccount.A_zimbraMinPwdAge])
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdAge,O)&&O.attrs[ZaCos.A_zimbraMaxPwdAge]){
O.attrs[ZaCos.A_zimbraMaxPwdAge]=parseInt(O.attrs[ZaCos.A_zimbraMaxPwdAge])
}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdLength,O)){
if(O.attrs[ZaAccount.A_zimbraMinPwdLength]!=null){
d=parseInt(O.attrs[ZaAccount.A_zimbraMinPwdLength])
}else{
d=parseInt(O._defaultValues.attrs[ZaAccount.A_zimbraMinPwdLength])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdLength,O)){
if(O.attrs[ZaAccount.A_zimbraMaxPwdLength]!=null){
h=parseInt(O.attrs[ZaAccount.A_zimbraMaxPwdLength])
}else{
h=parseInt(O._defaultValues.attrs[ZaAccount.A_zimbraMaxPwdLength])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdLength,O)||ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdLength,O)){
if(h<d){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_MAX_MIN_PWDLENGTH);
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdLength,O)){
if(O.attrs[ZaAccount.A_zimbraMaxPwdAge]!=null){
T=parseInt(O.attrs[ZaAccount.A_zimbraMaxPwdAge])
}else{
T=parseInt(O._defaultValues.attrs[ZaAccount.A_zimbraMaxPwdAge])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdAge,O)){
if(O.attrs[ZaAccount.A_zimbraMinPwdAge]!=null){
o=parseInt(O.attrs[ZaAccount.A_zimbraMinPwdAge])
}else{
o=parseInt(O._defaultValues.attrs[ZaCos.A_zimbraMinPwdAge])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdLength,O)||ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdLength,O)){
if(T<o){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_MAX_MIN_PWDAGE);
return false
}}
if(ZaItem.hasAnyRight([ZaAccount.SET_PASSWORD_RIGHT,ZaAccount.CHANGE_PASSWORD_RIGHT],O)){
if(!AjxUtil.isEmpty(O.attrs[ZaAccount.A_password])||!AjxUtil.isEmpty(O[ZaAccount.A2_confirmPassword])){
if(O.attrs[ZaAccount.A_password]!=O[ZaAccount.A2_confirmPassword]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}
if(O.attrs[ZaAccount.A_password].length<d||AjxStringUtil.trim(O.attrs[ZaAccount.A_password]).length<d){
var c;
if(d>1){
c=String(ZaMsg.NAD_passMinLengthMsg_p).replace("{0}",d)
}else{
c=String(ZaMsg.NAD_passMinLengthMsg_s).replace("{0}",d)
}
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_TOOSHORT+"<br>"+c);
return false
}
if(AjxStringUtil.trim(O.attrs[ZaAccount.A_password]).length>h){
var z;
if(h>1){
z=String(ZaMsg.NAD_passMaxLengthMsg_p).replace("{0}",h)
}else{
z=String(ZaMsg.NAD_passMaxLengthMsg_s).replace("{0}",h)
}
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_TOOLONG+"<br>"+z);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailQuota,O)){
if(O.attrs[ZaAccount.A_zimbraMailQuota]!=""&&O.attrs[ZaAccount.A_zimbraMailQuota]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraMailQuota])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailQuota]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraContactMaxNumEntries,O)){
if(O.attrs[ZaAccount.A_zimbraContactMaxNumEntries]!=""&&O.attrs[ZaAccount.A_zimbraContactMaxNumEntries]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraContactMaxNumEntries])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraContactMaxNumEntries]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailForwardingAddressMaxLength,O)){
if(O.attrs[ZaAccount.A_zimbraMailForwardingAddressMaxLength]!=""&&O.attrs[ZaAccount.A_zimbraMailForwardingAddressMaxLength]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraMailForwardingAddressMaxLength])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailForwardingAddressMaxLength]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraDataSourceMinPollingInterval,O)){
var p=O.attrs[ZaAccount.A_zimbraDataSourceMinPollingInterval];
if(!AjxUtil.isEmpty(p)&&!AjxUtil.isLifeTime(p)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceMinPollingInterval]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraDataSourcePop3PollingInterval,O)){
var e=O.attrs[ZaAccount.A_zimbraDataSourcePop3PollingInterval];
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isLifeTime(e)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourcePop3PollingInterval]));
return false
}
if(!AjxUtil.isEmpty(p)){
p=O._defaultValues.attrs[ZaAccount.A_zimbraDataSourceMinPollingInterval]
}
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isEmpty(p)){
if(ZaUtil.getLifeTimeInSeconds(e)<ZaUtil.getLifeTimeInSeconds(p)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+p);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraDataSourceImapPollingInterval,O)){
var e=O.attrs[ZaAccount.A_zimbraDataSourceImapPollingInterval];
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isLifeTime(e)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceImapPollingInterval]));
return false
}
if(!AjxUtil.isEmpty(p)){
p=O._defaultValues.attrs[ZaAccount.A_zimbraDataSourceMinPollingInterval]
}
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isEmpty(p)){
if(ZaUtil.getLifeTimeInSeconds(e)<ZaUtil.getLifeTimeInSeconds(p)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+p);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraDataSourceCalendarPollingInterval,O)){
var e=O.attrs[ZaAccount.A_zimbraDataSourceCalendarPollingInterval];
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isLifeTime(e)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceCalendarPollingInterval]));
return false
}
if(!AjxUtil.isEmpty(p)){
p=O._defaultValues.attrs[ZaAccount.A_zimbraDataSourceMinPollingInterval]
}
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isEmpty(p)){
if(ZaUtil.getLifeTimeInSeconds(e)<ZaUtil.getLifeTimeInSeconds(p)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+p);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraDataSourceRssPollingInterval,O)){
var e=O.attrs[ZaAccount.A_zimbraDataSourceRssPollingInterval];
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isLifeTime(e)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceRssPollingInterval]));
return false
}
if(!AjxUtil.isEmpty(p)){
p=O._defaultValues.attrs[ZaAccount.A_zimbraDataSourceMinPollingInterval]
}
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isEmpty(p)){
if(ZaUtil.getLifeTimeInSeconds(e)<ZaUtil.getLifeTimeInSeconds(p)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+p);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraDataSourceCaldavPollingInterval,O)){
var e=O.attrs[ZaAccount.A_zimbraDataSourceCaldavPollingInterval];
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isLifeTime(e)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceCaldavPollingInterval]));
return false
}
if(!AjxUtil.isEmpty(p)){
p=O._defaultValues.attrs[ZaAccount.A_zimbraDataSourceMinPollingInterval]
}
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isEmpty(p)){
if(ZaUtil.getLifeTimeInSeconds(e)<ZaUtil.getLifeTimeInSeconds(p)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+p);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPrefAutoSaveDraftInterval,O)){
var q=O.attrs[ZaAccount.A_zimbraPrefAutoSaveDraftInterval];
if(q!=""&&q!=null&&!AjxUtil.isLifeTime(q)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPrefAutoSaveDraftInterval]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs,O)){
if(O.attrs[ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs]!=""&&O.attrs[ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailForwardingAddressMaxNumAddrs]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraContactMaxNumEntries,O)){
if(O.attrs[ZaAccount.A_zimbraContactMaxNumEntries]){
O.attrs[ZaAccount.A_zimbraContactMaxNumEntries]=parseInt(O.attrs[ZaAccount.A_zimbraContactMaxNumEntries])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinUpperCaseChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinUpperCaseChars]!=""&&O.attrs[ZaAccount.A_zimbraPasswordMinUpperCaseChars]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraPasswordMinUpperCaseChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinUpperCaseChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinUpperCaseChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinUpperCaseChars]){
O.attrs[ZaAccount.A_zimbraPasswordMinUpperCaseChars]=parseInt(O.attrs[ZaAccount.A_zimbraPasswordMinUpperCaseChars])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinLowerCaseChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinLowerCaseChars]!=""&&O.attrs[ZaAccount.A_zimbraPasswordMinLowerCaseChars]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraPasswordMinLowerCaseChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinLowerCaseChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinLowerCaseChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinLowerCaseChars]){
O.attrs[ZaAccount.A_zimbraPasswordMinLowerCaseChars]=parseInt(O.attrs[ZaAccount.A_zimbraPasswordMinLowerCaseChars])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinPunctuationChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinPunctuationChars]!=""&&O.attrs[ZaAccount.A_zimbraPasswordMinPunctuationChars]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraPasswordMinPunctuationChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinPunctuationChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinPunctuationChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinPunctuationChars]){
O.attrs[ZaAccount.A_zimbraPasswordMinPunctuationChars]=parseInt(O.attrs[ZaAccount.A_zimbraPasswordMinPunctuationChars])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinNumericChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinNumericChars]!=""&&O.attrs[ZaAccount.A_zimbraPasswordMinNumericChars]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraPasswordMinNumericChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinNumericChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinNumericChars,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinNumericChars]){
O.attrs[ZaAccount.A_zimbraPasswordMinNumericChars]=parseInt(O.attrs[ZaAccount.A_zimbraPasswordMinNumericChars])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinDigitsOrPuncs]!=""&&O.attrs[ZaAccount.A_zimbraPasswordMinDigitsOrPuncs]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraPasswordMinDigitsOrPuncs])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinDigitsOrPuncs]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordMinDigitsOrPuncs]){
O.attrs[ZaAccount.A_zimbraPasswordMinDigitsOrPuncs]=parseInt(O.attrs[ZaAccount.A_zimbraPasswordMinDigitsOrPuncs])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraAuthTokenLifetime,O)){
if(O.attrs[ZaAccount.A_zimbraAuthTokenLifetime]!=""&&O.attrs[ZaAccount.A_zimbraAuthTokenLifetime]!=null&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraAuthTokenLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraAuthTokenLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraAdminAuthTokenLifetime,O)){
if(O.attrs[ZaAccount.A_zimbraAdminAuthTokenLifetime]!=""&&O.attrs[ZaAccount.A_zimbraAdminAuthTokenLifetime]!=null&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraAdminAuthTokenLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraAdminAuthTokenLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration,O)){
if(O.attrs[ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration]!=""&&O.attrs[ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration]!=null&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPrefOutOfOfficeCacheDuration]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPrefMailPollingInterval,O)){
var j=O.attrs[ZaAccount.A_zimbraPrefMailPollingInterval];
if(j!=""&&j!=null&&!AjxUtil.isLifeTime(j)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPrefMailPollingInterval]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailMinPollingInterval,O)){
var r=O.attrs[ZaAccount.A_zimbraMailMinPollingInterval];
if(r!=""&&r!=null&&!AjxUtil.isLifeTime(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailMinPollingInterval]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailMinPollingInterval,O)){
if(r==""||r==null){
r=O._defaultValues.attrs[ZaAccount.A_zimbraMailMinPollingInterval]
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPrefMailPollingInterval,O)){
if(j==""||j==null){
j=O._defaultValues.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]
}
if(j!=null&&r!=null){
if(ZaUtil.getLifeTimeInSeconds(j)<ZaUtil.getLifeTimeInSeconds(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+r);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailIdleSessionTimeout,O)){
if(O.attrs[ZaAccount.A_zimbraMailIdleSessionTimeout]!=""&&O.attrs[ZaAccount.A_zimbraMailIdleSessionTimeout]!=null&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraMailIdleSessionTimeout])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailIdleSessionTimeout]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailMessageLifetime,O)){
if(O.attrs[ZaAccount.A_zimbraMailMessageLifetime]!=""&&O.attrs[ZaAccount.A_zimbraMailMessageLifetime]!=null){
if(!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraMailMessageLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailMessageLifetime]));
return false
}
var k=parseInt(O.attrs[ZaAccount.A_zimbraMailMessageLifetime].substr(0,O.attrs[ZaAccount.A_zimbraMailMessageLifetime].length-1));
if(k>0&&k<31){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_MESSAGE_LIFETIME_BELOW_31);
return false
}}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailTrashLifetime,O)){
if(O.attrs[ZaAccount.A_zimbraMailTrashLifetime]!=""&&O.attrs[ZaAccount.A_zimbraMailTrashLifetime]!=null&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraMailTrashLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailTrashLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMailSpamLifetime,O)){
if(O.attrs[ZaAccount.A_zimbraMailSpamLifetime]!=""&&O.attrs[ZaAccount.A_zimbraMailSpamLifetime]!=0&&O.attrs[ZaAccount.A_zimbraMailSpamLifetime]!=null&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraMailSpamLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailSpamLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordLockoutFailureLifetime,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordLockoutFailureLifetime]!=""&&O.attrs[ZaAccount.A_zimbraPasswordLockoutFailureLifetime]!=null&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraPasswordLockoutFailureLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordLockoutFailureLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordLockoutDuration,O)){
if(O.attrs[ZaAccount.A_zimbraPasswordLockoutDuration]!=""&&O.attrs[ZaAccount.A_zimbraPasswordLockoutDuration]!=null&&O.attrs[ZaAccount.A_zimbraPasswordLockoutDuration]!=0&&!AjxUtil.isLifeTime(O.attrs[ZaAccount.A_zimbraPasswordLockoutDuration])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordLockoutDuration]));
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraEnforcePwdHistory,O)){
if(O.attrs[ZaAccount.A__zimbraEnforcePwdHistory]!=""&&O.attrs[ZaAccount.A_zimbraEnforcePwdHistory]!=null&&!AjxUtil.isNonNegativeLong(O.attrs[ZaAccount.A_zimbraEnforcePwdHistory])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraEnforcePwdHistory]));
return false
}
if(O.attrs[ZaAccount.A_zimbraEnforcePwdHistory]){
O.attrs[ZaAccount.A_zimbraEnforcePwdHistory]=parseInt(O.attrs[ZaAccount.A_zimbraEnforcePwdHistory])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxMailItemsPerPage,O)){
var m;
if(O.attrs[ZaAccount.A_zimbraMaxMailItemsPerPage]!=null){
m=parseInt(O.attrs[ZaAccount.A_zimbraMaxMailItemsPerPage])
}else{
m=parseInt(O._defaultValues.attrs[ZaAccount.A_zimbraMaxMailItemsPerPage])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPrefMailItemsPerPage,O)){
var v;
if(O.attrs[ZaAccount.A_zimbraPrefMailItemsPerPage]!=null){
v=parseInt(O.attrs[ZaAccount.A_zimbraPrefMailItemsPerPage])
}else{
v=parseInt(O._defaultValues.attrs[ZaAccount.A_zimbraPrefMailItemsPerPage])
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPrefMailItemsPerPage,O)&&ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxMailItemsPerPage,O)){
if(m<v){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ITEMS_PER_PAGE_OVER_MAX);
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraDomainAdminMaxMailQuota,O)&&(O.attrs[ZaAccount.A_zimbraMailQuota]!=null)){
var s=O._defaultValues.attrs[ZaAccount.A_zimbraDomainAdminMaxMailQuota];
var x=O.attrs[ZaAccount.A_zimbraMailQuota];
if(x>s){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_MAX_ACCOUNT_QUOTA);
return false
}}
var u=[ZaAccount.A_zimbraMailForwardingAddress,ZaAccount.A_zimbraPrefMailForwardingAddress,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo];
var n=AjxUtil.reduce(u.concat([ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled]),function(W,A){
return W||ZaItem.hasWritePermission(A,O)
}
);
if(n&&O.attrs[ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled]=="TRUE"){
var g=AjxUtil.reduce(u,function(W,A){
return W||(O.attrs[A]&&O.attrs[A].length>0)
}
);
if(!g){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_missing_zimbraPrefMailForwardingAddress);
return false
}}
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraPasswordLockoutMaxFailures,O)&&O.attrs[ZaAccount.A_zimbraPasswordLockoutMaxFailures]&&!AjxUtil.isInt(O.attrs[ZaAccount.A_zimbraPasswordLockoutMaxFailures])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_VALUE_NOT_INTEGER,ZaAccount.A_zimbraPasswordLockoutMaxFailures));
return false
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNTS_SKIN_TAB]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var y=O.attrs[ZaAccount.A_zimbraPrefSkin]?O.attrs[ZaAccount.A_zimbraPrefSkin]:O._defaultValues.attrs[ZaCos.A_zimbraPrefSkin];
var l=O.attrs[ZaAccount.A_zimbraAvailableSkin]?O.attrs[ZaAccount.A_zimbraAvailableSkin]:O._defaultValues.attrs[ZaCos.A_zimbraAvailableSkin];
if(y&&l){
var t=l instanceof Array?l:[l];
var b=t.length;
var f=false;
for(var w=0;
w<b;
w++){
if(t[w]==y){
f=true;
break
}}
if(!f){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.NAD_WarningCurrentThemeNotAvail,[y,y]));
return false
}}}
if(!ZaAccount.isAccountTypeSet(O)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_TYPE_NOT_SET);
return false
}
return true
};
ZaAccount.createMethod=function(r,c){
r.attrs[ZaAccount.A_mail]=r.name.replace(/[\s]+/g,"");
var h;
var p=AjxSoapDoc.create("CreateAccountRequest",ZaZimbraAdmin.URN,null);
p.set(ZaAccount.A_name,r.attrs[ZaAccount.A_mail]);
if(r.attrs[ZaAccount.A_password]&&r.attrs[ZaAccount.A_password].length>0){
p.set(ZaAccount.A_password,r.attrs[ZaAccount.A_password])
}
if(r[ZaAccount.A2_autoMailServer]=="TRUE"){
r.attrs[ZaAccount.A_mailHost]=null
}
if(r[ZaAccount.A2_autoCos]=="TRUE"){
r.attrs[ZaAccount.A_COSId]=null
}
for(var m in r.attrs){
if(m==ZaAccount.A_password||m==ZaAccount.A_zimbraMailAlias||m==ZaItem.A_objectClass||m==ZaAccount.A2_mbxsize||m==ZaAccount.A_mail){
continue
}
if(r.attrs[m] instanceof Array){
var t=r.attrs[m].length;
if(t){
for(var n=0;
n<t;
n++){
if(typeof(r.attrs[m][n])=="object"){
var d=p.set("a",r.attrs[m][n].toString());
d.setAttribute("n",m)
}else{
var d=p.set("a",r.attrs[m][n]);
d.setAttribute("n",m)
}}}}else{
if(r.attrs[m] instanceof AjxVector){
var g=r.attrs[m].getArray();
var t=g.length;
if(t){
for(var n=0;
n<t;
n++){
if(g[n]!=null){
if(typeof(g[n])=="object"){
var d=p.set("a",g[n].toString());
d.setAttribute("n",m)
}else{
var d=p.set("a",g[n]);
d.setAttribute("n",m)
}}}}}else{
if(r.attrs[m]!=null){
if(typeof(r.attrs[m])=="object"){
var d=p.set("a",r.attrs[m].toString());
d.setAttribute("n",m)
}else{
var d=p.set("a",r.attrs[m]);
d.setAttribute("n",m)
}}}}}
try{
var s=new Object();
s.soapDoc=p;
var e={};
e.controller=ZaApp.getInstance().getCurrentController();
e.busyMsg=ZaMsg.BUSY_CREATE_ACCOUNTS;
h=ZaRequestMgr.invoke(s,e).Body.CreateAccountResponse
}
catch(u){
throw u;
return null
}
c.initFromJS(h.account[0]);
if(r.attrs[ZaAccount.A_zimbraMailAlias].length){
var f=r.attrs[ZaAccount.A_zimbraMailAlias].length;
var l="";
var o=0;
try{
for(var n=0;
n<f;
n++){
try{
if(r.attrs[ZaAccount.A_zimbraMailAlias][n]!=""){
c.addAlias(r.attrs[ZaAccount.A_zimbraMailAlias][n]);
c.attrs[ZaAccount.A_zimbraMailAlias].push(r.attrs[ZaAccount.A_zimbraMailAlias][n])
}}
catch(u){
if(u.code==ZmCsfeException.ACCT_EXISTS){
l+=("<br>"+r.attrs[ZaAccount.A_zimbraMailAlias][n]);
o++
}else{
throw (u)
}}}
if(o==1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.WARNING_ALIAS_EXISTS,[l]))
}else{
if(o>1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.WARNING_ALIASES_EXIST,[l]))
}}}
catch(u){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.FAILED_ADD_ALIASES,u);
return null
}}};
ZaItem.createMethods.ZaAccount.push(ZaAccount.createMethod);
ZaAccount.modifyMethod=function(d){
var c=false;
var l=AjxSoapDoc.create("ModifyAccountRequest",ZaZimbraAdmin.URN,null);
l.set("id",this.id);
for(var h in d){
c=true;
if(d[h] instanceof Array){
var t=d[h].length;
if(t){
var n=false;
for(var o=0;
o<t;
o++){
var r=null;
if(d[h][o] instanceof String||AjxUtil.isString(d[h][o])){
if(AjxUtil.isEmpty(d[h][o])){
continue
}else{
n=true
}
var r=l.set("a",d[h][o].toString())
}else{
if(d[h][o] instanceof Object){
var r=l.set("a",d[h][o].toString());
n=true
}else{
var r=l.set("a",d[h][o]);
n=true
}}
if(r){
r.setAttribute("n",h)
}}
if(!n){
var r=l.set("a","");
r.setAttribute("n",h)
}}else{
var r=l.set("a","");
r.setAttribute("n",h)
}}else{
var r=l.set("a",d[h]);
r.setAttribute("n",h)
}}
if(!c){
return
}
var s=new Object();
s.soapDoc=l;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_ACCOUNT};
resp=ZaRequestMgr.invoke(s,e).Body.ModifyAccountResponse;
this.initFromJS(resp.account[0]);
this[ZaAccount.A2_confirmPassword]=null;
this._toolTip=null;
return
};
ZaItem.modifyMethods.ZaAccount.push(ZaAccount.modifyMethod);
ZaAccount.getViewMailLink=function(t){
var s={
authToken:"",lifetime:0};
var n=AjxSoapDoc.create("DelegateAuthRequest",ZaZimbraAdmin.URN,null);
var e=n.set("account",t);
e.setAttribute("by","id");
var h=new Object();
h.soapDoc=n;
var o={
controller:ZaApp.getInstance().getCurrentController()};
var r=ZaRequestMgr.invoke(h,o).Body.DelegateAuthResponse;
s.authToken=r.authToken[0]._content;
s.lifetime=r.lifetime;
return s
};
ZaReindexMailbox=function(){
this.status=null;
this.numSucceeded=0;
this.numFailed=0;
this.numRemaining=0;
this.numTotal=100;
this.numDone=0;
this.progressMsg=ZaMsg.NAD_ACC_ReindexingNotRunning;
this.mbxId=null;
this.resultMsg=null;
this.errorDetail=null;
this.pollInterval=500
};
ZaReindexMailbox.A_status="status";
ZaReindexMailbox.A_numSucceeded="numSucceeded";
ZaReindexMailbox.A_numFailed="numFailed";
ZaReindexMailbox.A_numRemaining="numRemaining";
ZaReindexMailbox.A_mbxId="mbxId";
ZaReindexMailbox.A_numTotal="numTotal";
ZaReindexMailbox.A_numDone="numDone";
ZaReindexMailbox.A_pollInterval="pollInterval";
ZaReindexMailbox.A_progressMsg="progressMsg";
ZaReindexMailbox.A_errorDetail="errorDetail";
ZaReindexMailbox.A_resultMsg="resultMsg";
ZaReindexMailbox.myXModel={
items:[{
id:ZaReindexMailbox.A_status,ref:ZaReindexMailbox.A_status,type:_STRING_}
,{
id:ZaReindexMailbox.A_numSucceeded,ref:ZaReindexMailbox.A_numSucceeded,type:_NUMBER_}
,{
id:ZaReindexMailbox.A_numFailed,ref:ZaReindexMailbox.A_numFailed,type:_NUMBER_}
,{
id:ZaReindexMailbox.A_numRemaining,ref:ZaReindexMailbox.A_numRemaining,type:_NUMBER_}
,{
id:ZaReindexMailbox.A_mbxId,ref:ZaReindexMailbox.A_mbxId,type:_STRING_}
,{
id:ZaReindexMailbox.A_numTotal,ref:ZaReindexMailbox.A_numTotal,type:_NUMBER_}
,{
id:ZaReindexMailbox.A_numDone,ref:ZaReindexMailbox.A_numDone,type:_NUMBER_}
,{
id:ZaReindexMailbox.A_pollInterval,ref:ZaReindexMailbox.A_pollInterval,type:_STRING_}
,{
id:ZaReindexMailbox.A_progressMsg,ref:ZaReindexMailbox.A_progressMsg,type:_STRING_}
,{
id:ZaReindexMailbox.A_resultMsg,ref:ZaReindexMailbox.A_pollInterval,type:_STRING_}
,{
id:ZaReindexMailbox.A_errorDetail,ref:ZaReindexMailbox.A_pollInterval,type:_STRING_}
]};
ZaAccount.prototype.remove=function(n){
var e;
if(this[ZaAccount.A2_ldap_ds]||this[ZaAccount.A2_zimbra_ds]){
e=AjxSoapDoc.create("DeleteGalSyncAccountRequest",ZaZimbraAdmin.URN,null);
var t=e.set("account",this.id);
t.setAttribute("by","id")
}else{
e=AjxSoapDoc.create("DeleteAccountRequest",ZaZimbraAdmin.URN,null);
e.set("id",this.id)
}
this.deleteCommand=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=e;
o.noAuthToken=true;
if(n){
o.asyncMode=true;
o.callback=n
}
this.deleteCommand.invoke(o)
};
ZaAccount.getReindexStatus=function(t,l){
var n=AjxSoapDoc.create("ReIndexRequest",ZaZimbraAdmin.URN,null);
n.getMethod().setAttribute("action","status");
var e=n.set("mbox",null);
e.setAttribute("id",t);
var h=null;
try{
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=n;
s.noAuthToken=true;
if(l){
s.asyncMode=true;
s.callback=l;
r.invoke(s)
}else{
h=r.invoke(s)
}}
catch(o){
if(o.code=="service.NOT_IN_PROGRESS"){
h=null
}else{
throw (o)
}}
return h
};
ZaAccount.startReindexMailbox=function(t,l){
var n=AjxSoapDoc.create("ReIndexRequest",ZaZimbraAdmin.URN,null);
n.getMethod().setAttribute("action","start");
var e=n.set("mbox",null);
e.setAttribute("id",t);
var h;
try{
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=n;
s.noAuthToken=true;
if(l){
s.asyncMode=true;
s.callback=l;
r.invoke(s)
}else{
h=r.invoke(s)
}}
catch(o){
h=o
}
return h
};
ZaAccount.abortReindexMailbox=function(t,l){
var n=AjxSoapDoc.create("ReIndexRequest",ZaZimbraAdmin.URN,null);
n.getMethod().setAttribute("action","cancel");
var e=n.set("mbox",null);
e.setAttribute("id",t);
var h;
try{
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=n;
s.noAuthToken=true;
if(l){
s.asyncMode=true;
s.callback=l;
r.invoke(s)
}else{
h=r.invoke(s)
}}
catch(o){
h=o
}
return h
};
ZaAccount.parseReindexResponse=function(t,c,o){
if(!t){
return
}
if(t.isException&&t.isException()){
var r=t.getException().code;
if(r&&r=="service.NOT_IN_PROGRESS"){
o.setInstanceValue("",ZaReindexMailbox.A_errorDetail);
o.setInstanceValue("",ZaReindexMailbox.A_resultMsg);
o.setInstanceValue(ZaMsg.NAD_ACC_ReindexingNotRunning,ZaReindexMailbox.A_progressMsg);
if(c.numRemaining>0||c.status=="started"){
o.setInstanceValue(c.numTotal,ZaReindexMailbox.A_numDone);
o.setInstanceValue(ZaMsg.NAD_ACC_ReindexingComplete,ZaReindexMailbox.A_progressMsg);
o.setInstanceValue("complete",ZaReindexMailbox.A_status)
}else{
o.setInstanceValue(null,ZaReindexMailbox.A_status)
}}else{
if(r&&r==ZmCsfeException.EMPTY_RESPONSE){
o.setInstanceValue(ZaMsg.ERROR_RECEIVED_EMPTY_RESPONSE,ZaReindexMailbox.A_resultMsg);
o.setInstanceValue(null,ZaReindexMailbox.A_errorDetail);
o.setInstanceValue("error",ZaReindexMailbox.A_status)
}else{
var h=t.getException().detail;
var n=t.getException().msg;
var l=[];
if(h){
l.push(h)
}
if(n){
l.push(n)
}
o.setInstanceValue(AjxMessageFormat.format(ZaMsg.FAILED_REINDEX,[r]),ZaReindexMailbox.A_resultMsg);
o.setInstanceValue(l.join("\n"),ZaReindexMailbox.A_errorDetail);
o.setInstanceValue("error",ZaReindexMailbox.A_status)
}}}else{
var s;
if(t.getResponse){
s=t.getResponse()
}else{
if(t.Body.ReIndexResponse){
s=t
}}
if(s&&s.Body.ReIndexResponse){
if(s.Body.ReIndexResponse.status=="idle"){
o.setInstanceValue("",ZaReindexMailbox.A_errorDetail);
o.setInstanceValue("",ZaReindexMailbox.A_resultMsg);
o.setInstanceValue(ZaMsg.NAD_ACC_ReindexingNotRunning,ZaReindexMailbox.A_progressMsg);
if(c.numRemaining>0||c.status=="started"){
o.setInstanceValue(c.numTotal,ZaReindexMailbox.A_numDone);
o.setInstanceValue(ZaMsg.NAD_ACC_ReindexingComplete,ZaReindexMailbox.A_progressMsg);
o.setInstanceValue("complete",ZaReindexMailbox.A_status)
}else{
o.setInstanceValue(null,ZaReindexMailbox.A_status)
}
o.setInstanceValue(s.Body.ReIndexResponse.status,ZaReindexMailbox.A_status)
}else{
o.setInstanceValue(s.Body.ReIndexResponse.status,ZaReindexMailbox.A_status);
if(s.Body.ReIndexResponse.status=="started"){
o.setInstanceValue(0,ZaReindexMailbox.A_numDone);
o.setInstanceValue(ZaMsg.NAD_ACC_ReindexingStarted,ZaReindexMailbox.A_progressMsg)
}
if(s.Body.ReIndexResponse.progress&&s.Body.ReIndexResponse.progress[0]){
var e=s.Body.ReIndexResponse.progress[0];
o.setInstanceValue(e.numFailed,ZaReindexMailbox.A_numFailed);
o.setInstanceValue(e.numSucceeded,ZaReindexMailbox.A_numSucceeded);
o.setInstanceValue(e.numRemaining,ZaReindexMailbox.A_numRemaining);
o.setInstanceValue(e.numSucceeded+e.numFailed+e.numRemaining,ZaReindexMailbox.A_numTotal);
o.setInstanceValue(e.numFailed+e.numSucceeded,ZaReindexMailbox.A_numDone);
o.setInstanceValue(AjxMessageFormat.format(ZaMsg.NAD_ACC_ReindexingStatus,[e.numSucceeded,e.numRemaining,e.numFailed]),ZaReindexMailbox.A_progressMsg);
if(c.status=="cancelled"){
o.setInstanceValue((c.progressMsg+"<br>"+ZaMsg.NAD_ACC_ReindexingCancelled),ZaReindexMailbox.A_progressMsg)
}
if(c.numRemaining==0){
o.setInstanceValue(c.numTotal,ZaReindexMailbox.A_numDone)
}}}}}};
ZaAccount.prototype.initFromDom=function(s){
this.name=s.getAttribute("name");
this.id=s.getAttribute("id");
this.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
this.attrs[ZaAccount.A_zimbraMailForwardingAddress]=new Array();
this.attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]=new Array();
this.attrs[ZaAccount.A_zimbraAllowFromAddress]=new Array();
this.attrs[ZaAccount.A_zimbraForeignPrincipal]=[];
var n=s.childNodes;
for(var o=0;
o<n.length;
o++){
child=n[o];
if(child.nodeName!="a"){
continue
}
var e=child.getAttribute("n");
if(child.firstChild!=null){
var r=child.firstChild.nodeValue;
if(e in this.attrs){
var t=this.attrs[e];
if((typeof t)=="object"){
t.push(r)
}else{
this.attrs[e]=[t,r]
}}else{
this.attrs[e]=r
}}}};
ZaAccount.prototype.initFromJS=function(o){
if(!o){
return
}
this.attrs=new Object();
this.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
this.name=o.name;
this.id=o.id;
this.isExternal=o.isExternal;
var e=o.a.length;
this.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
this.attrs[ZaAccount.A_zimbraMailForwardingAddress]=new Array();
this.attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]=new Array();
this.attrs[ZaAccount.A_zimbraAllowFromAddress]=new Array();
this.attrs[ZaAccount.A_zimbraForeignPrincipal]=[];
for(var t=0;
t<e;
t++){
if(!this.attrs[[o.a[t].n]]){
this.attrs[[o.a[t].n]]=o.a[t]._content
}else{
if(!(this.attrs[[o.a[t].n]] instanceof Array)){
this.attrs[[o.a[t].n]]=[this.attrs[[o.a[t].n]]]
}
this.attrs[[o.a[t].n]].push(o.a[t]._content)
}}
if(!(this.attrs[ZaAccount.A_description] instanceof Array)){
this.attrs[ZaAccount.A_description]=[this.attrs[ZaAccount.A_description]]
}
if(!this.attrs[ZaItem.A_zimbraId]&&this.id){
this.attrs[ZaItem.A_zimbraId]=this.id
}
if(this.attrs[ZaAccount.A_zimbraProxyAllowedDomains]&&(!(this.attrs[ZaAccount.A_zimbraProxyAllowedDomains] instanceof Array))){
this.attrs[ZaAccount.A_zimbraProxyAllowedDomains]=[this.attrs[ZaAccount.A_zimbraProxyAllowedDomains]]
}};
ZaAccount.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table cellpadding='0' cellspacing='0' border='0'>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;width:350' >";
t[e++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
if(this.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t[e++]=AjxImg.getImageHtml("AdminUser")
}else{
if(this.attrs[ZaAccount.A_zimbraIsDelegatedAdminAccount]=="TRUE"){
t[e++]=AjxImg.getImageHtml("DomainAdminUser")
}else{
if(this.attrs[ZaAccount.A_zimbraIsSystemResource]=="TRUE"){
t[e++]=AjxImg.getImageHtml("SystemResource")
}else{
t[e++]=AjxImg.getImageHtml("Account")
}}}
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
if(this.isExternal){
e=this._addRow(ZaMsg.NAD_MailServer,this.attrs[ZaAccount.A_zimbraMailTransport],t,e);
t[e++]="<tr valign='top'><td align='left' style='padding-right: 5px;' colspan='2'><b>";
t[e++]=AjxStringUtil.htmlEncode(ZaMsg.externalAccountNote);
t[e++]="</b></td>";
t[e++]="</td></tr>"
}else{
e=this._addRow(ZaMsg.NAD_MailServer,this.attrs[ZaAccount.A_mailHost],t,e)
}
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaAccount.loadMethod=function(w,O){
var T,j,m;
T=AjxSoapDoc.create("BatchRequest","urn:zimbra");
T.setMethodAttribute("onerror","continue");
if(w=="id"){
this.id=O;
this.attrs[ZaItem.A_zimbraId]=O;
var q=T.set("GetAccountRequest",null,null,ZaZimbraAdmin.URN);
q.setAttribute("applyCos","0");
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
q.setAttribute("attrs",this.attrsToGet.join(","))
}
var p=T.set("account",O,q);
p.setAttribute("by",w)
}else{
var q=AjxSoapDoc.create("GetAccountRequest",ZaZimbraAdmin.URN,null);
q.getMethod().setAttribute("applyCos","0");
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
q.getMethod().setAttribute("attrs",this.attrsToGet.join(","))
}
var p=q.set("account",O);
p.setAttribute("by",w);
var j=new Object();
j.soapDoc=q;
var n={
controller:ZaApp.getInstance().getCurrentController()};
m=ZaRequestMgr.invoke(j,n).Body.GetAccountResponse;
this.attrs=new Object();
this.initFromJS(m.account[0])
}
if(!AjxUtil.isEmpty(this.attrs[ZaAccount.A_mailHost])&&ZaItem.hasRight(ZaAccount.GET_MAILBOX_INFO_RIGHT,this)&&this.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]!="TRUE"){
var f=T.set("GetMailboxRequest",null,null,ZaZimbraAdmin.URN);
var g=T.set("mbox","",f);
g.setAttribute("id",this.attrs[ZaItem.A_zimbraId])
}
this[ZaAccount.A2_confirmPassword]=null;
if(ZaItem.hasRight(ZaAccount.GET_ACCOUNT_MEMBERSHIP_RIGHT,this)){
var r=AjxSoapDoc.create("GetAccountMembershipRequest",ZaZimbraAdmin.URN);
var o=r.set("account",this.attrs[ZaItem.A_zimbraId]);
o.setAttribute("by","id");
var j={
soapDoc:r,asyncMode:true,callback:this._handleAccountMembershipResponse.bind(this)};
var n={
controller:ZaApp.getInstance().getCurrentController()};
ZaRequestMgr.invoke(j,n)
}
if(ZaItem.hasRight(ZaAccount.GET_ACCOUNT_INFO_RIGHT,this)){
var u=T.set("GetAccountInfoRequest",null,null,ZaZimbraAdmin.URN);
var o=T.set("account",this.attrs[ZaItem.A_zimbraId],u);
o.setAttribute("by","id")
}
if(ZaItem.hasRight(ZaAccount.VIEW_MAIL_RIGHT,this)){
var k=T.set("GetDataSourcesRequest",null,null,ZaZimbraAdmin.URN);
var c=T.set("id",this.attrs[ZaItem.A_zimbraId],k)
}
var s=false;
var x;
if(w=="id"||ZaItem.hasRight(ZaAccount.GET_ACCOUNT_INFO_RIGHT,this)||ZaItem.hasRight(ZaAccount.GET_ACCOUNT_MEMBERSHIP_RIGHT,this)||(!AjxUtil.isEmpty(this.attrs[ZaAccount.A_mailHost])&&ZaItem.hasRight(ZaAccount.GET_MAILBOX_INFO_RIGHT,this))){
try{
j=new Object();
j.soapDoc=T;
var n={
controller:ZaApp.getInstance().getCurrentController()};
var z=ZaRequestMgr.invoke(j,n);
if(z.isException&&z.isException()){
ZaApp.getInstance().getCurrentController()._handleException(z.getException(),"ZaAccount.loadMethod",null,false);
s=true;
x=v
}else{
if(z.Body.BatchResponse.Fault){
var h=z.Body.BatchResponse.Fault;
if(h instanceof Array){
h=h[0]
}
if(h){
var v=ZmCsfeCommand.faultToEx(h);
ZaApp.getInstance().getCurrentController()._handleException(v,"ZaAccount.loadMethod",null,false);
s=true;
x=v
}}else{
var y=z.Body.BatchResponse;
if(y.GetAccountResponse){
m=y.GetAccountResponse[0];
this.initFromJS(m.account[0])
}
if(y.GetMailboxResponse){
m=y.GetMailboxResponse[0];
if(m&&m.mbox&&m.mbox[0]){
this.attrs[ZaAccount.A2_mbxsize]=m.mbox[0].s
}}
if(y.GetAccountMembershipResponse){
m=y.GetAccountMembershipResponse[0];
this[ZaAccount.A2_memberOf]=ZaAccountMemberOfListView.parseGetAccMembershipResponse(m);
this[ZaAccount.A2_directMemberList+"_more"]=(this[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList].length>ZaAccountMemberOfListView.SEARCH_LIMIT)?1:0;
this[ZaAccount.A2_indirectMemberList+"_more"]=(this[ZaAccount.A2_memberOf][ZaAccount.A2_indirectMemberList].length>ZaAccountMemberOfListView.SEARCH_LIMIT)?1:0
}
if(y.GetAccountInfoResponse){
m=y.GetAccountInfoResponse[0];
if(m[ZaAccount.A2_publicMailURL]&&m[ZaAccount.A2_publicMailURL][0]){
this[ZaAccount.A2_publicMailURL]=m[ZaAccount.A2_publicMailURL][0]._content
}
if(m[ZaAccount.A2_adminSoapURL]&&m[ZaAccount.A2_adminSoapURL][0]){
this[ZaAccount.A2_adminSoapURL]=m[ZaAccount.A2_adminSoapURL][0]._content
}
if(m[ZaAccount.A2_soapURL]&&m[ZaAccount.A2_soapURL][0]){
this[ZaAccount.A2_soapURL]=m[ZaAccount.A2_soapURL][0]._content
}
if(m.cos&&m.cos.id){
this[ZaAccount.A2_currentAccountType]=m.cos.id
}}
if(y.GetDataSourcesResponse&&y.GetDataSourcesResponse instanceof Array&&y.GetDataSourcesResponse[0]){
this[ZaAccount.A2_datasources]=new ZaItemList(ZaDataSource);
this[ZaAccount.A2_datasources].loadFromJS(y.GetDataSourcesResponse[0]);
var e=this[ZaAccount.A2_datasources].getArray();
if(e&&e.length){
for(var b=0;
b<e.length;
b++){
if(e[b].attrs[ZaDataSource.A_zimbraDataSourceType]==ZaDataSource.DS_TYPE_GAL){
if(e[b].attrs[ZaDataSource.A_zimbraGalType]==ZaDataSource.GAL_TYPE_ZIMBRA){
this[ZaAccount.A2_zimbra_ds]=e[b]
}else{
if(e[b].attrs[ZaDataSource.A_zimbraGalType]==ZaDataSource.GAL_TYPE_LDAP){
this[ZaAccount.A2_ldap_ds]=e[b]
}}}}}}}}}
catch(v){
ZaApp.getInstance().getCurrentController()._handleException(v,"ZaAccount.prototype.load",null,false);
s=true;
x=v
}}
if(s){
throw x
}
var d;
if(this.attrs[ZaAccount.A_firstName]){
d=this.attrs[ZaAccount.A_firstName]
}else{
d=""
}
if(this.attrs[ZaAccount.A_initials]){
d+=" ";
d+=this.attrs[ZaAccount.A_initials];
d+="."
}
if(this.attrs[ZaAccount.A_lastName]){
if(d.length>0){
d+=" "
}
d+=this.attrs[ZaAccount.A_lastName]
}
if(this.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]){
var t=ZaUtil.getLifeTimeInSeconds(this.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]);
if(t>=1){
this.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]=t+"s"
}}
if(this._defaultValues.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]){
var l=ZaUtil.getLifeTimeInSeconds(this._defaultValues.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]);
if(l>=1){
this._defaultValues.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]=l+"s"
}}
if(d==this.attrs[ZaAccount.A_displayname]){
this[ZaAccount.A2_autodisplayname]="TRUE"
}else{
this[ZaAccount.A2_autodisplayname]="FALSE"
}};
ZaItem.loadMethods.ZaAccount.push(ZaAccount.loadMethod);
ZaAccount.prototype.rename=function(e){
if(ZaAccount.renameMethods){
var t=ZaAccount.renameMethods;
var n=t.length;
for(var o=0;
o<n;
o++){
if(typeof(t[o])=="function"){
t[o].call(this,e)
}}}};
ZaAccount.renameMethod=function(e){
var t=AjxSoapDoc.create("RenameAccountRequest",ZaZimbraAdmin.URN,null);
t.set("id",this.id);
t.set("newName",e);
var n=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=t;
o.noAuthToken=true;
n.invoke(o)
};
ZaAccount.renameMethods.push(ZaAccount.renameMethod);
ZaAccount.changePasswordMethod=function(n){
var e=AjxSoapDoc.create("SetPasswordRequest",ZaZimbraAdmin.URN,null);
e.set("id",this.id);
e.set("newPassword",n);
var o=new ZmCsfeCommand();
var t=new Object();
t.soapDoc=e;
t.noAuthToken=true;
o.invoke(t)
};
ZaAccount.prototype.changePassword=function(n){
if(ZaAccount.changePasswordMethods){
var e=ZaAccount.changePasswordMethods;
var o=e.length;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
e[t].call(this,n)
}}}};
ZaAccount.changePasswordMethods.push(ZaAccount.changePasswordMethod);
ZaAccount.isValidName=function(s){
if(AjxUtil.isEmpty(s)){
return false
}
var t=s.indexOf("@");
var e=s.substring(0,t);
var n=e.replace(/(\s*$)/g,"");
n=AjxStringUtil.trim(n);
var o=s.substring(t+1);
o=AjxStringUtil.trim(o);
s=n+"@"+o;
return(AjxEmailAddress.isValid(s))
};
ZaAccount.myXModel={
items:[{
id:"getAttrs",type:_LIST_}
,{
id:"setAttrs",type:_LIST_}
,{
id:"rights",type:_LIST_}
,{
id:ZaItem.A_zimbraACE,ref:"attrs/"+ZaItem.A_zimbraACE,type:_LIST_}
,{
id:ZaAccount.A2_errorMessage,ref:ZaAccount.A2_errorMessage,type:_STRING_}
,{
id:ZaAccount.A2_warningMessage,ref:ZaAccount.A2_warningMessage,type:_STRING_}
,{
id:ZaAccount.A2_domainLeftAccounts,ref:ZaAccount.A2_domainLeftAccounts,type:_STRING_}
,{
id:ZaAccount.A2_showAccountTypeMsg,ref:ZaAccount.A2_showAccountTypeMsg,type:_STRING_}
,{
id:ZaAccount.A_name,type:_STRING_,ref:"name",required:true,constraints:{
type:"method",value:function(n,t,o,e){
if(n){
if(ZaAccount.isValidName(n)){
return n
}else{
throw ZaMsg.ErrorInvalidEmailAddress
}}}}}
,{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:ZaAccount.A_uid,type:_STRING_,ref:"attrs/"+ZaAccount.A_uid}
,{
id:ZaItem.A_zimbraCreateTimestamp,ref:"attrs/"+ZaItem.A_zimbraCreateTimestamp}
,{
id:ZaAccount.A_accountName,type:_STRING_,ref:"attrs/"+ZaAccount.A_accountName}
,{
id:ZaAccount.A_firstName,type:_STRING_,ref:"attrs/"+ZaAccount.A_firstName}
,{
id:ZaAccount.A_lastName,type:_STRING_,ref:"attrs/"+ZaAccount.A_lastName,required:true}
,{
id:ZaAccount.A_zimbraPhoneticFirstName,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPhoneticFirstName}
,{
id:ZaAccount.A_zimbraPhoneticLastName,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPhoneticLastName}
,{
id:ZaAccount.A_zimbraPhoneticCompany,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPhoneticCompany}
,{
id:ZaAccount.A_mail,type:_STRING_,ref:"attrs/"+ZaAccount.A_mail}
,{
id:ZaAccount.A_password,type:_STRING_,ref:"attrs/"+ZaAccount.A_password}
,{
id:ZaAccount.A2_confirmPassword,type:_STRING_}
,ZaItem.descriptionModelItem,{
id:ZaAccount.A_telephoneNumber,type:_STRING_,ref:"attrs/"+ZaAccount.A_telephoneNumber}
,{
id:ZaAccount.A_mobile,type:_STRING_,ref:"attrs/"+ZaAccount.A_mobile}
,{
id:ZaAccount.A_pager,type:_STRING_,ref:"attrs/"+ZaAccount.A_pager}
,{
id:ZaAccount.A_homePhone,type:_STRING_,ref:"attrs/"+ZaAccount.A_homePhone}
,{
id:ZaAccount.A_displayname,type:_STRING_,ref:"attrs/"+ZaAccount.A_displayname}
,{
id:ZaAccount.A_country,type:_STRING_,ref:"attrs/"+ZaAccount.A_country}
,{
id:ZaAccount.A_company,type:_STRING_,ref:"attrs/"+ZaAccount.A_company}
,{
id:ZaAccount.A_title,type:_STRING_,ref:"attrs/"+ZaAccount.A_title}
,{
id:ZaAccount.A_facsimileTelephoneNumber,type:_STRING_,ref:"attrs/"+ZaAccount.A_facsimileTelephoneNumber}
,{
id:ZaAccount.A_initials,type:_STRING_,ref:"attrs/"+ZaAccount.A_initials}
,{
id:ZaAccount.A_city,type:_STRING_,ref:"attrs/"+ZaAccount.A_city}
,{
id:ZaAccount.A_orgUnit,type:_STRING_,ref:"attrs/"+ZaAccount.A_orgUnit}
,{
id:ZaAccount.A_office,type:_STRING_,ref:"attrs/"+ZaAccount.A_office}
,{
id:ZaAccount.A_street,type:_STRING_,ref:"attrs/"+ZaAccount.A_street}
,{
id:ZaAccount.A_zip,type:_STRING_,ref:"attrs/"+ZaAccount.A_zip}
,{
id:ZaAccount.A_state,type:_STRING_,ref:"attrs/"+ZaAccount.A_state}
,{
id:ZaAccount.A_mailDeliveryAddress,type:_EMAIL_ADDRESS_,ref:"attrs/"+ZaAccount.A_mailDeliveryAddress}
,{
id:ZaAccount.A_zimbraMailCanonicalAddress,type:_EMAIL_ADDRESS_,ref:"attrs/"+ZaAccount.A_zimbraMailCanonicalAddress}
,{
id:ZaAccount.A_accountStatus,type:_STRING_,ref:"attrs/"+ZaAccount.A_accountStatus}
,{
id:ZaAccount.A_notes,type:_STRING_,ref:"attrs/"+ZaAccount.A_notes}
,{
id:ZaAccount.A_zimbraMailQuota,type:_COS_MAILQUOTA_,ref:"attrs/"+ZaAccount.A_zimbraMailQuota}
,{
id:ZaAccount.A_mailHost,type:_STRING_,ref:"attrs/"+ZaAccount.A_mailHost}
,{
id:ZaAccount.A_COSId,type:_STRING_,ref:"attrs/"+ZaAccount.A_COSId}
,{
id:ZaAccount.A_zimbraIsAdminAccount,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraIsAdminAccount}
,{
id:ZaAccount.A_zimbraIsSystemResource,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraIsSystemResource}
,{
id:ZaAccount.A_zimbraIsSystemAccount,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraIsSystemAccount}
,{
id:ZaAccount.A_zimbraLastLogonTimestamp,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraLastLogonTimestamp}
,{
id:ZaAccount.A_zimbraMaxPwdLength,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMaxPwdLength,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraMinPwdLength,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMinPwdLength,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraPasswordMinUpperCaseChars,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPasswordMinUpperCaseChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraPasswordMinLowerCaseChars,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPasswordMinLowerCaseChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraPasswordMinPunctuationChars,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPasswordMinPunctuationChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraPasswordMinNumericChars,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPasswordMinNumericChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraAuthLdapExternalDn,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraAuthLdapExternalDn}
,{
id:ZaAccount.A_zimbraMinPwdAge,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMinPwdAge,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraMaxPwdAge,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMaxPwdAge,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraEnforcePwdHistory,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraEnforcePwdHistory,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraMailAlias,type:_LIST_,ref:"attrs/"+ZaAccount.A_zimbraMailAlias,listItem:{
type:_EMAIL_ADDRESS_}}
,{
id:ZaAccount.A_zimbraForeignPrincipal,type:_LIST_,ref:"attrs/"+ZaAccount.A_zimbraForeignPrincipal,listItem:{
type:_STRING_}}
,{
id:ZaAccount.A_zimbraMailForwardingAddress,type:_LIST_,ref:"attrs/"+ZaAccount.A_zimbraMailForwardingAddress,listItem:{
type:_EMAIL_ADDRESS_}}
,{
id:ZaAccount.A_zimbraPrefCalendarForwardInvitesTo,type:_LIST_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarForwardInvitesTo,listItem:{
type:_EMAIL_ADDRESS_}}
,{
id:ZaAccount.A_zimbraPasswordMustChange,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPasswordMustChange}
,{
id:ZaAccount.A_zimbraPasswordLocked,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPasswordLocked,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraContactMaxNumEntries,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraContactMaxNumEntries,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraMailForwardingAddressMaxLength,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMailForwardingAddressMaxLength,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraDataSourcePop3PollingInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraDataSourcePop3PollingInterval}
,{
id:ZaAccount.A_zimbraDataSourceImapPollingInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraDataSourceImapPollingInterval}
,{
id:ZaAccount.A_zimbraDataSourceCalendarPollingInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraDataSourceCalendarPollingInterval}
,{
id:ZaAccount.A_zimbraDataSourceRssPollingInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraDataSourceRssPollingInterval}
,{
id:ZaAccount.A_zimbraDataSourceCaldavPollingInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraDataSourceCaldavPollingInterval}
,{
id:ZaAccount.A_zimbraDataSourceMinPollingInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraDataSourceMinPollingInterval}
,{
id:ZaAccount.A_zimbraPrefAutoSaveDraftInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraPrefAutoSaveDraftInterval}
,{
id:ZaAccount.A_zimbraProxyAllowedDomains,type:_COS_LIST_,ref:"attrs/"+ZaAccount.A_zimbraProxyAllowedDomains,listItem:{
type:_STRING_}}
,{
id:ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraAttachmentsBlocked,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraAttachmentsBlocked,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraQuotaWarnPercent,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraQuotaWarnPercent}
,{
id:ZaAccount.A_zimbraQuotaWarnInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraQuotaWarnInterval}
,{
id:ZaAccount.A_zimbraQuotaWarnMessage,type:_COS_STRING_,ref:"attrs/"+ZaAccount.A_zimbraQuotaWarnMessage}
,{
id:ZaAccount.A_zimbraAuthTokenLifetime,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraAuthTokenLifetime,required:true}
,{
id:ZaAccount.A_zimbraAdminAuthTokenLifetime,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraAdminAuthTokenLifetime,required:true}
,{
id:ZaAccount.A_zimbraMailIdleSessionTimeout,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraMailIdleSessionTimeout}
,{
id:ZaAccount.A_zimbraMailMessageLifetime,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraMailMessageLifetime}
,{
id:ZaAccount.A_zimbraMailSpamLifetime,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraMailSpamLifetime}
,{
id:ZaAccount.A_zimbraMailTrashLifetime,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraMailTrashLifetime}
,{
id:ZaAccount.A_zimbraPrefSaveToSent,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefSaveToSent,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefMailSignature,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailSignature}
,{
id:ZaAccount.A_zimbraPrefMailSignatureEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefMailSignatureEnabled}
,{
id:ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarShowPastDueReminders,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarShowPastDueReminders,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarToasterEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarToasterEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarAllowPublishMethodInvite,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarAllowPublishMethodInvite,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarReminderFlashTitle,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarReminderFlashTitle,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarSendInviteDeniedAutoReply,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarSendInviteDeniedAutoReply,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek,choices:ZaSettings.dayOfWeekChoices}
,{
id:ZaAccount.A_zimbraPrefCalendarInitialView,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarInitialView,choices:ZaSettings.calendarViewChoinces}
,{
id:ZaAccount.A_zimbraPrefClientType,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefClientType,choices:ZaSettings.clientTypeChoices}
,{
id:ZaAccount.A_zimbraPrefTimeZoneId,type:_COS_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefTimeZoneId,choices:ZaSettings.timeZoneChoices}
,{
id:ZaAccount.A_zimbraPrefMailDefaultCharset,type:_COS_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailDefaultCharset,choices:ZaSettings.mailCharsetChoices}
,{
id:ZaAccount.A_zimbraPrefMailToasterEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailToasterEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefMessageIdDedupingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefMessageIdDedupingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefLocale,type:_COS_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefLocale}
,{
id:ZaAccount.A_zimbraPrefSentMailFolder,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefSentMailFolder}
,{
id:ZaAccount.A_zimbraPrefIncludeSpamInSearch,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefIncludeSpamInSearch,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefIncludeTrashInSearch,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefIncludeTrashInSearch,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefMailInitialSearch,type:_COS_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailInitialSearch}
,{
id:ZaAccount.A_zimbraMaxMailItemsPerPage,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMaxMailItemsPerPage,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraPrefMailItemsPerPage,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailItemsPerPage,choices:[10,25,50,100]}
,{
id:ZaAccount.A_zimbraPrefMailPollingInterval,type:_COS_ENUM_POLLING_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailPollingInterval,choices:ZaModel.MAIL_POLLING_INTERVAL_CHOICES}
,{
id:ZaAccount.A_zimbraMailMinPollingInterval,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraMailMinPollingInterval}
,{
id:ZaAccount.A_zimbraPrefMailFlashIcon,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefMailFlashIcon,type:_COS_ENUM_}
,{
id:ZaAccount.A_zimbraPrefMailFlashTitle,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefMailFlashTitle,type:_COS_ENUM_}
,{
id:ZaAccount.A_zimbraPrefMailSoundsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefMailSoundsEnabled,type:_COS_ENUM_}
,{
id:ZaAccount.A_zimbraPrefOutOfOfficeReply,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefOutOfOfficeReply}
,{
id:ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,type:_COS_ENUM_}
,{
id:ZaAccount.A_zimbraPrefItemsPerVirtualPage,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPrefItemsPerVirtualPage}
,{
id:ZaAccount.A_zimbraPrefReplyToAddress,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefReplyToAddress}
,{
id:ZaAccount.A_zimbraPrefUseKeyboardShortcuts,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefUseKeyboardShortcuts,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraAllowAnyFromAddress,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraAllowAnyFromAddress,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraAllowFromAddress,type:_LIST_,ref:"attrs/"+ZaAccount.A_zimbraAllowFromAddress,listItem:{
type:_STRING_}}
,{
id:ZaAccount.A_zimbraPrefComposeInNewWindow,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefComposeInNewWindow,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefAutoAddAddressEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefAutoAddAddressEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefComposeFormat,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefComposeFormat,choices:ZaModel.COMPOSE_FORMAT_CHOICES}
,{
id:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily,choices:ZaModel.FONT_FAMILY_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily,type:_COS_ENUM_}
,{
id:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize,choices:ZaModel.FONT_SIZE_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize,type:_COS_ENUM_}
,{
id:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor,ref:"attrs/"+ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor,type:_COS_STRING_}
,{
id:ZaAccount.A_zimbraMailSignatureMaxLength,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraMailSignatureMaxLength}
,{
id:ZaAccount.A_zimbraPrefGroupMailBy,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefGroupMailBy,choices:ZaModel.GROUP_MAIL_BY_CHOICES}
,{
id:ZaAccount.A_zimbraPrefMessageViewHtmlPreferred,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefMessageViewHtmlPreferred,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefNewMailNotificationAddress,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefNewMailNotificationAddress}
,{
id:ZaAccount.A_zimbraPrefMailForwardingAddress,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailForwardingAddress,constraints:{
type:"method",value:function(l,e,r,d){
if(l){
var o;
var c=0;
var n=0;
var h;
var s;
var t=false;
l=l.replace(/\s/g,"");
for(o=0;
o<l.length;
o++){
n=l.indexOf(",",c);
if(n==-1){
h=l.substring(c);
if(!AjxUtil.isEmailAddress(h,false)){
t=true
}
break
}
h=l.substring(c,n);
if(!AjxUtil.isEmailAddress(h,false)){
t=true;
break
}
c=n+1
}
if(t){
throw ZaMsg.ErrorInvalidEmailAddressList
}}
return l
}}}
,{
id:ZaAccount.A_zimbraPrefNewMailNotificationEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefNewMailNotificationEnabled}
,{
id:ZaAccount.A_zimbraPrefOutOfOfficeReply,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefOutOfOfficeReply}
,{
id:ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled}
,{
id:ZaAccount.A_zimbraIsExternalVirtualAccount,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraIsExternalVirtualAccount}
,{
id:ZaAccount.A_zimbraPrefShowSearchString,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefShowSearchString,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefImapSearchFoldersEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefImapSearchFoldersEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarUseQuickAdd,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarUseQuickAdd,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefSkin,type:_COS_STRING_,ref:"attrs/"+ZaAccount.A_zimbraPrefSkin}
,{
id:ZaAccount.A_zimbraAvailableSkin,type:_COS_LIST_,ref:"attrs/"+ZaAccount.A_zimbraAvailableSkin,dataType:_STRING_}
,{
id:ZaAccount.A_zimbraZimletAvailableZimlets,type:_COS_LIST_,ref:"attrs/"+ZaAccount.A_zimbraZimletAvailableZimlets,dataType:_STRING_,outputType:_LIST_}
,{
id:ZaAccount.A_zimbraPrefGalAutoCompleteEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefGalAutoCompleteEnabled}
,{
id:ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit}
,{
id:ZaAccount.A_zimbraPrefWarnOnExit,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefWarnOnExit}
,{
id:ZaAccount.A_zimbraPrefShowSelectionCheckbox,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraPrefShowSelectionCheckbox}
,{
id:ZaAccount.A_zimbraPrefDisplayExternalImages,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefDisplayExternalImages,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration}
,{
id:ZaAccount.A_zimbraJunkMessagesIndexingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraJunkMessagesIndexingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefMailSendReadReceipts,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefMailSendReadReceipts,choices:ZaModel.SEND_READ_RECEPIT_CHOICES}
,{
id:ZaAccount.A_zimbraPrefReadReceiptsToAddress,type:_EMAIL_ADDRESS_,ref:"attrs/"+ZaAccount.A_zimbraPrefReadReceiptsToAddress}
,{
id:ZaAccount.A_zimbraPrefCalendarAutoAddInvites,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarAutoAddInvites,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarApptVisibility,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarApptVisibility,choices:ZaSettings.apptVisibilityChoices}
,{
id:ZaAccount.A_zimbraFeatureManageZimlets,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureManageZimlets,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureImportFolderEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureImportFolderEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureExportFolderEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureExportFolderEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraDumpsterEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraDumpsterEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraDumpsterUserVisibleAge,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraDumpsterUserVisibleAge}
,{
id:ZaAccount.A_zimbraDumpsterPurgeEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraDumpsterPurgeEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraMailDumpsterLifetime,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraMailDumpsterLifetime}
,{
id:ZaAccount.A_zimbraFeatureMailPriorityEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureMailPriorityEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureReadReceiptsEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureReadReceiptsEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureImapDataSourceEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureImapDataSourceEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeaturePop3DataSourceEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeaturePop3DataSourceEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureMailSendLaterEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureMailSendLaterEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureIdentitiesEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureIdentitiesEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureContactsEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureContactsEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureCalendarEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureCalendarEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureTasksEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureTasksEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureTaggingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureTaggingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeaturePeopleSearchEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeaturePeopleSearchEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureAdvancedSearchEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureAdvancedSearchEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureSavedSearchesEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureSavedSearchesEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureConversationsEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureConversationsEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureChangePasswordEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureChangePasswordEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureFiltersEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureFiltersEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureGalEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureGalEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureMAPIConnectorEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureMAPIConnectorEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureMailEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureMailEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureBriefcasesEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureBriefcasesEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureHtmlComposeEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureHtmlComposeEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureMailForwardingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureMailForwardingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureSharingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureSharingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraExternalSharingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraExternalSharingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPublicSharingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPublicSharingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureNewMailNotificationEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureNewMailNotificationEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureOptionsEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureOptionsEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureSkinChangeEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureSkinChangeEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime,choices:ZaModel.REMINDER_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureGroupCalendarEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureGroupCalendarEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureFlaggingEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureFlaggingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraImapEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraImapEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPop3Enabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPop3Enabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureDistributionListFolderEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaAccount.A_zimbraFeatureDistributionListFolderEnabled,type:_COS_ENUM_}
,{
id:ZaAccount.A_zimbraFeatureSMIMEEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureSMIMEEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureManageSMIMECertificateEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureManageSMIMECertificateEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureEwsEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureEwsEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureTouchClientEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureTouchClientEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaModel.currentStep,type:_NUMBER_,ref:ZaModel.currentStep}
,{
id:ZaAccount.A2_newAlias,type:_STRING_}
,{
id:ZaAccount.A2_aliases,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaAccount.A2_forwarding,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaAccount.A2_mbxsize,type:_NUMBER_,ref:"attrs/"+ZaAccount.A2_mbxsize}
,{
id:ZaAccount.A2_autodisplayname,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A2_autoMailServer,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A2_autoCos,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A2_alias_selection_cache,type:_LIST_}
,{
id:ZaAccount.A2_fwdAddr_selection_cache,type:_LIST_}
,{
id:ZaAccount.A2_calFwdAddr_selection_cache,type:_LIST_}
,{
id:ZaAccount.A2_fp_selection_cache,type:_LIST_}
,{
id:ZaAccount.A_zimbraHideInGal,type:_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraHideInGal,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraMailTransport,type:_STRING_,ref:"attrs/"+ZaAccount.A_zimbraMailTransport}
,{
id:ZaAccount.A_zimbraPasswordLockoutEnabled,type:_COS_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraPasswordLockoutEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_zimbraPasswordLockoutDuration,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraPasswordLockoutDuration}
,{
id:ZaAccount.A_zimbraPasswordLockoutMaxFailures,type:_COS_NUMBER_,ref:"attrs/"+ZaAccount.A_zimbraPasswordLockoutMaxFailures,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaAccount.A_zimbraPasswordLockoutFailureLifetime,type:_COS_MLIFETIME_,ref:"attrs/"+ZaAccount.A_zimbraPasswordLockoutFailureLifetime}
,{
id:ZaAccount.A_zimbraFreebusyExchangeUserOrg,ref:"attrs/"+ZaAccount.A_zimbraFreebusyExchangeUserOrg,type:_COS_STRING_}
,{
id:ZaAccount.A2_ldap_ds,ref:ZaAccount.A2_ldap_ds,type:_OBJECT_,items:ZaDataSource.myXModel.items}
,{
id:ZaAccount.A2_zimbra_ds,ref:ZaAccount.A2_zimbra_ds,type:_OBJECT_,items:ZaDataSource.myXModel.items}
,{
id:ZaAccount.A2_datasources,ref:ZaAccount.A2_datasources,type:_LIST_,listItem:{
type:_OBJECT_,items:ZaDataSource.myXModel.items}}
,{
id:ZaAccount.A2_isExternalAuth,ref:ZaAccount.A2_isExternalAuth,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES1}
]};
ZaItem._ATTR[ZaAccount.A_displayname]=ZaMsg.attrDesc_accountName;
ZaItem._ATTR[ZaAccount.A_description]=ZaMsg.attrDesc_description;
ZaItem._ATTR[ZaAccount.A_firstName]=ZaMsg.attrDesc_firstName;
ZaItem._ATTR[ZaAccount.A_lastName]=ZaMsg.attrDesc_lastName;
ZaItem._ATTR[ZaAccount.A_accountStatus]=ZaMsg.attrDesc_accountStatus;
ZaItem._ATTR[ZaAccount.A_mailHost]=ZabMsg.attrDesc_mailHost;
ZaItem._ATTR[ZaAccount.A_zimbraMailQuota]=ZaMsg.attrDesc_zimbraMailQuota;
ZaItem._ATTR[ZaAccount.A_notes]=ZaMsg.attrDesc_notes;
ZaAccount._accountStatus=function(t){
var e=ZaAccount.getAccountStatusMsg(t);
return(e==null)?t:e
};
ZaAccount.getAccountStatusMsg=function(e){
if(e==ZaAccount.ACCOUNT_STATUS_ACTIVE){
return ZaMsg.accountStatus_active
}else{
if(e==ZaAccount.ACCOUNT_STATUS_CLOSED){
return ZaMsg.accountStatus_closed
}else{
if(e==ZaAccount.ACCOUNT_STATUS_LOCKED){
return ZaMsg.accountStatus_locked
}else{
if(e==ZaAccount.ACCOUNT_STATUS_LOCKOUT){
return ZaMsg.accountStatus_lockout
}else{
if(e==ZaAccount.ACCOUNT_STATUS_MAINTENANCE){
return ZaMsg.accountStatus_maintenance
}else{
if(e==ZaAccount.ACCOUNT_STATUS_PENDING){
return ZaMsg.accountStatus_pending
}else{
return""
}}}}}}};
ZaAccount.initMethod=function(){
this.attrs=new Object();
this.id="";
this.name="";
this.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
this.attrs[ZaAccount.A_zimbraForeignPrincipal]=new Array();
this[ZaAccount.A2_memberOf]={
directMemberList:[],indirectMemberList:[],nonMemberList:[]};
this[ZaAccount.A2_directMemberList+"_more"]=0;
this[ZaAccount.A2_indirectMemberList+"_more"]=0
};
ZaItem.initMethods.ZaAccount.push(ZaAccount.initMethod);
ZaAccount.getDomain=function(e){
if(!e){
return null
}
return e.substring(e.lastIndexOf("@")+1)
};
ZaAccount.isAutoMailServer=function(){
return(this.getInstanceValue(ZaAccount.A2_autoMailServer)=="FALSE"&&!AjxUtil.isEmpty(ZaApp.getInstance().getServerListChoices().getChoices())&&!AjxUtil.isEmpty(ZaApp.getInstance().getServerListChoices().getChoices().values))
};
ZaAccount.setCosChanged=function(s,o,t){
var e=this.getInstanceValue();
if(e==s){
return
}
this.setInstanceValue(s);
if(ZaItem.ID_PATTERN.test(s)){
this._defaultValues=ZaCos.getCosById(s)
}else{
if(!AjxUtil.isEmpty(s)){
var n=ZaCos.getCosByName(s);
if(n){
this._defaultValues=n;
this.getInstance().attrs[ZaAccount.A_COSId]=n.id
}else{
this.setError(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[s]));
var o=new DwtXFormsEvent(t,this,s);
t.notifyListeners(DwtEvent.XFORMS_VALUE_ERROR,o)
}}}};
ZaAccount.setDomainChanged=function(m,y,t){
try{
var v=t.getInstance();
var h=ZaAccount.getDomain(v[ZaAccount.A_name]);
this.setInstanceValue(m);
var u=t.parent;
var x=ZaAccount.getDomain(m);
if(!x){
return
}
var n;
try{
n=ZaDomain.getDomainByName(x)
}
catch(w){
if(w.code==ZmCsfeException.SVC_PERM_DENIED){
t.getModel().setInstanceValue(t.getInstance(),"setAttrs",[]);
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_errorMessage,AjxMessageFormat.format(ZaMsg.CANNOT_CREATE_ACCOUNTS_IN_THIS_DOMAIN,[x]));
return
}else{
if(w.code==ZmCsfeException.NO_SUCH_DOMAIN){
return
}else{
throw (w)
}}}
if(v[ZaAccount.A2_autoCos]=="TRUE"){
ZaAccount.setDefaultCos(v)
}
if((x!=h)||(v[ZaAccount.A_name].indexOf("@")==0)){
try{
ZaItem.prototype.loadNewObjectDefaults.call(v,"name",x)
}
catch(w){
if(w.code==ZmCsfeException.NO_SUCH_DOMAIN){
return m
}else{
throw (w)
}}
if(v.getAttrs[ZaAccount.A_zimbraAvailableSkin]||v.getAttrs.all){
var k=ZaApp.getInstance().getInstalledSkins();
if(AjxUtil.isEmpty(k)){
if(n&&n.attrs&&!AjxUtil.isEmpty(n.attrs[ZaDomain.A_zimbraAvailableSkin])){
k=n.attrs[ZaDomain.A_zimbraAvailableSkin]
}else{
if(v._defaultValues&&v._defaultValues.attrs&&!AjxUtil.isEmpty(v._defaultValues.attrs[ZaAccount.A_zimbraAvailableSkin])){
k=v._defaultValues.attrs[ZaAccount.A_zimbraAvailableSkin]
}else{
k=[]
}}}else{
if(AjxUtil.isString(k)){
k=[k]
}}
var s=ZaApp.getInstance().getSkinChoices(k);
if(ZaNewAccountXWizard.themeChoices){
ZaNewAccountXWizard.themeChoices.setChoices(s);
ZaNewAccountXWizard.themeChoices.dirtyChoices()
}
if(ZaAccountXFormView.themeChoices){
ZaAccountXFormView.themeChoices.setChoices(s);
ZaAccountXFormView.themeChoices.dirtyChoices()
}}
if(v.getAttrs[ZaAccount.A_zimbraZimletAvailableZimlets]||v.getAttrs.all){
var r=ZaZimlet.getAll("extension");
if(!AjxUtil.isEmpty(r)&&r instanceof ZaItemList||r instanceof AjxVector){
r=r.getArray()
}
if(AjxUtil.isEmpty(r)){
if(n&&n.attrs&&!AjxUtil.isEmpty(n.attrs[ZaDomain.A_zimbraZimletDomainAvailableZimlets])){
r=n.attrs[ZaDomain.A_zimbraZimletDomainAvailableZimlets]
}else{
if(v._defaultValues&&v._defaultValues.attrs&&!AjxUtil.isEmpty(v._defaultValues.attrs[ZaAccount.A_zimbraZimletAvailableZimlets])){
r=v._defaultValues.attrs[ZaAccount.A_zimbraZimletAvailableZimlets]
}else{
r=[]
}}
if(ZaNewAccountXWizard.zimletChoices){
ZaNewAccountXWizard.zimletChoices.setChoices(r);
ZaNewAccountXWizard.zimletChoices.dirtyChoices()
}
if(ZaAccountXFormView.zimletChoices){
ZaAccountXFormView.zimletChoices.setChoices(r);
ZaAccountXFormView.zimletChoices.dirtyChoices()
}}else{
var g=r.length;
var d=[];
for(var b=0;
b<g;
b++){
var f=r[b];
d.push(f.name)
}
if(ZaNewAccountXWizard.zimletChoices){
ZaNewAccountXWizard.zimletChoices.setChoices(d);
ZaNewAccountXWizard.zimletChoices.dirtyChoices()
}
if(ZaAccountXFormView.zimletChoices){
ZaAccountXFormView.zimletChoices.setChoices(d);
ZaAccountXFormView.zimletChoices.dirtyChoices()
}}}
ZaAccount.setDefaultCos(v);
v[ZaAccount.A2_autoCos]="TRUE";
t.refresh()
}
if(h!=x){
if(n&&n.attrs){
var e=n.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts];
if(e&&e.length>0){
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_errorMessage,"");
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_accountTypes,n.getAccountTypes());
t.parent.updateAccountType()
}}}
if(n&&n.attrs){
var c=n.attrs[ZaDomain.A_domainMaxAccounts];
var e=n.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts];
if(c){
c=parseInt(c)
}
if(c&&c>0){
var l=n.getUsedDomainAccounts(x);
if(c<l&&(!e||e.length<=0)){
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_accountTypes,null);
var o;
if(l-c>1){
o=AjxMessageFormat.format(ZaMsg.NAD_DomainAccountLimits_p,[x,l-c])
}else{
o=AjxMessageFormat.format(ZaMsg.NAD_DomainAccountLimits_s,[x,l-c])
}
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_domainLeftAccounts,o)
}else{
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_domainLeftAccounts,null)
}}else{
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_domainLeftAccounts,null)
}}
if(n&&n.attrs&&n.attrs[ZaDomain.A_AuthMech]&&(n.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra)){
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_isExternalAuth,true)
}else{
t.getModel().setInstanceValue(t.getInstance(),ZaAccount.A2_isExternalAuth,false)
}
if(t.parent.setDirty){
t.parent.setDirty(true)
}}
catch(w){
ZaApp.getInstance().getCurrentController()._handleException(w,"ZaAccount.setDomainChanged",null,false)
}};
ZaAccount.generateDisplayName=function(e,r,o,l){
var t=this.getInstanceValue(ZaAccount.A_displayname);
var s="";
var n=r,h=o;
if(ZaZimbraAdmin.isLanguage("ja")){
n=o;
h=r
}
if(n){
s=n
}else{
s=""
}
if(l){
s+=" ";
s+=l;
s+="."
}
if(h){
if(s.length>0){
s+=" "
}
s+=h
}
if(s==t){
return false
}else{
this.getModel().setInstanceValue(e,ZaAccount.A_displayname,s);
return true
}};
ZaAccount.setDefaultCos=function(e){
var t=ZaCos.getDefaultCos4Account(e[ZaAccount.A_name],e.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE");
if(t&&t.id){
e._defaultValues=t;
e.attrs[ZaAccount.A_COSId]=t.id
}};
ZaAccount.prototype.getCurrentCos=function(){
try{
var e=this.attrs[ZaAccount.A_COSId];
var t;
t=ZaCos.getCosById(this.attrs[ZaAccount.A_COSId]);
if(!t){
t=ZaCos.getDefaultCos4Account(this.name,this.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE")
}
return t
}
catch(o){
ZaApp.getInstance().getCurrentController()._handleException(o,"ZaAccount.prototype.getCurrentCos",null,false)
}};
ZaAccount.getLastLoginTime=function(e){
if(e){
return ZaItem.formatServerTime(e)
}else{
return ZaMsg.Last_Login_Never
}};
ZaAccount.prototype.manageSpecialAttrs=function(){
var n="";
var h=this.attrs[ZaAccount.A_zimbraPrefTimeZoneId];
if(h){
var t=ZaModel.setUnrecoganizedChoiceValue(h,ZaSettings.timeZoneChoices);
if(h!=t){
this.attrs[ZaAccount.A_zimbraPrefTimeZoneId]=t;
n+=AjxMessageFormat.format(ZaMsg.WARNING_TIME_ZONE_INVALID,[h,'account - "'+this.name+'"'])
}}
var o=this.attrs[ZaAccount.A_zimbraPrefMailDefaultCharset];
if(o){
var s=ZaModel.setUnrecoganizedChoiceValue(o,ZaSettings.mailCharsetChoices);
if(o!=s){
this.attrs[ZaAccount.A_zimbraPrefMailDefaultCharset]=s;
n+=AjxMessageFormat.format(ZaMsg.WARNING_CHARSET_INVALID,[o,'account - "'+this.name+'"'])
}}
var r=this.attrs[ZaCos.A_zimbraPrefLocale];
if(r){
var e=ZaModel.setUnrecoganizedChoiceValue(r,ZaSettings.getLocaleChoices());
if(r!=e){
this.attrs[ZaCos.A_zimbraPrefLocale]=e;
n+=AjxMessageFormat.format(ZaMsg.WARNING_LOCALE_INVALID,[r,'account - "'+this.name+'"'])
}}
if(n&&n.length>0){
ZaApp.getInstance().getCurrentController().popupMsgDialog(n,true)
}};
ZaAccount.isAdminAccount=function(){
try{
return(this.getInstanceValue(ZaAccount.A_zimbraIsAdminAccount)=="TRUE"||this.getInstanceValue(ZaAccount.A_zimbraIsDelegatedAdminAccount)=="TRUE")
}
catch(e){
return false
}};
ZaAccount.isEmailRetentionPolicyEnabled=function(){
try{
var e=this.getInstance();
var s=ZaApp.getInstance().getGlobalConfig();
var r=ZaApp.getInstance().getServerByName(e.attrs[ZaAccount.A_mailHost]);
var t=r.attrs[ZaServer.A_zimbraMailPurgeSleepInterval];
var n=s.attrs[ZaGlobalConfig.A_zimbraMailPurgeSleepInterval];
if(t===_UNDEFINED_||t===null){
if(window.console&&window.console.log){
console.log("server setting A_zimbraMailPurgeSleepInterval is NOT set.")
}
if(n!=null&&ZaUtil.getLifeTimeInSeconds(n)==0){
return false
}}else{
if(ZaUtil.getLifeTimeInSeconds(t)==0){
return false
}}
return true
}
catch(o){
return true
}};
ZaAccount.isEmailRetentionPolicyDisabled=function(){
return !ZaAccount.isEmailRetentionPolicyEnabled.call(this)
};
ZaAccount.isShowAccountType=function(){
var r=this.getForm();
var t=r.getInstance();
var l=t[ZaAccount.A2_accountTypes];
var o=false;
for(var s=0;
s<l.length&&!o;
s++){
var n=ZaAccount.getDomain(t.name);
var e=ZaDomain.getDomainByName(n,r.parent._app);
var h=ZaCos.getCosById(l[s],ZaApp.getInstance());
if(h==null){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_ACCOUNT_TYPE,[l[s]]));
return o
}
if(e.isCosLimitInDomain(h.name)){
o=true
}}
return o
};
ZaAccount.getAccountTypeOutput=function(s){
var o=this.getForm();
var u=o.getInstance();
var p=u[ZaAccount.A2_accountTypes];
var r=[];
if(p&&p.length>0){
var c=u[ZaAccount.A2_currentAccountType];
var l=ZaCos.getDefaultCos4Account(u[ZaAccount.A_name],u.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE");
if(!c&&l){
c=l.id
}
var n=ZaAccount.getDomain(u.name);
var f=ZaDomain.getDomainByName(n,o.parent._app);
var y=true;
r.push("<table with=100%>");
r.push("<colgroup><col width='200px' /><col width='200px' /><col width='200px' /></colgroup> ");
r.push("<tbody>");
var g="account_type_radio_group_"+Dwt.getNextId();
f.updateUsedAccounts();
for(var h=0;
h<p.length;
h++){
var m=ZaCos.getCosById(p[h],ZaApp.getInstance());
var t=false;
if(m==null){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_ACCOUNT_TYPE,[p[h]]));
return
}
var d=m.attrs[ZaCos.A_description];
if(!d||d.length<1){
d=m.name
}
if(h%3==0){
r.push("<tr>")
}
r.push("<td>");
var e=f.getUsedAccounts(m.name);
var b=f.getAvailableAccounts(m.name);
var s=false;
if(o&&o.parent&&o.parent instanceof ZaNewAccountXWizard){
s=true
}
if(b>0){
y=false
}else{
if(c==p[h]){
y=false
}}
if(c==p[h]){
t=true;
if(c!=u.attrs[ZaAccount.A_COSId]){
u.autoCos="FALSE";
u.attrs[ZaAccount.A_COSId]=c;
if(s){
o.parent.updateCosGrouper()
}}}
r.push("<div><label style='font-weight: bold;"+((b>0||(c==p[h]&&!s))?"":"color: #686357;")+"'>");
r.push("<input type=radio name="+g+" value="+p[h]+((b>0||(c==p[h]&&!s))?(' onclick="ZaAccount.setAccountType.call('+this.getGlobalRef()+", '"+p[h]+"', event );\" "):(" disabled "))+((t&&(b>0||!s))?" checked ":"")+" />");
r.push(d+"</label></div>");
r.push("<div>"+AjxMessageFormat.format(ZaMsg.AccountsAvailable,[e,b])+"</div> ");
r.push("</td>");
if((h%3==2)||(h+1==p.length)){
r.push("</tr>")
}}
r.push("</tbody></table>");
if(y){
o.getModel().setInstanceValue(o.getInstance(),ZaAccount.A2_showAccountTypeMsg,AjxMessageFormat.format(ZaMsg.MSG_AccountTypeUnavailable,[l.name]))
}else{
o.getModel().setInstanceValue(o.getInstance(),ZaAccount.A2_showAccountTypeMsg,null)
}}
return r.join("")
};
ZaAccount.setAccountType=function(o,s){
var n=this.getForm();
var e=n.getInstance();
var t=ZaCos.getCosById(o);
if(t.id!=e.attrs[ZaAccount.A_COSId]){
if(e.cos){
e._defaultValues=t
}
e.autoCos="FALSE";
e.attrs[ZaAccount.A_COSId]=t.id;
n.parent._isCosChanged=true;
n.itemChanged(this,o,s);
if(n.parent.setDirty){
n.parent.setDirty(true)
}
n.parent.updateCosGrouper()
}};
ZaAccount.isAccountTypeSet=function(n){
var e=n.attrs[ZaAccount.A_COSId]||n[ZaAccount.A2_currentAccountType];
var o=ZaCos.getDefaultCos4Account(n[ZaAccount.A_name],n.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE");
if(!n.accountTypes||n.accountTypes.length<=0){
return true
}else{
if(!e){
return false
}}
if(e==o.id){
return true
}
for(var t=0;
t<n.accountTypes.length;
t++){
if(e==n.accountTypes[t]){
return true
}}
return false
};
ZaAccount.getCatchAllDomain=function(e){
return"@"+e
};
ZaAccount.getCatchAllAccount=function(t){
var s={
limit:1,type:[ZaSearch.ACCOUNTS],domain:t,applyCos:0,attrs:[ZaAccount.A_zimbraMailCatchAllAddress],query:(["(",ZaAccount.A_zimbraMailCatchAllAddress,"=",ZaAccount.getCatchAllDomain(t),")"].join(""))};
var n=ZaSearch.searchDirectory(s).Body.SearchDirectoryResponse;
var o=new ZaItemList(ZaAccount);
o.loadFromJS(n);
var e=o.getArray();
if(!AjxUtil.isEmpty(e)){
if(e[0]){
return e[0]
}}
return new ZaAccount(ZaApp.getInstance())
};
ZaAccount.modifyCatchAll=function(h,e){
if(h==null|h.length<=0){
return
}
var o=AjxSoapDoc.create("ModifyAccountRequest","urn:zimbraAdmin",null);
o.set("id",h);
var n="";
if(e==null||e.length==0){
n=""
}else{
if(e.indexOf("@")==-1){
n=ZaAccount.getCatchAllDomain(e)
}else{
if(e.indexOf("@")!=0){
n=e.substring(e.lastIndexOf("@"))
}else{
n=e
}}}
var t=o.set("a",n);
t.setAttribute("n",ZaAccount.A_zimbraMailCatchAllAddress);
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=o;
s.noAuthToken=true;
r.invoke(s)
};
ZaAccount.getRelatedList=function(t){
var s=this.attrs[ZaAccount.A_zimbraMailAlias];
var u=ZaCos.getCosById(this.attrs[ZaAccount.A_COSId])||ZaCos.getDefaultCos4Account(this[ZaAccount.A_name],this.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE");
var o=ZaAccount.getDomain(this[ZaAccount.A_name]);
var m=ZaDomain.getDomainByName(o);
var d=[];
if(s.length>0){
var r=new ZaTreeItemData({
text:ZaMsg.TABT_Aliases,count:s.length,image:"AccountAlias",mappingId:ZaZimbraAdmin._ACCOUNT_ALIAS_LIST_VIEW,path:t+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.TABT_Aliases}
);
r.setData("aliasTargetId",this.id);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._ACCOUNT_ALIAS_LIST_VIEW]=ZaOverviewPanelController.aliasListTreeListener;
d.push(r)
}
var e=this[ZaAccount.A2_memberOf];
if(e!=null){
var h=e[ZaAccount.A2_directMemberList];
var c=e[ZaAccount.A2_indirectMemberList];
if((h.length+c.length)>0){
var n=new ZaTreeItemData({
text:ZaMsg.OVP_distributionLists,count:h.length+c.length,image:"DistributionList",mappingId:ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW,path:t+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.OVP_distributionLists}
);
n.setData(ZaAccount.A2_memberOf,e);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW]=ZaOverviewPanelController.dlListTreeListener;
d.push(n)
}}
var l=new ZaTreeItemData({
text:u.name,image:"COS",forceNode:true,mappingId:ZaZimbraAdmin._COS_VIEW,path:t+ZaTree.SEPERATOR+u.name}
);
l.setData(ZaOverviewPanelController._OBJ_ID,u.id);
l.setData("skipHistory","TRUE");
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._COS_VIEW]=ZaOverviewPanelController.cosTreeListener;
d.push(l);
var f=new ZaTreeItemData({
text:o,image:"Domain",forceNode:true,mappingId:ZaZimbraAdmin._DOMAIN_VIEW,path:t+ZaTree.SEPERATOR+o}
);
f.setData(ZaOverviewPanelController._OBJ_ID,m.id);
f.setData("skipHistory","TRUE");
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DOMAIN_VIEW]=ZaOverviewPanelController.domainTreeListener;
d.push(f);
return d
};
ZaItem.getRelatedMethods.ZaAccount.push(ZaAccount.getRelatedList);
ZaAccount.prototype._handleAccountMembershipResponse=function(e){
var s=e.getResponse().Body;
if(!s){
return
}
var n=s.GetAccountMembershipResponse;
if(!n){
return
}
this[ZaAccount.A2_memberOf]=ZaAccountMemberOfListView.parseGetAccMembershipResponse(n);
this[ZaAccount.A2_directMemberList+"_more"]=(this[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList].length>ZaAccountMemberOfListView.SEARCH_LIMIT)?1:0;
this[ZaAccount.A2_indirectMemberList+"_more"]=(this[ZaAccount.A2_memberOf][ZaAccount.A2_indirectMemberList].length>ZaAccountMemberOfListView.SEARCH_LIMIT)?1:0;
var o=ZaApp.getInstance().getCurrentController();
if(!o||o._currentObject!==this){
return
}
var t=o._view;
if(t){
var r=t.getMyForm();
if(r){
r.setInstanceValue(ZaAccountMemberOfListView.cloneMemberOf(this),ZaAccount.A2_memberOf);
r.setInstanceValue(this[ZaAccount.A2_directMemberList+"_more"],ZaAccount.A2_directMemberList+"_more");
r.setInstanceValue(this[ZaAccount.A2_indirectMemberList+"_more"],ZaAccount.A2_indirectMemberList+"_more");
r.setInstanceValue(true,"memberOfLoaded");
r.setInstance(r.getInstance())
}}}
}
if(AjxPackage.define("zimbraAdmin.dl.model.ZaDistributionList")){
ZaDistributionList=function(s,e,n,o,t){
ZaItem.call(this,"ZaDistributionList");
this._init();
this.attrs=new Object();
this.attrs[ZaAccount.A_zimbraMailAlias]=[];
this.id=(s!=null)?s:null;
this.type=ZaItem.DL;
this.name=(e!=null)?e:null;
this._selfMember=new ZaDistributionListMember(this.name);
if(o!=null){
this.attrs.description=o
}
if(t!=null){
this.attrs.zimbraNotes=t
}
this.attrs[ZaDistributionList.A_zimbraIsACLGroup]="TRUE";
this[ZaDistributionList.A2_dlType]=ZaDistributionList.STATIC_DL_TYPE;
this[ZaDistributionList.A2_numMembers]=0;
this[ZaDistributionList.A2_memberList]=(n!=null)?n:new Array();
this[ZaDistributionList.A2_memberPool]=new Array();
this[ZaAccount.A2_autoMailServer]="TRUE";
this[ZaAccount.A2_memberOf]={
directMemberList:[],indirectMemberList:[],nonMemberList:[]};
this[ZaAccount.A2_directMemberList+"_more"]=0;
this[ZaAccount.A2_indirectMemberList+"_more"]=0;
this[ZaDistributionList.A2_DLOwners]=new Array()
};
ZaDistributionList.prototype=new ZaItem;
ZaDistributionList.prototype.constructor=ZaDistributionList;
ZaItem.modifyMethods.ZaDistributionList=new Array();
ZaItem.loadMethods.ZaDistributionList=new Array();
ZaItem.initMethods.ZaDistributionList=new Array();
ZaItem.createMethods.ZaDistributionList=new Array();
ZaItem.ObjectModifiers.ZaDistributionList=new Array();
ZaItem.getRelatedMethods.ZaDistributionList=new Array();
ZaDistributionList.EMAIL_ADDRESS="ZDLEA";
ZaDistributionList.DESCRIPTION="ZDLDESC";
ZaDistributionList.ID="ZDLID";
ZaDistributionList.MEMBER_QUERY_LIMIT=25;
ZaDistributionList.MEMBER_LIST_PAGE_SIZE=15;
ZaDistributionList.MEMBER_POOL_PAGE_SIZE=15;
ZaDistributionList.A_zimbraGroupId="zimbraGroupId";
ZaDistributionList.A_zimbraCreateTimestamp="zimbraCreateTimestamp";
ZaDistributionList.A_mailStatus="zimbraMailStatus";
ZaDistributionList.A2_dlType="dlType";
ZaDistributionList.A_memberOfURL="memberURL";
ZaDistributionList.A_zimbraIsACLGroup="zimbraIsACLGroup";
ZaDistributionList.A2_members="members";
ZaDistributionList.A2_allMemberHash="allMemberHash";
ZaDistributionList.A2_allMemberPages="allMemberPages";
ZaDistributionList.A2_allMemberHash="allMemberHash";
ZaDistributionList.A2_memberList="memberList";
ZaDistributionList.A2_origList="origList";
ZaDistributionList.A2_addList="addList";
ZaDistributionList.A2_removeList="removeList";
ZaDistributionList.A2_query="query";
ZaDistributionList.A2_pagenum="pagenum";
ZaDistributionList.A2_poolPagenum="poolPagenum";
ZaDistributionList.A2_poolNumPages="poolNumPages";
ZaDistributionList.A2_totalNumInPool="totalNumInPool";
ZaDistributionList.A2_numMembers="numMembers";
ZaDistributionList.A2_memPagenum="memPagenum";
ZaDistributionList.A2_memNumPages="memNumPages";
ZaDistributionList.A2_memberPool="memberPool";
ZaDistributionList.A2_optionalAdd="optionalAdd";
ZaDistributionList.A2_membersSelected="membersSelected";
ZaDistributionList.A2_nonmembersSelected="nonmembersSelected";
ZaDistributionList.A2_memberPoolSelected="memberPoolSelected";
ZaDistributionList.A2_directMemberSelected="directMemberSelected";
ZaDistributionList.A2_indirectMemberSelected="indirectMemberSelected";
ZaDistributionList.A2_directMemberList="directMemberList";
ZaDistributionList.A2_indirectMemberList="indirectMemberList";
ZaDistributionList.A2_nonMemberList="nonMemberList";
ZaDistributionList.A2_alias_selection_cache="alias_selection_cache";
ZaDistributionList.A_isAdminGroup="zimbraIsAdminGroup";
ZaDistributionList.A_zimbraPrefReplyToAddress="zimbraPrefReplyToAddress";
ZaDistributionList.A_zimbraPrefReplyToDisplay="zimbraPrefReplyToDisplay";
ZaDistributionList.A_zimbraPrefReplyToEnabled="zimbraPrefReplyToEnabled";
ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy="zimbraDistributionListSubscriptionPolicy";
ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy="zimbraDistributionListUnsubscriptionPolicy";
ZaDistributionList.A_zimbraDistributionListSendShareMessageToNewMembers="zimbraDistributionListSendShareMessageToNewMembers";
ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept="ACCEPT";
ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject="REJECT";
ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval="APPROVAL";
ZaDistributionList.A2_DLOwners="DLOwner";
ZaDistributionList.A2_owners_selection_cache="owners_selection_cache";
ZaDistributionList.getDLStatus=function(e){
if(e=="enabled"){
return ZaMsg.DL_Status_enabled
}else{
if(e=="disabled"){
return ZaMsg.DL_Status_disabled
}else{
return ZaMsg.ERROR_UNKNOWN
}}};
ZaDistributionList.RENAME_DL_RIGHT="renameDistributionList";
ZaDistributionList.ADD_DL_ALIAS_RIGHT="addDistributionListAlias";
ZaDistributionList.REMOVE_DL_ALIAS_RIGHT="removeDistributionListAlias";
ZaDistributionList.REMOVE_DL_MEMBER_RIGHT="removeDistributionListMember";
ZaDistributionList.ADD_DL_MEMBER_RIGHT="addDistributionListMember";
ZaDistributionList.GET_DL_MEMBERSHIP_RIGHT="getDistributionListMembership";
ZaDistributionList.GET_DL_SHARE_INFO_RIGHT="getDistributionListShareInfo";
ZaDistributionList.RIGHT_VIEW_ADMINUI_COMPONENTS="viewDistributionListAdminUI";
ZaDistributionList.searchAttributes=AjxBuffer.concat(ZaAccount.A_displayname,",",ZaItem.A_zimbraId,",",ZaAccount.A_mailHost,",",ZaAccount.A_uid,",",ZaAccount.A_description,",",ZaDistributionList.A_isAdminGroup,",",ZaDistributionList.A_mailStatus);
ZaDistributionList.DYNAMIC_DL_TYPE="1";
ZaDistributionList.STATIC_DL_TYPE="0";
ZaDistributionList.postLoadDataFunction=new Array();
ZaDistributionList.prototype.remove=function(o){
var e=AjxSoapDoc.create("DeleteDistributionListRequest",ZaZimbraAdmin.URN,null);
e.set("id",this.id);
this.deleteCommand=new ZmCsfeCommand();
var t=new Object();
t.soapDoc=e;
t.noAuthToken=true;
if(o){
t.asyncMode=true;
t.callback=o
}
this.deleteCommand.invoke(t)
};
ZaDistributionList.prototype.rename=function(e){
var o=AjxSoapDoc.create("RenameDistributionListRequest",ZaZimbraAdmin.URN,null);
o.set("id",this.id);
o.set("newName",e);
var s=new Object();
s.soapDoc=o;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_RENAME_DL};
var n=ZaRequestMgr.invoke(s,t).Body.RenameDistributionListResponse;
this.initFromJS(n.dl[0])
};
ZaDistributionList.createMethod=function(s,h){
s.attrs[ZaAccount.A_mail]=s.name;
var r;
var u=AjxSoapDoc.create("CreateDistributionListRequest",ZaZimbraAdmin.URN,null);
u.set(ZaAccount.A_name,s.name);
if(s[ZaDistributionList.A2_dlType]==ZaDistributionList.DYNAMIC_DL_TYPE){
u.setMethodAttribute("dynamic",ZaDistributionList.DYNAMIC_DL_TYPE)
}
if(s[ZaAccount.A2_autoMailServer]=="TRUE"){
s.attrs[ZaAccount.A_mailHost]=null
}
if(s[ZaAccount.A2_autoCos]=="TRUE"){
s.attrs[ZaAccount.A_COSId]=null
}
for(var d in s.attrs){
if(d==ZaAccount.A_zimbraMailAlias||d==ZaItem.A_objectClass||d==ZaAccount.A2_mbxsize||d==ZaAccount.A_mail){
continue
}
if(s[ZaDistributionList.A2_dlType]!=ZaDistributionList.DYNAMIC_DL_TYPE&&d==ZaDistributionList.A_zimbraIsACLGroup){
continue
}
if(s.attrs[d] instanceof Array){
var t=s.attrs[d].length;
if(t){
for(var o=0;
o<t;
o++){
if(typeof(s.attrs[d][o])=="object"){
var l=u.set("a",s.attrs[d][o].toString());
l.setAttribute("n",d)
}else{
var l=u.set("a",s.attrs[d][o]);
l.setAttribute("n",d)
}}}}else{
if(s.attrs[d] instanceof AjxVector){
var m=s.attrs[d].getArray();
var t=m.length;
if(t){
for(var o=0;
o<t;
o++){
if(m[o]!=null){
if(typeof(m[o])=="object"){
var l=u.set("a",m[o].toString());
l.setAttribute("n",d)
}else{
var l=u.set("a",m[o]);
l.setAttribute("n",d)
}}}}}else{
if(s.attrs[d]!=null){
if(typeof(s.attrs[d])=="object"){
var l=u.set("a",s.attrs[d].toString());
l.setAttribute("n",d)
}else{
var l=u.set("a",s.attrs[d]);
l.setAttribute("n",d)
}}}}}
try{
var n=new Object();
n.soapDoc=u;
var e={};
e.controller=ZaApp.getInstance().getCurrentController();
e.busyMsg=ZaMsg.BUSY_CREATE_ACCOUNTS;
r=ZaRequestMgr.invoke(n,e).Body.CreateDistributionListResponse
}
catch(c){
throw c;
return null
}
h.initFromJS(r.dl[0]);
s.rights=h.rights;
s.setAttrs=h.setAttrs;
s.getAttrs=h.getAttrs;
s.id=h.id;
s.attrs[ZaItem.A_zimbraId]=h.attrs[ZaItem.A_zimbraId]
};
ZaItem.createMethods.ZaDistributionList.push(ZaDistributionList.createMethod);
ZaDistributionList.modifyMethod=function(d,s){
var l=false;
var h=AjxSoapDoc.create("ModifyDistributionListRequest",ZaZimbraAdmin.URN,null);
h.set("id",this.id);
for(var c in s.attrs){
if(c==ZaItem.A_objectClass||c==ZaAccount.A_mail||c==ZaItem.A_zimbraId||c==ZaAccount.A_zimbraMailAlias||c==ZaItem.A_zimbraACE){
continue
}
if((this.attrs[c]!=s.attrs[c])&&!(this.attrs[c]==undefined&&s.attrs[c]==="")){
if(c==ZaAccount.A_uid){
continue
}
if(!ZaItem.hasWritePermission(c,s)){
continue
}
l=true;
if(s.attrs[c] instanceof Array){
if(!this.attrs[c]){
this.attrs[c]=[]
}else{
if(!(this.attrs[c] instanceof Array)){
this.attrs[c]=[this.attrs[c]]
}}
if(s.attrs[c].join(",").valueOf()!=this.attrs[c].join(",").valueOf()){
var t=s.attrs[c].length;
if(t){
for(var o=0;
o<t;
o++){
var r=null;
if(s.attrs[c][o] instanceof String){
var r=h.set("a",s.attrs[c][o].toString())
}else{
if(s.attrs[c][o] instanceof Object){
var r=h.set("a",s.attrs[c][o].toString())
}else{
if(s.attrs[c][o]){
var r=h.set("a",s.attrs[c][o])
}}}
if(r){
r.setAttribute("n",c)
}}}else{
var r=h.set("a","");
r.setAttribute("n",c)
}}}else{
var r=h.set("a",s.attrs[c]);
r.setAttribute("n",c)
}}}
if(!l){
return
}
var n=new Object();
n.soapDoc=h;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_DL};
resp=ZaRequestMgr.invoke(n,e).Body.ModifyDistributionListResponse;
this.initFromJS(resp.dl[0]);
this._toolTip=null;
return
};
ZaItem.modifyMethods.ZaDistributionList.push(ZaDistributionList.modifyMethod);
ZaDistributionList.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;'>";
t[e++]="<table style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
if(this.attrs[ZaDistributionList.A_isAdminGroup]=="TRUE"){
t[e++]=AjxImg.getImageHtml("DistributionListGroup")
}else{
t[e++]=AjxImg.getImageHtml("DistributionList")
}
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
e=this._addAttrRow(ZaItem.A_description,t,e);
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaDistributionList.addRemoveAliases=function(f,s){
var m=-1;
var r=-1;
if(ZaItem.hasRight(ZaDistributionList.REMOVE_DL_ALIAS_RIGHT,this)||ZaItem.hasRight(ZaDistributionList.ADD_DL_ALIAS_RIGHT,this)){
if(s.attrs[ZaAccount.A_zimbraMailAlias]){
if(typeof s.attrs[ZaAccount.A_zimbraMailAlias]=="string"){
var l=s.attrs[ZaAccount.A_zimbraMailAlias];
s.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
s.attrs[ZaAccount.A_zimbraMailAlias].push(l)
}
m=s.attrs[ZaAccount.A_zimbraMailAlias].length-1
}
if(this.attrs[ZaAccount.A_zimbraMailAlias]){
if(typeof this.attrs[ZaAccount.A_zimbraMailAlias]=="string"){
var l=this.attrs[ZaAccount.A_zimbraMailAlias];
this.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
this.attrs[ZaAccount.A_zimbraMailAlias].push(l)
}
r=this.attrs[ZaAccount.A_zimbraMailAlias].length-1
}
for(var e=m;
e>=0;
e--){
for(var u=r;
u>=0;
u--){
if(s.attrs[ZaAccount.A_zimbraMailAlias][e]==this.attrs[ZaAccount.A_zimbraMailAlias][u]){
s.attrs[ZaAccount.A_zimbraMailAlias].splice(e,1);
this.attrs[ZaAccount.A_zimbraMailAlias].splice(u,1);
break
}}}
if(r!=-1){
r=this.attrs[ZaAccount.A_zimbraMailAlias].length
}
if(ZaItem.hasRight(ZaDistributionList.REMOVE_DL_ALIAS_RIGHT,this)){
try{
for(var o=0;
o<r;
o++){
this.removeAlias(this.attrs[ZaAccount.A_zimbraMailAlias][o])
}}
catch(d){
ZaApp.getInstance().getCurrentController()._handleException(d,"ZaDistributionList.addRemoveAliases",null,false);
return false
}}
if(m!=-1){
m=s.attrs[ZaAccount.A_zimbraMailAlias].length
}
var n="";
var t=0;
if(ZaItem.hasRight(ZaDistributionList.ADD_DL_ALIAS_RIGHT,this)){
try{
for(var o=0;
o<m;
o++){
var c=s.attrs[ZaAccount.A_zimbraMailAlias][o];
try{
if(c){
if(c.indexOf("@")!=c.lastIndexOf("@")){
ZaApp.getInstance().getCurrentController()._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_ALIAS_INVALID,[c]),null,DwtMessageDialog.CRITICAL_STYLE,null);
ZaApp.getInstance().getCurrentController()._errorDialog.popup();
break
}
this.addAlias(c)
}}
catch(d){
if((d.code==ZmCsfeException.ACCT_EXISTS)&&c){
var h=ZaXFormViewController.prototype._findAlias.call(this,c);
switch(h.type){
case ZaItem.DL:if(h.name==c){
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS3,[h.name])
}else{
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS4,[h.name,c])
}
break;
case ZaItem.ACCOUNT:if(h.name==c){
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS2,[h.name])
}else{
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS1,[h.name,c])
}
break;
case ZaItem.RESOURCE:if(h.name==c){
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS5,[h.name])
}else{
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS6,[h.name,c])
}
break;
default:n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS0,[c]);
break
}
t++
}else{
throw (d)
}}}
if(t==1){
ZaApp.getInstance().getCurrentController()._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.WARNING_ALIAS_EXISTS,[n]),"",DwtMessageDialog.WARNING_STYLE,ZabMsg.zimbraAdminTitle);
ZaApp.getInstance().getCurrentController()._errorDialog.popup()
}else{
if(t>1){
ZaApp.getInstance().getCurrentController()._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.WARNING_ALIASES_EXIST,[n]),"",DwtMessageDialog.WARNING_STYLE,ZabMsg.zimbraAdminTitle);
ZaApp.getInstance().getCurrentController()._errorDialog.popup()
}}}
catch(d){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.FAILED_ADD_ALIASES,d);
return false
}}}};
ZaItem.modifyMethods.ZaDistributionList.push(ZaDistributionList.addRemoveAliases);
ZaDistributionList.addAliases=function(o,s){
if(ZaItem.hasRight(ZaDistributionList.ADD_DL_ALIAS_RIGHT,s)){
if(o.attrs[ZaAccount.A_zimbraMailAlias]){
if(typeof o.attrs[ZaAccount.A_zimbraMailAlias]=="string"){
var h=o.attrs[ZaAccount.A_zimbraMailAlias];
o.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
o.attrs[ZaAccount.A_zimbraMailAlias].push(h)
}
tmpObjCnt=o.attrs[ZaAccount.A_zimbraMailAlias].length
}
var n="";
var e=0;
try{
for(var t=0;
t<tmpObjCnt;
t++){
var c=o.attrs[ZaAccount.A_zimbraMailAlias][t];
try{
if(c){
if(c.indexOf("@")!=c.lastIndexOf("@")){
ZaApp.getInstance().getCurrentController()._errorDialog.setMessage(AjxMessageFormat.format(ZaMsg.ERROR_ALIAS_INVALID,[c]),null,DwtMessageDialog.CRITICAL_STYLE,null);
ZaApp.getInstance().getCurrentController()._errorDialog.popup();
break
}
s.addAlias(c)
}}
catch(l){
if((l.code==ZmCsfeException.ACCT_EXISTS)&&c){
var r=ZaXFormViewController.prototype._findAlias.call(this,c);
switch(r.type){
case ZaItem.DL:if(r.name==c){
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS3,[r.name])
}else{
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS4,[r.name,c])
}
break;
case ZaItem.ACCOUNT:if(r.name==c){
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS2,[r.name])
}else{
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS1,[r.name,c])
}
break;
case ZaItem.RESOURCE:if(r.name==c){
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS5,[r.name])
}else{
n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS6,[r.name,c])
}
break;
default:n+="<br>"+AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS0,[c]);
break
}
e++
}else{
throw (l)
}}}
if(e==1){
ZaApp.getInstance().getCurrentController()._errorDialog.setMessage(ZaMsg.WARNING_ALIAS_EXISTS+n,"",DwtMessageDialog.WARNING_STYLE,ZabMsg.zimbraAdminTitle);
ZaApp.getInstance().getCurrentController()._errorDialog.popup()
}else{
if(e>1){
ZaApp.getInstance().getCurrentController()._errorDialog.setMessage(ZaMsg.WARNING_ALIASES_EXIST+n,"",DwtMessageDialog.WARNING_STYLE,ZabMsg.zimbraAdminTitle);
ZaApp.getInstance().getCurrentController()._errorDialog.popup()
}}}
catch(l){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.FAILED_ADD_ALIASES,l);
return false
}}};
ZaItem.createMethods.ZaDistributionList.push(ZaDistributionList.addAliases);
ZaDistributionList.addRemoveOwners=function(d,o){
var c=-1;
var n=-1;
var s=true;
if(s){
if(o[ZaDistributionList.A2_DLOwners]){
if(!(o[ZaDistributionList.A2_DLOwners] instanceof Array)){
var r=o[ZaDistributionList.A2_DLOwners];
o[ZaDistributionList.A2_DLOwners]=new Array();
o[ZaDistributionList.A2_DLOwners].push(r)
}
c=o[ZaDistributionList.A2_DLOwners].length-1
}
if(this[ZaDistributionList.A2_DLOwners]){
if(!(this[ZaDistributionList.A2_DLOwners] instanceof Array)){
var r=this[ZaDistributionList.A2_DLOwners];
this[ZaDistributionList.A2_DLOwners]=new Array();
this[ZaDistributionList.A2_DLOwners].push(r)
}
n=this[ZaDistributionList.A2_DLOwners].length-1
}
for(var e=c;
e>=0;
e--){
for(var l=n;
l>=0;
l--){
if(o[ZaDistributionList.A2_DLOwners][e]==this[ZaDistributionList.A2_DLOwners][l]){
o[ZaDistributionList.A2_DLOwners].splice(e,1);
this[ZaDistributionList.A2_DLOwners].splice(l,1);
break
}}}
if(n!=-1){
n=this[ZaDistributionList.A2_DLOwners].length
}
try{
for(var t=0;
t<n;
t++){
this.addRemoveOwner(this[ZaDistributionList.A2_DLOwners][t])
}}
catch(h){
ZaApp.getInstance().getCurrentController()._handleException(h,"ZaDistributionList.addRemoveOwner",null,false);
return false
}
if(c!=-1){
c=o[ZaDistributionList.A2_DLOwners].length
}
try{
for(var t=0;
t<c;
t++){
try{
if(o[ZaDistributionList.A2_DLOwners][t]){
this.addRemoveOwner(o[ZaDistributionList.A2_DLOwners][t],true)
}}
catch(h){
throw (h)
}}}
catch(h){
ZaApp.getInstance().getCurrentController()._handleException(h,"ZaDistributionList.addRemoveOwner",null,false);
return false
}}};
ZaItem.modifyMethods.ZaDistributionList.push(ZaDistributionList.addRemoveOwners);
ZaDistributionList.addOwners=function(r,o){
var s=-1;
if(r[ZaDistributionList.A2_DLOwners]){
if(!(r[ZaDistributionList.A2_DLOwners] instanceof Array)){
var e=r[ZaDistributionList.A2_DLOwners];
r[ZaDistributionList.A2_DLOwners]=new Array();
r[ZaDistributionList.A2_DLOwners].push(e)
}
s=r[ZaDistributionList.A2_DLOwners].length-1
}
if(s!=-1){
s=r[ZaDistributionList.A2_DLOwners].length
}
try{
for(var t=0;
t<s;
t++){
try{
if(r[ZaDistributionList.A2_DLOwners][t]){
r.addRemoveOwner(r[ZaDistributionList.A2_DLOwners][t],true)
}}
catch(n){
throw (n)
}}}
catch(n){
ZaApp.getInstance().getCurrentController()._handleException(n,"ZaDistributionList.addOwner",null,false);
return false
}};
ZaItem.createMethods.ZaDistributionList.push(ZaDistributionList.addOwners);
ZaDistributionList.prototype.addRemoveOwner=function(d,l){
var h=AjxSoapDoc.create("DistributionListActionRequest","urn:zimbraAccount",null);
var t=h.set("dl",this.id);
t.setAttribute("by","id");
var e=h.set("action",null);
var c;
var r;
if(l){
r="addOwners";
c=ZaMsg.BUSY_ADD_DL_OWNER
}else{
r="removeOwners";
c=ZaMsg.BUSY_REMOVE_DL_OWNER
}
e.setAttribute("op",r);
var s=h.set("owner",d,e);
s.setAttribute("by","name");
s.setAttribute("type","usr");
var n=new Object();
n.soapDoc=h;
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:c};
ZaRequestMgr.invoke(n,o)
};
ZaDistributionList.checkValues=function(e){
if(ZaItem.hasWritePermission(ZaAccount.A_name,e)){
if(e.name==null||e.name.length<1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_DL_NAME_REQUIRED);
return false
}
if(!AjxUtil.isValidEmailNonReg(e.name)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_DL_NAME_INVALID);
return false
}}
return true
};
ZaDistributionList.prototype.markChanged=function(){
this._dirty=true
};
ZaDistributionList.prototype.markClean=function(){
this._dirty=false
};
ZaDistributionList.prototype.isDirty=function(){
return this._dirty
};
ZaDistributionList.prototype.getId=function(){
return this.id
};
ZaDistributionList.prototype.setId=function(e){
this.id=e
};
ZaDistributionList.prototype.getName=function(){
return this.name
};
ZaDistributionList.prototype.getMemberQueryParams=function(c,o,t,s,l){
if(o==null){
o=0
}
if(t==null){
t=ZaDistributionList.MEMBER_QUERY_LIMIT
}
var d=AjxSoapDoc.create("GetDistributionListRequest",ZaZimbraAdmin.URN,null);
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
d.setMethodAttribute("attrs",this.attrsToGet.join(","))
}
d.setMethodAttribute("limit",t);
d.setMethodAttribute("offset",o);
var r=d.set("dl",this.id);
r.setAttribute("by","id");
d.set("name",this.getName());
var n=Dwt.getNextId();
var u={
controller:s,offset:o,limit:t,busyId:n,ajxCallbackWhenCompleted:l};
var h={
soapDoc:d,noAuthToken:true,asyncMode:true};
if(c!=null){
h.callback=new AjxCallback(this,c,u)
}
var e={
controller:s,showBusy:true,busyMsg:ZaMsg.BUSY_GET_DL,busyId:n,skipCallbackIfCancelled:true};
var m={
reqCtrlParams:h,reqMgrParams:e};
return m
};
ZaDistributionList.prototype.getAllMembers=function(t){
if(AjxUtil.isEmpty(t)||AjxUtil.isEmpty(t.controller)||AjxUtil.isEmpty(t.controller._view)){
return
}
var s=t.controller,c=t.controller._view;
if(this.id!=null){
var o=0;
var n=0;
var l=ZaDistributionList.prototype.getAllMembersCallback;
this[ZaDistributionList.A2_allMemberHash]={};
try{
var h=new AjxCallback(c,ZaDLXFormView.prototype.updateMemberList);
var e=new AjxCallback(this,this.updateTree);
var d=ZaDistributionList.prototype.getMemberQueryParams.call(this,l,n,o,s,[h,e]);
ZaRequestMgr.invoke(d.reqCtrlParams,d.reqMgrParams)
}
catch(r){
ZaApp.getInstance().getCurrentController()._handleException(r,"ZaDistributionList.prototype.getAllMembers",null,false)
}}};
ZaDistributionList.prototype.updateTree=function(){
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController();
e.refreshRelatedTree(this,true,true)
};
ZaDistributionList.prototype.getAllMembersCallback=function(r,h){
try{
if(r.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,r.busyId)
}
if(!h&&!this._currentRequest.cancelled){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListViewController.prototype.getAllMembersCallback"))
}else{
if(!h.isException()){
if(!h._data||!h._data||!h._data.Body||!h._data.Body.GetDistributionListResponse){
return
}
var o=h._data.Body.GetDistributionListResponse;
if(!o.dl||!(o.dl[0])){
return
}
var y=o.dl[0];
if(y.dynamic===true){
this[ZaDistributionList.A2_dlType]=ZaDistributionList.DYNAMIC_DL_TYPE
}
var c=y.dlm;
var m=(c&&c.length)?c.length:0;
var s=this[ZaDistributionList.A2_allMemberHash];
for(var u=0;
u<m;
++u){
var e=c[u]._content;
if(!AjxUtil.isEmpty(e)){
var d=new ZaDistributionListMember(e);
s[e]=d
}}
this[ZaDistributionList.A2_numMembers]=m;
this[ZaDistributionList.A2_memNumPages]=Math.ceil(m/ZaDistributionList.MEMBER_LIST_PAGE_SIZE);
ZaDistributionList.prototype.pageAllMembers.call(this);
this.id=y.id;
this.initFromJS(y);
if(this[ZaDistributionList.A2_dlType]!==ZaDistributionList.DYNAMIC_DL_TYPE){
this[ZaAccount.A2_memberOf]=ZaAccountMemberOfListView.getDlMemberShip(this.id,"id")
}else{
this[ZaAccount.A2_memberOf]={
directMemberList:[],indirectMemberList:[],nonMemberList:[]}
}
this[ZaAccount.A2_directMemberList+"_more"]=(this[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList].length>ZaAccountMemberOfListView.SEARCH_LIMIT)?1:0;
this[ZaAccount.A2_indirectMemberList+"_more"]=(this[ZaAccount.A2_memberOf][ZaAccount.A2_indirectMemberList].length>ZaAccountMemberOfListView.SEARCH_LIMIT)?1:0;
var n=y.owners;
var l=(n&&n.length)?n.length:0;
this[ZaDistributionList.A2_DLOwners]=new Array();
if(l>0){
var p=n[0].owner;
for(var u=0;
u<p.length;
u++){
var t=new ZaDistributionListOwner(p[u]);
this[ZaDistributionList.A2_DLOwners].push(t.name)
}}
var g=r.ajxCallbackWhenCompleted||null;
if(g instanceof Array){
for(var u=0;
u<g.length;
u++){
g[u].run1([this])
}}else{
if(g instanceof AjxCallback){
g.run1([this])
}}}}}
catch(f){
ZaApp.getInstance().getCurrentController()._handleException(f,"ZaDistributionList.prototype.getAllMembersCallback",null,false)
}};
ZaDistributionList.prototype.pageAllMembers=function(){
var r=this[ZaDistributionList.A2_allMemberHash];
if(AjxUtil.isEmpty(r)){
return
}
var e=new Array();
var s=AjxUtil.getHashKeys(r);
for(var o=0;
o<s.length;
o+=ZaDistributionList.MEMBER_LIST_PAGE_SIZE){
var n=new Array();
for(var t=0;
(o+t<s.length)&&(t<ZaDistributionList.MEMBER_LIST_PAGE_SIZE);
t++){
var h=r[s[o+t]];
n.push(h)
}
e.push(n)
}
this[ZaDistributionList.A2_allMemberPages]=e
};
ZaDistributionList.removeDeletedMembers=function(m,l,c,s){
if(!ZaItem.hasRight(ZaDistributionList.REMOVE_DL_MEMBER_RIGHT,l)){
if(s&&s instanceof AjxCallback){
s.run()
}
return
}
var t,e;
var n=new ZmCsfeCommand();
t=AjxSoapDoc.create("RemoveDistributionListMemberRequest",ZaZimbraAdmin.URN,null);
t.set("id",l.id);
var u=l[ZaDistributionList.A2_removeList].length;
if(u<1){
return
}
for(var h=0;
h<u;
h++){
t.set("dlm",l[ZaDistributionList.A2_removeList][h].toString())
}
var o=new Object();
o.soapDoc=t;
o.noAuthToken=true;
if(s&&s instanceof AjxCallback){
o.asyncMode=true;
o.callback=s
}
var d=l[ZaDistributionList.A2_removeList];
l[ZaDistributionList.A2_removeList]=new Array();
n.invoke(o);
ZaDistributionList.modifyAccountDL(l,d,false)
};
ZaItem.modifyMethods.ZaDistributionList.push(ZaDistributionList.removeDeletedMembers);
ZaDistributionList.addNewMembers=function(m,l,c,s){
if(!ZaItem.hasRight(ZaDistributionList.ADD_DL_MEMBER_RIGHT,l)){
if(s&&s instanceof AjxCallback){
s.run()
}
return
}
var t,e;
var n=new ZmCsfeCommand();
t=AjxSoapDoc.create("AddDistributionListMemberRequest",ZaZimbraAdmin.URN,null);
t.set("id",l.id);
var u=l[ZaDistributionList.A2_addList].length;
if(u<1){
return
}
for(var h=0;
h<u;
h++){
t.set("dlm",l[ZaDistributionList.A2_addList][h].toString())
}
var o=new Object();
o.soapDoc=t;
if(s&&s instanceof AjxCallback){
o.asyncMode=true;
o.callback=s
}
o.noAuthToken=true;
var d=l[ZaDistributionList.A2_addList];
n.invoke(o);
l[ZaDistributionList.A2_addList]=new Array();
ZaDistributionList.modifyAccountDL(l,d,true)
};
ZaItem.modifyMethods.ZaDistributionList.push(ZaDistributionList.addNewMembers);
ZaDistributionList.modifyAccountDL=function(p,r,y){
var n=ZaApp.getInstance().getTabGroup();
var b={
name:p.name,id:p.id};
for(var g=0;
g<r.length;
g++){
var s=r[g];
var e=null;
e=s.name;
if(s.type==ZaItem.ALIAS&&s.attrs){
e=s.attrs[ZaAlias.A_targetAccount]
}
if(!e){
continue
}
var w=null;
for(var t=0;
t<ZaAppTabGroup._TABS.size();
t++){
var o=ZaAppTabGroup._TABS.get(t);
var h=o.getAppView();
if(h&&h._containedObject&&h._containedObject.name&&h.constructor&&(h.constructor==ZaAccountXFormView)){
if(e==h._containedObject.name){
w=h;
break
}else{
if(h._containedObject.attrs&&h._containedObject.attrs[ZaAccount.A_zimbraMailAlias]){
var m=h._containedObject.attrs[ZaAccount.A_zimbraMailAlias];
var l=false;
for(var u=0;
u<m.length;
u++){
if(e==m[u]){
l=true;
break
}}
if(l){
w=h;
break
}}}}}
if(!w){
continue
}
var d=false;
var c=w._containedObject[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
for(var f=0;
f<c.length;
f++){
if(c[f].name==b.name){
d=true;
break
}}
if(!d&&y){
c.push(b)
}else{
if(d&&!y){
c.splice(f,1)
}else{
continue
}}
w._localXForm.setInstanceValue(c,ZaAccount.A2_directMemberList)
}};
ZaDistributionList.addNewMembersCreateMethod=function(o,e,t){
ZaDistributionList.addNewMembers.call(this,null,o,e,t)
};
ZaItem.createMethods.ZaDistributionList.push(ZaDistributionList.addNewMembersCreateMethod);
ZaDistributionList.prototype.initFromJS=function(o){
if(!o){
return
}
this.attrs=new Object();
this.attrs[ZaAccount.A_zimbraMailAlias]=new Array();
this.name=o.name;
this.id=o.id;
this.dynamic=o.dynamic;
var e=o.a.length;
for(var t=0;
t<e;
t++){
if(o.a[t].n==ZaAccount.A_zimbraMailAlias&&o.a[t]._content==this.name){
continue
}
if(!this.attrs[[o.a[t].n]]){
this.attrs[[o.a[t].n]]=o.a[t]._content
}else{
if(!(this.attrs[[o.a[t].n]] instanceof Array)){
this.attrs[[o.a[t].n]]=[this.attrs[[o.a[t].n]]]
}
this.attrs[[o.a[t].n]].push(o.a[t]._content)
}}
if(!this.attrs[ZaAccount.A_description]){
this.attrs[ZaAccount.A_description]=[]
}
if(!(this.attrs[ZaAccount.A_description] instanceof Array)){
this.attrs[ZaAccount.A_description]=[this.attrs[ZaAccount.A_description]]
}};
ZaDistributionList.compareTwoMembers=function(n,o){
var t=AjxUtil.isEmpty(n);
var e=AjxUtil.isEmpty(o);
if(t&&!e){
return -1
}
if(!t&&e){
return 1
}
if(t&&e){
return 0
}
if(AjxUtil.isEmpty(n.name)&&AjxUtil.isEmpty(o.name)){
return 0
}
if(n.name==o.name){
return 0
}
if(n.name<o.name){
return -1
}
if(n.name>o.name){
return 1
}
return 0
};
ZaDistributionListMember=function(e){
this[ZaAccount.A_name]=e;
this.id="ZADLM_"+e
};
ZaDistributionListMember.prototype.toString=function(){
return this[ZaAccount.A_name]
};
ZaDistributionListOwner=function(e){
this[ZaAccount.A_name]=e.name;
this.id=e.id;
this.type=e.type
};
ZaDistributionListOwner.prototype.toString=function(){
return this[ZaAccount.A_name]
};
ZaDistributionList.myXModel={
items:[{
id:"id",type:_STRING_}
,{
id:ZaDistributionList.A2_query,type:_STRING_}
,{
id:ZaDistributionList.A2_dlType,type:_STRING_}
,{
id:ZaDistributionList.A2_pagenum,type:_NUMBER_,defaultValue:1}
,{
id:ZaDistributionList.A2_poolPagenum,type:_NUMBER_,defaultValue:1}
,{
id:ZaDistributionList.A2_poolNumPages,type:_NUMBER_,defaultValue:1}
,{
id:ZaDistributionList.A2_memPagenum,type:_NUMBER_,defaultValue:1}
,{
id:ZaDistributionList.A2_memNumPages,type:_NUMBER_,defaultValue:1}
,{
id:ZaDistributionList.A2_memberPool,type:_LIST_}
,{
id:ZaDistributionList.A2_memberList,type:_LIST_}
,{
id:ZaDistributionList.A2_allMemberHash,type:_OBJECT_,defaultValue:{}}
,{
id:ZaDistributionList.A2_allMemberPages,type:_LIST_,defaultValue:[]}
,{
id:ZaDistributionList.A2_origList,type:_LIST_}
,{
id:ZaDistributionList.A2_addList,type:_LIST_}
,{
id:ZaDistributionList.A2_removeList,type:_LIST_}
,{
id:ZaDistributionList.A2_optionalAdd,type:_STRING_}
,{
id:ZaAccount.A_name,type:_STRING_,required:true,constraints:{
type:"method",value:function(n,t,o,e){
if(n){
if(AjxUtil.isValidEmailNonReg(n)){
return AjxStringUtil.htmlEncode(n)
}else{
throw ZaMsg.ErrorInvalidEmailAddress
}}}}}
,{
id:ZaDistributionList.A2_DLOwners,type:_LIST_,ref:ZaDistributionList.A2_DLOwners,listItem:{
type:_STRING_}}
,{
id:ZaDistributionList.A2_owners_selection_cache,type:_LIST_}
,{
id:ZaDistributionList.A2_members,type:_LIST_}
,ZaItem.descriptionModelItem,{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:ZaDistributionList.A_memberOfURL,ref:"attrs/"+ZaDistributionList.A_memberOfURL,type:_STRING_,constraints:{
type:"method",value:function(s,o,n,e){
s=AjxStringUtil.trim(s);
var t=e.attrs[ZaDistributionList.A_zimbraIsACLGroup];
if(t!="TRUE"&&!s){
throw AjxMsg.valueIsRequired
}
return s
}}}
,{
id:ZaDistributionList.A_zimbraIsACLGroup,ref:"attrs/"+ZaDistributionList.A_zimbraIsACLGroup,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaItem.A_zimbraCreateTimestamp,ref:"attrs/"+ZaItem.A_zimbraCreateTimestamp}
,{
id:ZaAccount.A_zimbraHideInGal,type:_ENUM_,ref:"attrs/"+ZaAccount.A_zimbraHideInGal,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_notes,ref:"attrs/"+ZaAccount.A_notes,type:_STRING_}
,{
id:ZaAccount.A_mailHost,type:_STRING_,ref:"attrs/"+ZaAccount.A_mailHost}
,{
id:ZaAccount.A2_autoMailServer,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A_displayname,type:_STRING_,ref:"attrs/"+ZaAccount.A_displayname}
,{
id:ZaAccount.A_zimbraMailAlias,type:_LIST_,ref:"attrs/"+ZaAccount.A_zimbraMailAlias,listItem:{
type:_STRING_}}
,{
id:ZaDistributionList.A_mailStatus,ref:"attrs/"+ZaDistributionList.A_mailStatus,type:_STRING_}
,{
id:ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,ref:"attrs/"+ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,type:_STRING_}
,{
id:ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,ref:"attrs/"+ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,type:_STRING_}
,{
id:ZaDistributionList.A_zimbraDistributionListSendShareMessageToNewMembers,ref:"attrs/"+ZaDistributionList.A_zimbraDistributionListSendShareMessageToNewMembers,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDistributionList.A2_membersSelected,type:_LIST_}
,{
id:ZaDistributionList.A2_nonmembersSelected,type:_LIST_}
,{
id:ZaDistributionList.A2_memberPoolSelected,type:_LIST_}
,{
id:ZaDistributionList.A2_directMemberSelected,type:_LIST_}
,{
id:ZaDistributionList.A2_indirectMemberSelected,type:_LIST_}
,{
id:ZaAccount.A2_memberOf,type:_OBJECT_,items:[{
id:ZaDistributionList.A2_directMemberList,type:_LIST_}
,{
id:ZaDistributionList.A2_indirectMemberList,type:_LIST_}
,{
id:ZaDistributionList.A2_nonMemberList,type:_LIST_}
]}
,{
id:(ZaAccount.A2_directMemberList+"_more"),type:_LIST_}
,{
id:(ZaAccount.A2_directMemberList+"_offset"),type:_LIST_}
,{
id:(ZaAccount.A2_indirectMemberList+"_more"),type:_LIST_}
,{
id:(ZaAccount.A2_indirectMemberList+"_offset"),type:_LIST_}
,{
id:(ZaAccount.A2_nonMemberList+"_more"),type:_LIST_}
,{
id:(ZaAccount.A2_nonMemberList+"_offset"),type:_LIST_}
,{
id:ZaDistributionList.A2_alias_selection_cache,type:_LIST_}
,{
id:ZaDistributionList.A_zimbraPrefReplyToEnabled,type:_ENUM_,ref:"attrs/"+ZaDistributionList.A_zimbraPrefReplyToEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDistributionList.A_zimbraPrefReplyToDisplay,type:_STRING_,ref:"attrs/"+ZaDistributionList.A_zimbraPrefReplyToDisplay}
,{
id:ZaDistributionList.A_zimbraPrefReplyToAddress,type:_EMAIL_ADDRESS_,ref:"attrs/"+ZaDistributionList.A_zimbraPrefReplyToAddress}
]};
ZaDistributionList.prototype.schedulePostLoading=function(t){
var e=new AjxTimedAction(this,ZaDistributionList.prototype.getAllMembers,{
controller:t}
);
AjxTimedAction.scheduleAction(e,100)
};
ZaDistributionList.getRelatedList=function(o){
var n=this.attrs[ZaAccount.A_zimbraMailAlias];
var t=this[ZaDistributionList.A2_numMembers];
var e=[];
if(n.length>0){
var r=new ZaTreeItemData({
text:ZaMsg.TABT_Aliases,count:n.length,image:"AccountAlias",mappingId:ZaZimbraAdmin._DL_ALIAS_LIST_VIEW,path:o+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.TABT_Aliases}
);
r.setData("aliasTargetId",this.id);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DL_ALIAS_LIST_VIEW]=ZaOverviewPanelController.aliasListTreeListener;
e.push(r)
}
if(t>0){
var s=new ZaTreeItemData({
text:ZaMsg.DLXV_LabelListMembers,count:t,image:"DistributionList",mappingId:ZaZimbraAdmin._DL_MEMBERS_LIST_VIEW,path:o+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.DLXV_LabelListMembers}
);
s.setData("dlItem",this);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DL_MEMBERS_LIST_VIEW]=ZaOverviewPanelController.memberListInDLTreeListener;
e.push(s)
}
return e
};
ZaItem.getRelatedMethods.ZaDistributionList.push(ZaDistributionList.getRelatedList)
}
if(AjxPackage.define("zimbraAdmin.resource.model.ZaSignature")){
ZaSignature=function(e,n,o,t){
this.id=n;
this.name=e;
this.content=o;
this.type=t?t:"text/plain"
};
ZaSignature.prototype.constructor=ZaSignature;
ZaSignature.prototype.toString=function(){
return this.name
};
ZaSignature.compareObject=function(o,t){
for(var e in o){
if(o[e]!=t[e]){
return false
}}
return true
};
ZaSignature.A2_name="name";
ZaSignature.A2_id="id";
ZaSignature.A2_content="content";
ZaSignature.A2_type="type";
ZaSignature.myXModel={
items:[{
id:ZaSignature.A2_id,type:_STRING_,ref:ZaSignature.A2_id}
,{
id:ZaSignature.A2_name,type:_STRING_,ref:ZaSignature.A2_name}
,{
id:ZaSignature.A2_content,type:_STRING_,ref:ZaSignature.A2_content}
,{
id:ZaSignature.A2_type,type:_STRING_,ref:ZaSignature.A2_type}
]};
ZaSignature.signatureTypeChoices=[{
value:"text/plain",label:ZaMsg.resSignaturePlainType}
,{
value:"text/html",label:ZaMsg.resSignatureHTMLType}
];
ZaSignature.getSignatureChoices=function(t){
var e=[];
e.push({
name:ZaMsg.VALUE_NOT_SET,id:""}
);
var o=0;
for(o=0;
o<t.length;
o++){
if(t[o]&&t[o].name){
e.push({
name:t[o].name,id:t[o].id}
)
}}
return e
};
ZaSignature.getNewSignatureChoices=function(t){
var e=[];
e.push({
name:ZaMsg.VALUE_NOT_SET,id:""}
);
var o=0;
for(o=0;
o<t.length;
o++){
if(t[o]&&t[o].name){
e.push({
name:t[o].name,id:t[o].name}
)
}}
return e
};
ZaSignature.GetSignatures=function(c,e){
if(!ZaZimbraAdmin.haveTargetRight(ZaItem.RESOURCE,ZaResource.VIEW_RESOURCE_MAIL_RIGHT,this.name)&&!ZaZimbraAdmin.haveTargetRight(ZaItem.RESOURCE,ZaResource.VIEW_RESOURCE_MAIL_RIGHT,ZaAccount.getDomain(this.name))){
return
}
var d=AjxSoapDoc.create("GetSignaturesRequest","urn:zimbraAccount",null);
var o=new Object();
o.soapDoc=d;
o.skipAuthCheck=false;
if(c=="id"){
o.accountId=e
}else{
o.accountName=e
}
try{
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_RESOURCE};
this[ZaResource.A2_signatureList]=[];
var n=ZaRequestMgr.invoke(o,t).Body.GetSignaturesResponse;
if(n.signature){
for(var r in n.signature){
var h;
var s;
if(n.signature[r].content&&n.signature[r].content[0]){
h=n.signature[r].content[0]._content;
s=n.signature[r].content[0].type
}
var u=new ZaSignature(n.signature[r].name,n.signature[r].id,h,s);
this[ZaResource.A2_signatureList].push(u)
}}}
catch(l){
throw l;
return null
}};
ZaSignature.CreateSignature=function(h,e){
var l=AjxSoapDoc.create("CreateSignatureRequest","urn:zimbraAccount",null);
var c=l.set("signature",null);
c.setAttribute("name",this[ZaSignature.A2_name]);
var s;
if(this[ZaSignature.A2_type]=="text/plain"){
s=l.set("content",this[ZaSignature.A2_content],c);
s.setAttribute("type","text/plain");
s=l.set("content",null,c);
s.setAttribute("type","text/html")
}else{
s=l.set("content",this[ZaSignature.A2_content],c);
s.setAttribute("type","text/html");
s=l.set("content",null,c);
s.setAttribute("type","text/plain")
}
var o=new Object();
o.soapDoc=l;
o.skipAuthCheck=false;
if(h=="id"){
o.accountId=e
}else{
o.accountName=e
}
try{
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_RESOURCE};
var n=ZaRequestMgr.invoke(o,t).Body.CreateSignatureResponse;
if(n.signature&&n.signature[0]){
this.id=n.signature[0].id
}
return this
}
catch(r){
throw r;
return null
}};
ZaSignature.CreateAccountSignature=function(h,n){
if(!ZaZimbraAdmin.haveTargetRight(ZaItem.RESOURCE,ZaResource.VIEW_RESOURCE_MAIL_RIGHT,n.name)&&!ZaZimbraAdmin.haveTargetRight(ZaItem.RESOURCE,ZaResource.VIEW_RESOURCE_MAIL_RIGHT,ZaAccount.getDomain(n.name))){
return
}
if(!AjxUtil.isEmpty(h[ZaResource.A2_signatureList])){
for(var t=0;
t<h[ZaResource.A2_signatureList].length;
t++){
var s=h[ZaResource.A2_signatureList][t];
var r;
if(s[ZaSignature.A2_name]&&s[ZaSignature.A2_content]){
r=new ZaSignature(s[ZaSignature.A2_name],"",s[ZaSignature.A2_content],s[ZaSignature.A2_type]);
ZaSignature.CreateSignature.call(r,"id",n.id);
h[ZaResource.A2_signatureList][t]=r
}}
var o={};
var e;
if(h.attrs[ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId]){
e=ZaUtil.findValueInObjArrByPropertyName(h[ZaResource.A2_signatureList],h.attrs[ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId]);
if(e!=-1&&h[ZaResource.A2_signatureList][e].id){
o[ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId]=h[ZaResource.A2_signatureList][e].id
}}
if(h.attrs[ZaResource.A_zimbraPrefCalendarAutoDenySignatureId]){
e=ZaUtil.findValueInObjArrByPropertyName(h[ZaResource.A2_signatureList],h.attrs[ZaResource.A_zimbraPrefCalendarAutoDenySignatureId]);
if(e!=-1&&h[ZaResource.A2_signatureList][e].id){
o[ZaResource.A_zimbraPrefCalendarAutoDenySignatureId]=h[ZaResource.A2_signatureList][e].id
}}
if(h.attrs[ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId]){
e=ZaUtil.findValueInObjArrByPropertyName(h[ZaResource.A2_signatureList],h.attrs[ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId]);
if(e!=-1&&h[ZaResource.A2_signatureList][e].id){
o[ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId]=h[ZaResource.A2_signatureList][e].id
}}
if(!AjxUtil.isEmpty(o)){
ZaResource.modifyMethod.call(n,o)
}}
return n
};
ZaSignature.ModifySignature=function(s,l){
var o=AjxSoapDoc.create("ModifySignatureRequest","urn:zimbraAccount",null);
var h=o.set("signature",null);
h.setAttribute("name",this[ZaSignature.A2_name]);
h.setAttribute("id",this[ZaSignature.A2_id]);
var n;
if(this[ZaSignature.A2_type]=="text/plain"){
n=o.set("content",this[ZaSignature.A2_content],h);
n.setAttribute("type","text/plain");
n=o.set("content",null,h);
n.setAttribute("type","text/html")
}else{
n=o.set("content",this[ZaSignature.A2_content],h);
n.setAttribute("type","text/html");
n=o.set("content",null,h);
n.setAttribute("type","text/plain")
}
var r=new Object();
r.soapDoc=o;
r.skipAuthCheck=false;
if(s=="id"){
r.accountId=l
}else{
r.accountName=l
}
try{
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_RESOURCE};
ZaRequestMgr.invoke(r,t).Body.ModifySignatureResponse
}
catch(e){
throw e;
return null
}};
ZaSignature.DeleteSignature=function(n,l){
var o=AjxSoapDoc.create("DeleteSignatureRequest","urn:zimbraAccount",null);
var h=o.set("signature",null);
h.setAttribute("id",this[ZaSignature.A2_id]);
var r=new Object();
r.soapDoc=o;
r.skipAuthCheck=false;
if(n=="id"){
r.accountId=l
}else{
r.accountName=l
}
try{
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_RESOURCE};
var s=ZaRequestMgr.invoke(r,t).Body.DeleteSignatureResponse
}
catch(e){
throw e;
return null
}}
}
if(AjxPackage.define("zimbraAdmin.resource.model.ZaResource")){
ZaResource=function(){
ZaItem.call(this,"ZaResource");
this._init();
this.type=ZaItem.RESOURCE
};
ZaResource.prototype=new ZaAccount;
ZaResource.prototype.constructor=ZaResource;
ZaItem.loadMethods.ZaResource=new Array();
ZaItem.initMethods.ZaResource=new Array();
ZaItem.modifyMethods.ZaResource=new Array();
ZaItem.createMethods.ZaResource=new Array();
ZaResource.A_name=ZaAccount.A_name;
ZaResource.A_uid=ZaAccount.A_uid;
ZaResource.A_accountName=ZaAccount.A_accountName;
ZaResource.A_mail=ZaAccount.A_mail;
ZaResource.A_description=ZaAccount.A_description;
ZaResource.A_displayname=ZaAccount.A_displayname;
ZaResource.A_country=ZaAccount.A_country;
ZaResource.A_street=ZaAccount.A_street;
ZaResource.A_city=ZaAccount.A_city;
ZaResource.A_zip=ZaAccount.A_zip;
ZaResource.A_state=ZaAccount.A_state;
ZaResource.A_password=ZaAccount.A_password;
ZaResource.A2_confirmPassword=ZaAccount.A2_confirmPassword;
ZaResource.A_accountStatus=ZaAccount.A_accountStatus;
ZaResource.A_notes=ZaAccount.A_notes;
ZaResource.A_mailHost=ZaAccount.A_mailHost;
ZaResource.A_COSId=ZaAccount.A_COSId;
ZaResource.A_zimbraMinPwdLength=ZaAccount.A_zimbraMinPwdLength;
ZaResource.A_zimbraMaxPwdLength=ZaAccount.A_zimbraMaxPwdLength;
ZaResource.A_zimbraPrefCalendarForwardInvitesTo="zimbraPrefCalendarForwardInvitesTo";
ZaResource.A_zimbraCalResMaxNumConflictsAllowed="zimbraCalResMaxNumConflictsAllowed";
ZaResource.A_zimbraCalResMaxPercentConflictsAllowed="zimbraCalResMaxPercentConflictsAllowed";
ZaResource.A_locationDisplayName="zimbraCalResLocationDisplayName";
ZaResource.A_zimbraAccountCalendarUserType="zimbraAccountCalendarUserType";
ZaResource.A_zimbraCalResAlwaysFree="zimbraCalResAlwaysFree";
ZaResource.A_zimbraCalResAutoAcceptDecline="zimbraCalResAutoAcceptDecline";
ZaResource.A_zimbraCalResAutoDeclineIfBusy="zimbraCalResAutoDeclineIfBusy";
ZaResource.A_zimbraCalResAutoDeclineRecurring="zimbraCalResAutoDeclineRecurring";
ZaResource.A_zimbraCalResBuilding="zimbraCalResBuilding";
ZaResource.A_zimbraCalResCapacity="zimbraCalResCapacity";
ZaResource.A_zimbraCalResContactEmail="zimbraCalResContactEmail";
ZaResource.A_zimbraCalResContactName="zimbraCalResContactName";
ZaResource.A_zimbraCalResContactPhone="zimbraCalResContactPhone";
ZaResource.A_zimbraCalResFloor="zimbraCalResFloor";
ZaResource.A_zimbraCalResRoom="zimbraCalResRoom";
ZaResource.A_zimbraCalResSite="zimbraCalResSite";
ZaResource.A_zimbraCalResType="zimbraCalResType";
ZaResource.A_contactInfoAutoComplete="contactInfoAutoComplete";
ZaResource.A_zimbraMailForwardingAddressMaxLength="zimbraMailForwardingAddressMaxLength";
ZaResource.A_zimbraMailForwardingAddressMaxNumAddrs="zimbraMailForwardingAddressMaxNumAddrs";
ZaResource.ACCOUNT_STATUS_ACTIVE="active";
ZaResource.ACCOUNT_STATUS_MAINTENANCE="maintenance";
ZaResource.ACCOUNT_STATUS_LOCKED="locked";
ZaResource.ACCOUNT_STATUS_CLOSED="closed";
ZaResource.RESOURCE_TYPE_LOCATION="Location";
ZaResource.RESOURCE_TYPE_EQUIPMENT="Equipment";
ZaResource.SCHEDULE_POLICY_TT="scheduleTT";
ZaResource.SCHEDULE_POLICY_FT="scheduleFT";
ZaResource.SCHEDULE_POLICY_TF="scheduleTF";
ZaResource.SCHEDULE_POLICY_FF="scheduleFF";
ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId="zimbraPrefCalendarAutoAcceptSignatureId";
ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId="zimbraPrefCalendarAutoDeclineSignatureId";
ZaResource.A_zimbraPrefCalendarAutoDenySignatureId="zimbraPrefCalendarAutoDenySignatureId";
ZaResource.A2_signatureList="signatureList";
ZaResource.A2_signature_selection_cache="signatureSelectionCache";
ZaResource.A2_schedulePolicy="schedulePolicy";
ZaResource.A2_autodisplayname="autodisplayname";
ZaResource.A2_autoMailServer="automailserver";
ZaResource.A2_autoCos="autoCos";
ZaResource.A2_autoLocationName="autolocationname";
ZaResource.A2_myCOS="mycos";
ZaResource.A2_calFwdAddr_selection_cache="calFwdAddr_selection_cache";
ZaResource.MAXSEARCHRESULTS=ZaSettings.MAXSEARCHRESULTS;
ZaResource.RESULTSPERPAGE=ZaSettings.RESULTSPERPAGE;
ZaResource.searchAttributes=AjxBuffer.concat(ZaResource.A_displayname,",",ZaItem.A_zimbraId,",",ZaResource.A_mailHost,",",ZaResource.A_uid,",",ZaResource.A_accountStatus,",",ZaResource.A_description,",",ZaResource.A_zimbraCalResType);
ZaResource.VIEW_RESOURCE_MAIL_RIGHT="adminLoginCalendarResourceAs";
ZaResource.SET_CALRES_PASSWORD_RIGHT="setCalendarResourcePassword";
ZaResource.CHANGE_CALRES_PASSWORD_RIGHT="changeCalendarResourcePassword";
ZaResource.ADD_CALRES_ALIAS_RIGHT="addCalendarResourceAlias";
ZaResource.REMOVE_CALRES_ALIAS_RIGHT="removeCalendarResourceAlias";
ZaResource.DELETE_CALRES_RIGHT="deleteCalendarResource";
ZaResource.GET_CALRES_SHAREINFO_RIGHT="getCalendarResourceShareInfo";
ZaResource.LIST_CALRES_RIGHT="listCalendarResource";
ZaResource.PUBLISH_CALRES_SHAREINFO="publishCalendarResourceShareInfo";
ZaResource.RENAME_CALRES_RIGHT="renameCalendarResource";
ZaResource.GET_CALRES_INFO_RIGHT="getCalendarResourceInfo";
ZaResource.checkValues=function(s){
if(ZaItem.hasWritePermission(ZaAccount.A_name,s)){
if(s.name==null||s.name.length<1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_NAME_REQUIRED);
return false
}
if(!AjxUtil.isValidEmailNonReg(s.name)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_RESOURCE_EMAIL_INVALID);
return false
}}
var o=Number.POSITIVE_INFINITY;
var e=1;
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraMinPwdLength,s)&&ZaItem.hasWritePermission(ZaAccount.A_zimbraMaxPwdLength,s)){
if(s.attrs[ZaResource.A_zimbraMinPwdLength]!=null){
e=s.attrs[ZaResource.A_zimbraMinPwdLength]
}else{
e=s._defaultValues.attrs[ZaResource.A_zimbraMinPwdLength]
}
if(s.attrs[ZaResource.A_zimbraMaxPwdLength]!=null){
o=s.attrs[ZaResource.A_zimbraMaxPwdLength]
}else{
o=s._defaultValues.attrs[ZaResource.A_zimbraMaxPwdLength]
}}
if(ZaItem.hasAnyRight([ZaResource.SET_CALRES_PASSWORD_RIGHT,ZaResource.CHANGE_CALRES_PASSWORD_RIGHT],s)){
if(s.attrs[ZaResource.A_password]!=null||s[ZaResource.A2_confirmPassword]!=null){
if(s.attrs[ZaResource.A_password]!=s[ZaResource.A2_confirmPassword]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}
if(s.attrs[ZaResource.A_password].length<e||AjxStringUtil.trim(s.attrs[ZaResource.A_password]).length<e){
var t;
if(e>1){
t=String(ZaMsg.NAD_passMinLengthMsg_p).replace("{0}",e)
}else{
t=String(ZaMsg.NAD_passMinLengthMsg_s).replace("{0}",e)
}
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_TOOSHORT+"<br>"+t);
return false
}
if(AjxStringUtil.trim(s.attrs[ZaResource.A_password]).length>o){
var n;
if(o>1){
n=String(ZaMsg.NAD_passMinLengthMsg_p).replace("{0}",e)
}else{
n=String(ZaMsg.NAD_passMinLengthMsg_s).replace("{0}",e)
}
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_TOOLONG+"<br>"+n);
return false
}}}
return true
};
ZaResource.createMethod=function(r,n){
r.attrs[ZaResource.A_mail]=r.name;
var h;
var u=AjxSoapDoc.create("CreateCalendarResourceRequest",ZaZimbraAdmin.URN,null);
u.set(ZaResource.A_name,r.name);
if(r.attrs[ZaResource.A_password]&&r.attrs[ZaResource.A_password].length>0){
u.set(ZaResource.A_password,r.attrs[ZaResource.A_password])
}
if(r[ZaResource.A2_autoMailServer]=="TRUE"){
r.attrs[ZaResource.A_mailHost]=null
}
if(r[ZaResource.A2_autoCos]=="TRUE"){
r.attrs[ZaResource.A_COSId]=null
}
ZaResource.prototype.setLdapAttrsFromSchedulePolicy.call(r);
for(var d in r.attrs){
if(d==ZaResource.A_password||d==ZaItem.A_objectClass||d==ZaResource.A_mail||d==ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId||d==ZaResource.A_zimbraPrefCalendarAutoDenySignatureId||d==ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId){
continue
}
if(r.attrs[d] instanceof Array){
var t=r.attrs[d].length;
if(t){
for(var o=0;
o<t;
o++){
var l=u.set("a",r.attrs[d][o]);
l.setAttribute("n",d)
}}}else{
if(r.attrs[d]!=null){
var l=u.set("a",r.attrs[d]);
l.setAttribute("n",d)
}}}
try{
var s=new Object();
s.soapDoc=u;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_RESOURCE};
h=ZaRequestMgr.invoke(s,e).Body.CreateCalendarResourceResponse
}
catch(c){
throw c;
return null
}
n.initFromJS(h.calresource[0]);
return n
};
ZaItem.createMethods.ZaResource.push(ZaResource.createMethod);
ZaItem.createMethods.ZaResource.push(ZaSignature.CreateAccountSignature);
ZaResource.modifyMethod=function(c){
var d=false;
var l=AjxSoapDoc.create("ModifyCalendarResourceRequest",ZaZimbraAdmin.URN,null);
l.set("id",this.id);
for(var h in c){
d=true;
if(c[h] instanceof Array){
var t=c[h].length;
if(t){
var n=false;
for(var o=0;
o<t;
o++){
var r=null;
if(c[h][o] instanceof String||AjxUtil.isString(c[h][o])){
if(AjxUtil.isEmpty(c[h][o])){
continue
}else{
n=true
}
var r=l.set("a",c[h][o].toString())
}else{
if(c[h][o] instanceof Object){
var r=l.set("a",c[h][o].toString());
n=true
}else{
var r=l.set("a",c[h][o]);
n=true
}}
if(r){
r.setAttribute("n",h)
}}
if(!n){
var r=l.set("a","");
r.setAttribute("n",h)
}}else{
var r=l.set("a","");
r.setAttribute("n",h)
}}else{
var r=l.set("a",c[h]);
r.setAttribute("n",h)
}}
if(!d){
return
}
var s=new Object();
s.soapDoc=l;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_RESOURCE};
resp=ZaRequestMgr.invoke(s,e).Body.ModifyCalendarResourceResponse;
this.initFromJS(resp.calresource[0]);
this[ZaResource.A2_confirmPassword]=null;
this._toolTip=null;
return
};
ZaItem.modifyMethods.ZaResource.push(ZaResource.modifyMethod);
ZaResource.prototype.remove=function(o){
var e=AjxSoapDoc.create("DeleteCalendarResourceRequest",ZaZimbraAdmin.URN,null);
e.set("id",this.id);
this.deleteCommand=new ZmCsfeCommand();
var t=new Object();
t.soapDoc=e;
t.noAuthToken=true;
if(o){
t.asyncMode=true;
t.callback=o
}
this.deleteCommand.invoke(t)
};
ZaResource.prototype.initFromJS=function(o){
if(!o){
return
}
this.attrs=new Object();
this.name=o.name;
this.id=o.id;
this.attrs[ZaResource.A_zimbraPrefCalendarForwardInvitesTo]=new Array();
var e=(o.a?o.a.length:0);
for(var t=0;
t<e;
t++){
if(!this.attrs[[o.a[t].n]]){
this.attrs[[o.a[t].n]]=o.a[t]._content
}else{
if(!(this.attrs[[o.a[t].n]] instanceof Array)){
this.attrs[[o.a[t].n]]=[this.attrs[[o.a[t].n]]]
}
this.attrs[[o.a[t].n]].push(o.a[t]._content)
}}
this.setSchedulePolicyFromLdapAttrs();
if(!this.attrs[ZaAccount.A_description]){
this.attrs[ZaAccount.A_description]=[]
}
if(!(this.attrs[ZaAccount.A_description] instanceof Array)){
this.attrs[ZaAccount.A_description]=[this.attrs[ZaAccount.A_description]]
}};
ZaResource.prototype.setSchedulePolicyFromLdapAttrs=function(){
if(this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]=="TRUE"&&this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]=="TRUE"){
this[ZaResource.A2_schedulePolicy]=ZaResource.SCHEDULE_POLICY_TT
}else{
if(this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]=="TRUE"&&this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]=="FALSE"){
this[ZaResource.A2_schedulePolicy]=ZaResource.SCHEDULE_POLICY_TF
}else{
if(this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]=="FALSE"&&this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]=="FALSE"){
this[ZaResource.A2_schedulePolicy]=ZaResource.SCHEDULE_POLICY_FF
}else{
if(this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]=="FALSE"&&this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]=="TRUE"){
this[ZaResource.A2_schedulePolicy]=ZaResource.SCHEDULE_POLICY_FT
}}}}};
ZaResource.prototype.setLdapAttrsFromSchedulePolicy=function(){
if(this[ZaResource.A2_schedulePolicy]==ZaResource.SCHEDULE_POLICY_TT){
this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]="TRUE";
this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]="TRUE"
}else{
if(this[ZaResource.A2_schedulePolicy]==ZaResource.SCHEDULE_POLICY_TF){
this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]="TRUE";
this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]="FALSE"
}else{
if(this[ZaResource.A2_schedulePolicy]==ZaResource.SCHEDULE_POLICY_FT){
this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]="FALSE";
this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]="TRUE"
}else{
if(this[ZaResource.A2_schedulePolicy]==ZaResource.SCHEDULE_POLICY_FF){
this.attrs[ZaResource.A_zimbraCalResAutoAcceptDecline]="FALSE";
this.attrs[ZaResource.A_zimbraCalResAutoDeclineIfBusy]="FALSE"
}}}}};
ZaResource.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table cellpadding='0' cellspacing='0' border='0'>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;width:350' >";
t[e++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
if(this.attrs[ZaResource.A_zimbraCalResType]==ZaResource.RESOURCE_TYPE_LOCATION){
t[e++]=AjxImg.getImageHtml("Location")
}else{
t[e++]=AjxImg.getImageHtml("Resource")
}
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
e=this._addRow(ZaMsg.NAD_ResourceStatus,ZaResource.getAccountStatusLabel(this.attrs[ZaResource.A_accountStatus]),t,e);
e=this._addRow(ZaMsg.NAD_ResourceName,this.attrs[ZaResource.A_displayname],t,e);
e=this._addRow(ZaMsg.NAD_ResType,ZaResource.getResTypeLabel(this.attrs[ZaResource.A_zimbraCalResType]),t,e);
if(this.getAttrs&&this.getAttrs[ZaResource.A_mailHost]){
e=this._addRow(ZaMsg.NAD_MailServer,this.attrs[ZaResource.A_mailHost],t,e)
}
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaResource.loadMethod=function(h,e,r){
var l=AjxSoapDoc.create("GetCalendarResourceRequest",ZaZimbraAdmin.URN,null);
if(r){
l.getMethod().setAttribute("applyCos","1")
}else{
l.getMethod().setAttribute("applyCos","0")
}
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
l.setMethodAttribute("attrs",this.attrsToGet.join(","))
}
var c=l.set("calresource",e);
c.setAttribute("by",h);
var o=new Object();
o.soapDoc=l;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_RESOURCE};
var n=ZaRequestMgr.invoke(o,t).Body.GetCalendarResourceResponse;
this.attrs=new Object();
this.initFromJS(n.calresource[0]);
var s=this.attrs[ZaResource.A_locationDisplayName];
if(!s){
s=""
}
if(this.getAutoLocationName()==s){
this[ZaResource.A2_autoLocationName]="TRUE"
}else{
this[ZaResource.A2_autoLocationName]="FALSE"
}
this[ZaResource.A2_confirmPassword]=null
};
ZaItem.loadMethods.ZaResource.push(ZaResource.loadMethod);
ZaResource.loadInfoMethod=function(s,l,o){
if(!ZaItem.hasRight(ZaResource.GET_CALRES_INFO_RIGHT,this)){
return
}
var n=AjxSoapDoc.create("GetAccountInfoRequest",ZaZimbraAdmin.URN,null);
var e=n.set("account",l);
e.setAttribute("by",s);
var h=new Object();
i;
h.soapDoc=n;
var t={
controller:ZaApp.getInstance().getCurrentController()};
var r=ZaRequestMgr.invoke(h,t).Body.GetAccountInfoResponse;
if(r[ZaAccount.A2_publicMailURL]&&r[ZaAccount.A2_publicMailURL][0]){
this[ZaAccount.A2_publicMailURL]=r[ZaAccount.A2_publicMailURL][0]._content
}
if(r[ZaAccount.A2_adminSoapURL]&&r[ZaAccount.A2_adminSoapURL][0]){
this[ZaAccount.A2_adminSoapURL]=r[ZaAccount.A2_adminSoapURL][0]._content
}
if(r[ZaAccount.A2_soapURL]&&r[ZaAccount.A2_soapURL][0]){
this[ZaAccount.A2_soapURL]=r[ZaAccount.A2_soapURL][0]._content
}};
ZaItem.loadMethods.ZaResource.push(ZaSignature.GetSignatures);
ZaItem.loadMethods.ZaResource.push(ZaResource.loadInfoMethod);
ZaResource.prototype.getAutoLocationName=function(){
var e="";
if(this.attrs[ZaResource.A_zimbraCalResSite]){
e+=ZaMsg.NAD_Site+" "+this.attrs[ZaResource.A_zimbraCalResSite]
}
if(this.attrs[ZaResource.A_zimbraCalResBuilding]){
e+=", "+ZaMsg.NAD_Building+" "+this.attrs[ZaResource.A_zimbraCalResBuilding]
}
if(this.attrs[ZaResource.A_zimbraCalResFloor]){
e+=", "+ZaMsg.NAD_Floor+" "+this.attrs[ZaResource.A_zimbraCalResFloor]
}
if(this.attrs[ZaResource.A_zimbraCalResRoom]){
e+=", "+ZaMsg.NAD_Room+" "+this.attrs[ZaResource.A_zimbraCalResRoom]
}
var t=/^\,\s*/;
e=e.replace(t,"");
return e
};
ZaResource.prototype.refresh=function(e){
this.load("id",this.id,e)
};
ZaResource.prototype.rename=function(e){
var o=AjxSoapDoc.create("RenameCalendarResourceRequest",ZaZimbraAdmin.URN,null);
o.set("id",this.id);
o.set("newName",e);
var n=new Object();
n.soapDoc=o;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_RENAME_RESOURCE};
ZaRequestMgr.invoke(n,t)
};
ZaResource.myXModel={
items:[{
id:ZaResource.A_name,type:_STRING_,ref:"name",required:true,constraints:{
type:"method",value:function(n,t,o,e){
if(n){
if(AjxUtil.isValidEmailNonReg(n)){
return n
}else{
throw ZaMsg.ErrorInvalidEmailAddress
}}}}}
,{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:ZaItem.A_zimbraCreateTimestamp,ref:"attrs/"+ZaItem.A_zimbraCreateTimestamp}
,{
id:ZaResource.A_mail,type:_STRING_,ref:"attrs/"+ZaResource.A_mail,constraints:{
type:"method",value:function(n,t,o,e){
if(n){
if(AjxUtil.isValidEmailNonReg(n)){
return n
}else{
throw ZaMsg.ErrorInvalidEmailAddress
}}}}}
,{
id:ZaResource.A2_schedulePolicy,type:_STRING_,ref:ZaResource.A2_schedulePolicy}
,{
id:ZaResource.A_password,type:_STRING_,ref:"attrs/"+ZaAccount.A_password}
,{
id:ZaResource.A2_confirmPassword,type:_STRING_}
,{
id:ZaResource.A_displayname,type:_STRING_,ref:"attrs/"+ZaResource.A_displayname,required:true}
,{
id:ZaResource.A_zimbraCalResType,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResType}
,{
id:ZaResource.A_uid,type:_STRING_,ref:"attrs/"+ZaResource.A_uid}
,{
id:ZaResource.A_mailHost,type:_STRING_,ref:"attrs/"+ZaResource.A_mailHost}
,{
id:ZaResource.A_COSId,type:_STRING_,ref:"attrs/"+ZaResource.A_COSId}
,{
id:ZaResource.A_accountStatus,type:_STRING_,ref:"attrs/"+ZaResource.A_accountStatus}
,{
id:ZaResource.A_zimbraCalResAutoDeclineIfBusy,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResAutoDeclineIfBusy}
,{
id:ZaResource.A_zimbraCalResAlwaysFree,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResAlwaysFree}
,{
id:ZaResource.A_zimbraCalResAutoDeclineRecurring,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResAutoDeclineRecurring}
,{
id:ZaResource.A_zimbraCalResMaxNumConflictsAllowed,type:_NUMBER_,ref:"attrs/"+ZaResource.A_zimbraCalResMaxNumConflictsAllowed,defaultValue:0,minInclusive:0}
,{
id:ZaResource.A_zimbraCalResMaxPercentConflictsAllowed,type:_NUMBER_,ref:"attrs/"+ZaResource.A_zimbraCalResMaxPercentConflictsAllowed,minInclusive:0,maxInclusive:100,defaultValue:0}
,ZaItem.descriptionModelItem,{
id:ZaResource.A_notes,type:_STRING_,ref:"attrs/"+ZaResource.A_notes}
,{
id:ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId}
,{
id:ZaResource.A_zimbraPrefCalendarAutoDenySignatureId,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraPrefCalendarAutoDenySignatureId}
,{
id:ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId}
,{
id:ZaResource.A_zimbraCalResSite,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResSite}
,{
id:ZaResource.A_zimbraCalResBuilding,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResBuilding}
,{
id:ZaResource.A_zimbraCalResFloor,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResFloor}
,{
id:ZaResource.A_zimbraCalResRoom,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResRoom}
,{
id:ZaResource.A_zimbraCalResCapacity,type:_NUMBER_,ref:"attrs/"+ZaResource.A_zimbraCalResCapacity}
,{
id:ZaResource.A_locationDisplayName,type:_STRING_,ref:"attrs/"+ZaResource.A_locationDisplayName}
,{
id:ZaResource.A_street,type:_STRING_,ref:"attrs/"+ZaResource.A_street}
,{
id:ZaResource.A_city,type:_STRING_,ref:"attrs/"+ZaResource.A_city}
,{
id:ZaResource.A_state,type:_STRING_,ref:"attrs/"+ZaResource.A_state}
,{
id:ZaResource.A_country,type:_STRING_,ref:"attrs/"+ZaResource.A_country}
,{
id:ZaResource.A_zip,type:_STRING_,ref:"attrs/"+ZaResource.A_zip}
,{
id:ZaResource.A_zimbraCalResContactName,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResContactName}
,{
id:ZaResource.A_zimbraCalResContactEmail,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResContactEmail,constraints:{
type:"method",value:function(n,t,o,e){
if(n){
if(AjxUtil.isValidEmailNonReg(n)){
return n
}else{
throw ZaMsg.ErrorInvalidEmailAddress
}}}}}
,{
id:ZaResource.A_zimbraCalResContactPhone,type:_STRING_,ref:"attrs/"+ZaResource.A_zimbraCalResContactPhone}
,{
id:ZaResource.A_contactInfoAutoComplete,type:_LIST_,ref:"attrs/"+ZaResource.A_contactInfoAutoComplete}
,{
id:ZaResource.A_zimbraPrefCalendarForwardInvitesTo,type:_LIST_,ref:"attrs/"+ZaResource.A_zimbraPrefCalendarForwardInvitesTo,listItem:{
type:_EMAIL_ADDRESS_}}
,{
id:ZaResource.A2_autodisplayname,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaResource.A2_autoMailServer,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaResource.A2_autoCos,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaResource.A2_autoLocationName,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaAccount.A2_calFwdAddr_selection_cache,type:_LIST_}
,{
id:ZaResource.A2_signatureList,type:_LIST_}
,{
id:ZaResource.A2_signature_selection_cache,type:_LIST_}
]};
ZaItem._ATTR[ZaResource.A_displayname]=ZaMsg.attrDesc_accountName;
ZaItem._ATTR[ZaResource.A_description]=ZaMsg.attrDesc_description;
ZaItem._ATTR[ZaResource.A_accountStatus]=ZaMsg.attrDesc_accountStatus;
ZaItem._ATTR[ZaResource.A_mailHost]=ZabMsg.attrDesc_mailHost;
ZaItem._ATTR[ZaResource.A_notes]=ZaMsg.attrDesc_notes;
ZaResource.getAccountStatusLabel=ZaAccount.getAccountStatusMsg;
ZaResource.getResTypeLabel=function(t){
var e=ZaResource._RESOURCE_TYPE[t];
return(e==null)?t:e
};
ZaResource._RESOURCE_TYPE=new Object();
ZaResource._RESOURCE_TYPE[ZaResource.RESOURCE_TYPE_LOCATION]=ZaMsg.resType_location;
ZaResource._RESOURCE_TYPE[ZaResource.RESOURCE_TYPE_EQUIPMENT]=ZaMsg.resType_equipment;
ZaResource.initMethod=function(){
this.attrs=new Object();
this.id="";
this.name=""
};
ZaItem.initMethods.ZaResource.push(ZaResource.initMethod);
ZaResource.setAutoLocationName=function(n,o,t){
var e=this.getInstance();
this.getForm().itemChanged(this,n,t);
if(e[ZaResource.A2_autoLocationName]=="TRUE"){
e.attrs[ZaResource.A_locationDisplayName]=ZaResource.prototype.getAutoLocationName.call(e);
this.getForm().refresh()
}};
ZaResource.isLocation=function(){
return(this.getInstanceValue(ZaResource.A_zimbraCalResType).toLowerCase()==ZaResource.RESOURCE_TYPE_LOCATION.toLowerCase())
};
ZaResource.isAutoDeclineEnabled=function(){
return(this.getInstanceValue(ZaResource.A2_schedulePolicy)==ZaResource.SCHEDULE_POLICY_TT||this.getInstanceValue(ZaResource.A2_schedulePolicy)==ZaResource.SCHEDULE_POLICY_FT)
}
}
if(AjxPackage.define("zimbraAdmin.resource.model.ZaContactList")){
ZaContactList=function(){
this._list=[]
};
ZaContactList.matchValue=ZaAccount.A_displayname;
ZaContactList.matchText="matchListFieldText";
ZaContactList.prototype.getContactList=function(n,s){
try{
var o={};
var t=Dwt.getNextId();
o.attrs=[ZaAccount.A_displayname,ZaAccount.A_mail,ZaAccount.A_telephoneNumber].join();
o.types=ZaSearch.ACCOUNTS;
o.sortBy=ZaAccount.A_displayname;
o.query=ZaSearch.getSearchByDisplayNameQuery(n);
o.applyCos="0";
myCallback=new AjxCallback(this,this.getDataCallback,{
callback:s,busyId:t}
);
o.callback=myCallback;
o.controller=ZaApp.getInstance().getCurrentController();
o.showBusy=true;
o.busyMsg=ZaMsg.BUSY_SEARCHING;
o.skipCallbackIfCancelled=false;
o.busyId=t;
ZaSearch.searchDirectory(o)
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaContactList.prototype.getContactList")
}};
ZaContactList.prototype._autocompleteCallback=function(n,s){
var t=s.getForm();
var o=t.getItemsById(ZaResource.A_zimbraCalResContactEmail)[0];
var e=t.getItemsById(ZaResource.A_zimbraCalResContactPhone)[0];
o.setInstanceValue(n.contact[ZaAccount.A_name]);
e.setInstanceValue(n.contact[ZaAccount.A_telephoneNumber]);
t.refresh()
};
ZaContactList.prototype.getDataCallback=function(e,t){
try{
var c=e.callback;
if(e.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,e.busyId)
}
if(!t){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaContactList.prototype.getDataCallback"))
}
if(t.isException()){
ZaSearch.handleTooManyResultsException(t.getException(),"ZaContactList.prototype.getDataCallback")
}else{
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
var o=t.getResponse().Body.SearchDirectoryResponse;
var h=new ZaItemList();
h.loadFromJS(o);
var r=h.getArray();
var n=[];
for(var s=0;
s<r.length;
s++){
n[s]={
contact:{}};
n[s]["contact"][ZaAccount.A_displayname]=r[s].attrs[ZaAccount.A_displayname];
n[s]["contact"][ZaAccount.A_name]=r[s][ZaAccount.A_name];
n[s]["contact"][ZaAccount.A_telephoneNumber]=r[s].attrs[ZaAccount.A_telephoneNumber];
n[s][ZaContactList.matchText]=n[s]["contact"][ZaAccount.A_displayname]+"< "+n[s]["contact"][ZaAccount.A_name]+">";
n[s][ZaContactList.matchValue]=n[s]["contact"][ZaAccount.A_displayname]
}
c.run(n)
}}
catch(l){
ZaApp.getInstance().getCurrentController()._handleException(l,"ZaContactList.prototype.getDataCallback")
}};
ZaContactList.prototype.isUniqueValue=function(e){};
ZaContactList.prototype.getList=function(){
return this._list
}
}
if(AjxPackage.define("zimbraAdmin.accounts.model.ZaAlias")){
ZaAlias=function(){
ZaItem.call(this);
this.attrs=new Object();
this.id="";
this.name="";
this.type=ZaItem.ALIAS
};
ZaAlias.prototype=new ZaItem;
ZaAlias.prototype.constructor=ZaAlias;
ZaAlias.A_AliasTargetId="zimbraAliasTargetId";
ZaAlias.A_targetAccount="targetName";
ZaAlias.A_targetType="type";
ZaAlias.A_index="index";
ZaAlias.A_uid="uid";
ZaAlias.TARGET_TYPE_DL=ZaItem.DL;
ZaAlias.TARGET_TYPE_ACCOUNT=ZaItem.ACCOUNT;
ZaAlias.TARGET_TYPE_RESOURCE=ZaItem.RESOURCE;
ZaItem._ATTR[ZaAlias.A_targetAccount]=ZaMsg.attrDesc_aliasFor;
ZaAlias.searchAttributes=AjxBuffer.concat(ZaAlias.A_AliasTargetId,",",ZaItem.A_zimbraId,",",ZaAlias.A_targetAccount,",",ZaAlias.A_uid,",",ZaAlias.A_targetType,",",ZaAccount.A_description);
ZaAlias.prototype.remove=function(n){
var e;
switch(this.attrs[ZaAlias.A_targetType]){
case ZaAlias.TARGET_TYPE_ACCOUNT:e="RemoveAccountAliasRequest";
break;
case ZaAlias.TARGET_TYPE_DL:e="RemoveDistributionListAliasRequest";
break;
case ZaAlias.TARGET_TYPE_RESOURCE:e="RemoveAccountAliasRequest";
break;
default:throw new Error("Can't add alias for account type: "+this.attrs[ZaAlias.A_targetType])
}
var t=AjxSoapDoc.create(e,ZaZimbraAdmin.URN,null);
t.set("id",this.attrs[ZaAlias.A_AliasTargetId]);
t.set("alias",this.name);
this.deleteCommand=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=t;
o.noAuthToken=true;
if(n){
o.asyncMode=true;
o.callback=n
}
this.deleteCommand.invoke(o)
};
ZaAlias.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table cellpadding='0' cellspacing='0' border='0'>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;width:350' >";
t[e++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
t[e++]=AjxImg.getImageHtml("AccountAlias");
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
var o=this.getAliasTargetObj();
if(o&&(this.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_ACCOUNT)){
e=this._addRow(ZaItem._attrDesc(ZaAlias.A_targetAccount),o.attrs[ZaAccount.A_displayname],t,e);
e=this._addRow(ZaMsg.NAD_AccountStatus,ZaAccount._accountStatus(o.attrs[ZaAccount.A_accountStatus]),t,e);
if(o.getAttrs[ZaAccount.A_mailHost]){
e=this._addRow(ZaMsg.NAD_MailServer,o.attrs[ZaAccount.A_mailHost],t,e)
}}else{
if(o&&(this.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_DL)){
e=this._addRow(ZaItem._attrDesc(ZaAlias.A_targetAccount),o.attrs[ZaAccount.A_displayname],t,e);
e=this._addRow(ZaMsg.NAD_AccountStatus,ZaDistributionList.getDLStatus(o.attrs[ZaDistributionList.A_mailStatus]),t,e)
}else{
if(o&&(this.attrs[ZaAlias.A_targetType]==ZaAlias.TARGET_TYPE_RESOURCE)){
e=this._addRow(ZaItem._attrDesc(ZaAlias.A_targetAccount),o.attrs[ZaAccount.A_displayname],t,e);
e=this._addRow(ZaMsg.NAD_AccountStatus,ZaResource.getAccountStatusLabel(o.attrs[ZaResource.A_accountStatus]),t,e);
if(o.getAttrs&&o.getAttrs[ZaResource.A_mailHost]){
e=this._addRow(ZaMsg.NAD_MailServer,o.attrs[ZaResource.A_mailHost],t,e)
}}}}
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaAlias.myXModel={
items:[{
id:"getAttrs",type:_LIST_}
,{
id:"setAttrs",type:_LIST_}
,{
id:"rights",type:_LIST_}
,{
id:ZaAccount.A_name,type:_STRING_,ref:"name",constraints:{
type:"method",value:function(n,t,o,e){
if(n){
if(AjxUtil.isValidEmailNonReg(n)){
return n
}else{
throw ZaMsg.ErrorInvalidEmailAddress
}}}}}
,{
id:ZaAlias.A_AliasTargetId,type:_STRING_,ref:ZaAlias.A_AliasTargetId}
,{
id:ZaAlias.A_targetType,type:_STRING_,ref:ZaAlias.A_targetType}
,{
id:ZaAlias.A_targetAccount,ref:ZaAlias.A_targetAccount}
,{
id:ZaAlias.A_index,type:_NUMBER_,ref:ZaAlias.A_index}
]};
ZaAlias.prototype.addAlias=function(r){
var e=r.getInstance();
var s=e[ZaAccount.A_name];
var n=e[ZaAlias.A_targetAccount];
try{
var o;
var h=ZaAlias.TARGET_TYPE_ACCOUNT;
try{
o=ZaAlias.getTargetByName(n,h)
}
catch(t){
if(t.code==ZmCsfeException.ACCT_NO_SUCH_ACCOUNT){
h=ZaAlias.TARGET_TYPE_DL;
o=ZaAlias.getTargetByName(n,h)
}else{
throw t
}}
o.addAlias(s);
this.targetObj=o;
ZaApp.getInstance().getAccountViewController(true).fireCreationEvent(this);
r.parent.popdown();
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.AliasCreated,[s]))
}
catch(t){
if(t.code==ZmCsfeException.ACCT_EXISTS){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.WARNING_ALIAS_EXISTS,[s])+"<BR />"+t.msg)
}else{
if(t.code==ZmCsfeException.NO_SUCH_DISTRIBUTION_LIST||t.code==ZmCsfeException.ACCT_NO_SUCH_ACCOUNT){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.WARNING_ALIASES_TARGET_NON_EXIST,[n]))
}else{
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaAlias.prototype.addAlias",null,false)
}}}};
ZaAlias.getTargetByName=function(t,e){
var l;
var c;
if(e==ZaAlias.TARGET_TYPE_DL){
l=AjxSoapDoc.create("GetDistributionListRequest",ZaZimbraAdmin.URN,null);
c=l.set("dl",t)
}else{
if(e==ZaAlias.TARGET_TYPE_ACCOUNT){
l=AjxSoapDoc.create("GetAccountRequest",ZaZimbraAdmin.URN,null);
c=l.set("account",t)
}else{
throw new Error("Alias type "+e+" is not valid.")
}}
l.getMethod().setAttribute("applyCos","0");
c.setAttribute("by","name");
var n=new Object();
n.soapDoc=l;
var o={
controller:ZaApp.getInstance().getCurrentController()};
var h=ZaRequestMgr.invoke(n,o).Body;
var s;
var r;
if(e==ZaAlias.TARGET_TYPE_DL){
s=h.GetDistributionListResponse.dl[0];
r=new ZaDistributionList()
}else{
if(e==ZaAlias.TARGET_TYPE_ACCOUNT){
s=h.GetAccountResponse.account[0];
r=new ZaAccount()
}}
r.attrs=new Object();
r.initFromJS(s);
return r
};
ZaAlias.prototype.getAliasTargetObj=function(){
var t;
var n=this.attrs[ZaAlias.A_targetType];
var o=this.attrs[ZaAlias.A_targetAccount];
var e=this.attrs[ZaAlias.A_AliasTargetId];
if(n==ZaAlias.TARGET_TYPE_DL){
t=new ZaDistributionList(e,o)
}else{
if(n==ZaAlias.TARGET_TYPE_ACCOUNT){
t=new ZaAccount()
}else{
if(n==ZaAlias.TARGET_TYPE_RESOURCE){
t=new ZaResource()
}else{
throw new Error("Alias type "+n+" is not valid.")
}}}
t.load("name",o,false,true);
return t
};
ZaAlias.prototype.initEffectiveRightsFromJS=function(n){
if(!this.targetObj){
var o=this.attrs[ZaAlias.A_targetType];
var t=this.attrs[ZaAlias.A_targetAccount];
var e=this.attrs[ZaAlias.A_AliasTargetId];
if(o==ZaAlias.TARGET_TYPE_DL){
this.targetObj=new ZaDistributionList(e,t)
}else{
if(o==ZaAlias.TARGET_TYPE_ACCOUNT){
this.targetObj=new ZaAccount();
this.targetObj.id=e;
this.targetObj.name=t;
if(!this.targetObj.attrs){
this.targetObj.attrs={}
}
this.targetObj.attrs[ZaItem.A_cn]=t;
this.targetObj.attrs[ZaItem.A_zimbraId]=e
}}}
this.targetObj.initEffectiveRightsFromJS(n)
}
}
if(AjxPackage.define("zimbraAdmin.accounts.model.ZaForwardingAddress")){
ZaForwardingAddress=function(){
ZaItem.call(this,ZaEvent.S_ACCOUNT);
this.attrs=new Object();
this.id="";
this.name=""
};
ZaForwardingAddress.prototype=new ZaItem;
ZaForwardingAddress.prototype.constructor=ZaForwardingAddress
}
if(AjxPackage.define("zimbraAdmin.accounts.model.ZaFp")){
ZaFp=function(){
ZaItem.call(this,ZaEvent.S_ACCOUNT);
this.attrs=new Object();
this.name="";
this.prefix=""
};
ZaFp.prototype=new ZaItem;
ZaFp.prototype.constructor=ZaFp;
ZaFp.A_name="name";
ZaFp.A_index="index";
ZaFp.A_prefix="prefix";
ZaFp.INTEROP_PROVIDER_CHOICES=[];
ZaFp.getXModel=function(){
var e={
items:[{
id:"getAttrs",type:_LIST_}
,{
id:"setAttrs",type:_LIST_}
,{
id:"rights",type:_LIST_}
,{
id:ZaFp.A_name,type:_STRING_,ref:ZaFp.A_name}
,{
id:ZaFp.A_index,type:_NUMBER_,ref:ZaFp.A_index}
,{
id:ZaFp.A_prefix,type:_STRING_,ref:ZaFp.A_prefix}
]};
return e
};
ZaFp.getObject=function(t){
var n={};
var o=false;
for(var e=0;
e<ZaFp.INTEROP_PROVIDER_CHOICES.length;
e++){
if(t.indexOf(ZaFp.INTEROP_PROVIDER_CHOICES[e].value)==0){
n[ZaFp.A_prefix]=ZaFp.INTEROP_PROVIDER_CHOICES[e].value;
n[ZaFp.A_name]=t.substr(ZaFp.INTEROP_PROVIDER_CHOICES[e].value.length);
o=true;
break
}}
if(!o){
n[ZaFp.A_name]=t
}
return n
};
ZaFp.getEntry=function(t){
var e="";
if(t!=null){
e=(t[ZaFp.A_prefix]||"")+(t[ZaFp.A_name]||"")
}
return e
};
ZaFp.push=function(s){
var o=AjxSoapDoc.create("PushFreeBusyRequest",ZaZimbraAdmin.URN,null);
var n=o.set("account","");
n.setAttribute("id",s);
try{
params=new Object();
params.soapDoc=o;
var t={
controller:ZaApp.getInstance().getCurrentController(),asyncMode:false,busyMsg:ZaMsg.BUSY_PUSH_FP};
resp=ZaRequestMgr.invoke(params,t).Body.PushFreeBusyResponse;
ZaApp.getInstance().getCurrentController().popupMsgDialog(ZaMsg.PUSH_SUCCEED,true)
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaFp.push",null,false)
}};
ZaFp.getProviders=function(){
var n=AjxSoapDoc.create("GetAllFreeBusyProvidersRequest",ZaZimbraAdmin.URN,null);
try{
params=new Object();
params.soapDoc=n;
var o={
controller:ZaApp.getInstance().getCurrentController(),asyncMode:false,busyMsg:ZaMsg.BUSY_GET_INTEROP_PROVIDERS};
var r=ZaRequestMgr.invoke(params,o).Body.GetAllFreeBusyProvidersResponse;
ZaFp.INTEROP_PROVIDER_CHOICES=[];
var s=r.provider;
if(s!=null){
for(var t=0;
t<s.length;
t++){
ZaFp.INTEROP_PROVIDER_CHOICES.push({
value:s[t].prefix,label:s[t].name}
)
}}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaFp.push",null,false)
}};
ZaFp.findDupPrefixFp=function(e,o){
for(var t=0;
t<e.length;
t++){
if(e[t].indexOf(o)==0){
return true
}}
return false
}
}
if(AjxPackage.define("zimbraAdmin.cos.model.ZaCos")){
ZaCos=function(){
ZaItem.call(this,"ZaCos");
this._init()
};
ZaItem.loadMethods.ZaCos=new Array();
ZaItem.modifyMethods.ZaCos=new Array();
ZaItem.initMethods.ZaCos=new Array();
ZaItem.getRelatedMethods.ZaCos=new Array();
ZaCos.prototype=new ZaItem;
ZaCos.prototype.constructor=ZaCos;
ZaCos.NONE="none";
ZaCos.A_zimbraNotes="zimbraNotes";
ZaCos.A_zimbraMailQuota="zimbraMailQuota";
ZaCos.A_zimbraMinPwdLength="zimbraPasswordMinLength";
ZaCos.A_zimbraMaxPwdLength="zimbraPasswordMaxLength";
ZaCos.A_zimbraPasswordMinUpperCaseChars="zimbraPasswordMinUpperCaseChars";
ZaCos.A_zimbraPasswordMinLowerCaseChars="zimbraPasswordMinLowerCaseChars";
ZaCos.A_zimbraPasswordMinPunctuationChars="zimbraPasswordMinPunctuationChars";
ZaCos.A_zimbraPasswordMinNumericChars="zimbraPasswordMinNumericChars";
ZaCos.A_zimbraPasswordMinDigitsOrPuncs="zimbraPasswordMinDigitsOrPuncs";
ZaCos.A_zimbraMinPwdAge="zimbraPasswordMinAge";
ZaCos.A_zimbraMaxPwdAge="zimbraPasswordMaxAge";
ZaCos.A_zimbraEnforcePwdHistory="zimbraPasswordEnforceHistory";
ZaCos.A_zimbraPasswordLocked="zimbraPasswordLocked";
ZaCos.A_name="cn";
ZaCos.A_description="description";
ZaCos.A_zimbraAttachmentsBlocked="zimbraAttachmentsBlocked";
ZaCos.A_zimbraQuotaWarnPercent="zimbraQuotaWarnPercent";
ZaCos.A_zimbraQuotaWarnInterval="zimbraQuotaWarnInterval";
ZaCos.A_zimbraQuotaWarnMessage="zimbraQuotaWarnMessage";
ZaCos.A_zimbraAdminAuthTokenLifetime="zimbraAdminAuthTokenLifetime";
ZaCos.A_zimbraAuthTokenLifetime="zimbraAuthTokenLifetime";
ZaCos.A_zimbraMailIdleSessionTimeout="zimbraMailIdleSessionTimeout";
ZaCos.A_zimbraContactMaxNumEntries="zimbraContactMaxNumEntries";
ZaCos.A_zimbraMailMinPollingInterval="zimbraMailMinPollingInterval";
ZaCos.A_zimbraMailMessageLifetime="zimbraMailMessageLifetime";
ZaCos.A_zimbraMailTrashLifetime="zimbraMailTrashLifetime";
ZaCos.A_zimbraMailSpamLifetime="zimbraMailSpamLifetime";
ZaCos.A_zimbraMailHostPool="zimbraMailHostPool";
ZaCos.A_zimbraAvailableSkin="zimbraAvailableSkin";
ZaCos.A_zimbraZimletAvailableZimlets="zimbraZimletAvailableZimlets";
ZaCos.A_zimbraMailForwardingAddressMaxLength="zimbraMailForwardingAddressMaxLength";
ZaCos.A_zimbraMailForwardingAddressMaxNumAddrs="zimbraMailForwardingAddressMaxNumAddrs";
ZaCos.A_zimbraPrefItemsPerVirtualPage="zimbraPrefItemsPerVirtualPage",ZaCos.A_zimbraDataSourceMinPollingInterval="zimbraDataSourceMinPollingInterval";
ZaCos.A_zimbraDataSourcePop3PollingInterval="zimbraDataSourcePop3PollingInterval";
ZaCos.A_zimbraDataSourceImapPollingInterval="zimbraDataSourceImapPollingInterval";
ZaCos.A_zimbraDataSourceCalendarPollingInterval="zimbraDataSourceCalendarPollingInterval";
ZaCos.A_zimbraDataSourceRssPollingInterval="zimbraDataSourceRssPollingInterval";
ZaCos.A_zimbraDataSourceCaldavPollingInterval="zimbraDataSourceCaldavPollingInterval";
ZaCos.A_zimbraProxyAllowedDomains="zimbraProxyAllowedDomains";
ZaCos.A_zimbraPrefMandatorySpellCheckEnabled="zimbraPrefMandatorySpellCheckEnabled";
ZaCos.A_zimbraPrefAppleIcalDelegationEnabled="zimbraPrefAppleIcalDelegationEnabled";
ZaCos.A_zimbraPrefCalendarShowPastDueReminders="zimbraPrefCalendarShowPastDueReminders";
ZaCos.A_zimbraPrefCalendarToasterEnabled="zimbraPrefCalendarToasterEnabled";
ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf="zimbraPrefCalendarAllowCancelEmailToSelf";
ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite="zimbraPrefCalendarAllowPublishMethodInvite";
ZaCos.A_zimbraPrefCalendarAllowForwardedInvite="zimbraPrefCalendarAllowForwardedInvite";
ZaCos.A_zimbraPrefCalendarReminderFlashTitle="zimbraPrefCalendarReminderFlashTitle";
ZaCos.A_zimbraPrefCalendarReminderSoundsEnabled="zimbraPrefCalendarReminderSoundsEnabled";
ZaCos.A_zimbraPrefCalendarSendInviteDeniedAutoReply="zimbraPrefCalendarSendInviteDeniedAutoReply";
ZaCos.A_zimbraPrefCalendarAutoAddInvites="zimbraPrefCalendarAutoAddInvites";
ZaCos.A_zimbraPrefCalendarApptVisibility="zimbraPrefCalendarApptVisibility";
ZaCos.A_zimbraPrefCalendarNotifyDelegatedChanges="zimbraPrefCalendarNotifyDelegatedChanges";
ZaCos.A_zimbraPrefCalendarInitialView="zimbraPrefCalendarInitialView";
ZaCos.A_zimbraPrefClientType="zimbraPrefClientType";
ZaCos.A_zimbraPrefTimeZoneId="zimbraPrefTimeZoneId";
ZaCos.A_zimbraAllowAnyFromAddress="zimbraAllowAnyFromAddress";
ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal="zimbraPrefCalendarAlwaysShowMiniCal";
ZaCos.A_zimbraPrefCalendarUseQuickAdd="zimbraPrefCalendarUseQuickAdd";
ZaCos.A_zimbraPrefGroupMailBy="zimbraPrefGroupMailBy";
ZaCos.A_zimbraPrefIncludeSpamInSearch="zimbraPrefIncludeSpamInSearch";
ZaCos.A_zimbraPrefIncludeTrashInSearch="zimbraPrefIncludeTrashInSearch";
ZaCos.A_zimbraPrefMailInitialSearch="zimbraPrefMailInitialSearch";
ZaCos.A_zimbraMaxMailItemsPerPage="zimbraMaxMailItemsPerPage";
ZaCos.A_zimbraPrefMailItemsPerPage="zimbraPrefMailItemsPerPage";
ZaCos.A_zimbraPrefMailPollingInterval="zimbraPrefMailPollingInterval";
ZaCos.A_zimbraPrefAutoSaveDraftInterval="zimbraPrefAutoSaveDraftInterval";
ZaCos.A_zimbraPrefMailFlashTitle="zimbraPrefMailFlashTitle";
ZaCos.A_zimbraPrefMailFlashIcon="zimbraPrefMailFlashIcon";
ZaCos.A_zimbraPrefMailSoundsEnabled="zimbraPrefMailSoundsEnabled";
ZaCos.A_zimbraPrefMailToasterEnabled="zimbraPrefMailToasterEnabled";
ZaCos.A_zimbraPrefMessageIdDedupingEnabled="zimbraPrefMessageIdDedupingEnabled";
ZaCos.A_zimbraPrefUseKeyboardShortcuts="zimbraPrefUseKeyboardShortcuts";
ZaCos.A_zimbraPrefSaveToSent="zimbraPrefSaveToSent";
ZaCos.A_zimbraPrefComposeInNewWindow="zimbraPrefComposeInNewWindow";
ZaCos.A_zimbraPrefForwardReplyInOriginalFormat="zimbraPrefForwardReplyInOriginalFormat";
ZaCos.A_zimbraPrefAutoAddAddressEnabled="zimbraPrefAutoAddAddressEnabled";
ZaCos.A_zimbraPrefComposeFormat="zimbraPrefComposeFormat";
ZaCos.A_zimbraPrefMessageViewHtmlPreferred="zimbraPrefMessageViewHtmlPreferred";
ZaCos.A_zimbraPrefShowSearchString="zimbraPrefShowSearchString";
ZaCos.A_zimbraPrefUseTimeZoneListInCalendar="zimbraPrefUseTimeZoneListInCalendar";
ZaCos.A_zimbraPrefImapSearchFoldersEnabled="zimbraPrefImapSearchFoldersEnabled";
ZaCos.A_zimbraPrefCalendarApptReminderWarningTime="zimbraPrefCalendarApptReminderWarningTime";
ZaCos.A_zimbraPrefSkin="zimbraPrefSkin";
ZaCos.A_zimbraPrefGalAutoCompleteEnabled="zimbraPrefGalAutoCompleteEnabled";
ZaCos.A_zimbraPrefWarnOnExit="zimbraPrefWarnOnExit";
ZaCos.A_zimbraPrefShowSelectionCheckbox="zimbraPrefShowSelectionCheckbox";
ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily="zimbraPrefHtmlEditorDefaultFontFamily";
ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize="zimbraPrefHtmlEditorDefaultFontSize";
ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor="zimbraPrefHtmlEditorDefaultFontColor";
ZaCos.A_zimbraMailSignatureMaxLength="zimbraMailSignatureMaxLength";
ZaCos.A_zimbraPrefDisplayExternalImages="zimbraPrefDisplayExternalImages";
ZaCos.A_zimbraPrefOutOfOfficeCacheDuration="zimbraPrefOutOfOfficeCacheDuration";
ZaCos.A_zimbraPrefMailDefaultCharset="zimbraPrefMailDefaultCharset";
ZaCos.A_zimbraPrefLocale="zimbraPrefLocale";
ZaCos.A_zimbraJunkMessagesIndexingEnabled="zimbraJunkMessagesIndexingEnabled";
ZaCos.A_zimbraPrefMailSendReadReceipts="zimbraPrefMailSendReadReceipts";
ZaCos.A_zimbraPrefAdminConsoleWarnOnExit="zimbraPrefAdminConsoleWarnOnExit";
ZaCos.A_zimbraFeatureExportFolderEnabled="zimbraFeatureExportFolderEnabled";
ZaCos.A_zimbraFeatureImportFolderEnabled="zimbraFeatureImportFolderEnabled";
ZaCos.A_zimbraDumpsterEnabled="zimbraDumpsterEnabled";
ZaCos.A_zimbraMailDumpsterLifetime="zimbraMailDumpsterLifetime";
ZaCos.A_zimbraDumpsterUserVisibleAge="zimbraDumpsterUserVisibleAge";
ZaCos.A_zimbraDumpsterPurgeEnabled="zimbraDumpsterPurgeEnabled";
ZaCos.A_zimbraPrefCalendarFirstDayOfWeek="zimbraPrefCalendarFirstDayOfWeek";
ZaCos.A_zimbraFeatureReadReceiptsEnabled="zimbraFeatureReadReceiptsEnabled";
ZaCos.A_zimbraFeatureMailPriorityEnabled="zimbraFeatureMailPriorityEnabled";
ZaCos.A_zimbraFeatureImapDataSourceEnabled="zimbraFeatureImapDataSourceEnabled";
ZaCos.A_zimbraFeaturePop3DataSourceEnabled="zimbraFeaturePop3DataSourceEnabled";
ZaCos.A_zimbraFeatureIdentitiesEnabled="zimbraFeatureIdentitiesEnabled";
ZaCos.A_zimbraFeatureContactsEnabled="zimbraFeatureContactsEnabled";
ZaCos.A_zimbraFeatureCalendarEnabled="zimbraFeatureCalendarEnabled";
ZaCos.A_zimbraFeatureTasksEnabled="zimbraFeatureTasksEnabled";
ZaCos.A_zimbraFeatureTaggingEnabled="zimbraFeatureTaggingEnabled";
ZaCos.A_zimbraFeaturePeopleSearchEnabled="zimbraFeaturePeopleSearchEnabled";
ZaCos.A_zimbraFeatureAdvancedSearchEnabled="zimbraFeatureAdvancedSearchEnabled";
ZaCos.A_zimbraFeatureSavedSearchesEnabled="zimbraFeatureSavedSearchesEnabled";
ZaCos.A_zimbraFeatureConversationsEnabled="zimbraFeatureConversationsEnabled";
ZaCos.A_zimbraFeatureChangePasswordEnabled="zimbraFeatureChangePasswordEnabled";
ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled="zimbraFeatureInitialSearchPreferenceEnabled";
ZaCos.A_zimbraFeatureFiltersEnabled="zimbraFeatureFiltersEnabled";
ZaCos.A_zimbraFeatureGalEnabled="zimbraFeatureGalEnabled";
ZaCos.A_zimbraFeatureMAPIConnectorEnabled="zimbraFeatureMAPIConnectorEnabled";
ZaCos.A_zimbraFeatureEwsEnabled="zimbraFeatureEwsEnabled";
ZaCos.A_zimbraFeatureTouchClientEnabled="zimbraFeatureTouchClientEnabled";
ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled="zimbraFeatureWebClientOfflineAccessEnabled";
ZaCos.A_zimbraFeatureMailForwardingEnabled="zimbraFeatureMailForwardingEnabled";
ZaCos.A_zimbraFeatureMailSendLaterEnabled="zimbraFeatureMailSendLaterEnabled";
ZaCos.A_zimbraFeatureSharingEnabled="zimbraFeatureSharingEnabled";
ZaCos.A_zimbraExternalSharingEnabled="zimbraExternalSharingEnabled";
ZaCos.A_zimbraPublicSharingEnabled="zimbraPublicSharingEnabled";
ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled="zimbraFeatureCalendarReminderDeviceEmailEnabled";
ZaCos.A_zimbraFeatureBriefcasesEnabled="zimbraFeatureBriefcasesEnabled";
ZaCos.A_zimbraFeatureBriefcaseDocsEnabled="zimbraFeatureBriefcaseDocsEnabled";
ZaCos.A_zimbraImapEnabled="zimbraImapEnabled";
ZaCos.A_zimbraPop3Enabled="zimbraPop3Enabled";
ZaCos.A_zimbraFeatureHtmlComposeEnabled="zimbraFeatureHtmlComposeEnabled";
ZaCos.A_zimbraFeatureGalAutoCompleteEnabled="zimbraFeatureGalAutoCompleteEnabled";
ZaCos.A_zimbraFeatureManageZimlets="zimbraFeatureManageZimlets";
ZaCos.A_zimbraFeatureSkinChangeEnabled="zimbraFeatureSkinChangeEnabled";
ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled="zimbraFeatureOutOfOfficeReplyEnabled";
ZaCos.A_zimbraFeatureNewMailNotificationEnabled="zimbraFeatureNewMailNotificationEnabled";
ZaCos.A_zimbraFeatureOptionsEnabled="zimbraFeatureOptionsEnabled";
ZaCos.A_zimbraFeatureMailEnabled="zimbraFeatureMailEnabled";
ZaCos.A_zimbraFeatureGroupCalendarEnabled="zimbraFeatureGroupCalendarEnabled";
ZaCos.A_zimbraFeatureFlaggingEnabled="zimbraFeatureFlaggingEnabled";
ZaCos.A_zimbraFeatureManageSMIMECertificateEnabled="zimbraFeatureManageSMIMECertificateEnabled";
ZaCos.A_zimbraFeatureSMIMEEnabled="zimbraFeatureSMIMEEnabled";
ZaCos.A_zimbraFeatureDistributionListFolderEnabled="zimbraFeatureDistributionListFolderEnabled";
ZaCos.A_zimbraPasswordLockoutEnabled="zimbraPasswordLockoutEnabled";
ZaCos.A_zimbraPasswordLockoutDuration="zimbraPasswordLockoutDuration";
ZaCos.A_zimbraPasswordLockoutMaxFailures="zimbraPasswordLockoutMaxFailures";
ZaCos.A_zimbraPasswordLockoutFailureLifetime="zimbraPasswordLockoutFailureLifetime";
ZaCos.A_zimbraNumFileVersionsToKeep="zimbraNumFileVersionsToKeep";
ZaCos.A_zimbraUnaccessedFileLifetime="zimbraUnaccessedFileLifetime";
ZaCos.A_zimbraFileTrashLifetime="zimbraFileTrashLifetime";
ZaCos.A_zimbraFileSendExpirationWarning="zimbraFileSendExpirationWarning";
ZaCos.A_zimbraFileExpirationWarningDays="zimbraFileExpirationWarningDays";
ZaCos.A2_retentionPoliciesKeepInherited="retentionPoliciesKeepInherited";
ZaCos.A2_retentionPoliciesKeep="retentionPolicyKeep";
ZaCos.A2_retentionPoliciesPurge="retentionPolicyPurge";
ZaCos.A2_retentionPoliciesKeep_Selection="retentionPoliciesKeep_Selection";
ZaCos.A2_retentionPoliciesPurge_Selection="retentionPoliciesPurge_Selection";
ZaCos.RIGHT_LIST_COS="listCos";
ZaCos.RIGHT_LIST_ZIMLET="listZimlet";
ZaCos.RIGHT_GET_ZIMLET="getZimlet";
ZaCos.RIGHT_GET_HOSTNAME="zimbraVirtualHostname";
ZaCos.A_zimbraFreebusyExchangeUserOrg="zimbraFreebusyExchangeUserOrg";
ZaCos.cacheCounter=0;
ZaCos.staticCosByNameCacheTable={};
ZaCos.staticCosByIdCacheTable={};
ZaCos.putCosToCache=function(e){
if(ZaCos.cacheCounter==100){
ZaCos.staticCosByNameCacheTable={};
ZaCos.staticCosByIdCacheTable={};
ZaCos.cacheCounter=0
}
if(!ZaCos.staticCosByNameCacheTable[e.name]||!ZaCos.staticCosByIdCacheTable[e.id]){
ZaCos.cacheCounter++;
ZaCos.staticCosByNameCacheTable[e.name]=e;
ZaCos.staticCosByIdCacheTable[e.id]=e
}};
ZaCos.MAJOR_FEATURES_CHOICES=[{
value:ZaCos.A_zimbraFeatureMailEnabled,label:ZaMsg.NAD_zimbraFeatureMailEnabled}
,{
value:ZaCos.A_zimbraFeatureContactsEnabled,label:ZaMsg.NAD_FeatureContactsEnabled}
,{
value:ZaCos.A_zimbraFeatureCalendarEnabled,label:ZaMsg.NAD_FeatureCalendarEnabled}
,{
value:ZaCos.A_zimbraFeatureTasksEnabled,label:ZaMsg.NAD_FeatureTaskEnabled}
,{
value:ZaCos.A_zimbraFeatureBriefcasesEnabled,label:ZaMsg.NAD_zimbraFeatureBriefcasesEnabled}
,{
value:ZaCos.A_zimbraFeatureOptionsEnabled,label:ZaMsg.NAD_zimbraFeatureOptionsEnabled}
];
ZaCos.RENAME_COS_RIGHT="renameCos";
ZaCos.CREATE_COS_RIGHT="createCos";
ZaCos.DELETE_COS_RIGHT="deleteCos";
ZaCos.initMethod=function(){
this.attrs=new Object();
this.id="";
this.name="";
this.type=ZaItem.COS
};
ZaItem.initMethods.ZaCos.push(ZaCos.initMethod);
ZaCos.loadMethod=function(s,l){
var o=AjxSoapDoc.create("GetCosRequest",ZaZimbraAdmin.URN,null);
var t=o.set("cos",l);
t.setAttribute("by",s);
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
o.getMethod().setAttribute("attrs",this.attrsToGet.join(","))
}
var h=new Object();
h.soapDoc=o;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_COS};
var r=ZaRequestMgr.invoke(h,e).Body.GetCosResponse;
this.initFromJS(r.cos[0]);
if(this.name){
this.name=AjxStringUtil.htmlEncode(this.name)
}
if(this.attrs[ZaCos.A_name]){
this.attrs[ZaCos.A_name]=AjxStringUtil.htmlEncode(this.attrs[ZaCos.A_name])
}
if(this.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]){
var n=ZaUtil.getLifeTimeInSeconds(this.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]);
if(n>=1){
this.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]=n+"s"
}}
if(this.attrs[ZaCos.A_zimbraProxyAllowedDomains]&&(!(this.attrs[ZaCos.A_zimbraProxyAllowedDomains] instanceof Array))){
this.attrs[ZaCos.A_zimbraProxyAllowedDomains]=[this.attrs[ZaCos.A_zimbraProxyAllowedDomains]]
}};
ZaItem.loadMethods.ZaCos.push(ZaCos.loadMethod);
ZaCos.prototype.refresh=function(){
this.load("name",this.name)
};
ZaCos.prototype.initFromJS=function(e){
ZaItem.prototype.initFromJS.call(this,e);
if(typeof(this.attrs[ZaCos.A_zimbraMailHostPool])=="string"){
this.attrs[ZaCos.A_zimbraMailHostPool]=[this.attrs[ZaCos.A_zimbraMailHostPool]]
}};
ZaCos.prototype.create=function(e,d){
var c=AjxSoapDoc.create("CreateCosRequest",ZaZimbraAdmin.URN,null);
c.set("name",e);
for(var l in d){
if(d[l] instanceof Array){
var o=d[l].length;
if(o){
for(var n=0;
n<o;
n++){
if(d[l][n] instanceof String){
var h=c.set("a",d[l][n].toString())
}else{
if(d[l][n] instanceof Object){
var h=c.set("a",d[l][n].toString())
}else{
var h=c.set("a",d[l][n])
}}
h.setAttribute("n",l)
}}}else{
if(d[l]&&(d[l].length||!isNaN(d[l]))){
var h=c.set("a",d[l]);
h.setAttribute("n",l)
}}}
var r=new Object();
r.soapDoc=c;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_COS};
var s=ZaRequestMgr.invoke(r,t).Body.CreateCosResponse;
this.initFromJS(s.cos[0])
};
ZaCos.prototype.rename=function(e){
var o=AjxSoapDoc.create("RenameCosRequest",ZaZimbraAdmin.URN,null);
o.set("id",this.id);
o.set("newName",AjxStringUtil.htmlEncode(e));
var s=new Object();
s.soapDoc=o;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_RENAME_COS};
var n=ZaRequestMgr.invoke(s,t).Body.RenameCosResponse;
this.initFromJS(n.cos[0])
};
ZaCos.prototype.remove=function(n){
var t=AjxSoapDoc.create("DeleteCosRequest",ZaZimbraAdmin.URN,null);
t.set("id",this.id);
var o=new Object();
o.soapDoc=t;
o.soapDoc=t;
if(n){
o.asyncMode=true;
o.callback=n
}
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_DELETE_COS};
ZaRequestMgr.invoke(o,e)
};
ZaCos.modifyMethod=function(u){
var d=false;
var c=AjxSoapDoc.create("ModifyCosRequest",ZaZimbraAdmin.URN,null);
c.set("id",this.id);
for(var l in u){
d=true;
if(l===ZaCos.A_name){
u[l]=AjxStringUtil.htmlEncode(u[l])
}
if(u[l] instanceof Array){
var t=u[l].length;
if(t){
var n=false;
for(var o=0;
o<t;
o++){
var h=null;
if(u[l][o] instanceof String||AjxUtil.isString(u[l][o])){
if(AjxUtil.isEmpty(u[l][o])){
continue
}else{
n=true
}
var h=c.set("a",u[l][o].toString())
}else{
if(u[l][o] instanceof Object){
var h=c.set("a",u[l][o].toString());
n=true
}else{
var h=c.set("a",u[l][o]);
n=true
}}
if(h){
h.setAttribute("n",l)
}}
if(!n){
var h=c.set("a","");
h.setAttribute("n",l)
}}else{
var h=c.set("a","");
h.setAttribute("n",l)
}}else{
var h=c.set("a",u[l]);
h.setAttribute("n",l)
}}
if(!d){
return
}
var r=new Object();
r.soapDoc=c;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_COS};
var s=ZaRequestMgr.invoke(r,e).Body.ModifyCosResponse;
this.initFromJS(s.cos[0]);
ZaCos.putCosToCache(this)
};
ZaItem.modifyMethods.ZaCos.push(ZaCos.modifyMethod);
ZaCos.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table cellpadding='0' cellspacing='0' border='0'>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;'>";
t[e++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
t[e++]=AjxImg.getImageHtml("COS");
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
e=this._addAttrRow(ZaItem.A_description,t,e);
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaCos.getAll=function(){
var t=AjxSoapDoc.create("GetAllCosRequest",ZaZimbraAdmin.URN,null);
var s=new Object();
s.soapDoc=t;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_COS};
var n=ZaRequestMgr.invoke(s,e).Body.GetAllCosResponse;
var o=new ZaItemList(ZaCos);
o.loadFromJS(n);
return o
};
ZaCos.getCosChoices=function(){
if(ZaCos.cosChoices){
return ZaCos.cosChoices
}else{
ZaCos.cosChoices=new XFormChoices
}};
ZaCos.getDefaultCos4Account=function(l,e){
var o;
var d;
if(!l){
return o
}
var t=ZaAccount.getDomain(l);
var s;
var n;
try{
n=ZaDomain.getDomainByName(t)
}
catch(h){
n=undefined
}
if(n){
s=e?n.attrs[ZaDomain.A_domainDefaultExternalUserCOSId]:n.attrs[ZaDomain.A_domainDefaultCOSId];
var r=e?"defaultExternal":"default";
if(!s){
var c=ZaCos.getCosByName(r);
return c
}else{
var c=ZaCos.getCosById(s);
if(!c){
c=ZaCos.getCosByName(r)
}
return c
}}else{
return null
}};
ZaCos.getCosByName=function(e){
if(!e){
return null
}
var o=ZaCos.staticCosByNameCacheTable[e];
if(!o){
o=new ZaCos();
try{
o.load("name",e)
}
catch(t){
if(t.code==ZmCsfeException.NO_SUCH_COS){
return null
}else{
throw (t)
}}
ZaCos.putCosToCache(o)
}
return o
};
ZaCos.getCosById=function(e){
if(!e){
return null
}
var o=ZaCos.staticCosByIdCacheTable[e];
if(!o){
o=new ZaCos();
try{
o.load("id",e)
}
catch(t){
if(t.code==ZmCsfeException.NO_SUCH_COS){
return null
}else{
throw (t)
}}
ZaCos.putCosToCache(o)
}
return o
};
ZaCos.myXModel={
items:[{
id:"getAttrs",type:_LIST_}
,{
id:"setAttrs",type:_LIST_}
,{
id:"rights",type:_LIST_}
,{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:ZaItem.A_zimbraCreateTimestamp,ref:"attrs/"+ZaItem.A_zimbraCreateTimestamp}
,{
id:ZaCos.A_zimbraMailHostPool,ref:"attrs/"+ZaCos.A_zimbraMailHostPool,type:_LIST_,dataType:_STRING_,outputType:_LIST_}
,{
id:ZaCos.A_zimbraNotes,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraNotes}
,{
id:ZaCos.A_zimbraMailQuota,type:_MAILQUOTA_,ref:"attrs."+ZaCos.A_zimbraMailQuota}
,{
id:ZaCos.A_zimbraMinPwdLength,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMinPwdLength,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraMaxPwdLength,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMaxPwdLength,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPasswordMinUpperCaseChars,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPasswordMinUpperCaseChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPasswordMinLowerCaseChars,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPasswordMinLowerCaseChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPasswordMinPunctuationChars,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPasswordMinPunctuationChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPasswordMinNumericChars,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPasswordMinNumericChars,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPasswordMinDigitsOrPuncs,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPasswordMinDigitsOrPuncs,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraMinPwdAge,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMinPwdAge,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraMaxPwdAge,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMaxPwdAge,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraEnforcePwdHistory,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraEnforcePwdHistory,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPasswordLocked,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPasswordLocked}
,{
id:ZaCos.A_name,type:_STRING_,ref:"attrs/"+ZaCos.A_name}
,ZaItem.descriptionModelItem,{
id:ZaCos.A_zimbraAttachmentsBlocked,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraAttachmentsBlocked}
,{
id:ZaCos.A_zimbraAuthTokenLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraAuthTokenLifetime,required:true}
,{
id:ZaCos.A_zimbraAdminAuthTokenLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraAdminAuthTokenLifetime,required:true}
,{
id:ZaCos.A_zimbraMailIdleSessionTimeout,type:_MINTERVAL_,ref:"attrs/"+ZaCos.A_zimbraMailIdleSessionTimeout}
,{
id:ZaCos.A_zimbraContactMaxNumEntries,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraContactMaxNumEntries,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraMailForwardingAddressMaxLength,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMailForwardingAddressMaxLength,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraMailForwardingAddressMaxNumAddrs,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMailForwardingAddressMaxNumAddrs,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraMailMinPollingInterval,type:_MINTERVAL_,ref:"attrs/"+ZaCos.A_zimbraMailMinPollingInterval}
,{
id:ZaCos.A_zimbraMailMessageLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraMailMessageLifetime}
,{
id:ZaCos.A_zimbraMailTrashLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraMailTrashLifetime}
,{
id:ZaCos.A_zimbraPrefItemsPerVirtualPage,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPrefItemsPerVirtualPage}
,{
id:ZaCos.A_zimbraMailSpamLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraMailSpamLifetime}
,{
id:ZaCos.A_zimbraQuotaWarnPercent,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraQuotaWarnPercent}
,{
id:ZaCos.A_zimbraQuotaWarnInterval,type:_MINTERVAL_,ref:"attrs/"+ZaCos.A_zimbraQuotaWarnInterval}
,{
id:ZaCos.A_zimbraQuotaWarnMessage,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraQuotaWarnMessage}
,{
id:ZaCos.A_zimbraPrefMandatorySpellCheckEnabled,types:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefMandatorySpellCheckEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,types:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarShowPastDueReminders,types:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarShowPastDueReminders,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarToasterEnabled,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarToasterEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarAllowForwardedInvite,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarAllowForwardedInvite,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarReminderFlashTitle,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarReminderFlashTitle,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarReminderSoundsEnabled,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarReminderSoundsEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarAutoAddInvites,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarAutoAddInvites,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarNotifyDelegatedChanges,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarNotifyDelegatedChanges,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefCalendarApptVisibility,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarApptVisibility,choices:ZaSettings.apptVisibilityChoices}
,{
id:ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,choices:ZaSettings.dayOfWeekChoices}
,{
id:ZaCos.A_zimbraPrefCalendarInitialView,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarInitialView,choices:ZaSettings.calendarViewChoinces}
,{
id:ZaCos.A_zimbraPrefClientType,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraPrefClientType,choices:ZaSettings.clientTypeChoices}
,{
id:ZaCos.A_zimbraPrefTimeZoneId,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraPrefTimeZoneId,choices:ZaSettings.timeZoneChoices}
,{
id:ZaCos.A_zimbraPrefGroupMailBy,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraPrefGroupMailBy}
,{
id:ZaCos.A_zimbraPrefIncludeSpamInSearch,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefIncludeSpamInSearch,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefIncludeTrashInSearch,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefIncludeTrashInSearch,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefMailInitialSearch,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraPrefMailInitialSearch}
,{
id:ZaCos.A_zimbraPrefUseKeyboardShortcuts,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefUseKeyboardShortcuts,type:_ENUM_}
,{
id:ZaCos.A_zimbraAllowAnyFromAddress,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraAllowAnyFromAddress,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefSaveToSent,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefSaveToSent,type:_ENUM_}
,{
id:ZaCos.A_zimbraMaxMailItemsPerPage,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMaxMailItemsPerPage,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPrefMailItemsPerPage,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPrefMailItemsPerPage,choices:[10,25,50,100]}
,{
id:ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,choices:ZaModel.FONT_FAMILY_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,choices:ZaModel.FONT_SIZE_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,ref:"attrs/"+ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,type:_STRING_}
,{
id:ZaCos.A_zimbraMailSignatureMaxLength,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraMailSignatureMaxLength}
,{
id:ZaCos.A_zimbraPrefMailToasterEnabled,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefMailToasterEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefMessageIdDedupingEnabled,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPrefMessageIdDedupingEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPrefComposeInNewWindow,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefComposeInNewWindow,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefComposeFormat,choices:ZaModel.COMPOSE_FORMAT_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefComposeFormat,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefAutoAddAddressEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefAutoAddAddressEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefImapSearchFoldersEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefImapSearchFoldersEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefGroupMailBy,choices:ZaModel.GROUP_MAIL_BY_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefGroupMailBy,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefMessageViewHtmlPreferred,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefMessageViewHtmlPreferred,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefShowSearchString,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefShowSearchString,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefUseTimeZoneListInCalendar,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefUseTimeZoneListInCalendar,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefMailPollingInterval,ref:"attrs/"+ZaCos.A_zimbraPrefMailPollingInterval,type:_ENUM_,choices:ZaModel.MAIL_POLLING_INTERVAL_CHOICES}
,{
id:ZaCos.A_zimbraPrefAutoSaveDraftInterval,ref:"attrs/"+ZaCos.A_zimbraPrefAutoSaveDraftInterval,type:_MINTERVAL_}
,{
id:ZaCos.A_zimbraDataSourceMinPollingInterval,ref:"attrs/"+ZaCos.A_zimbraDataSourceMinPollingInterval,type:_LIFETIME_}
,{
id:ZaCos.A_zimbraDataSourcePop3PollingInterval,ref:"attrs/"+ZaCos.A_zimbraDataSourcePop3PollingInterval,type:_LIFETIME_}
,{
id:ZaCos.A_zimbraDataSourceImapPollingInterval,ref:"attrs/"+ZaCos.A_zimbraDataSourceImapPollingInterval,type:_LIFETIME_}
,{
id:ZaCos.A_zimbraDataSourceCalendarPollingInterval,ref:"attrs/"+ZaCos.A_zimbraDataSourceCalendarPollingInterval,type:_LIFETIME_}
,{
id:ZaCos.A_zimbraDataSourceRssPollingInterval,ref:"attrs/"+ZaCos.A_zimbraDataSourceRssPollingInterval,type:_LIFETIME_}
,{
id:ZaCos.A_zimbraDataSourceCaldavPollingInterval,ref:"attrs/"+ZaCos.A_zimbraDataSourceCaldavPollingInterval,type:_LIFETIME_}
,{
id:ZaCos.A_zimbraProxyAllowedDomains,type:_LIST_,ref:"attrs/"+ZaCos.A_zimbraProxyAllowedDomains,listItem:{
type:_STRING_}}
,{
id:ZaCos.A_zimbraPrefMailFlashIcon,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefMailFlashIcon,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefMailFlashTitle,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefMailFlashTitle,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefMailSoundsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefMailSoundsEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefCalendarUseQuickAdd,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarUseQuickAdd,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,choices:ZaModel.REMINDER_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefSkin,ref:"attrs/"+ZaCos.A_zimbraPrefSkin,type:_STRING_}
,{
id:ZaCos.A_zimbraPrefGalAutoCompleteEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefGalAutoCompleteEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefWarnOnExit,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefWarnOnExit,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefShowSelectionCheckbox,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefShowSelectionCheckbox,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefIMAutoLogin,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefIMAutoLogin,type:_ENUM_}
,{
id:ZaCos.A_zimbraAvailableSkin,ref:"attrs/"+ZaCos.A_zimbraAvailableSkin,type:_LIST_,dataType:_STRING_,outputType:_LIST_}
,{
id:ZaCos.A_zimbraZimletAvailableZimlets,ref:"attrs/"+ZaCos.A_zimbraZimletAvailableZimlets,type:_LIST_,dataType:_STRING_,outputType:_LIST_}
,{
id:ZaCos.A_zimbraPrefDisplayExternalImages,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefDisplayExternalImages,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefOutOfOfficeCacheDuration,ref:"attrs/"+ZaCos.A_zimbraPrefOutOfOfficeCacheDuration,type:_MLIFETIME_}
,{
id:ZaCos.A_zimbraPrefMailDefaultCharset,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraPrefMailDefaultCharset,choices:ZaSettings.mailCharsetChoices}
,{
id:ZaCos.A_zimbraPrefLocale,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraPrefLocale}
,{
id:ZaCos.A_zimbraJunkMessagesIndexingEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraJunkMessagesIndexingEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPrefMailSendReadReceipts,choices:ZaModel.SEND_READ_RECEPIT_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefMailSendReadReceipts,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureExportFolderEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureExportFolderEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureImportFolderEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureImportFolderEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraDumpsterEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraDumpsterEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraDumpsterUserVisibleAge,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraDumpsterUserVisibleAge}
,{
id:ZaCos.A_zimbraDumpsterPurgeEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraDumpsterPurgeEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraMailDumpsterLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraMailDumpsterLifetime}
,{
id:ZaCos.A_zimbraPrefCalendarSendInviteDeniedAutoReply,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPrefCalendarSendInviteDeniedAutoReply,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureReadReceiptsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureReadReceiptsEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureDistributionListFolderEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureDistributionListFolderEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureMailPriorityEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureMailPriorityEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureImapDataSourceEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureImapDataSourceEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeaturePop3DataSourceEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeaturePop3DataSourceEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureIdentitiesEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureIdentitiesEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureContactsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureContactsEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureCalendarEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureCalendarEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureTasksEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureTasksEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureTaggingEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureTaggingEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeaturePeopleSearchEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeaturePeopleSearchEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureAdvancedSearchEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureAdvancedSearchEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureSavedSearchesEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureSavedSearchesEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureConversationsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureConversationsEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureChangePasswordEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureChangePasswordEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureHtmlComposeEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureHtmlComposeEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureFiltersEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureFiltersEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureGalEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureGalEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureMAPIConnectorEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureMAPIConnectorEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureEwsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureEwsEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureTouchClientEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureTouchClientEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureManageSMIMECertificateEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureManageSMIMECertificateEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureSMIMEEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureSMIMEEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureMailForwardingEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureMailForwardingEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureMailSendLaterEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureMailSendLaterEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureBriefcasesEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureBriefcasesEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureBriefcaseDocsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureBriefcaseDocsEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraImapEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraImapEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureHtmlComposeEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureHtmlComposeEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraImapEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraImapEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPop3Enabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPop3Enabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureSharingEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureSharingEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraExternalSharingEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraExternalSharingEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPublicSharingEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraPublicSharingEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureNewMailNotificationEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureNewMailNotificationEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureOptionsEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureOptionsEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureSkinChangeEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureSkinChangeEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureManageZimlets,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureManageZimlets,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureMailEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureMailEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureGroupCalendarEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureGroupCalendarEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraFeatureFlaggingEnabled,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaCos.A_zimbraFeatureFlaggingEnabled,type:_ENUM_}
,{
id:ZaCos.A_zimbraPasswordLockoutEnabled,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraPasswordLockoutEnabled,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A_zimbraPasswordLockoutDuration,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraPasswordLockoutDuration}
,{
id:ZaCos.A_zimbraPasswordLockoutMaxFailures,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraPasswordLockoutMaxFailures,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraPasswordLockoutFailureLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraPasswordLockoutFailureLifetime}
,{
id:ZaCos.A_zimbraFreebusyExchangeUserOrg,type:_STRING_,ref:"attrs/"+ZaCos.A_zimbraFreebusyExchangeUserOrg}
,{
id:ZaCos.A_zimbraFileTrashLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraFileTrashLifetime}
,{
id:ZaCos.A_zimbraUnaccessedFileLifetime,type:_MLIFETIME_,ref:"attrs/"+ZaCos.A_zimbraUnaccessedFileLifetime}
,{
id:ZaCos.A_zimbraNumFileVersionsToKeep,type:_NUMBER_,ref:"attrs/"+ZaCos.A_zimbraNumFileVersionsToKeep,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaCos.A_zimbraFileSendExpirationWarning,type:_ENUM_,ref:"attrs/"+ZaCos.A_zimbraFileSendExpirationWarning,choices:["none","owner","all"]}
,{
id:ZaCos.A_zimbraFileExpirationWarningDays,type:_MINTERVAL_,ref:"attrs/"+ZaCos.A_zimbraFileExpirationWarningDays}
,{
id:ZaCos.A2_retentionPoliciesKeepInherited,type:_ENUM_,ref:ZaCos.A2_retentionPoliciesKeepInherited,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaCos.A2_retentionPoliciesKeep,type:_LIST_}
,{
id:ZaCos.A2_retentionPoliciesPurge,type:_LIST_}
,{
id:ZaCos.A2_retentionPoliciesKeep_Selection,type:_LIST_}
,{
id:ZaCos.A2_retentionPoliciesPurge_Selection,type:_LIST_}
]};
ZaCos.prototype.manageSpecialAttrs=function(){
var n="";
var h=this.attrs[ZaCos.A_zimbraPrefTimeZoneId];
if(h){
var t=ZaModel.setUnrecoganizedChoiceValue(h,ZaSettings.timeZoneChoices);
if(h!=t){
this.attrs[ZaCos.A_zimbraPrefTimeZoneId]=t;
n+=AjxMessageFormat.format(ZaMsg.WARNING_TIME_ZONE_INVALID,[h,'cos - "'+this.name+'"'])
}}
var o=this.attrs[ZaCos.A_zimbraPrefMailDefaultCharset];
if(o){
var s=ZaModel.setUnrecoganizedChoiceValue(o,ZaSettings.mailCharsetChoices);
if(o!=s){
this.attrs[ZaCos.A_zimbraPrefMailDefaultCharset]=s;
n+=AjxMessageFormat.format(ZaMsg.WARNING_CHARSET_INVALID,[o,'cos - "'+this.name+'"'])
}}
var r=this.attrs[ZaCos.A_zimbraPrefLocale];
if(r){
var e=ZaModel.setUnrecoganizedChoiceValue(r,ZaSettings.getLocaleChoices());
if(r!=e){
this.attrs[ZaCos.A_zimbraPrefLocale]=e;
n+=AjxMessageFormat.format(ZaMsg.WARNING_LOCALE_INVALID,[r,'cos - "'+this.name+'"'])
}}
if(n&&n.length>0){
ZaApp.getInstance().getCurrentController().popupMsgDialog(n,true)
}};
ZaCos.globalRights={};
ZaCos.getEffectiveCosList=function(c){
var u=AjxSoapDoc.create("GetAllEffectiveRightsRequest",ZaZimbraAdmin.URN,null);
var o=u.set("grantee",c);
o.setAttribute("type","usr");
o.setAttribute("by","id");
var n={};
n.soapDoc=u;
n.asyncMode=false;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_EFFICIENT_COS_LIST};
var m=[];
try{
var s=ZaRequestMgr.invoke(n,e);
if(!s||s.Body.GetAllEffectiveRightsResponse.Fault){
return m
}
var l=s.Body.GetAllEffectiveRightsResponse.target;
for(var h=0;
h<l.length;
h++){
if(l[h].type!=ZaItem.COS){
continue
}
if(!l[h].entries&&!l[h].all){
continue
}
if(l[h].all){
if(l[h].all.length&&l[h].all[0]&&l[h].all[0].right&&l[h].all[0].right.length){
for(var r=0;
r<l[h].all[0].right.length;
r++){
ZaCos.globalRights[l[h].all[0].right[r].n]=true
}}}
for(var r=0;
r<l[h].entries.length;
r++){
var f=l[h].entries[r].entry;
for(var t=0;
t<f.length;
t++){
m.push(f[t].name)
}}
break
}
return m
}
catch(d){
return m
}};
ZaCos.prototype.countAllAccounts=function(){
var o=AjxSoapDoc.create("SearchDirectoryRequest",ZaZimbraAdmin.URN,null);
o.getMethod().setAttribute("maxResults","0");
o.getMethod().setAttribute("limit","-1");
var n="("+ZaAccount.A_COSId+"="+this.id+")";
if(this.name=="default"){
n="(|(&(!("+ZaAccount.A_COSId+"=*))(!("+ZaAccount.A_zimbraIsExternalVirtualAccount+"=TRUE)))"+n+")"
}else{
if(this.name=="defaultExternal"){
n="(|(&(!("+ZaAccount.A_COSId+"=*))("+ZaAccount.A_zimbraIsExternalVirtualAccount+"=TRUE))"+n+")"
}}
n="(&"+n+"(!("+ZaAccount.A_zimbraIsSystemAccount+"=TRUE)))";
o.set("query",n);
o.set("types",ZaSearch.ACCOUNTS);
var r=new ZmCsfeCommand();
var t=new Object();
t.soapDoc=o;
t.noAuthToken=true;
try{
var s=r.invoke(t).Body.SearchDirectoryResponse;
if(s.searchTotal){
return s.searchTotal
}else{
return 0
}}
catch(e){
throw (e)
}
return 0
};
ZaCos.prototype.countAllDomains=function(){
var o=AjxSoapDoc.create("SearchDirectoryRequest",ZaZimbraAdmin.URN,null);
o.getMethod().setAttribute("maxResults","0");
o.getMethod().setAttribute("limit","-1");
var n="("+ZaDomain.A_domainDefaultCOSId+"="+this.id+")";
if(this.name=="default"){
n="(|(!("+ZaDomain.A_domainDefaultCOSId+"=*))"+n+")"
}else{
if(this.name=="defaultExternal"){
n="(|(!("+ZaDomain.A_domainDefaultExternalUserCOSId+"=*))"+n+")"
}}
o.set("query",n);
o.set("types",ZaSearch.DOMAINS);
var r=new ZmCsfeCommand();
var t=new Object();
t.soapDoc=o;
t.noAuthToken=true;
try{
var s=r.invoke(t).Body.SearchDirectoryResponse;
if(s.searchTotal){
return s.searchTotal
}else{
return 0
}}
catch(e){
throw (e)
}
return 0
};
ZaCos.checkValues=function(n){
if(n.attrs==null){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_UNKNOWN);
return false
}
if(ZaItem.hasWritePermission(ZaCos.A_name,n)){
if((n.attrs[ZaCos.A_name]==null||n.attrs[ZaCos.A_name].length<1)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_NAME_REQUIRED);
return false
}else{
n.name=n.attrs[ZaCos.A_name]
}
if(n.name.length>256||n.attrs[ZaCos.A_name].length>256){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_COS_NAME_TOOLONG);
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPasswordMinUpperCaseChars,n)){
if(n.attrs[ZaCos.A_zimbraPasswordMinUpperCaseChars]!=null&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraPasswordMinUpperCaseChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinUpperCaseChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPasswordMinLowerCaseChars,n)){
if(n.attrs[ZaCos.A_zimbraPasswordMinLowerCaseChars]!=null&&n.attrs[ZaCos.A_zimbraPasswordMinLowerCaseChars]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraPasswordMinLowerCaseChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinLowerCaseChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPasswordMinPunctuationChars,n)){
if(n.attrs[ZaCos.A_zimbraPasswordMinPunctuationChars]!=null&&n.attrs[ZaCos.A_zimbraPasswordMinPunctuationChars]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraPasswordMinPunctuationChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinPunctuationChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPasswordMinNumericChars,n)){
if(n.attrs[ZaCos.A_zimbraPasswordMinNumericChars]!=null&&n.attrs[ZaCos.A_zimbraPasswordMinNumericChars]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraPasswordMinNumericChars])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinNumericChars]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPasswordMinDigitsOrPuncs,n)){
if(n.attrs[ZaCos.A_zimbraPasswordMinDigitsOrPuncs]!=null&&n.attrs[ZaCos.A_zimbraPasswordMinDigitsOrPuncs]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraPasswordMinDigitsOrPuncs])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordMinDigitsOrPuncs]));
return false
}}
if(n.attrs[ZaCos.A_zimbraMailQuota]!=null&&n.attrs[ZaCos.A_zimbraMailQuota]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraMailQuota])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailQuota]));
return false
}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraContactMaxNumEntries,n)){
if(n.attrs[ZaCos.A_zimbraContactMaxNumEntries]!=null&&n.attrs[ZaCos.A_zimbraContactMaxNumEntries]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraContactMaxNumEntries])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraContactMaxNumEntries]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMinPwdLength,n)){
if(n.attrs[ZaCos.A_zimbraMinPwdLength]!=null&&n.attrs[ZaCos.A_zimbraMinPwdLength]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraMinPwdLength])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMinPwdLength]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMaxPwdLength,n)){
if(n.attrs[ZaCos.A_zimbraMaxPwdLength]!=null&&n.attrs[ZaCos.A_zimbraMaxPwdLength]&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraMaxPwdLength])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMaxPwdLength]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMaxPwdLength,n)&&ZaItem.hasWritePermission(ZaCos.A_zimbraMinPwdLength,n)){
if(n.attrs[ZaCos.A_zimbraMaxPwdLength]!=null&&n.attrs[ZaCos.A_zimbraMinPwdLength]!=null){
if(parseInt(n.attrs[ZaCos.A_zimbraMaxPwdLength])<parseInt(n.attrs[ZaCos.A_zimbraMinPwdLength])&&parseInt(n.attrs[ZaCos.A_zimbraMaxPwdLength])>0){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_MAX_MIN_PWDLENGTH);
return false
}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMinPwdAge,n)){
if(n.attrs[ZaCos.A_zimbraMinPwdAge]!=null&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraMinPwdAge])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_passMinAge]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMaxPwdAge,n)){
if(n.attrs[ZaCos.A_zimbraMaxPwdAge]!=null&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraMaxPwdAge])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_passMaxAge]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMinPwdAge,n)&&ZaItem.hasWritePermission(ZaCos.A_zimbraMaxPwdAge,n)){
if(n.attrs[ZaCos.A_zimbraMinPwdAge]!=null&&n.attrs[ZaCos.A_zimbraMaxPwdAge]!=null){
if(parseInt(n.attrs[ZaCos.A_zimbraMaxPwdAge])<parseInt(n.attrs[ZaCos.A_zimbraMinPwdAge])&&parseInt(n.attrs[ZaCos.A_zimbraMaxPwdAge])>0){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_MAX_MIN_PWDAGE);
return false
}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraAuthTokenLifetime,n)){
if(n.attrs[ZaCos.A_zimbraAuthTokenLifetime]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraAuthTokenLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraAuthTokenLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPrefOutOfOfficeCacheDuration,n)){
if(n.attrs[ZaCos.A_zimbraPrefOutOfOfficeCacheDuration]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraPrefOutOfOfficeCacheDuration])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPrefOutOfOfficeCacheDuration]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMailIdleSessionTimeout,n)){
if(n.attrs[ZaCos.A_zimbraMailIdleSessionTimeout]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraMailIdleSessionTimeout])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailIdleSessionTimeout]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPrefAutoSaveDraftInterval,n)){
if(n.attrs[ZaCos.A_zimbraPrefAutoSaveDraftInterval]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraPrefAutoSaveDraftInterval])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPrefAutoSaveDraftInterval]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraDataSourceMinPollingInterval,n)){
var r=n.attrs[ZaCos.A_zimbraDataSourceMinPollingInterval];
if(!AjxUtil.isEmpty(r)&&!AjxUtil.isLifeTime(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceMinPollingInterval]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraDataSourcePop3PollingInterval,n)){
var r=n.attrs[ZaCos.A_zimbraDataSourcePop3PollingInterval];
if(!AjxUtil.isEmpty(r)){
if(!AjxUtil.isLifeTime(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourcePop3PollingInterval]));
return false
}
var d=n.attrs[ZaCos.A_zimbraDataSourceMinPollingInterval];
if(!AjxUtil.isEmpty(d)){
if(ZaUtil.getLifeTimeInSeconds(r)<ZaUtil.getLifeTimeInSeconds(d)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+d);
return false
}}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraDataSourceImapPollingInterval,n)){
var r=n.attrs[ZaCos.A_zimbraDataSourceImapPollingInterval];
if(!AjxUtil.isEmpty(r)){
if(!AjxUtil.isLifeTime(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceImapPollingInterval]));
return false
}
var d=n.attrs[ZaCos.A_zimbraDataSourceMinPollingInterval];
if(!AjxUtil.isEmpty(d)){
if(ZaUtil.getLifeTimeInSeconds(r)<ZaUtil.getLifeTimeInSeconds(d)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+d);
return false
}}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraDataSourceCalendarPollingInterval,n)){
var r=n.attrs[ZaCos.A_zimbraDataSourceCalendarPollingInterval];
if(!AjxUtil.isEmpty(r)){
if(!AjxUtil.isLifeTime(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceCalendarPollingInterval]));
return false
}
var d=n.attrs[ZaCos.A_zimbraDataSourceMinPollingInterval];
if(!AjxUtil.isEmpty(d)){
if(ZaUtil.getLifeTimeInSeconds(r)<ZaUtil.getLifeTimeInSeconds(d)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+d);
return false
}}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraDataSourceRssPollingInterval,n)){
var r=n.attrs[ZaCos.A_zimbraDataSourceRssPollingInterval];
if(!AjxUtil.isEmpty(r)){
if(!AjxUtil.isLifeTime(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraDataSourceRssPollingInterval]));
return false
}
var d=n.attrs[ZaCos.A_zimbraDataSourceMinPollingInterval];
if(!AjxUtil.isEmpty(d)){
if(ZaUtil.getLifeTimeInSeconds(r)<ZaUtil.getLifeTimeInSeconds(d)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+d);
return false
}}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraDataSourceCaldavPollingInterval,n)){
var r=n.attrs[ZaCos.A_zimbraDataSourceCaldavPollingInterval];
if(!AjxUtil.isEmpty(r)){
if(!AjxUtil.isLifeTime(r)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zzimbraDataSourceCaldavPollingInterval]));
return false
}
var d=n.attrs[ZaCos.A_zimbraDataSourceMinPollingInterval];
if(!AjxUtil.isEmpty(d)){
if(ZaUtil.getLifeTimeInSeconds(r)<ZaUtil.getLifeTimeInSeconds(d)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.tt_mailPollingIntervalError+d);
return false
}}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPrefMailPollingInterval,n)){
if(n.attrs[ZaCos.A_zimbraPrefMailPollingInterval]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraPrefMailPollingInterval])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPrefMailPollingInterval]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPrefMailPollingInterval,n)){
var t=n.attrs[ZaCos.A_zimbraMailMinPollingInterval];
if(t!=null&&!AjxUtil.isLifeTime(t)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailMinPollingInterval]));
return false
}
var h=n.attrs[ZaCos.A_zimbraMailMinPollingInterval];
if(h!=null&&ZaUtil.getLifeTimeInSeconds(t)>ZaUtil.getLifeTimeInSeconds(h)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.tt_minPollingIntervalWarning,[h,t]),true)
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMailMessageLifetime,n)){
if(n.attrs[ZaCos.A_zimbraMailMessageLifetime]!=null){
if(!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraMailMessageLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailMessageLifetime]));
return false
}
var e=parseInt(n.attrs[ZaCos.A_zimbraMailMessageLifetime].substr(0,n.attrs[ZaCos.A_zimbraMailMessageLifetime].length-1));
if(e>0&&e<31){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_MESSAGE_LIFETIME_BELOW_31);
return false
}}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMailTrashLifetime,n)){
if(n.attrs[ZaCos.A_zimbraMailTrashLifetime]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraMailTrashLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailTrashLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMailSpamLifetime,n)){
if(n.attrs[ZaCos.A_zimbraMailSpamLifetime]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraMailSpamLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraMailSpamLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPasswordLockoutDuration,n)){
if(n.attrs[ZaCos.A_zimbraPasswordLockoutDuration]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraPasswordLockoutDuration])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordLockoutDuration]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraPasswordLockoutFailureLifetime,n)){
if(n.attrs[ZaCos.A_zimbraPasswordLockoutFailureLifetime]!=null&&!AjxUtil.isLifeTime(n.attrs[ZaCos.A_zimbraPasswordLockoutFailureLifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraPasswordLockoutFailureLifetime]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraEnforcePwdHistory,n)){
if(n.attrs[ZaCos.A_zimbraEnforcePwdHistory]!=null&&!AjxUtil.isNonNegativeLong(n.attrs[ZaCos.A_zimbraEnforcePwdHistory])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.MSG_zimbraEnforcePwdHistory]));
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraMaxMailItemsPerPage,n)&&ZaItem.hasWritePermission(ZaCos.A_zimbraPrefMailItemsPerPage,n)){
var c;
if(n.attrs[ZaAccount.A_zimbraMaxMailItemsPerPage]!=null){
c=parseInt(n.attrs[ZaAccount.A_zimbraMaxMailItemsPerPage])
}else{
c=parseInt(n._defaultValues.attrs[ZaAccount.A_zimbraMaxMailItemsPerPage])
}
var m;
if(n.attrs[ZaAccount.A_zimbraPrefMailItemsPerPage]!=null){
m=parseInt(n.attrs[ZaAccount.A_zimbraPrefMailItemsPerPage])
}else{
m=parseInt(n._defaultValues.attrs[ZaAccount.A_zimbraPrefMailItemsPerPage])
}
if(c<m){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ITEMS_PER_PAGE_OVER_MAX);
return false
}}
if(ZaItem.hasWritePermission(ZaCos.A_zimbraAvailableSkin,n)){
if(n.attrs[ZaCos.A_zimbraAvailableSkin]!=null&&n.attrs[ZaCos.A_zimbraAvailableSkin].length>0&&n.attrs[ZaCos.A_zimbraPrefSkin]){
var l=n.attrs[ZaCos.A_zimbraAvailableSkin] instanceof Array?n.attrs[ZaCos.A_zimbraAvailableSkin]:[n.attrs[ZaCos.A_zimbraAvailableSkin]];
var o=l.length;
var u=false;
for(var s=0;
s<o;
s++){
if(l[s]==n.attrs[ZaCos.A_zimbraPrefSkin]){
u=true;
break
}}
if(!u){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.COS_WarningCurrentThemeNotAvail,[n.attrs[ZaCos.A_zimbraPrefSkin],n.attrs[ZaCos.A_zimbraPrefSkin]]));
return false
}}}
return true
};
ZaCos.getRelatedList=function(t){
var e=[];
var s=this.countAllAccounts();
if(s>0){
var n=new ZaTreeItemData({
text:ZaMsg.OVP_accounts,count:s,image:"Account",mappingId:ZaZimbraAdmin._COS_ACCOUNT_LIST_VIEW,path:t+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.OVP_accounts}
);
n.setData("cosItem",this);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._COS_ACCOUNT_LIST_VIEW]=ZaOverviewPanelController.accountListTreeListener;
e.push(n)
}
s=this.countAllDomains();
if(s>0){
var o=new ZaTreeItemData({
text:ZaMsg.OVP_domains,count:s,image:"Domain",mappingId:ZaZimbraAdmin._COS_DOMAIN_LIST_VIEW,path:t+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.OVP_domains}
);
o.setData("cosItem",this);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._COS_DOMAIN_LIST_VIEW]=ZaOverviewPanelController.domainListTreeListener;
e.push(o)
}
return e
};
ZaItem.getRelatedMethods.ZaCos.push(ZaCos.getRelatedList)
}
if(AjxPackage.define("zimbraAdmin.domains.model.ZaDomain")){
ZaDomain=function(){
ZaItem.call(this,"ZaDomain");
this.attrs=new Object();
this.id="";
this.name="";
this.type=ZaItem.DOMAIN;
this.attrs[ZaDomain.A_zimbraGalMode]=ZaDomain.GAL_Mode_internal;
this.attrs[ZaDomain.A_AuthMech]=ZaDomain.AuthMech_zimbra;
this.attrs[ZaDomain.A_GALSyncUseGALSearch]="TRUE";
this.notebookAcls={};
this[ZaDomain.A_NotebookTemplateFolder]="Template";
this[ZaDomain.A_NotebookTemplateDir]="/opt/zimbra/wiki/Template";
this.attrs[ZaDomain.A_zimbraAuthMechAdmin]=ZaDomain.AuthMech_ad;
this.notebookAcls[ZaDomain.A_NotebookAllACLs]={
r:0,w:0,i:0,d:0,a:0,x:0};
this.notebookAcls[ZaDomain.A_NotebookPublicACLs]={
r:0,w:0,i:0,d:0,a:0,x:0};
this.notebookAcls[ZaDomain.A_NotebookDomainACLs]={
r:1,w:1,i:1,d:1,a:0,x:0};
this.notebookAcls[ZaDomain.A_NotebookUserACLs]=[];
this.notebookAcls[ZaDomain.A_NotebookGroupACLs]=[];
this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts]=[];
this.attrs[ZaDomain.A_zimbraDomainFeatureMaxAccounts]=[]
};
ZaDomain.DEF_WIKI_ACC="domain_wiki";
ZaDomain.WIKI_FOLDER_ID="12";
ZaDomain.RESULTSPERPAGE=ZaSettings.RESULTSPERPAGE;
ZaDomain.MAXSEARCHRESULTS=ZaSettings.MAXSEARCHRESULTS;
ZaDomain.prototype=new ZaItem;
ZaDomain.prototype.constructor=ZaDomain;
ZaDomain.ACLLabels={
r:ZaMsg.ACL_R,w:ZaMsg.ACL_W,i:ZaMsg.ACL_I,a:ZaMsg.ACL_A,d:ZaMsg.ACL_D,x:ZaMsg.ACL_X};
ZaItem.loadMethods.ZaDomain=new Array();
ZaItem.initMethods.ZaDomain=new Array();
ZaItem.modifyMethods.ZaDomain=new Array();
ZaItem.modifyMethodsExt.ZaDomain=new Array();
ZaItem.createMethods.ZaDomain=new Array();
ZaItem.getRelatedMethods.ZaDomain=new Array();
ZaDomain.DOMAIN_STATUS_ACTIVE="active";
ZaDomain.DOMAIN_STATUS_MAINTENANCE="maintenance";
ZaDomain.DOMAIN_STATUS_LOCKED="locked";
ZaDomain.DOMAIN_STATUS_CLOSED="closed";
ZaDomain.DOMAIN_STATUS_SUSPENDED="suspended";
ZaDomain.DOMAIN_STATUS_SHUTDOWN="shutdown";
ZaDomain.SPNEGO_SUPPORT_UA=[".*Windows.*Firefox/3.*",".*MSIE.*Windows.*",".*Windows.*Chrome.*",".*Windows.*Safari.*",".*Macintosh.*Safari.*"];
ZaDomain._domainStatus=function(t){
var e=ZaDomain._DOMAIN_STATUS[t];
return(e==null)?t:e
};
ZaDomain._DOMAIN_STATUS=new Object();
ZaDomain.initDomainStatus=function(){
ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_ACTIVE]=ZaMsg.domainStatus_active;
ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_CLOSED]=ZaMsg.domainStatus_closed;
ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_LOCKED]=ZaMsg.domainStatus_locked;
ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_SUSPENDED]=ZaMsg.domainStatus_suspended;
ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_MAINTENANCE]=ZaMsg.domainStatus_maintenance;
ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_SHUTDOWN]=ZaMsg.domainStatus_shutdown;
ZaDomain.getDomainStatusChoices=function(){
return[{
value:ZaDomain.DOMAIN_STATUS_ACTIVE,label:ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_ACTIVE]}
,{
value:ZaDomain.DOMAIN_STATUS_CLOSED,label:ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_CLOSED]}
,{
value:ZaDomain.DOMAIN_STATUS_LOCKED,label:ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_LOCKED]}
,{
value:ZaDomain.DOMAIN_STATUS_MAINTENANCE,label:ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_MAINTENANCE]}
,{
value:ZaDomain.DOMAIN_STATUS_SUSPENDED,label:ZaDomain._DOMAIN_STATUS[ZaDomain.DOMAIN_STATUS_SUSPENDED]}
]
};
ZaDomain.domainStatusChoices=ZaDomain.getDomainStatusChoices
};
ZaDomain.initDomainStatus();
ZaDomain.getAggregateQuotaPolicyChoices=function(){
return[{
label:ZaMsg.Choice_QuotaPolicy_AllAllowed,value:"ALLOWSENDRECEIVE"}
,{
label:ZaMsg.Choice_QuotaPolicy_BlockSends,value:"BLOCKSEND"}
,{
label:ZaMsg.Choice_QuotaPolicy_AllBlocked,value:"BLOCKSENDRECEIVE"}
]
};
ZaDomain.aggregateQuotaPolicyChoices=ZaDomain.getAggregateQuotaPolicyChoices;
ZaDomain.domainTypes={
alias:"alias",local:"local"};
ZaDomain.protocolChoices={
http:"http",https:"https"};
ZaDomain.A_description="description";
ZaDomain.A_notes="zimbraNotes";
ZaDomain.A_domainName="zimbraDomainName";
ZaDomain.A_domainType="zimbraDomainType";
ZaDomain.A_domainDefaultCOSId="zimbraDomainDefaultCOSId";
ZaDomain.A_domainDefaultExternalUserCOSId="zimbraDomainDefaultExternalUserCOSId";
ZaDomain.A_zimbraDomainStatus="zimbraDomainStatus";
ZaDomain.A_zimbraPublicServiceHostname="zimbraPublicServiceHostname";
ZaDomain.A_zimbraPublicServicePort="zimbraPublicServicePort";
ZaDomain.A_zimbraPublicServiceProtocol="zimbraPublicServiceProtocol";
ZaDomain.A_zimbraDNSCheckHostname="zimbraDNSCheckHostname";
ZaDomain.A_zimbraBasicAuthRealm="zimbraBasicAuthRealm";
ZaDomain.A_zimbraGalMaxResults="zimbraGalMaxResults";
ZaDomain.A_zimbraGalMode="zimbraGalMode";
ZaDomain.A_GalLdapURL="zimbraGalLdapURL";
ZaDomain.A_GalLdapSearchBase="zimbraGalLdapSearchBase";
ZaDomain.A_GalLdapBindDn="zimbraGalLdapBindDn";
ZaDomain.A_GalLdapBindPassword="zimbraGalLdapBindPassword";
ZaDomain.A_GalLdapBindPasswordConfirm="zimbraGalLdapBindPasswordConfirm";
ZaDomain.A_GalLdapFilter="zimbraGalLdapFilter";
ZaDomain.A_zimbraGalAutoCompleteLdapFilter="zimbraGalAutoCompleteLdapFilter";
ZaDomain.A_zimbraGalSyncLdapURL="zimbraGalSyncLdapURL";
ZaDomain.A_zimbraGalSyncLdapSearchBase="zimbraGalSyncLdapSearchBase";
ZaDomain.A_zimbraGalSyncLdapFilter="zimbraGalSyncLdapFilter";
ZaDomain.A_zimbraGalSyncLdapAuthMech="zimbraGalSyncLdapAuthMech";
ZaDomain.A_zimbraGalSyncLdapBindDn="zimbraGalSyncLdapBindDn";
ZaDomain.A_zimbraGalSyncLdapBindPassword="zimbraGalSyncLdapBindPassword";
ZaDomain.A_zimbraGalAccountId="zimbraGalAccountId";
ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled="zimbraFeatureCalendarReminderDeviceEmailEnabled";
ZaDomain.A_mailHost="zimbraMailHost";
ZaDomain.A_AuthMech="zimbraAuthMech";
ZaDomain.A_AuthLdapURL="zimbraAuthLdapURL";
ZaDomain.A_AuthLdapUserDn="zimbraAuthLdapBindDn";
ZaDomain.A_AuthLdapSearchBase="zimbraAuthLdapSearchBase";
ZaDomain.A_AuthLdapSearchFilter="zimbraAuthLdapSearchFilter";
ZaDomain.A_AuthLdapSearchBindDn="zimbraAuthLdapSearchBindDn";
ZaDomain.A_AuthLdapSearchBindPassword="zimbraAuthLdapSearchBindPassword";
ZaDomain.A_zimbraAdminConsoleDNSCheckEnabled="zimbraAdminConsoleDNSCheckEnabled";
ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled="zimbraAdminConsoleCatchAllAddressEnabled";
ZaDomain.A_zimbraMailCatchAllAddress="zimbraMailCatchAllAddress";
ZaDomain.A_zimbraMailCatchAllForwardingAddress="zimbraMailCatchAllForwardingAddress";
ZaDomain.A_zimbraAdminConsoleSkinEnabled="zimbraAdminConsoleSkinEnabled";
ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled="zimbraAdminConsoleLDAPAuthEnabled";
ZaDomain.A_zimbraAuthLdapStartTlsEnabled="zimbraAuthLdapStartTlsEnabled";
ZaDomain.A_zimbraAuthFallbackToLocal="zimbraAuthFallbackToLocal";
ZaDomain.A_zimbraPasswordChangeListener="zimbraPasswordChangeListener";
ZaDomain.A_domainMaxAccounts="zimbraDomainMaxAccounts";
ZaDomain.A_GALServerType="galservertype";
ZaDomain.A_GALSyncServerType="galsyncservertype";
ZaDomain.A_GALSyncUseGALSearch="galsyncusegalsearch";
ZaDomain.A_GALSearchTestMessage="galsearchtestmessage";
ZaDomain.A_GALSyncTestMessage="galsynctestmessage";
ZaDomain.A_GALSearchTestResultCode="galsearchtestresutcode";
ZaDomain.A_GALSyncTestResultCode="galsynctestresutcode";
ZaDomain.A_GALSampleQuery="samplequery";
ZaDomain.A_UseBindPassword="usebindpassword";
ZaDomain.A_SyncUseBindPassword="syncusebindpassword";
ZaDomain.A_GALTestSearchResults="galtestsearchresults";
ZaDomain.A_NotebookTemplateDir="templatedir";
ZaDomain.A_NotebookTemplateFolder="templatefolder";
ZaDomain.A_NotebookAccountPassword="noteBookAccountPassword";
ZaDomain.A_NotebookAccountPassword2="noteBookAccountPassword2";
ZaDomain.A_CreateNotebook="createNotebook";
ZaDomain.A_OverwriteTemplates="overwritetemplates";
ZaDomain.A_OverwriteNotebookACLs="overwritenotebookacls";
ZaDomain.A_NotebookPublicACLs="pub";
ZaDomain.A_NotebookAllACLs="all";
ZaDomain.A_NotebookDomainACLs="dom";
ZaDomain.A_NotebookUserACLs="usr";
ZaDomain.A_NotebookGroupACLs="grp";
ZaDomain.A_NotebookGuestACLs="guest";
ZaDomain.A_allNotebookACLS="allNotebookACLS";
ZaDomain.GAL_Mode_internal="zimbra";
ZaDomain.GAL_Mode_external="ldap";
ZaDomain.GAL_Mode_both="both";
ZaDomain.GAL_ServerType_ad="ad";
ZaDomain.GAL_ServerType_ldap="ldap";
ZaDomain.A_AuthADDomainName="zimbraAuthADDomainName";
ZaDomain.A_AuthLDAPSearchBase="zimbraAuthLDAPSearchBase";
ZaDomain.A_AuthTestUserName="authtestusername";
ZaDomain.A_AuthTestPassword="authtestpassword";
ZaDomain.A_AuthTestMessage="authtestmessage";
ZaDomain.A_AuthTestResultCode="authtestresutcode";
ZaDomain.A_AuthComputedBindDn="authcomputedbinddn";
ZaDomain.A_AuthUseBindPassword="authusebindpassword";
ZaDomain.A_AuthLdapSearchBindPasswordConfirm="authldapsearchBindpasswordconfirm";
ZaDomain.A_GalSyncLdapBindPasswordConfirm="syncldappasswordconfirm";
ZaDomain.A_zimbraVirtualHostname="zimbraVirtualHostname";
ZaDomain.A_zimbraSSLCertificate="zimbraSSLCertificate";
ZaDomain.A_zimbraSSLPrivateKey="zimbraSSLPrivateKey";
ZaDomain.AuthMech_ad="ad";
ZaDomain.AuthMech_ldap="ldap";
ZaDomain.AuthMech_zimbra="zimbra";
ZaDomain.A_zimbraNotebookAccount="zimbraNotebookAccount";
ZaDomain.A_zimbraFreebusyExchangeAuthUsername="zimbraFreebusyExchangeAuthUsername";
ZaDomain.A_zimbraFreebusyExchangeAuthPassword="zimbraFreebusyExchangeAuthPassword";
ZaDomain.A_zimbraFreebusyExchangeAuthScheme="zimbraFreebusyExchangeAuthScheme";
ZaDomain.A_zimbraFreebusyExchangeServerType="zimbraFreebusyExchangeServerType";
ZaDomain.A_zimbraFreebusyExchangeURL="zimbraFreebusyExchangeURL";
ZaDomain.A_zimbraFreebusyExchangeUserOrg="zimbraFreebusyExchangeUserOrg";
ZaDomain.A_zimbraAvailableSkin="zimbraAvailableSkin";
ZaDomain.A_zimbraZimletDomainAvailableZimlets="zimbraZimletDomainAvailableZimlets";
ZaDomain.A_zimbraDomainCOSMaxAccounts="zimbraDomainCOSMaxAccounts";
ZaDomain.A_zimbraDomainFeatureMaxAccounts="zimbraDomainFeatureMaxAccounts";
ZaDomain.A2_account_limit="account_limit";
ZaDomain.A_zimbraHelpAdminURL="zimbraHelpAdminURL";
ZaDomain.A_zimbraHelpDelegatedURL="zimbraHelpDelegatedURL";
ZaDomain.A_zimbraAdminConsoleLoginURL="zimbraAdminConsoleLoginURL";
ZaDomain.A_zimbraAdminConsoleLogoutURL="zimbraAdminConsoleLogoutURL";
ZaDomain.A_zimbraAuthKerberos5Realm="zimbraAuthKerberos5Realm";
ZaDomain.A_zimbraWebClientLoginURL="zimbraWebClientLoginURL";
ZaDomain.A_zimbraWebClientLogoutURL="zimbraWebClientLogoutURL";
ZaDomain.A_zimbraWebClientLoginURLAllowedUA="zimbraWebClientLoginURLAllowedUA";
ZaDomain.A_zimbraWebClientLogoutURLAllowedUA="zimbraWebClientLogoutURLAllowedUA";
ZaDomain.A_zimbraWebClientLoginURLAllowedIP="zimbraWebClientLoginURLAllowedIP";
ZaDomain.A_zimbraWebClientLogoutURLAllowedIP="zimbraWebClientLogoutURLAllowedIP";
ZaDomain.A_zimbraForceClearCookies="zimbraForceClearCookies";
ZaDomain.A_zimbraReverseProxyClientCertMode="zimbraReverseProxyClientCertMode";
ZaDomain.A_zimbraMailSSLClientCertPrincipalMap="zimbraMailSSLClientCertPrincipalMap";
ZaDomain.A_zimbraReverseProxyClientCertCA="zimbraReverseProxyClientCertCA";
ZaDomain.A_zimbraAutoProvMode="zimbraAutoProvMode";
ZaDomain.A_zimbraAutoProvAuthMech="zimbraAutoProvAuthMech";
ZaDomain.A_zimbraAutoProvLdapURL="zimbraAutoProvLdapURL";
ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled="zimbraAutoProvLdapStartTlsEnabled";
ZaDomain.A_zimbraAutoProvLdapAdminBindDn="zimbraAutoProvLdapAdminBindDn";
ZaDomain.A_zimbraAutoProvLdapAdminBindPassword="zimbraAutoProvLdapAdminBindPassword";
ZaDomain.A_zimbraAutoProvLdapSearchBase="zimbraAutoProvLdapSearchBase";
ZaDomain.A_zimbraAutoProvLdapSearchFilter="zimbraAutoProvLdapSearchFilter";
ZaDomain.A_zimbraAutoProvLdapBindDn="zimbraAutoProvLdapBindDn";
ZaDomain.A_zimbraAutoProvAccountNameMap="zimbraAutoProvAccountNameMap";
ZaDomain.A_zimbraAutoProvAttrMap="zimbraAutoProvAttrMap";
ZaDomain.A_zimbraAutoProvNotificationFromAddress="zimbraAutoProvNotificationFromAddress";
ZaDomain.A_zimbraAutoProvBatchSize="zimbraAutoProvBatchSize";
ZaDomain.A_zimbraAutoProvLastPolledTimestamp="zimbraAutoProvLastPolledTimestamp";
ZaDomain.A2_zimbraAutoProvModeEAGEREnabled=ZaDomain.A_zimbraAutoProvMode+"_EAGER";
ZaDomain.A2_zimbraAutoProvModeLAZYEnabled=ZaDomain.A_zimbraAutoProvMode+"_LAZY";
ZaDomain.A2_zimbraAutoProvModeMANUALEnabled=ZaDomain.A_zimbraAutoProvMode+"_MANUAL";
ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled=ZaDomain.A_zimbraAutoProvAuthMech+"_LDAP";
ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled=ZaDomain.A_zimbraAutoProvAuthMech+"_PREAUTH";
ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled=ZaDomain.A_zimbraAutoProvAuthMech+"_KRB5";
ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled=ZaDomain.A_zimbraAutoProvAuthMech+"_SPNEGO";
ZaDomain.A2_zimbraAutoProvServerList="zimbraAutoProvServerList";
ZaDomain.A2_zimbraAutoProvSelectedServerList="zimbraAutoProvSelectedDomainList";
ZaDomain.A2_zimbraAutoProvPollingInterval="zimbraAutoProvPollingInterval";
ZaDomain.A2_zimbraAutoProvSearchActivated="zimbraAutoProvSearchAcctActivated";
ZaDomain.A2_zimbraAutoProvAccountPool="zimbraAutoProvAccountPool";
ZaDomain.A2_zimbraAutoProvAccountPoolPageNum="zimbraAutoProvAccountPoolPageNum";
ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool="zimbraAutoProvAccountSrcSelectedPool";
ZaDomain.A2_zimbraAutoProvAccountTargetPool="zimbraAutoProvAccountTargetPool";
ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool="zimbraAutoProvAccountTgtSelectedPool";
ZaDomain.A2_zimbraAutoProvAccountPoolPageTotal="zimbraAutoProvAccountPoolPageTotal";
ZaDomain.A2_zimbraAutoProvAccountPassword="zimbraAutoProvAccountPassword";
ZaDomain.A2_zimbraAutoProvAccountPasswordInDlg=ZaDomain.A2_zimbraAutoProvAccountPassword+"InDlg";
ZaDomain.A2_zimbraAutoProvAccountPasswordAgainInDlg=ZaDomain.A2_zimbraAutoProvAccountPassword+"AgainInDlg";
ZaDomain.A2_zimbraAutoProvAccountPasswordUnmatchedWarning=ZaDomain.A2_zimbraAutoProvAccountPassword+"UnmatchedWarning";
ZaDomain.A_zimbraSkinForegroundColor="zimbraSkinForegroundColor";
ZaDomain.A_zimbraSkinBackgroundColor="zimbraSkinBackgroundColor";
ZaDomain.A_zimbraSkinSecondaryColor="zimbraSkinSecondaryColor";
ZaDomain.A_zimbraSkinSelectionColor="zimbraSkinSelectionColor";
ZaDomain.A_zimbraSkinLogoURL="zimbraSkinLogoURL";
ZaDomain.A_zimbraSkinLogoLoginBanner="zimbraSkinLogoLoginBanner";
ZaDomain.A_zimbraSkinLogoAppBanner="zimbraSkinLogoAppBanner";
ZaDomain.A_zimbraMailDomainQuota="zimbraMailDomainQuota";
ZaDomain.A_zimbraDomainAggregateQuota="zimbraDomainAggregateQuota";
ZaDomain.A_zimbraDomainAggregateQuotaPolicy="zimbraDomainAggregateQuotaPolicy";
ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent="zimbraDomainAggregateQuotaWarnPercent";
ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient="zimbraDomainAggregateQuotaWarnEmailRecipient";
ZaDomain.A_zimbraMailAddressValidationRegex="zimbraMailAddressValidationRegex";
ZaDomain.A_zimbraAutoProvNotificationSubject="zimbraAutoProvNotificationSubject";
ZaDomain.A_zimbraAutoProvNotificationBody="zimbraAutoProvNotificationBody";
ZaDomain.A_zimbraDomainAliasTargetId="zimbraDomainAliasTargetId";
ZaDomain.A2_zimbraDomainAliasTarget="zimbraDomainAliasTargetName";
ZaDomain.A_zimbraPrefTimeZoneId="zimbraPrefTimeZoneId";
ZaDomain.A_zimbraAdminConsoleLoginMessage="zimbraAdminConsoleLoginMessage";
ZaDomain.A2_allowClearTextLDAPAuth="allowClearTextLdapAuth";
ZaDomain.A2_isTestingGAL="isTestingGAL";
ZaDomain.A2_isTestingSync="isTestingSync";
ZaDomain.A2_isTestingAuth="isTestingAuth";
ZaDomain.A2_acl_selection_cache="acl_selection_cache";
ZaDomain.A2_gal_sync_accounts="gal_sync_accounts";
ZaDomain.A2_new_gal_sync_account_name="new_gal_sync_account_name";
ZaDomain.A2_new_internal_gal_ds_name="new_internal_gal_ds_name";
ZaDomain.A2_new_external_gal_ds_name="new_external_gal_ds_name";
ZaDomain.A2_new_internal_gal_polling_interval="new_internal_gal_polling_interval";
ZaDomain.A2_new_external_gal_polling_interval="new_external_gal_polling_interval";
ZaDomain.A2_gal_sync_accounts_set="gal_sync_accounts_set";
ZaDomain.A2_create_gal_acc="create_gal_acc";
ZaDomain.A2_domain_account_quota="domain_account_quota";
ZaDomain.Check_OK="check.OK";
ZaDomain.Check_UNKNOWN_HOST="check.UNKNOWN_HOST";
ZaDomain.Check_CONNECTION_REFUSED="check.CONNECTION_REFUSED";
ZaDomain.Check_SSL_HANDSHAKE_FAILURE="check.SSL_HANDSHAKE_FAILURE";
ZaDomain.Check_COMMUNICATION_FAILURE="check.COMMUNICATION_FAILURE";
ZaDomain.Check_AUTH_FAILED="check.AUTH_FAILED";
ZaDomain.Check_AUTH_NOT_SUPPORTED="check.AUTH_NOT_SUPPORTED";
ZaDomain.Check_NAME_NOT_FOUND="check.NAME_NOT_FOUND";
ZaDomain.Check_INVALID_SEARCH_FILTER="check.INVALID_SEARCH_FILTER";
ZaDomain.Check_FAILURE="check.FAILURE";
ZaDomain.Check_FAULT="Fault";
ZaDomain.Check_SKIPPED="Skiped";
ZaDomain.AUTH_MECH_CHOICES=[ZaDomain.AuthMech_ad,ZaDomain.AuthMech_ldap,ZaDomain.AuthMech_zimbra];
ZaDomain.LOCAL_DOMAIN_QUERY="(zimbraDomainType=local)";
ZaDomain.RIGHT_LIST_DOMAIN="listDomain";
ZaDomain.RIGHT_CREATE_TOP_DOMAIN="createTopDomain";
ZaDomain.RIGHT_DELETE_DOMAIN="deleteDomain";
ZaDomain.RIGHT_RENAME_DOMAIN="renameDomain";
ZaDomain.RIGHT_CREATE_SUB_DOMAIN="createSubDomain";
ZaDomain.RIGHT_CREATE_ACCOUNT="createAccount";
ZaDomain.RIGHT_CREATE_CALRES="createCalendarResource";
ZaDomain.RIGHT_CREATE_DL="createDistributionList";
ZaDomain.RIGHT_CREATE_ALIAS="createAlias";
ZaDomain.RIGHT_ADMIN_LOGIN_AS="adminLoginAs";
ZaDomain.RIGHT_CHECK_MX_RECORD="checkDomainMXRecord";
ZaDomain.CHECK_AUTH_CONFIG="checkExchangeAuthConfig";
ZaDomain.RIGHT_GET_DOMAIN_QUOTA="getDomainQuotaUsage";
ZaDomain.cacheCounter=0;
ZaDomain.staticDomainByNameCacheTable={};
ZaDomain.staticDomainByIdCacheTable={};
ZaDomain.putDomainToCache=function(e){
if(ZaDomain.cacheCounter==100){
ZaDomain.staticDomainByNameCacheTable={};
ZaDomain.staticDomainByIdCacheTable={};
ZaDomain.cacheCounter=0
}
if(!ZaDomain.staticDomainByNameCacheTable[e.name]||!ZaDomain.staticDomainByIdCacheTable[e.id]){
ZaDomain.cacheCounter++
}
if(e.name){
ZaDomain.staticDomainByNameCacheTable[e.name]=e
}
if(e.id){
ZaDomain.staticDomainByIdCacheTable[e.id]=e
}};
ZaDomain.compareACLs=function(t,e){
if(AjxUtil.isEmpty(t.name)&&AjxUtil.isEmpty(e.name)){
if(AjxUtil.isEmpty(t.gt)&&AjXUtil.isEmpty(e.gt)){
return 0
}
if(t.gt==e.gt){
return 0
}
if(t.gt<e.gt){
return -1
}
if(t.gt>e.gt){
return 1
}}else{
if(t.gt==e.gt){
if(t.name==e.name){
return 0
}
if(t.name<e.name){
return -1
}
if(t.name>e.name){
return 1
}}else{
if(t.gt==e.gt){
return 0
}
if(t.gt<e.gt){
return -1
}
if(t.gt>e.gt){
return 1
}}}};
ZaDomain.getAll=function(r,o){
var n="";
if(!ZaZimbraAdmin.hasGlobalDomainListAccess()){
var s=ZaApp.getInstance()._domainNameList;
if(s&&s instanceof Array){
for(var t=0;
t<s.length;
t++){
if(!r||s[t].indexOf(r)!=-1){
n+="("+ZaDomain.A_domainName+"="+s[t]+")"
}}
if(s.length>1){
n="(|"+n+")"
}}}else{
if(r){
n="("+ZaDomain.A_domainName+"=*"+r+"*)"
}}
var h={
query:n,types:[ZaSearch.DOMAINS],sortBy:ZaDomain.A_domainName,offset:"0",attrs:[ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus,ZaItem.A_zimbraId,ZaDomain.A_domainType,ZaDomain.A_AuthMech],sortAscending:"1",limit:ZaDomain.MAXSEARCHRESULTS,ignoreTooManyResultsException:true,exceptionFrom:"ZaDomain.getAll",controller:ZaApp.getInstance().getCurrentController()};
if(o){
if(o.limit){
h.limit=o.limit
}
if(o.callback){
h.callback=ZaDomain._getAllCallback.bind(window,o.callback)
}}
var e=ZaSearch.searchDirectory(h);
if(e){
return ZaDomain._getAllCallback(false,e)
}};
ZaDomain._getAllCallback=function(s,e){
var n=e.isZmCsfeResult?e.getResponse().Body:e.Body;
var t=n&&n.SearchDirectoryResponse;
var o=new ZaItemList(ZaDomain);
if(t!=null){
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
o.loadFromJS(t)
}
if(s){
s(o)
}
return o
};
ZaDomain.createMethod=function(s,h){
if(s.attrs==null){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_UNKNOWN,null);
return null
}
if(s.attrs[ZaDomain.A_domainName]==null||s.attrs[ZaDomain.A_domainName].length<1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_DOMAIN_NAME_REQUIRED);
return null
}
s.name=s.attrs[ZaDomain.A_domainName];
if(!AjxUtil.isEmpty(s.attrs[ZaDomain.A_zimbraGalMaxResults])&&!AjxUtil.isNonNegativeLong(s.attrs[ZaDomain.A_zimbraGalMaxResults])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_VALUE_FOR,[ZaMsg.NAD_GalMaxResults]));
return null
}
if(s.name.length>256||s.attrs[ZaDomain.A_domainName].length>256){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_DOMAIN_NAME_TOOLONG);
return null
}
if(s.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal){
if(!s.attrs[ZaDomain.A_GalLdapFilter]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_SEARCH_FILTER_REQUIRED);
return null
}
if(!s.attrs[ZaDomain.A_GalLdapURL]||s.attrs[ZaDomain.A_GalLdapURL].length<1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_LDAP_URL_REQUIRED);
return null
}}
if(s.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra){
if(!s.attrs[ZaDomain.A_AuthLdapURL]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_LDAP_URL_REQUIRED);
return null
}}
var c=AjxSoapDoc.create("CreateDomainRequest",ZaZimbraAdmin.URN,null);
c.set("name",s.attrs[ZaDomain.A_domainName]);
var l=c.set("a",s.attrs[ZaDomain.A_zimbraGalMode]);
l.setAttribute("n",ZaDomain.A_zimbraGalMode);
l=c.set("a",s.attrs[ZaDomain.A_zimbraGalMaxResults]);
l.setAttribute("n",ZaDomain.A_zimbraGalMaxResults);
l=c.set("a",s.attrs[ZaDomain.A_notes]);
l.setAttribute("n",ZaDomain.A_notes);
if(s.attrs[ZaDomain.A_zimbraHelpAdminURL]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraHelpAdminURL]);
l.setAttribute("n",ZaDomain.A_zimbraHelpAdminURL)
}
if(s.attrs[ZaDomain.A_zimbraHelpDelegatedURL]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraHelpDelegatedURL]);
l.setAttribute("n",ZaDomain.A_zimbraHelpDelegatedURL)
}
if(s.attrs[ZaDomain.A_zimbraAdminConsoleLoginURL]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAdminConsoleLoginURL]);
l.setAttribute("n",ZaDomain.A_zimbraAdminConsoleLoginURL)
}
if(s.attrs[ZaDomain.A_zimbraAdminConsoleLogoutURL]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAdminConsoleLogoutURL]);
l.setAttribute("n",ZaDomain.A_zimbraAdminConsoleLogoutURL)
}
if(s.attrs[ZaDomain.A_zimbraSSLCertificate]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraSSLCertificate]);
l.setAttribute("n",ZaDomain.A_zimbraSSLCertificate)
}
if(s.attrs[ZaDomain.A_zimbraSSLPrivateKey]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraSSLPrivateKey]);
l.setAttribute("n",ZaDomain.A_zimbraSSLPrivateKey)
}
if(s.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]);
l.setAttribute("n",ZaDomain.A_zimbraAuthLdapStartTlsEnabled)
}
if(s.attrs[ZaDomain.A_AuthLdapURL]){
var d=s.attrs[ZaDomain.A_AuthLdapURL].join(" ");
l=c.set("a",d);
l.setAttribute("n",ZaDomain.A_AuthLdapURL);
if(s.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]=="TRUE"&&s.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ldap){
if(d.indexOf("ldaps://")>-1){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.Domain_WarningStartTLSIgnored)
}}}
l=c.set("a",s.attrs[ZaDomain.A_description]);
l.setAttribute("n",ZaDomain.A_description);
if(s.attrs[ZaDomain.A_zimbraBasicAuthRealm]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraBasicAuthRealm]);
l.setAttribute("n",ZaDomain.A_zimbraBasicAuthRealm)
}
if(s.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal){
d=s.attrs[ZaDomain.A_GalLdapURL].join(" ");
l=c.set("a",d);
l.setAttribute("n",ZaDomain.A_GalLdapURL);
l=c.set("a",s.attrs[ZaDomain.A_GalLdapSearchBase]);
l.setAttribute("n",ZaDomain.A_GalLdapSearchBase);
l=c.set("a",s.attrs[ZaDomain.A_GalLdapBindDn]);
l.setAttribute("n",ZaDomain.A_GalLdapBindDn);
l=c.set("a",s.attrs[ZaDomain.A_GalLdapBindPassword]);
l.setAttribute("n",ZaDomain.A_GalLdapBindPassword);
l=c.set("a",s.attrs[ZaDomain.A_GalLdapFilter]);
l.setAttribute("n",ZaDomain.A_GalLdapFilter);
l=c.set("a",s.attrs[ZaDomain.A_zimbraGalAutoCompleteLdapFilter]);
l.setAttribute("n",ZaDomain.A_zimbraGalAutoCompleteLdapFilter)
}
if(s.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
l=c.set("a","%u@"+s.attrs[ZaDomain.A_AuthADDomainName]);
l.setAttribute("n",ZaDomain.A_AuthLdapUserDn)
}else{
if(s.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ldap){
l=c.set("a",s.attrs[ZaDomain.A_AuthLdapSearchFilter]);
l.setAttribute("n",ZaDomain.A_AuthLdapSearchFilter);
l=c.set("a",s.attrs[ZaDomain.A_AuthLdapSearchBase]);
l.setAttribute("n",ZaDomain.A_AuthLdapSearchBase);
if(s[ZaDomain.A_AuthUseBindPassword]&&s[ZaDomain.A_AuthUseBindPassword]=="TRUE"){
l=c.set("a",s.attrs[ZaDomain.A_AuthLdapSearchBindDn]);
l.setAttribute("n",ZaDomain.A_AuthLdapSearchBindDn);
l=c.set("a",s.attrs[ZaDomain.A_AuthLdapSearchBindPassword]);
l.setAttribute("n",ZaDomain.A_AuthLdapSearchBindPassword)
}}}
if(s.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra){
if(s.attrs[ZaDomain.A_zimbraAuthFallbackToLocal]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAuthFallbackToLocal]);
l.setAttribute("n",ZaDomain.A_zimbraAuthFallbackToLocal)
}
if(s.attrs[ZaDomain.A_zimbraPasswordChangeListener]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraPasswordChangeListener]);
l.setAttribute("n",ZaDomain.A_zimbraPasswordChangeListener)
}}
var l=c.set("a",s.attrs[ZaDomain.A_AuthMech]);
l.setAttribute("n",ZaDomain.A_AuthMech);
if(s.attrs[ZaDomain.A_domainDefaultCOSId]){
l=c.set("a",s.attrs[ZaDomain.A_domainDefaultCOSId]);
l.setAttribute("n",ZaDomain.A_domainDefaultCOSId)
}
if(s.attrs[ZaDomain.A_zimbraPublicServiceHostname]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraPublicServiceHostname]);
l.setAttribute("n",ZaDomain.A_zimbraPublicServiceHostname)
}
if(s.attrs[ZaDomain.A_zimbraPublicServiceProtocol]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraPublicServiceProtocol]);
l.setAttribute("n",ZaDomain.A_zimbraPublicServiceProtocol)
}
if(s.attrs[ZaDomain.A_zimbraPublicServicePort]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraPublicServicePort]);
l.setAttribute("n",ZaDomain.A_zimbraPublicServicePort)
}
if(s.attrs[ZaDomain.A_zimbraDNSCheckHostname]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraDNSCheckHostname]);
l.setAttribute("n",ZaDomain.A_zimbraDNSCheckHostname)
}
if(s.attrs[ZaDomain.A_zimbraAdminConsoleDNSCheckEnabled]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAdminConsoleDNSCheckEnabled]);
l.setAttribute("n",ZaDomain.A_zimbraAdminConsoleDNSCheckEnabled)
}
if(s.attrs[ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled]);
l.setAttribute("n",ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled)
}
if(s.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled]);
l.setAttribute("n",ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled)
}
if(s.attrs[ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled]);
l.setAttribute("n",ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled)
}
if(s.attrs[ZaDomain.A_zimbraDomainStatus]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraDomainStatus]);
l.setAttribute("n",ZaDomain.A_zimbraDomainStatus)
}
if(s.attrs[ZaDomain.A_domainMaxAccounts]){
l=c.set("a",s.attrs[ZaDomain.A_domainMaxAccounts]);
l.setAttribute("n",ZaDomain.A_domainMaxAccounts)
}
if(s.attrs[ZaDomain.A_zimbraVirtualHostname]){
if(s.attrs[ZaDomain.A_zimbraVirtualHostname] instanceof Array){
var t=s.attrs[ZaDomain.A_zimbraVirtualHostname].length;
for(var o=0;
o<t;
o++){
l=c.set("a",s.attrs[ZaDomain.A_zimbraVirtualHostname][o]);
l.setAttribute("n",ZaDomain.A_zimbraVirtualHostname)
}}else{
l=c.set("a",s.attrs[ZaDomain.A_zimbraVirtualHostname]);
l.setAttribute("n",ZaDomain.A_zimbraVirtualHostname)
}}
if(s.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]){
if(s.attrs[ZaDomain.A_zimbraMailAddressValidationRegex] instanceof Array){
var t=s.attrs[ZaDomain.A_zimbraMailAddressValidationRegex].length;
for(var o=0;
o<t;
o++){
l=c.set("a",s.attrs[ZaDomain.A_zimbraMailAddressValidationRegex][o]);
l.setAttribute("n",ZaDomain.A_zimbraMailAddressValidationRegex)
}}else{
l=c.set("a",s.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]);
l.setAttribute("n",ZaDomain.A_zimbraMailAddressValidationRegex)
}}
if(s.attrs[ZaDomain.A_zimbraAuthKerberos5Realm]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraAuthKerberos5Realm]);
l.setAttribute("n",ZaDomain.A_zimbraAuthKerberos5Realm)
}
if(s.attrs[ZaDomain.A_zimbraForceClearCookies]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraForceClearCookies]);
l.setAttribute("n",ZaDomain.A_zimbraForceClearCookies)
}
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURL]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURL]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURL)
}
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURL]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURL]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURL)
}
if(s.attrs[ZaDomain.A_zimbraReverseProxyClientCertMode]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraReverseProxyClientCertMode]);
l.setAttribute("n",ZaDomain.A_zimbraReverseProxyClientCertMode)
}
if(s.attrs[ZaDomain.A_zimbraMailSSLClientCertPrincipalMap]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraMailSSLClientCertPrincipalMap]);
l.setAttribute("n",ZaDomain.A_zimbraMailSSLClientCertPrincipalMap)
}
if(s.attrs[ZaDomain.A_zimbraReverseProxyClientCertCA]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraReverseProxyClientCertCA]);
l.setAttribute("n",ZaDomain.A_zimbraReverseProxyClientCertCA)
}
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]){
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA] instanceof Array){
var t=s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA].length;
for(var o=0;
o<t;
o++){
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA][o]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedUA)
}}else{
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedUA)
}}
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]){
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA] instanceof Array){
var t=s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA].length;
for(var o=0;
o<t;
o++){
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA][o]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedUA)
}}else{
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedUA)
}}
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP]){
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP] instanceof Array){
var t=s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP].length;
for(var o=0;
o<t;
o++){
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP][o]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedIP)
}}else{
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedIP)
}}
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP]){
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP] instanceof Array){
var t=s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP].length;
for(var o=0;
o<t;
o++){
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP][o]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedIP)
}}else{
l=c.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP]);
l.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedIP)
}}
if(s.attrs[ZaDomain.A_zimbraMailDomainQuota]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraMailDomainQuota]);
l.setAttribute("n",ZaDomain.A_zimbraMailDomainQuota)
}
if(s.attrs[ZaDomain.A_zimbraDomainAggregateQuota]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraDomainAggregateQuota]);
l.setAttribute("n",ZaDomain.A_zimbraDomainAggregateQuota)
}
if(s.attrs[ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent]);
l.setAttribute("n",ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent)
}
if(s.attrs[ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient]);
l.setAttribute("n",ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient)
}
if(s.attrs[ZaDomain.A_zimbraDomainAggregateQuotaPolicy]){
l=c.set("a",s.attrs[ZaDomain.A_zimbraDomainAggregateQuotaPolicy]);
l.setAttribute("n",ZaDomain.A_zimbraDomainAggregateQuotaPolicy)
}
var r=new Object();
r.soapDoc=c;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_DOMAIN};
var n=ZaRequestMgr.invoke(r,e).Body.CreateDomainResponse;
h.initFromJS(n.domain[0])
};
ZaItem.createMethods.ZaDomain.push(ZaDomain.createMethod);
ZaDomain.createGalAccounts=function(t,h){
if(t[ZaDomain.A2_create_gal_acc]&&t[ZaDomain.A2_create_gal_acc]=="TRUE"&&!AjxUtil.isEmpty(t[ZaDomain.A2_gal_sync_accounts_set])){
for(var r in t[ZaDomain.A2_gal_sync_accounts_set]){
var n=t[ZaDomain.A2_gal_sync_accounts_set][r];
if(!n){
continue
}
if(n[ZaDomain.A2_new_gal_sync_account_name]&&(n[ZaDomain.A2_new_internal_gal_ds_name]||n[ZaDomain.A2_new_external_gal_ds_name])){
var d=AjxSoapDoc.create("BatchRequest","urn:zimbra");
d.setMethodAttribute("onerror","stop");
if(n[ZaDomain.A2_new_gal_sync_account_name].indexOf("@")<0){
n[ZaDomain.A2_new_gal_sync_account_name]=[n[ZaDomain.A2_new_gal_sync_account_name],"@",t.attrs[ZaDomain.A_domainName]].join("")
}
if((t.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_internal||t.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_both)&&n[ZaDomain.A2_new_gal_sync_account_name]&&n[ZaDomain.A2_new_internal_gal_ds_name]&&n[ZaDomain.A_mailHost]){
var u=d.set("CreateGalSyncAccountRequest",null,null,ZaZimbraAdmin.URN);
u.setAttribute("name",n[ZaDomain.A2_new_internal_gal_ds_name]);
u.setAttribute("folder","_"+n[ZaDomain.A2_new_internal_gal_ds_name]);
u.setAttribute("type","zimbra");
u.setAttribute("domain",t.attrs[ZaDomain.A_domainName]);
u.setAttribute("server",n[ZaDomain.A_mailHost]);
d.set("account",n[ZaDomain.A2_new_gal_sync_account_name],u).setAttribute("by","name");
d.set("a",n[ZaDomain.A2_new_internal_gal_polling_interval],u).setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}
if(t.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal&&n[ZaDomain.A2_new_gal_sync_account_name]&&n[ZaDomain.A2_new_external_gal_ds_name]&&n[ZaDomain.A_mailHost]){
var m=d.set("CreateGalSyncAccountRequest",null,null,ZaZimbraAdmin.URN);
m.setAttribute("name",n[ZaDomain.A2_new_external_gal_ds_name]);
m.setAttribute("folder","_"+n[ZaDomain.A2_new_external_gal_ds_name]);
m.setAttribute("type","ldap");
m.setAttribute("domain",t.attrs[ZaDomain.A_domainName]);
m.setAttribute("server",n[ZaDomain.A_mailHost]);
d.set("account",n[ZaDomain.A2_new_gal_sync_account_name],m).setAttribute("by","name");
d.set("a",n[ZaDomain.A2_new_external_gal_polling_interval],m).setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}
try{
var s=new Object();
s.soapDoc=d;
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATING_GALDS,showBusy:true};
var e=ZaRequestMgr.invoke(s,o);
if(e.isException&&e.isException()){
ZaApp.getInstance().getCurrentController()._handleException(e.getException(),"ZaDomain.createGalAccounts",null,false);
hasError=true;
lastException=l
}else{
if(e.Body.BatchResponse.Fault){
var c=e.Body.BatchResponse.Fault;
if(c instanceof Array){
c=c[0]
}
if(c){
var l=ZmCsfeCommand.faultToEx(c);
ZaApp.getInstance().getCurrentController()._handleException(l,"ZaDomain.createGalAccounts",null,false);
hasError=true;
lastException=l
}}else{
var f=e.Body.BatchResponse
}}}
catch(l){
ZaApp.getInstance().getCurrentController()._handleException(l,"ZaDomain.createGalAccounts",null,false);
hasError=true;
lastException=l
}}}}};
ZaItem.createMethods.ZaDomain.push(ZaDomain.createGalAccounts);
ZaDomain.canConfigureAuth=function(e){
return(ZaItem.hasRight(ZaDomain.CHECK_AUTH_CONFIG,e)&&ZaItem.hasWritePermission(ZaDomain.A_AuthMech,e)&&ZaItem.hasWritePermission(ZaDomain.A_AuthLdapURL,e)&&ZaItem.hasWritePermission(ZaDomain.A_AuthLdapUserDn,e)&&ZaItem.hasWritePermission(ZaDomain.A_AuthLdapSearchBase,e)&&ZaItem.hasWritePermission(ZaDomain.A_AuthLdapSearchFilter,e)&&ZaItem.hasWritePermission(ZaDomain.A_AuthLdapSearchBindDn,e)&&ZaItem.hasWritePermission(ZaDomain.A_AuthLdapSearchBindPassword,e))
};
ZaDomain.canConfigureGal=function(e){
return(ZaItem.hasWritePermission(ZaDomain.A_zimbraGalAccountId,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraGalMode,e)&&ZaItem.hasWritePermission(ZaDomain.A_GalLdapURL,e)&&ZaItem.hasWritePermission(ZaDomain.A_GalLdapSearchBase,e)&&ZaItem.hasWritePermission(ZaDomain.A_GalLdapBindDn,e)&&ZaItem.hasWritePermission(ZaDomain.A_GalLdapBindPassword,e)&&ZaItem.hasWritePermission(ZaDomain.A_GalLdapFilter,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraGalAutoCompleteLdapFilter,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraGalSyncLdapURL,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraGalSyncLdapSearchBase,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraGalSyncLdapFilter,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraGalSyncLdapBindDn,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraGalSyncLdapBindPassword,e))
};
ZaDomain.canConfigureAutoProv=function(e){
return(ZaItem.hasRight(ZaDomain.A_zimbraAutoProvMode,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvAuthMech,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvLdapURL,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvLdapAdminBindDn,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvLdapAdminBindPassword,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvLdapSearchBase,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvLdapSearchFilter,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvLdapBindDn,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvAccountNameMap,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvAttrMap,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvNotificationFromAddress,e)&&ZaItem.hasWritePermission(ZaDomain.A_zimbraAutoProvBatchSize,e))
};
ZaDomain.testAuthSettings=function(n,h){
var o=AjxSoapDoc.create("CheckAuthConfigRequest",ZaZimbraAdmin.URN,null);
var e=o.set("a",n.attrs[ZaDomain.A_AuthMech]);
e.setAttribute("n",ZaDomain.A_AuthMech);
var t=n.attrs[ZaDomain.A_AuthLdapURL].join(" ");
e=o.set("a",t);
e.setAttribute("n",ZaDomain.A_AuthLdapURL);
if(n.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
e=o.set("a","%u@"+n.attrs[ZaDomain.A_AuthADDomainName]);
e.setAttribute("n",ZaDomain.A_AuthLdapUserDn)
}
if(n.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ldap){
if(n.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]){
e=o.set("a",n.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]);
e.setAttribute("n",ZaDomain.A_zimbraAuthLdapStartTlsEnabled)
}
if(n.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]=="TRUE"){
if(t.indexOf("ldaps://")>-1){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.Domain_WarningStartTLSIgnored)
}}
e=o.set("a",n.attrs[ZaDomain.A_AuthLdapSearchBase]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBase);
e=o.set("a",n.attrs[ZaDomain.A_AuthLdapSearchFilter]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchFilter);
e=o.set("a",n.attrs[ZaDomain.A_AuthLdapSearchBindDn]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBindDn);
e=o.set("a",n.attrs[ZaDomain.A_AuthLdapSearchBindPassword]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBindPassword)
}
e=o.set("name",n[ZaDomain.A_AuthTestUserName]);
e=o.set("password",n[ZaDomain.A_AuthTestPassword]);
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=o;
s.noAuthToken=true;
s.asyncMode=true;
s.callback=h;
r.invoke(s)
};
ZaDomain.getRevokeNotebookACLsRequest=function(s,n){
var t=s.length;
for(var e=0;
e<t;
e++){
var r=n.set("FolderActionRequest",null,null,"urn:zimbraMail");
var o=n.set("action","",r);
o.setAttribute("id",ZaDomain.WIKI_FOLDER_ID);
o.setAttribute("op","!grant");
o.setAttribute("zid",s[e].zid)
}};
ZaDomain.getGrantNotebookACLsRequest=function(r,n){
var h=n.set("FolderActionRequest",null,null,"urn:zimbraMail");
var o=n.set("action","",h);
o.setAttribute("id",ZaDomain.WIKI_FOLDER_ID);
o.setAttribute("op","grant");
var s=n.set("grant","",o);
s.setAttribute("gt",r.gt);
if(r.name){
s.setAttribute("d",r.name)
}
var t="";
for(var e in r.acl){
if(r.acl[e]==1){
t+=e
}}
s.setAttribute("perm",t)
};
ZaDomain.testSyncSettings=function(n,h){
var o=AjxSoapDoc.create("CheckGalConfigRequest",ZaZimbraAdmin.URN,null);
var e=o.set("a",ZaDomain.GAL_Mode_external);
e.setAttribute("n",ZaDomain.A_zimbraGalMode);
var t=n.attrs[ZaDomain.A_GalLdapURL].join(" ");
e=o.set("a",t);
e.setAttribute("n",ZaDomain.A_GalLdapURL);
e=o.set("a",n.attrs[ZaDomain.A_GalLdapSearchBase]);
e.setAttribute("n",ZaDomain.A_GalLdapSearchBase);
e=o.set("a",n.attrs[ZaDomain.A_GalLdapFilter]);
e.setAttribute("n",ZaDomain.A_GalLdapFilter);
if(n.attrs[ZaDomain.A_GalLdapBindDn]){
e=o.set("a",n.attrs[ZaDomain.A_GalLdapBindDn]);
e.setAttribute("n",ZaDomain.A_GalLdapBindDn)
}
if(n.attrs[ZaDomain.A_GalLdapBindPassword]){
e=o.set("a",n.attrs[ZaDomain.A_GalLdapBindPassword]);
e.setAttribute("n",ZaDomain.A_GalLdapBindPassword)
}
if(n.attrs[ZaDomain.A_GALSyncUseGALSearch]=="FALSE"){
if(n.attrs[ZaDomain.A_zimbraGalSyncLdapURL]){
var t=n.attrs[ZaDomain.A_zimbraGalSyncLdapURL].join(" ");
e=o.set("a",t);
e.setAttribute("n",ZaDomain.A_zimbraGalSyncLdapURL)
}
if(n.attrs[ZaDomain.A_zimbraGalSyncLdapSearchBase]){
e=o.set("a",n.attrs[ZaDomain.A_zimbraGalSyncLdapSearchBase]);
e.setAttribute("n",ZaDomain.A_zimbraGalSyncLdapSearchBase)
}
if(n.attrs[ZaDomain.A_zimbraGalSyncLdapFilter]){
e=o.set("a",n.attrs[ZaDomain.A_zimbraGalSyncLdapFilter]);
e.setAttribute("n",ZaDomain.A_zimbraGalSyncLdapFilter)
}
if(n.attrs[ZaDomain.A_zimbraGalSyncLdapBindDn]){
e=o.set("a",n.attrs[ZaDomain.A_zimbraGalSyncLdapBindDn]);
e.setAttribute("n",ZaDomain.A_zimbraGalSyncLdapBindDn)
}
if(n.attrs[ZaDomain.A_zimbraGalSyncLdapBindPassword]){
e=o.set("a",n.attrs[ZaDomain.A_zimbraGalSyncLdapBindPassword]);
e.setAttribute("n",ZaDomain.A_zimbraGalSyncLdapBindPassword)
}}
o.set("action","sync");
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=o;
s.asyncMode=true;
s.noAuthToken=true;
s.callback=h;
r.invoke(s)
};
ZaDomain.testGALSettings=function(s,l,o){
var n=AjxSoapDoc.create("CheckGalConfigRequest",ZaZimbraAdmin.URN,null);
var e=n.set("a",ZaDomain.GAL_Mode_external);
e.setAttribute("n",ZaDomain.A_zimbraGalMode);
var t=s.attrs[ZaDomain.A_GalLdapURL].join(" ");
e=n.set("a",t);
e.setAttribute("n",ZaDomain.A_GalLdapURL);
e=n.set("a",s.attrs[ZaDomain.A_GalLdapSearchBase]);
e.setAttribute("n",ZaDomain.A_GalLdapSearchBase);
e=n.set("a",s.attrs[ZaDomain.A_GalLdapFilter]);
e.setAttribute("n",ZaDomain.A_GalLdapFilter);
if(s.attrs[ZaDomain.A_GalLdapBindDn]){
e=n.set("a",s.attrs[ZaDomain.A_GalLdapBindDn]);
e.setAttribute("n",ZaDomain.A_GalLdapBindDn)
}
if(s.attrs[ZaDomain.A_GalLdapBindPassword]){
e=n.set("a",s.attrs[ZaDomain.A_GalLdapBindPassword]);
e.setAttribute("n",ZaDomain.A_GalLdapBindPassword)
}
n.set("query","*"+o+"*");
n.set("action","search");
var h=new ZmCsfeCommand();
var r=new Object();
r.soapDoc=n;
r.noAuthToken=true;
r.asyncMode=true;
r.callback=l;
h.invoke(r)
};
ZaDomain.modifyGalSettings=function(s){
var u=AjxSoapDoc.create("BatchRequest","urn:zimbra");
u.setMethodAttribute("onerror","stop");
if(s[ZaDomain.A2_create_gal_acc]&&s[ZaDomain.A2_create_gal_acc]=="TRUE"&&!AjxUtil.isEmpty(s[ZaDomain.A2_gal_sync_accounts_set])){
for(var r in s[ZaDomain.A2_gal_sync_accounts_set]){
var g=s[ZaDomain.A2_gal_sync_accounts_set][r];
if(g[ZaDomain.A2_new_gal_sync_account_name].indexOf("@")<0){
g[ZaDomain.A2_new_gal_sync_account_name]=[g[ZaDomain.A2_new_gal_sync_account_name],"@",s.attrs[ZaDomain.A_domainName]].join("")
}
if((s.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_internal||s.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_both)&&g[ZaDomain.A2_new_internal_gal_ds_name]&&g[ZaDomain.A_mailHost]){
var m=u.set("CreateGalSyncAccountRequest",null,null,ZaZimbraAdmin.URN);
m.setAttribute("name",g[ZaDomain.A2_new_internal_gal_ds_name]);
m.setAttribute("folder","_"+g[ZaDomain.A2_new_internal_gal_ds_name]);
m.setAttribute("type","zimbra");
m.setAttribute("domain",s.attrs[ZaDomain.A_domainName]);
m.setAttribute("server",g[ZaDomain.A_mailHost]);
if(g[ZaDomain.A2_new_gal_sync_account_name]){
u.set("account",g[ZaDomain.A2_new_gal_sync_account_name],m).setAttribute("by","name")
}else{
if(s[ZaDomain.A2_gal_sync_accounts]&&s[ZaDomain.A2_gal_sync_accounts][r]){
u.set("account",s[ZaDomain.A2_gal_sync_accounts][r].name,f).setAttribute("by","name")
}}
if(g[ZaDomain.A2_new_internal_gal_polling_interval]){
u.set("a",g[ZaDomain.A2_new_internal_gal_polling_interval],m).setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}}
if(s.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal&&g[ZaDomain.A2_new_external_gal_ds_name]&&g[ZaDomain.A_mailHost]){
var f=u.set("CreateGalSyncAccountRequest",null,null,ZaZimbraAdmin.URN);
f.setAttribute("name",g[ZaDomain.A2_new_external_gal_ds_name]);
f.setAttribute("folder","_"+g[ZaDomain.A2_new_external_gal_ds_name]);
f.setAttribute("type","ldap");
f.setAttribute("domain",s.attrs[ZaDomain.A_domainName]);
f.setAttribute("server",g[ZaDomain.A_mailHost]);
if(g[ZaDomain.A2_new_gal_sync_account_name]){
u.set("account",g[ZaDomain.A2_new_gal_sync_account_name],f).setAttribute("by","name")
}else{
if(s[ZaDomain.A2_gal_sync_accounts]&&s[ZaDomain.A2_gal_sync_accounts][r]){
u.set("account",s[ZaDomain.A2_gal_sync_accounts][r].name,f).setAttribute("by","name")
}}
if(g[ZaDomain.A2_new_external_gal_polling_interval]){
u.set("a",g[ZaDomain.A2_new_external_gal_polling_interval],f).setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}}}}
if(s[ZaDomain.A2_gal_sync_accounts]&&!AjxUtil.isEmpty(s[ZaDomain.A2_gal_sync_accounts])){
for(var r in s[ZaDomain.A2_gal_sync_accounts]){
var y=s[ZaDomain.A2_gal_sync_accounts][r];
if(y[ZaAccount.A2_zimbra_ds]&&y[ZaAccount.A2_zimbra_ds].attrs&&this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_zimbra_ds]&&this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_zimbra_ds].attrs){
if(this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]!=y[ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]){
var n=u.set("ModifyDataSourceRequest",null,null,ZaZimbraAdmin.URN);
u.set("id",this[ZaDomain.A2_gal_sync_accounts][r].id,n);
var o=u.set("dataSource",null,n);
o.setAttribute("id",this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_zimbra_ds].id);
var l=u.set("a",y[ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval],o);
l.setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}}
if(y[ZaAccount.A2_ldap_ds]&&y[ZaAccount.A2_ldap_ds].attrs&&this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_ldap_ds]&&this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_ldap_ds].attrs){
if(this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]!=y[ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]){
var n=u.set("ModifyDataSourceRequest",null,null,ZaZimbraAdmin.URN);
u.set("id",this[ZaDomain.A2_gal_sync_accounts][r].id,n);
var o=u.set("dataSource",null,n);
o.setAttribute("id",this[ZaDomain.A2_gal_sync_accounts][r][ZaAccount.A2_ldap_ds].id);
var l=u.set("a",y[ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval],o);
l.setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}}}}
var h=u.set("ModifyDomainRequest",null,null,ZaZimbraAdmin.URN);
u.set("id",this.id,h);
var l=u.set("a",s.attrs[ZaDomain.A_zimbraGalMode],h);
l.setAttribute("n",ZaDomain.A_zimbraGalMode);
if(s.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal){
var p=s.attrs[ZaDomain.A_GalLdapURL].join(" ");
l=u.set("a",p,h);
l.setAttribute("n",ZaDomain.A_GalLdapURL);
l=u.set("a",s.attrs[ZaDomain.A_GalLdapSearchBase],h);
l.setAttribute("n",ZaDomain.A_GalLdapSearchBase);
l=u.set("a",s.attrs[ZaDomain.A_GalLdapBindDn],h);
l.setAttribute("n",ZaDomain.A_GalLdapBindDn);
l=u.set("a",s.attrs[ZaDomain.A_GalLdapBindPassword],h);
l.setAttribute("n",ZaDomain.A_GalLdapBindPassword);
l=u.set("a",s.attrs[ZaDomain.A_GalLdapFilter],h);
l.setAttribute("n",ZaDomain.A_GalLdapFilter);
l=u.set("a",s.attrs[ZaDomain.A_zimbraGalAutoCompleteLdapFilter],h);
l.setAttribute("n",ZaDomain.A_zimbraGalAutoCompleteLdapFilter)
}
if(s.attrs[ZaDomain.A_zimbraGalMaxResults]!=s.attrs[ZaDomain.A_zimbraGalMaxResults]){
l=u.set("a",s.attrs[ZaDomain.A_zimbraGalMaxResults],h);
l.setAttribute("n",ZaDomain.A_zimbraGalMaxResults)
}
try{
params=new Object();
params.soapDoc=u;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATING_GALDS,showBusy:true};
var e=ZaRequestMgr.invoke(params,t);
if(e.isException&&e.isException()){
ZaApp.getInstance().getCurrentController()._handleException(e.getException(),"ZaDomain.modifyGalSettings",null,false);
hasError=true;
lastException=c
}else{
if(e.Body.BatchResponse.Fault){
var d=e.Body.BatchResponse.Fault;
if(d instanceof Array){
d=d[0]
}
if(d){
var c=ZmCsfeCommand.faultToEx(d);
ZaApp.getInstance().getCurrentController()._handleException(c,"ZaDomain.modifyGalSettings",null,false);
hasError=true;
lastException=c
}}else{
this.refresh(false,true);
ZaDomain.putDomainToCache(this)
}}}
catch(c){
ZaApp.getInstance().getCurrentController()._handleException(c,"ZaDomain.modifyGalSettings",null,false);
hasError=true;
lastException=c
}};
ZaDomain.modifyAuthSettings=function(h){
var n=AjxSoapDoc.create("ModifyDomainRequest",ZaZimbraAdmin.URN,null);
n.set("id",this.id);
var e=n.set("a",h.attrs[ZaDomain.A_AuthMech]);
e.setAttribute("n",ZaDomain.A_AuthMech);
if(h.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
var t=h.attrs[ZaDomain.A_AuthLdapURL].join(" ");
e=n.set("a",t);
e.setAttribute("n",ZaDomain.A_AuthLdapURL);
e=n.set("a","%u@"+h.attrs[ZaDomain.A_AuthADDomainName]);
e.setAttribute("n",ZaDomain.A_AuthLdapUserDn);
if(h[ZaDomain.A_AuthUseBindPassword]&&h[ZaDomain.A_AuthUseBindPassword]=="TRUE"){
e=n.set("a",h.attrs[ZaDomain.A_AuthLdapSearchBindDn]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBindDn);
e=n.set("a",h.attrs[ZaDomain.A_AuthLdapSearchBindPassword]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBindPassword)
}}else{
if(h.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ldap){
if(h.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]){
e=n.set("a",h.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]);
e.setAttribute("n",ZaDomain.A_zimbraAuthLdapStartTlsEnabled)
}
var t=h.attrs[ZaDomain.A_AuthLdapURL].join(" ");
if(h.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]=="TRUE"){
if(t.indexOf("ldaps://")>-1){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.Domain_WarningStartTLSIgnored)
}}
e=n.set("a",t);
e.setAttribute("n",ZaDomain.A_AuthLdapURL);
e=n.set("a",h.attrs[ZaDomain.A_AuthLdapSearchFilter]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchFilter);
e=n.set("a",h.attrs[ZaDomain.A_AuthLdapSearchBase]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBase);
if(h[ZaDomain.A_AuthUseBindPassword]&&h[ZaDomain.A_AuthUseBindPassword]=="TRUE"){
e=n.set("a",h.attrs[ZaDomain.A_AuthLdapSearchBindDn]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBindDn);
e=n.set("a",h.attrs[ZaDomain.A_AuthLdapSearchBindPassword]);
e.setAttribute("n",ZaDomain.A_AuthLdapSearchBindPassword)
}}}
if(h.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra&&h[ZaDomain.A2_zimbraExternalGroupLdapEnabled]=="TRUE"){
if(h.attrs[ZaDomain.A_zimbraExternalGroupLdapSearchBase]&&h.attrs[ZaDomain.A_zimbraExternalGroupLdapSearchFilter]&&h.attrs[ZaDomain.A_zimbraExternalGroupHandlerClass]){
e=n.set("a",h.attrs[ZaDomain.A_zimbraExternalGroupLdapSearchBase]);
e.setAttribute("n",ZaDomain.A_zimbraExternalGroupLdapSearchBase);
e=n.set("a",h.attrs[ZaDomain.A_zimbraExternalGroupLdapSearchFilter]);
e.setAttribute("n",ZaDomain.A_zimbraExternalGroupLdapSearchFilter);
e=n.set("a",h.attrs[ZaDomain.A_zimbraExternalGroupHandlerClass]);
e.setAttribute("n",ZaDomain.A_zimbraExternalGroupHandlerClass);
e=n.set("a",h.attrs[ZaDomain.A_zimbraAuthMechAdmin]);
e.setAttribute("n",ZaDomain.A_zimbraAuthMechAdmin)
}}
ZaDomain.modifySSOSettings(n,h);
var r=new Object();
r.soapDoc=n;
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_DOMAIN};
var s=ZaRequestMgr.invoke(r,o).Body.ModifyDomainResponse;
this.initFromJS(s.domain[0]);
ZaDomain.putDomainToCache(this)
};
ZaDomain.modifySSOSettings=function(n,s){
if(s.attrs[ZaDomain.A_zimbraVirtualHostname]){
if(s.attrs[ZaDomain.A_zimbraVirtualHostname] instanceof Array){
var o=s.attrs[ZaDomain.A_zimbraVirtualHostname].length;
for(var t=0;
t<o;
t++){
var e=n.set("a",s.attrs[ZaDomain.A_zimbraVirtualHostname][t]);
e.setAttribute("n",ZaDomain.A_zimbraVirtualHostname)
}}else{
var e=n.set("a",s.attrs[ZaDomain.A_zimbraVirtualHostname]);
e.setAttribute("n",ZaDomain.A_zimbraVirtualHostname)
}}
if(s[ZaDomain.A2_zimbraSpnegoUAAllBrowsers]=="TRUE"||s[ZaDomain.A2_zimbraSpnegoUASupportedBrowsers]=="TRUE"){
s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]=ZaDomain.SPNEGO_SUPPORT_UA;
s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]=ZaDomain.SPNEGO_SUPPORT_UA
}
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]){
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA] instanceof Array){
var o=s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA].length;
for(var t=0;
t<o;
t++){
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA][t]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedUA)
}}else{
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedUA)
}}
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]){
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA] instanceof Array){
var o=s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA].length;
for(var t=0;
t<o;
t++){
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA][t]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedUA)
}}else{
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedUA)
}}
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP]){
if(s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP] instanceof Array){
var o=s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP].length;
for(var t=0;
t<o;
t++){
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP][t]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedIP)
}}else{
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLoginURLAllowedIP)
}}
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP]){
if(s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP] instanceof Array){
var o=s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP].length;
for(var t=0;
t<o;
t++){
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP][t]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedIP)
}}else{
var e=n.set("a",s.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP]);
e.setAttribute("n",ZaDomain.A_zimbraWebClientLogoutURLAllowedIP)
}}};
ZaDomain.modifyAutoPovSettings=function(v){
var w=AjxSoapDoc.create("BatchRequest","urn:zimbra");
w.setMethodAttribute("onerror","stop");
var g=w.set("ModifyDomainRequest",null,null,ZaZimbraAdmin.URN);
w.set("id",this.id,g);
var l;
if(v.attrs[ZaDomain.A_zimbraAutoProvMode]){
if(v.attrs[ZaDomain.A_zimbraAutoProvMode] instanceof Array){
var u=v.attrs[ZaDomain.A_zimbraAutoProvMode].length;
for(var m=0;
m<u;
m++){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvMode][m],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvMode)
}
if(u==0){
l=w.set("a","",g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvMode)
}}else{
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvMode],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvMode)
}}
if(v.attrs[ZaDomain.A_zimbraAutoProvAuthMech]){
if(v.attrs[ZaDomain.A_zimbraAutoProvAuthMech] instanceof Array&&v.attrs[ZaDomain.A_zimbraAutoProvAuthMech].length>0){
var u=v.attrs[ZaDomain.A_zimbraAutoProvAuthMech].length;
for(var m=0;
m<u;
m++){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvAuthMech][m],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvAuthMech)
}}else{
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvAuthMech],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvAuthMech)
}}
if(v.attrs[ZaDomain.A_zimbraAutoProvAttrMap]){
if((v.attrs[ZaDomain.A_zimbraAutoProvAttrMap] instanceof Array)&&v.attrs[ZaDomain.A_zimbraAutoProvAttrMap].length>0){
var u=v.attrs[ZaDomain.A_zimbraAutoProvAttrMap].length;
for(var m=0;
m<u;
m++){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvAttrMap][m],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvAttrMap)
}}else{
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvAttrMap],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvAttrMap)
}}
if(v.attrs[ZaDomain.A_zimbraAutoProvLdapURL]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLdapURL],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLdapURL)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLdapAdminBindDn)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLdapAdminBindPassword)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLdapSearchBase)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLdapSearchFilter)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLdapBindDn)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvAccountNameMap]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvAccountNameMap],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvAccountNameMap)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvNotificationFromAddress]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvNotificationFromAddress],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvNotificationFromAddress)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvBatchSize]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvBatchSize],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvBatchSize)
}
if(v.attrs[ZaDomain.A_zimbraAutoProvLastPolledTimestamp]){
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvLastPolledTimestamp],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvLastPolledTimestamp)
}
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvNotificationSubject],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvNotificationSubject);
l=w.set("a",v.attrs[ZaDomain.A_zimbraAutoProvNotificationBody],g);
l.setAttribute("n",ZaDomain.A_zimbraAutoProvNotificationBody);
if(v[ZaDomain.A2_zimbraAutoProvSelectedServerList]&&v[ZaDomain.A2_zimbraAutoProvSelectedServerList].getArray().length>0){
var t=null;
var b=v[ZaDomain.A2_zimbraAutoProvSelectedServerList].getArray();
var n=v[ZaDomain.A2_zimbraAutoProvServerList];
var u=b.length;
for(var m=0;
m<u;
m++){
var h=null;
for(var d=0;
d<n.length;
d++){
if(b[m]==n[d].name){
h=n[d]
}}
if(h){
var p=h.attrs[ZaServer.A_zimbraAutoProvScheduledDomains];
t=w.set("ModifyServerRequest",null,null,ZaZimbraAdmin.URN);
w.set("id",h.id,t);
var e=false;
for(var m=0;
p&&m<p.length;
m++){
l=w.set("a",p[m],t);
l.setAttribute("n",ZaServer.A_zimbraAutoProvScheduledDomains);
if(p[m]==this.name){
e=true
}}
if(!e){
l=w.set("a",this.name,t);
l.setAttribute("n",ZaServer.A_zimbraAutoProvScheduledDomains)
}
if(v[ZaDomain.A2_zimbraAutoProvPollingInterval]){
l=w.set("a",v[ZaDomain.A2_zimbraAutoProvPollingInterval],t);
l.setAttribute("n",ZaServer.A_zimbraAutoProvPollingInterval)
}}}}
try{
params=new Object();
params.soapDoc=w;
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_DOMAIN,showBusy:true};
var y=ZaRequestMgr.invoke(params,o);
if(y.isException&&y.isException()){
ZaApp.getInstance().getCurrentController()._handleException(y.getException(),"ZaDomain.modifyAutoPovSettings",null,false);
hasError=true;
lastException=f
}else{
if(y.Body.BatchResponse.Fault){
var s=y.Body.BatchResponse.Fault;
if(s instanceof Array){
s=s[0]
}
if(s){
var f=ZmCsfeCommand.faultToEx(s);
ZaApp.getInstance().getCurrentController()._handleException(f,"ZaDomain.modifyGalSettings",null,false);
hasError=true;
lastException=f
}}else{
var c=y.Body.BatchResponse;
var r=c.ModifyDomainResponse[0];
this.initFromJS(r.domain[0])
}}}
catch(f){
ZaApp.getInstance().getCurrentController()._handleException(f,"ZaDomain.modifyAutoPovSettings",null,false);
hasError=true;
lastException=f
}
this.refresh(false,true);
ZaDomain.putDomainToCache(this)
};
ZaDomain.prototype.setStatus=function(e){
var o=AjxSoapDoc.create("ModifyDomainStatusRequest",ZaZimbraAdmin.URN,null);
o.set("id",this.id);
var s=new Object();
s.soapDoc=o;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_DOMAIN_STATUS};
var n=ZaRequestMgr.invoke(s,t).Body.ModifyDomainStatusResponse;
this.attrs[ZaDomain.A_zimbraDomainStatus]=n.domain.status
};
ZaDomain.modifyMethod=function(p,x){
var k=AjxSoapDoc.create("BatchRequest","urn:zimbra");
k.setMethodAttribute("onerror","stop");
var s=p;
if(ZaItem.modifyMethodsExt.ZaDomain){
var b=ZaItem.modifyMethodsExt.ZaDomain;
var u=b.length;
for(var m=0;
m<u;
m++){
if(typeof(b[m])=="function"){
b[m].call(this,s,x,k)
}}}
var w=k.set("ModifyDomainRequest",null,null,ZaZimbraAdmin.URN);
k.set("id",this.id,w);
for(var y in s){
gotSomething=true;
if(s[y] instanceof Array){
var u=s[y].length;
if(u){
var t=false;
for(var n=0;
n<u;
n++){
var c=null;
if(s[y][n] instanceof String||AjxUtil.isString(s[y][n])){
if(AjxUtil.isEmpty(s[y][n])){
continue
}else{
t=true
}
var c=k.set("a",s[y][n].toString(),w)
}else{
if(s[y][n] instanceof Object){
var c=k.set("a",s[y][n].toString(),w);
t=true
}else{
var c=k.set("a",s[y][n],w);
t=true
}}
if(c){
c.setAttribute("n",y)
}}
if(!t){
var c=k.set("a","",w);
c.setAttribute("n",y)
}}else{
var c=k.set("a","",w);
c.setAttribute("n",y)
}}else{
var c=k.set("a",s[y],w);
c.setAttribute("n",y)
}}
if(x[ZaDomain.A2_gal_sync_accounts]&&!AjxUtil.isEmpty(x[ZaDomain.A2_gal_sync_accounts])){
for(var m in x[ZaDomain.A2_gal_sync_accounts]){
var e=x[ZaDomain.A2_gal_sync_accounts][m];
if(e){
if(e[ZaAccount.A2_zimbra_ds]&&e[ZaAccount.A2_zimbra_ds].attrs&&this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_zimbra_ds]&&this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_zimbra_ds].attrs){
if(this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]!=e[ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]){
var f=k.set("ModifyDataSourceRequest",null,null,ZaZimbraAdmin.URN);
k.set("id",this[ZaDomain.A2_gal_sync_accounts][m].id,f);
var h=k.set("dataSource",null,f);
h.setAttribute("id",this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_zimbra_ds].id);
var c=k.set("a",e[ZaAccount.A2_zimbra_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval],h);
c.setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}}
if(e[ZaAccount.A2_ldap_ds]&&e[ZaAccount.A2_ldap_ds].attrs&&this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_ldap_ds]&&this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_ldap_ds].attrs){
if(this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]!=e[ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval]){
var f=k.set("ModifyDataSourceRequest",null,null,ZaZimbraAdmin.URN);
k.set("id",this[ZaDomain.A2_gal_sync_accounts][m].id,f);
var h=k.set("dataSource",null,f);
h.setAttribute("id",this[ZaDomain.A2_gal_sync_accounts][m][ZaAccount.A2_ldap_ds].id);
var c=k.set("a",e[ZaAccount.A2_ldap_ds].attrs[ZaDataSource.A_zimbraDataSourcePollingInterval],h);
c.setAttribute("n",ZaDataSource.A_zimbraDataSourcePollingInterval)
}}}}}
try{
params=new Object();
params.soapDoc=k;
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_DOMAIN,showBusy:true};
var v=ZaRequestMgr.invoke(params,o);
if(v.isException&&v.isException()){
ZaApp.getInstance().getCurrentController()._handleException(v.getException(),"ZaDomain.modifyGalSettings",null,false);
hasError=true;
lastException=g
}else{
if(v.Body.BatchResponse.Fault){
var r=v.Body.BatchResponse.Fault;
if(r instanceof Array){
r=r[0]
}
if(r){
var g=ZmCsfeCommand.faultToEx(r);
ZaApp.getInstance().getCurrentController()._handleException(g,"ZaDomain.modifyGalSettings",null,false);
hasError=true;
lastException=g
}}else{
var d=v.Body.BatchResponse;
var l=d.ModifyDomainResponse[0];
this.initFromJS(l.domain[0])
}}}
catch(g){
ZaApp.getInstance().getCurrentController()._handleException(g,"ZaDomain.modifyGalSettings",null,false);
hasError=true;
lastException=g
}
this.refresh(false,true);
ZaDomain.putDomainToCache(this)
};
ZaItem.modifyMethods.ZaDomain.push(ZaDomain.modifyMethod);
ZaDomain.getAccountQuota=function(e,h,r,f,c,p){
var u=AjxSoapDoc.create("GetQuotaUsageRequest",ZaZimbraAdmin.URN,null);
if(f==null||f==ZaAccountQuota.A2_diskUsage){
f="totalUsed"
}else{
if(f==ZaAccountQuota.A2_quotaUsage){
f="percentUsed"
}else{
if(f==ZaAccountQuota.A2_quota){
f="quotaLimit"
}else{
if(f==ZaAccountQuota.A2_name){
f="account"
}else{
f="totalUsed"
}}}}
u.getMethod().setAttribute("sortBy",f);
if(c){
u.getMethod().setAttribute("sortAscending",c)
}
r=r?r:ZaSettings.RESULTSPERPAGE;
u.getMethod().setAttribute("offset",h);
u.getMethod().setAttribute("limit",ZaServerMBXStatsPage.MBX_DISPLAY_LIMIT);
u.getMethod().setAttribute("refresh","1");
if(e){
u.getMethod().setAttribute("domain",e);
u.getMethod().setAttribute("allServers","1")
}
var s=new Object();
s.soapDoc=u;
var m=p?true:false;
if(m){
s.asyncMode=true;
s.callback=p
}
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_QUOTA};
var n=ZaRequestMgr.invoke(s,o);
if(m){
return n
}else{
n=n.Body.GetQuotaUsageResponse
}
var g={
hasMore:false,mbxes:new Array()};
if((n.account&&n.account.length>0)&&(n.searchTotal&&n.searchTotal>0)){
g.hasMore=n.more;
var t=n.account;
var d=new Array();
for(var l=0;
l<t.length;
l++){
d[l]=new ZaAccountQuota(t[l])
}
g.mbxes=d
}
return g
};
ZaDomain.prototype.initFromJS=function(t){
ZaItem.prototype.initFromJS.call(this,t);
if(!(this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts] instanceof Array)){
if(this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts]){
this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts]=[this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts]]
}else{
this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts]=[]
}}
if(!(this.attrs[ZaDomain.A_zimbraDomainFeatureMaxAccounts] instanceof Array)){
if(this.attrs[ZaDomain.A_zimbraDomainFeatureMaxAccounts]){
this.attrs[ZaDomain.A_zimbraDomainFeatureMaxAccounts]=[this.attrs[ZaDomain.A_zimbraDomainFeatureMaxAccounts]]
}else{
this.attrs[ZaDomain.A_zimbraDomainFeatureMaxAccounts]=[]
}}
if(!(this.attrs[ZaDomain.A_zimbraVirtualHostname] instanceof Array)){
if(this.attrs[ZaDomain.A_zimbraVirtualHostname]){
this.attrs[ZaDomain.A_zimbraVirtualHostname]=[this.attrs[ZaDomain.A_zimbraVirtualHostname]]
}else{
this.attrs[ZaDomain.A_zimbraVirtualHostname]=new Array()
}}
if(!(this.attrs[ZaDomain.A_zimbraMailAddressValidationRegex] instanceof Array)){
if(this.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]){
this.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]=[this.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]]
}else{
this.attrs[ZaDomain.A_zimbraMailAddressValidationRegex]=new Array()
}}
if(AjxUtil.isString(this.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA])){
this.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA]]
}
if(AjxUtil.isString(this.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA])){
this.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA]]
}
if(AjxUtil.isString(this.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP])){
this.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedIP]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP]]
}
if(AjxUtil.isString(this.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP])){
this.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedIP]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP]]
}
if(!this.attrs[ZaDomain.A_AuthMech]){
this.attrs[ZaDomain.A_AuthMech]=ZaDomain.AuthMech_zimbra
}
if(!this.attrs[ZaDomain.A_zimbraGalMode]){
this.attrs[ZaDomain.A_zimbraGalMode]=ZaDomain.GAL_Mode_internal
}
if(this.attrs[ZaDomain.A_AuthLdapURL]){
var e=this.attrs[ZaDomain.A_AuthLdapURL];
this.attrs[ZaDomain.A_AuthLdapURL]=e.split(" ")
}else{
this.attrs[ZaDomain.A_AuthLdapURL]=new Array()
}
if(this.attrs[ZaDomain.A_GalLdapURL]){
var e=this.attrs[ZaDomain.A_GalLdapURL];
this.attrs[ZaDomain.A_GalLdapURL]=e.split(" ")
}else{
this.attrs[ZaDomain.A_GalLdapURL]=new Array()
}
if(this.attrs[ZaDomain.A_zimbraGalMode]){
if(this.attrs[ZaDomain.A_zimbraGalMode]=="ldap"||this.attrs[ZaDomain.A_zimbraGalMode]=="both"){
if(this.attrs[ZaDomain.A_GalLdapFilter]=="ad"){
this.attrs[ZaDomain.A_GALServerType]="ad"
}else{
this.attrs[ZaDomain.A_GALServerType]="ldap"
}
if(!this.attrs[ZaDomain.A_zimbraGalSyncLdapURL]){
this.attrs[ZaDomain.A_GALSyncUseGALSearch]="TRUE"
}else{
this.attrs[ZaDomain.A_GALSyncUseGALSearch]="FALSE";
if(this.attrs[ZaDomain.A_zimbraGalSyncLdapBindDn]||this.attrs[ZaDomain.A_zimbraGalSyncLdapBindPassword]){
this.attrs[ZaDomain.A_SyncUseBindPassword]="TRUE"
}else{
this.attrs[ZaDomain.A_SyncUseBindPassword]="FALSE"
}
if(this.attrs[ZaDomain.A_zimbraGalSyncLdapFilter]=="ad"){
this.attrs[ZaDomain.A_GALSyncServerType]="ad"
}else{
this.attrs[ZaDomain.A_GALSyncServerType]="ldap"
}}}else{
this.attrs[ZaDomain.A_GALSyncUseGALSearch]="TRUE"
}}else{
this.attrs[ZaDomain.A_zimbraGalMode]="zimbra";
this.attrs[ZaDomain.A_GALSyncUseGALSearch]="TRUE"
}
if(this.attrs[ZaDomain.A_GalLdapBindDn]||this.attrs[ZaDomain.A_GalLdapBindPassword]){
this.attrs[ZaDomain.A_UseBindPassword]="TRUE"
}else{
this.attrs[ZaDomain.A_UseBindPassword]="FALSE"
}
if(!AjxUtil.isEmpty(this.attrs[ZaDomain.A_AuthLdapUserDn])){
this.attrs[ZaDomain.A_AuthADDomainName]=ZaAccount.getDomain(this.attrs[ZaDomain.A_AuthLdapUserDn])
}
if(this.attrs[ZaDomain.A_AuthLdapSearchBindDn]||this.attrs[ZaDomain.A_AuthLdapSearchBindPassword]){
this[ZaDomain.A_AuthUseBindPassword]="TRUE"
}else{
this[ZaDomain.A_AuthUseBindPassword]="FALSE"
}
this[ZaDomain.A_GALSampleQuery]="john";
if(!this.attrs[ZaDomain.A_zimbraGalAutoCompleteLdapFilter]){
this.attrs[ZaDomain.A_zimbraGalAutoCompleteLdapFilter]="(|(cn=%s*)(sn=%s*)(gn=%s*)(mail=%s*))"
}
if(this.attrs[ZaDomain.A_zimbraFreebusyExchangeAuthPassword]&&(this.attrs[ZaDomain.A_zimbraFreebusyExchangeAuthPassword]=="VALUE-BLOCKED")){
this.attrs[ZaDomain.A_zimbraFreebusyExchangeAuthPassword]=""
}};
ZaDomain.prototype.parseNotebookFolderAcls=function(h){
try{
if(h.isException&&h.isException()){
throw (h.getException())
}
var n;
if(h.getResponse){
n=h.getResponse().Body.GetFolderResponse
}else{
n=h.Body.GetFolderResponse
}
if(n&&n.folder&&n.folder[0]&&n.folder[0].acl&&n.folder[0].acl.grant){
var t=n.folder[0].acl.grant;
var r=t.length;
this[ZaDomain.A_allNotebookACLS]=[];
for(var e=0;
e<r;
e++){
var o=t[e];
var l={
r:o.perm.indexOf("r")>=0?1:0,w:o.perm.indexOf("w")>=0?1:0,i:o.perm.indexOf("i")>=0?1:0,d:o.perm.indexOf("d")>=0?1:0,a:o.perm.indexOf("a")>=0?1:0,x:o.perm.indexOf("x")>=0?1:0,toString:function(){
return this.r+this.w+this.i+this.d+this.a+this.x
}};
this[ZaDomain.A_allNotebookACLS].push({
acl:l,name:o.d,zid:o.zid,gt:o.gt,toString:function(){
return(this.gt+":"+this.name+":"+this.grantObj.toString())
}}
)
}
this[ZaDomain.A_allNotebookACLS]._version=0
}}
catch(s){
ZaApp.getInstance().getCurrentController()._handleException(s,"ZaDomain.prototype.parseNotebookFolderAcls",null,false)
}};
ZaDomain.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table cellpadding='0' cellspacing='0' border='0'>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;width:350'>";
t[e++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
t[e++]=AjxImg.getImageHtml("Domain");
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
e=this._addAttrRow(ZaItem.A_description,t,e);
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaDomain.prototype.remove=function(n){
var t=AjxSoapDoc.create("DeleteDomainRequest",ZaZimbraAdmin.URN,null);
t.set("id",this.id);
var o=new Object();
o.soapDoc=t;
if(n){
o.asyncMode=true;
o.callback=n
}
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_DELETE_DOMAIN};
ZaRequestMgr.invoke(o,e)
};
ZaDomain.getLoginMessage=function(){
var e=ZaDomain.getDomainByName(ZaSettings.myDomainName,true);
return e.attrs[ZaDomain.A_zimbraAdminConsoleLoginMessage]
};
ZaDomain.getDomainByName=function(e){
if(!e){
return null
}
e=e.toLowerCase();
var o=ZaDomain.staticDomainByNameCacheTable[e];
if(!o){
o=new ZaDomain();
try{
o.load("name",e,false,true)
}
catch(t){
throw (t)
}
ZaDomain.putDomainToCache(o)
}
return o
};
ZaDomain.getDomainById=function(o){
if(!o){
return null
}
var t=ZaDomain.staticDomainByIdCacheTable[o];
if(!t){
t=new ZaDomain();
try{
t.load("id",o,false,true)
}
catch(e){
if(e.code==ZmCsfeException.NO_SUCH_DOMAIN){
return null
}else{
throw (e)
}}
ZaDomain.putDomainToCache(t)
}
return t
};
ZaDomain.loadMethod=function(n,l){
n=n?n:"name";
l=l?l:this.attrs[ZaDomain.A_domainName];
this.notebookAcls[ZaDomain.A_NotebookAllACLs]={
r:0,w:0,i:0,d:0,a:0,x:0};
this.notebookAcls[ZaDomain.A_NotebookPublicACLs]={
r:0,w:0,i:0,d:0,a:0,x:0};
this.notebookAcls[ZaDomain.A_NotebookDomainACLs]={
r:1,w:1,i:1,d:1,a:0,x:0};
this.notebookAcls[ZaDomain.A_NotebookUserACLs]=[];
this.notebookAcls[ZaDomain.A_NotebookGroupACLs]=[];
var o=AjxSoapDoc.create("GetDomainRequest",ZaZimbraAdmin.URN,null);
o.getMethod().setAttribute("applyConfig","false");
var e=o.set("domain",l);
e.setAttribute("by",n);
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
o.setMethodAttribute("attrs",this.attrsToGet.join(","))
}
var h=new Object();
h.soapDoc=o;
var t={
controller:(ZaApp.getInstance()?ZaApp.getInstance().getCurrentController():null),busyMsg:ZaMsg.BUSY_GET_DOMAIN};
var r=ZaRequestMgr.invoke(h,t);
if(r.isException&&r.isException()){
if(ZaApp.getInstance()&&ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController()._handleException(r.getException(),"ZaDomain.loadMethod",null,false)
}}else{
var s=r.Body.GetDomainResponse;
this.initFromJS(s.domain[0])
}};
ZaItem.loadMethods.ZaDomain.push(ZaDomain.loadMethod);
ZaDomain.loadDataSources=function(n,s){
if(this.attrs[ZaDomain.A_zimbraGalAccountId]){
if(!(this.attrs[ZaDomain.A_zimbraGalAccountId] instanceof Array)){
this.attrs[ZaDomain.A_zimbraGalAccountId]=[this.attrs[ZaDomain.A_zimbraGalAccountId]]
}
this[ZaDomain.A2_gal_sync_accounts]=[];
for(var t=0;
t<this.attrs[ZaDomain.A_zimbraGalAccountId].length;
t++){
try{
var o=new ZaAccount();
o.load("id",this.attrs[ZaDomain.A_zimbraGalAccountId][t],false,false);
this[ZaDomain.A2_gal_sync_accounts].push(o)
}
catch(e){
if(e.code==ZmCsfeException.ACCT_NO_SUCH_ACCOUNT){
if(ZaApp.getInstance()&&ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_GALSYNC_ACCOUNT_INVALID,[this.name,this.attrs[ZaDomain.A_zimbraGalAccountId][t]]),e,true)
}}else{
if(ZaApp.getInstance()&&ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaDomain.loadDataSources",null,false)
}}}}}};
ZaItem.loadMethods.ZaDomain.push(ZaDomain.loadDataSources);
ZaDomain.loadNotebookACLs=function(s,h){
if(this.attrs[ZaDomain.A_zimbraDomainStatus]!=ZaDomain.DOMAIN_STATUS_MAINTENANCE&&this.attrs[ZaDomain.A_zimbraDomainStatus]!=ZaDomain.DOMAIN_STATUS_SUSPENDED){
if(this.attrs[ZaDomain.A_zimbraNotebookAccount]){
var o=AjxSoapDoc.create("GetFolderRequest","urn:zimbraMail",null);
var e=new ZmCsfeCommand();
var r=new Object();
r.soapDoc=o;
r.noAuthToken=true;
r.accountName=this.attrs[ZaDomain.A_zimbraNotebookAccount];
var n=o.set("folder","");
n.setAttribute("l",ZaDomain.WIKI_FOLDER_ID);
try{
this.parseNotebookFolderAcls(e.invoke(r))
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaDomain.loadMethod",null,false)
}}}};
ZaItem.loadMethods.ZaDomain.push(ZaDomain.loadNotebookACLs);
ZaDomain.loadCatchAll=function(){
if((this.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled]&&this.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled]=="TRUE")||(AjxUtil.isEmpty(this.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled])&&(!AjxUtil.isEmpty(this._defaultValues.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled])&&this._defaultValues.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled]=="TRUE"))){
var e=ZaAccount.getCatchAllAccount(this.name);
if(!AjxUtil.isEmpty(e)&&!AjxUtil.isEmpty(e.id)&&!AjxUtil.isEmpty(e.name)){
this[ZaAccount.A_zimbraMailCatchAllAddress]=e
}else{
this[ZaAccount.A_zimbraMailCatchAllAddress]=null
}}else{
this[ZaAccount.A_zimbraMailCatchAllAddress]=null
}};
ZaItem.loadMethods.ZaDomain.push(ZaDomain.loadCatchAll);
ZaDomain.checkDomainMXRecord=function(n,r){
var o=AjxSoapDoc.create("CheckDomainMXRecordRequest",ZaZimbraAdmin.URN,null);
var e=o.set("domain",n.id);
e.setAttribute("by","id");
var s=new Object();
s.soapDoc=o;
if(r){
s.asyncMode=true;
s.callback=r
}
var t={
controller:(ZaApp.getInstance()?ZaApp.getInstance().getCurrentController():null),busyMsg:ZaMsg.BUSY_CHECKING_MX};
ZaRequestMgr.invoke(s,t)
};
ZaDomain.aclXModel={
items:[{
id:"acl",type:_OBJECT_,items:[{
id:"r",type:_NUMBER_}
,{
id:"w",type:_NUMBER_}
,{
id:"d",type:_NUMBER_}
,{
id:"i",type:_NUMBER_}
,{
id:"a",type:_NUMBER_}
,{
id:"x",type:_NUMBER_}
]}
,{
id:"name",type:_STRING_}
,{
id:"gt",type:_STRING_}
]};
ZaDomain.myXModel={
items:[{
id:"getAttrs",type:_LIST_}
,{
id:"setAttrs",type:_LIST_}
,{
id:"rights",type:_LIST_}
,{
id:"name",type:_STRING_,ref:"name"}
,{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:ZaItem.A_zimbraDomainAliasTargetId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraDomainAliasTargetId}
,{
id:ZaItem.A_zimbraCreateTimestamp,ref:"attrs/"+ZaItem.A_zimbraCreateTimestamp}
,{
id:ZaDomain.A_domainName,type:_STRING_,ref:"attrs/"+ZaDomain.A_domainName,maxLength:255,constraints:{
type:"method",value:function(e){
e=e.replace(/(^\s*)/g,"");
return AjxStringUtil.htmlEncode(e)
}}}
,{
id:ZaDomain.A_zimbraPublicServiceHostname,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraPublicServiceHostname,maxLength:255}
,{
id:ZaDomain.A_zimbraPublicServiceProtocol,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraPublicServiceProtocol,maxLength:255,defaultValue:"http"}
,{
id:ZaDomain.A_zimbraPublicServicePort,type:_NUMBER_,ref:"attrs/"+ZaDomain.A_zimbraPublicServicePort,minInclusive:0,maxInclusive:65535,defaultValue:80}
,{
id:ZaDomain.A_zimbraDNSCheckHostname,type:_COS_STRING_,ref:"attrs/"+ZaDomain.A_zimbraDNSCheckHostname,maxLength:255}
,{
id:ZaDomain.A_zimbraBasicAuthRealm,type:_COS_STRING_,ref:"attrs/"+ZaDomain.A_zimbraBasicAuthRealm,maxLength:255}
,{
id:ZaDomain.A_zimbraAdminConsoleDNSCheckEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_zimbraAdminConsoleDNSCheckEnabled}
,{
id:ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled}
,{
id:ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled}
,{
id:ZaDomain.A_zimbraAdminConsoleSkinEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_zimbraAdminSkinAddressEnabled}
,{
id:ZaDomain.A_zimbraMailAddressValidationRegex,type:_LIST_,listItem:{
type:_STRING_,maxLength:512}
,ref:"attrs/"+ZaDomain.A_zimbraMailAddressValidationRegex}
,{
id:ZaDomain.A_zimbraVirtualHostname,type:_LIST_,listItem:{
type:_STRING_,maxLength:255}
,ref:"attrs/"+ZaDomain.A_zimbraVirtualHostname}
,ZaItem.descriptionModelItem,{
id:ZaDomain.A_zimbraSSLCertificate,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraSSLCertificate}
,{
id:ZaDomain.A_zimbraSSLPrivateKey,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraSSLPrivateKey}
,{
id:ZaDomain.A_notes,type:_STRING_,ref:"attrs/"+ZaDomain.A_notes}
,{
id:ZaDomain.A_domainDefaultCOSId,type:_STRING_,ref:"attrs/"+ZaDomain.A_domainDefaultCOSId}
,{
id:ZaDomain.A_zimbraGalMode,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraGalMode}
,{
id:ZaDomain.A_mailHost,type:_STRING_,ref:"attrs/"+ZaDomain.A_mailHost}
,{
id:ZaDomain.A_zimbraGalMaxResults,type:_NUMBER_,ref:"attrs/"+ZaDomain.A_zimbraGalMaxResults,maxInclusive:2147483647,minInclusive:1}
,{
id:ZaDomain.A_GALServerType,type:_STRING_,ref:"attrs/"+ZaDomain.A_GALServerType}
,{
id:ZaDomain.A_GALSyncServerType,type:_STRING_,ref:"attrs/"+ZaDomain.A_GALSyncServerType}
,{
id:ZaDomain.A_GALSyncUseGALSearch,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_GALSyncUseGALSearch}
,{
id:ZaDomain.A_zimbraGalSyncLdapBindDn,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraGalSyncLdapBindDn}
,{
id:ZaDomain.A_zimbraGalSyncLdapBindPassword,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraGalSyncLdapBindPassword}
,{
id:ZaDomain.A_zimbraGalSyncLdapSearchBase,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraGalSyncLdapSearchBase}
,{
id:ZaDomain.A_zimbraGalSyncLdapFilter,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraGalSyncLdapFilter,required:true}
,{
id:ZaDomain.A_GalLdapFilter,type:_STRING_,ref:"attrs/"+ZaDomain.A_GalLdapFilter,required:true}
,{
id:ZaDomain.A_zimbraGalAutoCompleteLdapFilter,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraGalAutoCompleteLdapFilter}
,{
id:ZaDomain.A_GalLdapSearchBase,type:_STRING_,ref:"attrs/"+ZaDomain.A_GalLdapSearchBase}
,{
id:ZaDomain.A_UseBindPassword,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_UseBindPassword}
,{
id:ZaDomain.A_SyncUseBindPassword,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_SyncUseBindPassword}
,{
id:ZaDomain.A_GalLdapURL,type:_LIST_,listItem:{
type:_SHORT_URL_}
,ref:"attrs/"+ZaDomain.A_GalLdapURL}
,{
id:ZaDomain.A_zimbraGalSyncLdapURL,type:_LIST_,listItem:{
type:_SHORT_URL_}
,ref:"attrs/"+ZaDomain.A_zimbraGalSyncLdapURL}
,{
id:ZaDomain.A_GalLdapBindDn,type:_STRING_,ref:"attrs/"+ZaDomain.A_GalLdapBindDn}
,{
id:ZaDomain.A_GalLdapBindPassword,type:_STRING_,ref:"attrs/"+ZaDomain.A_GalLdapBindPassword}
,{
id:ZaDomain.A_GalLdapBindPasswordConfirm,type:_STRING_,ref:"attrs/"+ZaDomain.A_GalLdapBindPasswordConfirm}
,{
id:ZaDomain.A_zimbraGalAccountId,type:_LIST_,listItem:{
type:_STRING_}
,ref:"attrs/"+ZaDomain.A_zimbraGalAccountId}
,{
id:ZaDomain.A2_create_gal_acc,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_create_gal_acc}
,{
id:ZaDomain.A2_gal_sync_accounts_set,type:_LIST_,ref:ZaDomain.A2_gal_sync_accounts_set,listItem:{
type:_OBJECT_,ref:".",items:[{
id:ZaDomain.A2_new_gal_sync_account_name,type:_STRING_,ref:ZaDomain.A2_new_gal_sync_account_name,defaultValue:"galsync"}
,{
id:ZaDomain.A2_new_internal_gal_ds_name,type:_STRING_,ref:ZaDomain.A2_new_internal_gal_ds_name,defaultValue:"zimbra"}
,{
id:ZaDomain.A2_new_external_gal_ds_name,type:_STRING_,ref:ZaDomain.A2_new_external_gal_ds_name,defaultValue:"ldap"}
,{
id:ZaDomain.A2_new_internal_gal_polling_interval,type:_MINTERVAL_,ref:ZaDomain.A2_new_internal_gal_polling_interval,defaultValue:"1d"}
,{
id:ZaDomain.A2_new_external_gal_polling_interval,type:_MINTERVAL_,ref:ZaDomain.A2_new_external_gal_polling_interval,defaultValue:"1d"}
]}}
,{
id:ZaDomain.A2_gal_sync_accounts,type:_LIST_,listItem:{
type:_OBJECT_,items:ZaAccount.myXModel.items}
,ref:ZaDomain.A2_gal_sync_accounts}
,{
id:ZaDomain.A_AuthLdapUserDn,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthLdapUserDn}
,{
id:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_zimbraAuthLdapStartTlsEnabled}
,{
id:ZaDomain.A_AuthLDAPSearchBase,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthLDAPSearchBase}
,{
id:ZaDomain.A_AuthMech,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthMech}
,{
id:ZaDomain.A_AuthLdapURL,type:_LIST_,listItem:{
type:_SHORT_URL_}
,ref:"attrs/"+ZaDomain.A_AuthLdapURL}
,{
id:ZaDomain.A_AuthADDomainName,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthADDomainName}
,{
id:ZaDomain.A_AuthLdapSearchBase,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthLdapSearchBase}
,{
id:ZaDomain.A_AuthLdapSearchFilter,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthLdapSearchFilter}
,{
id:ZaDomain.A_AuthLdapSearchBindDn,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthLdapSearchBindDn}
,{
id:ZaDomain.A_AuthLdapSearchBindPassword,type:_STRING_,ref:"attrs/"+ZaDomain.A_AuthLdapSearchBindPassword}
,{
id:ZaDomain.A_zimbraDomainStatus,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraDomainStatus}
,{
id:ZaDomain.A_AuthTestUserName,type:_STRING_}
,{
id:ZaDomain.A_AuthTestPassword,type:_STRING_}
,{
id:ZaDomain.A_AuthTestMessage,type:_STRING_}
,{
id:ZaDomain.A_AuthTestResultCode,type:_STRING_}
,{
id:ZaDomain.A_AuthTestMessage,type:_STRING_}
,{
id:ZaDomain.A_AuthComputedBindDn,type:_STRING_}
,{
id:ZaDomain.A_zimbraPasswordChangeListener,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraPasswordChangeListener}
,{
id:ZaDomain.A_zimbraAuthFallbackToLocal,type:_ENUM_,ref:"attrs/"+ZaDomain.A_zimbraAuthFallbackToLocal,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A_GALSearchTestMessage,type:_STRING_}
,{
id:ZaDomain.A_GALSyncTestMessage,type:_STRING_}
,{
id:ZaDomain.A_GALSearchTestResultCode,type:_STRING_}
,{
id:ZaDomain.A_GALSyncTestResultCode,type:_STRING_}
,{
id:ZaDomain.A_GALSampleQuery,type:_STRING_,required:true}
,{
id:ZaDomain.A_AuthUseBindPassword,type:_STRING_,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A_AuthLdapSearchBindPasswordConfirm,type:_STRING_}
,{
id:ZaDomain.A_zimbraAutoProvLdapURL,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLdapURL,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled}
,{
id:ZaDomain.A_zimbraAutoProvLdapAdminBindDn,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLdapAdminBindDn,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvLdapAdminBindPassword,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLdapAdminBindPassword,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvLdapSearchBase,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLdapSearchBase,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvLdapSearchFilter,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLdapSearchFilter,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvLdapBindDn,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLdapBindDn,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvAccountNameMap,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvAccountNameMap,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvNotificationFromAddress,type:_EMAIL_ADDRESS_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvNotificationFromAddress,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvBatchSize,type:_NUMBER_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvBatchSize,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaDomain.A_zimbraAutoProvLastPolledTimestamp,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvLastPolledTimestamp,maxLength:256}
,{
id:ZaDomain.A_zimbraAutoProvAttrMap,type:_LIST_,listItem:{
type:_STRING_,maxLength:255}
,ref:"attrs/"+ZaDomain.A_zimbraAutoProvAttrMap}
,{
id:ZaDomain.A2_zimbraAutoProvModeEAGEREnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvModeEAGEREnabled}
,{
id:ZaDomain.A2_zimbraAutoProvModeLAZYEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvModeLAZYEnabled}
,{
id:ZaDomain.A2_zimbraAutoProvModeMANUALEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvModeMANUALEnabled}
,{
id:ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled}
,{
id:ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled}
,{
id:ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled}
,{
id:ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled}
,{
id:ZaDomain.A2_zimbraAutoProvServerList,type:_LIST_,ref:ZaDomain.A2_zimbraAutoProvServerList}
,{
id:ZaDomain.A2_zimbraAutoProvSelectedServerList,type:_LIST_}
,{
id:ZaDomain.A2_zimbraAutoProvPollingInterval,ref:ZaDomain.A2_zimbraAutoProvPollingInterval,type:_MINTERVAL_,minInclusive:0}
,{
id:ZaDomain.A2_zimbraAutoProvSearchActivated,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaDomain.A2_zimbraAutoProvSearchActivated}
,{
id:ZaDomain.A2_zimbraAutoProvAccountPool,type:_LIST_,ref:ZaDomain.A2_zimbraAutoProvAccountPool}
,{
id:ZaDomain.A2_zimbraAutoProvAccountPoolPageNum,ref:ZaDomain.A2_zimbraAutoProvAccountPoolPageNum,type:_NUMBER_,defaultValue:1}
,{
id:ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool,type:_LIST_,ref:ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool}
,{
id:ZaDomain.A2_zimbraAutoProvAccountTargetPool,type:_LIST_,ref:ZaDomain.A2_zimbraAutoProvAccountTargetPool}
,{
id:ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool,type:_LIST_,ref:ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool}
,{
id:ZaDomain.A2_zimbraAutoProvAccountPoolPageTotal,ref:ZaDomain.A2_zimbraAutoProvAccountPoolPageTotal,type:_NUMBER_,defaultValue:1}
,{
id:ZaDomain.A2_zimbraAutoProvAccountPassword,type:_STRING_,ref:ZaDomain.A2_zimbraAutoProvAccountPassword,maxLength:256}
,{
id:ZaDomain.A_domainMaxAccounts,type:_INT_,ref:"attrs/"+ZaDomain.A_domainMaxAccounts,minInclusive:0}
,{
id:ZaDomain.A_zimbraMailDomainQuota,type:_NUMBER_,ref:"attrs/"+ZaDomain.A_zimbraMailDomainQuota,minInclusive:0}
,{
id:ZaDomain.A_zimbraDomainAggregateQuota,type:_NUMBER_,ref:"attrs/"+ZaDomain.A_zimbraDomainAggregateQuota,minInclusive:0}
,{
id:ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent,type:_NUMBER_,ref:"attrs/"+ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent,maxInclusive:100,minInclusive:0}
,{
id:ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient,type:_EMAIL_ADDRESS_,ref:"attrs/"+ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient}
,{
id:ZaDomain.A_zimbraDomainAggregateQuotaPolicy,type:_ENUM_,ref:"attrs/"+ZaDomain.A_zimbraDomainAggregateQuotaPolicy,choices:ZaDomain.aggregateQuotaPolicyChoices}
,{
id:ZaDomain.A_zimbraPrefTimeZoneId,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraPrefTimeZoneId,choices:ZaSettings.timeZoneChoices}
,{
id:ZaModel.currentStep,type:_NUMBER_,ref:ZaModel.currentStep,maxInclusive:2147483647}
,{
id:ZaDomain.A2_acl_selection_cache,type:_LIST_}
,{
id:ZaDomain.A_GALTestSearchResults,ref:ZaDomain.A_GALTestSearchResults,type:_LIST_,listItem:{
type:_OBJECT_,items:[{
id:"email",type:_STRING_}
,{
id:"fullName",type:_STRING_}
,{
id:"firstName",type:_STRING_}
,{
id:"lastName",type:_STRING_}
]}}
,{
id:ZaDomain.A_NotebookTemplateDir,type:_STRING_,ref:ZaDomain.A_NotebookTemplateDir}
,{
id:ZaDomain.A_NotebookTemplateFolder,type:_STRING_,ref:ZaDomain.A_NotebookTemplateFolder}
,{
id:ZaDomain.A_NotebookAccountPassword,type:_STRING_}
,{
id:ZaDomain.A_NotebookAccountPassword2,type:_STRING_}
,{
id:ZaDomain.A_CreateNotebook,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A_OverwriteTemplates,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A_zimbraNotebookAccount,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraNotebookAccount}
,{
id:ZaDomain.A_NotebookAllACLs,ref:"notebookAcls/"+ZaDomain.A_NotebookAllACLs,type:_OBJECT_,items:[{
id:"r",type:_NUMBER_}
,{
id:"w",type:_NUMBER_}
,{
id:"d",type:_NUMBER_}
,{
id:"i",type:_NUMBER_}
,{
id:"a",type:_NUMBER_}
,{
id:"x",type:_NUMBER_}
]}
,{
id:ZaDomain.A_NotebookDomainACLs,ref:"notebookAcls/"+ZaDomain.A_NotebookDomainACLs,type:_OBJECT_,items:[{
id:"r",type:_NUMBER_}
,{
id:"w",type:_NUMBER_}
,{
id:"d",type:_NUMBER_}
,{
id:"i",type:_NUMBER_}
,{
id:"a",type:_NUMBER_}
,{
id:"x",type:_NUMBER_}
]}
,{
id:ZaDomain.A_NotebookPublicACLs,ref:"notebookAcls/"+ZaDomain.A_NotebookPublicACLs,type:_OBJECT_,items:[{
id:"r",type:_NUMBER_}
,{
id:"w",type:_NUMBER_}
,{
id:"d",type:_NUMBER_}
,{
id:"i",type:_NUMBER_}
,{
id:"a",type:_NUMBER_}
,{
id:"x",type:_NUMBER_}
]}
,{
id:ZaDomain.A_NotebookGroupACLs,ref:"notebookAcls/"+ZaDomain.A_NotebookGroupACLs,type:_LIST_,listItem:{
type:_OBJECT_,items:[{
id:"acl",type:_OBJECT_,items:[{
id:"r",type:_NUMBER_}
,{
id:"w",type:_NUMBER_}
,{
id:"d",type:_NUMBER_}
,{
id:"i",type:_NUMBER_}
,{
id:"a",type:_NUMBER_}
,{
id:"x",type:_NUMBER_}
]}
,{
id:"name",type:_STRING_}
,{
id:"gt",type:_STRING_}
]}}
,{
id:ZaDomain.A_NotebookUserACLs,ref:"notebookAcls/"+ZaDomain.A_NotebookUserACLs,type:_LIST_,listItem:{
type:_OBJECT_,items:[{
id:"acl",type:_OBJECT_,items:[{
id:"r",type:_NUMBER_}
,{
id:"w",type:_NUMBER_}
,{
id:"d",type:_NUMBER_}
,{
id:"i",type:_NUMBER_}
,{
id:"a",type:_NUMBER_}
,{
id:"x",type:_NUMBER_}
]}
,{
id:"name",type:_STRING_}
,{
id:"gt",type:_STRING_}
]}}
,{
id:ZaDomain.A_allNotebookACLS,ref:ZaDomain.A_allNotebookACLS,type:_LIST_,listItem:{
type:_OBJECT_,items:[{
id:"acl",type:_OBJECT_,items:[{
id:"r",type:_NUMBER_}
,{
id:"w",type:_NUMBER_}
,{
id:"d",type:_NUMBER_}
,{
id:"i",type:_NUMBER_}
,{
id:"a",type:_NUMBER_}
,{
id:"x",type:_NUMBER_}
]}
,{
id:"name",type:_STRING_}
,{
id:"gt",type:_STRING_}
]}}
,{
id:ZaDomain.A_zimbraZimletDomainAvailableZimlets,type:_LIST_,ref:"attrs/"+ZaDomain.A_zimbraZimletDomainAvailableZimlets,dataType:_STRING_,outputType:_LIST_}
,{
id:ZaAccount.A_zimbraMailCatchAllAddress,ref:ZaAccount.A_zimbraMailCatchAllAddress,type:_OBJECT_,items:[{
id:"id",type:_STRING_}
,{
id:"name",type:_STRING_}
]}
,{
id:ZaDomain.A_zimbraDomainCOSMaxAccounts,ref:"attrs/"+ZaDomain.A_zimbraDomainCOSMaxAccounts,type:_LIST_,dataType:_STRING_,outputType:_LIST_}
,{
id:ZaDomain.A_zimbraDomainFeatureMaxAccounts,ref:"attrs/"+ZaDomain.A_zimbraDomainFeatureMaxAccounts,type:_LIST_,dataType:_STRING_,outputType:_LIST_}
,{
id:ZaDomain.A2_domain_account_quota,ref:ZaDomain.A2_domain_account_quota,type:_LIST_,listItem:{
type:_OBJECT_}}
,{
id:ZaDomain.A_zimbraSkinForegroundColor,ref:"attrs/"+ZaDomain.A_zimbraSkinForegroundColor,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraSkinBackgroundColor,ref:"attrs/"+ZaDomain.A_zimbraSkinBackgroundColor,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraSkinSecondaryColor,ref:"attrs/"+ZaDomain.A_zimbraSkinSecondaryColor,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraSkinSelectionColor,ref:"attrs/"+ZaDomain.A_zimbraSkinSelectionColor,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraSkinLogoURL,ref:"attrs/"+ZaDomain.A_zimbraSkinLogoURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraSkinLogoLoginBanner,ref:"attrs/"+ZaDomain.A_zimbraSkinLogoLoginBanner,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraSkinLogoAppBanner,ref:"attrs/"+ZaDomain.A_zimbraSkinLogoAppBanner,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraWebClientLoginURL,ref:"attrs/"+ZaDomain.A_zimbraWebClientLoginURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraWebClientLogoutURL,ref:"attrs/"+ZaDomain.A_zimbraWebClientLogoutURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraForceClearCookies,ref:"attrs/"+ZaDomain.A_zimbraForceClearCookies,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A_zimbraReverseProxyClientCertMode,ref:"attrs/"+ZaDomain.A_zimbraReverseProxyClientCertMode,type:_COS_STRING_,choices:["on","off","optional"]}
,{
id:ZaDomain.A_zimbraMailSSLClientCertPrincipalMap,ref:"attrs/"+ZaDomain.A_zimbraMailSSLClientCertPrincipalMap,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraReverseProxyClientCertCA,ref:"attrs/"+ZaDomain.A_zimbraReverseProxyClientCertCA,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraHelpAdminURL,ref:"attrs/"+ZaDomain.A_zimbraHelpAdminURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraHelpDelegatedURL,ref:"attrs/"+ZaDomain.A_zimbraHelpDelegatedURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraAdminConsoleLoginURL,ref:"attrs/"+ZaDomain.A_zimbraAdminConsoleLoginURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraAdminConsoleLogoutURL,ref:"attrs/"+ZaDomain.A_zimbraAdminConsoleLogoutURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraWebClientLoginURLAllowedUA,type:_COS_LIST_,ref:"attrs/"+ZaDomain.A_zimbraWebClientLoginURLAllowedUA,listItem:{
type:_STRING_}}
,{
id:ZaDomain.A_zimbraWebClientLogoutURLAllowedUA,type:_COS_LIST_,ref:"attrs/"+ZaDomain.A_zimbraWebClientLogoutURLAllowedUA,listItem:{
type:_STRING_}}
,{
id:ZaDomain.A_zimbraWebClientLoginURLAllowedIP,type:_COS_LIST_,ref:"attrs/"+ZaDomain.A_zimbraWebClientLoginURLAllowedIP,listItem:{
type:_STRING_}}
,{
id:ZaDomain.A_zimbraWebClientLogoutURLAllowedIP,type:_COS_LIST_,ref:"attrs/"+ZaDomain.A_zimbraWebClientLogoutURLAllowedIP,listItem:{
type:_STRING_}}
,{
id:ZaDomain.A_zimbraAuthKerberos5Realm,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAuthKerberos5Realm}
,{
id:ZaDomain.A_zimbraFreebusyExchangeAuthUsername,ref:"attrs/"+ZaDomain.A_zimbraFreebusyExchangeAuthUsername,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraFreebusyExchangeAuthPassword,ref:"attrs/"+ZaDomain.A_zimbraFreebusyExchangeAuthPassword,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraFreebusyExchangeAuthScheme,ref:"attrs/"+ZaDomain.A_zimbraFreebusyExchangeAuthScheme,type:_COS_ENUM_,choices:ZaSettings.authorizationScheme}
,{
id:ZaDomain.A_zimbraFreebusyExchangeServerType,ref:"attrs/"+ZaDomain.A_zimbraFreebusyExchangeServerType,type:_COS_ENUM_,choices:ZaSettings.exchangeServerType}
,{
id:ZaDomain.A_zimbraFreebusyExchangeURL,ref:"attrs/"+ZaDomain.A_zimbraFreebusyExchangeURL,type:_COS_STRING_}
,{
id:ZaDomain.A_zimbraFreebusyExchangeUserOrg,ref:"attrs/"+ZaDomain.A_zimbraFreebusyExchangeUserOrg,type:_COS_STRING_}
,{
id:ZaDomain.A2_isTestingGAL,ref:ZaDomain.A2_isTestingGAL,type:_NUMBER_}
,{
id:ZaDomain.A2_isTestingSync,ref:ZaDomain.A2_isTestingSync,type:_NUMBER_}
,{
id:ZaDomain.A2_isTestingAuth,ref:ZaDomain.A2_isTestingAuth,type:_NUMBER_}
,{
id:ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled}
,{
id:ZaDomain.A_zimbraAutoProvNotificationSubject,type:_COS_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvNotificationSubject}
,{
id:ZaDomain.A_zimbraAutoProvNotificationBody,type:_COS_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAutoProvNotificationBody}
]};
ZaDomain.prototype.getUsedDomainAccounts=function(){
var n=0;
var e=this.getAccountCountsByCoses();
if(e&&e.length>0){
for(var t=0;
t<e.length;
t++){
var o=e[t]._content;
n+=parseInt(o)
}}
return n
};
ZaDomain.prototype.getAccountCountsByCoses=function(){
try{
var s=AjxSoapDoc.create("CountAccountRequest",ZaZimbraAdmin.URN,null);
var t=s.set("domain",this.name);
t.setAttribute("by","name");
var h=new Object();
h.soapDoc=s;
var n={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_COUNT_ACCOUNTS};
var r=ZaRequestMgr.invoke(h,n);
var e=r.Body.CountAccountResponse.cos;
return e
}
catch(o){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_GET_USED_ACCOUNTS,[this.name]),o)
}};
ZaDomain.prototype.updateUsedAccounts=function(){
this.updateMaxAccounts();
var e=this.getAccountCountsByCoses();
if(e&&e.length>0){
for(var t=0;
t<e.length;
t++){
var o=e[t].name;
if(!this[ZaDomain.A2_account_limit][o]){
this[ZaDomain.A2_account_limit][o]={}
}
this[ZaDomain.A2_account_limit][o].used=parseInt(e[t]._content)
}}
for(o in this[ZaDomain.A2_account_limit]){
if(!this[ZaDomain.A2_account_limit][o].used){
this[ZaDomain.A2_account_limit][o].used=0
}}};
ZaDomain.prototype.getUsedAccounts=function(e,t){
if(!this[ZaDomain.A2_account_limit]){
this[ZaDomain.A2_account_limit]={}
}
if(!this[ZaDomain.A2_account_limit][e]){
this[ZaDomain.A2_account_limit][e]={
used:null}
}
if(t||(this[ZaDomain.A2_account_limit][e].used==null)){
this.updateUsedAccounts()
}
if(!this[ZaDomain.A2_account_limit][e]){
return 0
}else{
return this[ZaDomain.A2_account_limit][e].used
}};
ZaDomain.prototype.isCosLimitInDomain=function(e){
if(!this[ZaDomain.A2_account_limit]||this[ZaDomain.A2_account_limit].length<1){
this.updateMaxAccounts()
}
if(this[ZaDomain.A2_account_limit][e]){
return true
}else{
return false
}};
ZaDomain.prototype.getMaxAccounts=function(e,t){
if(!this[ZaDomain.A2_account_limit]){
this[ZaDomain.A2_account_limit]={}
}
if(!this[ZaDomain.A2_account_limit][e]){
this[ZaDomain.A2_account_limit][e]={}
}
if(!this[ZaDomain.A2_account_limit][e].max||t){
this.updateMaxAccounts()
}
if(!this[ZaDomain.A2_account_limit][e]){
return 0
}else{
return this[ZaDomain.A2_account_limit][e].max
}};
ZaDomain.prototype.updateMaxAccounts=function(){
this[ZaDomain.A2_account_limit]={};
var t=this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts];
for(var e=0;
e<t.length;
e++){
var s=t[e].split(":");
var o=ZaCos.getCosById(s[0]);
if(o==null){
ZaApp.getInstance().getCurrentController.popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_INVALID_ACCOUNT_TYPE,[s[0]]));
return
}
var r=o.name;
this[ZaDomain.A2_account_limit][r]={};
this[ZaDomain.A2_account_limit][r].max=s[1]
}};
ZaDomain.prototype.getAvailableAccounts=function(t,n){
if(!this[ZaDomain.A2_account_limit][t]){
this[ZaDomain.A2_account_limit][t]={}
}
var o=this.getUsedAccounts(t,n);
var e=this.getMaxAccounts(t,n);
if(!this[ZaDomain.A2_account_limit][t]){
return 0
}else{
this[ZaDomain.A2_account_limit][t].available=e-o;
return this[ZaDomain.A2_account_limit][t].available
}};
ZaDomain.prototype.getAccountTypes=function(){
var o=[];
var t=this.attrs[ZaDomain.A_zimbraDomainCOSMaxAccounts];
if(t&&t.length>0){
for(var e=0;
e<t.length;
e++){
var n=t[e].split(":");
o.push(n[0])
}}
return o
};
ZaDomain.getTotalLimitsPerAccountTypes=function(t){
var o=0;
if(t&&t.length>0){
for(var e=0;
e<t.length;
e++){
var n=t[e].split(":");
o+=new Number(n[1])
}}
return o
};
ZaDomain.searchAccountsInDomain=function(n){
if(n){
var e=ZaApp.getInstance().getSearchListController();
var r=Dwt.getNextId();
var h=new AjxCallback(e,e.searchCallback,{
limit:e.RESULTSPERPAGE,show:true,busyId:r}
);
e._currentQuery="";
var o=[ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.ALIASES,ZaSearch.RESOURCES];
if(e.setSearchTypes){
e.setSearchTypes(o)
}
e._currentDomain=n;
e.fetchAttrs=AjxBuffer.concat(ZaAlias.searchAttributes,",",ZaDistributionList.searchAttributes,",",ZaResource.searchAttributes,",",ZaSearch.standardAttributes);
e._currentPageNum=1;
var s={
query:e._currentQuery,domain:e._currentDomain,types:o,attrs:e.fetchAttrs,callback:h,controller:e,showBusy:true,busyId:r,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false};
e.scrollSearchParams={
query:e._currentQuery,domain:e._currentDomain,types:o,attrs:e.fetchAttrs,controller:e,showBusy:true,busyMsg:ZaMsg.BUSY_SEARCHING,skipCallbackIfCancelled:false};
ZaSearch.searchDirectory(s)
}else{
var t=ZaApp.getInstance().getCurrentController();
t.popupErrorDialog(ZaMsg.ERROR_NO_DOMAIN_NAME)
}};
ZaDomain.prototype.createDomainAlias=function(e){
var p=e.getInstance();
var m=p.attrs[ZaDomain.A_domainName];
var r=p[ZaDomain.A2_zimbraDomainAliasTarget];
try{
var c=ZaDomain.getTargetDomainByName(r);
if(c==null){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_TARGET_DOMAIN_NOT_EXIST,[r]));
return
}else{
if(c.attrs[ZaDomain.A_domainType]!=ZaDomain.domainTypes.local){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_TARGET_DOMAIN_IS_ALIAS,[r]));
return
}else{
if(m==null){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_DOMAIN_ALIAS_NOT_EXIST);
return
}}}
if(!this.attrs){
this.attrs={}
}
this.attrs[ZaDomain.A_domainName]=m;
this.attrs[ZaDomain.A_domainType]=ZaDomain.domainTypes.alias;
this.attrs[ZaDomain.A_zimbraDomainAliasTargetId]=c.id;
this.attrs[ZaDomain.A_description]=AjxMessageFormat.format(ZaMsg.DESC_targetDomain,[r]);
this.attrs[ZaDomain.A_zimbraMailCatchAllAddress]="@"+m;
this.attrs[ZaDomain.A_zimbraMailCatchAllForwardingAddress]="@"+r;
var f=AjxSoapDoc.create("CreateDomainRequest",ZaZimbraAdmin.URN,null);
f.set("name",this.attrs[ZaDomain.A_domainName]);
var s=[ZaDomain.A_domainType,ZaDomain.A_zimbraDomainAliasTargetId,ZaDomain.A_description,ZaDomain.A_zimbraMailCatchAllAddress,ZaDomain.A_zimbraMailCatchAllForwardingAddress];
for(var h=0;
h<s.length;
h++){
var u=s[h];
if(this.attrs[u]!=null){
var l=f.set("a",this.attrs[u]);
l.setAttribute("n",u)
}}
var n=new Object();
n.soapDoc=f;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_DOMAIN};
var o=ZaRequestMgr.invoke(n,t).Body.CreateDomainResponse;
ZaApp.getInstance().getDomainListController().fireCreationEvent(this);
e.parent.popdown()
}
catch(d){
if(d.code==ZmCsfeException.DOMAIN_EXISTS){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_DOMAIN_ALIAS_EXIST,[m]))
}else{
ZaApp.getInstance().getCurrentController()._handleException(d,"ZaDomain.prototype.createDomainAlias",null,false)
}}};
ZaDomain.prototype.modifyDomainAlias=function(e){
var m=e.getInstance();
var r=m[ZaDomain.A2_zimbraDomainAliasTarget];
if(r!=null&&(("@"+r)!=this.attrs[ZaDomain.A_zimbraMailCatchAllForwardingAddress])){
var c=ZaDomain.getTargetDomainByName(r);
if(c==null){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_TARGET_DOMAIN_NOT_EXIST,[r]));
return
}else{
if(c.attrs[ZaDomain.A_domainType]!=ZaDomain.domainTypes.local){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_TARGET_DOMAIN_IS_ALIAS,[r]));
return
}}
if(!this.attrs){
this.attrs={}
}
this.attrs[ZaDomain.A_zimbraDomainAliasTargetId]=c.id;
this.attrs[ZaDomain.A_description]=AjxMessageFormat.format(ZaMsg.DESC_targetDomain,[r]);
this.attrs[ZaDomain.A_zimbraMailCatchAllForwardingAddress]="@"+r;
var u=AjxSoapDoc.create("ModifyDomainRequest",ZaZimbraAdmin.URN,null);
u.set("id",this.id);
var s=[ZaDomain.A_zimbraDomainAliasTargetId,ZaDomain.A_description,ZaDomain.A_zimbraMailCatchAllForwardingAddress];
for(var h=0;
h<s.length;
h++){
var d=s[h];
if(this.attrs[d]!=null){
var l=u.set("a",this.attrs[d]);
l.setAttribute("n",d)
}}
var n=new Object();
n.soapDoc=u;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_DOMAIN};
var o=ZaRequestMgr.invoke(n,t).Body.ModifyDomainResponse;
this.oldItem=m;
ZaApp.getInstance().getDomainListController().fireChangeEvent(this)
}
e.parent.popdown()
};
ZaDomain.getTargetDomainByName=function(t){
var n=ZaDomain.getAll(t).getArray();
for(var e=0;
e<n.length;
e++){
var o=n[e];
if(t==o.name){
return o
}}
return null
};
ZaDomain.globalRights={};
ZaDomain.getEffectiveDomainList=function(d){
var m=AjxSoapDoc.create("GetAllEffectiveRightsRequest",ZaZimbraAdmin.URN,null);
var o=m.set("grantee",d);
o.setAttribute("type","usr");
o.setAttribute("by","id");
var n={};
n.soapDoc=m;
n.asyncMode=false;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_EFFICIENT_DOMAIN_LIST};
var r=[];
try{
var s=ZaRequestMgr.invoke(n,e);
if(!s||s.Body.GetAllEffectiveRightsResponse.Fault){
return r
}
var c=s.Body.GetAllEffectiveRightsResponse.target;
for(var l=0;
l<c.length;
l++){
if(c[l].type!=ZaItem.DOMAIN){
continue
}
if(!c[l].entries&&!c[l].all){
continue
}
if(c[l].entries){
for(var h=0;
h<c[l].entries.length;
h++){
var f=c[l].entries[h].entry;
for(var t=0;
t<f.length;
t++){
r.push(f[t].name)
}}}
if(c[l].all){
if(c[l].all.length&&c[l].all[0]&&c[l].all[0].right&&c[l].all[0].right.length){
for(var h=0;
h<c[l].all[0].right.length;
h++){
ZaDomain.globalRights[c[l].all[0].right[h].n]=true
}}}
break
}
return r
}
catch(u){
ZaApp.getInstance().getCurrentController()._handleException(u,"ZaDomain.getEffectiveDomainList",null,false)
}};
ZaDomain.prototype.countAllAccounts=function(){
var n=AjxSoapDoc.create("SearchDirectoryRequest",ZaZimbraAdmin.URN,null);
n.getMethod().setAttribute("maxResults","0");
n.getMethod().setAttribute("limit","-1");
var s="";
var t=[ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.ALIASES,ZaSearch.RESOURCES];
n.set("query",s);
n.set("types",t.toString());
n.set("domain",this.name);
var h=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=n;
o.noAuthToken=true;
try{
var r=h.invoke(o).Body.SearchDirectoryResponse;
if(r.searchTotal){
return r.searchTotal
}else{
return 0
}}
catch(e){
throw (e)
}
return 0
};
ZaDomain.prototype.countAllAliases=function(){
var n=AjxSoapDoc.create("SearchDirectoryRequest",ZaZimbraAdmin.URN,null);
n.getMethod().setAttribute("limit","1");
var s="("+ZaDomain.A_zimbraDomainAliasTargetId+"="+this.id+")";
var t=[ZaSearch.DOMAINS];
n.set("query",s);
n.set("types",t.toString());
var h=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=n;
o.noAuthToken=true;
try{
var r=h.invoke(o).Body.SearchDirectoryResponse;
if(r.searchTotal){
return r.searchTotal
}else{
return 0
}}
catch(e){
throw (e)
}
return 0
};
ZaDomain.getRelatedList=function(t){
var e=[];
var n=this.countAllAccounts();
if(n>0){
var o=new ZaTreeItemData({
text:ZaMsg.OVP_accounts,count:n,image:"Account",mappingId:ZaZimbraAdmin._DOMAIN_ACCOUNT_LIST_VIEW,path:t+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.OVP_accounts}
);
o.setData("domainItem",this);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DOMAIN_ACCOUNT_LIST_VIEW]=ZaOverviewPanelController.accountListInDomainTreeListener;
e.push(o)
}
n=this.countAllAliases();
if(n>0){
var s=new ZaTreeItemData({
text:ZaMsg.TABT_Aliases,count:n,image:"DomainAlias",mappingId:ZaZimbraAdmin._DOMAIN_ALIAS_LIST_VIEW,path:t+ZaTree.SEPERATOR+this.name+ZaTree.SEPERATOR+ZaMsg.OVP_accounts}
);
s.setData("domainItem",this);
ZaOverviewPanelController.overviewTreeListeners[ZaZimbraAdmin._DOMAIN_ALIAS_LIST_VIEW]=ZaOverviewPanelController.domainListTreeListener;
e.push(s)
}
return e
};
ZaItem.getRelatedMethods.ZaDomain.push(ZaDomain.getRelatedList)
}
if(AjxPackage.define("zimbraAdmin.search.model.ZaSearch")){
ZaSearch=function(){
this[ZaSearch.A_selected]=null;
this[ZaSearch.A_query]="";
this[ZaSearch.A_fAliases]="TRUE";
this[ZaSearch.A_fAccounts]="TRUE";
this[ZaSearch.A_fdistributionlists]="TRUE";
this[ZaSearch.A_fResources]="TRUE";
this[ZaSearch.A_fDomains]="TRUE";
this[ZaSearch.A_fCoses]="TRUE";
this[ZaSearch.A_pagenum]=1
};
ZaSearch.ALIASES="aliases";
ZaSearch.DLS="distributionlists";
ZaSearch.DDLS="dynamicgroups";
ZaSearch.ACCOUNTS="accounts";
ZaSearch.RESOURCES="resources";
ZaSearch.DOMAINS="domains";
ZaSearch.COSES="coses";
ZaSearch.BEST_MATCH_LIMIT=5;
ZaSearch.TYPES=new Object();
ZaSearch.TYPES[ZaItem.ALIAS]=ZaSearch.ALIASES;
ZaSearch.TYPES[ZaItem.DL]=ZaSearch.DLS;
ZaSearch.TYPES[ZaItem.ACCOUNT]=ZaSearch.ACCOUNTS;
ZaSearch.TYPES[ZaItem.RESOURCE]=ZaSearch.RESOURCES;
ZaSearch.TYPES[ZaItem.DOMAIN]=ZaSearch.DOMAINS;
ZaSearch.TYPES[ZaItem.COS]=ZaSearch.COSES;
ZaSearch.A_query="query";
ZaSearch.A_selected="selected";
ZaSearch.A_pagenum="pagenum";
ZaSearch.A_fAliases="f_aliases";
ZaSearch.A_fAccounts="f_accounts";
ZaSearch.A_fDomains="f_domains";
ZaSearch.A_fCoses="f_coses";
ZaSearch.A_fdistributionlists="f_distributionlists";
ZaSearch.A_fResources="f_resources";
ZaSearch.A_ResultMsg="resultMsg";
ZaSearch._currentQuery=null;
ZaSearch._domain=null;
ZaSearch._savedSearchToBeUpdated=true;
ZaSearch.getPredefinedSavedSearchesForAdminOnly=function(){
return[{
name:ZaMsg.ss_admin_account,query:"(|(zimbraIsAdminAccount=TRUE)(zimbraIsDelegatedAdminAccount=TRUE))"}
]
};
ZaSearch.getPredefinedSavedSearches=function(){
return[{
name:ZaMsg.ss_external_accounts,query:"(zimbraIsExternalVirtualAccount=TRUE)"}
,{
name:ZaMsg.ss_locked_out_accounts,query:"(zimbraAccountStatus=*lockout*)"}
,{
name:ZaMsg.ss_closed_accounts,query:"(zimbraAccountStatus=*closed*)"}
,{
name:ZaMsg.ss_maintenance_accounts,query:"(zimbraAccountStatus=*maintenance*)"}
,{
name:ZaMsg.ss_non_active_accounts,query:"(!(zimbraAccountStatus=*active*))"}
,{
name:ZaMsg.ss_inactive_accounts_30,query:"(zimbraLastLogonTimestamp<=###JSON:{func: ZaSearch.getTimestampByDays, args:[-30]}###)"}
,{
name:ZaMsg.ss_inactive_accounts_90,query:"(zimbraLastLogonTimestamp<=###JSON:{func: ZaSearch.getTimestampByDays, args:[-90]}###)"}
]
};
ZaSearch.getAll=function(){
return ZaSearch.search("",[ZaSearch.ALIASES,ZaSearch.DLS,ZaSearch.ACCOUNTS,ZaSearch.RESOURCES,ZaSearch.DOMAINS,ZaSearch.COSES],1,ZaAccount.A_uid,true)
};
ZaSearch.standardAttributes=[ZaAccount.A_displayname,ZaItem.A_zimbraId,ZaAlias.A_AliasTargetId,ZaAccount.A_accountName,ZaAccount.A_lastName,ZaAccount.A_mailHost,ZaAccount.A_uid,ZaAccount.A_COSId,ZaAccount.A_accountStatus,ZaAccount.A_zimbraLastLogonTimestamp,ZaAccount.A_description,ZaAccount.A_zimbraIsSystemAccount,ZaAccount.A_zimbraIsDelegatedAdminAccount,ZaAccount.A_zimbraIsAdminAccount,ZaAccount.A_zimbraIsSystemResource,ZaAccount.A_zimbraAuthTokenValidityValue,ZaAccount.A_zimbraIsExternalVirtualAccount,ZaDistributionList.A_mailStatus,ZaDistributionList.A_isAdminGroup,ZaResource.A_zimbraCalResType,ZaDomain.A_domainType,ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus].join();
ZaSearch.searchDirectory=function(h){
var s=AjxSoapDoc.create("SearchDirectoryRequest",ZaZimbraAdmin.URN,null);
if(h.query){
s.set("query",h.query);
ZaSearch._currentQuery=h.query
}else{
s.set("query","");
ZaSearch._currentQuery=""
}
var l=(h.sortBy!=undefined)?h.sortBy:ZaAccount.A_name;
var e=(h.limit!=undefined)?h.limit:ZaAccount.RESULTSPERPAGE;
var r=(h.offset!=undefined)?h.offset:"0";
var n=(h.sortAscending!=null)?h.sortAscending:"1";
s.getMethod().setAttribute("offset",r);
s.getMethod().setAttribute("limit",e);
s.getMethod().setAttribute("sortBy",l);
s.getMethod().setAttribute("sortAscending",n);
if(h.applyCos){
s.getMethod().setAttribute("applyCos",h.applyCos)
}else{
s.getMethod().setAttribute("applyCos",false)
}
if(h.applyConfig){
s.getMethod().setAttribute("applyConfig",h.applyConfig)
}else{
s.getMethod().setAttribute("applyConfig","false")
}
if(h.domain){
s.getMethod().setAttribute("domain",h.domain);
ZaSearch._domain=h.domain
}else{
ZaSearch._domain=null
}
if(h.attrs&&h.attrs.length>0){
s.getMethod().setAttribute("attrs",h.attrs.toString())
}
if(h.types&&h.types.length>0){
s.getMethod().setAttribute("types",ZaSearch.checkDynamicGroupType(h.types).toString())
}
if(h.maxResults){
s.getMethod().setAttribute("maxResults",h.maxResults.toString())
}
var o=new Object();
o.soapDoc=s;
if(h.callback){
o.asyncMode=true;
o.callback=h.callback;
o.skipCallbackIfCancelled=h.skipCallbackIfCancelled
}
try{
return ZaRequestMgr.invoke(o,h)
}
catch(t){
if(h.ignoreTooManyResultsException){
ZaSearch.handleTooManyResultsException(t,o.exceptionFrom||"ZaSearch.searchDirectory");
return null
}else{
throw (t)
}}};
ZaSearch.checkDynamicGroupType=function(t){
for(var e=0;
e<t.length;
e++){
if(t[e]==ZaSearch.DLS){
t.push(ZaSearch.DDLS);
return t
}}
return t
};
ZaSearch.TOO_MANY_RESULTS_FLAG=false;
ZaSearch.handleTooManyResultsException=function(e,t){
if(e.code==ZmCsfeException.TOO_MANY_SEARCH_RESULTS){
ZaSearch.TOO_MANY_RESULTS_FLAG=true
}else{
throw (e)
}};
ZaSearch.findAccount=function(s,l){
var t=AjxSoapDoc.create("SearchDirectoryRequest",ZaZimbraAdmin.URN,null);
t.getMethod().setAttribute("limit","1");
var n=["(",s,"=",l,")"].join("");
t.set("query",n);
var h=new ZmCsfeCommand();
var e=new Object();
e.soapDoc=t;
e.noAuthToken=true;
var r=h.invoke(e).Body.SearchDirectoryResponse;
var o=new ZaItemList(ZaAccount);
o.loadFromJS(r);
return o.getArray()[0]
};
ZaSearch.prototype.dynSelectDataCallback=function(s,n){
var r=s.callback;
if(s.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,s.busyId)
}
if(!r){
return
}
try{
if(!n){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListViewController.prototype.dynSelectDataCallback"))
}
if(n.isException()){
throw (n.getException())
}else{
var e=n.getResponse().Body.SearchDirectoryResponse;
var o=new ZaItemList(null);
o.loadFromJS(e);
r.run(o.getArray(),e.more,e.searchTotal)
}}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaSearch.prototype.dynSelectDataCallback")
}};
ZaSearch.prototype.dynSelectSearchCosesCallback=function(s,n){
var h=s.callback;
if(s.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,s.busyId)
}
if(!h){
return
}
try{
if(!n){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaListViewController.prototype.dynSelectSearchCosesCallback"))
}
if(n.isException()){
throw (n.getException())
}else{
var e=n.getResponse().Body.SearchDirectoryResponse;
var o=new ZaItemList(null);
o.loadFromJS(e);
var r=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
r.setChoices(o.getArray());
h.run(o.getArray(),e.more,e.searchTotal)
}}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaSearch.prototype.dynSelectSearchCosesCallback")
}};
ZaSearch.prototype.dynSelectSearch=function(s){
try{
var n=s.value;
var o=s.event;
var l=s.callback;
var h=Dwt.getNextId();
var r=new Object();
var t=new AjxCallback(this,this.dynSelectDataCallback,{
callback:l,busyId:h}
);
r.types=s.types?s.types:[ZaSearch.ACCOUNTS,ZaSearch.DLS];
if(!AjxUtil.isEmpty(s.attrs)){
r.attrs=s.attrs
}
r.callback=t;
r.sortBy=ZaAccount.A_name;
if(s.needCategorized){
r.limit=ZaSearch.BEST_MATCH_LIMIT;
r.query=ZaSearch.getBestMatchSearchByNameQuery(n,r.types)
}else{
r.query=ZaSearch.getSearchByNameQuery(n,r.types)
}
r.controller=ZaApp.getInstance().getCurrentController();
r.showBusy=true;
r.busyId=h;
r.busyMsg=ZaMsg.BUSY_SEARCHING;
r.skipCallbackIfCancelled=false;
if(s.domain){
r.domain=s.domain
}
ZaSearch.searchDirectory(r)
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaSearch.prototype.dynSelectSearch")
}};
ZaSearch.prototype.dynSearchField=function(t){
var e={};
e.value=t.value;
e.event=t.event;
e.callback=t.callback;
e.needCategorized=true;
e.types=ZaApp.getInstance().getSearchListController()._searchField.getSearchTypes();
ZaSearch.prototype.dynSelectSearch.call(this,e)
};
ZaSearch.prototype.dynSelectSearchGroups=function(s){
try{
var l=s.value;
var e=s.event;
var c=s.callback;
var t=s.extraLdapQuery;
var n=Dwt.getNextId();
var o=new Object();
var r=new AjxCallback(this,this.dynSelectDataCallback,{
callback:c,busyId:n}
);
o.types=[ZaSearch.DLS];
o.callback=r;
o.sortBy=ZaAccount.A_name;
o.query=ZaSearch.getSearchByNameQuery(l,o.types);
if(t){
o.query="(&"+t+o.query+")"
}
o.controller=ZaApp.getInstance().getCurrentController();
o.busyId=n;
o.showBusy=true;
o.busyMsg=ZaMsg.BUSY_SEARCHING;
o.skipCallbackIfCancelled=false;
ZaSearch.searchDirectory(o)
}
catch(h){
ZaApp.getInstance().getCurrentController()._handleException(h,"ZaSearch.prototype.dynSelectSearchGroups")
}};
ZaSearch.prototype.dynSelectSearchDomains=function(r){
try{
var d=r.value;
var e=r.event;
var u=r.callback;
var l=r.applyConfig;
var s=Dwt.getNextId();
var o=new Object();
var h=new AjxCallback(this,this.dynSelectDataCallback,{
callback:u,busyId:s}
);
o.types=[ZaSearch.DOMAINS];
o.callback=h;
o.sortBy=ZaDomain.A_domainName;
o.query="";
if(!ZaZimbraAdmin.hasGlobalDomainListAccess()){
var t=ZaApp.getInstance()._domainNameList;
if(t&&t instanceof Array){
for(var n=0;
n<t.length;
n++){
if(!d||t[n].indexOf(d)!=-1){
o.query+="("+ZaDomain.A_domainName+"="+t[n]+")"
}}
if(t.length>1){
o.query="(|"+o.query+")"
}}}else{
o.query=ZaSearch.getSearchDomainByNameQuery(d)
}
o.controller=ZaApp.getInstance().getCurrentController();
o.showBusy=true;
o.busyId=s;
o.applyConfig=l;
o.busyMsg=ZaMsg.BUSY_SEARCHING_DOMAINS;
o.skipCallbackIfCancelled=false;
o.attrs=[ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus,ZaItem.A_zimbraId,ZaDomain.A_domainType,ZaDomain.A_zimbraMailAddressValidationRegex];
ZaSearch.searchDirectory(o)
}
catch(c){
ZaApp.getInstance().getCurrentController()._handleException(c,"ZaSearch.prototype.dynSelectSearchDomains")
}};
ZaSearch.prototype.dynSelectSearchOnlyDomains=function(s){
try{
var n=s.value;
var o=s.event;
var l=s.callback;
var h=Dwt.getNextId();
var r=new Object();
var t=new AjxCallback(this,this.dynSelectDataCallback,{
callback:l,busyId:h}
);
r.types=[ZaSearch.DOMAINS];
r.callback=t;
r.sortBy=ZaDomain.A_domainName;
r.query=ZaSearch.getSearchOnlyDomainByNameQuery(n);
r.controller=ZaApp.getInstance().getCurrentController();
r.showBusy=true;
r.busyId=h;
r.busyMsg=ZaMsg.BUSY_SEARCHING_DOMAINS;
r.skipCallbackIfCancelled=false;
r.attrs=[ZaDomain.A_domainName,ZaDomain.A_zimbraDomainStatus,ZaItem.A_zimbraId,ZaDomain.A_domainType];
ZaSearch.searchDirectory(r)
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaSearch.prototype.dynSelectSearchOnlyDomains")
}};
ZaSearch.prototype.dynSelectSearchCoses=function(s){
try{
var c=s.value;
var e=s.event;
var d=s.callback;
var n=Dwt.getNextId();
var t=new Object();
var r=new AjxCallback(this,this.dynSelectSearchCosesCallback,{
callback:d,busyId:n}
);
t.types=[ZaSearch.COSES];
t.callback=r;
t.sortBy=ZaCos.A_name;
t.query="";
if(!ZaZimbraAdmin.hasGlobalCOSSListAccess()){
var l=ZaApp.getInstance()._cosNameList;
if(l&&(l instanceof Array)&&l.length==0){
for(var o=0;
o<l.length;
o++){
query+="("+ZaCos.A_name+"="+l[o]+")"
}
if(l.length>1){
query="(|"+query+")"
}}else{
t.query=ZaSearch.getSearchCosByNameQuery(c)
}}else{
t.query=ZaSearch.getSearchCosByNameQuery(c)
}
t.controller=ZaApp.getInstance().getCurrentController();
t.showBusy=true;
t.busyId=n;
t.busyMsg=ZaMsg.BUSY_SEARCHING_COSES;
t.skipCallbackIfCancelled=false;
ZaSearch.searchDirectory(t)
}
catch(h){
ZaApp.getInstance().getCurrentController()._handleException(h,"ZaSearch.prototype.dynSelectSearchCoses")
}};
ZaSearch.search=function(p,d,f,m,e,g,r,o,l){
if(!m){
m=ZaAccount.A_name
}
var c="1";
if(!e){
c="0"
}
r=(r!=null)?r:ZaAccount.RESULTSPERPAGE;
var h=(f-1)*r;
g=(g!=null)?g:ZaSearch.standardAttributes;
var s={
query:p,offset:h,limit:r,applyCos:"0",attrs:g,sortBy:m,sortAscending:c};
if(o!=null){
s.domain=o
}
if(d!=null&&d.length>0){
s.types=d.toString()
}
if(l){
s.maxResults=l.toString()
}
s.controller=ZaApp.getInstance().getCurrentController();
var n=ZaSearch.searchDirectory(s).Body.SearchDirectoryResponse;
var u=new ZaItemList(null);
u.loadFromJS(n);
var y=n.searchTotal;
var t=Math.ceil(y/r);
return{
list:u,numPages:t,searchTotal:y}
};
ZaSearch.searchByDomain=function(s,n,e,r,h,o,t){
return ZaSearch.search("",n,e,r,h,o,t,s)
};
ZaSearch.getObjectCountsCalback=function(h,r){
var l=h.callback;
if(!l){
return
}
try{
if(!r){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaSearch.getObjectCountsCalback"))
}
if(r.isException()){
throw (r.getException())
}else{
var n;
n={};
n[ZaItem.ACCOUNT]=0;
n[ZaItem.ALIAS]=0;
n[ZaItem.RESOURCE]=0;
n[ZaItem.DL]=0;
n[ZaItem.DOMAIN]=0;
n[ZaItem.SERVER]=0;
var s=r.getResponse().Body.BatchResponse;
if(s.CountObjectsResponse){
for(var t=0;
t<s.CountObjectsResponse.length;
t++){
r=s.CountObjectsResponse[t];
var o=r.type;
if(o=="userAccount"){
o=ZaItem.ACCOUNT
}
n[o]=r.num
}}
l.run(n)
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaSearch.getObjectCountsCalback")
}};
ZaSearch.getObjectCounts=function(n,c){
var o=new AjxCallback(ZaSearch.getObjectCountsCalback,{
callback:c}
);
var l=AjxSoapDoc.create("BatchRequest","urn:zimbra");
l.setMethodAttribute("onerror","continue");
for(var t=0;
t<n.length;
t++){
var r=n[t];
var h=l.set("CountObjectsRequest",null,null,ZaZimbraAdmin.URN);
if(r==ZaItem.ACCOUNT){
r="userAccount"
}
h.setAttribute("type",r)
}
try{
var e=new ZmCsfeCommand();
var d=new Object();
d.noAuthToken=true;
d.soapDoc=l;
d.asyncMode=true;
d.callback=o;
e.invoke(d)
}
catch(s){
ZaApp.getInstance().getCurrentController()._handleException(s,"ZaSearch.getObjectCounts",null,false)
}};
ZaSearch.getSearchCosByNameQuery=function(e){
if(e==null||e==""){
return""
}else{
e=ZaSearch.escapeLdapQuery(e);
return("(|(uid=*"+e+"*)(cn=*"+e+"*)(sn=*"+e+"*)(gn=*"+e+"*)(zimbraId="+e+"))")
}};
ZaSearch.getSearchDomainByNameQuery=function(e){
if(e==null||e==""){
return""
}else{
e=ZaSearch.escapeLdapQuery(e);
return("(|(uid=*"+e+"*)(cn=*"+e+"*)(sn=*"+e+"*)(gn=*"+e+"*)(zimbraId="+e+")(zimbraDomainName=*"+e+"*))")
}};
ZaSearch.getSearchOnlyDomainByNameQuery=function(e){
if(e==null||e==""){
return""
}else{
e=ZaSearch.escapeLdapQuery(e);
return("(&(|(uid=*"+e+"*)(cn=*"+e+"*)(sn=*"+e+"*)(gn=*"+e+"*)(zimbraId="+e+")(zimbraDomainName=*"+e+"*))(zimbraDomainType=local))")
}};
ZaSearch.getSearchByNameQuery=function(c,s,e){
e=e?e:false;
var h=[];
if(e){
h.push("(&(!(zimbraAccountStatus=closed))")
}
if(!AjxUtil.isEmpty(c)){
h.push("(|");
c=ZaSearch.escapeLdapQuery(c);
if(!s){
s=[ZaSearch.ALIASES,ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.RESOURCES,ZaSearch.DOMAINS,ZaSearch.COSES]
}
var r=false;
var l=false;
var t=false;
for(var o=0;
o<s.length;
o++){
if(s[o]=="domains"){
h.push("(zimbraDomainName=*"+c+"*)")
}else{
if(s[o]==ZaSearch.COSES){
h.push("(cn=*"+c+"*)")
}else{
if(s[o]==ZaSearch.ALIASES){
h.push("(zimbraDomainName=*"+c+"*)(uid=*"+c+"*)")
}else{
if(!r){
h.push("(mail=*"+c+"*)(cn=*"+c+"*)(sn=*"+c+"*)(gn=*"+c+"*)(displayName=*"+c+"*)");
r=true
}
if(!l&&(s[o]=="accounts"||s[o]=="resources")){
h.push("(zimbraMailDeliveryAddress=*"+c+"*)");
l=true
}else{
if(!t&&(s[o]=="distributionlists"||s[o]=="aliases")){
h.push("(zimbraMailAlias=*"+c+"*)(uid=*"+c+"*)");
t=true
}}}}}}}
if(e){
h.push(")")
}
if(!AjxUtil.isEmpty(c)){
h.push(")")
}
return h.join("")
};
ZaSearch.searchAliasByNameQuery=function(c,s,e){
e=e?e:false;
var h=[];
if(e){
h.push("(&(!(zimbraAccountStatus=closed))")
}
if(!AjxUtil.isEmpty(c)){
h.push("(|");
c=ZaSearch.escapeLdapQuery(c);
if(!s){
s=[ZaSearch.ALIASES,ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.RESOURCES,ZaSearch.DOMAINS,ZaSearch.COSES]
}
var r=false;
var l=false;
var t=false;
for(var o=0;
o<s.length;
o++){
if(s[o]=="domains"){
h.push("(zimbraDomainName="+c+")")
}else{
if(s[o]==ZaSearch.COSES){
h.push("(cn="+c+")")
}else{
if(s[o]==ZaSearch.ALIASES){
h.push("(zimbraDomainName="+c+")(uid="+c+")")
}else{
if(!r){
h.push("(mail="+c+")(cn="+c+")(sn="+c+")(gn="+c+")(displayName="+c+")");
r=true
}
if(!l&&(s[o]=="accounts"||s[o]=="resources")){
h.push("(zimbraMailDeliveryAddress="+c+")");
l=true
}else{
if(!t&&(s[o]=="distributionlists"||s[o]=="aliases")){
h.push("(zimbraMailAlias="+c+")(uid="+c+")");
t=true
}}}}}}}
if(e){
h.push(")")
}
if(!AjxUtil.isEmpty(c)){
h.push(")")
}
return h.join("")
};
ZaSearch.getBestMatchSearchByNameQuery=function(c,o){
var r=ZaSearch.getSearchByNameQuery(c,o);
c=ZaSearch.escapeLdapQuery(c);
var l=new RegExp("\\*"+c+"\\*","g");
var s=new RegExp("^\\s*\\(\\s*\\|");
var e=new RegExp("\\)\\s*$");
var h=r.replace(l,c+"*");
h=h.replace(s,"");
h=h.replace(e,"");
var t=r.replace(l,"*"+c);
t=t.replace(s,"");
t=t.replace(e,"");
return"(|"+h+t+")"
};
ZaSearch.getSearchByDisplayNameQuery=function(e){
if(e==null||e==""){
return""
}else{
e=String(e).replace(/([\\\\\\*\\(\\)])/g,"\\$1");
return("(displayName=*"+e+"*)")
}};
ZaSearch.searchByQueryHolder=function(t,e,o,n){
if(t.isByDomain){
return ZaSearch.searchByDomain(t.byValAttr,t.types,e,o,n)
}else{
return ZaSearch.search(t.queryString,t.types,e,o,n,t.fetchAttrs,t.limit)
}};
ZaSearch.getSearchFromQuery=function(o){
var e=new ZaSearch();
e[ZaSearch.A_selected]=null;
e[ZaSearch.A_query]=o.queryString;
e[ZaSearch.A_fAliases]="FALSE";
e[ZaSearch.A_fAccounts]="FALSE";
e[ZaSearch.A_fdistributionlists]="FALSE";
e[ZaSearch.A_fResources]="FALSE";
e[ZaSearch.A_fDomains]="FALSE";
e[ZaSearch.A_fCoses]="FALSE";
if(o.types!=null){
for(var t=0;
t<o.types.length;
++t){
if(o.types[t]==ZaSearch.ALIASES){
e[ZaSearch.A_fAliases]="TRUE"
}
if(o.types[t]==ZaSearch.ACCOUNTS){
e[ZaSearch.A_fAccounts]="TRUE"
}
if(o.types[t]==ZaSearch.DLS){
e[ZaSearch.A_fdistributionlists]="TRUE"
}
if(o.types[t]==ZaSearch.RESOURCES){
e[ZaSearch.A_fResources]="TRUE"
}
if(o.types[t]==ZaSearch.DOMAINS){
e[ZaSearch.A_fDomains]="TRUE"
}
if(o.types[t]==ZaSearch.COSES){
e[ZaSearch.A_fCoses]="TRUE"
}}}
return e
};
ZaSearch.myXModel={
items:[{
id:ZaSearch.A_query,type:_OBJECT_}
,{
id:ZaSearch.A_selected,type:_OBJECT_,items:ZaAccount.myXModel}
,{
id:ZaSearch.A_fAliases,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaSearch.A_fdistributionlists,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaSearch.A_fAccounts,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaSearch.A_pagenum,type:_NUMBER_}
,{
id:ZaSearch.A_ResultMsg,type:_STRING_}
]};
ZaSearchQuery=function(r,o,t,s,n,e){
this.queryString=r;
this.isByDomain=t;
this.byValAttr=s;
this.types=o;
this.fetchAttrs=(n!=null)?n:ZaSearch.standardAttributes;
this.limit=(e!=null)?e:ZaAccount.RESULTSPERPAGE
};
ZaSearch.searchResultCountsView=function(o,e){
o[ZaOperation.SEP]=new ZaOperation(ZaOperation.SEP);
o[ZaOperation.LABEL]=new ZaOperation(ZaOperation.LABEL,AjxMessageFormat.format(ZaMsg.searchResultCount,[0,0]),null,null,null,null,null,null,"ZaSearchResultCountLabel",ZaOperation.SEARCH_RESULT_COUNT);
o[ZaOperation.SEP]=new ZaOperation(ZaOperation.SEP);
for(var t=0;
t<e.length;
t++){
if(e[t]==ZaOperation.PAGE_BACK){
e.splice(t+1,0,ZaOperation.SEP,ZaOperation.LABEL,ZaOperation.SEP);
break
}}};
ZaSearch.isAccountExist=function(l){
var e=ZaApp.getInstance().getCurrentController();
var t=l.name;
var r=l.popupError?true:false;
if(!t){
e.popupErrorDialog(ZaMsg.error_account_missing);
return true
}
var l={
query:["(mail=",t,")"].join(""),limit:2,applyCos:0,types:[ZaSearch.DLS,ZaSearch.ALIASES,ZaSearch.ACCOUNTS,ZaSearch.RESOURCES],controller:e};
try{
var h=ZaSearch.searchDirectory(l).Body.SearchDirectoryResponse
}
catch(o){
e._handleException(o,"ZaSearch.isAccountExist",null,false)
}
var s=new ZaItemList(null);
s.loadFromJS(h);
if(s.size()>0){
if(r){
var n=s.getArray()[0];
if(n.type==ZaItem.ALIAS){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_aliasWithThisNameExists)
}else{
if(n.type==ZaItem.RESOURCE){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_resourceWithThisNameExists)
}else{
if(n.type==ZaItem.DL){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_dlWithThisNameExists)
}else{
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_accountWithThisNameExists)
}}}}}else{
return false
}
return true
};
ZaSearch.modifySavedSearches=function(e,l){
if(ZaSearchField.canSaveSearch()){
var r=AjxSoapDoc.create("ModifyAdminSavedSearchesRequest",ZaZimbraAdmin.URN,null);
for(var t=0;
t<e.length;
t++){
var s=e[t];
var n=r.set("search",s.query);
n.setAttribute("name",s.name)
}
var h=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=r;
o.noAuthToken=true;
if(l){
o.asyncMode=true;
o.callback=l
}
h.invoke(o)
}};
ZaSearch.getSavedSearches=function(e,h){
if(ZaSearchField.canViewSavedSearch()){
var s=AjxSoapDoc.create("GetAdminSavedSearchesRequest",ZaZimbraAdmin.URN,null);
if(e){
for(var t=0;
t<e.length;
t++){
var n=s.set("search","");
n.setAttribute("name",e[t])
}}
var r=new ZmCsfeCommand();
var o=new Object();
o.soapDoc=s;
o.noAuthToken=true;
if(h){
o.asyncMode=true;
o.callback=h
}
return r.invoke(o)
}};
ZaSearch.updateSavedSearch=function(n){
ZaSearch.SAVED_SEARCHES=[];
if(n!=null){
var o=n._data||n;
var t=o.Body.GetAdminSavedSearchesResponse.search;
if(t){
for(var e=0;
e<t.length;
e++){
ZaSearch.SAVED_SEARCHES.push({
name:t[e].name,query:t[e]._content}
)
}}}
ZaSearch._savedSearchToBeUpdated=false
};
ZaSearch.loadPredefinedSearch=function(){
if(ZaSearchField.canViewSavedSearch()){
var o=ZaApp.getInstance().getSavedSearchList();
if((!AjxUtil.isEmpty(o))&&(ZaSearchField.canSaveSearch())){
var c=[];
for(var s=0;
s<o.length;
s++){
var t=o[s].name;
var r=o[s].query;
if(r&&r.search(/zimbraIsDomainAdminAccount/)!=-1){
r=r.replace(/zimbraIsDomainAdminAccount/g,"zimbraIsDelegatedAdminAccount");
c.push({
name:t,query:r}
)
}}
if(c.length!=0){
ZaSearch.modifySavedSearches(c);
ZaSearch.SAVED_SEARCHES=l;
ZaSearch._savedSearchToBeUpdated=false
}}
if((AjxUtil.isEmpty(o))&&(ZaSearchField.canSaveSearch())){
var l=[];
for(var e=0;
e<ZaSearch.getPredefinedSavedSearchesForAdminOnly().length;
e++){
l.push(ZaSearch.getPredefinedSavedSearchesForAdminOnly()[e])
}
for(var h=0;
h<ZaSearch.getPredefinedSavedSearches().length;
h++){
l.push(ZaSearch.getPredefinedSavedSearches()[h])
}
ZaSearch.modifySavedSearches(l);
ZaSearch.SAVED_SEARCHES=l;
ZaSearch._savedSearchToBeUpdated=false
}}};
ZaSearch.parseSavedSearchQuery=function(query){
if(query==null||query.length<=0){
return
}
var regEx=/^(.+)#{3}JSON:(.+)#{3}(.+)$/;
var results=query.match(regEx);
if(results!=null){
query=results[1];
eval("var jsonObj = "+results[2]);
query+=jsonObj.func(jsonObj.args);
query+=results[3]
}
return query
};
ZaSearch.getTimestampByDays=function(n){
var o=parseInt(n);
var e=new Date();
var t=e.getTime();
e.setTime(t+o*86400*1000);
return ZaUtil.getAdminServerDateTime(e,true)
};
ZaSearch.SAVED_SEARCHES=[];
ZaSearch.escapeLdapQuery=function(e){
e=String(e);
e=e.replace(/\\/g,"\\5C");
e=e.replace(/\(/g,"\\28");
e=e.replace(/\)/g,"\\29");
e=e.replace(/\*/g,"\\2A");
return e
}
}
if(AjxPackage.define("zimbraAdmin.search.model.ZaSearchOption")){
ZaSearchOption=function(){};
ZaSearchOption.ID=100;
ZaSearchOption.BASIC_TYPE_ID=ZaSearchOption.ID++;
ZaSearchOption.OBJECT_TYPE_ID=ZaSearchOption.ID++;
ZaSearchOption.DOMAIN_ID=ZaSearchOption.ID++;
ZaSearchOption.SERVER_ID=ZaSearchOption.ID++;
ZaSearchOption.ADVANCED_ID=ZaSearchOption.ID++;
ZaSearchOption.COS_ID=ZaSearchOption.ID++;
ZaSearchOption.BASIC_FILTER_ID=ZaSearchOption.ID++;
ZaSearchOption.STATUS_FILTER_ID=ZaSearchOption.ID++;
ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID=ZaSearchOption.ID++;
ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID=ZaSearchOption.ID++;
ZaSearchOption.COS_FILTER_ID=ZaSearchOption.ID++;
ZaSearchOption.SERVER_FILTER_ID=ZaSearchOption.ID++;
ZaSearchOption.DOMAIN_FILTER_ID=ZaSearchOption.ID++;
ZaSearchOption.A_basic_uid=ZaAccount.A_uid;
ZaSearchOption.A_basic_sn="sn";
ZaSearchOption.A_basic_displayName=ZaAccount.A_displayname;
ZaSearchOption.A_basic_zimbraId=ZaItem.A_zimbraId;
ZaSearchOption.A_basic_status=ZaAccount.A_accountStatus;
ZaSearchOption.A_objTypeAccount="option_"+ZaSearch.ACCOUNTS;
ZaSearchOption.A_objTypeAccountAdmin=ZaAccount.A_zimbraIsAdminAccount;
ZaSearchOption.A_objTypeSystemAccount=ZaAccount.A_zimbraIsSystemAccount;
ZaSearchOption.A_enableAccountLastLoginTime_From="enable_"+ZaAccount.A_zimbraLastLogonTimestamp+"_From";
ZaSearchOption.A_enableAccountLastLoginTime_To="enable_"+ZaAccount.A_zimbraLastLogonTimestamp+"_To";
ZaSearchOption.A_includeNeverLoginedAccounts="include_never_login_accounts";
ZaSearchOption.A_accountLastLoginTime_From=ZaAccount.A_zimbraLastLogonTimestamp+"_From";
ZaSearchOption.A_accountLastLoginTime_To=ZaAccount.A_zimbraLastLogonTimestamp+"_To";
ZaSearchOption.A_accountLastLoginTime=ZaAccount.A_zimbraLastLogonTimestamp;
ZaSearchOption.A_zimbraMailForwardingAddress=ZaAccount.A_zimbraMailForwardingAddress;
ZaSearchOption.A_zimbraPrefMailForwardingAddress=ZaAccount.A_zimbraPrefMailForwardingAddress;
ZaSearchOption.A_objTypeDl="option_"+ZaSearch.DLS;
ZaSearchOption.A_objTypeAlias="option_"+ZaSearch.ALIASES;
ZaSearchOption.A_objTypeResource="option_"+ZaSearch.RESOURCES;
ZaSearchOption.A_domainFilter="option_domain_filter";
ZaSearchOption.A_domainList="option_domain_list";
ZaSearchOption.A_domainListChecked="option_domain_list_checked";
ZaSearchOption.A_serverList="option_server_list";
ZaSearchOption.A_serverListChecked="option_server_list_checked";
ZaSearchOption.A_cosFilter="option_cos_filter";
ZaSearchOption.A_cosList="option_cos_list";
ZaSearchOption.A_cosListChecked="option_cos_list_checked";
ZaSearchOption.A2_cosNotSet="option_not_set_cosid";
ZaSearchOption.A2_status_active="status_active";
ZaSearchOption.A2_status_closed="status_closed";
ZaSearchOption.A2_status_locked="status_locked";
ZaSearchOption.A2_status_lockout="status_lockout";
ZaSearchOption.A2_status_pending="status_pending";
ZaSearchOption.A2_status_maintenance="status_maintenance";
ZaSearchOption.A2_status_list="status_list";
ZaSearchOption.getObjectTypeXModel=function(l){
var r={
items:[]};
var e=[{
id:ZaSearchOption.A_basic_uid,ref:"options/"+ZaSearchOption.A_basic_uid,type:_STRING_}
,{
id:ZaSearchOption.A_objTypeAccountAdmin,ref:"options/"+ZaSearchOption.A_objTypeAccountAdmin,type:_STRING_}
,{
id:ZaSearchOption.A_objTypeSystemAccount,ref:"options/"+ZaSearchOption.A_objTypeSystemAccount,type:_STRING_}
,{
id:ZaSearchOption.A_basic_sn,ref:"options/"+ZaSearchOption.A_basic_sn,type:_STRING_}
,{
id:ZaSearchOption.A_basic_displayName,ref:"options/"+ZaSearchOption.A_basic_displayName,type:_STRING_}
,{
id:ZaSearchOption.A_basic_zimbraId,ref:"options/"+ZaSearchOption.A_basic_zimbraId,type:_STRING_}
,{
id:ZaSearchOption.A_basic_status,ref:"options/"+ZaSearchOption.A_basic_status,type:_STRING_}
];
if(ZaSearchOption.A_objTypeAccountDomainAdmin){
e.push({
id:ZaSearchOption.A_objTypeAccountDomainAdmin,ref:"options/"+ZaSearchOption.A_objTypeAccountDomainAdmin,type:_STRING_}
)
}
var o=[{
id:ZaSearchOption.A_objTypeAccount,ref:"options/"+ZaSearchOption.A_objTypeAccount,type:_STRING_}
,{
id:ZaSearchOption.A_objTypeDl,ref:"options/"+ZaSearchOption.A_objTypeDl,type:_STRING_}
,{
id:ZaSearchOption.A_objTypeAlias,ref:"options/"+ZaSearchOption.A_objTypeAlias,type:_STRING_}
,{
id:ZaSearchOption.A_objTypeResource,ref:"options/"+ZaSearchOption.A_objTypeResource,type:_STRING_}
,{
id:ZaSearchOption.A_objTypeDomain,ref:"options/"+ZaSearchOption.A_objTypeDomain,type:_STRING_}
];
var n=[{
id:ZaSearchOption.A_domainFilter,ref:"options/"+ZaSearchOption.A_domainFilter,type:_STRING_}
,{
id:ZaSearchOption.A_domainListChecked,ref:"options/"+ZaSearchOption.A_domainListChecked,type:_LIST_}
,{
id:ZaSearchOption.A_domainList,ref:"options/"+ZaSearchOption.A_domainList,type:_LIST_}
];
var h=[{
id:ZaSearchOption.A_serverListChecked,ref:"options/"+ZaSearchOption.A_serverListChecked,type:_LIST_}
,{
id:ZaSearchOption.A_serverList,ref:"options/"+ZaSearchOption.A_serverList,type:_LIST_}
];
var t=[{
id:ZaSearchOption.A_enableAccountLastLoginTime_From,ref:ZaSearchOption.A_enableAccountLastLoginTime_From,type:_STRING_}
,{
id:ZaSearchOption.A_enableAccountLastLoginTime_To,ref:ZaSearchOption.A_enableAccountLastLoginTime_To,type:_STRING_}
,{
id:ZaSearchOption.A_includeNeverLoginedAccounts,ref:ZaSearchOption.A_includeNeverLoginedAccounts,type:_STRING_}
,{
id:ZaSearchOption.A_accountLastLoginTime_From,ref:"options/"+ZaSearchOption.A_accountLastLoginTime_From,type:_DATETIME_}
,{
id:ZaSearchOption.A_accountLastLoginTime_To,ref:"options/"+ZaSearchOption.A_accountLastLoginTime_To,type:_DATETIME_}
,{
id:ZaSearchOption.A_zimbraMailForwardingAddress,ref:"options/"+ZaSearchOption.A_zimbraMailForwardingAddress,type:_STRING_}
];
var s=[{
id:ZaSearchOption.A_cosFilter,ref:"options/"+ZaSearchOption.A_cosFilter,type:_STRING_}
,{
id:ZaSearchOption.A_cosListChecked,ref:"options/"+ZaSearchOption.A_cosListChecked,type:_LIST_}
,{
id:ZaSearchOption.A2_cosNotSet,ref:ZaSearchOption.A2_cosNotSet,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaSearchOption.A_cosList,ref:"options/"+ZaSearchOption.A_cosList,type:_LIST_}
];
if(l==ZaSearchOption.OBJECT_TYPE_ID){
r.items=o
}else{
if(l==ZaSearchOption.DOMAIN_ID){
r.items=n
}else{
if(l==ZaSearchOption.SERVER_ID){
r.items=h
}else{
if(l==ZaSearchOption.BASIC_TYPE_ID){
r.items=e
}else{
if(l==ZaSearchOption.ADVANCED_ID){
r.items=t
}else{
if(l==ZaSearchOption.COS_ID){
r.items=s
}}}}}}
return r
};
ZaSearchOption.getNewObjectTypeXModel=function(r){
var o={
items:[]};
var n=[{
id:ZaSearchOption.A_basic_uid,ref:"options/"+ZaSearchOption.A_basic_uid,type:_STRING_,minLength:3}
,{
id:ZaSearchOption.A_objTypeAccountAdmin,ref:"options/"+ZaSearchOption.A_objTypeAccountAdmin,type:_STRING_}
,{
id:ZaSearchOption.A_objTypeSystemAccount,ref:"options/"+ZaSearchOption.A_objTypeSystemAccount,type:_STRING_}
,{
id:ZaSearchOption.A_basic_sn,ref:"options/"+ZaSearchOption.A_basic_sn,type:_STRING_,minLength:3}
,{
id:ZaSearchOption.A_basic_displayName,ref:"options/"+ZaSearchOption.A_basic_displayName,type:_STRING_,minLength:3}
,{
id:ZaSearchOption.A_basic_zimbraId,ref:"options/"+ZaSearchOption.A_basic_zimbraId,type:_STRING_,minLength:3}
];
if(ZaSearchOption.A_objTypeAccountDomainAdmin){
n.push({
id:ZaSearchOption.A_objTypeAccountDomainAdmin,ref:"options/"+ZaSearchOption.A_objTypeAccountDomainAdmin,type:_STRING_}
)
}
var t=[{
id:ZaSearchOption.A_domainFilter,ref:"options/"+ZaSearchOption.A_domainFilter,type:_STRING_,minLength:3}
,{
id:ZaSearchOption.A_domainListChecked,ref:"options/"+ZaSearchOption.A_domainListChecked,type:_LIST_}
,{
id:ZaSearchOption.A_domainList,ref:"options/"+ZaSearchOption.A_domainList,type:_LIST_}
];
var s=[{
id:ZaSearchOption.A_serverListChecked,ref:"options/"+ZaSearchOption.A_serverListChecked,type:_LIST_}
,{
id:ZaSearchOption.A_serverList,ref:"options/"+ZaSearchOption.A_serverList,type:_LIST_}
];
var c=[{
id:ZaSearchOption.A_enableAccountLastLoginTime_From,ref:ZaSearchOption.A_enableAccountLastLoginTime_From,type:_STRING_}
,{
id:ZaSearchOption.A_enableAccountLastLoginTime_To,ref:ZaSearchOption.A_enableAccountLastLoginTime_To,type:_STRING_}
,{
id:ZaSearchOption.A_includeNeverLoginedAccounts,ref:ZaSearchOption.A_includeNeverLoginedAccounts,type:_STRING_}
,{
id:ZaSearchOption.A_accountLastLoginTime_From,ref:"options/"+ZaSearchOption.A_accountLastLoginTime_From,type:_DATETIME_}
,{
id:ZaSearchOption.A_accountLastLoginTime_To,ref:"options/"+ZaSearchOption.A_accountLastLoginTime_To,type:_DATETIME_}
];
var e=[{
id:ZaSearchOption.A_cosFilter,ref:"options/"+ZaSearchOption.A_cosFilter,type:_STRING_,minLength:3}
,{
id:ZaSearchOption.A_cosListChecked,ref:"options/"+ZaSearchOption.A_cosListChecked,type:_LIST_}
,{
id:ZaSearchOption.A2_cosNotSet,ref:ZaSearchOption.A2_cosNotSet,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaSearchOption.A_cosList,ref:"options/"+ZaSearchOption.A_cosList,type:_LIST_}
];
var h=[{
id:ZaSearchOption.A_zimbraMailForwardingAddress,ref:"options/"+ZaSearchOption.A_zimbraMailForwardingAddress,type:_STRING_,minLength:3}
];
var l=[{
id:ZaSearchOption.A2_status_active,ref:"options/"+ZaSearchOption.A2_status_active,type:_STRING_}
,{
id:ZaSearchOption.A2_status_closed,ref:"options/"+ZaSearchOption.A2_status_closed,type:_STRING_}
,{
id:ZaSearchOption.A2_status_locked,ref:"options/"+ZaSearchOption.A2_status_locked,type:_STRING_}
,{
id:ZaSearchOption.A2_status_lockout,ref:"options/"+ZaSearchOption.A2_status_lockout,type:_STRING_}
,{
id:ZaSearchOption.A2_status_pending,ref:"options/"+ZaSearchOption.A2_status_pending,type:_STRING_}
,{
id:ZaSearchOption.A2_status_maintenance,ref:"options/"+ZaSearchOption.A2_status_maintenance,type:_STRING_}
,{
id:ZaSearchOption.A2_status_list,ref:"options/"+ZaSearchOption.A2_status_list,type:_LIST_}
];
if(r==ZaSearchOption.BASIC_FILTER_ID){
o.items=n
}else{
if(r==ZaSearchOption.SERVER_FILTER_ID){
o.items=s
}else{
if(r==ZaSearchOption.COS_FILTER_ID){
o.items=e
}else{
if(r==ZaSearchOption.DOMAIN_FILTER_ID){
o.items=t
}else{
if(r==ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID){
o.items=h
}else{
if(r==ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID){
o.items=c
}else{
if(r==ZaSearchOption.STATUS_FILTER_ID){
o.items=l
}}}}}}}
return o
};
ZaSearchOption.getObjectTypeXForm=function(d,y){
var n=ZaSearchOptionView.HEADER_HEIGHT+8;
var u=[{
value:ZaAccount.ACCOUNT_STATUS_ACTIVE,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_ACTIVE)}
,{
value:ZaAccount.ACCOUNT_STATUS_CLOSED,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_CLOSED)}
,{
value:ZaAccount.ACCOUNT_STATUS_LOCKED,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_LOCKED)}
,{
value:ZaAccount.ACCOUNT_STATUS_LOCKOUT,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_LOCKOUT)}
,{
value:ZaAccount.ACCOUNT_STATUS_PENDING,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_PENDING)}
,{
value:ZaAccount.ACCOUNT_STATUS_MAINTENANCE,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_MAINTENANCE)}
];
var g={
numCols:2,width:150,cssClass:"ZaSearchOptionOverview",cssStyle:"",items:[]};
var l=[{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_uid,label:ZaMsg.search_option_uid,align:_LEFT_,width:100,onChange:ZaSearchBuilderController.handleOptions,toolTipContent:ZaMsg.tt_search_option_uid,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_sn,label:ZaMsg.search_option_sn,align:_LEFT_,width:100,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_displayName,label:ZaMsg.search_option_displayName,align:_LEFT_,width:100,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_zimbraId,label:ZaMsg.search_option_zimbraId,align:_LEFT_,width:100,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_OSELECT1_,ref:ZaSearchOption.A_basic_status,editable:false,msgName:ZaMsg.NAD_AccountStatus,label:ZaMsg.NAD_AccountStatus,labelLocation:_LEFT_,choices:u,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_GROUP_,name:"special search cases",colSpan:"2",numCols:2,width:150,items:[]}
];
var f=l.length;
var o={
type:_CHECKBOX_,ref:ZaSearchOption.A_objTypeAccountAdmin,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.SearchFilter_Accounts_admin,align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,bmolsnr:true,enableDisableChecks:[],visibilityChecks:[]};
l[f-1].items.push(o);
if(ZaSearchOption.A_objTypeAccountDomainAdmin){
var h={
type:_CHECKBOX_,ref:ZaSearchOption.A_objTypeAccountDomainAdmin,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.SearchFilter_Accounts_domainadmin,align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,bmolsnr:true,enableDisableChecks:[],visibilityChecks:[],labelWrap:true};
l[f-1].items.push(h)
}
var s={
type:_CHECKBOX_,ref:ZaSearchOption.A_objTypeSystemAccount,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.SearchFilter_System_Accounts,align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,bmolsnr:true,enableDisableChecks:[],visibilityChecks:[]};
l[f-1].items.push(s);
var e=[{
type:_CHECKBOX_,ref:ZaSearchOption.A_objTypeAccount,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.SearchFilter_Accounts,align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])"]}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_objTypeDl,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.SearchFilter_DLs,align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DL_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])"]}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_objTypeAlias,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.SearchFilter_Aliases,align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ALIAS_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])"]}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_objTypeResource,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.SearchFilter_Resources,align:_RIGHT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.RESOURCE_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])"]}
];
var c=50;
var m=[{
type:_TEXTFIELD_,ref:ZaSearchOption.A_domainFilter,label:ZaMsg.search_option_filter,align:_LEFT_,width:ZaSearchOptionView.DOMAIN_OPTION_WIDTH-c,inputHelp:ZaMsg.search_option_filter_input_help_domain,toolTipContent:ZaMsg.tt_domain_search_option_filter,onChange:ZaSearchBuilderController.filterDomains,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_OUTPUT_,value:ZaMsg.no_domain_found_msg,colSpan:"*",cssStyle:"white-space: normal",visibilityChecks:[[XForm.checkInstanceValueEmty,ZaSearchOption.A_domainList]]}
,{
type:_GROUP_,width:ZaSearchOptionView.WIDTH,colSpan:"*",height:y-30-25-5,cssStyle:"overflow:auto; position:absolute;margin-top: 5px;",visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaSearchOption.A_domainList]],items:[{
type:_DWT_LIST_,ref:ZaSearchOption.A_domainList,width:ZaSearchOptionView.WIDTH-2,height:y-30-25,forceUpdate:true,widgetClass:ZaOptionList,multiselect:true,preserveSelection:false,bmolsnr:true,onSelection:ZaSearchBuilderController.filterSelectionListener}
]}
];
var p=[{
type:_GROUP_,width:ZaSearchOptionView.WIDTH,colSpan:"*",height:y-30,cssStyle:"overflow:auto; position:absolute;",items:[{
type:_DWT_LIST_,ref:ZaSearchOption.A_serverList,width:ZaSearchOptionView.WIDTH-2,height:y-30,forceUpdate:true,widgetClass:ZaOptionList,multiselect:true,preserveSelection:false,bmolsnr:true,onSelection:ZaSearchBuilderController.filterSelectionListener}
]}
];
var t=[{
type:_TEXTFIELD_,ref:ZaSearchOption.A_cosFilter,label:ZaMsg.search_option_filter,align:_LEFT_,width:ZaSearchOptionView.COS_OPTION_WIDTH-c,inputHelp:ZaMsg.search_option_filter_input_help_cos,toolTipContent:ZaMsg.tt_cos_search_option_filter,onChange:ZaSearchBuilderController.filterCOSES,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_GROUP_,colSpan:"2",numCols:2,width:150,items:[{
ref:ZaSearchOption.A2_cosNotSet,type:_CHECKBOX_,msgName:ZaMsg.search_includeObjectWithoutCosId,label:ZaMsg.search_includeObjectWithoutCosId,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
]}
,{
type:_OUTPUT_,value:ZaMsg.no_cos_found_msg,colSpan:"*",cssStyle:"white-space: normal",visibilityChecks:[[XForm.checkInstanceValueEmty,ZaSearchOption.A_cosList]]}
,{
type:_GROUP_,width:ZaSearchOptionView.WIDTH,colSpan:"*",height:y-30-25-5,cssStyle:"overflow:auto; position:absolute;margin-top: 5px;",visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaSearchOption.A_cosList]],items:[{
type:_DWT_LIST_,ref:ZaSearchOption.A_cosList,width:ZaSearchOptionView.WIDTH-2,height:y-30-25,forceUpdate:true,widgetClass:ZaOptionList,multiselect:true,preserveSelection:false,bmolsnr:true,onSelection:ZaSearchBuilderController.filterSelectionListener}
]}
];
var r=[{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,colSpan:"*",cssClass:"ZaSearchOptionViewSubHeader",value:ZaMsg.search_option_lastAccessTime,width:280}
,{
type:_GROUP_,numCols:5,colSpan:"*",items:[{
type:_CELL_SPACER_,width:40}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_enableAccountLastLoginTime_From,label:ZaMsg.enable_search_option_label_from,trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_enableAccountLastLoginTime_To,label:ZaMsg.enable_search_option_label_to,trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
]}
,{
type:_GROUP_,numCols:3,colSpan:"*",items:[{
type:_CELL_SPACER_,width:40}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_includeNeverLoginedAccounts,label:ZaMsg.includeNeverLoginedAccounts,trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
]}
,{
type:_GROUP_,colSpan:"*",numCols:2,colSize:["60px","auto"],items:[{
ref:ZaSearchOption.A_accountLastLoginTime_From,colSpan:"*",type:_DWT_DATETIME_,onChange:ZaSearchBuilderController.handleOptions,visibilityChecks:[[XForm.checkInstanceValue,ZaSearchOption.A_enableAccountLastLoginTime_From,"TRUE"]],bmolsnr:true,firstDayOfWeek:ZaZimbraAdmin.FIRST_DAY_OF_WEEK,visibilityChangeEventSources:[ZaSearchOption.A_enableAccountLastLoginTime_From],label:ZaMsg.search_option_label_from,labelLocation:_LEFT_}
,{
ref:ZaSearchOption.A_accountLastLoginTime_To,colSpan:"*",type:_DWT_DATETIME_,onChange:ZaSearchBuilderController.handleOptions,visibilityChecks:[[XForm.checkInstanceValue,ZaSearchOption.A_enableAccountLastLoginTime_To,"TRUE"]],visibilityChangeEventSources:[ZaSearchOption.A_enableAccountLastLoginTime_To],bmolsnr:true,firstDayOfWeek:ZaZimbraAdmin.FIRST_DAY_OF_WEEK,label:ZaMsg.search_option_label_to,labelLocation:_LEFT_}
]}
,{
type:_SPACER_}
,{
type:_TEXTFIELD_,ref:ZaSearchOption.A_zimbraMailForwardingAddress,label:ZaMsg.LB_External_mail,align:_LEFT_,width:150,onChange:ZaSearchBuilderController.handleOptions,toolTipContent:ZaMsg.LB_External_mail_tt,enableDisableChecks:[],visibilityChecks:[]}
]}
];
if(d==ZaSearchOption.OBJECT_TYPE_ID){
g.items=e
}else{
if(d==ZaSearchOption.DOMAIN_ID){
g.items=m
}else{
if(d==ZaSearchOption.SERVER_ID){
g.items=p
}else{
if(d==ZaSearchOption.BASIC_TYPE_ID){
g.items=l;
g.width=ZaSearchOptionView.BASIC_OPTION_WIDTH
}else{
if(d==ZaSearchOption.ADVANCED_ID){
g.items=r;
g.width=ZaSearchOptionView.ADVANCED_OPTION_WIDTH
}else{
if(d==ZaSearchOption.COS_ID){
g.items=t
}}}}}}
return g
};
ZaSearchOption.getNewObjectTypeXForm=function(d,p){
var m={
numCols:2,cssClass:"ZaSearchOptionOverview",items:[]};
var f=[{
type:_GROUP_,colSizes:["90px","120px"],items:[{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_uid,label:ZaMsg.search_option_uid,align:_LEFT_,width:100,toolTipContent:ZaMsg.tt_search_option_uid,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_CELL_SPACER_,height:10,colSpan:"*"}
,{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_sn,label:ZaMsg.search_option_sn,align:_LEFT_,width:100,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_CELL_SPACER_,height:10,colSpan:"*"}
,{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_displayName,label:ZaMsg.search_option_displayName,align:_LEFT_,width:100,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_CELL_SPACER_,height:10,colSpan:"*"}
,{
type:_TEXTFIELD_,ref:ZaSearchOption.A_basic_zimbraId,label:ZaMsg.search_option_zimbraId,align:_LEFT_,width:100,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_CELL_SPACER_,height:10,colSpan:"*"}
,{
type:_GROUP_,name:"special search cases",colSpan:"2",numCols:2,colSizes:["30px","180px"],items:[]}
]}
];
var u=f[0].items.length;
var t={
type:_WIZ_CHECKBOX_,ref:ZaSearchOption.A_objTypeAccountAdmin,trueValue:"TRUE",falseValue:"FALSE",valign:_TOP_,label:ZaMsg.SearchFilter_Accounts_admin,onChange:ZaSearchBuilderController.newHandleOptions,bmolsnr:true,enableDisableChecks:[],visibilityChecks:[]};
f[0].items[u-1].items.push(t);
if(ZaSearchOption.A_objTypeAccountDomainAdmin){
var c={
type:_WIZ_CHECKBOX_,ref:ZaSearchOption.A_objTypeAccountDomainAdmin,trueValue:"TRUE",falseValue:"FALSE",valign:_TOP_,onChange:ZaSearchBuilderController.newHandleOptions,label:ZaMsg.SearchFilter_Accounts_domainadmin,bmolsnr:true,enableDisableChecks:[],visibilityChecks:[],labelWrap:true};
f[0].items[u-1].items.push(c)
}
var h={
type:_WIZ_CHECKBOX_,ref:ZaSearchOption.A_objTypeSystemAccount,trueValue:"TRUE",falseValue:"FALSE",valign:_TOP_,onChange:ZaSearchBuilderController.newHandleOptions,label:ZaMsg.SearchFilter_System_Accounts,bmolsnr:true,enableDisableChecks:[],visibilityChecks:[]};
f[0].items[u-1].items.push(h);
var r=[{
type:_TEXTFIELD_,ref:ZaSearchOption.A_domainFilter,label:ZaMsg.search_option_filter,align:_LEFT_,width:ZaSearchOptionView.WIDTH-35,inputHelp:ZaMsg.search_option_filter_input_help_domain,toolTipContent:ZaMsg.tt_domain_search_option_filter,labelCssStyle:"white-space:nowrap",onChange:ZaSearchBuilderController.filterDomains,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_OUTPUT_,value:ZaMsg.no_domain_found_msg,colSpan:"*",cssStyle:"white-space: normal",visibilityChecks:[[XForm.checkInstanceValueEmty,ZaSearchOption.A_domainList]]}
,{
type:_GROUP_,width:ZaSearchOptionView.WIDTH,colSpan:"*",height:p-30-25-5,cssStyle:"overflow:auto; margin-top: 5px;",visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaSearchOption.A_domainList]],items:[{
type:_DWT_LIST_,ref:ZaSearchOption.A_domainList,width:ZaSearchOptionView.WIDTH-2,height:p-30-25,forceUpdate:true,widgetClass:ZaOptionList,multiselect:true,preserveSelection:true,onSelection:ZaSearchBuilderController.filterSelectionListener}
]}
];
var l=[{
type:_GROUP_,width:ZaSearchOptionView.WIDTH,colSpan:"*",height:p-30,cssStyle:"overflow:auto;",items:[{
type:_DWT_LIST_,ref:ZaSearchOption.A_serverList,width:ZaSearchOptionView.WIDTH-2,height:p-30,forceUpdate:true,widgetClass:ZaOptionList,multiselect:true,preserveSelection:true,onSelection:ZaSearchBuilderController.filterSelectionListener}
]}
];
var s=[{
type:_TEXTFIELD_,ref:ZaSearchOption.A_cosFilter,label:ZaMsg.search_option_filter,align:_LEFT_,width:ZaSearchOptionView.WIDTH-50,inputHelp:ZaMsg.search_option_filter_input_help_cos,toolTipContent:ZaMsg.tt_cos_search_option_filter,onChange:ZaSearchBuilderController.filterCOSES,labelCssStyle:"white-space:nowrap",enableDisableChecks:[],visibilityChecks:[]}
,{
type:_GROUP_,colSpan:"2",numCols:2,items:[{
ref:ZaSearchOption.A2_cosNotSet,type:_CHECKBOX_,msgName:ZaMsg.search_includeObjectWithoutCosId,label:ZaMsg.search_includeObjectWithoutCosId,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,onChange:ZaSearchBuilderController.handleOptions,enableDisableChecks:[],visibilityChecks:[]}
]}
,{
type:_OUTPUT_,value:ZaMsg.no_cos_found_msg,colSpan:"*",cssStyle:"white-space: normal",visibilityChecks:[[XForm.checkInstanceValueEmty,ZaSearchOption.A_cosList]]}
,{
type:_GROUP_,width:ZaSearchOptionView.WIDTH,colSpan:"*",height:p-30-25-5,cssStyle:"overflow:auto; margin-top: 5px;",visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaSearchOption.A_cosList]],items:[{
type:_DWT_LIST_,ref:ZaSearchOption.A_cosList,width:ZaSearchOptionView.WIDTH-2,height:p-30-25,forceUpdate:true,widgetClass:ZaOptionList,multiselect:true,preserveSelection:true,onSelection:ZaSearchBuilderController.filterSelectionListener}
]}
];
var e=[{
type:_GROUP_,numCols:2,items:[{
type:_GROUP_,numCols:5,colSpan:"*",items:[{
type:_CELL_SPACER_,width:40}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_enableAccountLastLoginTime_From,label:ZaMsg.enable_search_option_label_from,trueValue:"TRUE",falseValue:"FALSE",subLabel:"",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_enableAccountLastLoginTime_To,label:ZaMsg.enable_search_option_label_to,trueValue:"TRUE",falseValue:"FALSE",subLabel:"",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[]}
]}
,{
type:_GROUP_,numCols:3,colSpan:"*",items:[{
type:_CELL_SPACER_,width:40}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A_includeNeverLoginedAccounts,label:ZaMsg.includeNeverLoginedAccounts,subLabel:"",trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
]}
,{
type:_GROUP_,colSpan:"*",numCols:2,colSize:["60px","auto"],items:[{
ref:ZaSearchOption.A_accountLastLoginTime_From,colSpan:"*",type:_DWT_DATETIME_,visibilityChecks:[[XForm.checkInstanceValue,ZaSearchOption.A_enableAccountLastLoginTime_From,"TRUE"]],bmolsnr:true,firstDayOfWeek:ZaZimbraAdmin.FIRST_DAY_OF_WEEK,visibilityChangeEventSources:[ZaSearchOption.A_enableAccountLastLoginTime_From],label:ZaMsg.search_option_label_from,labelLocation:_LEFT_}
,{
ref:ZaSearchOption.A_accountLastLoginTime_To,colSpan:"*",type:_DWT_DATETIME_,visibilityChecks:[[XForm.checkInstanceValue,ZaSearchOption.A_enableAccountLastLoginTime_To,"TRUE"]],visibilityChangeEventSources:[ZaSearchOption.A_enableAccountLastLoginTime_To],bmolsnr:true,firstDayOfWeek:ZaZimbraAdmin.FIRST_DAY_OF_WEEK,label:ZaMsg.search_option_label_to,labelLocation:_LEFT_}
]}
]}
];
var o=[{
type:_OUTPUT_,value:ZaMsg.LBL_New_External_mail,colSpan:2}
,{
type:_TEXTFIELD_,colSpan:2,ref:ZaSearchOption.A_zimbraMailForwardingAddress,enableDisableChecks:[],visibilityChecks:[]}
];
var n=[{
type:_CHECKBOX_,ref:ZaSearchOption.A2_status_active,subLabel:"",label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_ACTIVE),trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A2_status_closed,subLabel:"",label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_CLOSED),trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A2_status_locked,subLabel:"",label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_LOCKED),trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A2_status_lockout,subLabel:"",label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_LOCKOUT),trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A2_status_pending,subLabel:"",label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_PENDING),trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
,{
type:_CHECKBOX_,ref:ZaSearchOption.A2_status_maintenance,subLabel:"",label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_MAINTENANCE),trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,labelLocation:_RIGHT_,onChange:ZaSearchBuilderController.newHandleOptions,enableDisableChecks:[],visibilityChecks:[],labelWrap:true}
];
if(d==ZaSearchOption.BASIC_FILTER_ID){
m.items=f
}else{
if(d==ZaSearchOption.SERVER_FILTER_ID){
m.items=l
}else{
if(d==ZaSearchOption.COS_FILTER_ID){
m.items=s
}else{
if(d==ZaSearchOption.DOMAIN_FILTER_ID){
m.items=r
}else{
if(d==ZaSearchOption.EXT_EMAIL_ADDRESS_FILTER_ID){
m.items=o
}else{
if(d==ZaSearchOption.LASTER_LOGIN_TIME_FILTER_ID){
m.items=e
}else{
if(d==ZaSearchOption.STATUS_FILTER_ID){
m.items=n
}}}}}}}
return m
};
ZaSearchOption.getDefaultInstance=function(t){
var e={};
e.options={};
if(t==ZaSearchOption.OBJECT_TYPE_ID){
e.options[ZaSearchOption.A_objTypeAccount]="TRUE";
e.options[ZaSearchOption.A_objTypeAlias]="TRUE";
e.options[ZaSearchOption.A_objTypeDl]="TRUE";
e.options[ZaSearchOption.A_objTypeResource]="TRUE"
}else{
if(t==ZaSearchOption.DOMAIN_ID){}else{
if(t==ZaSearchOption.SERVER_ID){}else{
if(t==ZaSearchOption.BASIC_TYPE_ID){}else{
if(t==ZaSearchOption.COS_ID){
e[ZaSearchOption.A2_cosNotSet]="FALSE"
}else{
if(t==ZaSearchOption.ADVANCED_ID){
e[ZaSearchOption.A_enableAccountLastLoginTime_From]="FALSE";
e[ZaSearchOption.A_enableAccountLastLoginTime_To]="FALSE";
e[ZaSearchOption.A_includeNeverLoginedAccounts]="FALSE"
}}}}}}
return e
};
ZaSearchOption.getDefaultObjectTypes=function(){
var e=[];
e[0]=[ZaSearch.ACCOUNTS,ZaSearch.ALIASES,ZaSearch.DLS,ZaSearch.RESOURCES];
return e
};
ZaOptionList=function(t,e){
DwtListView.call(this,t,null,Dwt.STATIC_STYLE)
};
ZaOptionList.prototype=new DwtListView;
ZaOptionList.prototype.constructor=ZaOptionList;
ZaOptionList.prototype.toString=function(){
return"ZaOptionList"
};
ZaOptionList.prototype._createItemHtml=function(o){
var t=new Array(10);
var n=document.createElement("div");
n[DwtListView._STYLE_CLASS]="Row";
n[DwtListView._SELECTED_STYLE_CLASS]=n[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
n.className=n[DwtListView._STYLE_CLASS];
this.associateItemWithElement(o,n,DwtListView.TYPE_LIST_ITEM);
var e=0;
t[e++]="<table width='100%' cellspacing='0' cellpadding='0'><tr><td width=20>";
t[e++]="<input type=checkbox value='"+o+"' /></td>";
t[e++]="<td>"+o+"</td></tr></table>";
n.innerHTML=t.join("");
return n
}
}
if(AjxPackage.define("zimbraAdmin.servers.model.ZaServer")){
ZaServer=function(){
ZaItem.call(this,"ZaServer");
this._init();
this.type=ZaItem.SERVER
};
ZaServer.modelExtensions=[];
ZaServer.prototype=new ZaItem;
ZaServer.prototype.constructor=ZaServer;
ZaItem.loadMethods.ZaServer=new Array();
ZaItem.initMethods.ZaServer=new Array();
ZaItem.modifyMethods.ZaServer=new Array();
ZaItem.modelExtensions.ZaServer=new Array();
ZaServer.A_name="cn";
ZaServer.A_description="description";
ZaServer.A_notes="zimbraNotes";
ZaServer.A_Service="zimbraService";
ZaServer.A_ServiceHostname="zimbraServiceHostname";
ZaServer.A_zimbraMailPort="zimbraMailPort";
ZaServer.A_zimbraMailSSLPort="zimbraMailSSLPort";
ZaServer.A_zimbraMailMode="zimbraMailMode";
ZaServer.A_zimbraMailReferMode="zimbraMailReferMode";
ZaServer.A_zimbraServiceInstalled="zimbraServiceInstalled";
ZaServer.A_zimbraLdapServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_ldap";
ZaServer.A_zimbraMailboxServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_mailbox";
ZaServer.A_zimbraMtaServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_mta";
ZaServer.A_zimbraSnmpServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_snmp";
ZaServer.A_zimbraAntiVirusServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_antivirus";
ZaServer.A_zimbraAntiSpamServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_antispam";
ZaServer.A_zimbraOpenDKIMServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_opendkim";
ZaServer.A_zimbraSpellServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_spell";
ZaServer.A_zimbraLoggerServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_logger";
ZaServer.A_zimbraMailProxyServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_proxy";
ZaServer.A_zimbraVmwareHAServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_vmwareha";
ZaServer.A_zimbraPolicydServiceInstalled="_"+ZaServer.A_zimbraServiceInstalled+"_cbpolicyd";
ZaServer.A_zimbraReverseProxyHttpEnabled="zimbraReverseProxyHttpEnabled";
ZaServer.A_zimbraServiceEnabled="zimbraServiceEnabled";
ZaServer.A_zimbraPolicydServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_cbpolicyd";
ZaServer.A_zimbraLdapServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_ldap";
ZaServer.A_zimbraMailboxServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_mailbox";
ZaServer.A_zimbraMtaServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_mta";
ZaServer.A_zimbraSnmpServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_snmp";
ZaServer.A_zimbraAntiVirusServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_antivirus";
ZaServer.A_zimbraAntiSpamServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_antispam";
ZaServer.A_zimbraOpenDKIMServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_opendkim";
ZaServer.A_zimbraSpellServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_spell";
ZaServer.A_zimbraLoggerServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_logger";
ZaServer.A_zimbraMailProxyServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_proxy";
ZaServer.A_zimbraVmwareHAServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_vmwareha";
ZaServer.A_zimbraWebClientServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_zimbra";
ZaServer.A_zimbraAdminClientServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_zimbraAdmin";
ZaServer.A_zimbraMailClientServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_service";
ZaServer.A_zimbraZimletServiceEnabled="_"+ZaServer.A_zimbraServiceEnabled+"_zimlet";
ZaServer.servlets=["zimbra","zimbraAdmin","service","zimlet"];
ZaServer.A_zimbraMtaSaslAuthEnable="zimbraMtaSaslAuthEnable";
ZaServer.A_zimbraMtaSmtpDnsSupportLevel="zimbraMtaSmtpDnsSupportLevel";
ZaServer.A_zimbraMtaRelayHost="zimbraMtaRelayHost";
ZaServer.A_zimbraMtaFallbackRelayHost="zimbraMtaFallbackRelayHost";
ZaServer.A_zimbraMtaTlsAuthOnly="zimbraMtaTlsAuthOnly";
ZaServer.A_zimbraMtaMyNetworks="zimbraMtaMyNetworks";
ZaServer.A_zimbraMilterBindPort="zimbraMilterBindPort";
ZaServer.A_zimbraMilterBindAddress="zimbraMilterBindAddress";
ZaServer.A_zimbraMilterServerEnabled="zimbraMilterServerEnabled";
ZaServer.A_zimbraSmtpHostname="zimbraSmtpHostname";
ZaServer.A_SmtpPort="zimbraSmtpPort";
ZaServer.A_SmtpTimeout="zimbraSmtpTimeout";
ZaServer.A_LmtpAdvertisedName="zimbraLmtpAdvertisedName";
ZaServer.A_LmtpBindAddress="zimbraLmtpBindAddress";
ZaServer.A_LmtpBindPort="zimbraLmtpBindPort";
ZaServer.A_zimbraPop3NumThreads="zimbraPop3NumThreads";
ZaServer.A_Pop3AdvertisedName="zimbraPop3AdvertisedName";
ZaServer.A_Pop3BindAddress="zimbraPop3BindAddress";
ZaServer.A_zimbraPop3BindPort="zimbraPop3BindPort";
ZaServer.A_zimbraPop3SSLBindPort="zimbraPop3SSLBindPort";
ZaServer.A_Pop3SSLServerEnabled="zimbraPop3SSLServerEnabled";
ZaServer.A_Pop3ServerEnabled="zimbraPop3ServerEnabled";
ZaServer.A_Pop3CleartextLoginEnabled="zimbraPop3CleartextLoginEnabled";
ZaServer.A_zimbraImapNumThreads="zimbraImapNumThreads";
ZaServer.A_zimbraImapBindPort="zimbraImapBindPort";
ZaServer.A_ImapServerEnabled="zimbraImapServerEnabled";
ZaServer.A_ImapSSLBindPort="zimbraImapSSLBindPort";
ZaServer.A_ImapSSLServerEnabled="zimbraImapSSLServerEnabled";
ZaServer.A_ImapCleartextLoginEnabled="zimbraImapCleartextLoginEnabled";
ZaServer.A_zimbraReverseProxyLookupTarget="zimbraReverseProxyLookupTarget";
ZaServer.A_RedologEnabled="zimbraRedologEnabled";
ZaServer.A_RedologLogPath="zimbraRedologLogPath";
ZaServer.A_RedologArchiveDir="zimbraRedologArchiveDir";
ZaServer.A_RedologBacklogDir="zimbraRedologBacklogDir";
ZaServer.A_RedologRolloverFileSizeKB="zimbraRedologRolloverFileSizeKB";
ZaServer.A_RedologFsyncIntervalMS="zimbraRedologFsyncIntervalMS";
ZaServer.A_MasterRedologClientConnections="zimbraMasterRedologClientConnections";
ZaServer.A_MasterRedologClientTimeoutSec="zimbraMasterRedologClientTimeoutSec";
ZaServer.A_MasterRedologClientTcpNoDelay="zimbraMasterRedologClientTcpNoDelay";
ZaServer.A_zimbraUserServicesEnabled="zimbraUserServicesEnabled";
ZaServer.A_RemovedVolumes="removed_volumes";
ZaServer.A_Volumes="volumes";
ZaServer.A_VolumeId="id";
ZaServer.A_VolumeName="name";
ZaServer.A_VolumeRootPath="rootpath";
ZaServer.A_VolumeCompressBlobs="compressBlobs";
ZaServer.A_VolumeCompressionThreshold="compressionThreshold";
ZaServer.A_VolumeType="type";
ZaServer.A_CurrentIndexVolumeId="current_index_volume_id";
ZaServer.A_CurrentMsgVolumeId="current_msg_volume_id";
ZaServer.A_isCurrent="isCurrent";
ZaServer.A_zimbraApplianceVendor="zimbraApplianceVendor";
ZaServer.A_zimbraApplianceName="zimbraApplianceName";
ZaServer.A_zimbraApplianceVersion="zimbraApplianceVersion";
ZaServer.A_zimbraApplianceFullVersion="zimbraApplianceFullVersion";
ZaServer.A_zimbraApplianceDetails="zimbraApplianceDetails";
ZaServer.A_zimbraApplianceDefaultRepUrl="zimbraApplianceDefaultRepUrl";
ZaServer.A_zimbraApplianceCustomRepUrl="zimbraApplianceCustomRepUrl";
ZaServer.A_zimbraApplianceCustomRepUrlUser="zimbraApplianceCustomRepUrlUser";
ZaServer.A_zimbraApplianceCustomRepUrlPass="zimbraApplianceCustomRepUrlPass";
ZaServer.A_zimbraApplianceUpdateOption="zimbraApplianceUpdateOption";
ZaServer.A_zimbraApplianceUpdateType="zimbraApplianceUpdateType";
ZaServer.A_zimbraApplianceUpdatehourofrun="zimbraApplianceUpdatehourofrun";
ZaServer.A_zimbraMailBindAddress="zimbraMailBindAddress";
ZaServer.A_zimbraMailSSLBindAddress="zimbraMailSSLBindAddress";
ZaServer.A_zimbraMailSSLClientCertBindAddress="zimbraMailSSLClientCertBindAddress";
ZaServer.A_zimbraAdminBindAddress="zimbraAdminBindAddress";
ZaServer.A_zimbraSpnegoAuthPrincipal="zimbraSpnegoAuthPrincipal";
ZaServer.A_zimbraSpnegoAuthTargetName="zimbraSpnegoAuthTargetName";
ZaServer.A_zimbraAutoProvPollingInterval="zimbraAutoProvPollingInterval";
ZaServer.A_zimbraAutoProvScheduledDomains="zimbraAutoProvScheduledDomains";
ZaServer.A_zimbraMailSSLClientCertMode="zimbraMailSSLClientCertMode";
ZaServer.A_zimbraMailSSLClientCertPort="zimbraMailSSLClientCertPort";
ZaServer.A_zimbraMailSSLProxyClientCertPort="zimbraMailSSLProxyClientCertPort";
ZaServer.A_zimbraReverseProxyMailMode="zimbraReverseProxyMailMode";
ZaServer.A_zimbraReverseProxyClientCertMode="zimbraReverseProxyClientCertMode";
ZaServer.A_zimbraReverseProxyClientCertCA="zimbraReverseProxyClientCertCA";
ZaServer.A_zimbraScheduledTaskNumThreads="zimbraScheduledTaskNumThreads";
ZaServer.A_zimbraMailPurgeSleepInterval="zimbraMailPurgeSleepInterval";
ZaServer.A_zimbraIsMonitorHost="zimbraIsMonitorHost";
ZaServer.A_showVolumes="show_volumes";
ZaServer.A_zimbraLogHostname="zimbraLogHostname";
ZaServer.A_isCurrentVolume="isCurrentVolume";
ZaServer.STANDALONE="standalone";
ZaServer.MASTER="master";
ZaServer.SLAVE="slave";
ZaServer.A2_volume_selection_cache="volume_selection_cache";
ZaServer.MSG=1;
ZaServer.INDEX=10;
ZaServer.currentkeys={};
ZaServer.currentkeys[ZaServer.MSG]=ZaServer.A_CurrentMsgVolumeId;
ZaServer.currentkeys[ZaServer.INDEX]=ZaServer.A_CurrentIndexVolumeId;
ZaServer.volumeTypes=[ZaServer.MSG,ZaServer.INDEX];
ZaServer.updateoptions={};
ZaServer.updateoptions[0]=ZaMsg.NONE=111;
ZaServer.updateoptions[2]=ZaMsg.EVERYDAY=112;
ZaServer.updateoptions[3]=ZaMsg.EVERYSUNDAY=113;
ZaServer.updateoptions[4]=ZaMsg.EVERYMONDAY=114;
ZaServer.updateoptions[5]=ZaMsg.EVERYTUESDAY=115;
ZaServer.updateoptions[6]=ZaMsg.EVERYWEDNESDAY=116;
ZaServer.updateoptions[7]=ZaMsg.EVERYTHURSDAY=117;
ZaServer.updateoptions[8]=ZaMsg.EVERYFRIDAY=118;
ZaServer.updateoptions[9]=ZaMsg.EVERYSATURDAY=119;
ZaServer.updatehourofrun={};
ZaServer.updatehourofrun[0]=ZaMsg.ONEAM=201;
ZaServer.updatehourofrun[1]=ZaMsg.TWOAM=202;
ZaServer.updatehourofrun[2]=ZaMsg.THREEAM=203;
ZaServer.updatehourofrun[3]=ZaMsg.FOURAM=204;
ZaServer.updatehourofrun[4]=ZaMsg.FIVEAM=205;
ZaServer.updatehourofrun[5]=ZaMsg.SIXAM=206;
ZaServer.updatehourofrun[6]=ZaMsg.SEVENAM=207;
ZaServer.updatehourofrun[7]=ZaMsg.EIGHTAM=208;
ZaServer.updatehourofrun[8]=ZaMsg.NINEAM=209;
ZaServer.updatehourofrun[9]=ZaMsg.TENAM=210;
ZaServer.updatehourofrun[10]=ZaMsg.ELEVENAM=211;
ZaServer.updatehourofrun[11]=ZaMsg.TWELVEAM=212;
ZaServer.updatehourofrun[12]=ZaMsg.TWELVEPM=312;
ZaServer.updatehourofrun[13]=ZaMsg.ELEVENPM=311;
ZaServer.updatehourofrun[14]=ZaMsg.TENPM=310;
ZaServer.updatehourofrun[15]=ZaMsg.NINEPM=309;
ZaServer.updatehourofrun[16]=ZaMsg.EIGHTPM=308;
ZaServer.updatehourofrun[17]=ZaMsg.SEVENPM=307;
ZaServer.updatehourofrun[18]=ZaMsg.SIXPM=306;
ZaServer.updatehourofrun[19]=ZaMsg.FIVEPM=305;
ZaServer.updatehourofrun[20]=ZaMsg.FOURPM=304;
ZaServer.updatehourofrun[21]=ZaMsg.THREEPM=303;
ZaServer.updatehourofrun[22]=ZaMsg.TWOPM=302;
ZaServer.updatehourofrun[23]=ZaMsg.ONEPM=301;
ZaServer.APPLIANCEUPDATE_CD=2;
ZaServer.APPLIANCEUPDATE_DEFAULTREP=1;
ZaServer.APPLIANCEUPDATE_CUSTOMREP=3;
ZaServer.DEFAULT_IMAP_PORT=143;
ZaServer.DEFAULT_IMAP_SSL_PORT=993;
ZaServer.DEFAULT_POP3_PORT=110;
ZaServer.DEFAULT_POP3_SSL_PORT=995;
ZaServer.DEFAULT_IMAP_PORT_ZCS=7143;
ZaServer.DEFAULT_IMAP_SSL_PORT_ZCS=7993;
ZaServer.DEFAULT_POP3_PORT_ZCS=7110;
ZaServer.DEFAULT_POP3_SSL_PORT_ZCS=7995;
ZaServer.ERR_NOT_CIDR=1;
ZaServer.ERR_NOT_STARTING_ADDR=2;
ZaServer.DOT_TO_CIDR={};
ZaServer.DOT_TO_CIDR["0x80000000"]=ZaServer.DOT_TO_CIDR["128.0.0.0"]=1;
ZaServer.DOT_TO_CIDR["0xc0000000"]=ZaServer.DOT_TO_CIDR["192.0.0.0"]=2;
ZaServer.DOT_TO_CIDR["0xe0000000"]=ZaServer.DOT_TO_CIDR["224.0.0.0"]=3;
ZaServer.DOT_TO_CIDR["0xf0000000"]=ZaServer.DOT_TO_CIDR["240.0.0.0"]=4;
ZaServer.DOT_TO_CIDR["0xf8000000"]=ZaServer.DOT_TO_CIDR["248.0.0.0"]=5;
ZaServer.DOT_TO_CIDR["0xfc000000"]=ZaServer.DOT_TO_CIDR["252.0.0.0"]=6;
ZaServer.DOT_TO_CIDR["0xfe000000"]=ZaServer.DOT_TO_CIDR["254.0.0.0"]=7;
ZaServer.DOT_TO_CIDR["0xff000000"]=ZaServer.DOT_TO_CIDR["255.0.0.0"]=8;
ZaServer.DOT_TO_CIDR["0xff800000"]=ZaServer.DOT_TO_CIDR["255.128.0.0"]=9;
ZaServer.DOT_TO_CIDR["0xffc00000"]=ZaServer.DOT_TO_CIDR["255.192.0.0"]=10;
ZaServer.DOT_TO_CIDR["0xffe00000"]=ZaServer.DOT_TO_CIDR["255.224.0.0"]=11;
ZaServer.DOT_TO_CIDR["0xfff00000"]=ZaServer.DOT_TO_CIDR["255.240.0.0"]=12;
ZaServer.DOT_TO_CIDR["0xfff80000"]=ZaServer.DOT_TO_CIDR["255.248.0.0"]=13;
ZaServer.DOT_TO_CIDR["0xfffc0000"]=ZaServer.DOT_TO_CIDR["255.252.0.0"]=14;
ZaServer.DOT_TO_CIDR["0xfffe0000"]=ZaServer.DOT_TO_CIDR["255.254.0.0"]=15;
ZaServer.DOT_TO_CIDR["0xffff0000"]=ZaServer.DOT_TO_CIDR["255.255.0.0"]=16;
ZaServer.DOT_TO_CIDR["0xffff8000"]=ZaServer.DOT_TO_CIDR["255.255.128.0"]=17;
ZaServer.DOT_TO_CIDR["0xffffc000"]=ZaServer.DOT_TO_CIDR["255.255.192.0"]=16;
ZaServer.DOT_TO_CIDR["0xffffe000"]=ZaServer.DOT_TO_CIDR["255.255.224.0"]=19;
ZaServer.DOT_TO_CIDR["0xfffff000"]=ZaServer.DOT_TO_CIDR["255.255.240.0"]=20;
ZaServer.DOT_TO_CIDR["0xfffff800"]=ZaServer.DOT_TO_CIDR["255.255.248.0"]=21;
ZaServer.DOT_TO_CIDR["0xfffffc00"]=ZaServer.DOT_TO_CIDR["255.255.252.0"]=22;
ZaServer.DOT_TO_CIDR["0xfffffe00"]=ZaServer.DOT_TO_CIDR["255.255.254.0"]=23;
ZaServer.DOT_TO_CIDR["0xffffff00"]=ZaServer.DOT_TO_CIDR["255.255.255.0"]=24;
ZaServer.DOT_TO_CIDR["0xffffff80"]=ZaServer.DOT_TO_CIDR["255.255.255.128"]=25;
ZaServer.DOT_TO_CIDR["0xffffffc0"]=ZaServer.DOT_TO_CIDR["255.255.255.192"]=26;
ZaServer.DOT_TO_CIDR["0xffffffe0"]=ZaServer.DOT_TO_CIDR["255.255.255.224"]=27;
ZaServer.DOT_TO_CIDR["0xfffffff0"]=ZaServer.DOT_TO_CIDR["255.255.255.240"]=28;
ZaServer.DOT_TO_CIDR["0xfffffff8"]=ZaServer.DOT_TO_CIDR["255.255.255.248"]=29;
ZaServer.DOT_TO_CIDR["0xfffffffc"]=ZaServer.DOT_TO_CIDR["255.255.255.252"]=30;
ZaServer.DOT_TO_CIDR["0xfffffffe"]=ZaServer.DOT_TO_CIDR["255.255.255.254"]=31;
ZaServer.DOT_TO_CIDR["0xffffffff"]=ZaServer.DOT_TO_CIDR["255.255.255.255"]=32;
ZaServer.FLUSH_CACHE_RIGHT="flushCache";
ZaServer.MANAGE_VOLUME_RIGHT="manageVolume";
ZaServer.RIGHT_GET_SESSIONS="getSessions";
ZaServer.isValidPostfixSubnetString=function(c){
var s=c.indexOf("/");
var r=c.lastIndexOf("/");
if(s==-1||s!=r){
return ZaServer.ERR_NOT_CIDR
}
var n=parseInt(c.substr(r+1,(c.length-r-1)));
if(isNaN(n)||n==""||n==null||n<1){
return ZaServer.ERR_NOT_CIDR
}
var h=c.substr(0,r);
var o=ZaServer.octetsToLong(h);
if(o<0){
return ZaServer.ERR_NOT_CIDR
}
var l=0;
var t=32-n;
for(var e=31;
e>=t;
e--){
l+=Math.pow(2,e)
}
if(o!=ZaServer.applyMask(o,l)){
return ZaServer.ERR_NOT_STARTING_ADDR
}
return 0
};
ZaServer.iGetNumNetBits=function(e){
var n=e.indexOf("/");
var o=e.lastIndexOf("/");
var t=parseInt(e.substr(o+1,(e.length-o-1)));
return t
};
ZaServer.oGetStartingAddress=function(e){
return ZaServer.longToOctets(ZaServer.lGetStartingAddress(e))
};
ZaServer.lGetStartingAddress=function(c){
var s=ZaServer.iGetNumNetBits(c);
var r=c.lastIndexOf("/");
var h=c.substr(0,r);
var n=ZaServer.octetsToLong(h);
var l=0;
var o=32-s;
for(var e=31;
e>=o;
e--){
l+=Math.pow(2,e)
}
var t=ZaServer.applyMask(n,l);
return t
};
ZaServer.lGetEndingAddress=function(e,o){
var t=e+Math.pow(2,(32-o))-1;
return t
};
ZaServer.applyMask=function(t,e){
var o=(t&e);
if(o>=0){
return o
}else{
return(4294967296+o)
}};
ZaServer.octetsToLong=function(l){
var h=/^[A-Fa-f0-9:.]+$/;
if(h.test(l)){
var o=l.indexOf(".");
var t=l.indexOf(":");
var e=l.indexOf("::");
if(e!=-1){
var c=l.split("::");
if(c.length!=2){
return -1
}else{
if(o==-1&&t>-1){
octetsub0=c[0].split(":");
octetsub1=c[1].split(":");
if(octetsub0.length+octetsub1.length>7){
return -1
}else{
for(var n=0;
n<octetsub0.length;
n++){
if(octetsub0[n].length>4){
return -1
}}
for(var n=0;
n<octetsub1.length;
n++){
if(octetsub1[n].length>4){
return -1
}}}}else{
if((o>-1)){
if(c[0]!=""){
return -1
}else{
octetsub=c[1].split(".");
for(var n=0;
n<octetsub.length;
n++){
if(octetsub[n]>parseInt("255")){
return -1
}}}}}}
return 0
}
if(o!=-1){
var c=l.split(".");
if(c.length!=4){
return -1
}else{
for(var s=0;
s<c.length;
s++){
var n=c[s];
if(n>parseInt("255")){
return -1
}}
var r=Math.pow(256,3)*parseInt(c[0])+Math.pow(256,2)*parseInt(c[1])+Math.pow(256,1)*parseInt(c[2])+parseInt(c[3]);
return r
}}
if(t!=-1){
var c=l.split(":");
if(c.length!=8){
return -1
}else{
for(var s=0;
s<c.length;
s++){
if(c[s].length>4){
return -1
}}
return 0
}}}
return -1
};
ZaServer.longToOctets=function(e){
var s=Math.floor(e/Math.pow(256,3));
var n=Math.floor((e%Math.pow(256,3))/Math.pow(256,2));
var o=Math.floor(((e%Math.pow(256,3))%Math.pow(256,2))/Math.pow(256,1));
var t=Math.floor((((e%Math.pow(256,3))%Math.pow(256,2))%Math.pow(256,1))/Math.pow(256,0));
return[s,n,o,t].join(".")
};
ZaServer.volumeTypeChoices=new XFormChoices({
1:ZaMsg.VM_VOLUME_Msg,10:ZaMsg.VM_VOLUME_Index}
,XFormChoices.HASH);
ZaServer.volumeObjModel={
items:[{
id:ZaServer.A_isCurrentVolume,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_VolumeId,type:_NUMBER_}
,{
id:ZaServer.A_VolumeName,type:_STRING_}
,{
id:ZaServer.A_VolumeType,type:_ENUM_,choices:ZaServer.volumeTypes,defaultValue:ZaServer.MSG}
,{
id:ZaServer.A_VolumeRootPath,type:_STRING_}
,{
id:ZaServer.A_VolumeCompressBlobs,type:_ENUM_,choices:[false,true],defaultValue:true}
,{
id:ZaServer.A_VolumeCompressionThreshold,type:_NUMBER_,defaultValue:4096}
,{
id:"_index",type:_NUMBER_}
],type:_OBJECT_};
ZaServer.myXModel={
items:[{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:ZaItem.A_zimbraCreateTimestamp,ref:"attrs/"+ZaItem.A_zimbraCreateTimestamp}
,{
id:ZaServer.A_name,ref:"attrs/"+ZaServer.A_name,type:_STRING_}
,ZaItem.descriptionModelItem,{
id:ZaServer.A_notes,ref:"attrs/"+ZaServer.A_notes,type:_STRING_,maxLength:1024}
,{
id:ZaServer.A_Service,ref:"attrs/"+ZaServer.A_Service,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_ServiceHostname,ref:"attrs/"+ZaServer.A_ServiceHostname,type:_HOSTNAME_OR_IP_,maxLength:256}
,{
id:ZaServer.A_zimbraPolicydServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraPolicydServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraLdapServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraLdapServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMailboxServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraMailboxServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraWebClientServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraWebClientServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraAdminClientServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraAdminClientServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMailClientServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraMailClientServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraZimletServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraZimletServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMtaServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraMtaServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraSnmpServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraSnmpServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraAntiVirusServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraAntiVirusServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraAntiSpamServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraAntiSpamServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraOpenDKIMServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraOpenDKIMServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraSpellServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraSpellServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraLoggerServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraLoggerServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraVmwareHAServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraVmwareHAServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMailProxyServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraMailProxyServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraReverseProxyLookupTarget,ref:"attrs/"+ZaServer.A_zimbraReverseProxyLookupTarget,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_zimbraLdapServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraLdapServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMailboxServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraMailboxServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMtaServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraMtaServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraSnmpServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraSnmpServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraAntiVirusServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraAntiVirusServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraAntiSpamServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraAntiSpamServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraOpenDKIMServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraOpenDKIMServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraSpellServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraSpellServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraLoggerServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraLoggerServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMailProxyServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraMailProxyServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraVmwareHAServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraVmwareHAServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraPolicydServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraPolicydServiceInstalled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMtaSaslAuthEnable,ref:"attrs/"+ZaServer.A_zimbraMtaSaslAuthEnable,type:_COS_ENUM_,choices:["yes","no"]}
,{
id:ZaServer.A_zimbraMtaTlsAuthOnly,ref:"attrs/"+ZaServer.A_zimbraMtaTlsAuthOnly,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_zimbraMtaRelayHost,ref:"attrs/"+ZaServer.A_zimbraMtaRelayHost,type:_COS_HOSTNAME_OR_IP_,maxLength:256}
,{
id:ZaServer.A_zimbraMtaFallbackRelayHost,ref:"attrs/"+ZaServer.A_zimbraMtaFallbackRelayHost,type:_COS_HOSTNAME_OR_IP_,maxLength:256}
,{
id:ZaServer.A_zimbraMtaMyNetworks,ref:"attrs/"+ZaServer.A_zimbraMtaMyNetworks,type:_COS_STRING_,maxLength:10240}
,{
id:ZaServer.A_zimbraMtaSmtpDnsSupportLevel,ref:"attrs/"+ZaServer.A_zimbraMtaSmtpDnsSupportLevel,type:_COS_ENUM_,choices:ZaSettings.smtpDnsSupportLevel}
,{
id:ZaServer.A_zimbraMilterBindAddress,ref:"attrs/"+ZaServer.A_zimbraMilterBindAddress,type:_LIST_,listItem:{
type:_HOSTNAME_OR_IP_,maxLength:128}}
,{
id:ZaServer.A_zimbraMilterBindPort,ref:"attrs/"+ZaServer.A_zimbraMilterBindPort,type:_COS_PORT_}
,{
id:ZaServer.A_zimbraMilterServerEnabled,ref:"attrs/"+ZaServer.A_zimbraMilterServerEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_zimbraSpnegoAuthTargetName,ref:"attrs/"+ZaServer.A_zimbraSpnegoAuthTargetName,type:_STRING_}
,{
id:ZaServer.A_zimbraSpnegoAuthPrincipal,ref:"attrs/"+ZaServer.A_zimbraSpnegoAuthPrincipal,type:_STRING_}
,{
id:ZaServer.A_zimbraMailSSLClientCertMode,ref:"attrs/"+ZaServer.A_zimbraMailSSLClientCertMode,type:_COS_STRING_,choices:["Disabled","NeedClientAuth","WantClientAuth"]}
,{
id:ZaServer.A_zimbraMailSSLClientCertPort,ref:"attrs/"+ZaServer.A_zimbraMailSSLClientCertPort,type:_COS_PORT_}
,{
id:ZaServer.A_zimbraMailSSLProxyClientCertPort,ref:"attrs/"+ZaServer.A_zimbraMailSSLProxyClientCertPort,type:_COS_PORT_}
,{
id:ZaServer.A_zimbraReverseProxyMailMode,ref:"attrs/"+ZaServer.A_zimbraReverseProxyMailMode,type:_COS_STRING_,choices:["http","https","both","mixed","redirect"]}
,{
id:ZaServer.A_zimbraReverseProxyClientCertMode,ref:"attrs/"+ZaServer.A_zimbraReverseProxyClientCertMode,type:_COS_STRING_,choices:["on","off","optional"]}
,{
id:ZaServer.A_zimbraReverseProxyClientCertCA,ref:"attrs/"+ZaServer.A_zimbraReverseProxyClientCertCA,type:_STRING_}
,{
id:ZaServer.A_zimbraSmtpHostname,ref:"attrs/"+ZaServer.A_zimbraSmtpHostname,type:_COS_LIST_,listItem:{
type:_HOSTNAME_OR_IP_,maxLength:256}}
,{
id:ZaServer.A_SmtpPort,ref:"attrs/"+ZaServer.A_SmtpPort,type:_COS_PORT_}
,{
id:ZaServer.A_SmtpTimeout,ref:"attrs/"+ZaServer.A_SmtpTimeout,type:_COS_NUMBER_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaServer.A_LmtpAdvertisedName,ref:"attrs/"+ZaServer.A_LmtpAdvertisedName,type:_STRING_,maxLength:128}
,{
id:ZaServer.A_LmtpBindAddress,ref:"attrs/"+ZaServer.A_LmtpBindAddress,type:_HOSTNAME_OR_IP_,maxLength:256}
,{
id:ZaServer.A_LmtpBindPort,ref:"attrs/"+ZaServer.A_LmtpBindPort,type:_COS_PORT_}
,{
id:ZaServer.A_zimbraScheduledTaskNumThreads,ref:"attrs/"+ZaServer.A_zimbraScheduledTaskNumThreads,type:_COS_INT_,minInclusive:1,maxInclusive:2147483647}
,{
id:ZaServer.A_zimbraMailPurgeSleepInterval,ref:"attrs/"+ZaServer.A_zimbraMailPurgeSleepInterval,type:_COS_MLIFETIME_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaServer.A_zimbraPop3NumThreads,ref:"attrs/"+ZaServer.A_zimbraPop3NumThreads,type:_COS_INT_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaServer.A_zimbraImapNumThreads,ref:"attrs/"+ZaServer.A_zimbraImapNumThreads,type:_COS_INT_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaServer.A_Pop3AdvertisedName,ref:"attrs/"+ZaServer.A_Pop3AdvertisedName,type:_STRING_,maxLength:128}
,{
id:ZaServer.A_Pop3BindAddress,ref:"attrs/"+ZaServer.A_Pop3BindAddress,type:_HOSTNAME_OR_IP_,maxLength:128}
,{
id:ZaServer.A_Pop3AdvertisedName,ref:"attrs/"+ZaServer.A_Pop3AdvertisedName,type:_STRING_,maxLength:128}
,{
id:ZaServer.A_Pop3BindAddress,ref:"attrs/"+ZaServer.A_Pop3BindAddress,type:_HOSTNAME_OR_IP_,maxLength:128}
,{
id:ZaServer.A_zimbraPop3BindPort,ref:"attrs/"+ZaServer.A_zimbraPop3BindPort,type:_COS_PORT_}
,{
id:ZaServer.A_zimbraPop3SSLBindPort,ref:"attrs/"+ZaServer.A_zimbraPop3SSLBindPort,type:_COS_PORT_}
,{
id:ZaServer.A_Pop3SSLServerEnabled,ref:"attrs/"+ZaServer.A_Pop3SSLServerEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_Pop3ServerEnabled,ref:"attrs/"+ZaServer.A_Pop3ServerEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_Pop3CleartextLoginEnabled,ref:"attrs/"+ZaServer.A_Pop3CleartextLoginEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_zimbraImapBindPort,ref:"attrs/"+ZaServer.A_zimbraImapBindPort,type:_COS_PORT_}
,{
id:ZaServer.A_ImapServerEnabled,ref:"attrs/"+ZaServer.A_ImapServerEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_ImapSSLBindPort,ref:"attrs/"+ZaServer.A_ImapSSLBindPort,type:_COS_PORT_}
,{
id:ZaServer.A_ImapSSLServerEnabled,ref:"attrs/"+ZaServer.A_ImapSSLServerEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_zimbraMailBindAddress,ref:"attrs/"+ZaServer.A_zimbraMailBindAddress,type:_IP_}
,{
id:ZaServer.A_zimbraMailSSLBindAddress,ref:"attrs/"+ZaServer.A_zimbraMailSSLBindAddress,type:_IP_}
,{
id:ZaServer.A_zimbraMailSSLClientCertBindAddress,ref:"attrs/"+ZaServer.A_zimbraMailSSLClientCertBindAddress,type:_IP_}
,{
id:ZaServer.A_zimbraAdminBindAddress,ref:"attrs/"+ZaServer.A_zimbraAdminBindAddress,type:_IP_}
,{
id:ZaServer.A_zimbraAutoProvPollingInterval,ref:"attrs/"+ZaServer.A_zimbraAutoProvPollingInterval,type:_COS_MLIFETIME_,minInclusive:0}
,{
id:ZaServer.A_zimbraAutoProvScheduledDomains,ref:"attrs/"+ZaServer.A_zimbraAutoProvScheduledDomains,type:_LIST_,listItem:{
type:_STRING_,maxLength:256}}
,{
id:ZaServer.A_ImapCleartextLoginEnabled,ref:"attrs/"+ZaServer.A_ImapCleartextLoginEnabled,type:_COS_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_RedologEnabled,ref:"attrs/"+ZaServer.A_RedologEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_RedologLogPath,ref:"attrs/"+ZaServer.A_RedologLogPath,type:_STRING_}
,{
id:ZaServer.A_RedologArchiveDir,ref:"attrs/"+ZaServer.A_RedologArchiveDir,type:_STRING_}
,{
id:ZaServer.A_RedologBacklogDir,ref:"attrs/"+ZaServer.A_RedologBacklogDir,type:_STRING_}
,{
id:ZaServer.A_RedologRolloverFileSizeKB,ref:"attrs/"+ZaServer.A_RedologRolloverFileSizeKB,type:_NUMBER_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaServer.A_RedologFsyncIntervalMS,ref:"attrs/"+ZaServer.A_RedologFsyncIntervalMS,type:_NUMBER_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaServer.A_MasterRedologClientConnections,ref:"attrs/"+ZaServer.A_MasterRedologClientConnections,type:_STRING_}
,{
id:ZaServer.A_MasterRedologClientTimeoutSec,ref:"attrs/"+ZaServer.A_MasterRedologClientTimeoutSec,type:_STRING_}
,{
id:ZaServer.A_MasterRedologClientTcpNoDelay,ref:"attrs/"+ZaServer.A_MasterRedologClientTcpNoDelay,type:_STRING_}
,{
id:ZaServer.A_zimbraUserServicesEnabled,ref:"attrs/"+ZaServer.A_zimbraUserServicesEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaServer.A_Volumes,ref:ZaServer.A_Volumes,type:_LIST_,listItem:ZaServer.volumeObjModel}
,{
id:ZaServer.A_showVolumes,ref:ZaServer.A_showVolumes,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A2_volume_selection_cache,ref:ZaServer.A2_volume_selection_cache,type:_LIST_}
,{
id:ZaServer.A_CurrentIndexVolumeId,ref:ZaServer.A_CurrentIndexVolumeId,type:_NUMBER_}
,{
id:ZaServer.A_CurrentMsgVolumeId,ref:ZaServer.A_CurrentMsgVolumeId,type:_NUMBER_}
,{
id:ZaServer.A_zimbraApplianceVendor,ref:"attrs/"+ZaServer.A_zimbraApplianceVendor,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceName,ref:"attrs/"+ZaServer.A_zimbraApplianceName,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceVersion,ref:"attrs/"+ZaServer.A_zimbraApplianceVersion,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceFullVersion,ref:"attrs/"+ZaServer.A_zimbraApplianceFullVersion,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceDetails,ref:"attrs/"+ZaServer.A_zimbraApplianceDetails,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceDefaultRepUrl,ref:"attrs/"+ZaServer.A_zimbraApplianceDefaultRepUrl,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceCustomRepUrl,ref:"attrs/"+ZaServer.A_zimbraApplianceCustomRepUrl,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceCustomRepUrlUser,ref:"attrs/"+ZaServer.A_zimbraApplianceCustomRepUrlUser,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceCustomRepUrlPass,ref:"attrs/"+ZaServer.A_zimbraApplianceCustomRepUrlPass,type:_STRING_,maxLength:256}
,{
id:ZaServer.A_zimbraApplianceUpdateOption,ref:"attrs/"+ZaServer.A_zimbraApplianceUpdateOption,type:_LIST_}
,{
id:ZaServer.A_zimbraApplianceUpdateType,ref:"attrs/"+ZaServer.A_zimbraApplianceUpdateType,type:_LIST_}
,{
id:ZaServer.A_zimbraApplianceUpdatehourofrun,ref:"attrs/"+ZaServer.A_zimbraApplianceUpdatehourofrun,type:_LIST_}
]};
ZaServer.prototype.toString=function(){
return this.name
};
ZaServer.staticServerByNameCacheTable=[];
ZaServer.getServerByName=function(o){
if(!o){
return null
}
var t=ZaServer.staticServerByNameCacheTable[o];
if(!t){
t=new ZaServer();
try{
t.load("name",o,false,true)
}
catch(e){
throw (e)
}
ZaServer.staticServerByNameCacheTable[o]=t
}
return t
};
ZaServer.staticServerByIdCacheTable=[];
ZaServer.getServerById=function(e){
if(!e){
return null
}
var o=ZaServer.staticServerByIdCacheTable[e];
if(!o){
o=new ZaServer();
try{
o.load("id",e,false,true)
}
catch(t){
throw (t)
}
ZaServer.staticServerByIdCacheTable[e]=o
}
return o
};
ZaServer.getAllMBSs=function(e,h){
var o=AjxSoapDoc.create("GetAllServersRequest",ZaZimbraAdmin.URN,null);
o.getMethod().setAttribute("service","mailbox");
o.getMethod().setAttribute("applyConfig","false");
var r=new Object();
r.soapDoc=o;
r.asyncMode=h?true:false;
r.callback=h?h:null;
if(e){
o.setMethodAttribute("attrs",e.join(","))
}
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_SERVER};
if(h){
ZaRequestMgr.invoke(r,t)
}else{
var s=ZaRequestMgr.invoke(r,t).Body.GetAllServersResponse;
var n=new ZaItemList(ZaServer);
n.loadFromJS(s);
return n
}};
ZaServer.getAll=function(e){
var o=AjxSoapDoc.create("GetAllServersRequest",ZaZimbraAdmin.URN,null);
o.getMethod().setAttribute("applyConfig","false");
var r=new Object();
r.soapDoc=o;
r.asyncMode=false;
if(e){
o.setMethodAttribute("attrs",e.join(","))
}
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_SERVER};
var s=ZaRequestMgr.invoke(r,t).Body.GetAllServersResponse;
var n=new ZaItemList(ZaServer);
n.loadFromJS(s);
return n
};
ZaServer.modifyMethod=function(T){
if(T.attrs==null){
return
}
if(ZaItem.hasWritePermission(ZaServer.A_zimbraServiceEnabled,T)){
var t=AjxUtil.isString(T.attrs[ZaServer.A_zimbraServiceInstalled])?[T.attrs[ZaServer.A_zimbraServiceInstalled]]:T.attrs[ZaServer.A_zimbraServiceInstalled];
if(t){
var d=[];
for(var b=0;
b<t.length;
b++){
var z=t[b];
if(z=="vmware-ha"){
if(T.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_vmwareha"]){
d.push("vmware-ha")
}
continue
}
if(T.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_"+z]){
d.push(z)
}}
for(var b=0;
b<ZaServer.servlets.length;
b++){
var z=ZaServer.servlets[b];
if(this.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_"+z]){
d.push(z)
}}
var l=false;
if(this.attrs[ZaServer.A_zimbraServiceEnabled]){
var o=AjxUtil.isString(this.attrs[ZaServer.A_zimbraServiceEnabled])?[this.attrs[ZaServer.A_zimbraServiceEnabled]]:this.attrs[ZaServer.A_zimbraServiceEnabled];
l=(d.length!=o.length);
if(!l){
for(var b=0;
b<o.length;
b++){
var z=o[b];
if(z=="vmware-ha"){
if(!T.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_vmware"]){
l=true;
break
}else{
continue
}}
if(!T.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_"+z]){
l=true;
break
}}}}
if(l){
T.attrs[ZaServer.A_zimbraServiceEnabled]=d
}}}
if(this.attrs[ZaServer.A_zimbraMailClientServiceEnabled]&&ZaItem.hasRight(ZaServer.MANAGE_VOLUME_RIGHT,this)){
if(T[ZaServer.A_RemovedVolumes]){
var y=T[ZaServer.A_RemovedVolumes].length;
for(var b=0;
b<y;
b++){
if(T[ZaServer.A_RemovedVolumes][b][ZaServer.A_VolumeId]>0){
this.deleteVolume(T[ZaServer.A_RemovedVolumes][b][ZaServer.A_VolumeId])
}}}
if(T[ZaServer.A_Volumes]){
var w=new Array();
var y=T[ZaServer.A_Volumes].length;
for(var b=0;
b<y;
b++){
w.push(T[ZaServer.A_Volumes][b])
}
y=w.length;
for(var b=0;
b<y;
b++){
if(!(w[b][ZaServer.A_VolumeId]>0)&&w[b][ZaServer.A_VolumeName]&&w[b][ZaServer.A_VolumeRootPath]){
var u=this.createVolume(w[b]);
if(u>0){
for(var j in ZaServer.currentkeys){
if(T[ZaServer.currentkeys[j]]==w[b][ZaServer.A_VolumeId]){
T[ZaServer.currentkeys[j]]=u
}}}}}
y--;
var e=this[ZaServer.A_Volumes].length;
for(var b=y;
b>=0;
b--){
var v=w[b];
var m;
for(var s=0;
s<e;
s++){
m=this[ZaServer.A_Volumes][s];
if(m[ZaServer.A_VolumeId]==v[ZaServer.A_VolumeId]){
var h=false;
for(var p in m){
if(m[p]!=v[p]){
h=true;
break
}}
if(h){
this.modifyVolume(w[b])
}
w.splice(b,1)
}}}}
for(var j in ZaServer.currentkeys){
if(T[ZaServer.currentkeys[j]]&&(!this[ZaServer.currentkeys[j]]||(this[ZaServer.currentkeys[j]]!=T[ZaServer.currentkeys[j]]))){
this.setCurrentVolume(T[ZaServer.currentkeys[j]],j)
}}}
var g=false;
var q=AjxSoapDoc.create("ModifyServerRequest",ZaZimbraAdmin.URN,null);
q.set("id",this.id);
var r=new Object();
for(var x in T.attrs){
if(x==ZaItem.A_objectClass||/^_/.test(x)||x==ZaServer.A_zimbraServiceInstalled||x==ZaItem.A_zimbraACE){
continue
}
if(!ZaItem.hasWritePermission(x,this)){
continue
}
g=true;
if(this.attrs[x]!=T.attrs[x]){
if(T.attrs[x] instanceof Array){
if(!this.attrs[x]){
this.attrs[x]=[]
}
if(!this.attrs[x] instanceof Array){
this.attrs[x]=[this.attrs[x]]
}
if(T.attrs[x].join(",").valueOf()!=this.attrs[x].join(",").valueOf()){
var c=T.attrs[x];
if(c.length>0){
for(var b=0;
b<c.length;
b++){
var p=q.set("a",c[b]);
p.setAttribute("n",x)
}}else{
var p=q.set("a");
p.setAttribute("n",x)
}}}else{
var p=q.set("a",T.attrs[x]);
p.setAttribute("n",x)
}}}
if(g){
var k=new Object();
k.soapDoc=q;
var n={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_SERVER};
var f=ZaRequestMgr.invoke(k,n).Body.ModifyServerResponse;
this.initFromJS(f.server[0])
}};
ZaItem.modifyMethods.ZaServer.push(ZaServer.modifyMethod);
ZaServer.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table cellpadding='0' cellspacing='0' border='0'>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;width:350'>";
t[e++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
t[e++]=AjxImg.getImageHtml("Server");
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
e=this._addAttrRow(ZaItem.A_description,t,e);
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaServer.loadMethod=function(m,t){
var s=m?m:"id";
var l=t?t:this.id;
var f=AjxSoapDoc.create("GetServerRequest",ZaZimbraAdmin.URN,null);
var g=f.set("server",l);
g.setAttribute("by",s);
f.setMethodAttribute("applyConfig","false");
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
f.setMethodAttribute("attrs",this.attrsToGet.join(","))
}
var r=new Object();
r.soapDoc=f;
r.asyncMode=false;
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_SERVER};
resp=ZaRequestMgr.invoke(r,o);
this.initFromJS(resp.Body.GetServerResponse.server[0]);
f=AjxSoapDoc.create("BatchRequest","urn:zimbra");
f.setMethodAttribute("onerror","continue");
if(this.attrs[ZaServer.A_zimbraMailClientServiceEnabled]&&ZaItem.hasRight(ZaServer.MANAGE_VOLUME_RIGHT,this)){
var h=f.set("GetAllVolumesRequest",null,null,ZaZimbraAdmin.URN);
var c=f.set("GetCurrentVolumesRequest",null,null,ZaZimbraAdmin.URN)
}
var h=f.set("GetServerNIfsRequest",null,null,ZaZimbraAdmin.URN);
var n=f.set("server",l,h);
n.setAttribute("by",s);
try{
r=new Object();
r.soapDoc=f;
r.asyncMode=false;
if(this.attrs&&this.attrs[ZaServer.A_zimbraMailClientServiceEnabled]){
r.targetServer=this.id
}
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_SERVER};
var e=ZaRequestMgr.invoke(r,o);
this[ZaServer.A_Volumes]=new Array();
if(e.isException&&e.isException()){
ZaApp.getInstance().getCurrentController()._handleException(e.getException(),"ZaServer.loadMethod",null,false)
}
if(e.Body.BatchResponse){
if(e.Body.BatchResponse.Fault){
var u=e.Body.BatchResponse.Fault;
if(u instanceof Array){
u=u[0]
}
if(u){
var d=ZmCsfeCommand.faultToEx(u);
ZaApp.getInstance().getCurrentController()._handleException(d,"ZaServer.loadMethod",null,false)
}}
var p=e.Body.BatchResponse;
if(p.GetAllVolumesResponse){
resp=p.GetAllVolumesResponse[0];
this.parseMyVolumes(resp)
}
if(p.GetCurrentVolumesResponse){
resp=p.GetCurrentVolumesResponse[0];
this.parseCurrentVolumesResponse(resp)
}
if(p.GetServerNIfsResponse){
resp=p.GetServerNIfsResponse[0];
this.parseNIFsResponse(resp)
}}}
catch(d){
ZaApp.getInstance().getCurrentController()._handleException(d,"ZaServer.loadMethod",null,false)
}};
ZaItem.loadMethods.ZaServer.push(ZaServer.loadMethod);
ZaServer.prototype.parseNIFsResponse=function(s){
if(s&&s.ni){
var n=s.ni;
var o=n.length;
this.nifs=[];
for(var t=0;
t<o;
t++){
var e={};
ZaItem.prototype.initFromJS.call(e,n[t]);
this.nifs.push(e)
}}};
ZaServer.prototype.initFromJS=function(s){
ZaItem.prototype.initFromJS.call(this,s);
var n=this.attrs[ZaServer.A_zimbraServiceInstalled];
if(n){
if(AjxUtil.isString(n)){
n=[n]
}
for(var o=0;
o<n.length;
o++){
var e=n[o];
if(e=="vmware-ha"){
this.attrs["_"+ZaServer.A_zimbraServiceInstalled+"_vmwareha"]=true;
this.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_vmwareha"]=false;
continue
}
this.attrs["_"+ZaServer.A_zimbraServiceInstalled+"_"+e]=true;
this.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_"+e]=false
}}
var t=this.attrs[ZaServer.A_zimbraServiceEnabled];
if(t){
if(AjxUtil.isString(t)){
t=[t]
}
for(var o=0;
o<t.length;
o++){
var e=t[o];
if(e=="vmware-ha"){
this.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_vmwareha"]=true;
continue
}
this.attrs["_"+ZaServer.A_zimbraServiceEnabled+"_"+e]=true
}}
this[ZaServer.A_ServiceHostname]=this.attrs[ZaServer.A_ServiceHostname];
this[ZaServer.A_showVolumes]=this.attrs[ZaServer.A_zimbraMailClientServiceEnabled];
if(this.attrs[ZaServer.A_zimbraSmtpHostname]&&!(this.attrs[ZaServer.A_zimbraSmtpHostname] instanceof Array)){
this.attrs[ZaServer.A_zimbraSmtpHostname]=[this.attrs[ZaServer.A_zimbraSmtpHostname]]
}
if(this._defaultValues&&this._defaultValues.attrs[ZaServer.A_zimbraSmtpHostname]&&!(this._defaultValues.attrs[ZaServer.A_zimbraSmtpHostname] instanceof Array)){
this._defaultValues.attrs[ZaServer.A_zimbraSmtpHostname]=[this._defaultValues.attrs[ZaServer.A_zimbraSmtpHostname]]
}
if(this.attrs[ZaServer.A_zimbraMilterBindAddress]&&!(this.attrs[ZaServer.A_zimbraMilterBindAddress] instanceof Array)){
this.attrs[ZaServer.A_zimbraMilterBindAddress]=[this.attrs[ZaServer.A_zimbraMilterBindAddress]]
}
if(this._defaultValues&&this._defaultValues.attrs[ZaServer.A_zimbraMilterBindAddress]&&!(this._defaultValues.attrs[ZaServer.A_zimbraMilterBindAddress] instanceof Array)){
this._defaultValues.attrs[ZaServer.A_zimbraMilterBindAddress]=[this._defaultValues.attrs[ZaServer.A_zimbraMilterBindAddress]]
}
if(this.attrs[ZaServer.A_zimbraAutoProvScheduledDomains]&&!(this.attrs[ZaServer.A_zimbraAutoProvScheduledDomains] instanceof Array)){
this.attrs[ZaServer.A_zimbraAutoProvScheduledDomains]=[this.attrs[ZaServer.A_zimbraAutoProvScheduledDomains]]
}};
ZaServer.prototype.parseCurrentVolumesResponse=function(r){
var s=r.volume;
if(s){
var o=s.length;
for(var t=0;
t<o;
t++){
var n=s[t];
for(var e in ZaServer.currentkeys){
if(n[ZaServer.A_VolumeType]==e){
this[ZaServer.currentkeys[e]]=n[ZaServer.A_VolumeId]
}}}}};
ZaServer.prototype.parseMyVolumes=function(n){
var o=n.volume;
if(o){
var t=o.length;
for(var e=0;
e<t;
e++){
this[ZaServer.A_Volumes].push(o[e])
}}};
ZaServer.compareVolumesByName=function(t,e){
if(t[ZaServer.A_VolumeName]>e[ZaServer.A_VolumeName]){
return 1
}
if(t[ZaServer.A_VolumeName]<e[ZaServer.A_VolumeName]){
return -1
}
return 0
};
ZaServer.prototype.loadVolumes=function(n){
var t=AjxSoapDoc.create("GetAllVolumesRequest",ZaZimbraAdmin.URN,null);
var o={
soapDoc:t,targetServer:this.id,asyncMode:n?true:false,callback:n?n:null};
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_LOADING_VOL};
ZaRequestMgr.invoke(o,e)
};
ZaServer.prototype.deleteVolume=function(s,n){
if(!s){
return false
}
var t=AjxSoapDoc.create("DeleteVolumeRequest",ZaZimbraAdmin.URN,null);
t.getMethod().setAttribute(ZaServer.A_VolumeId,s);
var o={
soapDoc:t,targetServer:this.id,asyncMode:n?true:false,callback:n?n:null};
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_DELETE_VOL};
ZaRequestMgr.invoke(o,e)
};
ZaServer.prototype.createVolume=function(n){
if(!n){
return false
}
var o=AjxSoapDoc.create("CreateVolumeRequest",ZaZimbraAdmin.URN,null);
var s=o.set("volume",null);
s.setAttribute("type",n[ZaServer.A_VolumeType]);
s.setAttribute("name",n[ZaServer.A_VolumeName]);
s.setAttribute("rootpath",n[ZaServer.A_VolumeRootPath]);
s.setAttribute("compressBlobs",n[ZaServer.A_VolumeCompressBlobs]);
s.setAttribute("compressionThreshold",n[ZaServer.A_VolumeCompressionThreshold]);
var r={
soapDoc:o,targetServer:this.id,asyncMode:false};
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_VOL};
var e=ZaRequestMgr.invoke(r,t);
if(e.Body&&e.Body.CreateVolumeResponse&&e.Body.CreateVolumeResponse.volume){
return e.Body.CreateVolumeResponse.volume[0][ZaServer.A_VolumeId]
}};
ZaServer.prototype.modifyVolume=function(o){
if(!o){
return false
}
var t=AjxSoapDoc.create("ModifyVolumeRequest",ZaZimbraAdmin.URN,null);
t.getMethod().setAttribute(ZaServer.A_VolumeId,o[ZaServer.A_VolumeId]);
var n=t.set("volume",null);
n.setAttribute("type",o[ZaServer.A_VolumeType]);
n.setAttribute("name",o[ZaServer.A_VolumeName]);
n.setAttribute("rootpath",o[ZaServer.A_VolumeRootPath]);
n.setAttribute("compressBlobs",o[ZaServer.A_VolumeCompressBlobs]);
n.setAttribute("compressionThreshold",o[ZaServer.A_VolumeCompressionThreshold]);
var s={
soapDoc:t,targetServer:this.id,asyncMode:false};
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_VOL};
ZaRequestMgr.invoke(s,e)
};
ZaServer.prototype.setCurrentVolume=function(s,o){
if(!s||!o){
return false
}
var t=AjxSoapDoc.create("SetCurrentVolumeRequest",ZaZimbraAdmin.URN,null);
t.getMethod().setAttribute(ZaServer.A_VolumeType,o);
t.getMethod().setAttribute(ZaServer.A_VolumeId,s);
var n={
soapDoc:t,targetServer:this.id,asyncMode:false};
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_SET_VOL};
ZaRequestMgr.invoke(n,e)
};
ZaServer.initMethod=function(){
this.attrs=new Object();
this.id="";
this.name=""
};
ZaItem.initMethods.ZaServer.push(ZaServer.initMethod);
ZaServer.flushCache=function(r){
var s=AjxSoapDoc.create("FlushCacheRequest",ZaZimbraAdmin.URN,null);
var t=s.set("cache",null);
var n=[];
if(r.flushSkin){
n.push("skin")
}
if(r.flushLocale){
n.push("locale")
}
if(r.flushZimlet){
n.push("zimlet")
}
t.setAttribute("type",n.join(","));
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:r.busyMsg?r.busyMsg:ZaMsg.BUSY_FLUSH_CACHE,busyId:r.busyId};
var e={
soapDoc:s,targetServer:r.serverId?r.serverId:r.serverList[r.ix].attrs[ZaItem.A_zimbraId],asyncMode:r.callback?true:false,callback:r.callback?r.callback:null};
ZaRequestMgr.invoke(e,o)
}
}
if(AjxPackage.define("zimbraAdmin.zimlets.model.ZaZimlet")){
ZaZimlet=function(){
ZaItem.call(this,"ZaZimlet");
this.label="";
this.type=ZaItem.ZIMLET;
this[ZaModel.currentStep]=1
};
ZaZimlet.prototype=new ZaItem;
ZaZimlet.prototype.constructor=ZaZimlet;
ZaItem.loadMethods.ZaZimlet=new Array();
ZaItem.initMethods.ZaZimlet=new Array();
ZaZimlet.NULL_ZIMLET="com_zimbra_noop";
ZaZimlet.A_name="name";
ZaZimlet.A_zimbraZimletEnabled="zimbraZimletEnabled";
ZaZimlet.A_zimbraZimletPriority="zimbraZimletPriority";
ZaZimlet.A_zimbraZimletIsExtension="zimbraZimletIsExtension";
ZaZimlet.A_zimbraZimletKeyword="zimbraZimletKeyword";
ZaZimlet.A_zimbraZimletVersion="zimbraZimletVersion";
ZaZimlet.A_zimbraZimletDescription="zimbraZimletDescription";
ZaZimlet.A_zimbraZimletIndexingEnabled="zimbraZimletIndexingEnabled";
ZaZimlet.A_zimbraZimletStoreMatched="zimbraZimletStoreMatched";
ZaZimlet.A_zimbraZimletHandlerClass="zimbraZimletHandlerClass";
ZaZimlet.A_zimbraZimletHandlerConfig="zimbraZimletHandlerConfig";
ZaZimlet.A_zimbraZimletContentObject="zimbraZimletContentObject";
ZaZimlet.A_zimbraZimletPanelItem="zimbraZimletPanelItem";
ZaZimlet.A_zimbraCreateTimestamp="zimbraCreateTimestamp";
ZaZimlet.A_zimbraZimletScript="zimbraZimletScript";
ZaZimlet.A_zimbraZimletServerIndexRegex="zimbraZimletServerIndexRegex";
ZaZimlet.A_zimbraAdminExtDisableUIUndeploy="zimbraAdminExtDisableUIUndeploy";
ZaZimlet.A_attachmentId="attId";
ZaZimlet.A_uploadStatus="uploadStatus";
ZaZimlet.A_deployStatus="deployStatus";
ZaZimlet.A_uploadStatusMsg="uploadStatusMsg";
ZaZimlet.A_deployStatusMsg="deployStatusMsg";
ZaZimlet.A_statusMsg="statusMsg";
ZaZimlet.EXCLUDE_MAIL="mail";
ZaZimlet.EXCLUDE_EXTENSIONS="extension";
ZaZimlet.EXCLUDE_NONE="none";
ZaZimlet.STATUS_FAILED="failed";
ZaZimlet.STATUS_SUCCEEDED="succeeded";
ZaZimlet.STATUS_PENDING="pending";
ZaZimlet.ACTION_DEPLOY_ALL="deployAll";
ZaZimlet.ACTION_DEPLOY_LOCAL="deployLocal";
ZaZimlet.ACTION_DEPLOY_STATUS="status";
ZaZimlet.A_progress="progress";
ZaZimlet.A_flushCache="flushCache";
ZaZimlet.prototype.toString=function(){
return this.name
};
ZaZimlet.getAll=function(t,h){
var e=t?t:"none";
var n=AjxSoapDoc.create("GetAllZimletsRequest",ZaZimbraAdmin.URN,null);
n.getMethod().setAttribute("exclude",e);
var r={
soapDoc:n,asyncMode:Boolean(h),callback:h&&new AjxCallback(ZaZimlet._handleGetAllResponse,[h])};
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ZIMLET};
var s=ZaRequestMgr.invoke(r,o);
return s&&ZaZimlet._handleGetAllResponse(null,s)
};
ZaZimlet._handleGetAllResponse=function(u,o){
var r=new ZaItemList(ZaZimlet);
o=o instanceof ZmCsfeResult?o.getResponse():o;
r.loadFromJS(o.Body.GetAllZimletsResponse);
if(ZaZimlet.zimlets==null){
ZaZimlet.zimlets=new Object()
}
var h=new Object();
var t=r.getVector()._array;
for(var s in t){
var c=t[s];
h[c[ZaZimlet.A_name]]=c
}
var m;
m=new ZaItemList(ZaZimlet);
for(var d in h){
var e=ZaZimlet.zimlets[d];
var n=h[d];
if(!e){
ZaZimlet.zimlets[d]=n;
m.add(n)
}else{
if(n.attrs[ZaZimlet.A_zimbraCreateTimestamp]!=e.attrs[ZaZimlet.A_zimbraCreateTimestamp]){
ZaZimlet.zimlets[d]=n;
m.add(n)
}}}
if(u){
var l=u.args;
l=l?(l instanceof Array?l:[l]):[];
u=new AjxCallback(u.obj,u.func,l.concat(r));
if(m.size()==0){
u.run()
}else{
ZaZimlet._handleGetAllResources(m,u)
}}else{
if(m.size()>0){
ZaZimlet._handleGetAllResources(m)
}}
return r
};
ZaZimlet._handleGetAllResources=function(n,h){
var o=[];
for(var r in n.getIdHash()){
var e=n.getItemById(r);
o.push({
src:["/res/",e.name,".js?v=",appVers,ZaZimbraAdmin.LOCALE_QS].join(""),id:"res_"+e.name}
)
}
var s=appContextPath;
var t=null;
AjxInclude(o,s,h,t)
};
ZaZimlet.prototype.isEnabled=function(){
var e=this.attrs[ZaZimlet.A_zimbraZimletEnabled];
if(e!=null&&e=="TRUE"){
return true
}else{
return false
}};
ZaZimlet.__RE_MSG=/\$\{msg\.(.*?)\}/g;
ZaZimlet.prototype.getDescription=function(){
var t=null;
var e=null;
if(this.attrs&&this.attrs[ZaZimlet.A_zimbraZimletDescription]){
e=this[ZaZimlet.A_name];
t=this.attrs[ZaZimlet.A_zimbraZimletDescription];
t=(t||"").replace(ZaZimlet.__RE_MSG,function(n,o){
var s=window[e];
return(s&&s[o])||n
}
)
}
return t
};
ZaZimlet.prototype.getDisplayName=function(){
var t=this[ZaZimlet.A_name];
var o=window[t];
var e=(o&&(o.label||o.zimletLabel))||"";
return e
};
ZaZimlet.prototype.getLabel=function(){
var t=null;
var e=this[ZaZimlet.A_name];
if(this.label){
t=this.label;
t=(t||"").replace(ZaZimlet.__RE_MSG,function(s,n){
var r=window[e];
return(r&&r[n])||s
}
)
}
if(!t){
var o=window[e];
t=(o&&(o.label||o.zimletLabel))||e
}
return t
};
ZaZimlet.prototype.enable=function(e,h){
var n=AjxSoapDoc.create("ModifyZimletRequest",ZaZimbraAdmin.URN,null);
var r=n.set("zimlet","");
r.setAttribute("name",this.name);
var o=n.set("status","",r);
if(e){
o.setAttribute("value","enabled");
this.attrs[ZaZimlet.A_zimbraZimletEnabled]="TRUE"
}else{
o.setAttribute("value","disabled");
this.attrs[ZaZimlet.A_zimbraZimletEnabled]="FALSE"
}
var s=new Object();
s.soapDoc=n;
if(h){
s.asyncMode=true;
s.callback=h
}
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_ZIMLET};
ZaRequestMgr.invoke(s,t)
};
ZaZimlet.prototype.modify=function(e){};
ZaZimlet.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]="<table cellpadding='0' cellspacing='0' border='0'>";
t[e++]="<tr valign='center'><td colspan='2' align='left'>";
t[e++]="<div style='border-bottom: 1px solid black; white-space:nowrap; overflow:hidden;width:350'>";
t[e++]="<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
t[e++]="<tr valign='center'>";
t[e++]="<td><b>"+AjxStringUtil.htmlEncode(this.name)+"</b></td>";
t[e++]="<td align='right'>";
t[e++]=AjxImg.getImageHtml("ZaZimlet");
t[e++]="</td>";
t[e++]="</table></div></td></tr>";
t[e++]="<tr></tr>";
e=this._addAttrRow(ZaItem.A_description,t,e);
e=this._addAttrRow(ZaItem.A_zimbraId,t,e);
t[e++]="</table>";
this._toolTip=t.join("")
}
return this._toolTip
};
ZaZimlet.prototype.remove=function(){
var t=AjxSoapDoc.create("UndeployZimletRequest",ZaZimbraAdmin.URN,null);
t.getMethod().setAttribute("name",this.name);
var n=new Object();
n.soapDoc=t;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_UNDEPLOY_ZIMLET};
var o=ZaRequestMgr.invoke(n,e)
};
ZaZimlet.prototype.refresh=function(){
this.load()
};
ZaZimlet.deploy=function(h,l){
var s=h.action?h.action:ZaZimlet.ACTION_DEPLOY_ALL;
var e=h.attId?h.attId:null;
var r=h.flushCache?h.flushCache:"0";
var n=AjxSoapDoc.create("DeployZimletRequest",ZaZimbraAdmin.URN,null);
n.getMethod().setAttribute("action",s);
if(s!=ZaZimlet.ACTION_DEPLOY_STATUS){
n.getMethod().setAttribute("flush",r)
}
var o=n.set("content","");
if(e){
o.setAttribute("aid",e)
}
var h=new Object();
h.soapDoc=n;
if(l){
h.asyncMode=true;
h.callback=l
}
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_DEPLOY_ZIMLET};
ZaRequestMgr.invoke(h,t)
};
ZaZimlet.loadMethod=function(n,r){
var h=r?r:this.name;
var o=AjxSoapDoc.create("GetZimletRequest",ZaZimbraAdmin.URN,null);
var e=o.set("zimlet","");
e.setAttribute("name",h);
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
o.setMethodAttribute("attrs",this.attrsToGet.join(","))
}
var s={};
s.soapDoc=o;
s.asyncMode=false;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ZIMLET};
resp=ZaRequestMgr.invoke(s,t);
this.initFromJS(resp.Body.GetZimletResponse.zimlet[0])
};
ZaItem.loadMethods.ZaZimlet.push(ZaZimlet.loadMethod);
ZaZimlet.myXModel={
items:[{
id:ZaZimlet.A_name,ref:ZaZimlet.A_name,type:_STRING_}
,{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:ZaItem.A_zimbraCreateTimestamp,ref:"attrs/"+ZaItem.A_zimbraCreateTimestamp}
,{
id:ZaZimlet.A_flushCache,ref:ZaZimlet.A_flushCache,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES2}
,{
id:ZaZimlet.A_zimbraZimletDescription,ref:"attrs/"+ZaZimlet.A_zimbraZimletDescription,type:_STRING_}
,{
id:ZaZimlet.A_zimbraZimletEnabled,ref:"attrs/"+ZaZimlet.A_zimbraZimletEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
]}
}
if(AjxPackage.define("zimbraAdmin.rp.model.ZaRetentionPolicy")){
ZaRetentionPolicy=function(t,s,e,o){
this.id=s;
this.name=t;
if(!e){
this.lifetime="1d"
}else{
var n=e.substr(0,e.length-1);
if(n%ZaRetentionPolicy.YEAR==0){
this.lifetime=(n/ZaRetentionPolicy.YEAR)+"y"
}else{
if(n%ZaRetentionPolicy.MONTH==0){
this.lifetime=(n/ZaRetentionPolicy.MONTH)+"m"
}else{
if(n%ZaRetentionPolicy.WEEK==0){
this.lifetime=(n/ZaRetentionPolicy.WEEK)+"w"
}else{
this.lifetime=e
}}}}
this.type=o?o:ZaRetentionPolicy.TYPE_KEEP
};
ZaRetentionPolicy.prototype=new ZaItem;
ZaRetentionPolicy.prototype.constructor=ZaRetentionPolicy;
ZaRetentionPolicy.POLICY_CUSTOM="custom";
ZaRetentionPolicy.prototype.toString=function(){
return this.name
};
ZaRetentionPolicy.prototype.toDays=function(){
var t=this.lifetime.substr(0,this.lifetime.length-1);
var e=this.lifetime.substr(this.lifetime.length-1,1);
if(e=="y"){
return t*ZaRetentionPolicy.YEAR+"d"
}
if(e=="m"){
return t*ZaRetentionPolicy.MONTH+"d"
}
if(e=="w"){
return t*ZaRetentionPolicy.WEEK+"d"
}
return this.lifetime
};
ZaRetentionPolicy.YEAR=366;
ZaRetentionPolicy.MONTH=31;
ZaRetentionPolicy.WEEK=7;
ZaRetentionPolicy.TYPE_KEEP="keep";
ZaRetentionPolicy.TYPE_PURGE="purge";
ZaRetentionPolicy.A2_name="name";
ZaRetentionPolicy.A2_id="id";
ZaRetentionPolicy.A2_lifetime="lifetime";
ZaRetentionPolicy.A2_type="type";
ZaRetentionPolicy.myXModel={
items:[{
id:ZaRetentionPolicy.A2_id,type:_STRING_,ref:ZaRetentionPolicy.A2_id}
,{
id:ZaRetentionPolicy.A2_name,type:_STRING_,ref:ZaRetentionPolicy.A2_name,required:true}
,{
id:ZaRetentionPolicy.A2_lifetime,type:_MLIFETIME_,ref:ZaRetentionPolicy.A2_lifetime,minInclusive:1}
,{
id:ZaRetentionPolicy.A2_type,type:_STRING_,ref:ZaRetentionPolicy.A2_type}
]};
ZaRetentionPolicy.getRetentionPolicies=function(f,n){
var g=AjxSoapDoc.create("GetSystemRetentionPolicyRequest","urn:zimbraAdmin",null);
if(f&&n){
var o=g.set("cos",n);
o.setAttribute("by",f)
}
var h=new Object();
h.soapDoc=g;
try{
var s={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_RETENTION_POLICIES};
var y={};
y[ZaRetentionPolicy.TYPE_KEEP]=[];
y[ZaRetentionPolicy.TYPE_PURGE]=[];
var l=ZaRequestMgr.invoke(h,s).Body.GetSystemRetentionPolicyResponse;
if(l.retentionPolicy&&l.retentionPolicy.length==1){
var e=l.retentionPolicy[0];
var r=e.keep[0].policy;
var p=e.purge[0].policy;
if(r){
for(var u=0;
u<r.length;
u++){
if(r[u].id){
var d=new ZaRetentionPolicy(r[u].name,r[u].id,r[u].lifetime,ZaRetentionPolicy.TYPE_KEEP);
y[ZaRetentionPolicy.TYPE_KEEP].push(d)
}}}
if(p){
for(var c=0;
c<p.length;
c++){
if(p[c].id){
var t=new ZaRetentionPolicy(p[c].name,p[c].id,p[c].lifetime,ZaRetentionPolicy.TYPE_PURGE);
y[ZaRetentionPolicy.TYPE_PURGE].push(t)
}}}}
return y
}
catch(m){
throw m;
return null
}};
ZaRetentionPolicy.prototype.createPolicy=function(c,o){
var d=AjxSoapDoc.create("CreateSystemRetentionPolicyRequest","urn:zimbraAdmin",null);
if(c&&o){
var t=d.set("cos",o);
t.setAttribute("by",c)
}
if(this[ZaRetentionPolicy.A2_type]!==ZaRetentionPolicy.TYPE_KEEP&&this[ZaRetentionPolicy.A2_type]!==ZaRetentionPolicy.TYPE_PURGE){
return
}
var e=d.set(this[ZaRetentionPolicy.A2_type],null);
var l=d.set("policy",null,e,"urn:zimbraMail");
l.setAttribute("name",this[ZaRetentionPolicy.A2_name]);
l.setAttribute("lifetime",this.toDays());
var r=new Object();
r.soapDoc=d;
try{
var n={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_RETENTION_POLICIES};
var s=ZaRequestMgr.invoke(r,n).Body.CreateSystemRetentionPolicyResponse;
if(s.policy&&s.policy[0]){
this.id=s.policy[0].id
}
return this
}
catch(h){
throw h;
return null
}};
ZaRetentionPolicy.checkLifeTime=function(e){
if(!e||e.length<1){
return false
}
var t=e.substr(0,e.length-1);
if(!t){
return false
}
return AjxUtil.isPositiveInt(t)
};
ZaRetentionPolicy.checkValues=function(n,o){
if(!n){
return false
}
var e=AjxStringUtil.trim(n[ZaRetentionPolicy.A2_name]);
if(AjxUtil.isEmpty(e)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_EmptyRPName);
return false
}
if(ZaRetentionPolicy.POLICY_CUSTOM==e.toLowerCase()){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_RPNameCustomDisallowed,[e]));
return false
}
if(!ZaRetentionPolicy.checkLifeTime(n[ZaRetentionPolicy.A2_lifetime])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_InvalidRPLifetime);
return false
}
if(o&&AjxUtil.isArray(o)){
for(var t=0;
t<o.length;
t++){
if(o[t][ZaRetentionPolicy.A2_name]==n[ZaRetentionPolicy.A2_name]&&o[t]!=n){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_RPExists,[n[ZaRetentionPolicy.A2_name]]));
return false
}}}
return true
};
ZaRetentionPolicy.prototype.modifyPolicy=function(s,l){
var n=AjxSoapDoc.create("ModifySystemRetentionPolicyRequest","urn:zimbraAdmin",null);
if(s&&l){
var o=n.set("cos",l);
o.setAttribute("by",s)
}
var h=n.set("policy",null,null,"urn:zimbraMail");
h.setAttribute("name",this[ZaRetentionPolicy.A2_name]);
h.setAttribute("id",this[ZaRetentionPolicy.A2_id]);
h.setAttribute("lifetime",this.toDays());
h.setAttribute("type","system");
var r=new Object();
r.soapDoc=n;
r.skipAuthCheck=false;
try{
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_RETENTION_POLICIES};
ZaRequestMgr.invoke(r,t).Body.ModifySystemRetentionPolicyResponse
}
catch(e){
throw e;
return null
}};
ZaRetentionPolicy.prototype.deletePolicy=function(l,t){
var c=AjxSoapDoc.create("DeleteSystemRetentionPolicyRequest","urn:zimbraAdmin",null);
if(l&&t){
var e=c.set("cos",t);
e.setAttribute("by",l)
}
var h=c.set("policy",null,null,"urn:zimbraMail");
h.setAttribute("id",this.id);
var n=new Object();
n.soapDoc=c;
n.skipAuthCheck=false;
try{
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_DELETE_RETENTION_POLICIES};
var s=ZaRequestMgr.invoke(n,o).Body.DeleteSystemRetentionPolicyResponse
}
catch(r){
throw r;
return null
}}
}
if(AjxPackage.define("zimbraAdmin.globalconfig.model.ZaGlobalConfig")){
ZaGlobalConfig=function(){
ZaItem.call(this,"ZaGlobalConfig");
this.attrs=new Object();
this.type=ZaItem.GLOBAL_CONFIG;
this.load()
};
ZaGlobalConfig.prototype=new ZaItem;
ZaGlobalConfig.prototype.constructor=ZaGlobalConfig;
ZaItem.loadMethods.ZaGlobalConfig=new Array();
ZaItem.modifyMethods.ZaGlobalConfig=new Array();
ZaItem.modifyMethodsExt.ZaGlobalConfig=new Array();
ZaGlobalConfig.MTA_RESTRICTIONS=["reject_invalid_helo_hostname","reject_non_fqdn_helo_hostname","reject_non_fqdn_sender","reject_unknown_client_hostname","reject_unknown_reverse_client_hostname","reject_unknown_sender_domain","reject_unknown_helo_hostname"];
ZaGlobalConfig.A_zimbraLastLogonTimestampFrequency="zimbraLastLogonTimestampFrequency";
ZaGlobalConfig.A_zimbraDefaultDomainName="zimbraDefaultDomainName";
ZaGlobalConfig.A_zimbraScheduledTaskNumThreads="zimbraScheduledTaskNumThreads";
ZaGlobalConfig.A_zimbraMailPurgeSleepInterval="zimbraMailPurgeSleepInterval";
ZaGlobalConfig.A_zimbraAttachmentsBlocked="zimbraAttachmentsBlocked";
ZaGlobalConfig.A_zimbraMtaBlockedExtensionWarnRecipient="zimbraMtaBlockedExtensionWarnRecipient";
ZaGlobalConfig.A_zimbraMtaBlockedExtension="zimbraMtaBlockedExtension";
ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension="zimbraMtaCommonBlockedExtension";
ZaGlobalConfig.A_zimbraMtaSaslAuthEnable="zimbraMtaSaslAuthEnable";
ZaGlobalConfig.A_zimbraMtaTlsAuthOnly="zimbraMtaTlsAuthOnly";
ZaGlobalConfig.A_zimbraMtaSmtpDnsSupportLevel="zimbraMtaSmtpDnsSupportLevel";
ZaGlobalConfig.A_zimbraMtaMaxMessageSize="zimbraMtaMaxMessageSize";
ZaGlobalConfig.A_zimbraMtaRelayHost="zimbraMtaRelayHost";
ZaGlobalConfig.A_zimbraMtaFallbackRelayHost="zimbraMtaFallbackRelayHost";
ZaGlobalConfig.A_zimbraMtaMyNetworks="zimbraMtaMyNetworks";
ZaGlobalConfig.A_zimbraComponentAvailable="zimbraComponentAvailable";
ZaGlobalConfig.A_zimbraSmtpSendAddOriginatingIP="zimbraSmtpSendAddOriginatingIP";
ZaGlobalConfig.A_zimbraDNSCheckHostname="zimbraDNSCheckHostname";
ZaGlobalConfig.A_zimbraBasicAuthRealm="zimbraBasicAuthRealm";
ZaGlobalConfig.A_zimbraAdminConsoleDNSCheckEnabled="zimbraAdminConsoleDNSCheckEnabled";
ZaGlobalConfig.A_zimbraAdminConsoleCatchAllAddressEnabled="zimbraAdminConsoleCatchAllAddressEnabled";
ZaGlobalConfig.A_zimbraAdminConsoleSkinEnabled="zimbraAdminConsoleSkinEnabled";
ZaGlobalConfig.A_zimbraAdminConsoleLDAPAuthEnabled="zimbraAdminConsoleLDAPAuthEnabled";
ZaGlobalConfig.A_zimbraMilterBindPort="zimbraMilterBindPort";
ZaGlobalConfig.A_zimbraMilterServerEnabled="zimbraMilterServerEnabled";
ZaGlobalConfig.A_zimbraMtaRestriction="zimbraMtaRestriction";
ZaGlobalConfig.A_zimbraMtaPolicyService="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_policy_service";
ZaGlobalConfig.A_zimbraMtaRejectInvalidHeloHostname="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_invalid_helo_hostname";
ZaGlobalConfig.A_zimbraMtaRejectNonFqdnHeloHostname="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_non_fqdn_helo_hostname";
ZaGlobalConfig.A_zimbraMtaRejectNonFqdnSender="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_non_fqdn_sender";
ZaGlobalConfig.A_zimbraMtaRejectUnknownClientHostname="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_unknown_client_hostname";
ZaGlobalConfig.A_zimbraMtaRejectUnknownReverseClientHostname="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_unknown_reverse_client_hostname";
ZaGlobalConfig.A_zimbraMtaRejectUnknownSenderDomain="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_unknown_sender_domain";
ZaGlobalConfig.A_zimbraMtaRejectUnknownHeloHostname="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_unknown_helo_hostname";
ZaGlobalConfig.A_zimbraMtaRejectRblClient="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_rbl_client";
ZaGlobalConfig.A_zimbraMtaRejectRHSblClient="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_rhsbl_client";
ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_rhsbl_reverse_client";
ZaGlobalConfig.A_zimbraMtaRejectRHSblSender="_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_reject_rhsbl_sender";
ZaGlobalConfig.A_zimbraGalLdapFilterDef="zimbraGalLdapFilterDef";
ZaGlobalConfig.A_zimbraGalMaxResults="zimbraGalMaxResults";
ZaGlobalConfig.A_zimbraNotebookAccount="zimbraNotebookAccount";
ZaGlobalConfig.A_zimbraLmtpNumThreads="zimbraLmtpNumThreads";
ZaGlobalConfig.A_zimbraLmtpBindPort="zimbraLmtpBindPort";
ZaGlobalConfig.A_zimbraPop3NumThreads="zimbraPop3NumThreads";
ZaGlobalConfig.A_zimbraPop3BindPort="zimbraPop3BindPort";
ZaGlobalConfig.A_zimbraRedologEnabled="zimbraRedologEnabled";
ZaGlobalConfig.A_zimbraRedologLogPath="zimbraRedologLogPath";
ZaGlobalConfig.A_zimbraRedologArchiveDir="zimbraRedologArchiveDir";
ZaGlobalConfig.A_zimbraRedologBacklogDir="zimbraRedologBacklogDir";
ZaGlobalConfig.A_zimbraRedologRolloverFileSizeKB="zimbraRedologRolloverFileSizeKB";
ZaGlobalConfig.A_zimbraRedologFsyncIntervalMS="zimbraRedologFsyncIntervalMS";
ZaGlobalConfig.A_zimbraFileUploadMaxSize="zimbraFileUploadMaxSize";
ZaGlobalConfig.A_zimbraSmtpHostname="zimbraSmtpHostname";
ZaGlobalConfig.A_zimbraSmtpPort="zimbraSmtpPort";
ZaGlobalConfig.A_zimbraSmtpTimeout="zimbraSmtpTimeout";
ZaGlobalConfig.A_zimbraPop3BindPort="zimbraPop3BindPort";
ZaGlobalConfig.A_zimbraPop3ServerEnabled="zimbraPop3ServerEnabled";
ZaGlobalConfig.A_zimbraPop3SSLBindPort="zimbraPop3SSLBindPort";
ZaGlobalConfig.A_zimbraPop3SSLServerEnabled="zimbraPop3SSLServerEnabled";
ZaGlobalConfig.A_zimbraPop3CleartextLoginEnabled="zimbraPop3CleartextLoginEnabled";
ZaGlobalConfig.A_zimbraImapBindPort="zimbraImapBindPort";
ZaGlobalConfig.A_zimbraImapServerEnabled="zimbraImapServerEnabled";
ZaGlobalConfig.A_zimbraImapNumThreads="zimbraImapNumThreads";
ZaGlobalConfig.A_zimbraImapSSLBindPort="zimbraImapSSLBindPort";
ZaGlobalConfig.A_zimbraImapSSLServerEnabled="zimbraImapSSLServerEnabled";
ZaGlobalConfig.A_zimbraImapCleartextLoginEnabled="zimbraImapCleartextLoginEnabled";
ZaGlobalConfig.A_zimbraSpamKillPercent="zimbraSpamKillPercent";
ZaGlobalConfig.A_zimbraSpamTagPercent="zimbraSpamTagPercent";
ZaGlobalConfig.A_zimbraSpamSubjectTag="zimbraSpamSubjectTag";
ZaGlobalConfig.A_zimbraSpamAccount="zimbraSpamIsSpamAccount";
ZaGlobalConfig.A_zimbraHamAccount="zimbraSpamIsNotSpamAccount";
ZaGlobalConfig.A_zimbraWikiAccount="zimbraNotebookAccount";
ZaGlobalConfig.A_zimbraAmavisQAccount="zimbraAmavisQuarantineAccount";
ZaGlobalConfig.A_zimbraVirusWarnRecipient="zimbraVirusWarnRecipient";
ZaGlobalConfig.A_zimbraVirusWarnAdmin="zimbraVirusWarnAdmin";
ZaGlobalConfig.A_zimbraVirusDefinitionsUpdateFrequency="zimbraVirusDefinitionsUpdateFrequency";
ZaGlobalConfig.A_zimbraVirusBlockEncryptedArchive="zimbraVirusBlockEncryptedArchive";
ZaGlobalConfig.A_zimbraAccountClientAttr="zimbraAccountClientAttr";
ZaGlobalConfig.A_zimbraServerInheritedAttr="zimbraServerInheritedAttr";
ZaGlobalConfig.A_zimbraDomainInheritedAttr="zimbraDomainInheritedAttr";
ZaGlobalConfig.A_zimbraCOSInheritedAttr="zimbraCOSInheritedAttr";
ZaGlobalConfig.A_zimbraGalLdapAttrMap="zimbraGalLdapAttrMap";
ZaGlobalConfig.A_zimbraGalLdapFilterDef="zimbraGalLdapFilterDef";
ZaGlobalConfig.A_zimbraMailMode="zimbraMailMode";
ZaGlobalConfig.A_zimbraImapProxyBindPort="zimbraImapProxyBindPort";
ZaGlobalConfig.A_zimbraImapSSLProxyBindPort="zimbraImapSSLProxyBindPort";
ZaGlobalConfig.A_zimbraPop3ProxyBindPort="zimbraPop3ProxyBindPort";
ZaGlobalConfig.A_zimbraPop3SSLProxyBindPort="zimbraPop3SSLProxyBindPort";
ZaGlobalConfig.A_zimbraReverseProxyLookupTarget="zimbraReverseProxyLookupTarget";
ZaGlobalConfig.A_zimbraMailAddressValidationRegex="zimbraMailAddressValidationRegex";
ZaGlobalConfig.A_zimbraInstalledSkin="zimbraInstalledSkin";
ZaGlobalConfig.A_zimbraNewExtension="_zimbraNewExtension";
ZaGlobalConfig.A_originalMonitorHost="_originalMonitorHost";
ZaGlobalConfig.A_currentMonitorHost="_currentMonitorHost";
ZaGlobalConfig.A_zimbraFreebusyExchangeAuthUsername="zimbraFreebusyExchangeAuthUsername";
ZaGlobalConfig.A_zimbraFreebusyExchangeAuthPassword="zimbraFreebusyExchangeAuthPassword";
ZaGlobalConfig.A_zimbraFreebusyExchangeAuthScheme="zimbraFreebusyExchangeAuthScheme";
ZaGlobalConfig.A_zimbraFreebusyExchangeServerType="zimbraFreebusyExchangeServerType";
ZaGlobalConfig.A_zimbraFreebusyExchangeURL="zimbraFreebusyExchangeURL";
ZaGlobalConfig.A_zimbraFreebusyExchangeUserOrg="zimbraFreebusyExchangeUserOrg";
ZaGlobalConfig.A_zimbraSpnegoAuthEnabled="zimbraSpnegoAuthEnabled";
ZaGlobalConfig.A_zimbraSpnegoAuthRealm="zimbraSpnegoAuthRealm";
ZaGlobalConfig.A_zimbraSpnegoAuthErrorURL="zimbraSpnegoAuthErrorURL";
ZaGlobalConfig.A_zimbraWebClientLoginURL="zimbraWebClientLoginURL";
ZaGlobalConfig.A_zimbraWebClientLogoutURL="zimbraWebClientLogoutURL";
ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA="zimbraWebClientLoginURLAllowedUA";
ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA="zimbraWebClientLogoutURLAllowedUA";
ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP="zimbraWebClientLoginURLAllowedIP";
ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP="zimbraWebClientLogoutURLAllowedIP";
ZaGlobalConfig.A_zimbraForceClearCookies="zimbraForceClearCookies";
ZaGlobalConfig.A_zimbraAutoProvBatchSize="zimbraAutoProvBatchSize";
ZaGlobalConfig.A_zimbraAutoProvPollingInterval="zimbraAutoProvPollingInterval";
ZaGlobalConfig.A_zimbraMailSSLClientCertMode="zimbraMailSSLClientCertMode";
ZaGlobalConfig.A_zimbraMailSSLClientCertPort="zimbraMailSSLClientCertPort";
ZaGlobalConfig.A_zimbraMailSSLClientCertPrincipalMap="zimbraMailSSLClientCertPrincipalMap";
ZaGlobalConfig.A_zimbraReverseProxyClientCertMode="zimbraReverseProxyClientCertMode";
ZaGlobalConfig.A_zimbraMailSSLProxyClientCertPort="zimbraMailSSLProxyClientCertPort";
ZaGlobalConfig.A_zimbraReverseProxyMailMode="zimbraReverseProxyMailMode";
ZaGlobalConfig.A_zimbraReverseProxyAdminIPAddress="zimbraReverseProxyAdminIPAddress";
ZaGlobalConfig.A_zimbraReverseProxyClientCertCA="zimbraReverseProxyClientCertCA";
ZaGlobalConfig.A_zimbraAutoProvNotificationSubject="zimbraAutoProvNotificationSubject";
ZaGlobalConfig.A_zimbraAutoProvNotificationBody="zimbraAutoProvNotificationBody";
ZaGlobalConfig.A_zimbraSkinForegroundColor="zimbraSkinForegroundColor";
ZaGlobalConfig.A_zimbraSkinBackgroundColor="zimbraSkinBackgroundColor";
ZaGlobalConfig.A_zimbraSkinSecondaryColor="zimbraSkinSecondaryColor";
ZaGlobalConfig.A_zimbraSkinSelectionColor="zimbraSkinSelectionColor";
ZaGlobalConfig.A_zimbraSkinLogoURL="zimbraSkinLogoURL";
ZaGlobalConfig.A_zimbraSkinLogoLoginBanner="zimbraSkinLogoLoginBanner";
ZaGlobalConfig.A_zimbraSkinLogoAppBanner="zimbraSkinLogoAppBanner";
ZaGlobalConfig.A2_blocked_extension_selection="blocked_extension_selection";
ZaGlobalConfig.A2_common_extension_selection="common_extension_selection";
ZaGlobalConfig.A2_retentionPoliciesKeep="retentionPolicyKeep";
ZaGlobalConfig.A2_retentionPoliciesPurge="retentionPolicyPurge";
ZaGlobalConfig.A2_retentionPoliciesKeep_Selection="retentionPoliciesKeep_Selection";
ZaGlobalConfig.A2_retentionPoliciesPurge_Selection="retentionPoliciesPurge_Selection";
ZaGlobalConfig.A_zimbraHelpAdminURL="zimbraHelpAdminURL";
ZaGlobalConfig.A_zimbraHelpDelegatedURL="zimbraHelpDelegatedURL";
ZaGlobalConfig.__configInstance=null;
ZaGlobalConfig.isDirty=true;
ZaGlobalConfig.CHECK_EXCHANGE_AUTH_CONFIG_RIGHT="checkExchangeAuthConfig";
ZaGlobalConfig.getInstance=function(e){
if(e||ZaGlobalConfig.isDirty||!ZaGlobalConfig.__configInstance){
ZaGlobalConfig.__configInstance=new ZaGlobalConfig();
ZaGlobalConfig.isDirty=false
}
return ZaGlobalConfig.__configInstance
};
ZaGlobalConfig.loadMethod=function(o,r){
var t=AjxSoapDoc.create("GetAllConfigRequest",ZaZimbraAdmin.URN,null);
if(!this.getAttrs.all&&!AjxUtil.isEmpty(this.attrsToGet)){
t.setMethodAttribute("attrs",this.attrsToGet.join(","))
}
var s=new Object();
s.soapDoc=t;
s.noAuthToken=true;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_CONFIG};
var n=ZaRequestMgr.invoke(s,e).Body.GetAllConfigResponse;
this.initFromJS(n)
};
ZaItem.loadMethods.ZaGlobalConfig.push(ZaGlobalConfig.loadMethod);
ZaGlobalConfig.prototype.initFromJS=function(r){
ZaItem.prototype.initFromJS.call(this,r);
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension])){
this.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension]=[this.attrs[ZaGlobalConfig.A_zimbraMtaBlockedExtension]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension])){
this.attrs[ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension]=[this.attrs[ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraSmtpHostname])){
this.attrs[ZaGlobalConfig.A_zimbraSmtpHostname]=[this.attrs[ZaGlobalConfig.A_zimbraSmtpHostname]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraMailAddressValidationRegex])){
this.attrs[ZaGlobalConfig.A_zimbraMailAddressValidationRegex]=[this.attrs[ZaGlobalConfig.A_zimbraMailAddressValidationRegex]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraReverseProxyAdminIPAddress])){
this.attrs[ZaGlobalConfig.A_zimbraReverseProxyAdminIPAddress]=[this.attrs[ZaGlobalConfig.A_zimbraReverseProxyAdminIPAddress]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA])){
this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA])){
this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP])){
this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP]]
}
if(AjxUtil.isString(this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP])){
this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP]=[this.attrs[ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP]]
}
var s=this.attrs[ZaGlobalConfig.A_zimbraComponentAvailable];
if(s){
if(AjxUtil.isString(s)){
s=[s]
}
for(var o=0;
o<s.length;
o++){
var t=s[o];
this.attrs["_"+ZaGlobalConfig.A_zimbraComponentAvailable+"_"+t]=true
}}
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRblClient]=[];
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblClient]=[];
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient]=[];
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblSender]=[];
this.attrs[ZaGlobalConfig.A_zimbraMtaPolicyService]=[];
var n=this.attrs[ZaGlobalConfig.A_zimbraMtaRestriction];
if(n){
if(AjxUtil.isString(n)){
n=[n]
}
for(var o=0;
o<n.length;
o++){
if(n[o].indexOf("reject_rbl_client")>-1){
var e=n[o];
var h=e.split(" ");
if(h&&h.length>0){
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRblClient].push(h[1])
}}else{
if(n[o].indexOf("reject_rhsbl_client")>-1){
var e=n[o];
var h=e.split(" ");
if(h&&h.length>0){
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblClient].push(h[1])
}}else{
if(n[o].indexOf("reject_rhsbl_reverse_client")>-1){
var e=n[o];
var h=e.split(" ");
if(h&&h.length>0){
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient].push(h[1])
}}else{
if(n[o].indexOf("reject_rhsbl_sender")>-1){
var e=n[o];
var h=e.split(" ");
if(h&&h.length>0){
this.attrs[ZaGlobalConfig.A_zimbraMtaRejectRHSblSender].push(h[1])
}}else{
if(n[o].indexOf("check_policy_service")>-1){
var e=n[o];
var h=e.split(" ");
if(h&&h.length>0){
this.attrs[ZaGlobalConfig.A_zimbraMtaPolicyService].push(h[1])
}}else{
var e=n[o];
this.attrs["_"+ZaGlobalConfig.A_zimbraMtaRestriction+"_"+e]=true
}}}}}}}
if(this.attrs[ZaGlobalConfig.A_zimbraInstalledSkin]!=null&&!(this.attrs[ZaGlobalConfig.A_zimbraInstalledSkin] instanceof Array)){
this.attrs[ZaGlobalConfig.A_zimbraInstalledSkin]=[this.attrs[ZaGlobalConfig.A_zimbraInstalledSkin]]
}
if(this.attrs[ZaDomain.A_zimbraFreebusyExchangeAuthPassword]&&(this.attrs[ZaDomain.A_zimbraFreebusyExchangeAuthPassword]=="VALUE-BLOCKED")){
this.attrs[ZaDomain.A_zimbraFreebusyExchangeAuthPassword]=""
}};
ZaGlobalConfig.modifyMethod=function(m,h){
var u=AjxSoapDoc.create("BatchRequest","urn:zimbra");
u.setMethodAttribute("onerror","stop");
var f=m;
if(ZaItem.modifyMethodsExt.ZaGlobalConfig){
var n=ZaItem.modifyMethodsExt.ZaGlobalConfig;
var t=n.length;
for(var l=0;
l<t;
l++){
if(typeof(n[l])=="function"){
n[l].call(this,f,h,u)
}}}
var e=u.set("ModifyConfigRequest",null,null,ZaZimbraAdmin.URN);
for(var d in f){
if(f[d] instanceof Array){
var t=f[d].length;
if(t>0){
for(var o=0;
o<t;
o++){
if(f[d][o] instanceof String){
var c=u.set("a",f[d][o].toString(),e)
}else{
if(f[d][o] instanceof Object){
var c=u.set("a",f[d][o].toString(),e)
}else{
var c=u.set("a",f[d][o],e)
}}
c.setAttribute("n",d)
}}else{
var c=u.set("a","",e);
c.setAttribute("n",d)
}}else{
if((typeof ZaLicense=="function")&&(ZaSettings.LICENSE_ENABLED)){
if(ZaUtil.findValueInObjArrByPropertyName(ZaLicense.myXModel.items,d,"id")>-1){
continue
}}
var c=u.set("a",f[d],e);
c.setAttribute("n",d)
}}
var r=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=u;
s.noAuthToken=true;
r.invoke(s);
ZaGlobalConfig.isDirty=true
};
ZaItem.modifyMethods.ZaGlobalConfig.push(ZaGlobalConfig.modifyMethod);
LifetimeNumber_XFormItem=function(){};
XModelItemFactory.createItemType("_LIFETIME_NUMBER_","lifetime_number",LifetimeNumber_XFormItem,Number_XModelItem);
LifetimeNumber_XFormItem.prototype.validateType=function(t){
var e=t.substring(0,t.length-1);
this.validateNumber(e);
return t
};
ZaGlobalConfig.myXModel={
items:[{
id:ZaGlobalConfig.A_zimbraGalMaxResults,ref:"attrs/"+ZaGlobalConfig.A_zimbraGalMaxResults,type:_NUMBER_,minInclusive:0,maxInclusive:2147483647,defaultValue:100}
,{
id:ZaGlobalConfig.A_zimbraDefaultDomainName,ref:"attrs/"+ZaGlobalConfig.A_zimbraDefaultDomainName,type:_STRING_,maxLength:256}
,{
id:ZaGlobalConfig.A_zimbraScheduledTaskNumThreads,ref:"attrs/"+ZaGlobalConfig.A_zimbraScheduledTaskNumThreads,type:_NUMBER_,minInclusive:1}
,{
id:ZaGlobalConfig.A_zimbraMailPurgeSleepInterval,type:_MINTERVAL_,ref:"attrs/"+ZaGlobalConfig.A_zimbraMailPurgeSleepInterval}
,{
id:ZaGlobalConfig.A_currentMonitorHost,ref:"attrs/"+ZaGlobalConfig.A_currentMonitorHost,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraAttachmentsBlocked,ref:"attrs/"+ZaGlobalConfig.A_zimbraAttachmentsBlocked,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraMtaBlockedExtensionWarnRecipient,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaBlockedExtensionWarnRecipient,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraMtaBlockedExtension,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaBlockedExtension,type:_LIST_,dataType:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension,type:_LIST_,dataType:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,type:_ENUM_,choices:["yes","no"]}
,{
id:ZaGlobalConfig.A_zimbraMtaTlsAuthOnly,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaTlsAuthOnly,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraMailAddressValidationRegex,ref:"attrs/"+ZaGlobalConfig.A_zimbraMailAddressValidationRegex,type:_LIST_,listItem:{
type:_STRING_,maxLength:512}}
,{
id:ZaGlobalConfig.A_zimbraSmtpHostname,ref:"attrs/"+ZaGlobalConfig.A_zimbraSmtpHostname,type:_LIST_,listItem:{
type:_HOSTNAME_OR_IP_,maxLength:256}}
,{
id:ZaGlobalConfig.A_zimbraSmtpPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraSmtpPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraMtaMaxMessageSize,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaMaxMessageSize,type:_FILE_SIZE_,units:AjxUtil.SIZE_KILOBYTES,required:true}
,{
id:ZaGlobalConfig.A_zimbraFileUploadMaxSize,ref:"attrs/"+ZaGlobalConfig.A_zimbraFileUploadMaxSize,type:_FILE_SIZE_,units:AjxUtil.SIZE_KILOBYTES}
,{
id:ZaGlobalConfig.A_zimbraMtaMyNetworks,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaMyNetworks,type:_STRING_,maxLength:10240}
,{
id:ZaGlobalConfig.A_zimbraMtaRelayHost,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRelayHost,type:_HOSTNAME_OR_IP_,maxLength:256}
,{
id:ZaGlobalConfig.A_zimbraMtaFallbackRelayHost,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaFallbackRelayHost,type:_HOSTNAME_OR_IP_,maxLength:256}
,{
id:ZaGlobalConfig.A_zimbraSmtpSendAddOriginatingIP,ref:"attrs/"+ZaGlobalConfig.A_zimbraSmtpSendAddOriginatingIP,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraMtaSmtpDnsSupportLevel,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaSmtpDnsSupportLevel,type:_ENUM_,choices:ZaSettings.smtpDnsSupportLevel}
,{
id:ZaGlobalConfig.A_zimbraMilterServerEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraMilterServerEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraMilterBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraMilterBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectInvalidHeloHostname,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectInvalidHeloHostname,type:_ENUM_,choices:[false,true]}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectNonFqdnHeloHostname,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectNonFqdnHeloHostname,type:_ENUM_,choices:[false,true]}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectNonFqdnSender,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectNonFqdnSender,type:_ENUM_,choices:[false,true]}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectUnknownClientHostname,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectUnknownClientHostname,type:_ENUM_,choices:[false,true]}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectUnknownReverseClientHostname,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectUnknownReverseClientHostname,type:_ENUM_,choices:[false,true]}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectUnknownSenderDomain,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectUnknownSenderDomain,type:_ENUM_,choices:[false,true]}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectUnknownHeloHostname,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectUnknownHeloHostname,type:_ENUM_,choices:[false,true]}
,{
id:ZaGlobalConfig.A_zimbraDNSCheckHostname,type:_STRING_,ref:"attrs/"+ZaGlobalConfig.A_zimbraDNSCheckHostname,maxLength:255}
,{
id:ZaGlobalConfig.A_zimbraBasicAuthRealm,type:_STRING_,ref:"attrs/"+ZaGlobalConfig.A_zimbraBasicAuthRealm,maxLength:255}
,{
id:ZaGlobalConfig.A_zimbraAdminConsoleDNSCheckEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaGlobalConfig.A_zimbraAdminConsoleDNSCheckEnabled}
,{
id:ZaGlobalConfig.A_zimbraAdminConsoleCatchAllAddressEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaGlobalConfig.A_zimbraAdminConsoleCatchAllAddressEnabled}
,{
id:ZaGlobalConfig.A_zimbraAdminConsoleSkinEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaGlobalConfig.A_zimbraAdminConsoleSkinEnabled}
,{
id:ZaGlobalConfig.A_zimbraAdminConsoleLDAPAuthEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:"attrs/"+ZaGlobalConfig.A_zimbraAdminConsoleLDAPAuthEnabled}
,{
id:ZaGlobalConfig.A_zimbraMtaPolicyService,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaPolicyService,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectRblClient,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectRblClient,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectRHSblClient,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectRHSblClient,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraMtaRejectRHSblSender,ref:"attrs/"+ZaGlobalConfig.A_zimbraMtaRejectRHSblSender,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraSmtpTimeout,ref:"attrs/"+ZaGlobalConfig.A_zimbraSmtpTimeout,type:_NUMBER_,minInclusive:0}
,{
id:ZaGlobalConfig.A_zimbraPop3ServerEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3ServerEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraPop3SSLServerEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3SSLServerEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraPop3CleartextLoginEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3CleartextLoginEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraPop3BindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3BindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraPop3SSLBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3SSLBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraImapServerEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapServerEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraImapSSLServerEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapSSLServerEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraImapCleartextLoginEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapCleartextLoginEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraImapNumThreads,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapNumThreads,type:_INT_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaGlobalConfig.A_zimbraImapBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraImapSSLBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapSSLBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraSpamCheckEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraSpamCheckEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraSpamKillPercent,ref:"attrs/"+ZaGlobalConfig.A_zimbraSpamKillPercent,type:_PERCENT_,fractionDigits:0}
,{
id:ZaGlobalConfig.A_zimbraSpamTagPercent,ref:"attrs/"+ZaGlobalConfig.A_zimbraSpamTagPercent,type:_PERCENT_,fractionDigits:0}
,{
id:ZaGlobalConfig.A_zimbraSpamSubjectTag,ref:"attrs/"+ZaGlobalConfig.A_zimbraSpamSubjectTag,type:_STRING_,whiteSpace:"collapse",maxLength:32}
,{
id:ZaGlobalConfig.A_zimbraVirusCheckEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraVirusCheckEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraVirusDefinitionsUpdateFrequency,ref:"attrs/"+ZaGlobalConfig.A_zimbraVirusDefinitionsUpdateFrequency,type:_STRING_,whiteSpace:"collapse"}
,{
id:ZaGlobalConfig.A_zimbraVirusBlockEncryptedArchive,ref:"attrs/"+ZaGlobalConfig.A_zimbraVirusBlockEncryptedArchive,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraVirusWarnAdmin,ref:"attrs/"+ZaGlobalConfig.A_zimbraVirusWarnAdmin,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraVirusWarnRecipient,ref:"attrs/"+ZaGlobalConfig.A_zimbraVirusWarnRecipient,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraImapProxyBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapProxyBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraImapSSLProxyBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraImapSSLProxyBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraPop3ProxyBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3ProxyBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraPop3SSLProxyBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3SSLProxyBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraLmtpBindPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraLmtpBindPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraPop3NumThreads,ref:"attrs/"+ZaGlobalConfig.A_zimbraPop3NumThreads,type:_INT_,minInclusive:0,maxInclusive:2147483647}
,{
id:ZaGlobalConfig.A_zimbraInstalledSkin,ref:"attrs/"+ZaGlobalConfig.A_zimbraInstalledSkin,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraSpnegoAuthEnabled,ref:"attrs/"+ZaGlobalConfig.A_zimbraSpnegoAuthEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraSpnegoAuthRealm,ref:"attrs/"+ZaGlobalConfig.A_zimbraSpnegoAuthRealm,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSpnegoAuthErrorURL,ref:"attrs/"+ZaGlobalConfig.A_zimbraSpnegoAuthErrorURL,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraWebClientLoginURL,ref:"attrs/"+ZaGlobalConfig.A_zimbraWebClientLoginURL,type:_STRING_,maxLength:255}
,{
id:ZaGlobalConfig.A_zimbraWebClientLogoutURL,ref:"attrs/"+ZaGlobalConfig.A_zimbraWebClientLogoutURL,type:_STRING_,maxLength:255}
,{
id:ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA,ref:"attrs/"+ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA,ref:"attrs/"+ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP,ref:"attrs/"+ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP,ref:"attrs/"+ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraForceClearCookies,ref:"attrs/"+ZaGlobalConfig.A_zimbraForceClearCookies,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaGlobalConfig.A_zimbraMailSSLClientCertMode,ref:"attrs/"+ZaGlobalConfig.A_zimbraMailSSLClientCertMode,type:_STRING_,choices:["Disabled","NeedClientAuth","WantClientAuth"]}
,{
id:ZaGlobalConfig.A_zimbraMailSSLClientCertPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraMailSSLClientCertPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraMailSSLProxyClientCertPort,ref:"attrs/"+ZaGlobalConfig.A_zimbraMailSSLProxyClientCertPort,type:_PORT_}
,{
id:ZaGlobalConfig.A_zimbraReverseProxyMailMode,ref:"attrs/"+ZaGlobalConfig.A_zimbraReverseProxyMailMode,type:_STRING_,choices:["http","https","both","mixed","redirect"]}
,{
id:ZaGlobalConfig.A_zimbraReverseProxyClientCertMode,ref:"attrs/"+ZaGlobalConfig.A_zimbraReverseProxyClientCertMode,type:_STRING_,choices:["on","off","optional"]}
,{
id:ZaGlobalConfig.A_zimbraMailSSLClientCertPrincipalMap,ref:"attrs/"+ZaGlobalConfig.A_zimbraMailSSLClientCertPrincipalMap,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraReverseProxyAdminIPAddress,ref:"attrs/"+ZaGlobalConfig.A_zimbraReverseProxyAdminIPAddress,type:_LIST_,listItem:{
type:_STRING_}}
,{
id:ZaGlobalConfig.A_zimbraReverseProxyClientCertCA,ref:"attrs/"+ZaGlobalConfig.A_zimbraReverseProxyClientCertCA,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSkinForegroundColor,ref:"attrs/"+ZaGlobalConfig.A_zimbraSkinForegroundColor,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSkinBackgroundColor,ref:"attrs/"+ZaGlobalConfig.A_zimbraSkinBackgroundColor,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSkinSecondaryColor,ref:"attrs/"+ZaGlobalConfig.A_zimbraSkinSecondaryColor,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSkinSelectionColor,ref:"attrs/"+ZaGlobalConfig.A_zimbraSkinSelectionColor,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSkinLogoURL,ref:"attrs/"+ZaGlobalConfig.A_zimbraSkinLogoURL,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSkinLogoLoginBanner,ref:"attrs/"+ZaGlobalConfig.A_zimbraSkinLogoLoginBanner,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraSkinLogoAppBanner,ref:"attrs/"+ZaGlobalConfig.A_zimbraSkinLogoAppBanner,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraAutoProvBatchSize,type:_NUMBER_,ref:"attrs/"+ZaGlobalConfig.A_zimbraAutoProvBatchSize,maxInclusive:2147483647,minInclusive:0}
,{
id:ZaGlobalConfig.A_zimbraAutoProvPollingInterval,ref:"attrs/"+ZaGlobalConfig.A_zimbraAutoProvPollingInterval,type:_LIFETIME_NUMBER_,minInclusive:0,fractionDigits:0}
,{
id:ZaGlobalConfig.A_zimbraAutoProvNotificationSubject,ref:"attrs/"+ZaGlobalConfig.A_zimbraAutoProvNotificationSubject,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraAutoProvNotificationBody,ref:"attrs/"+ZaGlobalConfig.A_zimbraAutoProvNotificationBody,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraHelpAdminURL,ref:"attrs/"+ZaGlobalConfig.A_zimbraHelpAdminURL,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraHelpDelegatedURL,ref:"attrs/"+ZaGlobalConfig.A_zimbraHelpDelegatedURL,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraFreebusyExchangeAuthUsername,ref:"attrs/"+ZaGlobalConfig.A_zimbraFreebusyExchangeAuthUsername,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraFreebusyExchangeAuthPassword,ref:"attrs/"+ZaGlobalConfig.A_zimbraFreebusyExchangeAuthPassword,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraFreebusyExchangeAuthScheme,ref:"attrs/"+ZaGlobalConfig.A_zimbraFreebusyExchangeAuthScheme,type:_ENUM_,choices:ZaSettings.authorizationScheme}
,{
id:ZaGlobalConfig.A_zimbraFreebusyExchangeServerType,ref:"attrs/"+ZaGlobalConfig.A_zimbraFreebusyExchangeServerType,type:_ENUM_,choices:ZaSettings.exchangeServerType}
,{
id:ZaGlobalConfig.A_zimbraFreebusyExchangeURL,ref:"attrs/"+ZaGlobalConfig.A_zimbraFreebusyExchangeURL,type:_STRING_}
,{
id:ZaGlobalConfig.A_zimbraFreebusyExchangeUserOrg,ref:"attrs/"+ZaGlobalConfig.A_zimbraFreebusyExchangeUserOrg,type:_STRING_}
,{
id:ZaGlobalConfig.A2_blocked_extension_selection,type:_LIST_}
,{
id:ZaGlobalConfig.A2_common_extension_selection,type:_LIST_}
,{
id:ZaGlobalConfig.A2_retentionPoliciesKeep,type:_LIST_}
,{
id:ZaGlobalConfig.A2_retentionPoliciesPurge,type:_LIST_}
,{
id:ZaGlobalConfig.A2_retentionPoliciesKeep_Selection,type:_LIST_}
,{
id:ZaGlobalConfig.A2_retentionPoliciesPurge_Selection,type:_LIST_}
]}
}
if(AjxPackage.define("zimbraAdmin.status.model.ZaStatus")){
ZaStatus=function(){
ZaItem.call(this,"ZaStatus");
this._init()
};
ZaStatus.prototype=new ZaItem;
ZaStatus.prototype.constructor=ZaStatus;
ZaItem.loadMethods.ZaStatus=new Array();
ZaItem.initMethods.ZaStatus=new Array();
ZaStatus.A_server="server";
ZaStatus.A_service="service";
ZaStatus.A_timestamp="t";
ZaStatus.PRFX_Server="status_server";
ZaStatus.PRFX_Service="status_service";
ZaStatus.PRFX_Time="status_time";
ZaStatus.PRFX_Status="status_status";
ZaStatus.SVC_SPELL="spell";
ZaStatus.SVC_LOGGER="logger";
ZaStatus.SVC_MTA="mta";
ZaStatus.SVC_LDAP="ldap";
ZaStatus.SVC_MEMCACHED="memcached";
ZaStatus.SVC_MAILBOX="mailbox";
ZaStatus.SVC_CONVERTD="convertd";
ZaStatus.SVC_IMAPPROXY="proxy";
ZaStatus.SVC_STATS="stats";
ZaStatus.SVC_SNMP="snmp";
ZaStatus.SVC_AS="antispam";
ZaStatus.SVC_AV="antivirus";
ZaStatus.prototype.load=function(e,t){
ZaItem.prototype.load.call(this,e,t,true,false)
};
ZaStatus.loadMethod=function(){
try{
var t=ZaApp.getInstance().getGlobalConfig().attrs[ZaServer.A_zimbraLogHostname];
if(t){
var o=AjxSoapDoc.create("GetServiceStatusRequest",ZaZimbraAdmin.URN,null);
var r=new ZmCsfeCommand();
var s=new Object();
s.noAuthToken=true;
s.soapDoc=o;
var n=r.invoke(s).Body.GetServiceStatusResponse;
this.initFromJS(n)
}}
catch(e){
ZaApp.getInstance().getStatusViewController()._handleException(e,"ZaStatus.loadMethod",null,false)
}};
ZaItem.loadMethods.ZaStatus.push(ZaStatus.loadMethod);
ZaStatus.initMethod=function(){
this.serverMap=new Object();
this.statusVector=new AjxVector();
this.id=Dwt.getNextId()
};
ZaItem.initMethods.ZaStatus.push(ZaStatus.initMethod);
ZaStatus.prototype.initFromJS=function(r){
var l=r.timezone[0].id;
if(r.status&&r.status instanceof Array){
var m=r.status;
var s=m.length;
var f=AjxDateFormat.getDateTimeInstance(AjxDateFormat.MEDIUM,AjxDateFormat.SHORT);
for(var h=0;
h<s;
h++){
var t=m[h].server;
if(!this.serverMap[t]){
this.serverMap[t]=new Object();
this.serverMap[t].name=t;
this.serverMap[t].id=Dwt.getNextId();
this.serverMap[t].serviceMap=null;
this.serverMap[t].status=1;
this.statusVector.add(this.serverMap[t])
}
var c=m[h].service;
if(c){
if(!this.serverMap[t].serviceMap){
this.serverMap[t].serviceMap=new Object()
}
var u=Number(m[h].t);
var e=u*1000;
var n=u-AjxTimezone.getOffset(AjxTimezone.DEFAULT_RULE)*60;
var d=n+AjxTimezone.getOffset(l,(new Date(e)))*60;
this.serverMap[t].serviceMap[c]=new Object();
this.serverMap[t].serviceMap[c].status=m[h]._content;
this.serverMap[t].serviceMap[c].timestamp=e;
var o=d*1000;
this.serverMap[t].serviceMap[c].time=f.format(new Date(o));
if(this.serverMap[t].serviceMap[c].status!=1){
this.serverMap[t].status=0
}}}}};
ZaStatus.prototype.getStatusVector=function(){
return this.statusVector
};
ZaStatus.compare=function(t,e){
return(t.serverName<e.serverName)?-1:((t.serverName>e.serverName)?1:0)
}
}
if(AjxPackage.define("zimbraAdmin.mta.model.ZaMTA")){
ZaMTA=function(){
ZaItem.call(this,"ZaMTA");
this._init()
};
ZaMTA.prototype=new ZaItem;
ZaMTA.prototype.constructor=ZaMTA;
ZaItem.loadMethods.ZaMTA=new Array();
ZaItem.initMethods.ZaMTA=new Array();
ZaMTA.RESULTSPERPAGE=25;
ZaMTA.POLL_INTERVAL=1000;
ZaMTA.STATUS_IDLE=0;
ZaMTA.STATUS_SCANNING=1;
ZaMTA.STATUS_SCAN_COMPLETE=2;
ZaMTA.STATUS_STALE=3;
ZaMTA.ID_ALL="ALL";
ZaMTA.SCANNER_STATUS_CHOICES=[{
value:ZaMTA.STATUS_IDLE,label:ZaMsg.PQ_ScannerIdle}
,{
value:ZaMTA.STATUS_SCANNING,label:ZaMsg.PQ_ScannerScanning}
,{
value:ZaMTA.STATUS_SCAN_COMPLETE,label:ZaMsg.PQ_ScannerScanComplete}
,{
value:ZaMTA.STATUS_STALE,label:ZaMsg.PQ_ScannerStaleData}
];
ZaMTA.A_Servername="servername";
ZaMTA.A_Status="status";
ZaMTA.A_Stale="stale";
ZaMTA.A_LastError="lasterror";
ZaMTA.A_MTAName="mtaname";
ZaMTA.A_refreshTime="time";
ZaMTA.A_totalComplete="total";
ZaMTA.A_DeferredQ="deferred";
ZaMTA.A_IncomingQ="incoming";
ZaMTA.A_ActiveQ="active";
ZaMTA.A_CorruptQ="corrupt";
ZaMTA.A_HoldQ="hold";
ZaMTA.A_rdomain="todomain";
ZaMTA.A_sdomain="fromdomain";
ZaMTA.A_origip="received";
ZaMTA.A_raddress="to";
ZaMTA.A_saddress="from";
ZaMTA.A_error="reason";
ZaMTA.A_host="host";
ZaMTA.A_messages="messages";
ZaMTA.A_pageNum="pagenum";
ZaMTA.A_name="name";
ZaMTA.A_count="n";
ZaMTA.A_Qid="qid";
ZaMTA.A_query="query";
ZaMTA.A_more="more";
ZaMTA.A_scan="scan";
ZaMTA.A_selection_cache="_selection_cache";
ZaMTA.A_queue_filter_name="_queue_filter_name";
ZaMTA.A_queue_filter_value="_queue_filter_value";
ZaMTA.MsgIDS="message_ids";
ZaMTA._quecountsArr=new Array();
ZaMTA.threashHold;
ZaMTA.ActionRequeue="requeue";
ZaMTA.ActionDelete="delete";
ZaMTA.ActionHold="hold";
ZaMTA.ActionRelease="release";
ZaMTA.MANAGE_MAIL_QUEUE_RIGHT="manageMailQueue";
ZaMTA.prototype.getTabToolTip=function(){
return ZaMsg.tt_tab_MTA+" "+this.type+" "+this.name
};
ZaMTA.prototype.getTabIcon=function(){
return"Queue"
};
ZaMTA.prototype.QCountsCallback=function(s){
try{
if(!s){
var n=new ZmCsfeException(ZMsg.errorEmptyResponse,ZmCsfeException.CSFE_SVC_ERROR,"ZaMTA.prototype.QCountsCallback");
throw n
}
if(s.isException&&s.isException()){
var o={
obj:this,qName:null,poll:false};
ZaApp.getInstance().getMTAController(this._viewInternalId).fireChangeEvent(o);
throw (s.getException())
}
var t=s.getResponse();
var e=t.Body;
if(e&&e.GetMailQueueInfoResponse.server&&e.GetMailQueueInfoResponse.server[0]){
this.initFromJS(e.GetMailQueueInfoResponse.server[0],true);
ZaMTA._quecountsArr.sort();
ZaMTA.threashHold=ZaMTA._quecountsArr[Math.round(ZaMTA._quecountsArr.length/2)];
var o={
obj:this,qName:null,poll:false};
ZaApp.getInstance().getMTAController(this._viewInternalId).fireChangeEvent(o)
}else{
var n=new ZmCsfeException(ZMsg["service.UNKNOWN_DOCUMENT"],ZmCsfeException.SVC_UNKNOWN_DOCUMENT,"ZaMTA.prototype.QCountsCallback");
throw (n)
}}
catch(n){
this[ZaMTA.A_DeferredQ]={
n:ZaMsg.PQ_Error};
this[ZaMTA.A_IncomingQ]={
n:ZaMsg.PQ_Error};
this[ZaMTA.A_ActiveQ]={
n:ZaMsg.PQ_Error};
this[ZaMTA.A_HoldQ]={
n:ZaMsg.PQ_Error};
this[ZaMTA.A_CorruptQ]={
n:ZaMsg.PQ_Error};
this[ZaMTA.A_DeferredQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Error;
this[ZaMTA.A_IncomingQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Error;
this[ZaMTA.A_ActiveQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Error;
this[ZaMTA.A_HoldQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Error;
this[ZaMTA.A_CorruptQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Error;
var o={
obj:this,qName:null,poll:false};
ZaApp.getInstance().getMTAController(this._viewInternalId).fireChangeEvent(o);
ZaApp.getInstance().getCurrentController()._handleException(n,"ZaMTA.prototype.QCountsCallback")
}};
ZaMTA.getAll=function(d){
var l=AjxSoapDoc.create("GetAllServersRequest",ZaZimbraAdmin.URN,null);
l.getMethod().setAttribute("service","mta");
l.getMethod().setAttribute("applyConfig","false");
var n=new Object();
n.asyncMode=d?true:false;
n.callback=d?d:null;
n.soapDoc=l;
l.setMethodAttribute("attrs",[ZaServer.A_ServiceHostname,ZaServer.A_description,ZaServer.A_zimbraServiceEnabled,ZaServer.A_zimbraServiceInstalled,ZaItem.A_zimbraId].join(","));
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_SERVER};
if(d){
ZaRequestMgr.invoke(n,o)
}else{
var s=ZaRequestMgr.invoke(n,o).Body.GetAllServersResponse;
var h=new ZaItemList(ZaMTA);
var e=new ZaItemList(ZaMTA);
h.loadFromJS(s);
var c=h.getArray();
var t=c.length;
for(var r=0;
r<t;
r++){
if(ZaItem.hasRight(ZaMTA.MANAGE_MAIL_QUEUE_RIGHT,c[r])){
e.add(c[r])
}}
e.loadedRights=h.loadedRights;
return e
}};
ZaMTA.prototype.refresh=function(){
this.load()
};
ZaMTA.prototype.initFromJS=function(h,p){
if(h.a){
ZaItem.prototype.initFromJS.call(this,h)
}
var n=100;
if(h.queue){
var t=h.queue.length;
for(var o=0;
o<t;
o++){
var d=h.queue[o];
var m=d.name;
if(!this[m]){
this[m]=new Object()
}
if(d[ZaMTA.A_count]!=undefined){
this[m][ZaMTA.A_count]=d[ZaMTA.A_count];
ZaMTA._quecountsArr.push(d[ZaMTA.A_count])
}
if(d[ZaMTA.A_refreshTime]!=undefined){
this[m][ZaMTA.A_refreshTime]=AjxDateUtil.computeDateStr(new Date(),parseInt(d[ZaMTA.A_refreshTime]))
}
if(p){
continue
}
this[m][ZaMTA.MsgIDS]=null;
try{
if(d[ZaMTA.A_totalComplete]!=undefined){
this[m][ZaMTA.A_totalComplete]=parseInt(d[ZaMTA.A_totalComplete])
}}
catch(f){
this[m][ZaMTA.A_totalComplete]=0
}
if(d[ZaMTA.A_scan]!=undefined){
if(d[ZaMTA.A_scan]){
this[m][ZaMTA.A_Status]=ZaMTA.STATUS_SCANNING
}else{
this[m][ZaMTA.A_Status]=ZaMTA.STATUS_SCAN_COMPLETE;
this[m][ZaMTA.A_count]=this[m][ZaMTA.A_totalComplete]
}}
if(d[ZaMTA.A_Stale]){
this[m][ZaMTA.A_Status]=ZaMTA.STATUS_STALE
}
this[m][ZaMTA.A_more]=d[ZaMTA.A_more];
this[m][ZaMTA.A_rdomain]=[];
this[m][ZaMTA.A_sdomain]=[];
this[m][ZaMTA.A_origip]=[];
this[m][ZaMTA.A_raddress]=[];
this[m][ZaMTA.A_saddress]=[];
this[m][ZaMTA.A_error]=[];
this[m][ZaMTA.A_host]=[];
this[m][ZaMTA.A_messages]=[];
if(d.qs){
var g=h.queue[o].qs;
var u=g.length;
for(var r=0;
r<u;
r++){
if(!this[m][g[r].type]){
this[m][g[r].type]=[]
}
if(g[r].qsi){
var y=g[r].qsi;
var c=y.length;
for(var s=0;
s<c;
s++){
y[s].prototype=new ZaMTAQSummaryItem;
y[s].getToolTip=ZaMTAQSummaryItem.prototype.getToolTip;
y[s].toString=ZaMTAQSummaryItem.prototype.toString;
y[s].id=n++
}
this[m][g[r].type]=y
}}}
this[m][ZaMTA.A_messages]=[];
if(d.qi){
var e=h.queue[o].qi;
var l=e.length;
for(var r=0;
r<l;
r++){
e[r].prototype=new ZaMTAQMsgItem;
e[r].getToolTip=ZaMTAQMsgItem.prototype.getToolTip;
e[r].toString=ZaMTAQMsgItem.prototype.toString
}
this[m][ZaMTA.A_messages]=e
}}}};
ZaMTA.loadMethod=function(o,r){
var t=AjxSoapDoc.create("GetMailQueueInfoRequest",ZaZimbraAdmin.URN,null);
var e=t.set("server","");
e.setAttribute("name",this.name);
var s=new ZmCsfeCommand();
var n=new Object();
n.soapDoc=t;
n.noAuthToken=true;
n.asyncMode=true;
var h=new AjxCallback(this,this.QCountsCallback);
n.callback=h;
s.invoke(n)
};
ZaItem.loadMethods.ZaMTA.push(ZaMTA.loadMethod);
ZaMTA.luceneEscape=function(e){
return String(e).replace(/([\-\+\&\\!\(\)\{\}\[\]\^\"\~\*\?\:\\])/g,"\\$1")
};
ZaMTA.prototype.getMailQStatus=function(g,h,l,f,o){
if(o){
var u=this[g].n;
this[g]={
n:u}
}
f=(f!=null)?f:ZaMTA.RESULTSPERPAGE;
l=(l!=null)?l:"0";
var b=AjxSoapDoc.create("GetMailQueueRequest",ZaZimbraAdmin.URN,null);
var e=b.set("server","");
e.setAttribute("name",this.name);
var d=b.getDoc().createElement("queue");
d.setAttribute("name",g);
if(o){
d.setAttribute("scan",1);
this[g][ZaMTA.A_Status]=ZaMTA.STATUS_SCANNING
}
e.appendChild(d);
var w=b.getDoc().createElement("query");
if(!AjxUtil.isEmpty(h)){
for(var y in h){
var t=h[y];
if(t){
var u=t.length;
if(u){
var n=b.getDoc().createElement("field");
n.setAttribute("name",y);
for(var m=0;
m<u;
m++){
var c=b.getDoc().createElement("match");
c.setAttribute("value",t[m][ZaMTAQSummaryItem.A_text]);
n.appendChild(c)
}
w.appendChild(n)
}}}}
if(l!=null){
w.setAttribute("offset",l)
}
if(f!=null){
w.setAttribute("limit",f)
}
d.appendChild(w);
var s=new ZmCsfeCommand();
var p=new Object();
p.soapDoc=b;
p.noAuthToken=true;
p.asyncMode=true;
var r=new AjxCallback(this,this.mailQStatusCallback,{
qName:g,query:h,offset:l,limit:f,force:o}
);
p.callback=r;
s.invoke(p)
};
ZaMTA.prototype.mailQStatusCallback=function(t,l){
var h=t.qName;
if(!l){
var r=new ZmCsfeException(ZMsg.errorEmptyResponse,ZmCsfeException.CSFE_SVC_ERROR,"ZaMTA.prototype.mailQStatusCallback");
ZaApp.getInstance().getCurrentController()._handleException(r,"ZaMTA.prototype.mailQStatusCallback");
return
}
if(l.isException&&l.isException()){
if(l.getException().code==ZmCsfeException.SVC_ALREADY_IN_PROGRESS){
var s={
obj:this,qName:h,poll:true};
ZaApp.getInstance().getMTAController(this._viewInternalId).fireChangeEvent(s)
}else{
if(l.getException().code==ZmCsfeException.SVC_TEMPORARILY_UNAVAILABLE){
ZaApp.getInstance().getCurrentController().popupMsgDialog(ZaMsg.ERROR_PQ_SERVICE_UNAVAILABLE)
}else{
ZaApp.getInstance().getCurrentController()._handleException(l.getException(),"ZaMTA.prototype.mailQStatusCallback")
}}
return
}
var n=l.getResponse();
var e=n.Body;
if(e&&e.GetMailQueueResponse.server&&e.GetMailQueueResponse.server[0]){
this.initFromJS(e.GetMailQueueResponse.server[0],false);
var s={
obj:this,poll:true};
for(var o in t){
s[o]=t[o]
}
ZaApp.getInstance().getMTAController(this._viewInternalId).fireChangeEvent(s)
}else{
var r=new ZmCsfeException(ZMsg["service.UNKNOWN_DOCUMENT"],ZmCsfeException.SVC_UNKNOWN_DOCUMENT,"ZaMTA.prototype.mailQStatusCallback");
ZaApp.getInstance().getCurrentController()._handleException(r,"ZaMTA.prototype.mailQStatusCallback");
return
}};
ZaMTA.prototype.mailQueueAction=function(p,c,m,w){
var y=AjxSoapDoc.create("MailQueueActionRequest",ZaZimbraAdmin.URN,null);
var e=y.set("server","");
e.setAttribute("name",this.name);
var l=y.getDoc().createElement("queue");
l.setAttribute("name",p);
e.appendChild(l);
var o;
if(m=="id"){
o=y.set("action",w,l)
}else{
o=y.getDoc().createElement("action");
var b=y.getDoc().createElement("query");
if(w!=null){
for(var g in w){
var t=w[g];
if(t){
var d=t.length;
if(d){
var n=y.getDoc().createElement("field");
n.setAttribute("name",g);
for(var u=0;
u<d;
u++){
var h=y.getDoc().createElement("match");
h.setAttribute("value",t[u][ZaMTAQSummaryItem.A_text]);
n.appendChild(h)
}
b.appendChild(n)
}}}}
o.appendChild(b);
l.appendChild(o)
}
o.setAttribute("op",c);
o.setAttribute("by",m);
var s=new ZmCsfeCommand();
var f=new Object();
f.soapDoc=y;
f.asyncMode=true;
f.noAuthToken=true;
var r=new AjxCallback(this,this.mailQueueActionClbck,p);
f.callback=r;
s.invoke(f)
};
ZaMTA.prototype.mailQueueActionClbck=function(t,o){
this[t][ZaMTA.A_DeferredQ]=ZaMTA.STATUS_STALE;
this[t][ZaMTA.A_IncomingQ]=ZaMTA.STATUS_STALE;
this[t][ZaMTA.A_ActiveQ]=ZaMTA.STATUS_STALE;
this[t][ZaMTA.A_CorruptQ]=ZaMTA.STATUS_STALE;
this[t][ZaMTA.A_HoldQ]=ZaMTA.STATUS_STALE;
if(o.isException&&o.isException()){
if(o.getException().code==ZmCsfeException.SVC_ALREADY_IN_PROGRESS){
var e={
obj:this,qName:t};
ZaApp.getInstance().getMTAController(this._viewInternalId).fireChangeEvent(e)
}else{
if(o.getException().code==ZmCsfeException.SVC_TEMPORARILY_UNAVAILABLE){
ZaApp.getInstance().getCurrentController().popupMsgDialog(ZaMsg.ERROR_PQ_SERVICE_UNAVAILABLE)
}else{
ZaApp.getInstance().getCurrentController()._handleException(o.getException(),"ZaMTA.prototype.mailQueueActionClbck")
}}}else{
this.getMailQStatus(t)
}};
ZaMTA.prototype.flushQueues=function(){
var t=AjxSoapDoc.create("MailQueueFlushRequest",ZaZimbraAdmin.URN,null);
var n=t.set("server","");
n.setAttribute("name",this.name);
var o=new Object();
o.soapDoc=t;
o.asyncMode=false;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_FLUSH_QUEUE};
ZaRequestMgr.invoke(o,e)
};
ZaMTA.initMethod=function(){
this.attrs=new Object();
this.id="";
this.name="";
this[ZaItem.A_zimbraId]="000";
this[ZaMTA.A_DeferredQ]={
n:ZaMsg.PQ_Loading};
this[ZaMTA.A_IncomingQ]={
n:ZaMsg.PQ_Loading};
this[ZaMTA.A_ActiveQ]={
n:ZaMsg.PQ_Loading};
this[ZaMTA.A_HoldQ]={
n:ZaMsg.PQ_Loading};
this[ZaMTA.A_CorruptQ]={
n:ZaMsg.PQ_Loading};
this[ZaMTA.A_DeferredQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Loading;
this[ZaMTA.A_IncomingQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Loading;
this[ZaMTA.A_ActiveQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Loading;
this[ZaMTA.A_HoldQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Loading;
this[ZaMTA.A_CorruptQ][ZaMTA.A_refreshTime]=ZaMsg.PQ_Loading;
this[ZaMTA.A_DeferredQ][ZaMTA.A_pageNum]=0;
this[ZaMTA.A_IncomingQ][ZaMTA.A_pageNum]=0;
this[ZaMTA.A_ActiveQ][ZaMTA.A_pageNum]=0;
this[ZaMTA.A_HoldQ][ZaMTA.A_pageNum]=0;
this[ZaMTA.A_CorruptQ][ZaMTA.A_pageNum]=0;
this[ZaMTA.A_DeferredQ][ZaMTA.A_Status]=ZaMTA.STATUS_IDLE;
this[ZaMTA.A_IncomingQ][ZaMTA.A_Status]=ZaMTA.STATUS_IDLE;
this[ZaMTA.A_ActiveQ][ZaMTA.A_Status]=ZaMTA.STATUS_IDLE;
this[ZaMTA.A_HoldQ][ZaMTA.A_Status]=ZaMTA.STATUS_IDLE;
this[ZaMTA.A_CorruptQ][ZaMTA.A_Status]=ZaMTA.STATUS_IDLE
};
ZaItem.initMethods.ZaMTA.push(ZaMTA.initMethod);
ZaMTAQSummaryItem=function(o,e,s){
if(arguments.length==0){
return
}
ZaItem.call(this,"ZaMTAQSummaryItem");
this._init();
if(o){
this[ZaMTAQSummaryItem.A_description]=o
}
if(e){
this[ZaMTAQSummaryItem.A_text]=e
}
if(s){
this[ZaMTAQSummaryItem.A_count]=s
}};
ZaMTAQSummaryItem.A_text="t";
ZaMTAQSummaryItem.A_text_col="textColumn";
ZaMTAQSummaryItem.A_description="d";
ZaMTAQSummaryItem.A_count="n";
ZaMTAQSummaryItem.A_count_col="countColumn";
ZaMTAQSummaryItem.prototype=new ZaItem;
ZaMTAQSummaryItem.prototype.constructor=ZaMTAQSummaryItem;
ZaItem.loadMethods.ZaMTAQSummaryItem=new Array();
ZaItem.initMethods.ZaMTAQSummaryItem=new Array();
ZaMTAQSummaryItem.prototype.toString=function(){
return this[ZaMTAQSummaryItem.A_text]+this[ZaMTAQSummaryItem.A_count]
};
ZaMTAQSummaryItem.prototype.getToolTip=function(){
if(!this._toolTip){
var t=new Array(20);
var e=0;
t[e++]=AjxStringUtil.htmlEncode(this[ZaMTAQSummaryItem.A_text]);
t[e++]="<br>";
t[e++]=this[ZaMTAQSummaryItem.A_count];
t[e++]=" ";
t[e++]=ZaMsg.PQV_Messages;
this._toolTip=t.join("")
}
return this._toolTip
};
ZaMTAQMsgItem=function(){
if(arguments.length==0){
return
}
ZaItem.call(this,"ZaMTAQMsgItem");
this._init()
};
ZaMTAQMsgItem.A_time="time";
ZaMTAQMsgItem.A_content_filter="filter";
ZaMTAQMsgItem.A_origin_host="host";
ZaMTAQMsgItem.A_sender="from";
ZaMTAQMsgItem.A_fromdomain="fromdomain";
ZaMTAQMsgItem.A_todomain="todomain";
ZaMTAQMsgItem.A_id="id";
ZaMTAQMsgItem.A_recipients="to";
ZaMTAQMsgItem.A_size="size";
ZaMTAQMsgItem.A_origin_ip="received";
ZaMTAQMsgItem.A_error="reason";
ZaMTAQMsgItem.prototype=new ZaItem;
ZaMTAQMsgItem.prototype.constructor=ZaMTAQMsgItem;
ZaItem.loadMethods.ZaMTAQMsgItem=new Array();
ZaItem.initMethods.ZaMTAQMsgItem=new Array();
ZaMTAQMsgItem.prototype.toString=function(){
return this[ZaMTAQMsgItem.A_id]
};
ZaMTAQMsgItem.prototype.initFromJS=function(e){
this[ZaMTAQMsgItem.A_time]=e[ZaMTAQMsgItem.A_time];
this[ZaMTAQMsgItem.A_content_filter]=e[ZaMTAQMsgItem.A_content_filter];
this[ZaMTAQMsgItem.A_origin_host]=e[ZaMTAQMsgItem.A_origin_host];
this[ZaMTAQMsgItem.A_sender]=e[ZaMTAQMsgItem.A_sender];
this[ZaMTAQMsgItem.A_id]=e[ZaMTAQMsgItem.A_id];
this[ZaMTAQMsgItem.A_recipients]=e[ZaMTAQMsgItem.A_recipients];
this[ZaMTAQMsgItem.A_origin_ip]=e[ZaMTAQMsgItem.A_origin_ip]
};
ZaMTAQMsgItem.prototype.getToolTip=function(){
if(!this._toolTip){
var o=new Array(20);
var t=0;
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_Sender+" "+this[ZaMTAQMsgItem.A_sender]);
o[t++]="<br/>";
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_OriginHost+" "+this[ZaMTAQMsgItem.A_origin_host]);
o[t++]="<br/>";
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_OriginDomain+" "+this[ZaMTAQMsgItem.A_fromdomain]);
o[t++]="<br/>";
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_OriginIP+" "+this[ZaMTAQMsgItem.A_origin_ip]);
o[t++]="<br/>";
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_Recipients+" "+this[ZaMTAQMsgItem.A_recipients]);
o[t++]="<br/>";
var e=this[ZaMTAQMsgItem.A_todomain] instanceof Array?this[ZaMTAQMsgItem.A_todomain]:[this[ZaMTAQMsgItem.A_todomain]];
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_DestinationDomain+" "+ZaUtil.getUniqueArrayElements(e));
o[t++]="<br/>";
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_ContentFilter+" "+this[ZaMTAQMsgItem.A_content_filter]);
o[t++]="<br/>";
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_Size+" "+this[ZaMTAQMsgItem.A_size]);
o[t++]="<br/>";
if(this[ZaMTAQMsgItem.A_error]!=null&&this[ZaMTAQMsgItem.A_error]!=undefined&&this[ZaMTAQMsgItem.A_error].length>0){
o[t++]=AjxStringUtil.htmlEncode(ZaMsg.PQ_Reason+" "+this[ZaMTAQMsgItem.A_error])
}
this._toolTip=o.join("")
}
return this._toolTip
};
PostQSummary_XModelItem=function(){};
XModelItemFactory.createItemType("_POSTQSUMMARY_","postqsummary",PostQSummary_XModelItem);
PostQSummary_XModelItem.prototype.items=[{
id:ZaMTA.A_count,type:_NUMBER_}
,{
id:ZaMTA.A_pageNum,type:_NUMBER_}
,{
id:ZaMTA.A_query,type:_STRING_}
,{
id:ZaMTA.A_Status,type:_NUMBER_,choices:ZaMTA.SCANNER_STATUS_CHOICES}
,{
id:ZaMTA.A_refreshTime,type:_STRING_}
];
ZaMTA.myXModel={
items:[{
id:ZaMTA.A_Status,type:_STRING_,ref:ZaMTA.A_Status}
,{
id:ZaMTA.A_MTAName,type:_STRING_,ref:ZaMTA.A_MTAName}
,{
id:ZaMTA.A_LastError,type:_STRING_,ref:ZaMTA.A_LastError}
,{
id:ZaMTA.A_DeferredQ,type:_POSTQSUMMARY_}
,{
id:ZaMTA.A_IncomingQ,type:_POSTQSUMMARY_}
,{
id:ZaMTA.A_ActiveQ,type:_POSTQSUMMARY_}
,{
id:ZaMTA.A_CorruptQ,type:_POSTQSUMMARY_}
,{
id:ZaMTA.A_HoldQ,type:_POSTQSUMMARY_}
]}
}
if(AjxPackage.define("zimbraAdmin.task.model.ZaTask")){
ZaTask=function(e){
if(e){
return
}
ZaItem.call(this,"ZaTask");
this._init();
this.type="Task"
};
ZaTask.prototype=new ZaItem;
ZaTask.prototype.constructor=ZaTask;
ZaItem.loadMethods.ZaTask=new Array();
ZaItem.initMethods.ZaTask=new Array();
ZaTask.A_workingInProcess="workingInProcess";
ZaTask.A_runningTask="runningTask";
ZaTask.A2_isExpanded="expanded";
ZaTask.A2_isWIPExpanded="WIPExpanded";
ZaTask.A2_isRTExpanded="RTExpaneded";
ZaTask.A2_isServerExpaned="ServerExpaned";
ZaTask.A2_notificationCount="notificationCount";
ZaTask.postLoadDataFunction=new Array();
ZaTask.loadMethod=function(e,t){
this.attrs=new Object();
this.attrs[ZaTask.A_workingInProcess]=[];
this.attrs[ZaTask.A_runningTask]=[];
this.schedulePostLoading()
};
ZaItem.loadMethods.ZaTask.push(ZaTask.loadMethod);
ZaTask.initMethod=function(){
this[ZaTask.A2_isExpanded]=false;
this[ZaTask.A2_isWIPExpanded]=true;
this[ZaTask.A2_isRTExpanded]=true;
this[ZaTask.A2_isServerExpaned]=true
};
ZaItem.initMethods.ZaTask.push(ZaTask.initMethod);
ZaTask.myXModel={
items:[{
id:ZaTask.A_workingInProcess,ref:"attrs/"+ZaTask.A_workingInProcess,type:_LIST_,listItem:{
type:_OBJECT_}}
,{
id:ZaTask.A_runningTask,ref:"attrs/"+ZaTask.A_runningTask,type:_LIST_}
,{
id:ZaTask.A2_isExpanded,ref:ZaTask.A2_isExpanded,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaTask.A2_isWIPExpanded,ref:ZaTask.A2_isWIPExpanded,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaTask.A2_isRTExpanded,ref:ZaTask.A2_isRTExpanded,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaTask.A2_isServerExpaned,ref:ZaTask.A2_isServerExpaned,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaTask.A2_notificationCount,ref:ZaTask.A2_notificationCount,type:_NUMBER_,defaultValue:0}
]};
ZaTaskItem=function(o,n,h,e,t,s,l,u,r,c,d){
this.viewForPopup=o;
this.cacheName=n;
this._title=h;
this.data=e;
this.position=t;
this.type=s||1;
this.displayName=l;
this.finishCallback=u;
this.cacheDialog=r
};
ZaTaskItem.minDisplayName=new Object();
ZaTaskItem.prototype.getMinDisplayName=function(t){
var e;
if(!ZaTaskItem.minDisplayName[t]){
ZaTaskItem.minDisplayName[t]=1;
e=t
}else{
e=t+" "+ZaTaskItem.minDisplayName[t];
ZaTaskItem.minDisplayName[t]++
}
return e
};
ZaTaskItem.prototype.toString=function(){
if(!this.displayName){
this.displayName=this.getMinDisplayName(this._title)
}
return this.displayName
};
ZaTaskItem.prototype.getData=function(){
return this.data._uuid
};
ZaTask.prototype.schedulePostLoading=function(){
var e=new AjxTimedAction(this,ZaTask.prototype.startPostLoading);
AjxTimedAction.scheduleAction(e,100)
};
ZaTask.prototype.startPostLoading=function(){
for(var e=0;
e<ZaTask.postLoadDataFunction.length;
e++){
ZaTask.postLoadDataFunction[e].call(this)
}}
}
if(AjxPackage.define("zimbraAdmin.home.view.ZaHomeXFormView")){
ZaHomeXFormView=function(e,t){
ZaTabView.call(this,{
parent:e,cssClassName:"ZaHomeTabView DwtTabView",iKeyName:"ZaHomeXFormView",contextId:ZaId.VIEW_HOME}
);
this.initForm(ZaHome.myXModel,this.getMyXForm(t),null);
this._localXForm.setController(ZaApp.getInstance())
};
ZaHomeXFormView.prototype=new ZaTabView();
ZaHomeXFormView.prototype.constructor=ZaHomeXFormView;
ZaTabView.XFormModifiers.ZaHomeXFormView=new Array();
ZaHomeXFormView.prototype.setObject=function(o){
this._containedObject=new Object();
this._containedObject.attrs=new Object();
for(var e in o.attrs){
var t=this._localXForm.getModel().getItem(e);
if((t!=null&&t.type==_LIST_)||(o.attrs[e]!=null&&o.attrs[e] instanceof Array)){
this._containedObject.attrs[e]=ZaItem.deepCloneListItem(o.attrs[e])
}else{
this._containedObject.attrs[e]=o.attrs[e]
}}
this._containedObject.name=o.name;
this._containedObject.type=o.type;
if(o.rights){
this._containedObject.rights=o.rights
}
if(o.setAttrs){
this._containedObject.setAttrs=o.setAttrs
}
if(o.getAttrs){
this._containedObject.getAttrs=o.getAttrs
}
if(o._defaultValues){
this._containedObject._defaultValues=o._defaultValues
}
if(o.id){
this._containedObject.id=o.id
}
if(!o[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=o[ZaModel.currentTab]
}
this._localXForm.setInstance(this._containedObject)
};
ZaHomeXFormView.onCreateDomain=function(t){
var e=ZaApp.getInstance().getDomainListController();
ZaDomainListController.prototype._newButtonListener.call(e,t)
};
ZaHomeXFormView.onConfigGAL=function(o){
var n=ZaApp.getInstance().getDomainList();
if(n.size()>0){
var t=n.getVector().getLast();
var e=ZaApp.getInstance().getDomainListController();
ZaDomainListController.prototype._openConfigGAL.call(e,t)
}};
ZaHomeXFormView.canConfigGAL=function(s){
var r=ZaApp.getInstance().getDomainList();
var e=false;
if(r.size()>0){
var n;
var t=r.getVector();
for(var o=t.size()-1;
o>=0;
o--){
n=t.get(o);
if(ZaDomain.canConfigureGal(n)){
e=true;
break
}}}
return e
};
ZaHomeXFormView.onConfigAuth=function(o){
var n=ZaApp.getInstance().getDomainList();
if(n.size()>0){
var t=n.getVector().getLast();
var e=ZaApp.getInstance().getDomainListController();
ZaDomainListController.prototype._openAuthWiz.call(e,t)
}};
ZaHomeXFormView.canConfigAuth=function(e){
var o=ZaApp.getInstance().getDomainList();
var t=false;
if(o.size()>0){
t=ZaDomain.canConfigureAuth(o.getVector().getLast())
}
return t
};
ZaHomeXFormView.onConfigDefaultCos=function(){
var s=ZaApp.getInstance().getCosList();
if(s.size()>0){
var e=s.getVector();
var n;
for(var o=0;
o<e.size();
o++){
n=e.get(o);
if(n.name=="default"){
break
}}
if(o!=e.size()){
ZaApp.getInstance().getCosController().show(n);
var t=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_configure,ZaMsg.OVP_cos]);
ZaZimbraAdmin.getInstance().getOverviewPanelController().addObjectItem(t,n.name,null,true,false,n)
}}};
ZaHomeXFormView.onCreateAccount=function(e){
ZaAccountListController.prototype._newAccountListener.call(ZaApp.getInstance().getAccountListController(),e)
};
ZaHomeXFormView.onManageAccount=function(t){
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
var o=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_manageAccounts]);
e.setSelectionByPath(o,false)
};
ZaHomeXFormView.onViewService=function(t){
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
var o=ZaTree.getPathByArray([ZaMsg.OVP_home,ZaMsg.OVP_monitor,ZaMsg.OVP_status]);
e.setSelectionByPath(o,false)
};
ZaHomeXFormView.onSearchZimbraHelp=function(t){
var e="http://support.zimbra.com/help/index.php";
window.open(e,"_blank")
};
ZaHomeXFormView.onDownloadGuide=function(e){
ZaZimbraAdmin.prototype._dwListener.call(ZaZimbraAdmin.getInstance())
};
ZaHomeXFormView.onHelpLink=function(e){
ZaZimbraAdmin.prototype._helpListener.call(ZaZimbraAdmin.getInstance())
};
ZaHomeXFormView.onCloseSetup=function(o){
var t=this.getForm();
var e=t.getItemById(t.getId()+"_homeSetupGroup");
e.hide()
};
ZaHomeXFormView.getWarningPanelItem=function(e){
return e.items[0].items[0].items[0]
};
ZaHomeXFormView.getHomeMaintenanceItem=function(e){
return e.items[0].items[0].items[1].items[1]
};
ZaHomeXFormView.getHomeSetupItem=function(e){
return e.items[0].items[0].items[2].items[0].items[1]
};
ZaHomeXFormView.getWarningPanelCol=function(){
return["20px","*","120px"]
};
ZaHomeXFormView.showStatusInfo=function(){
return(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.GLOBAL_STATUS_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])
};
ZaHomeXFormView.showStaticsInfo=function(){
return(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SERVER_STATS_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])
};
ZaHomeXFormView.showRunTime=function(){
return(ZaHomeXFormView.showStatusInfo()||ZaHomeXFormView.showStaticsInfo())
};
ZaHomeXFormView.showMT=function(){
var e=this.getInstanceValue(ZaHome.A2_maintenanceItemNum);
return e>1
};
ZaHomeXFormView.myXFormModifier=function(s,h){
var c=[];
var n=[];
var o=[];
n.push(ZaMsg.LBL_HomeGetStared);
o.push([]);
var t=o[o.length-1];
t.push({}
);
t.push({}
);
t.push({}
);
t.push({}
);
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.COS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t[3]={
value:ZaMsg.LBL_HomeConfigureCos,onClick:ZaHomeXFormView.onConfigDefaultCos}
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DOMAIN_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var e=[];
if(ZaZimbraAdmin.canCreateTopDomain()){
e.push({
value:ZaMsg.LBL_HomeCreateDomain,onClick:ZaHomeXFormView.onCreateDomain}
)
}
if(ZaHomeXFormView.canConfigGAL()){
e.push({
value:ZaMsg.LBL_HomeConfigureGAL,onClick:ZaHomeXFormView.onConfigGAL}
)
}
if(ZaHomeXFormView.canConfigAuth()){
e.push({
value:ZaMsg.LBL_HomeCOnfigureAuth,onClick:ZaHomeXFormView.onConfigAuth}
)
}
if(e.length>0){
n.push(ZaMsg.LBL_HomeSetupDomain);
o.push(e)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
var l=[];
if(ZaZimbraAdmin.canCreateAccount()){
n.push(ZaMsg.LBL_HomeAddAccounts);
l.push({
value:ZaMsg.LBL_HomeAddAccount,onClick:ZaHomeXFormView.onCreateAccount}
)
}else{
if(ZaZimbraAdmin.canListAccounts()){
n.push(ZaMsg.LBL_HomeManageAccount)
}}
if(ZaZimbraAdmin.canListAccounts()){
l.push({
value:ZaMsg.LBL_HomeManageAccount,onClick:ZaHomeXFormView.onManageAccount}
)
}
if(l.length>0){
o.push(l)
}}
var r={
type:_ZATABCASE_,numCols:3,colSizes:["37%","34%","29%"],caseKey:1,paddingStyle:"",width:"100%",items:[{
type:_GROUP_,colSpan:"*",numCols:1,containerCssClass:"ZaHomeWarningPanel",visibilityChecks:[[XForm.checkInstanceValue,ZaHome.A2_showWarningPanel,true]],visibilityChangeEventSources:[ZaHome.A2_showWarningPanel],items:[{
type:_GROUP_,numCols:3,width:"100%",colSizes:ZaHomeXFormView.getWarningPanelCol(),containerCssClass:"ZaHomeWarningItem",visibilityChecks:[[XForm.checkInstanceValueNot,ZaHome.A2_serviceStatus,true],[ZaHomeXFormView.showStatusInfo]],visibilityChangeEventSources:[ZaHome.A2_serviceStatus],items:[{
type:_OUTPUT_,ref:ZaHome.A2_serviceStatus,bmolsnr:true,getDisplayValue:function(d){
if(this.getInstanceValue(ZaHome.A2_serviceDetailedMessage)==ZaMsg.MSG_HomeLoading){
return""
}
if(d===undefined){
return AjxImg.getImageHtml("UnKnownStatus")
}else{
if(d===false){
return AjxImg.getImageHtml("Critical")
}else{
return AjxImg.getImageHtml("Check")
}}}
,valueChangeEventSources:[ZaHome.A2_serviceDetailedMessage]}
,{
type:_OUTPUT_,ref:ZaHome.A2_serviceDetailedMessage,bmolsnr:true}
,{
type:_OUTPUT_,value:ZaMsg.LBL_HomeLinkServerStatus,containerCssClass:"ZaLinkedItem",onClick:ZaHomeXFormView.onViewService}
]}
]}
,{
type:_GROUP_,colSpan:"*",numCols:3,width:"100%",colSizes:["33%","34%","33%"],containerCssClass:"ZaHomeInfoPanel",items:[{
type:_GROUP_,containerCssClass:"ZaHomePanelPage",cssStyle:"overflow:hidden",colSizes:["auto"],items:[{
type:_OUTPUT_,colSpan:"2",value:ZaMsg.LBL_HomeSummary,cssClass:"ZaHomeInfoTitle"}
,{
type:_OUTPUT_,label:ZabMsg.LBL_HomeZimbraVersion,cssStyle:"word-wrap:break-word;word-break:break-all;",ref:ZaHome.A2_version}
,{
type:_OUTPUT_,label:ZaMsg.LBL_HomeServerNum,ref:ZaHome.A2_serverNum,bmolsnr:true,visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SERVER_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]);"]}
,{
type:_OUTPUT_,label:ZaMsg.LBL_HomeAccountNum,ref:ZaHome.A2_accountNum,bmolsnr:true,visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]);"]}
,{
type:_OUTPUT_,label:ZaMsg.LBL_HomeDomainNum,ref:ZaHome.A2_domainNum,bmolsnr:true,visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DOMAIN_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]);"]}
,{
type:_OUTPUT_,label:ZaMsg.LBL_HomeCosNum,ref:ZaHome.A2_cosNum,bmolsnr:true,visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.COS_LIST_VIEW] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]);"]}
]}
,{
type:_GROUP_,id:"maintenance_grp",containerCssClass:"ZaHomePanelPage",items:[{
type:_OUTPUT_,colSpan:"*",value:ZaMsg.LBL_HomeMaintenance,cssClass:"ZaHomeInfoTitle",visibilityChangeEventSources:[ZaHome.A2_maintenanceItemNum],visibilityChecks:[[ZaHomeXFormView.showMT]]}
]}
,{
type:_GROUP_,containerCssClass:"ZaHomePanelPage",visibilityChecks:[[ZaHomeXFormView.showRunTime]],items:[{
type:_OUTPUT_,colSpan:"2",value:ZaMsg.LBL_HomeRuntime,cssClass:"ZaHomeInfoTitle"}
,{
type:_OUTPUT_,label:ZaMsg.LBL_HomeService,ref:ZaHome.A2_serviceStatus,bmolsnr:true,visibilityChecks:[[ZaHomeXFormView.showStatusInfo]],valueChangeEventSources:[ZaHome.A2_serviceStatusMessage],cssStyle:"position:relative;",getDisplayValue:function(f){
var m="";
var p=this.getInstanceValue(ZaHome.A2_serviceStatusMessage);
var u;
if(p!=ZaMsg.MSG_HomeLoading){
u="position:absolute;left:0px;";
if(f===undefined){
m=AjxImg.getImageHtml("UnKnownStatus",u)
}else{
if(f===false){
m=AjxImg.getImageHtml("Critical",u)
}else{
m=AjxImg.getImageHtml("Check",u)
}}}
var d="";
if(p!=""){
d=["<span style='margin-left:16px;'>",p,"</span>"].join("")
}
return m+d
}}
,{
type:_OUTPUT_,label:ZaMsg.LBL_HomeActiveSession,align:_LEFT_,ref:ZaHome.A2_activeSession,bmolsnr:true,visibilityChecks:[[ZaHomeXFormView.showStaticsInfo]]}
,{
type:_OUTPUT_,label:ZaMsg.LBL_HomeQueueLength,ref:ZaHome.A2_queueLength,bmolsnr:true,visibilityChecks:[[ZaHomeXFormView.showStaticsInfo]]}
]}
]}
,{
type:_GROUP_,colSpan:"*",id:"homeSetupGroup",containerCssClass:"ZaHomeSetupPanelContainer",cssClass:"ZaHomeSetupPanel",numCols:1,items:[{
type:_GROUP_,colSpan:"*",numCols:3,width:"100%",colSizes:["37%","34%","29%"],containerCssClass:"ZaHomeSetupPanelContent",items:[{
type:_GROUP_,colSpan:"*",width:"100%",numCols:2,colSizes:["100%","20px"],items:[{
type:_CELL_SPACER_}
,{
type:_DWT_IMAGE_,value:"ImgRemoveLineUp",containerCssStyle:"cursor: pointer;",cssStyle:"position:static;display:none;",onClick:ZaHomeXFormView.onCloseSetup}
]}
,{
type:_SETUPGROUP_,colSpan:"*",headerLabels:n,contentItems:o}
]}
]}
]};
c.push(r);
s.tableCssStyle="width:100%;";
s.items=[{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:c}
]
};
ZaTabView.XFormModifiers.ZaHomeXFormView.push(ZaHomeXFormView.myXFormModifier);
ZaHomeXFormView.prototype.getBarImage=function(){
return"Home"
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaAccountXFormView")){
ZaAccountXFormView=function(e,t){
ZaTabView.call(this,{
parent:e,iKeyName:"ZaAccountXFormView",contextId:ZaId.TAB_ACCT_EDIT}
);
this.accountStatusChoices=[{
value:ZaAccount.ACCOUNT_STATUS_ACTIVE,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_ACTIVE)}
,{
value:ZaAccount.ACCOUNT_STATUS_CLOSED,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_CLOSED)}
,{
value:ZaAccount.ACCOUNT_STATUS_LOCKED,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_LOCKED)}
,{
value:ZaAccount.ACCOUNT_STATUS_LOCKOUT,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_LOCKOUT),visible:false}
,{
value:ZaAccount.ACCOUNT_STATUS_PENDING,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_PENDING)}
,{
value:ZaAccount.ACCOUNT_STATUS_MAINTENANCE,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_MAINTENANCE)}
];
this.cosChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
this.TAB_INDEX=0;
this._domains={};
this.initForm(ZaAccount.myXModel,this.getMyXForm(t),null);
this._localXForm._setAllowSelection()
};
ZaAccountXFormView.prototype=new ZaTabView();
ZaAccountXFormView.prototype.constructor=ZaAccountXFormView;
ZaTabView.XFormModifiers.ZaAccountXFormView=new Array();
ZaTabView.ObjectModifiers.ZaAccountXFormView=[];
ZaAccountXFormView.zimletChoices=new XFormChoices([],XFormChoices.SIMPLE_LIST);
ZaAccountXFormView.themeChoices=new XFormChoices([],XFormChoices.OBJECT_LIST);
ZaAccountXFormView.prototype.getTabIcon=function(){
if(this._containedObject&&this._containedObject.attrs){
var e;
var t=this._containedObject;
if(t.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
e="AdminUser"
}else{
if(t.attrs[ZaAccount.A_zimbraIsDelegatedAdminAccount]=="TRUE"){
e="DomainAdminUser"
}else{
if(t.attrs[ZaAccount.A_zimbraIsSystemResource]=="TRUE"){
e="SystemResource"
}else{
e="Account"
}}}
return e
}else{
return"Account"
}};
ZaAccountXFormView.prototype.setObject=function(m){
m.manageSpecialAttrs();
m.modifyObject();
this._containedObject=new ZaAccount();
this._containedObject.attrs=new Object();
for(var u in m.attrs){
var l=this._localXForm.getModel().getItem(u);
if((l!=null&&l.type==_LIST_)||(m.attrs[u]!=null&&m.attrs[u] instanceof Array)){
this._containedObject.attrs[u]=ZaItem.deepCloneListItem(m.attrs[u])
}else{
this._containedObject.attrs[u]=m.attrs[u]
}}
this._containedObject.name=m.name;
this._containedObject.type=m.type;
if(m.rights){
this._containedObject.rights=m.rights
}
if(m.setAttrs){
this._containedObject.setAttrs=m.setAttrs
}else{
this._containedObject.setAttrs={}
}
if(m.getAttrs){
this._containedObject.getAttrs=m.getAttrs
}
if(m._defaultValues){
this._containedObject._defaultValues=m._defaultValues
}
if(m.id){
this._containedObject.id=m.id
}
for(var u in m.attrs){
var l=this._localXForm.getModel().getItem(u);
if((l!=null&&l.type==_LIST_)||(m.attrs[u]!=null&&m.attrs[u] instanceof Array)){
this._containedObject.attrs[u]=ZaItem.deepCloneListItem(m.attrs[u])
}else{
this._containedObject.attrs[u]=m.attrs[u]
}}
this._containedObject[ZaAccount.A2_memberOf]=ZaAccountMemberOfListView.cloneMemberOf(m);
this._containedObject[ZaAccount.A2_directMemberList+"_offset"]=m[ZaAccount.A2_directMemberList+"_offset"];
this._containedObject[ZaAccount.A2_directMemberList+"_more"]=m[ZaAccount.A2_directMemberList+"_more"];
this._containedObject[ZaAccount.A2_indirectMemberList+"_offset"]=m[ZaAccount.A2_indirectMemberList+"_offset"];
this._containedObject[ZaAccount.A2_indirectMemberList+"_more"]=m[ZaAccount.A2_indirectMemberList+"_more"];
this._containedObject[ZaAccount.A2_nonMemberList+"_offset"]=m[ZaAccount.A2_nonMemberList+"_offset"];
this._containedObject[ZaAccount.A2_nonMemberList+"_more"]=m[ZaAccount.A2_nonMemberList+"_more"];
if(ZaTabView.isTAB_ENABLED(m,ZaAccountXFormView.ALIASES_TAB_ATTRS,ZaAccountXFormView.ALIASES_TAB_RIGHTS)){
if(this._containedObject.attrs[ZaAccount.A_zimbraMailAlias]){
if(!this._containedObject.attrs[ZaAccount.A_zimbraMailAlias] instanceof Array){
this._containedObject.attrs[ZaAccount.A_zimbraMailAlias]=[this._containedObject.attrs[ZaAccount.A_zimbraMailAlias]]
}}}
if(ZaTabView.isTAB_ENABLED(m,ZaAccountXFormView.FORWARDING_TAB_ATTRS,ZaAccountXFormView.FORWARDING_TAB_RIGHTS)){
if(this._containedObject.attrs[ZaAccount.A_zimbraMailForwardingAddress]){
if(!this._containedObject.attrs[ZaAccount.A_zimbraMailForwardingAddress] instanceof Array){
this._containedObject.attrs[ZaAccount.A_zimbraMailForwardingAddress]=[this._containedObject.attrs[ZaAccount.A_zimbraMailForwardingAddress]]
}}}
if(this._containedObject.attrs[ZaAccount.A_COSId]){
this._containedObject[ZaAccount.A2_autoCos]="FALSE"
}
if(!this._containedObject.attrs[ZaAccount.A_COSId]){
this._containedObject[ZaAccount.A2_autoCos]="TRUE"
}
if(this._containedObject.setAttrs[ZaAccount.A_COSId]){
var f=ZaCos.getCosById(this._containedObject.attrs[ZaAccount.A_COSId]);
this.cosChoices.setChoices([f]);
this.cosChoices.dirtyChoices()
}
this._containedObject[ZaAccount.A2_autodisplayname]=m[ZaAccount.A2_autodisplayname];
this._containedObject[ZaAccount.A2_confirmPassword]=m[ZaAccount.A2_confirmPassword];
if(!m[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=m[ZaModel.currentTab]
}
var s=ZaAccount.getDomain(this._containedObject.name);
var p=ZaDomain.getDomainByName(s);
this._containedObject[ZaAccount.A2_accountTypes]=p.getAccountTypes();
this._containedObject[ZaAccount.A2_currentAccountType]=m[ZaAccount.A2_currentAccountType];
if(!m.getAttrs||m.getAttrs[ZaAccount.A_zimbraAvailableSkin]||m.getAttrs.all){
var c=ZaApp.getInstance().getInstalledSkins();
if(AjxUtil.isEmpty(c)){
if(p&&p.attrs&&!AjxUtil.isEmpty(p.attrs[ZaDomain.A_zimbraAvailableSkin])){
c=p.attrs[ZaDomain.A_zimbraAvailableSkin]
}else{
if(m._defaultValues&&m._defaultValues.attrs&&!AjxUtil.isEmpty(m._defaultValues.attrs[ZaAccount.A_zimbraAvailableSkin])){
c=m._defaultValues.attrs[ZaAccount.A_zimbraAvailableSkin]
}else{
c=[]
}}}else{
if(AjxUtil.isString(c)){
c=[c]
}}
var h=ZaApp.getInstance().getSkinChoices(c);
ZaAccountXFormView.themeChoices.setChoices(h);
ZaAccountXFormView.themeChoices.dirtyChoices()
}
if(!m.getAttrs||m.getAttrs[ZaAccount.A_zimbraZimletAvailableZimlets]||m.getAttrs.all){
var o=ZaZimlet.getAll("extension");
if(!AjxUtil.isEmpty(o)&&o instanceof ZaItemList||o instanceof AjxVector){
o=o.getArray()
}
if(AjxUtil.isEmpty(o)){
if(p&&p.attrs&&!AjxUtil.isEmpty(p.attrs[ZaDomain.A_zimbraZimletDomainAvailableZimlets])){
o=p.attrs[ZaDomain.A_zimbraZimletDomainAvailableZimlets]
}else{
if(m._defaultValues&&m._defaultValues.attrs&&!AjxUtil.isEmpty(m._defaultValues.attrs[ZaAccount.A_zimbraZimletAvailableZimlets])){
o=m._defaultValues.attrs[ZaAccount.A_zimbraZimletAvailableZimlets]
}else{
o=[]
}}
ZaAccountXFormView.zimletChoices.setChoices(o);
ZaAccountXFormView.zimletChoices.dirtyChoices()
}else{
var n=o.length;
var d=[];
for(var r=0;
r<n;
r++){
var e=o[r];
d.push(e.name)
}
ZaAccountXFormView.zimletChoices.setChoices(d);
ZaAccountXFormView.zimletChoices.dirtyChoices()
}}
if(p&&p.attrs&&p.attrs[ZaDomain.A_AuthMech]&&(p.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra)){
this._containedObject[ZaAccount.A2_isExternalAuth]=true
}else{
this._containedObject[ZaAccount.A2_isExternalAuth]=false
}
if(ZaItem.modelExtensions.ZaAccount){
for(var r=0;
r<ZaItem.modelExtensions.ZaAccount.length;
r++){
var t=ZaItem.modelExtensions.ZaAccount[r];
if(m[t]){
if(m[t] instanceof Array){
this._containedObject[t]=ZaItem.deepCloneListItem(m[t]);
if(m[t]._version){
this._containedObject[t]._version=m[t]._version
}}else{
this._containedObject[t]={};
for(var u in m[t]){
var l=this._localXForm.getModel().getItem(u);
if((l!=null&&l.type==_LIST_)||(m[t][u]!=null&&m[t][u] instanceof Array)){
this._containedObject[t][u]=ZaItem.deepCloneListItem(m[t][u])
}else{
this._containedObject[t][u]=m[t][u]
}}}}}}
this.modifyContainedObject();
this._localXForm.setInstance(this._containedObject);
this.formDirtyLsnr=new AjxListener(ZaApp.getInstance().getCurrentController(),ZaXFormViewController.prototype.handleXFormChange);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,this.formDirtyLsnr);
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,this.formDirtyLsnr)
};
ZaAccountXFormView.gotNoSkins=function(){
return !ZaAccountXFormView.gotSkins.call(this)
};
ZaAccountXFormView.gotSkins=function(){
return(((ZaApp.getInstance()!=null)&&(ZaApp.getInstance().getInstalledSkins()!=null)&&(ZaApp.getInstance().getInstalledSkins().length>0))||!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A_zimbraAvailableSkin))||!AjxUtil.isEmpty(this.getInstance()._defaultValues.attrs[ZaAccount.A_zimbraAvailableSkin]))
};
ZaAccountXFormView.preProcessCOS=function(o,e){
var n=o;
if(ZaItem.ID_PATTERN.test(o)){
n=o
}else{
var t=ZaCos.getCosByName(o);
if(t){
n=t.id
}}
return n
};
ZaAccountXFormView.accountTypeItemId="account_type_output_"+Dwt.getNextId();
ZaAccountXFormView.prototype.updateAccountType=function(){
var e=this._localXForm.getItemsById(ZaAccountXFormView.accountTypeItemId)[0];
e.updateElement(ZaAccount.getAccountTypeOutput.call(e,true))
};
ZaAccountXFormView.cosGroupItemId="cos_grouper_"+Dwt.getNextId();
ZaAccountXFormView.prototype.updateCosGrouper=function(){
var e=this._localXForm.getItemsById(ZaAccountXFormView.cosGroupItemId)[0];
e.items[0].setElementEnabled(true);
e.updateElement()
};
ZaAccountXFormView.isSendingFromAnyAddressDisAllowed=function(){
return(this.getInstanceValue(ZaAccount.A_zimbraAllowAnyFromAddress)!="TRUE")
};
ZaAccountXFormView.aliasSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_alias_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_alias_selection_cache,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountXFormView.editAliasButtonListener.call(this)
}};
ZaAccountXFormView.nonMemberOfSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_nonMemberListSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_nonMemberListSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountMemberOfListView._addSelectedLists(this.getForm(),e)
}};
ZaAccountXFormView.directMemberOfSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_directMemberListSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_directMemberListSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountMemberOfListView._removeSelectedLists(this.getForm(),e)
}};
ZaAccountXFormView.indirectMemberOfSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_indirectMemberListSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_indirectMemberListSelected,null)
}};
ZaAccountXFormView.isEditAliasEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_alias_selection_cache))&&this.getInstanceValue(ZaAccount.A2_alias_selection_cache).length==1)
};
ZaAccountXFormView.isDeleteAliasEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_alias_selection_cache)))
};
ZaAccountXFormView.deleteAliasButtonListener=function(){
var e=this.getInstance();
if(e[ZaAccount.A2_alias_selection_cache]!=null){
var s=e[ZaAccount.A2_alias_selection_cache].length;
if(s&&e.attrs[ZaAccount.A_zimbraMailAlias]){
var o=e.attrs[ZaAccount.A_zimbraMailAlias];
for(var n=0;
n<s;
n++){
var r=o.length-1;
for(var t=r;
t>=0;
t--){
if(o[t]==e[ZaAccount.A2_alias_selection_cache][n]){
o.splice(t,1);
break
}}}
this.getModel().setInstanceValue(e,ZaAccount.A_zimbraMailAlias,o)
}}
this.getModel().setInstanceValue(e,ZaAccount.A2_alias_selection_cache,[]);
this.getForm().parent.setDirty(true)
};
ZaAccountXFormView.editAliasButtonListener=function(){
var e=this.getInstance();
if(e.alias_selection_cache&&e.alias_selection_cache[0]){
var s=this.getForm().parent;
if(!s.editAliasDlg){
s.editAliasDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Edit_Alias_Title);
s.editAliasDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.updateAlias,this.getForm(),null)
}
var n={};
n[ZaAccount.A_name]=e[ZaAccount.A2_alias_selection_cache][0];
var o=e.attrs[ZaAccount.A_zimbraMailAlias].length;
for(var t=0;
t<o;
t++){
if(e[ZaAccount.A2_alias_selection_cache][0]==e.attrs[ZaAccount.A_zimbraMailAlias][t]){
n[ZaAlias.A_index]=t;
break
}}
s.editAliasDlg.setObject(n);
s.editAliasDlg.popup()
}};
ZaAccountXFormView.updateAlias=function(){
if(this.parent.editAliasDlg){
this.parent.editAliasDlg.popdown();
var n=this.parent.editAliasDlg.getObject();
var c=this.getInstance();
var s=c.attrs[ZaAccount.A_zimbraMailAlias];
if(n[ZaAlias.A_index]>=0&&s[n[ZaAlias.A_index]]!=n[ZaAccount.A_name]){
var o;
var t=ZaAccount.getDomain(n[ZaAccount.A_name]);
try{
o=ZaDomain.getDomainByName(t)
}
catch(h){}
if(!o||!ZaItem.hasRight(ZaDomain.RIGHT_CREATE_ALIAS,o)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_PERMISSION_CREATE_ALIAS,[t]))
}else{
var e=null;
e=ZaApp.getInstance().getControllerById(this.parent.__internalId);
var r=null;
if(e){
r=e._findAlias(n[ZaAccount.A_name])
}
if(r){
var l=null;
switch(r.type){
case ZaItem.DL:if(r.name==n[ZaAccount.A_name]){
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS3,[r.name])
}else{
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS4,[r.name,n[ZaAccount.A_name]])
}
break;
case ZaItem.ACCOUNT:if(r.name==n[ZaAccount.A_name]){
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS2,[r.name])
}else{
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS1,[r.name,n[ZaAccount.A_name]])
}
break;
case ZaItem.RESOURCE:if(r.name==n[ZaAccount.A_name]){
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS5,[r.name])
}else{
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS6,[r.name,n[ZaAccount.A_name]])
}
break;
default:l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS0,[n[ZaAccount.A_name]]);
break
}
ZaApp.getInstance().getCurrentController().popupErrorDialog(l)
}else{
s[n[ZaAlias.A_index]]=n[ZaAccount.A_name];
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraMailAlias,s);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_alias_selection_cache,new Array());
this.parent.setDirty(true)
}}}}};
ZaAccountXFormView.addAliasButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addAliasDlg){
o.addAliasDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Add_Alias_Title);
o.addAliasDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.addAlias,this.getForm(),null)
}
var t={};
t[ZaAccount.A_name]="";
t[ZaAlias.A_index]=-1;
o.addAliasDlg.setObject(t);
o.addAliasDlg.popup()
};
ZaAccountXFormView.addAlias=function(){
if(this.parent.addAliasDlg){
this.parent.addAliasDlg.popdown();
var n=this.parent.addAliasDlg.getObject();
if(n[ZaAccount.A_name]&&n[ZaAccount.A_name].length>1){
var o;
var t=ZaAccount.getDomain(n[ZaAccount.A_name]);
try{
o=ZaDomain.getDomainByName(t)
}
catch(h){}
if(!o||!ZaItem.hasRight(ZaDomain.RIGHT_CREATE_ALIAS,o)){
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_PERMISSION_CREATE_ALIAS,[t]))
}else{
var e=null;
e=ZaApp.getInstance().getControllerById(this.parent.__internalId);
var r=null;
if(e){
r=e._findAlias(n[ZaAccount.A_name])
}
if(r){
var l=null;
switch(r.type){
case ZaItem.DL:if(r.name==n[ZaAccount.A_name]){
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS3,[r.name])
}else{
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS4,[r.name,n[ZaAccount.A_name]])
}
break;
case ZaItem.ACCOUNT:if(r.name==n[ZaAccount.A_name]){
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS2,[r.name])
}else{
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS1,[r.name,n[ZaAccount.A_name]])
}
break;
case ZaItem.RESOURCE:if(r.name==n[ZaAccount.A_name]){
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS5,[r.name])
}else{
l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS6,[r.name,n[ZaAccount.A_name]])
}
break;
default:l=AjxMessageFormat.format(ZaMsg.WARNING_EACH_ALIAS0,[n[ZaAccount.A_name]]);
break
}
ZaApp.getInstance().getCurrentController().popupErrorDialog(l)
}else{
var c=this.getInstance();
var s=c.attrs[ZaAccount.A_zimbraMailAlias];
s.push(n[ZaAccount.A_name]);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraMailAlias,s);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_alias_selection_cache,new Array());
this.parent.setDirty(true)
}}}}};
ZaAccountXFormView.isAuthfromInternal=function(n){
var o=true;
var t=null;
var s=n.split("@");
if(s.length==2){
t=s[1]
}else{
t=s[0]
}
if(t){
var e=ZaDomain.getDomainByName(t);
if(e.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra){
o=false
}
if(!o&&e.attrs[ZaDomain.A_zimbraAuthFallbackToLocal]=="TRUE"){
o=true
}}
return o
};
ZaAccountXFormView.isAuthfromInternalSync=function(o,t){
var n=null;
if(t){
var e=this.getInstance();
if(e){
n=this.getInstanceValue(t)
}}
if(!n){
n=o
}
return ZaAccountXFormView.isAuthfromInternal(n)
};
ZaAccountXFormView.isEditFwdAddrEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_fwdAddr_selection_cache))&&this.getInstanceValue(ZaAccount.A2_fwdAddr_selection_cache).length==1)
};
ZaAccountXFormView.isDeleteFwdAddrEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_fwdAddr_selection_cache)))
};
ZaAccountXFormView.isEditCalFwdAddrEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_calFwdAddr_selection_cache))&&this.getInstanceValue(ZaAccount.A2_calFwdAddr_selection_cache).length==1)
};
ZaAccountXFormView.isDeleteCalFwdAddrEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_calFwdAddr_selection_cache)))
};
ZaAccountXFormView.deleteFwdAddrButtonListener=function(){
var t=this.getInstance();
if(t[ZaAccount.A2_fwdAddr_selection_cache]!=null){
var s=t[ZaAccount.A2_fwdAddr_selection_cache].length;
if(s&&t.attrs[ZaAccount.A_zimbraMailForwardingAddress]){
var e=t.attrs[ZaAccount.A_zimbraMailForwardingAddress];
for(var n=0;
n<s;
n++){
var r=e.length-1;
for(var o=r;
o>=0;
o--){
if(e[o]==t[ZaAccount.A2_fwdAddr_selection_cache][n]){
e.splice(o,1);
break
}}}
this.getModel().setInstanceValue(t,ZaAccount.A_zimbraMailForwardingAddress,e);
this.getModel().setInstanceValue(t,ZaAccount.A2_fwdAddr_selection_cache,[])
}}
this.getForm().parent.setDirty(true)
};
ZaAccountXFormView.deleteCalFwdAddrButtonListener=function(){
var t=this.getInstance();
if(t[ZaAccount.A2_calFwdAddr_selection_cache]!=null){
var s=t[ZaAccount.A2_calFwdAddr_selection_cache].length;
if(s&&t.attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]){
var e=t.attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo];
for(var n=0;
n<s;
n++){
var r=e.length-1;
for(var o=r;
o>=0;
o--){
if(e[o]==t[ZaAccount.A2_calFwdAddr_selection_cache][n]){
e.splice(o,1);
break
}}}
this.getModel().setInstanceValue(t,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo,e);
this.getModel().setInstanceValue(t,ZaAccount.A2_calFwdAddr_selection_cache,[])
}}
this.getForm().parent.setDirty(true)
};
ZaAccountXFormView.fwdAddrSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fwdAddr_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fwdAddr_selection_cache,[])
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountXFormView.editFwdAddrButtonListener.call(this)
}};
ZaAccountXFormView.calFwdAddrSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_calFwdAddr_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_calFwdAddr_selection_cache,[])
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountXFormView.editCalFwdAddrButtonListener.call(this)
}};
ZaAccountXFormView.editFwdAddrButtonListener=function(){
var e=this.getInstance();
if(e[ZaAccount.A2_fwdAddr_selection_cache]&&e[ZaAccount.A2_fwdAddr_selection_cache][0]){
var s=this.getForm().parent;
if(!s.editFwdAddrDlg){
s.editFwdAddrDlg=new ZaEditFwdAddrXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Edit_FwdAddr_Title);
s.editFwdAddrDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.updateFwdAddr,this.getForm(),null)
}
var n={};
n[ZaAccount.A_name]=e[ZaAccount.A2_fwdAddr_selection_cache][0];
var o=e.attrs[ZaAccount.A_zimbraMailForwardingAddress].length;
for(var t=0;
t<o;
t++){
if(e.fwdAddr_selection_cache[0]==e.attrs[ZaAccount.A_zimbraMailForwardingAddress][t]){
n[ZaAlias.A_index]=t;
break
}}
s.editFwdAddrDlg.setObject(n);
s.editFwdAddrDlg.popup()
}};
ZaAccountXFormView.editCalFwdAddrButtonListener=function(){
var e=this.getInstance();
if(e[ZaAccount.A2_calFwdAddr_selection_cache]&&e[ZaAccount.A2_calFwdAddr_selection_cache][0]){
var s=this.getForm().parent;
if(!s.editCalFwdAddrDlg){
s.editCalFwdAddrDlg=new ZaEditFwdAddrXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Edit_FwdAddr_Title);
s.editCalFwdAddrDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.updateCalFwdAddr,this.getForm(),null)
}
var n={};
n[ZaAccount.A_name]=e[ZaAccount.A2_calFwdAddr_selection_cache][0];
var o=e.attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo].length;
for(var t=0;
t<o;
t++){
if(e[ZaAccount.A2_calFwdAddr_selection_cache][0]==e.attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo][t]){
n[ZaAlias.A_index]=t;
break
}}
s.editCalFwdAddrDlg.setObject(n);
s.editCalFwdAddrDlg.popup()
}};
ZaAccountXFormView.updateFwdAddr=function(){
if(this.parent.editFwdAddrDlg){
this.parent.editFwdAddrDlg.popdown();
var o=this.parent.editFwdAddrDlg.getObject();
var t=this.getInstance();
var e=t.attrs[ZaAccount.A_zimbraMailForwardingAddress];
if(o[ZaAlias.A_index]>=0&&e[o[ZaAlias.A_index]]!=o[ZaAccount.A_name]){
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fwdAddr_selection_cache,[]);
e[o[ZaAlias.A_index]]=o[ZaAccount.A_name];
this.getModel().setInstanceValue(t,ZaAccount.A_zimbraMailForwardingAddress,e);
this.parent.setDirty(true)
}}};
ZaAccountXFormView.updateCalFwdAddr=function(){
if(this.parent.editCalFwdAddrDlg){
this.parent.editCalFwdAddrDlg.popdown();
var o=this.parent.editCalFwdAddrDlg.getObject();
var t=this.getInstance();
var e=t.attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo];
if(o[ZaAlias.A_index]>=0&&e[o[ZaAlias.A_index]]!=o[ZaAccount.A_name]){
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_calFwdAddr_selection_cache,[]);
e[o[ZaAlias.A_index]]=o[ZaAccount.A_name];
this.getModel().setInstanceValue(t,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo,e);
this.parent.setDirty(true)
}}};
ZaAccountXFormView.addFwdAddrButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addFwdAddrDlg){
o.addFwdAddrDlg=new ZaEditFwdAddrXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Add_FwdAddr_Title);
o.addFwdAddrDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.addFwdAddr,this.getForm(),null)
}
var t={};
t[ZaAccount.A_name]="";
t[ZaAlias.A_index]=-1;
o.addFwdAddrDlg.setObject(t);
o.addFwdAddrDlg.popup()
};
ZaAccountXFormView.addCalFwdAddrButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addCalFwdAddrDlg){
o.addCalFwdAddrDlg=new ZaEditFwdAddrXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Add_FwdAddr_Title);
o.addCalFwdAddrDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.addCalFwdAddr,this.getForm(),null)
}
var t={};
t[ZaAccount.A_name]="";
t[ZaAlias.A_index]=-1;
o.addCalFwdAddrDlg.setObject(t);
o.addCalFwdAddrDlg.popup()
};
ZaAccountXFormView.addFwdAddr=function(){
if(this.parent.addFwdAddrDlg){
this.parent.addFwdAddrDlg.popdown();
var t=this.parent.addFwdAddrDlg.getObject();
if(t[ZaAccount.A_name]&&t[ZaAccount.A_name].length>1){
var e=this.getInstance().attrs[ZaAccount.A_zimbraMailForwardingAddress];
e.push(t[ZaAccount.A_name]);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraMailForwardingAddress,e);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fwdAddr_selection_cache,[]);
this.parent.setDirty(true)
}}};
ZaAccountXFormView.addCalFwdAddr=function(){
if(this.parent.addCalFwdAddrDlg){
this.parent.addCalFwdAddrDlg.popdown();
var t=this.parent.addCalFwdAddrDlg.getObject();
if(t[ZaAccount.A_name]&&t[ZaAccount.A_name].length>1){
var e=this.getInstance().attrs[ZaAccount.A_zimbraPrefCalendarForwardInvitesTo];
e.push(t[ZaAccount.A_name]);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraPrefCalendarForwardInvitesTo,e);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_calFwdAddr_selection_cache,[]);
this.parent.setDirty(true)
}}};
ZaAccountXFormView.fpSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fp_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fp_selection_cache,[])
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountXFormView.editFpButtonListener.call(this)
}};
ZaAccountXFormView.isEditFpEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_fp_selection_cache))&&this.getInstanceValue(ZaAccount.A2_fp_selection_cache).length==1&&!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A_zimbraForeignPrincipal)))
};
ZaAccountXFormView.isDeleteFpEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_fp_selection_cache)))
};
ZaAccountXFormView.isPushFpEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A_zimbraForeignPrincipal)))
};
ZaAccountXFormView.deleteFpButtonListener=function(){
var t=this.getInstance();
if(!AjxUtil.isEmpty(t.fp_selection_cache)){
var s=t.fp_selection_cache.length;
var e=t.attrs[ZaAccount.A_zimbraForeignPrincipal];
if(s&&!AjxUtil.isEmpty(e)){
for(var n=0;
n<s;
n++){
var r=e.length-1;
for(var o=r;
o>=0;
o--){
if(e[o]==t.fp_selection_cache[n]){
e.splice(o,1);
break
}}}
this.getModel().setInstanceValue(t,ZaAccount.A_zimbraForeignPrincipal,e);
this.getModel().setInstanceValue(t,ZaAccount.A2_fp_selection_cache,[])
}}
this.getForm().parent.setDirty(true)
};
ZaAccountXFormView.editFpButtonListener=function(){
var e=this.getInstance();
if(e.fp_selection_cache&&e.fp_selection_cache[0]){
var s=this.getForm().parent;
if(!s.editFpDlg){
s.editFpDlg=new ZaEditFpXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Edit_Fp_Title);
s.editFpDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.updateFp,this.getForm(),null)
}
var n=ZaFp.getObject(e.fp_selection_cache[0]);
var o=e.attrs[ZaAccount.A_zimbraForeignPrincipal].length;
for(var t=0;
t<o;
t++){
if(e.fp_selection_cache[0]==e.attrs[ZaAccount.A_zimbraForeignPrincipal][t]){
n[ZaFp.A_index]=t;
break
}}
s.editFpDlg.setObject(n);
s.editFpDlg.popup()
}};
ZaAccountXFormView.pushFpButtonListener=function(){
var e=this.getInstance();
if(this.getForm().parent.isDirty()){
ZaApp.getInstance().getCurrentController().popupMsgDialog(ZaMsg.DIRTY_SAVE_ACCT,true)
}else{
if(e.attrs[ZaAccount.A_zimbraForeignPrincipal].length>0){
ZaFp.push(e.id)
}}};
ZaAccountXFormView.updateFp=function(){
if(this.parent.editFpDlg){
this.parent.editFpDlg.popdown();
var t=this.parent.editFpDlg.getObject();
var e=this.getInstance().attrs[ZaAccount.A_zimbraForeignPrincipal];
if(t[ZaFp.A_index]>=0&&e[t[ZaFp.A_index]]!=ZaFp.getEntry(t)){
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fp_selection_cache,[]);
e[t[ZaFp.A_index]]=ZaFp.getEntry(t);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraForeignPrincipal,e);
this.parent.setDirty(true)
}}};
ZaAccountXFormView.addFpButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addFpDlg){
o.addFpDlg=new ZaEditFpXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Add_Fp_Title);
o.addFpDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.addFp,this.getForm(),null)
}
var t={};
t[ZaFp.A_prefix]="";
t[ZaFp.A_name]="";
t[ZaFp.A_index]=-1;
o.addFpDlg.setObject(t);
o.addFpDlg.popup()
};
ZaAccountXFormView.addFp=function(){
if(this.parent.addFpDlg){
var t=this.parent.addFpDlg.getObject();
var o=this.parent._app;
var e=this.getInstance().attrs[ZaAccount.A_zimbraForeignPrincipal];
if(ZaFp.findDupPrefixFp(e,t[ZaFp.A_prefix])){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ONE_FP_PREFIX_ALLOWED,null)
}else{
this.parent.addFpDlg.popdown();
if(ZaFp.getEntry(t).length>0){
e.push(ZaFp.getEntry(t));
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraForeignPrincipal,e);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A2_fp_selection_cache,[]);
this.parent.setDirty(true)
}}}};
ZaAccountXFormView.isDomainLeftAccountsAlertVisible=function(){
var t=this.getInstanceValue(ZaAccount.A2_domainLeftAccounts);
var e=this.getInstanceValue(ZaAccount.A2_accountTypes);
return(!AjxUtil.isEmpty(t)&&AjxUtil.isEmpty(e))
};
ZaAccountXFormView.isAccountTypeGrouperVisible=function(){
return !AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_accountTypes))
};
ZaAccountXFormView.isAccountsTypeAlertInvisible=function(){
var e=this.getInstanceValue(ZaAccount.A2_showAccountTypeMsg);
return(AjxUtil.isEmpty(e))
};
ZaAccountXFormView.isAccountTypeSet=function(){
return !ZaAccount.isAccountTypeSet(this.getInstance())
};
ZaAccountXFormView.CONTACT_TAB_ATTRS=[ZaAccount.A_telephoneNumber,ZaAccount.A_homePhone,ZaAccount.A_mobile,ZaAccount.A_pager,ZaAccount.A_company,ZaAccount.A_title,ZaAccount.A_facsimileTelephoneNumber,ZaAccount.A_street,ZaAccount.A_city,ZaAccount.A_state,ZaAccount.A_zip,ZaAccount.A_country];
ZaAccountXFormView.CONTACT_TAB_RIGHTS=[];
ZaAccountXFormView.ACCOUNT_NAME_GROUP_ATTRS=[ZaAccount.A_name,ZaAccount.A_firstName,ZaAccount.A_initials,ZaAccount.A_lastName,ZaAccount.A_displayname,ZaAccount.A_zimbraHideInGal];
ZaAccountXFormView.MEMBEROF_TAB_ATTRS=[];
ZaAccountXFormView.MEMBEROF_TAB_RIGHTS=[ZaAccount.GET_ACCOUNT_MEMBERSHIP_RIGHT];
ZaAccountXFormView.FEATURE_TAB_ATTRS=[ZaAccount.A_zimbraFeatureManageZimlets,ZaAccount.A_zimbraFeatureReadReceiptsEnabled,ZaAccount.A_zimbraFeatureMailEnabled,ZaAccount.A_zimbraFeatureContactsEnabled,ZaAccount.A_zimbraFeatureDistributionListFolderEnabled,ZaAccount.A_zimbraFeatureCalendarEnabled,ZaAccount.A_zimbraFeatureTasksEnabled,ZaAccount.A_zimbraFeatureBriefcasesEnabled,ZaAccount.A_zimbraFeatureOptionsEnabled,ZaAccount.A_zimbraFeatureTaggingEnabled,ZaAccount.A_zimbraFeatureSharingEnabled,ZaAccount.A_zimbraExternalSharingEnabled,ZaAccount.A_zimbraSharingEnabled,ZaAccount.A_zimbraFeatureChangePasswordEnabled,ZaAccount.A_zimbraFeatureSkinChangeEnabled,ZaAccount.A_zimbraFeatureHtmlComposeEnabled,ZaAccount.A_zimbraFeatureGalEnabled,ZaAccount.A_zimbraFeatureMAPIConnectorEnabled,ZaAccount.A_zimbraFeatureEwsEnabled,ZaAccount.A_zimbraFeatureTouchClientEnabled,ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled,ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled,ZaAccount.A_zimbraFeatureMailPriorityEnabled,ZaAccount.A_zimbraFeatureFlaggingEnabled,ZaAccount.A_zimbraImapEnabled,ZaAccount.A_zimbraPop3Enabled,ZaAccount.A_zimbraFeatureImapDataSourceEnabled,ZaAccount.A_zimbraFeaturePop3DataSourceEnabled,ZaAccount.A_zimbraFeatureMailSendLaterEnabled,ZaAccount.A_zimbraFeatureConversationsEnabled,ZaAccount.A_zimbraFeatureFiltersEnabled,ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled,ZaAccount.A_zimbraFeatureNewMailNotificationEnabled,ZaAccount.A_zimbraFeatureIdentitiesEnabled,ZaAccount.A_zimbraFeatureGroupCalendarEnabled,ZaAccount.A_zimbraFeaturePeopleSearchEnabled,ZaAccount.A_zimbraFeatureAdvancedSearchEnabled,ZaAccount.A_zimbraFeatureSavedSearchesEnabled,ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled,ZaAccount.A_zimbraFeatureImportFolderEnabled,ZaAccount.A_zimbraFeatureExportFolderEnabled,ZaAccount.A_zimbraDumpsterEnabled,ZaAccount.A_zimbraDumpsterPurgeEnabled,ZaAccount.A_zimbraFeatureSMIMEEnabled,ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled];
ZaAccountXFormView.FEATURE_TAB_RIGHTS=[];
ZaAccountXFormView.PREFERENCES_TAB_ATTRS=[ZaAccount.A_zimbraPrefReadReceiptsToAddress,ZaAccount.A_zimbraPrefMailSendReadReceipts,ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar,ZaAccount.A_zimbraPrefCalendarUseQuickAdd,ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal,ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime,ZaAccount.A_zimbraPrefTimeZoneId,ZaAccount.A_zimbraPrefGalAutoCompleteEnabled,ZaAccount.A_zimbraPrefAutoAddAddressEnabled,ZaAccount.A_zimbraPrefMailSignature,ZaAccount.A_zimbraMailSignatureMaxLength,ZaAccount.A_zimbraPrefMailSignatureEnabled,ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize,ZaAccount.A_zimbraPrefComposeFormat,ZaAccount.A_zimbraPrefComposeInNewWindow,ZaAccount.A_zimbraAllowFromAddress,ZaAccount.A_zimbraAllowAnyFromAddress,ZaAccount.A_zimbraPrefSaveToSent,ZaAccount.A_zimbraPrefOutOfOfficeReply,ZaAccount.A_zimbraPrefNewMailNotificationAddress,ZaAccount.A_zimbraPrefNewMailNotificationEnabled,ZaAccount.A_zimbraMailMinPollingInterval,ZaAccount.A_zimbraPrefMailPollingInterval,ZaAccount.A_zimbraPrefAutoSaveDraftInterval,ZaAccount.A_zimbraPrefMailSoundsEnabled,ZaAccount.A_zimbraPrefMailFlashIcon,ZaAccount.A_zimbraPrefMailFlashTitle,ZaAccount.A_zimbraPrefMailDefaultCharset,ZaAccount.A_zimbraMaxMailItemsPerPage,ZaAccount.A_zimbraPrefMailItemsPerPage,ZaAccount.A_zimbraPrefGroupMailBy,ZaAccount.A_zimbraPrefDisplayExternalImages,ZaAccount.A_zimbraPrefMessageViewHtmlPreferred,ZaAccount.A_zimbraPrefLocale,ZaAccount.A_zimbraJunkMessagesIndexingEnabled,ZaAccount.A_zimbraPrefShowSelectionCheckbox,ZaAccount.A_zimbraPrefWarnOnExit,ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit,ZaAccount.A_zimbraPrefUseKeyboardShortcuts,ZaAccount.A_zimbraPrefImapSearchFoldersEnabled,ZaAccount.A_zimbraPrefShowSearchString,ZaAccount.A_zimbraPrefMailInitialSearch,ZaAccount.A_zimbraPrefClientType,ZaAccount.A_zimbraPrefCalendarInitialView,ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek,ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges,ZaAccount.A_zimbraPrefCalendarApptVisibility,ZaAccount.A_zimbraPrefCalendarAutoAddInvites,ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled,ZaAccount.A_zimbraPrefCalendarReminderFlashTitle,ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite,ZaAccount.A_zimbraPrefCalendarAllowPublishMethodInvite,ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf,ZaAccount.A_zimbraPrefCalendarToasterEnabled,ZaAccount.A_zimbraPrefCalendarShowPastDueReminders,ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled,ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled];
ZaAccountXFormView.PREFERENCES_TAB_RIGHTS=[];
ZaAccountXFormView.ALIASES_TAB_ATTRS=[ZaAccount.A_zimbraMailAlias];
ZaAccountXFormView.ALIASES_TAB_RIGHTS=[ZaAccount.ADD_ACCOUNT_ALIAS_RIGHT,ZaAccount.REMOVE_ACCOUNT_ALIAS_RIGHT];
ZaAccountXFormView.FORWARDING_TAB_ATTRS=[ZaAccount.A_zimbraFeatureMailForwardingEnabled,ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled,ZaAccount.A_zimbraMailForwardingAddress,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo];
ZaAccountXFormView.FORWARDING_TAB_RIGHTS=[];
ZaAccountXFormView.INTEROP_TAB_ATTRS=[ZaAccount.A_zimbraForeignPrincipal];
ZaAccountXFormView.INTEROP_TAB_RIGHTS=[];
ZaAccountXFormView.SKIN_TAB_ATTRS=[ZaAccount.A_zimbraPrefSkin,ZaAccount.A_zimbraAvailableSkin];
ZaAccountXFormView.SKIN_TAB_RIGHTS=[];
ZaAccountXFormView.ZIMLET_TAB_ATTRS=[ZaAccount.A_zimbraZimletAvailableZimlets];
ZaAccountXFormView.ZIMLET_TAB_RIGHTS=[];
ZaAccountXFormView.ADVANCED_TAB_ATTRS=[ZaAccount.A_zimbraAttachmentsBlocked,ZaAccount.A_zimbraMailQuota,ZaAccount.A_zimbraContactMaxNumEntries,ZaAccount.A_zimbraQuotaWarnPercent,ZaAccount.A_zimbraQuotaWarnInterval,ZaAccount.A_zimbraQuotaWarnMessage,ZaAccount.A_zimbraPasswordLocked,ZaAccount.A_zimbraMinPwdLength,ZaAccount.A_zimbraMaxPwdLength,ZaAccount.A_zimbraPasswordMinUpperCaseChars,ZaAccount.A_zimbraPasswordMinLowerCaseChars,ZaAccount.A_zimbraPasswordMinPunctuationChars,ZaAccount.A_zimbraPasswordMinNumericChars,ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,ZaAccount.A_zimbraMinPwdAge,ZaAccount.A_zimbraMaxPwdAge,ZaAccount.A_zimbraEnforcePwdHistory,ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_zimbraPasswordLockoutMaxFailures,ZaAccount.A_zimbraPasswordLockoutDuration,ZaAccount.A_zimbraPasswordLockoutFailureLifetime,ZaAccount.A_zimbraAdminAuthTokenLifetime,ZaAccount.A_zimbraAuthTokenLifetime,ZaAccount.A_zimbraMailIdleSessionTimeout,ZaAccount.A_zimbraMailMessageLifetime,ZaAccount.A_zimbraMailTrashLifetime,ZaAccount.A_zimbraMailSpamLifetime,ZaAccount.A_zimbraDumpsterUserVisibleAge,ZaAccount.A_zimbraMailDumpsterLifetime,ZaAccount.A_zimbraFreebusyExchangeUserOrg,ZaAccount.A_zimbraMailCanonicalAddress,ZaAccount.A_zimbraMailTransport];
ZaAccountXFormView.ADVANCED_TAB_RIGHTS=[];
ZaAccountXFormView.addressItemsPool=null;
ZaAccountXFormView.addressItemsPoolForDialog=null;
ZaAccountXFormView.getAddressFormItem=function(){
if(AjxUtil.isEmpty(ZaAccountXFormView.addressItemsPool)){
ZaAccountXFormView.addressItemsPool=new Object();
ZaAccountXFormView.addressItemsPool[ZaAccount.A_zip]={
ref:ZaAccount.A_zip,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zip,label:ZaMsg.NAD_zip,labelLocation:_LEFT_,width:100};
ZaAccountXFormView.addressItemsPool[ZaAccount.A_state]={
ref:ZaAccount.A_state,type:_TEXTFIELD_,msgName:ZaMsg.NAD_state,label:ZaMsg.NAD_state,labelLocation:_LEFT_,width:250};
ZaAccountXFormView.addressItemsPool[ZaAccount.A_street]={
ref:ZaAccount.A_street,type:_TEXTAREA_,msgName:ZaMsg.NAD_street,label:ZaMsg.NAD_street,labelLocation:_LEFT_,width:250};
ZaAccountXFormView.addressItemsPool[ZaAccount.A_city]={
ref:ZaAccount.A_city,type:_TEXTFIELD_,msgName:ZaMsg.NAD_city,label:ZaMsg.NAD_city,labelLocation:_LEFT_,width:250};
ZaAccountXFormView.addressItemsPool[ZaAccount.A_country]={
ref:ZaAccount.A_country,type:_TEXTFIELD_,msgName:ZaMsg.NAD_country,label:ZaMsg.NAD_country,labelLocation:_LEFT_,width:250}
}
var e=new Array();
var o=new Array();
if(ZaZimbraAdmin.isLanguage("ja")){
o=[ZaAccount.A_zip,ZaAccount.A_state,ZaAccount.A_city,ZaAccount.A_street,ZaAccount.A_country]
}else{
o=[ZaAccount.A_street,ZaAccount.A_city,ZaAccount.A_state,ZaAccount.A_zip,ZaAccount.A_country]
}
for(var t=0;
t<o.length;
t++){
e.push(ZaAccountXFormView.addressItemsPool[o[t]])
}
return e
};
ZaAccountXFormView.getAddressFormItemForDialog=function(){
if(AjxUtil.isEmpty(ZaAccountXFormView.addressItemsPoolForDialog)){
ZaAccountXFormView.addressItemsPoolForDialog=new Object();
ZaAccountXFormView.addressItemsPoolForDialog[ZaAccount.A_zip]={
ref:ZaAccount.A_zip,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zip,label:ZaMsg.NAD_zip,labelLocation:_LEFT_,width:100};
ZaAccountXFormView.addressItemsPoolForDialog[ZaAccount.A_state]={
ref:ZaAccount.A_state,type:_TEXTFIELD_,msgName:ZaMsg.NAD_state,label:ZaMsg.NAD_state,labelLocation:_LEFT_,width:250};
ZaAccountXFormView.addressItemsPoolForDialog[ZaAccount.A_street]={
ref:ZaAccount.A_street,type:_TEXTAREA_,msgName:ZaMsg.NAD_street,label:ZaMsg.NAD_street,labelLocation:_LEFT_,width:250};
ZaAccountXFormView.addressItemsPoolForDialog[ZaAccount.A_city]={
ref:ZaAccount.A_city,type:_TEXTFIELD_,msgName:ZaMsg.NAD_city,label:ZaMsg.NAD_city,labelLocation:_LEFT_,width:250};
ZaAccountXFormView.addressItemsPoolForDialog[ZaAccount.A_country]={
ref:ZaAccount.A_country,type:_TEXTFIELD_,msgName:ZaMsg.NAD_country,label:ZaMsg.NAD_country,labelLocation:_LEFT_,width:250}
}
var e=new Array();
var o=new Array();
if(ZaZimbraAdmin.isLanguage("ja")){
o=[ZaAccount.A_zip,ZaAccount.A_state,ZaAccount.A_city,ZaAccount.A_street,ZaAccount.A_country]
}else{
o=[ZaAccount.A_street,ZaAccount.A_city,ZaAccount.A_state,ZaAccount.A_zip,ZaAccount.A_country]
}
for(var t=0;
t<o.length;
t++){
e.push(ZaAccountXFormView.addressItemsPoolForDialog[o[t]])
}
return e
};
ZaAccountXFormView.accountNameInfoPool=null;
ZaAccountXFormView.getAccountNameInfoItem=function(){
if(AjxUtil.isEmpty(ZaAccountXFormView.accountNameInfoPool)){
ZaAccountXFormView.accountNameInfoPool=new Object();
ZaAccountXFormView.accountNameInfoPool[ZaAccount.A_name]={
ref:ZaAccount.A_name,type:_EMAILADDR_,msgName:ZaMsg.NAD_AccountName,label:ZaMsg.NAD_AccountName,bmolsnr:false,labelLocation:_LEFT_,onChange:ZaAccount.setDomainChanged,forceUpdate:true,enableDisableChecks:[[ZaItem.hasRight,ZaAccount.RENAME_ACCOUNT_RIGHT]],visibilityChecks:[],domainPartWidth:"100%",domainContainerWidth:"100%"}
,ZaAccountXFormView.accountNameInfoPool[ZaAccount.A_firstName]={
ref:ZaAccount.A_firstName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_FirstName,label:ZaMsg.NAD_FirstName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150,elementChanged:function(r,s,n){
if(this.getInstance()[ZaAccount.A2_autodisplayname]=="TRUE"){
ZaAccount.generateDisplayName.call(this,this.getInstance(),r,this.getInstance().attrs[ZaAccount.A_lastName],this.getInstance().attrs[ZaAccount.A_initials])
}
this.getForm().itemChanged(this,r,n)
}};
ZaAccountXFormView.accountNameInfoPool[ZaAccount.A_initials]={
ref:ZaAccount.A_initials,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Initials,label:ZaMsg.NAD_Initials,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:50,elementChanged:function(r,s,n){
if(this.getInstance()[ZaAccount.A2_autodisplayname]=="TRUE"){
ZaAccount.generateDisplayName.call(this,this.getInstance(),this.getInstanceValue(ZaAccount.A_firstName),this.getInstanceValue(ZaAccount.A_lastName),r)
}
this.getForm().itemChanged(this,r,n)
}};
ZaAccountXFormView.accountNameInfoPool[ZaAccount.A_lastName]={
ref:ZaAccount.A_lastName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_LastName,label:ZaMsg.NAD_LastName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150,elementChanged:function(r,s,n){
if(this.getInstance()[ZaAccount.A2_autodisplayname]=="TRUE"){
ZaAccount.generateDisplayName.call(this,this.getInstance(),this.getInstanceValue(ZaAccount.A_firstName),r,this.getInstanceValue(ZaAccount.A_initials))
}
this.getForm().itemChanged(this,r,n)
}};
ZaAccountXFormView.accountNameInfoPool.ZaAccountDisplayInfoGroup={
type:_GROUP_,numCols:3,nowrap:true,attributeName:ZaAccount.A_displayname,width:200,msgName:ZaMsg.NAD_DisplayName,label:ZaMsg.NAD_DisplayName,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasReadPermission,ZaAccount.A_displayname]],items:[{
ref:ZaAccount.A_displayname,type:_TEXTFIELD_,label:null,cssClass:"admin_xform_name_input",width:150,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A2_autodisplayname,"FALSE"],ZaItem.hasWritePermission],enableDisableChangeEventSources:[ZaAccount.A2_autodisplayname],bmolsnr:true,visibilityChecks:[]}
,{
ref:ZaAccount.A2_autodisplayname,type:_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",subLabel:"",helpTooltip:false,elementChanged:function(r,s,n){
if(r=="TRUE"){
if(ZaAccount.generateDisplayName.call(this,this.getInstance(),this.getInstanceValue(ZaAccount.A_firstName),this.getInstanceValue(ZaAccount.A_lastName),this.getInstanceValue(ZaAccount.A_initials))){
this.getForm().parent.setDirty(true)
}}
this.getForm().itemChanged(this,r,n)
}
,enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_displayname]],visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_displayname]]}
]}
,ZaAccountXFormView.accountNameInfoPool[ZaAccount.A_zimbraHideInGal]={
ref:ZaAccount.A_zimbraHideInGal,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraHideInGal,label:ZaMsg.LBL_zimbraHideInGal,trueValue:"TRUE",falseValue:"FALSE"}
,ZaAccountXFormView.accountNameInfoPool[ZaAccount.A_zimbraPhoneticFirstName]={
ref:ZaAccount.A_zimbraPhoneticFirstName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zimbraPhoneticFirstName,label:ZaMsg.NAD_zimbraPhoneticFirstName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150};
ZaAccountXFormView.accountNameInfoPool[ZaAccount.A_zimbraPhoneticLastName]={
ref:ZaAccount.A_zimbraPhoneticLastName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zimbraPhoneticLastName,label:ZaMsg.NAD_zimbraPhoneticLastName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150}
}
var t=new Array();
var o=new Array();
if(ZaZimbraAdmin.isLanguage("ja")){
o=[ZaAccount.A_name,ZaAccount.A_zimbraPhoneticLastName,ZaAccount.A_lastName,ZaAccount.A_initials,ZaAccount.A_zimbraPhoneticFirstName,ZaAccount.A_firstName,"ZaAccountDisplayInfoGroup",ZaAccount.A_zimbraHideInGal]
}else{
o=[ZaAccount.A_name,ZaAccount.A_firstName,ZaAccount.A_initials,ZaAccount.A_lastName,"ZaAccountDisplayInfoGroup",ZaAccount.A_zimbraHideInGal]
}
for(var e=0;
e<o.length;
e++){
t.push(ZaAccountXFormView.accountNameInfoPool[o[e]])
}
return t
};
ZaAccountXFormView.validatePollingInterval=function(h,t,o){
var c=o.getInstance();
this.setInstanceValue(h);
var n=c.attrs[ZaAccount.A_zimbraPrefMailPollingInterval];
if(!n){
n=c._defaultValues.attrs[ZaAccount.A_zimbraPrefMailPollingInterval]
}
var l=c.attrs[ZaAccount.A_zimbraMailMinPollingInterval];
if(!l){
l=c._defaultValues.attrs[ZaAccount.A_zimbraMailMinPollingInterval]
}
var u=o.getItemsById(ZaAccount.A_zimbraPrefMailPollingInterval)[0];
try{
var d=parseInt(ZaUtil.getLifeTimeInSeconds(n));
var r=parseInt(ZaUtil.getLifeTimeInSeconds(l));
if(d<r){
u.setError(ZaMsg.tt_mailPollingIntervalError+l);
o.parent.setDirty(false)
}else{
u.clearError();
o.parent.setDirty(true)
}}
catch(s){
u.setError(s.message);
o.parent.setDirty(false)
}};
ZaAccountXFormView.myXFormModifier=function(q,n){
var c;
try{
c=ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraDefaultDomainName];
if(!c&&ZaApp.getInstance().getDomainList().size()>0){
c=ZaApp.getInstance().getDomainList().getArray()[0].name
}}
catch(A){
c=ZaSettings.myDomainName;
if(A.code!=ZmCsfeException.SVC_PERM_DENIED){
throw (A)
}}
var l=" @"+c;
var s=[{
type:_AJX_IMAGE_,src:"Person_32",label:null,rowSpan:3,cssStyle:"margin:auto;"}
,{
type:_OUTPUT_,ref:ZaAccount.A_displayname,label:null,cssClass:"AdminTitle",height:"auto",width:350,rowSpan:3,cssStyle:"word-wrap:break-word;overflow:hidden;",visibilityChecks:[ZaItem.hasReadPermission],getDisplayValue:function(D){
return AjxStringUtil.htmlEncode(D)
}}
];
if(ZaItem.hasReadPermission(ZaItem.A_zimbraId,n)){
s.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID}
)
}
if(ZaItem.hasReadPermission(ZaItem.A_zimbraCreateTimestamp,n)){
s.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var D=ZaItem.formatServerTime(this.getInstanceValue());
if(!D){
return ZaMsg.Server_Time_NA
}else{
return D
}}}
)
}
if(!n.isExternal&&ZaItem.hasReadPermission(ZaAccount.A_mailHost,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A_mailHost,labelLocation:_LEFT_,label:ZabMsg.attrDesc_mailHost}
)
}else{
if(n.isExternal&&ZaItem.hasReadPermission(ZaAccount.A_zimbraMailTransport,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A_zimbraMailTransport,labelLocation:_LEFT_,label:ZabMsg.attrDesc_mailHost}
)
}}
if(ZaItem.hasReadPermission(ZaAccount.A_name,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A_name,label:ZaMsg.NAD_Email,labelLocation:_LEFT_,required:false,cssStyle:"word-wrap:break-word;overflow:hidden;"}
)
}
if(ZaItem.hasReadPermission(ZaAccount.A_accountStatus,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A_accountStatus,label:ZaMsg.NAD_AccountStatus,labelLocation:_LEFT_,choices:this.accountStatusChoices}
)
}
if(!n.isExternal){
if(ZaItem.hasReadPermission(ZaAccount.A_zimbraMailQuota,n)&&ZaItem.hasRight(ZaAccount.GET_MAILBOX_INFO_RIGHT,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A2_mbxsize,label:ZaMsg.LBL_quota,getDisplayValue:function(){
var D=this.getInstanceValue();
var F=AjxNumberFormat.getNumberInstance();
if(!D){
D="0"
}else{
D=Number(D/1048576).toFixed(3);
D=F.format(D)
}
var S=this.getInstanceValue(ZaAccount.A_zimbraMailQuota);
if(!S||S=="0"){
S=ZaMsg.Unlimited
}else{
S=F.format(S)
}
if(S==ZaMsg.Unlimited){
return AjxMessageFormat.format(ZaMsg.unlimitedQuotaValueTemplate,[D,S])
}else{
return AjxMessageFormat.format(ZaMsg.quotaValueTemplate,[D,S])
}}
,valueChangeEventSources:[ZaAccount.A_zimbraMailQuota,ZaAccount.A2_mbxsize]}
)
}else{
if(ZaItem.hasReadPermission(ZaAccount.A_zimbraMailQuota,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A_zimbraMailQuota,label:ZaMsg.LBL_assignedQuota,getDisplayValue:function(){
var D=this.getInstanceValue();
if(!D||D=="0"){
D=ZaMsg.Unlimited
}
if(D==ZaMsg.Unlimited){
return AjxMessageFormat.format(ZaMsg.unlimitedAssignedQuotaValueTemplate,[D])
}else{
return AjxMessageFormat.format(ZaMsg.assignedQuotaTemplate,[D])
}}
,bmolsnr:true}
)
}else{
if(ZaItem.hasRight(ZaAccount.GET_MAILBOX_INFO_RIGHT,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A2_mbxsize,label:ZaMsg.LBL_usedQuota,getDisplayValue:function(){
var D=this.getInstanceValue();
if(!D){
D="0"
}else{
D=Number(D/1048576).toFixed(3)
}
return AjxMessageFormat.format(ZaMsg.usedQuotaTemplate,[D])
}
,bmolsnr:true}
)
}}}}
if(ZaItem.hasReadPermission(ZaAccount.A_zimbraLastLogonTimestamp,n)){
s.push({
type:_OUTPUT_,ref:ZaAccount.A_zimbraLastLogonTimestamp,label:ZaMsg.LBL_Last_Login,labelLocation:_LEFT_,getDisplayValue:function(){
var D=this.getInstanceValue();
return ZaAccount.getLastLoginTime(D)
}}
)
}
this.tabChoices=new Array();
var C,B,W,T,z,j,x,k,v,f,u;
this.helpMap={};
C=++this.TAB_INDEX;
this.tabChoices.push({
value:C,label:ZaMsg.TABT_GeneralPage}
);
this.helpMap[C]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/user_interface_features.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.CONTACT_TAB_ATTRS,ZaAccountXFormView.CONTACT_TAB_RIGHTS)){
B=++this.TAB_INDEX;
this.tabChoices.push({
value:B,label:ZaMsg.TABT_ContactInfo}
);
this.helpMap[B]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/user_interface_features.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.MEMBEROF_TAB_ATTRS,ZaAccountXFormView.MEMBEROF_TAB_RIGHTS)){
W=++this.TAB_INDEX;
this.tabChoices.push({
value:W,label:ZaMsg.TABT_MemberOf}
);
this.helpMap[W]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/adding_distribution_lists_to_an_account.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.FEATURE_TAB_ATTRS,ZaAccountXFormView.FEATURE_TAB_RIGHTS)){
T=++this.TAB_INDEX;
this.tabChoices.push({
value:T,label:ZaMsg.TABT_Features}
);
this.helpMap[T]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/user_interface_features.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.PREFERENCES_TAB_ATTRS,ZaAccountXFormView.PREFERENCES_TAB_RIGHTS)){
z=++this.TAB_INDEX;
this.tabChoices.push({
value:z,label:ZaMsg.TABT_Preferences}
);
this.helpMap[z]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/preferences.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.ALIASES_TAB_ATTRS,ZaAccountXFormView.ALIASES_TAB_RIGHTS)){
j=++this.TAB_INDEX;
this.tabChoices.push({
value:j,label:ZaMsg.TABT_Aliases}
);
this.helpMap[j]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/user_interface_features.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.FORWARDING_TAB_ATTRS,ZaAccountXFormView.FORWARDING_TAB_RIGHTS)){
x=++this.TAB_INDEX;
this.tabChoices.push({
value:x,label:ZaMsg.TABT_Forwarding}
);
this.helpMap[x]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/forwarding_mail.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.INTEROP_TAB_ATTRS,ZaAccountXFormView.INTEROP_TAB_RIGHTS)){
k=++this.TAB_INDEX;
this.tabChoices.push({
value:k,label:ZaMsg.TABT_Interop}
);
this.helpMap[k]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/manage_account_free_busy_email_address.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.SKIN_TAB_ATTRS,ZaAccountXFormView.SKIN_TAB_RIGHTS)){
v=++this.TAB_INDEX;
this.tabChoices.push({
value:v,label:ZaMsg.TABT_Themes}
);
this.helpMap[v]=[location.pathname,ZaUtil.HELP_URL,"ui_themes/defining_theme_for_the_zimbra_web_client_ui.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.ZIMLET_TAB_ATTRS,ZaAccountXFormView.ZIMLET_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.tabChoices.push({
value:f,label:ZaMsg.TABT_Zimlets}
);
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"zimlets/about_zimlets.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.ADVANCED_TAB_ATTRS,ZaAccountXFormView.ADVANCED_TAB_RIGHTS)){
u=++this.TAB_INDEX;
this.tabChoices.push({
value:u,label:ZaMsg.TABT_Advanced}
);
this.helpMap[u]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/account_advanced_features.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
var o=[];
var g={
type:_ZATABCASE_,caseKey:C,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,numCols:1};
var w=[{
type:_DWT_ALERT_,ref:ZaAccount.A2_domainLeftAccounts,visibilityChecks:[ZaAccountXFormView.isDomainLeftAccountsAlertVisible],visibilityChangeEventSources:[ZaAccount.A2_domainLeftAccounts,ZaAccount.A_name,ZaAccount.A2_accountTypes],containerCssStyle:"width:400px;",bmolsnr:true,style:DwtAlert.WARNING,iconVisible:false}
,{
type:_TOP_GROUPER_,label:ZaMsg.NAD_AccountTypeGrouper,id:"account_type_group",colSpan:"*",numCols:1,colSizes:["100%"],visibilityChecks:[ZaAccountXFormView.isAccountTypeGrouperVisible,ZaAccount.isShowAccountType],visibilityChangeEventSources:[ZaAccount.A2_accountTypes,ZaAccount.A_COSId,ZaAccount.A_name,ZaAccount.A2_showAccountTypeMsg],items:[{
type:_DWT_ALERT_,visibilityChecks:[ZaAccountXFormView.isAccountTypeSet,ZaAccountXFormView.isAccountsTypeAlertInvisible],visibilityChangeEventSources:[ZaAccount.A2_accountTypes,ZaAccount.A_COSId,ZaAccount.A_name,ZaAccount.A2_showAccountTypeMsg],containerCssStyle:"width:400px;",style:DwtAlert.CRITICAL,iconVisible:false,content:ZaMsg.ERROR_ACCOUNT_TYPE_NOT_SET}
,{
type:_DWT_ALERT_,ref:ZaAccount.A2_showAccountTypeMsg,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaAccount.A2_showAccountTypeMsg]],visibilityChangeEventSources:[ZaAccount.A2_showAccountTypeMsg,ZaAccount.A_name],bmolsnr:true,containerCssStyle:"width:400px;",style:DwtAlert.WARNING,iconVisible:false}
,{
type:_OUTPUT_,id:ZaAccountXFormView.accountTypeItemId,getDisplayValue:ZaAccount.getAccountTypeOutput,cssStyle:"margin-left:auto;margin-right:auto;width:600px;"}
]}
,{
type:_TOP_GROUPER_,label:ZaMsg.NAD_AccountNameGrouper,id:"account_form_name_group",colSizes:["275px","*"],numCols:2,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,ZaAccountXFormView.ACCOUNT_NAME_GROUP_ATTRS]],items:ZaAccountXFormView.getAccountNameInfoItem()}
];
var h={
type:_TOP_GROUPER_,label:ZaMsg.NAD_AccountSetupGrouper,id:"account_form_setup_group",colSizes:["275px","*"],numCols:2,items:[{
ref:ZaAccount.A_accountStatus,type:_OSELECT1_,msgName:ZaMsg.NAD_AccountStatus,label:ZaMsg.NAD_AccountStatus,bmolsnr:true,labelLocation:_LEFT_,choices:this.accountStatusChoices}
],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_accountStatus,ZaAccount.A_COSId,ZaAccount.A_zimbraIsAdminAccount]]]};
h.items.push({
type:_GROUP_,numCols:3,colSizes:["156px","22px","100px"],nowrap:true,label:ZaMsg.NAD_ClassOfService,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasReadPermission,ZaAccount.A_COSId]],attributeName:ZaAccount.A_COSId,id:ZaAccountXFormView.cosGroupItemId,items:[{
ref:ZaAccount.A_COSId,type:_INPUT_,onChange:ZaAccount.setCosChanged,enableDisableChecks:[[ZaNewAccountXWizard.isAutoCos],[ZaItem.hasWritePermission,ZaAccount.A_COSId]],enableDisableChangeEventSources:[ZaAccount.A2_autoCos],getDisplayValue:function(S){
this.createDataList(ZaApp.getInstance().getCosListName());
if(S){
var D=ZaCos.getCosById(S);
return D&&D.name
}}}
,{
ref:ZaAccount.A2_autoCos,type:_CHECKBOX_,visibilityChecks:[],subLabel:"",enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_COSId]],msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",helpTooltip:false,elementChanged:function(M,S,D){
this.getForm().parent.setDirty(true);
if(M=="TRUE"){
var F=ZaCos.getDefaultCos4Account(this.getInstance()[ZaAccount.A_name],this.getInstance().attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE");
if(F&&F.id){
this.getInstance()._defaultValues=F;
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_COSId,F.id)
}
this.getParentItem().getItems()[0].updateElement(null)
}
this.getForm().itemChanged(this,M,D)
}}
]}
);
h.items.push({
ref:ZaAccount.A_zimbraIsAdminAccount,type:_CHECKBOX_,msgName:ZaMsg.NAD_IsSystemAdminAccount,label:ZaMsg.NAD_IsSystemAdminAccount,bmolsnr:true,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[XForm.checkInstanceValueNot,ZaAccount.A_zimbraIsExternalVirtualAccount,"TRUE"],[ZaItem.hasReadPermission,ZaAccount.A_zimbraIsAdminAccount]],visibilityChangeEventSources:[ZaAccount.A_zimbraIsExternalVirtualAccount,ZaAccount.A_zimbraIsAdminAccount]}
);
w.push(h);
var r={
type:_TOP_GROUPER_,label:ZaMsg.NAD_PasswordGrouper,id:"account_form_password_group",visibilityChecks:[[ZaItem.hasAnyRight,[ZaAccount.SET_PASSWORD_RIGHT,ZaAccount.CHANGE_PASSWORD_RIGHT]],[XForm.checkInstanceValueNot,ZaAccount.A2_isExternalAuth,true]],visibilityChangeEventSources:[ZaAccount.A2_isExternalAuth],colSizes:["275px","*"],numCols:2,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Alert_InternalPassword}
,{
ref:ZaAccount.A_password,type:_SECRET_,msgName:ZaMsg.NAD_Password,label:ZaMsg.NAD_Password,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]],cssClass:"admin_xform_name_input"}
,{
ref:ZaAccount.A2_confirmPassword,type:_SECRET_,msgName:ZaMsg.NAD_ConfirmPassword,label:ZaMsg.NAD_ConfirmPassword,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]],cssClass:"admin_xform_name_input"}
,{
ref:ZaAccount.A_zimbraPasswordMustChange,type:_CHECKBOX_,msgName:ZaMsg.NAD_MustChangePwd,label:ZaMsg.NAD_MustChangePwd,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
]};
w.push(r);
var e={
type:_TOP_GROUPER_,label:ZaMsg.NAD_ExternalAuthGrouper,id:"account_form_ext_auth_group",visibilityChecks:[[XForm.checkInstanceValue,ZaAccount.A2_isExternalAuth,true],[ZaItem.hasReadPermission,ZaAccount.A_zimbraAuthLdapExternalDn]],visibilityChangeEventSources:[ZaAccount.A2_isExternalAuth],colSizes:["275px","*"],numCols:2,items:[{
ref:ZaAccount.A_zimbraAuthLdapExternalDn,type:_TEXTFIELD_,width:256,msgName:ZaMsg.NAD_AuthLdapExternalDn,label:ZaMsg.NAD_AuthLdapExternalDn,labelLocation:_LEFT_,align:_LEFT_,toolTipContent:ZaMsg.tt_AuthLdapExternalDn}
]};
w.push(e);
var t={
type:_TOP_GROUPER_,label:ZaMsg.NAD_NotesGrouper,id:"account_form_notes_group",colSizes:["275px","*"],numCols:2,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_notes,ZaAccount.A_description]]],items:[ZaItem.descriptionXFormItem,{
ref:ZaAccount.A_notes,type:_TEXTAREA_,msgName:ZaMsg.NAD_Notes,label:ZaMsg.NAD_Notes,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em"}
]};
w.push(t);
g.items=w;
o.push(g);
if(B){
var m={
type:_ZATABCASE_,numCols:1,caseKey:B,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,align:_CENTER_,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.LBL_phone,id:"contact_form_phone_group",width:"100%",numCols:2,colSizes:["275px","100%"],items:[{
ref:ZaAccount.A_telephoneNumber,type:_TEXTFIELD_,msgName:ZaMsg.NAD_telephoneNumber,label:ZaMsg.NAD_telephoneNumber,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_homePhone,type:_TEXTFIELD_,msgName:ZaMsg.NAD_homePhone,label:ZaMsg.NAD_homePhone,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_mobile,type:_TEXTFIELD_,msgName:ZaMsg.NAD_mobile,label:ZaMsg.NAD_mobile,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_pager,type:_TEXTFIELD_,msgName:ZaMsg.NAD_pager,label:ZaMsg.NAD_pager,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_facsimileTelephoneNumber,type:_TEXTFIELD_,msgName:ZaMsg.NAD_facsimileTelephoneNumber,label:ZaMsg.NAD_facsimileTelephoneNumber,labelLocation:_LEFT_,width:250}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.LBL_company,id:"contact_form_company_group",width:"100%",numCols:2,colSizes:["275px","100%"],items:[{
ref:ZaAccount.A_zimbraPhoneticCompany,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zimbraPhoneticCompany,label:ZaMsg.NAD_zimbraPhoneticCompany,labelLocation:_LEFT_,width:250,visibilityChecks:[[ZaZimbraAdmin.isLanguage,"ja"]]}
,{
ref:ZaAccount.A_company,type:_TEXTFIELD_,msgName:ZaMsg.NAD_company,label:ZaMsg.NAD_company,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_title,type:_TEXTFIELD_,msgName:ZaMsg.NAD_title,label:ZaMsg.NAD_title,labelLocation:_LEFT_,width:250}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.LBL_address,id:"contact_form_address_group",width:"100%",numCols:2,colSizes:["275px","100%"],items:ZaAccountXFormView.getAddressFormItem()}
]};
o.push(m)
}
var O=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.DIRECT);
var y=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.INDIRECT);
var p=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.NON);
if(W){
var d={
type:_ZATABCASE_,numCols:2,caseKey:W,colSizes:["390px","390px"],paddingStyle:"padding-left:15px;",cellpadding:2,items:[{
type:_SPACER_,height:"10"}
,{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_DirectGroupLabel,containerCssStyle:"padding-top:5px;",items:[{
ref:ZaAccount.A2_directMemberList,type:_S_DWT_LIST_,width:"98%",height:200,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:O,defaultColumnSortable:0,onSelection:ZaAccountXFormView.directMemberOfSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[85,5,85,"100%",80,5,80,5],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemoveAll,width:80,enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAllButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList],onActivate:"ZaAccountMemberOfListView.removeAllGroups.call(this,event, ZaAccount.A2_directMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemove,width:80,id:"removeButton",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAddRemoveButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberListSelected],onActivate:"ZaAccountMemberOfListView.removeGroups.call(this,event, ZaAccount.A2_directMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,width:75,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_offset"]}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,width:75,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_more"]}
,{
type:_CELLSPACER_,height:"100%"}
]}
]}
,{
type:_SPACER_,height:"10"}
,{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_IndirectGroupLabel,containerCssStyle:"padding-top:5px;",items:[{
ref:ZaAccount.A2_indirectMemberList,type:_S_DWT_LIST_,width:"98%",height:200,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:y,defaultColumnSortable:0,onSelection:ZaAccountXFormView.indirectMemberOfSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[85,5,85,"100%",80,5,80,5],items:[{
type:_CELLSPACER_,height:"100%"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,width:75,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_offset"]}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,width:75,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_more"]}
,{
type:_CELLSPACER_,height:"100%"}
]}
]}
]}
,{
type:_ZARIGHT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_NonGroupLabel,containerCssStyle:"padding-top:5px;",items:[{
type:_GROUP_,numCols:5,colSizes:[55,"auto",10,80,120,20],width:"100%",items:[{
type:_OUTPUT_,value:ZaMsg.DLXV_LabelFind,nowrap:true}
,{
ref:"query",type:_TEXTFIELD_,width:"100%",label:null,elementChanged:function(M,F,S){
var D=S.charCode;
if(D==13||D==3){
ZaAccountMemberOfListView.prototype.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,M,S)
}}
,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,width:80,onActivate:ZaAccountMemberOfListView.prototype.srchButtonHndlr}
,{
ref:ZaAccount.A2_showSameDomain,type:_CHECKBOX_,align:_RIGHT_,msgName:ZaMsg.NAD_SearchSameDomain,label:AjxMessageFormat.format(ZaMsg.NAD_SearchSameDomain),subLabel:"",labelCssClass:"xform_label",labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",enableDisableChecks:[],visibilityChecks:[]}
]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaAccount.A2_nonMemberList,type:_S_DWT_LIST_,width:"98%",height:455,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:p,defaultColumnSortable:0,onSelection:ZaAccountXFormView.nonMemberOfSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[85,5,85,"100%",80,5,80,5],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddFromList,width:80,enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAddRemoveButton,ZaAccount.A2_nonMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_nonMemberListSelected],onActivate:"ZaAccountMemberOfListView.addGroups.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddAll,width:80,enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAllButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.addAllGroups.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,width:75,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_offset"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,width:75,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_more"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
]}
]}
,{
type:_GROUP_,width:"100%",items:[{
type:_CELLSPACER_}
]}
]};
o.push(d)
}
if(T){
o.push({
type:_ZATABCASE_,id:"account_form_features_tab",numCols:1,width:"100%",caseKey:T,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-top:20px;width:400px;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.NAD_CheckFeaturesInfo}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMajorFeature,id:"account_form_features_major",colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureMailEnabled,ZaAccount.A_zimbraFeatureContactsEnabled,ZaAccount.A_zimbraFeatureCalendarEnabled,ZaAccount.A_zimbraFeatureTasksEnabled,ZaAccount.A_zimbraFeatureBriefcasesEnabled,ZaAccount.A_zimbraFeatureOptionsEnabled]]],items:[{
ref:ZaAccount.A_zimbraFeatureMailEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMailEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureContactsEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureContactsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureContactsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureCalendarEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureCalendarEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureTasksEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureTaskEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureTaskEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureBriefcasesEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureOptionsEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureOptionsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureOptionsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraGeneralFeature,id:"account_form_features_general",colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureTaggingEnabled,ZaAccount.A_zimbraFeatureSharingEnabled,ZaAccount.A_zimbraFeatureChangePasswordEnabled,ZaAccount.A_zimbraFeatureSkinChangeEnabled,ZaAccount.A_zimbraFeatureManageZimlets,ZaAccount.A_zimbraFeatureHtmlComposeEnabled,ZaAccount.A_zimbraFeatureGalEnabled,ZaAccount.A_zimbraFeatureMAPIConnectorEnabled,ZaAccount.A_zimbraFeatureEwsEnabled,ZaAccount.A_zimbraFeatureTouchClientEnabled,ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled,ZaAccount.A_zimbraFeatureBriefcasesEnabled,ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled,ZaAccount.A_zimbraFeatureImportFolderEnabled,ZaAccount.A_zimbraFeatureExportFolderEnabled,ZaAccount.A_zimbraDumpsterEnabled,ZaAccount.A_zimbraDumpsterPurgeEnabled]]],items:[{
ref:ZaAccount.A_zimbraFeatureTaggingEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureTaggingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureTaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureSharingEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSharingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSharingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraExternalSharingEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraExternalSharingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraExternalSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaAccount.A_zimbraPublicSharingEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPublicSharingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPublicSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaAccount.A_zimbraFeatureChangePasswordEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureSkinChangeEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureManageZimlets,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureManageZimlets,checkBoxLabel:ZaMsg.LBL_zimbraFeatureManageZimlets,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureHtmlComposeEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureGalEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureGalEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureGalEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureMAPIConnectorEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureEwsEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureEwsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureEwsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureTouchClientEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureTouchClientEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureTouchClientEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureWebClientOfflineAccessEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureWebClientOfflineAccessEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureImportFolderEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureExportFolderEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraDumpsterEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraDumpsterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraDumpsterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraDumpsterPurgeEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraDumpsterPurgeEnabled,checkBoxLabel:ZaMsg.LBL_zimbraDumpsterPurgeEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraDumpsterEnabled]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMailFeature,id:"account_form_features_mail",colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureMailPriorityEnabled,ZaAccount.A_zimbraFeatureFlaggingEnabled,ZaAccount.A_zimbraImapEnabled,ZaAccount.A_zimbraPop3Enabled,ZaAccount.A_zimbraFeatureImapDataSourceEnabled,ZaAccount.A_zimbraFeaturePop3DataSourceEnabled,ZaAccount.A_zimbraFeatureMailSendLaterEnabled,ZaAccount.A_zimbraFeatureConversationsEnabled,ZaAccount.A_zimbraFeatureFiltersEnabled,ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled,ZaAccount.A_zimbraFeatureNewMailNotificationEnabled,ZaAccount.A_zimbraFeatureIdentitiesEnabled,ZaAccount.A_zimbraFeatureReadReceiptsEnabled]]],enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureMailEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureMailEnabled,ZaAccount.A_COSId],items:[{
ref:ZaAccount.A_zimbraFeatureMailPriorityEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureFlaggingEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraImapEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraImapEnabled,checkBoxLabel:ZaMsg.LBL_zimbraImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPop3Enabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPop3Enabled,checkBoxLabel:ZaMsg.LBL_zimbraPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureImapDataSourceEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraExternalImapEnabled,checkBoxLabel:ZaMsg.LBL_zimbraExternalImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeaturePop3DataSourceEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraExternalPop3Enabled,checkBoxLabel:ZaMsg.LBL_zimbraExternalPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureMailSendLaterEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureConversationsEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureConversationsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureConversationsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureFiltersEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureFiltersEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureFiltersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureNewMailNotificationEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureIdentitiesEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureReadReceiptsEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraFeatureReadReceiptsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraContactFeature,id:"account_form_features_contact",enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureContactsEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureContactsEnabled,ZaAccount.A_COSId],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureDistributionListFolderEnabled]]],items:[{
ref:ZaAccount.A_zimbraFeatureDistributionListFolderEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraFeatureDistributionListFolderEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureDistributionListFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraCalendarFeature,id:"account_form_features_calendar",colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureGroupCalendarEnabled,ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled]]],enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureCalendarEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureCalendarEnabled,ZaAccount.A_COSId],items:[{
ref:ZaAccount.A_zimbraFeatureGroupCalendarEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSearchFeature,id:"account_form_features_search",colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureAdvancedSearchEnabled,ZaAccount.A_zimbraFeatureSavedSearchesEnabled,ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled,ZaAccount.A_zimbraFeaturePeopleSearchEnabled]]],items:[{
ref:ZaAccount.A_zimbraFeatureAdvancedSearchEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureSavedSearchesEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeaturePeopleSearchEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSMIMEFeature,id:"account_form_features_smime",colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureSMIMEEnabled]]],items:[{
ref:ZaAccount.A_zimbraFeatureSMIMEEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
]}
)
}
if(z){
var b=[{
type:_ZA_TOP_GROUPER_,id:"account_prefs_general",colSizes:["275px","auto"],numCols:2,label:ZaMsg.NAD_GeneralOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPrefClientType,ZaAccount.A_zimbraPrefMailInitialSearch,ZaAccount.A_zimbraPrefShowSearchString,ZaAccount.A_zimbraPrefImapSearchFoldersEnabled,ZaAccount.A_zimbraPrefUseKeyboardShortcuts,ZaAccount.A_zimbraPrefWarnOnExit,ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit,ZaAccount.A_zimbraPrefShowSelectionCheckbox,ZaAccount.A_zimbraJunkMessagesIndexingEnabled,ZaAccount.A_zimbraPrefLocale]]],items:[{
ref:ZaAccount.A_zimbraPrefClientType,type:_SUPER_SELECT1_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefClientType,label:ZaMsg.LBL_zimbraPrefClientType,labelLocation:_LEFT_}
,{
ref:ZaAccount.A_zimbraPrefMailInitialSearch,type:_SUPER_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraPrefMailInitialSearch,txtBoxLabel:ZaMsg.LBL_zimbraPrefMailInitialSearch,labelCssClass:"gridGroupBodyLabel",labelCssStyle:"border-right:1px solid;",labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefShowSearchString,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefShowSearchString,checkBoxLabel:ZaMsg.LBL_zimbraPrefShowSearchString,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefImapSearchFoldersEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefUseKeyboardShortcuts,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraPrefUseKeyboardShortcuts,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefWarnOnExit,type:_SUPER_CHECKBOX_,nowrap:false,labelWrap:true,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraPrefWarnOnExit,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit,type:_SUPER_CHECKBOX_,nowrap:false,labelWrap:true,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZabMsg.LBL_zimbraPrefAdminConsoleWarnOnExit,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefShowSelectionCheckbox,type:_SUPER_CHECKBOX_,labelWrap:true,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraPrefShowSelectionCheckbox,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraJunkMessagesIndexingEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraJunkMessagesIndexingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraJunkMessagesIndexingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefLocale,type:_SUPER_SELECT1_,colSpan:2,choices:ZaSettings.getLocaleChoices(),msgName:ZaMsg.LBL_zimbraPrefLocale,label:ZaMsg.LBL_zimbraPrefLocale,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_prefs_standard_client",colSizes:["275px","auto"],numCols:2,label:ZaMsg.NAD_MailOptionsStandardClient,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraMaxMailItemsPerPage,ZaAccount.A_zimbraPrefMailItemsPerPage]]],items:[{
ref:ZaAccount.A_zimbraMaxMailItemsPerPage,type:_SUPER_SELECT1_,editable:true,inputSize:4,choices:[10,25,50,100,250,500,1000],msgName:ZaMsg.MSG_zimbraMaxMailItemsPerPage,label:ZaMsg.LBL_zimbraMaxMailItemsPerPage,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,valueLabel:null}
,{
ref:ZaAccount.A_zimbraPrefMailItemsPerPage,type:_SUPER_SELECT1_,editable:false,msgName:ZaMsg.MSG_zimbraPrefMailItemsPerPage,label:ZaMsg.LBL_zimbraPrefMailItemsPerPage,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,valueLabel:null}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_prefs_mail_general",label:ZaMsg.NAD_MailOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPrefMessageViewHtmlPreferred,ZaAccount.A_zimbraPrefDisplayExternalImages,ZaAccount.A_zimbraPrefGroupMailBy,ZaAccount.A_zimbraPrefMailDefaultCharset,ZaAccount.A_zimbraPrefMailToasterEnabled,ZaAccount.A_zimbraPrefMessageIdDedupingEnabled,ZaAccount.A_zimbraPrefItemsPerVirtualPage,]]],items:[{
ref:ZaAccount.A_zimbraPrefMessageViewHtmlPreferred,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,checkBoxLabel:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefDisplayExternalImages,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefDisplayExternalImages,checkBoxLabel:ZaMsg.LBL_zimbraPrefDisplayExternalImages,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefGroupMailBy,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefGroupMailBy,label:ZaMsg.LBL_zimbraPrefGroupMailBy,labelLocation:_LEFT_}
,{
ref:ZaAccount.A_zimbraPrefMailDefaultCharset,type:_SUPER_SELECT1_,msgName:ZaMsg.LBL_zimbraPrefMailDefaultCharset,label:ZaMsg.LBL_zimbraPrefMailDefaultCharset,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefMailToasterEnabled,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefMailToasterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefMailToasterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMessageIdDedupingEnabled,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefMessageIdDedupingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefMessageIdDedupingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefItemsPerVirtualPage,type:_SUPER_TEXTFIELD_,colSizes:["275px","275px","*"],colSpan:2,msgName:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage,txtBoxLabel:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,textFieldCssClass:"admin_xform_number_input"}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["275px","100%"],id:"account_prefs_mail_receiving",numCols:2,label:ZaMsg.NAD_MailOptionsReceiving,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPrefMailPollingInterval,ZaAccount.A_zimbraMailMinPollingInterval,ZaAccount.A_zimbraPrefMailSoundsEnabled,ZaAccount.A_zimbraPrefMailFlashIcon,ZaAccount.A_zimbraPrefMailFlashTitle,ZaAccount.A_zimbraPrefNewMailNotificationEnabled,ZaAccount.A_zimbraPrefNewMailNotificationAddress,ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration,ZaAccount.A_zimbraPrefOutOfOfficeReply,ZaAccount.A_zimbraPrefMailSendReadReceipts,ZaAccount.A_zimbraPrefReadReceiptsToAddress]]],items:[{
ref:ZaAccount.A_zimbraPrefMailPollingInterval,type:_SUPER_SELECT1_,labelCssClass:"gridGroupBodyLabel",msgName:ZaMsg.MSG_zimbraPrefMailPollingInterval,label:ZaMsg.LBL_zimbraPrefMailPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,onChange:ZaAccountXFormView.validatePollingInterval,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraMailMinPollingInterval,labelCssClass:"gridGroupBodyLabel",type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraMailMinPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraMailMinPollingInterval,onChange:ZaAccountXFormView.validatePollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:2}
,{
ref:ZaAccount.A_zimbraPrefMailSoundsEnabled,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_playSound,checkBoxLabel:ZaMsg.LBL_playSound,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMailFlashIcon,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_flashIcon,checkBoxLabel:ZaMsg.LBL_flashIcon,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMailFlashTitle,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_flashTitle,checkBoxLabel:ZaMsg.LBL_flashTitle,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefNewMailNotificationEnabled,type:_ZA_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefNewMailNotificationEnabled,label:ZaMsg.LBL_zimbraPrefNewMailNotificationEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefNewMailNotificationAddress,type:_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraPrefNewMailNotificationAddress,label:ZaMsg.LBL_zimbraPrefNewMailNotificationAddress,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraPrefNewMailNotificationEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefNewMailNotificationAddress]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPrefNewMailNotificationEnabled],nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,type:_ZA_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefOutOfOfficeReplyEnabled,label:ZaMsg.LBL_zimbraPrefOutOfOfficeReplyEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraPrefOutOfOfficeCacheDuration,txtBoxLabel:ZaMsg.LBL_zimbraPrefOutOfOfficeCacheDuration,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:2}
,{
ref:ZaAccount.A_zimbraPrefOutOfOfficeReply,type:_TEXTAREA_,msgName:ZaMsg.LBL_zimbraPrefOutOfOfficeReply,label:ZaMsg.LBL_zimbraPrefOutOfOfficeReply,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em",enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefOutOfOfficeReply]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled]}
,{
ref:ZaAccount.A_zimbraPrefMailSendReadReceipts,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,label:ZaMsg.LBL_zimbraPrefMailSendReadReceipts,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureReadReceiptsEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefMailSendReadReceipts]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureReadReceiptsEnabled]}
,{
ref:ZaAccount.A_zimbraPrefReadReceiptsToAddress,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPrefReadReceiptsToAddress,label:ZaMsg.LBL_zimbraPrefReadReceiptsToAddress,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureReadReceiptsEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefReadReceiptsToAddress]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureReadReceiptsEnabled],nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["275px","100%"],id:"account_prefs_mail_sending",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsSending,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPrefSaveToSent,ZaAccount.A_zimbraAllowAnyFromAddress,ZaAccount.A_zimbraAllowFromAddress]]],items:[{
ref:ZaAccount.A_zimbraPrefSaveToSent,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefSaveToSent,checkBoxLabel:ZaMsg.LBL_zimbraPrefSaveToSent,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraAllowAnyFromAddress,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraAllowAnyFromAddress,checkBoxLabel:ZaMsg.LBL_zimbraAllowAnyFromAddress,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraAllowFromAddress,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_zimbraAllowFromAddress,msgName:ZaMsg.MSG_zimbraAllowFromAddress,labelLocation:_LEFT_,addButtonLabel:ZaMsg.NAD_AddAddress,align:_LEFT_,repeatInstance:l,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveAddress,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:"200px",enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraAllowFromAddress]],visibilityChecks:[[ZaItem.hasReadPermission,ZaAccount.A_zimbraAllowFromAddress]]}
],visibilityChecks:[ZaAccountXFormView.isSendingFromAnyAddressDisAllowed,[ZaItem.hasReadPermission,ZaAccount.A_zimbraAllowFromAddress]],visibilityChangeEventSources:[ZaAccount.A_zimbraAllowAnyFromAddress,ZaAccount.A_zimbraAllowFromAddress,ZaAccount.A_COSId]}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["275px","100%"],id:"account_prefs_mail_composing",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsComposing,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPrefComposeInNewWindow,ZaAccount.A_zimbraPrefComposeFormat,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor,ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat,ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled,ZaAccount.A_zimbraMailSignatureMaxLength,ZaAccount.A_zimbraPrefMailSignature,ZaAccount.A_zimbraPrefAutoSaveDraftInterval]]],items:[{
ref:ZaAccount.A_zimbraPrefComposeInNewWindow,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefComposeInNewWindow,checkBoxLabel:ZaMsg.LBL_zimbraPrefComposeInNewWindow,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefComposeFormat,type:_SUPER_SELECT1_,nowrap:false,labelWrap:true,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefComposeFormat,label:ZaMsg.LBL_zimbraPrefComposeFormat}
,{
ref:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize}
,{
ref:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily}
,{
ref:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor,type:_SUPER_DWT_COLORPICKER_,labelCssStyle:"width:269px;",msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,checkBoxLabel:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMailSignatureEnabled,type:_ZA_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMailSignatureEnabled,label:ZaMsg.LBL_zimbraPrefMailSignatureEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraMailSignatureMaxLength,colSpan:2,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraMailSignatureMaxLength,txtBoxLabel:ZaMsg.LBL_zimbraMailSignatureMaxLength,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaAccount.A_zimbraPrefMailSignature,type:_TEXTAREA_,msgName:ZaMsg.MSG_zimbraPrefMailSignature,label:ZaMsg.LBL_zimbraPrefMailSignature,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em",enableDisableChangeEventSources:[ZaAccount.A_zimbraPrefMailSignatureEnabled],enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraPrefMailSignatureEnabled,"TRUE"]]}
,{
ref:ZaAccount.A_zimbraPrefAutoSaveDraftInterval,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraPrefAutoSaveDraftInterval,txtBoxLabel:ZaMsg.LBL_zimbraPrefAutoSaveDraftInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:2,nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_prefs_contacts_general",label:ZaMsg.NAD_ContactsOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPrefAutoAddAddressEnabled,ZaAccount.A_zimbraPrefGalAutoCompleteEnabled]]],items:[{
ref:ZaAccount.A_zimbraPrefAutoAddAddressEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,trueValue:"TRUE",falseValue:"FALSE",colSpan:2}
,{
ref:ZaAccount.A_zimbraPrefGalAutoCompleteEnabled,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_prefs_calendar_general",label:ZaMsg.NAD_CalendarOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPrefTimeZoneId,ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime,ZaAccount.A_zimbraPrefCalendarInitialView,ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek,ZaAccount.A_zimbraPrefCalendarApptVisibility,ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled,ZaAccount.A_zimbraPrefCalendarShowPastDueReminders,ZaAccount.A_zimbraPrefCalendarToasterEnabled,ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf,ZaAccount.A_zimbraPrefCalendarAllowPublishMethodInvite,ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite,ZaAccount.A_zimbraPrefCalendarReminderFlashTitle,ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled,ZaAccount.A_zimbraPrefCalendarSendInviteDeniedAutoReply,ZaAccount.A_zimbraPrefCalendarAutoAddInvites,ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges,ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal,ZaAccount.A_zimbraPrefCalendarUseQuickAdd,ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar]]],items:[{
ref:ZaAccount.A_zimbraPrefTimeZoneId,type:_SUPER_SELECT1_,valueWidth:"220px",msgName:ZaMsg.MSG_zimbraPrefTimeZoneId,label:ZaMsg.LBL_zimbraPrefTimeZoneId,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime,type:_SUPER_SELECT1_,msgName:ZaMsg.MSG_zimbraPrefCalendarApptReminderWarningTime,label:ZaMsg.LBL_zimbraPrefCalendarApptReminderWarningTime,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefCalendarInitialView,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarInitialView,label:ZaMsg.LBL_zimbraPrefCalendarInitialView,labelLocation:_LEFT_}
,{
ref:ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarFirstDayOfWeek,label:ZaMsg.LBL_zimbraPrefCalendarFirstDayOfWeek,labelLocation:_LEFT_}
,{
ref:ZaAccount.A_zimbraPrefCalendarApptVisibility,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarApptVisibility,label:ZaMsg.LBL_zimbraPrefCalendarApptVisibility,labelLocation:_LEFT_}
,{
ref:ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefAppleIcalDelegationEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefAppleIcalDelegationEnabled,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarShowPastDueReminders,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarShowPastDueReminders,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarShowPastDueReminders,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarToasterEnabled,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarToasterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarToasterEnabled,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowCancelEmailToSelf,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAllowCancelEmailToSelf,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAllowPublishMethodInvite,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowPublishMethodInvite,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAllowPublishMethodInvite,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowForwardedInvite,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAllowForwardedInvite,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarReminderFlashTitle,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarReminderFlashTitle,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarReminderFlashTitle,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarReminderSoundsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarReminderSoundsEnabled,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarSendInviteDeniedAutoReply,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarSendInviteDeniedAutoReply,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarSendInviteDeniedAutoReply,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAutoAddInvites,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal,type:_SUPER_CHECKBOX_,colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefCalendarUseQuickAdd,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarUseQuickAdd,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarUseQuickAdd,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar,colSpan:2,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,checkBoxLabel:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,trueValue:"TRUE",falseValue:"FALSE"}
]}
];
o.push({
type:_ZATABCASE_,id:"account_form_prefs_tab",numCols:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,caseKey:z,items:b}
)
}
if(j){
o.push({
type:_ZATABCASE_,id:"account_form_aliases_tab",width:"100%",numCols:1,colSizes:["auto"],paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,caseKey:j,items:[{
type:_ZA_TOP_GROUPER_,id:"account_form_aliases_group",borderCssClass:"LowPaddedTopGrouperBorder",width:"100%",numCols:1,colSizes:["auto"],label:ZaMsg.NAD_EditAliasesGroup,items:[{
ref:ZaAccount.A_zimbraMailAlias,type:_DWT_LIST_,height:"200",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,onSelection:ZaAccountXFormView.aliasSelectionListener}
,{
type:_GROUP_,numCols:5,width:"350px",colSizes:["100px","auto","100px","auto","100px"],cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaAccountXFormView.deleteAliasButtonListener.call(this);",id:"deleteAliasButton",enableDisableChecks:[ZaAccountXFormView.isDeleteAliasEnabled,[ZaItem.hasRight,ZaAccount.REMOVE_ACCOUNT_ALIAS_RIGHT]],enableDisableChangeEventSources:[ZaAccount.A2_alias_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaAccountXFormView.editAliasButtonListener.call(this);",id:"editAliasButton",enableDisableChangeEventSources:[ZaAccount.A2_alias_selection_cache],enableDisableChecks:[ZaAccountXFormView.isEditAliasEnabled,[ZaItem.hasRight,ZaAccount.ADD_ACCOUNT_ALIAS_RIGHT],[ZaItem.hasRight,ZaAccount.REMOVE_ACCOUNT_ALIAS_RIGHT]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChecks:[[ZaItem.hasRight,ZaAccount.ADD_ACCOUNT_ALIAS_RIGHT]],enableDisableChangeEventSources:[ZaAccount.A2_alias_selection_cache],onActivate:"ZaAccountXFormView.addAliasButtonListener.call(this);"}
]}
]}
]}
)
}
if(x){
o.push({
type:_ZATABCASE_,id:"account_form_forwarding_tab",width:"100%",numCols:1,colSizes:["auto"],caseKey:x,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_EditFwdTopGroupGrouper,id:"account_form_user_forwarding_addr",colSizes:["275px","100%"],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFeatureMailForwardingEnabled]]],items:[{
ref:ZaAccount.A_zimbraFeatureMailForwardingEnabled,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,type:_SUPER_CHECKBOX_,colSpan:2,colSizes:["275","275","*"],checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailForwardingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled,type:_ZA_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMailLocalDeliveryDisabled,label:ZaMsg.LBL_zimbraPrefMailLocalDeliveryDisabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMailForwardingAddress,type:_TEXTFIELD_,width:"350px",labelCssClass:"xform_label",cssClass:"admin_xform_name_input",label:ZaMsg.LBL_zimbraPrefMailForwardingAddress,msgName:ZaMsg.LBL_zimbraPrefMailForwardingAddressMsg,nowrap:false,labelWrap:true,labelLocation:_LEFT_,labelCssStyle:"text-align:left;",align:_LEFT_,visibilityChecks:[ZaItem.hasReadPermission],enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureMailForwardingEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureMailForwardingEnabled,ZaAccount.A_COSId]}
,{
type:_GROUP_,colSizes:["275px","*"],numCols:2,width:"100%",colSpan:2,items:[{
ref:ZaAccount.A_zimbraPrefCalendarForwardInvitesTo,type:_DWT_LIST_,height:"100",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",nowrap:false,labelWrap:true,headerList:null,onSelection:ZaAccountXFormView.calFwdAddrSelectionListener,label:ZaMsg.zimbraPrefCalendarForwardInvitesTo,labelCssClass:"gridGroupBodyLabel",labelCssStyle:"text-align:left;border-right:1px solid;",visibilityChecks:[ZaItem.hasReadPermission]}
,{
type:_GROUP_,numCols:6,width:"625px",colSizes:["275","100px","auto","100px","auto","100px"],colSpan:2,visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]],cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaAccountXFormView.deleteCalFwdAddrButtonListener.call(this);",enableDisableChecks:[ZaAccountXFormView.isDeleteCalFwdAddrEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]],enableDisableChangeEventSources:[ZaAccount.A2_calFwdAddr_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaAccountXFormView.editCalFwdAddrButtonListener.call(this);",enableDisableChecks:[ZaAccountXFormView.isEditCalFwdAddrEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]],enableDisableChangeEventSources:[ZaAccount.A2_calFwdAddr_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]],onActivate:"ZaAccountXFormView.addCalFwdAddrButtonListener.call(this);"}
]}
,{
type:_DWT_ALERT_,colSpan:2,containerCssStyle:"padding:0 10px 10px;width:100%;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_Bouncing_Reveal_Hidden_Adds}
,{
ref:ZaAccount.A_zimbraMailForwardingAddress,type:_DWT_LIST_,height:"100",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,onSelection:ZaAccountXFormView.fwdAddrSelectionListener,label:ZaMsg.NAD_EditFwdGroup,labelCssClass:"gridGroupBodyLabel",nowrap:false,labelWrap:true,labelCssStyle:"text-align:left;border-right:1px solid;",visibilityChecks:[ZaItem.hasReadPermission]}
,{
type:_GROUP_,numCols:6,width:"625px",colSizes:["275","100px","auto","100px","auto","100px"],colSpan:2,cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaAccountXFormView.deleteFwdAddrButtonListener.call(this);",enableDisableChecks:[ZaAccountXFormView.isDeleteFwdAddrEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailForwardingAddress]],enableDisableChangeEventSources:[ZaAccount.A2_fwdAddr_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaAccountXFormView.editFwdAddrButtonListener.call(this);",enableDisableChecks:[ZaAccountXFormView.isEditFwdAddrEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailForwardingAddress]],enableDisableChangeEventSources:[ZaAccount.A2_fwdAddr_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailForwardingAddress]],onActivate:"ZaAccountXFormView.addFwdAddrButtonListener.call(this);"}
]}
]}
]}
]}
)
}
if(k){
o.push({
type:_ZATABCASE_,id:"account_form_interop_tab",width:"100%",numCols:1,colSizes:["auto"],paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,caseKey:k,items:[{
type:_ZA_TOP_GROUPER_,id:"account_form_interop_group",borderCssClass:"LowPaddedTopGrouperBorder",width:"100%",numCols:1,colSizes:["auto"],label:ZaMsg.NAD_EditFpGroup,items:[{
ref:ZaAccount.A_zimbraForeignPrincipal,type:_DWT_LIST_,height:"200",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,onSelection:ZaAccountXFormView.fpSelectionListener}
,{
type:_GROUP_,numCols:7,width:"350px",colSizes:["100px","auto","100px","auto","100px","auto","100px"],cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Push,width:"100px",onActivate:"ZaAccountXFormView.pushFpButtonListener.call(this);",enableDisableChecks:[ZaAccountXFormView.isPushFpEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraForeignPrincipal]],enableDisableChangeEventSources:[ZaAccount.A_zimbraForeignPrincipal]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaAccountXFormView.deleteFpButtonListener.call(this);",enableDisableChecks:[ZaAccountXFormView.isDeleteFpEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraForeignPrincipal]],enableDisableChangeEventSources:[ZaAccount.A2_fp_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaAccountXFormView.editFpButtonListener.call(this);",enableDisableChecks:[ZaAccountXFormView.isEditFpEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraForeignPrincipal]],enableDisableChangeEventSources:[ZaAccount.A2_fp_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraForeignPrincipal]],onActivate:"ZaAccountXFormView.addFpButtonListener.call(this);"}
]}
]}
]}
)
}
if(v){
o.push({
type:_ZATABCASE_,id:"account_form_themes_tab",numCols:1,caseKey:v,items:[{
type:_SPACER_}
,{
type:_GROUP_,items:[{
ref:ZaAccount.A_zimbraPrefSkin,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,choices:ZaAccountXFormView.themeChoices,visibilityChecks:[ZaAccountXFormView.gotSkins]}
,{
type:_OUTPUT_,ref:ZaAccount.A_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,visibilityChecks:[ZaAccountXFormView.gotNoSkins]}
]}
,{
type:_SPACER_}
,{
type:_SUPER_SELECT_CHECK_,selectRef:ZaAccount.A_zimbraAvailableSkin,ref:ZaAccount.A_zimbraAvailableSkin,choices:ZaAccountXFormView.themeChoices,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaAccountXFormView.gotSkins],visibilityChangeEventSources:[ZaModel.currentTab],caseKey:v,caseVarRef:ZaModel.currentTab,limitLabel:ZaMsg.NAD_LimitThemesTo}
,{
type:_DWT_ALERT_,colSpan:2,style:DwtAlert.WARNING,iconVisible:true,visibilityChecks:[ZaAccountXFormView.gotNoSkins],value:ZaMsg.ERROR_CANNOT_FIND_SKINS_FOR_ACCOUNT}
]}
)
}
if(f){
o.push({
type:_ZATABCASE_,id:"account_form_zimlets_tab",numCols:1,caseKey:f,items:[{
type:_GROUP_,numCols:1,colSizes:["auto"],items:[{
type:_SUPER_ZIMLET_SELECT_,selectRef:ZaAccount.A_zimbraZimletAvailableZimlets,ref:ZaAccount.A_zimbraZimletAvailableZimlets,choices:ZaAccountXFormView.zimletChoices,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab],visibilityChangeEventSources:[ZaModel.currentTab],caseKey:f,caseVarRef:ZaModel.currentTab,limitLabel:ZaMsg.NAD_LimitZimletsTo}
,{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Zimlet_Note}
]}
]}
)
}
if(u){
o.push({
type:_ZATABCASE_,id:"account_form_advanced_tab",numCols:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,caseKey:u,items:[{
type:_ZA_TOP_GROUPER_,id:"account_attachment_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_AttachmentsGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraAttachmentsBlocked]]],items:[{
ref:ZaAccount.A_zimbraAttachmentsBlocked,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.NAD_RemoveAllAttachments,checkBoxLabel:ZaMsg.NAD_RemoveAllAttachments,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_quota_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_QuotaGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraMailForwardingAddressMaxLength,ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs,ZaAccount.A_zimbraMailQuota,ZaAccount.A_zimbraContactMaxNumEntries,ZaAccount.A_zimbraQuotaWarnPercent,ZaAccount.A_zimbraQuotaWarnInterval,ZaAccount.A_zimbraQuotaWarnMessage]],[XForm.checkInstanceValueNot,ZaAccount.A_zimbraIsExternalVirtualAccount,"TRUE"]],items:[{
ref:ZaAccount.A_zimbraMailForwardingAddressMaxLength,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxLength,colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraMailForwardingAddressMaxLength,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxNumAddrs,colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraMailForwardingAddressMaxNumAddrs,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaAccount.A_zimbraMailQuota,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraMailQuota,msgName:ZaMsg.MSG_zimbraMailQuota,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraContactMaxNumEntries,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraContactMaxNumEntries,colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraContactMaxNumEntries,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaAccount.A_zimbraQuotaWarnPercent,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,txtBoxLabel:ZaMsg.LBL_zimbraQuotaWarnPercent,colSpan:1,msgName:ZaMsg.MSG_zimbraQuotaWarnPercent,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraQuotaWarnInterval,type:_SUPER_LIFETIME_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraQuotaWarnInterval,msgName:ZaMsg.MSG_zimbraQuotaWarnInterval,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraQuotaWarnMessage,type:_SUPER_TEXTAREA_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,txtBoxLabel:ZaMsg.MSG_zimbraQuotaWarnMessage,msgName:ZaMsg.LBL_zimbraQuotaWarnMessage,colSpan:1,labelCssStyle:"vertical-align:top;",textAreaWidth:"250px",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_datasourcepolling_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_DataSourcePolling,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraDataSourceMinPollingInterval,ZaAccount.A_zimbraDataSourcePop3PollingInterval,ZaAccount.A_zimbraDataSourceImapPollingInterval,ZaAccount.A_zimbraDataSourceCalendarPollingInterval,ZaAccount.A_zimbraDataSourceRssPollingInterval,ZaAccount.A_zimbraDataSourceCaldavPollingInterval]]],items:[{
ref:ZaAccount.A_zimbraDataSourceMinPollingInterval,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceMinPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceMinPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourcePop3PollingInterval,type:_SUPER_LIFETIME_,sgName:ZaMsg.MSG_zimbraDataSourcePop3PollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourcePop3PollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceImapPollingInterval,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceImapPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceImapPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceCalendarPollingInterval,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceCalendarPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceCalendarPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceRssPollingInterval,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceRssPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceRssPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceCaldavPollingInterval,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceCaldavPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceCaldavPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:1,nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_proxyalloweddomain_settings",label:ZaMsg.NAD_ProxyAllowedDomains,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraProxyAllowedDomains]]],items:[{
ref:ZaAccount.A_zimbraProxyAllowedDomains,label:ZaMsg.LBL_zimbraProxyAllowedDomains,labelCssStyle:"vertical-align:top;",type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,repeatInstance:"",colSizes:["275px","*"],addButtonLabel:ZaMsg.NAD_ProxyAddAllowedDomain,removeButtonLabel:ZaMsg.NAD_ProxyRemoveAllowedDomain,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,enableDisableChecks:[ZaItem.hasWritePermission],visibilityChecks:[[ZaItem.hasReadPermission,ZaAccount.A_zimbraProxyAllowedDomains]],enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraProxyAllowedDomains]],width:"15em"}
]}
]}
,{
type:_ZA_TOP_GROUPER_,id:"account_password_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_PasswordGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPasswordLocked,ZaAccount.A_zimbraMinPwdLength,ZaAccount.A_zimbraMaxPwdLength,ZaAccount.A_zimbraPasswordMinUpperCaseChars,ZaAccount.A_zimbraPasswordMinLowerCaseChars,ZaAccount.A_zimbraPasswordMinPunctuationChars,ZaAccount.A_zimbraPasswordMinNumericChars,ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,ZaAccount.A_zimbraMinPwdAge,ZaAccount.A_zimbraMaxPwdAge,ZaAccount.A_zimbraEnforcePwdHistory]]],items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",colSpan:3,style:DwtAlert.INFO,iconVisible:(!ZaAccountXFormView.isAuthfromInternal(n.name)),content:((ZaAccountXFormView.isAuthfromInternal(n.name))?ZaMsg.Alert_InternalPassword:ZaMsg.Alert_ExternalPassword)}
,{
ref:ZaAccount.A_zimbraPasswordLocked,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.NAD_PwdLocked,checkBoxLabel:ZaMsg.NAD_PwdLocked,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMinPwdLength,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMinPwdLength,txtBoxLabel:ZaMsg.LBL_zimbraMinPwdLength,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMaxPwdLength,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMaxPwdLength,txtBoxLabel:ZaMsg.LBL_zimbraMaxPwdLength,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinUpperCaseChars,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinUpperCaseChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinUpperCaseChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinLowerCaseChars,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinLowerCaseChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinLowerCaseChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinPunctuationChars,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinPunctuationChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinPunctuationChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinNumericChars,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinNumericChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinNumericChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinDigitsOrPuncs,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinDigitsOrPuncs,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMinPwdAge,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_passMinAge,txtBoxLabel:ZaMsg.LBL_passMinAge,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMaxPwdAge,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_passMaxAge,txtBoxLabel:ZaMsg.LBL_passMaxAge,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraEnforcePwdHistory,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraEnforcePwdHistory,txtBoxLabel:ZaMsg.LBL_zimbraEnforcePwdHistory,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaAccountXFormView.isAuthfromInternalSync,n.name,ZaAccount.A_name]]}
]}
,{
type:_ZA_TOP_GROUPER_,id:"password_lockout_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_FailedLoginGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_zimbraPasswordLockoutMaxFailures,ZaAccount.A_zimbraPasswordLockoutDuration,ZaAccount.A_zimbraPasswordLockoutFailureLifetime]]],items:[{
ref:ZaAccount.A_zimbraPasswordLockoutEnabled,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPasswordLockoutEnabled,colSpan:1,checkBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPasswordLockoutMaxFailures,type:_SUPER_TEXTFIELD_,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraPasswordLockoutEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_COSId],txtBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutMaxFailures,toolTipContent:ZaMsg.TTP_zimbraPasswordLockoutMaxFailuresSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutMaxFailures,labelLocation:_LEFT_,colSpan:1,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPasswordLockoutDuration,type:_SUPER_LIFETIME_,colSpan:1,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraPasswordLockoutEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_COSId],txtBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutDuration,toolTipContent:ZaMsg.TTP_zimbraPasswordLockoutDurationSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutDuration,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPasswordLockoutFailureLifetime,type:_SUPER_LIFETIME_,colSpan:1,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraPasswordLockoutEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_COSId],txtBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutFailureLifetime,toolTipContent:ZaMsg.TTP_zimbraPasswordLockoutFailureLifetimeSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutFailureLifetime,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS,labelCssStyle:"white-space:normal;border-right:1px solid;",nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["auto"],numCols:1,label:ZaMsg.NAD_TimeoutGrouper,id:"timeout_settings",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraAdminAuthTokenLifetime,ZaAccount.A_zimbraAuthTokenLifetime,ZaAccount.A_zimbraMailIdleSessionTimeout,ZaAccount.A_zimbraDumpsterUserVisibleAge]]],items:[{
ref:ZaAccount.A_zimbraAdminAuthTokenLifetime,type:_SUPER_LIFETIME_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraAdminAuthTokenLifetime,txtBoxLabel:ZaMsg.LBL_zimbraAdminAuthTokenLifetime,enableDisableChecks:[ZaAccount.isAdminAccount],enableDisableChangeEventSources:[ZaAccount.A_zimbraIsAdminAccount,ZaAccount.A_zimbraIsDelegatedAdminAccount]}
,{
ref:ZaAccount.A_zimbraAuthTokenLifetime,type:_SUPER_LIFETIME_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraAuthTokenLifetime,txtBoxLabel:ZaMsg.LBL_zimbraAuthTokenLifetime}
,{
ref:ZaAccount.A_zimbraMailIdleSessionTimeout,type:_SUPER_LIFETIME_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailIdleSessionTimeout,txtBoxLabel:ZaMsg.LBL_zimbraMailIdleSessionTimeout}
,{
ref:ZaAccount.A_zimbraDumpsterUserVisibleAge,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,type:_SUPER_LIFETIME_,msgName:ZaMsg.MSG_zimbraDumpsterUserVisibleAge,txtBoxLabel:ZaMsg.LBL_zimbraDumpsterUserVisibleAge,visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraDumpsterEnabled]}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraMailMessageLifetime,ZaAccount.A_zimbraMailTrashLifetime,ZaAccount.A_zimbraMailSpamLifetime,ZaAccount.A_zimbraMailDumpsterLifetime]],[XForm.checkInstanceValueNot,ZaAccount.A_zimbraIsExternalVirtualAccount,"TRUE"]],label:ZaMsg.NAD_MailRetentionGrouper,id:"mailretention_settings",items:[{
type:_DWT_ALERT_,containerCssStyle:"padding:0 10px 10px;width:100%;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Alert_EnableMailRetention}
,{
ref:ZaAccount.A_zimbraMailMessageLifetime,type:_SUPER_LIFETIME2_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailMessageLifetime,txtBoxLabel:ZaMsg.LBL_zimbraMailMessageLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled]],visibilityChangeEventSources:[ZaAccount.A_mailHost],labelCssStyle:"border-right:1px solid;",labelCssClass:"gridGroupBodyLabel"}
,{
ref:ZaAccount.A_zimbraMailTrashLifetime,type:_SUPER_LIFETIME1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailTrashLifetime,txtBoxLabel:ZaMsg.LBL_zimbraMailTrashLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled]],visibilityChangeEventSources:[ZaAccount.A_mailHost],labelCssStyle:"padding-left:10px; text-align:left; border-right:1px solid;",labelCssClass:"gridGroupBodyLabel"}
,{
ref:ZaAccount.A_zimbraMailSpamLifetime,type:_SUPER_LIFETIME1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailSpamLifetime,txtBoxLabel:ZaMsg.LBL_zimbraMailSpamLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled]],visibilityChangeEventSources:[ZaAccount.A_mailHost],labelCssStyle:"padding-left:10px; text-align:left; border-right:1px solid;",labelCssClass:"gridGroupBodyLabel"}
,{
ref:ZaAccount.A_zimbraMailDumpsterLifetime,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,type:_SUPER_LIFETIME1_,msgName:ZaMsg.MSG_zimbraMailDumpsterLifetime,txtBoxLabel:ZaMsg.LBL_zimbraMailDumpsterLifetime,labelCssStyle:"padding-left:10px; text-align:left;border-right:1px solid;",labelCssClass:"gridGroupBodyLabel",visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterEnabled,"TRUE"],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterPurgeEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraDumpsterEnabled,ZaAccount.A_zimbraDumpsterPurgeEnabled]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_InteropGrouper,id:"interop_settings",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraFreebusyExchangeUserOrg]]],items:[{
ref:ZaAccount.A_zimbraFreebusyExchangeUserOrg,type:_SUPER_TEXTFIELD_,textFieldWidth:"220px",resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,txtBoxLabel:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_MailTransportGrouper,id:"mailtransport_setting",colSizes:["275px","*"],numCols:2,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraMailTransport,ZaAccount.A_zimbraMailCanonicalAddress]]],items:[{
type:_OUTPUT_,ref:".",label:"",labelLocation:_LEFT_,value:ZaMsg.MSG_MailTransportMessage}
,{
ref:ZaAccount.A_zimbraMailTransport,type:_TEXTFIELD_,msgName:ZaMsg.NAD_MailTransport,label:ZaMsg.NAD_MailTransport,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:220}
,{
type:_DWT_ALERT_,content:ZaMsg.CannonicalWarning,visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailCanonicalAddress]],visibilityChangeEventSources:[ZaAccount.A_zimbraMailCanonicalAddress],containerCssStyle:"width:400px;",style:DwtAlert.WARNING,iconVisible:true}
,{
ref:ZaAccount.A_zimbraMailCanonicalAddress,type:_TEXTFIELD_,msgName:ZaMsg.NAD_CanonicalFrom,label:ZaMsg.NAD_CanonicalFrom,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:220}
]}
,{
type:_SPACER_,height:"10px"}
]}
)
}
q.tableCssStyle="width:100%;";
q.items=[{
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:4,width:"100%",colSizes:["60px","*","80px","*"],items:s}
]}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,choices:this.tabChoices,cssClass:"ZaTabBar",cssStyle:"display:none;",id:"xform_tabbar"}
,{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:o}
]
};
ZaTabView.XFormModifiers.ZaAccountXFormView.push(ZaAccountXFormView.myXFormModifier);
ZaAccountXFormView.prototype.getTabChoices=function(){
return this.tabChoices
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaAccChangePwdXDlg")){
ZaAccChangePwdXDlg=function(o,e,t){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.CANCEL_BUTTON,DwtDialog.OK_BUTTON];
ZaXDialog.call(this,o,null,ZaMsg.CHNP_Title,e,t,"ZaAccChangePwdXDlg");
this.initForm(ZaAccount.myXModel,this.getMyXForm());
this._helpURL=[location.pathname,ZaUtil.HELP_URL,ZaAccChangePwdXDlg.helpURL,"?locid=",AjxEnv.DEFAULT_LOCALE].join("")
};
ZaAccChangePwdXDlg.prototype=new ZaXDialog;
ZaAccChangePwdXDlg.prototype.constructor=ZaAccChangePwdXDlg;
ZaAccChangePwdXDlg.helpURL="passwords/setting_passwords.htm";
ZaAccChangePwdXDlg.prototype.getPassword=function(){
return this._localXForm.getInstance().attrs[ZaAccount.A_password]
};
ZaAccChangePwdXDlg.prototype.getConfirmPassword=function(){
return this._localXForm.getInstance()[ZaAccount.A2_confirmPassword]
};
ZaAccChangePwdXDlg.prototype.getMustChangePassword=function(){
return this._localXForm.getInstance().attrs[ZaAccount.A_zimbraPasswordMustChange]
};
ZaAccChangePwdXDlg.prototype.getMyXForm=function(){
var e={
numCols:2,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaAccount.A_password,type:_SECRET_,msgName:ZaMsg.NAD_Password,label:ZaMsg.NAD_Password,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaAccount.A2_confirmPassword,type:_SECRET_,msgName:ZaMsg.NAD_ConfirmPassword,label:ZaMsg.NAD_ConfirmPassword,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaAccount.A_zimbraPasswordMustChange,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_MustChangePwd,label:ZaMsg.NAD_MustChangePwd,trueValue:"TRUE",falseValue:"FALSE"}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaEditAliasXDialog")){
ZaEditAliasXDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t,null,ZaId.DLG_EDIT_ALIAS);
this._containedObject={};
this.initForm(ZaAlias.myXModel,this.getMyXForm());
this._helpURL=ZaEditAliasXDialog.helpURL
};
ZaEditAliasXDialog.prototype=new ZaXDialog;
ZaEditAliasXDialog.prototype.constructor=ZaEditAliasXDialog;
ZaEditAliasXDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/creating_a_mail_aliases.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaEditAliasXDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaAccount.A_name,type:_EMAILADDR_,label:null,visibilityChecks:[],enableDisableChecks:[]}
]}
]};
return e
};
ZaNewAliasXDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t,null,ZaId.DLG_NEW_ALIAS);
this._containedObject={};
this.initForm(ZaAlias.myXModel,this.getMyXForm());
this._helpURL=ZaNewAliasXDialog.helpURL
};
ZaNewAliasXDialog.prototype=new ZaXDialog;
ZaNewAliasXDialog.prototype.constructor=ZaNewAliasXDialog;
ZaNewAliasXDialog.prototype.supportMinimize=true;
ZaNewAliasXDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/creating_a_mail_aliases.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaNewAliasXDialog.prototype.getCacheName=function(){
return"newAliasDialog"
};
ZaNewAliasXDialog.prototype.setObject=function(e){
this._containedObject=e;
this._containedObject._uuid=this._containedObject._uuid||ZaUtil.getItemUUid();
this._localXForm.setInstance(this._containedObject)
};
ZaNewAliasXDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaAccount.A_name,type:_EMAILADDR_,label:ZaMsg.Alias_Dlg_label_alias,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DYNSELECT_,ref:ZaAlias.A_targetAccount,dataFetcherClass:ZaSearch,dataFetcherMethod:ZaSearch.prototype.dynSelectSearch,dataFetcherTypes:[ZaSearch.ACCOUNTS,ZaSearch.RESOURCES,ZaSearch.DLS],dataFetcherAttrs:[ZaItem.A_zimbraId,ZaItem.A_cn,ZaAccount.A_name,ZaAccount.A_displayname,ZaAccount.A_mail],label:ZaMsg.Alias_Dlg_label_target_acct,labelLocation:_LEFT_,width:"100%",inputWidth:"100%",editable:true,forceUpdate:true,choices:new XFormChoices([],XFormChoices.OBJECT_REFERENCE_LIST,"name","name"),visibilityChecks:[],enableDisableChecks:[],onChange:function(n,o,t){
if(n instanceof ZaItem){
this.setInstanceValue(n.name)
}else{
this.setInstanceValue(n)
}}
,autoCompleteEnabled:true}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaEditFwdAddrXDialog")){
ZaEditFwdAddrXDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t);
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/forwarding_mail.htm?locid="+AjxEnv.DEFAULT_LOCALE;
this._containedObject={};
this.initForm(ZaAlias.myXModel,this.getMyXForm())
};
ZaEditFwdAddrXDialog.prototype=new ZaXDialog;
ZaEditFwdAddrXDialog.prototype.constructor=ZaEditFwdAddrXDialog;
ZaEditFwdAddrXDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaAccount.A_name,type:_TEXTFIELD_,label:ZaMsg.Enter_EmailAddr,width:230,visibilityChecks:[],enableDisableChecks:[]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaEditFpXDialog")){
ZaEditFpXDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t);
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_global_settings/making_free_busy_view__available_.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaFp.getProviders();
this._containedObject={};
this.initForm(ZaFp.getXModel(),this.getMyXForm())
};
ZaEditFpXDialog.prototype=new ZaXDialog;
ZaEditFpXDialog.prototype.constructor=ZaEditFpXDialog;
ZaEditFpXDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaFp.A_prefix,type:_OSELECT1_,choices:ZaFp.INTEROP_PROVIDER_CHOICES,label:ZaMsg.Select_Interop_Provider,width:230,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaFp.A_name,type:_TEXTFIELD_,label:ZaMsg.Enter_ForeignAccount,width:230,visibilityChecks:[],enableDisableChecks:[]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaAccountListView")){
ZaAccountListView=function(r,s){
var n=null;
var o=DwtControl.ABSOLUTE_STYLE;
this._listType=s;
var t=this._getHeaderList();
var e;
if(!this._listType||this._listType==ZaItem.ACCOUNT){
e=ZaId.TAB_ACCT_MANAGE
}else{
if(this._listType==ZaItem.ALIAS){
e=ZaId.TAB_ALIAS_MANAGE
}else{
if(this._listType==ZaItem.DL){
e=ZaId.TAB_DL_MANAGE
}else{
if(this._listType==ZaItem.RESOURCE){
e=ZaId.TAB_RES_MANAGE
}else{
e=ZaId.TAB_UNDEF
}}}}
ZaListView.call(this,{
parent:r,className:n,posStyle:o,headerList:t,id:e,scrollLoading:true}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL);
this._domains={}
};
ZaAccountListView.prototype=new ZaListView;
ZaAccountListView.prototype.constructor=ZaAccountListView;
ZaAccountListView.prototype.toString=function(){
return"ZaAccountListView"
};
ZaAccountListView.prototype.getTitle=function(){
var e=ZaMsg.Addresses_view_title;
var t=ZaApp.getInstance().getControllerById(this.__internalId);
switch(t._defaultType){
case ZaItem.DL:e=ZaMsg.DL_view_title;
break;
case ZaItem.ALIAS:e=ZaMsg.Aliases_view_title;
break;
case ZaItem.RESOURCE:e=ZaMsg.Resourse_view_title;
break;
default:e=ZaMsg.Accounts_view_title
}
return e
};
ZaAccountListView.prototype.getTabIcon=function(){
var e=null;
var t=ZaApp.getInstance().getControllerById(this.__internalId);
switch(t._defaultType){
case ZaItem.DL:e="DistributionList";
break;
case ZaItem.ALIAS:e="AccountAlias";
break;
case ZaItem.RESOURCE:e="Resource";
break;
default:e="Account"
}
return e
};
ZaAccountListView.prototype._createItemHtml=function(u,o,l){
var d=new Array(50);
var t=document.createElement("div");
t[DwtListView._STYLE_CLASS]="Row";
t[DwtListView._SELECTED_STYLE_CLASS]=t[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
t.className=t[DwtListView._STYLE_CLASS];
this.associateItemWithElement(u,t,DwtListView.TYPE_LIST_ITEM);
var p=0;
d[p++]="<table width='100%' cellspacing='0' cellpadding='0'>";
d[p++]="<tr>";
var n=this._headerList.length;
var m=Dwt.getNextId();
var r=this._listType;
for(var c=0;
c<n;
c++){
var f=this._headerList[c]._field;
var s=this._getCellWidth(c,{}
);
if(f=="type"){
d[p++]='<td id="'+r+"_data_type_"+m+'" width='+s+">";
switch(u.type){
case ZaItem.ACCOUNT:if(u.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
d[p++]=AjxImg.getImageHtml("AdminUser")
}else{
if(u.attrs[ZaAccount.A_zimbraIsDelegatedAdminAccount]=="TRUE"){
d[p++]=AjxImg.getImageHtml("DomainAdminUser")
}else{
if(u.attrs[ZaAccount.A_zimbraIsSystemAccount]=="TRUE"){
d[p++]=AjxImg.getImageHtml("SpecialAccount")
}else{
if(u.attrs[ZaAccount.A_zimbraIsSystemResource]=="TRUE"){
d[p++]=AjxImg.getImageHtml("SystemResource")
}else{
if(u.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE"){
d[p++]=AjxImg.getImageHtml("AccountExternalVirtual")
}else{
if(u.isExternal){
d[p++]=AjxImg.getImageHtml("AccountIMAP")
}else{
d[p++]=AjxImg.getImageHtml("Account")
}}}}}}
break;
case ZaItem.DL:if(u.attrs[ZaDistributionList.A_isAdminGroup]=="TRUE"){
d[p++]=AjxImg.getImageHtml("DistributionListGroup")
}else{
d[p++]=AjxImg.getImageHtml("DistributionList")
}
break;
case ZaItem.ALIAS:d[p++]=AjxImg.getImageHtml("AccountAlias");
break;
case ZaItem.RESOURCE:if(u.attrs[ZaResource.A_zimbraCalResType]==ZaResource.RESOURCE_TYPE_LOCATION){
d[p++]=AjxImg.getImageHtml("Location")
}else{
d[p++]=AjxImg.getImageHtml("Resource")
}
break;
default:d[p++]=u.type;
break
}
d[p++]="</td>"
}else{
if(f==ZaAccount.A_name){
d[p++]='<td id="'+r+"_data_emailaddress_"+m+'" nowrap width='+s+"><nobr>";
d[p++]=AjxStringUtil.htmlEncode(u.name);
d[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_displayname){
d[p++]='<td id="'+r+"_data_displayname_"+m+'" nowrap width='+s+"><nobr>";
d[p++]=AjxStringUtil.htmlEncode(u.attrs[ZaAccount.A_displayname]);
d[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_accountStatus){
d[p++]='<td id="'+r+"_data_status_"+m+'" width='+s+"><nobr>";
var h="";
if(u.type==ZaItem.ACCOUNT){
h=ZaAccount._accountStatus(u.attrs[ZaAccount.A_accountStatus])
}else{
if(u.type==ZaItem.DL){
h=ZaDistributionList.getDLStatus(u.attrs.zimbraMailStatus)
}else{
if(u.type==ZaItem.RESOURCE){
h=ZaResource.getAccountStatusLabel(u.attrs[ZaAccount.A_accountStatus])
}}}
d[p++]=h;
d[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_zimbraLastLogonTimestamp){
d[p++]='<td id="'+r+"_data_lastlogontime_"+m+'" nowrap width='+s+"><nobr>";
d[p++]=AjxStringUtil.htmlEncode(ZaAccount.getLastLoginTime(u.attrs[ZaAccount.A_zimbraLastLogonTimestamp]));
d[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_description){
d[p++]='<td id="'+r+"_data_description_"+m+'" width='+s+"><nobr>";
d[p++]=AjxStringUtil.htmlEncode(ZaItem.getDescriptionValue(u.attrs[ZaAccount.A_description]));
d[p++]="</nobr></td>"
}else{
if(f=="target"+ZaAlias.A_targetType){
d[p++]='<td id="'+r+"_data_targettype_"+m+'" width='+s+"><nobr>";
var e=u.attrs[ZaAlias.A_targetType];
var g;
if(e==ZaItem.ACCOUNT){
g=ZaMsg.aliasTargetTypeAccount
}else{
if(e==ZaItem.DL){
g=ZaMsg.aliasTargetTypeDL
}else{
if(e=ZaItem.RESOURCE){
g=ZaMsg.aliasTargetTypeResource
}}}
d[p++]=AjxStringUtil.htmlEncode(g);
d[p++]="</nobr></td>"
}else{
if(f==ZaAlias.A_targetAccount){
d[p++]='<td id="'+r+"_data_targetaccount_"+m+'" width='+s+"><nobr>";
d[p++]=AjxStringUtil.htmlEncode(u.attrs[ZaAlias.A_targetAccount]);
d[p++]="</nobr></td>"
}}}}}}}}}
d[p++]="</tr></table>";
t.innerHTML=d.join("");
return t
};
ZaAccountListView.prototype._getHeaderList=function(o){
var e=new Array();
var n=1;
var t=0;
e[t++]=new ZaListHeaderItem("type",null,null,"22px",null,"objectClass",false,true);
this._defaultColumnSortable=n;
e[t++]=new ZaListHeaderItem(ZaAccount.A_name,ZaMsg.ALV_Name_col,null,"210px",n++,ZaAccount.A_name,true,true);
if(this._listType){
if(this._listType==ZaItem.ALIAS){
e[t++]=new ZaListHeaderItem(ZaAlias.A_targetAccount,ZaMsg.ALV_TargetName_col,null,"210px",n++,ZaAlias.A_targetAccount,true,true);
e[t++]=new ZaListHeaderItem("target"+ZaAlias.A_targetType,ZaMsg.ALV_TargetType_col,null,"200px",n++,ZaAlias.A_targetType,true,true)
}else{
e[t++]=new ZaListHeaderItem(ZaAccount.A_displayname,ZaMsg.ALV_DspName_col,null,"210px",n++,ZaAccount.A_displayname,true,true);
if(this._listType==ZaItem.DL){
e[t++]=new ZaListHeaderItem(ZaAccount.A_accountStatus,ZaMsg.ALV_Status_col,null,"120px",null,ZaAccount.A_accountStatus,true,true)
}else{
e[t++]=new ZaListHeaderItem(ZaAccount.A_accountStatus,ZaMsg.ALV_Status_col,null,"120px",n++,ZaAccount.A_accountStatus,true,true)
}
e[t++]=new ZaListHeaderItem(ZaAccount.A_zimbraLastLogonTimestamp,ZaMsg.ALV_Last_Login,null,"195px",n++,ZaAccount.A_zimbraLastLogonTimestamp,true,true)
}}else{
e[t++]=new ZaListHeaderItem(ZaAccount.A_displayname,ZaMsg.ALV_DspName_col,null,"210px",n++,ZaAccount.A_displayname,true,true);
e[t++]=new ZaListHeaderItem(ZaAccount.A_accountStatus,ZaMsg.ALV_Status_col,null,"120px",n++,ZaAccount.A_accountStatus,true,true);
e[t++]=new ZaListHeaderItem(ZaAccount.A_zimbraLastLogonTimestamp,ZaMsg.ALV_Last_Login,null,"195px",n++,ZaAccount.A_zimbraLastLogonTimestamp,true,true)
}
e[t++]=new ZaListHeaderItem(ZaAccount.A_description,ZaMsg.ALV_Description_col,null,"auto",null,null,false,true);
return e
};
ZaAccountListView.prototype._sortColumn=function(o,n){
try{
if(this._listType==ZaItem.DL){
viewId=ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW
}else{
if(this._listType==ZaItem.RESOURCE){
viewId=ZaZimbraAdmin._RESOURCE_LIST_VIEW
}else{
if(this._listType==ZaItem.ALIAS){
viewId=ZaZimbraAdmin._ALIASES_LIST_VIEW
}else{
viewId=ZaZimbraAdmin._ACCOUNTS_LIST_VIEW
}}}
var t=ZaApp.getInstance().getAccountListController(viewId);
t.setSortOrder(n);
t.setSortField(o.getSortField());
t.show()
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e)
}}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaNewAccountXWizard")){
ZaNewAccountXWizard=function(e,t){
ZaXWizardDialog.call(this,e,null,ZaMsg.NCD_NewAccTitle,"720px","300px","ZaNewAccountXWizard",null,ZaId.DLG_NEW_ACCT);
this.accountStatusChoices=[{
value:ZaAccount.ACCOUNT_STATUS_ACTIVE,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_ACTIVE)}
,{
value:ZaAccount.ACCOUNT_STATUS_CLOSED,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_CLOSED)}
,{
value:ZaAccount.ACCOUNT_STATUS_LOCKED,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_LOCKED)}
,{
value:ZaAccount.ACCOUNT_STATUS_PENDING,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_PENDING)}
,{
value:ZaAccount.ACCOUNT_STATUS_MAINTENANCE,label:ZaAccount.getAccountStatusMsg(ZaAccount.ACCOUNT_STATUS_MAINTENANCE)}
];
this.initForm(ZaAccount.myXModel,this.getMyXForm(t),null);
this._localXForm.setController();
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaNewAccountXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaNewAccountXWizard.prototype.handleXFormChange));
this._helpURL=ZaNewAccountXWizard.helpURL;
this._domains={}
};
ZaNewAccountXWizard.zimletChoices=new XFormChoices([],XFormChoices.SIMPLE_LIST);
ZaNewAccountXWizard.themeChoices=new XFormChoices([],XFormChoices.OBJECT_LIST);
ZaNewAccountXWizard.prototype=new ZaXWizardDialog;
ZaNewAccountXWizard.prototype.constructor=ZaNewAccountXWizard;
ZaNewAccountXWizard.prototype.toString=function(){
return"ZaNewAccountXWizard"
};
ZaXDialog.XFormModifiers.ZaNewAccountXWizard=new Array();
ZaNewAccountXWizard.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/create_an_account.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaNewAccountXWizard.prototype.handleXFormChange=function(){
if(this._localXForm.hasErrors()){
var t=true;
if(this._containedObject[ZaModel.currentStep]==ZaNewAccountXWizard.ALIASES_STEP){
var e=arguments[0];
if(e&&e.formItem&&(e.formItem.type=="emailaddr")){
t=!e.formItem.clearNameNullError()
}}
if(t){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
}}else{
if(this._containedObject.attrs[ZaAccount.A_lastName]&&this._containedObject[ZaAccount.A_name].indexOf("@")>0&&ZaAccount.isAccountTypeSet(this._containedObject)){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true);
if(this._containedObject[ZaModel.currentStep]!=this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}
if(this._containedObject[ZaModel.currentStep]!=ZaNewAccountXWizard.GENERAL_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}}};
ZaNewAccountXWizard.accountTypeItemId="account_type_output_"+Dwt.getNextId();
ZaNewAccountXWizard.prototype.updateAccountType=function(){
var e=this._localXForm.getItemsById(ZaNewAccountXWizard.accountTypeItemId)[0];
e.updateElement(ZaAccount.getAccountTypeOutput.call(e,true))
};
ZaNewAccountXWizard.cosGroupItemId="cos_grouper_"+Dwt.getNextId();
ZaNewAccountXWizard.prototype.updateCosGrouper=function(){
var e=this._localXForm.getItemsById(ZaNewAccountXWizard.cosGroupItemId)[0];
e.items[0].setElementEnabled(true);
e.updateElement()
};
ZaNewAccountXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
};
ZaNewAccountXWizard.prototype.createDomainAndAccount=function(t){
try{
var n=new ZaDomain();
n.name=t;
n.attrs[ZaDomain.A_domainName]=t;
var o=ZaItem.create(n,ZaDomain,"ZaDomain");
if(o!=null){
ZaApp.getInstance().getCurrentController().closeCnfrmDelDlg();
this.finishWizard()
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewAccountXWizard.prototype.createDomainAndAccount",null,false)
}};
ZaNewAccountXWizard.prototype.finishWizard=function(){
try{
if(this._containedObject.attrs[ZaAccount.A_password]){
if(this._containedObject.attrs[ZaAccount.A_password]!=this._containedObject[ZaAccount.A2_confirmPassword]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}}
if(!ZaAccount.checkValues(this._containedObject)){
return false
}
var t=ZaItem.create(this._containedObject,ZaAccount,"ZaAccount");
if(t!=null){
ZaApp.getInstance().getAccountListController().fireCreationEvent(t);
this.popdown();
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.AccountCreated,[t.name]))
}}
catch(e){
switch(e.code){
case ZmCsfeException.ACCT_EXISTS:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_EXISTS);
break;
case ZmCsfeException.NO_SUCH_COS:ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[this._containedObject.attrs[ZaAccount.A_COSId]]),e);
break;
case ZmCsfeException.ACCT_INVALID_PASSWORD:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_INVALID,e);
ZaApp.getInstance().getAppCtxt().getErrorDialog().showDetail(true);
break;
case ZmCsfeException.NO_SUCH_DOMAIN:ZaApp.getInstance().dialogs.confirmMessageDialog2.setMessage(AjxMessageFormat.format(ZaMsg.CreateDomain_q,[ZaAccount.getDomain(this._containedObject.name)]),DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.YES_BUTTON,this.createDomainAndAccount,this,[ZaAccount.getDomain(this._containedObject.name)]);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.NO_BUTTON,ZaController.prototype.closeCnfrmDelDlg,ZaApp.getInstance().getCurrentController(),null);
ZaApp.getInstance().dialogs.confirmMessageDialog2.popup();
break;
default:ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewAccountXWizard.prototype.finishWizard",null,false);
break
}}};
ZaNewAccountXWizard.prototype.goNext=function(){
if(this._containedObject[ZaModel.currentStep]==1){
if(this._containedObject.attrs[ZaAccount.A_password]){
if(this._containedObject.attrs[ZaAccount.A_password]!=this._containedObject[ZaAccount.A2_confirmPassword]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}}
if(ZaSearch.isAccountExist.call(this,{
name:this._containedObject[ZaAccount.A_name],popupError:true}
)){
return false
}
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}
this.goPage(this._containedObject[ZaModel.currentStep]+1);
if(this._containedObject[ZaModel.currentStep]==this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}};
ZaNewAccountXWizard.prototype.goPrev=function(){
if(this._containedObject[ZaModel.currentStep]==2){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}else{
if(this._containedObject[ZaModel.currentStep]==this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}}
this.goPage(this._containedObject[ZaModel.currentStep]-1)
};
ZaNewAccountXWizard.prototype.setObject=function(m){
this._containedObject=new ZaAccount();
this._containedObject.attrs=new Object();
for(var u in m.attrs){
this._containedObject.attrs[u]=m.attrs[u]
}
this._containedObject.name=m.name||"";
if(m._uuid){
this._containedObject._uuid=m._uuid
}
if(m.rights){
this._containedObject.rights=m.rights
}else{
this._containedObject.rights=[]
}
if(this._containedObject.rights[ZaAccount.RENAME_ACCOUNT_RIGHT]===undefined){
this._containedObject.rights[ZaAccount.RENAME_ACCOUNT_RIGHT]=true
}
if(m.setAttrs){
this._containedObject.setAttrs=m.setAttrs
}
if(m.getAttrs){
this._containedObject.getAttrs=m.getAttrs
}
if(m._defaultValues){
this._containedObject._defaultValues=m._defaultValues
}
this._containedObject.id=m.id||null;
this.cosChoices.setChoices([this._containedObject.cos]);
this.cosChoices.dirtyChoices();
this._containedObject.attrs[ZaAccount.A_accountStatus]=ZaAccount.ACCOUNT_STATUS_ACTIVE;
this._containedObject[ZaAccount.A2_autodisplayname]=m[ZaAccount.A2_autodisplayname]||"TRUE";
this._containedObject[ZaAccount.A2_autoMailServer]=m[ZaAccount.A2_autoMailServer]||"TRUE";
this._containedObject[ZaAccount.A2_autoCos]=m[ZaAccount.A2_autoCos]||"TRUE";
this._containedObject[ZaAccount.A2_confirmPassword]=m[ZaAccount.A2_confirmPassword]||null;
this._containedObject[ZaModel.currentStep]=m[ZaModel.currentStep]||1;
this._containedObject.attrs[ZaAccount.A_zimbraMailAlias]=m.attrs[ZaAccount.A_zimbraMailAlias]||new Array();
this._containedObject[ZaAccount.A2_errorMessage]=m[ZaAccount.A2_errorMessage]||"";
var s;
if(!s){
try{
s=ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraDefaultDomainName]
}
catch(c){
if(c.code!=ZmCsfeException.SVC_PERM_DENIED){
throw (c)
}}}
if(!s){
s=ZaSettings.myDomainName
}
this._containedObject[ZaAccount.A_name]="@"+s;
if(m[ZaAccount.A_name]){
this._containedObject[ZaAccount.A_name]=m[ZaAccount.A_name]
}
EmailAddr_XFormItem.domainChoices.setChoices([]);
EmailAddr_XFormItem.domainChoices.dirtyChoices();
var s=ZaAccount.getDomain(this._containedObject.name);
try{
var f=ZaDomain.getDomainByName(s);
this._containedObject[ZaAccount.A2_accountTypes]=f.getAccountTypes()
}
catch(c){
if(c.code==ZmCsfeException.SVC_PERM_DENIED){
this._containedObject[ZaAccount.A2_errorMessage]=AjxMessageFormat.format(ZaMsg.CANNOT_CREATE_ACCOUNTS_IN_THIS_DOMAIN,[s])
}else{
this._containedObject[ZaAccount.A2_errorMessage]="";
throw (c)
}}
this._containedObject[ZaAccount.A2_memberOf]=ZaAccountMemberOfListView.cloneMemberOf(m);
this._containedObject[ZaAccount.A2_directMemberList+"_offset"]=m[ZaAccount.A2_directMemberList+"_offset"];
this._containedObject[ZaAccount.A2_directMemberList+"_more"]=m[ZaAccount.A2_directMemberList+"_more"];
this._containedObject[ZaAccount.A2_indirectMemberList+"_offset"]=m[ZaAccount.A2_indirectMemberList+"_offset"];
this._containedObject[ZaAccount.A2_indirectMemberList+"_more"]=m[ZaAccount.A2_indirectMemberList+"_more"];
this._containedObject[ZaAccount.A2_nonMemberList+"_offset"]=m[ZaAccount.A2_nonMemberList+"_offset"];
this._containedObject[ZaAccount.A2_nonMemberList+"_more"]=m[ZaAccount.A2_nonMemberList+"_more"];
if(m.getAttrs[ZaAccount.A_zimbraAvailableSkin]||m.getAttrs.all){
var l=ZaApp.getInstance().getInstalledSkins();
if(AjxUtil.isEmpty(l)){
if(m._defaultValues&&m._defaultValues.attrs&&!AjxUtil.isEmpty(m._defaultValues.attrs[ZaAccount.A_zimbraAvailableSkin])){
l=m._defaultValues.attrs[ZaAccount.A_zimbraAvailableSkin]
}else{
l=[]
}}else{
if(AjxUtil.isString(l)){
l=[l]
}}
var h=ZaApp.getInstance().getSkinChoices(l);
ZaNewAccountXWizard.themeChoices.setChoices(h);
ZaNewAccountXWizard.themeChoices.dirtyChoices()
}
if(m.getAttrs[ZaAccount.A_zimbraZimletAvailableZimlets]||m.getAttrs.all){
var o=ZaZimlet.getAll("extension");
if(!AjxUtil.isEmpty(o)&&o instanceof ZaItemList||o instanceof AjxVector){
o=o.getArray()
}
if(AjxUtil.isEmpty(o)){
if(m._defaultValues&&m._defaultValues.attrs&&!AjxUtil.isEmpty(m._defaultValues.attrs[ZaAccount.A_zimbraZimletAvailableZimlets])){
o=m._defaultValues.attrs[ZaAccount.A_zimbraZimletAvailableZimlets]
}else{
o=[]
}
ZaNewAccountXWizard.zimletChoices.setChoices(o);
ZaNewAccountXWizard.zimletChoices.dirtyChoices()
}else{
var n=o.length;
var d=[];
for(var r=0;
r<n;
r++){
var t=o[r];
d.push(t.name)
}
ZaNewAccountXWizard.zimletChoices.setChoices(d);
ZaNewAccountXWizard.zimletChoices.dirtyChoices()
}}
if(f&&f.attrs&&f.attrs[ZaDomain.A_AuthMech]&&(f.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra)){
this._containedObject[ZaAccount.A2_isExternalAuth]=true
}else{
this._containedObject[ZaAccount.A2_isExternalAuth]=false
}
this._localXForm.setInstance(this._containedObject);
var e=this._localXForm.getItemsById(ZaAccount.A_name);
if(!AjxUtil.isEmpty(e)&&e[0]&&e[0].resetEditedState){
e[0].resetEditedState()
}};
ZaNewAccountXWizard.isAuthfromInternal=function(o,t){
var n=null;
if(t){
var e=this.getInstance();
if(e){
n=this.getInstanceValue(t)
}}
if(!n){
n=o
}
return ZaAccountXFormView.isAuthfromInternal(n)
};
ZaNewAccountXWizard.isDomainLeftAccountsAlertVisible=function(){
var t=this.getInstanceValue(ZaAccount.A2_domainLeftAccounts);
var e=this.getInstanceValue(ZaAccount.A2_accountTypes);
return(!AjxUtil.isEmpty(t)&&AjxUtil.isEmpty(e))
};
ZaNewAccountXWizard.isAccountsTypeAlertInvisible=function(){
var e=this.getInstanceValue(ZaAccount.A2_showAccountTypeMsg);
return(AjxUtil.isEmpty(e))
};
ZaNewAccountXWizard.isAccountTypeGrouperVisible=function(){
return !AjxUtil.isEmpty(this.getInstanceValue(ZaAccount.A2_accountTypes))
};
ZaNewAccountXWizard.isAccountTypeSet=function(){
return !ZaAccount.isAccountTypeSet(this.getInstance())
};
ZaNewAccountXWizard.isAutoDisplayname=function(){
return(this.getInstanceValue(ZaAccount.A2_autodisplayname)=="FALSE")
};
ZaNewAccountXWizard.isAutoCos=function(){
return(this.getInstanceValue(ZaAccount.A2_autoCos)=="FALSE")
};
ZaNewAccountXWizard.isContactsFeatureEnabled=function(){
return this.getInstanceValue(ZaAccount.A_zimbraFeatureDistributionListFolderEnabled)=="TRUE"
};
ZaNewAccountXWizard.isCalendarFeatureEnabled=function(){
return this.getInstanceValue(ZaAccount.A_zimbraFeatureCalendarEnabled)=="TRUE"
};
ZaNewAccountXWizard.isMailForwardingEnabled=function(){
return(this.getInstanceValue(ZaAccount.A_zimbraFeatureMailForwardingEnabled)=="TRUE")
};
ZaNewAccountXWizard.onCOSChanged=function(o,t,e){
if(ZaItem.ID_PATTERN.test(o)){
e.getInstance()._defaultValues=ZaCos.getCosById(o,e.parent._app);
this.setInstanceValue(o)
}else{
e.getInstance()._defaultValues=ZaCos.getCosByName(o,e.parent._app);
if(e.getInstance().cos){
o=e.getInstance()._defaultValues.id
}}
this.setInstanceValue(o);
e.parent._isCosChanged=true;
e.parent.updateAccountType();
return o
};
ZaNewAccountXWizard.getAccountNameInfoItem=function(){
if(AjxUtil.isEmpty(ZaNewAccountXWizard.accountNameInfoPool)){
ZaNewAccountXWizard.accountNameInfoPool=new Object();
ZaNewAccountXWizard.accountNameInfoPool[ZaAccount.A_name]={
ref:ZaAccount.A_name,type:_EMAILADDR_,msgName:ZaMsg.NAD_AccountName,label:ZaMsg.NAD_AccountName,bmolsnr:false,domainPartWidth:"100%",labelLocation:_LEFT_,onChange:ZaAccount.setDomainChanged,forceUpdate:true,enableDisableChecks:[],visibilityChecks:[]}
,ZaNewAccountXWizard.accountNameInfoPool[ZaAccount.A_firstName]={
ref:ZaAccount.A_firstName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_FirstName,label:ZaMsg.NAD_FirstName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150,elementChanged:function(r,s,n){
if(this.getInstance()[ZaAccount.A2_autodisplayname]=="TRUE"){
ZaAccount.generateDisplayName.call(this,this.getInstance(),r,this.getInstance().attrs[ZaAccount.A_lastName],this.getInstance().attrs[ZaAccount.A_initials])
}
this.getForm().itemChanged(this,r,n)
}};
ZaNewAccountXWizard.accountNameInfoPool[ZaAccount.A_initials]={
ref:ZaAccount.A_initials,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Initials,label:ZaMsg.NAD_Initials,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:50,elementChanged:function(r,s,n){
if(this.getInstance()[ZaAccount.A2_autodisplayname]=="TRUE"){
ZaAccount.generateDisplayName.call(this,this.getInstance(),this.getInstanceValue(ZaAccount.A_firstName),this.getInstanceValue(ZaAccount.A_lastName),r)
}
this.getForm().itemChanged(this,r,n)
}};
ZaNewAccountXWizard.accountNameInfoPool[ZaAccount.A_lastName]={
ref:ZaAccount.A_lastName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_LastName,label:ZaMsg.NAD_LastName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150,elementChanged:function(r,s,n){
if(this.getInstance()[ZaAccount.A2_autodisplayname]=="TRUE"){
ZaAccount.generateDisplayName.call(this,this.getInstance(),this.getInstanceValue(ZaAccount.A_firstName),r,this.getInstanceValue(ZaAccount.A_initials))
}
this.getForm().itemChanged(this,r,n)
}};
ZaNewAccountXWizard.accountNameInfoPool.ZaAccountDisplayInfoGroup={
type:_GROUP_,numCols:3,nowrap:true,width:200,msgName:ZaMsg.NAD_DisplayName,label:ZaMsg.NAD_DisplayName,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasReadPermission,ZaAccount.A_displayname]],items:[{
ref:ZaAccount.A_displayname,type:_TEXTFIELD_,label:null,cssClass:"admin_xform_name_input",width:150,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A2_autodisplayname,"FALSE"],ZaItem.hasWritePermission],enableDisableChangeEventSources:[ZaAccount.A2_autodisplayname],bmolsnr:true,visibilityChecks:[]}
,{
ref:ZaAccount.A2_autodisplayname,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",subLabel:"",elementChanged:function(r,s,n){
if(r=="TRUE"){
if(ZaAccount.generateDisplayName.call(this,this.getInstance(),this.getInstanceValue(ZaAccount.A_firstName),this.getInstanceValue(ZaAccount.A_lastName),this.getInstanceValue(ZaAccount.A_initials))){
this.getForm().parent.setDirty(true)
}}
this.getForm().itemChanged(this,r,n)
}
,enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_displayname]],visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_displayname]]}
]}
,ZaNewAccountXWizard.accountNameInfoPool[ZaAccount.A_zimbraHideInGal]={
ref:ZaAccount.A_zimbraHideInGal,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraHideInGal,subLabel:"",labelLocation:_RIGHT_,align:_RIGHT_,label:ZaMsg.LBL_zimbraHideInGal,trueValue:"TRUE",falseValue:"FALSE"}
,ZaNewAccountXWizard.accountNameInfoPool[ZaAccount.A_zimbraPhoneticFirstName]={
ref:ZaAccount.A_zimbraPhoneticFirstName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zimbraPhoneticFirstName,label:ZaMsg.NAD_zimbraPhoneticFirstName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150};
ZaNewAccountXWizard.accountNameInfoPool[ZaAccount.A_zimbraPhoneticLastName]={
ref:ZaAccount.A_zimbraPhoneticLastName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zimbraPhoneticLastName,label:ZaMsg.NAD_zimbraPhoneticLastName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150}
}
var t=new Array();
var o=new Array();
if(ZaZimbraAdmin.isLanguage("ja")){
o=[ZaAccount.A_name,ZaAccount.A_zimbraPhoneticLastName,ZaAccount.A_lastName,ZaAccount.A_initials,ZaAccount.A_zimbraPhoneticFirstName,ZaAccount.A_firstName,"ZaAccountDisplayInfoGroup",ZaAccount.A_zimbraHideInGal]
}else{
o=[ZaAccount.A_name,ZaAccount.A_firstName,ZaAccount.A_initials,ZaAccount.A_lastName,"ZaAccountDisplayInfoGroup",ZaAccount.A_zimbraHideInGal]
}
for(var e=0;
e<o.length;
e++){
t.push(ZaNewAccountXWizard.accountNameInfoPool[o[e]])
}
return t
};
ZaNewAccountXWizard.myXFormModifier=function(w,n){
var c=ZaSettings.myDomainName;
var l="@"+c;
var o=new Array();
this.stepChoices=[];
this.TAB_INDEX=0;
ZaNewAccountXWizard.GENERAL_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.GENERAL_STEP,label:ZaMsg.TABT_GeneralPage}
);
this.cosChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
var f={
type:_CASE_,tabGroupKey:ZaNewAccountXWizard.GENERAL_STEP,caseKey:ZaNewAccountXWizard.GENERAL_STEP,numCols:1,align:_LEFT_,valign:_TOP_};
var y=[{
type:_DWT_ALERT_,ref:ZaAccount.A2_domainLeftAccounts,visibilityChecks:[ZaNewAccountXWizard.isDomainLeftAccountsAlertVisible],visibilityChangeEventSources:[ZaAccount.A2_domainLeftAccounts,ZaAccount.A2_accountTypes,ZaAccount.A_name],bmolsnr:true,containerCssStyle:"width:400px;",style:DwtAlert.WARNING,iconVisible:false}
,{
type:_DWT_ALERT_,ref:ZaAccount.A2_warningMessage,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaAccount.A2_warningMessage]],visibilityChangeEventSources:[ZaAccount.A2_warningMessage],bmolsnr:true,containerCssStyle:"width:400px;",style:DwtAlert.WARNING,iconVisible:false}
,{
type:_DWT_ALERT_,ref:ZaAccount.A2_errorMessage,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaAccount.A2_errorMessage]],visibilityChangeEventSources:[ZaAccount.A2_errorMessage],bmolsnr:true,containerCssStyle:"width:400px;",style:DwtAlert.CRITICAL,iconVisible:false}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_AccountTypeGrouper,id:"account_wiz_type_group",colSpan:"*",numCols:1,colSizes:["100%"],visibilityChecks:[ZaNewAccountXWizard.isAccountTypeGrouperVisible,ZaAccount.isShowAccountType],visibilityChangeEventSources:[ZaAccount.A2_accountTypes,ZaAccount.A_COSId,ZaAccount.A_name,ZaAccount.A2_showAccountTypeMsg],items:[{
type:_DWT_ALERT_,visibilityChecks:[ZaNewAccountXWizard.isAccountTypeSet,ZaNewAccountXWizard.isAccountsTypeAlertInvisible],visibilityChangeEventSources:[ZaAccount.A2_accountTypes,ZaAccount.A_COSId,ZaAccount.A_name,ZaAccount.A2_showAccountTypeMsg],containerCssStyle:"width:400px;",style:DwtAlert.CRITICAL,iconVisible:false,content:ZaMsg.ERROR_ACCOUNT_TYPE_NOT_SET}
,{
type:_DWT_ALERT_,ref:ZaAccount.A2_showAccountTypeMsg,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaAccount.A2_showAccountTypeMsg]],visibilityChangeEventSources:[ZaAccount.A2_showAccountTypeMsg,ZaAccount.A_name],bmolsnr:true,containerCssStyle:"width:400px;",style:DwtAlert.WARNING,iconVisible:false}
,{
type:_OUTPUT_,id:ZaNewAccountXWizard.accountTypeItemId,getDisplayValue:ZaAccount.getAccountTypeOutput,valueChangeEventSources:[ZaAccount.A_name,ZaAccount.A_COSId,ZaAccount.A2_accountTypes,ZaAccount.A2_currentAccountType],cssStyle:"margin-left:auto;margin-right:auto;width:600px;"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_AccountNameGrouper,id:"account_wiz_name_group",numCols:2,items:ZaNewAccountXWizard.getAccountNameInfoItem(),displayLabelItem:true,headerLabelWidth:"100px",headerItems:[{
ref:ZaAccount.A_name,type:_EMAILADDR_,msgName:ZaMsg.NAD_AccountName,labelLocation:_LEFT_,onChange:ZaAccount.setDomainChanged,forceUpdate:true,enableDisableChecks:[[ZaItem.hasRight,ZaAccount.RENAME_ACCOUNT_RIGHT]],visibilityChecks:[]}
]}
];
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_accountStatus,ZaAccount.A_COSId,ZaAccount.A_zimbraIsAdminAccount,ZaAccount.A_mailHost],[])){
var h={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_AccountSetupGrouper,id:"account_wiz_setup_group",numCols:2,colSizes:["200px","400px"],items:[{
ref:ZaAccount.A_accountStatus,type:_OSELECT1_,msgName:ZaMsg.NAD_AccountStatus,label:ZaMsg.NAD_AccountStatus,labelLocation:_LEFT_,choices:this.accountStatusChoices}
],headerItems:[{
ref:ZaAccount.A_accountStatus,type:_OSELECT1_,bmolsnr:true,labelLocation:_LEFT_,choices:this.accountStatusChoices}
],displayLabelItem:true,headerLabelWidth:"100px"};
h.items.push({
type:_GROUP_,numCols:3,nowrap:true,label:ZaMsg.NAD_ClassOfService,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_COSId]],id:ZaNewAccountXWizard.cosGroupItemId,items:[{
ref:ZaAccount.A_COSId,label:null,type:_INPUT_,onChange:ZaAccount.setCosChanged,enableDisableChecks:[[ZaNewAccountXWizard.isAutoCos],[ZaItem.hasWritePermission,ZaAccount.A_COSId]],enableDisableChangeEventSources:[ZaAccount.A2_autoCos],getDisplayValue:function(q){
if(q){
var x=ZaCos.getCosById(q);
return x&&x.name
}}}
,{
ref:ZaAccount.A2_autoCos,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",subLabel:"",elementChanged:function(T,j,q){
var z=this.getParentItem().getItems()[0];
var x=this.getForm();
if(T=="TRUE"){
z.updateElement(null);
ZaAccount.setDefaultCos(this.getInstance(),x.parent._app)
}else{
z.createDataList(ZaApp.getInstance().getCosListName())
}
x.itemChanged(this,T,q)
}
,enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_COSId]],visibilityChecks:[]}
]}
);
h.items.push({
ref:ZaAccount.A_zimbraIsAdminAccount,type:_WIZ_CHECKBOX_,labelLocation:_RIGHT_,align:_RIGHT_,subLabel:"",visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraIsAdminAccount]],msgName:ZaMsg.NAD_IsSystemAdminAccount,label:ZaMsg.NAD_IsSystemAdminAccount,bmolsnr:true,trueValue:"TRUE",falseValue:"FALSE"}
);
h.items.push({
type:_GROUP_,numCols:3,nowrap:true,label:ZabMsg.attrDesc_mailHost,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_mailHost]],items:[{
ref:ZaAccount.A_mailHost,type:_OSELECT1_,label:null,editable:false,choices:ZaApp.getInstance().getServerListChoices(),enableDisableChecks:[ZaAccount.isAutoMailServer],enableDisableChangeEventSources:[ZaAccount.A2_autoMailServer],visibilityChecks:[],tableCssStyle:"height:15px;"}
,{
ref:ZaAccount.A2_autoMailServer,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[],labelLocation:_RIGHT_,align:_RIGHT_,subLabel:"",enableDisableChecks:[]}
]}
);
y.push(h)
}
var r={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_PasswordGrouper,id:"account_wiz_password_group",numCols:2,visibilityChecks:[[ZaItem.adminHasAnyRight,[ZaAccount.SET_PASSWORD_RIGHT,ZaAccount.CHANGE_PASSWORD_RIGHT]],[XForm.checkInstanceValueNot,ZaAccount.A2_isExternalAuth,true]],visibilityChangeEventSources:[ZaAccount.A2_isExternalAuth],items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:false,content:ZaMsg.Alert_InternalPassword}
,{
ref:ZaAccount.A_password,type:_SECRET_,msgName:ZaMsg.NAD_Password,label:ZaMsg.NAD_Password,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]],cssClass:"admin_xform_name_input"}
,{
ref:ZaAccount.A2_confirmPassword,type:_SECRET_,msgName:ZaMsg.NAD_ConfirmPassword,label:ZaMsg.NAD_ConfirmPassword,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]],cssClass:"admin_xform_name_input"}
,{
ref:ZaAccount.A_zimbraPasswordMustChange,type:_WIZ_CHECKBOX_,labelLocation:_RIGHT_,align:_RIGHT_,subLabel:"",msgName:ZaMsg.NAD_MustChangePwd,label:ZaMsg.NAD_MustChangePwd,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
]};
y.push(r);
var e={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_ExternalAuthGrouper,id:"account_wiz_ext_auth_group",numCols:2,visibilityChecks:[[XForm.checkInstanceValue,ZaAccount.A2_isExternalAuth,true],[ZaItem.hasReadPermission,ZaAccount.A_zimbraAuthLdapExternalDn]],visibilityChangeEventSources:[ZaAccount.A2_isExternalAuth],items:[{
ref:ZaAccount.A_zimbraAuthLdapExternalDn,type:_TEXTFIELD_,width:256,msgName:ZaMsg.NAD_AuthLdapExternalDn,label:ZaMsg.NAD_AuthLdapExternalDn,labelLocation:_LEFT_,align:_LEFT_,toolTipContent:ZaMsg.tt_AuthLdapExternalDn}
]};
y.push(e);
var b={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_TimezoneGrouper,id:"account_wiz_timezone_group",visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefTimeZoneId]],numCols:2,items:[{
ref:ZaAccount.A_zimbraPrefTimeZoneId,type:_SELECT1_,msgName:ZaMsg.LBL_zimbraPrefTimeZoneId,label:ZaMsg.LBL_zimbraPrefTimeZoneId,labelLocation:_LEFT_}
]};
y.push(b);
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_description,ZaAccount.A_notes],[])){
var t={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_NotesGrouper,id:"account_wiz_notes_group",numCols:2,items:[{
ref:ZaAccount.A_description,type:_INPUT_,msgName:ZaMsg.NAD_Description,label:ZaMsg.NAD_Description,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_description]],enableDisableChecks:[]}
,{
ref:ZaAccount.A_notes,type:_TEXTAREA_,msgName:ZaMsg.NAD_Notes,label:ZaMsg.NAD_Notes,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em",visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_notes]],enableDisableChecks:[]}
]};
y.push(t)
}
f.items=y;
o.push(f);
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.CONTACT_TAB_ATTRS,ZaAccountXFormView.CONTACT_TAB_RIGHTS)&&!ZaSettings.isOctopus()){
ZaNewAccountXWizard.CONTACT_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.CONTACT_STEP,label:ZaMsg.TABT_ContactInfo}
);
var d={
type:_CASE_,caseKey:ZaNewAccountXWizard.CONTACT_STEP,tabGroupKey:ZaNewAccountXWizard.CONTACT_STEP,numCols:1,items:[{
type:_ZAWIZGROUP_,items:[{
ref:ZaAccount.A_telephoneNumber,type:_TEXTFIELD_,msgName:ZaMsg.NAD_telephoneNumber,label:ZaMsg.NAD_telephoneNumber,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_homePhone,type:_TEXTFIELD_,msgName:ZaMsg.NAD_homePhone,label:ZaMsg.NAD_homePhone,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_mobile,type:_TEXTFIELD_,msgName:ZaMsg.NAD_mobile,label:ZaMsg.NAD_mobile,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_pager,type:_TEXTFIELD_,msgName:ZaMsg.NAD_pager,label:ZaMsg.NAD_pager,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_facsimileTelephoneNumber,type:_TEXTFIELD_,msgName:ZaMsg.NAD_facsimileTelephoneNumber,label:ZaMsg.NAD_facsimileTelephoneNumber,labelLocation:_LEFT_,width:250}
]}
,{
type:_ZAWIZGROUP_,items:[{
ref:ZaAccount.A_zimbraPhoneticCompany,type:_TEXTFIELD_,msgName:ZaMsg.NAD_zimbraPhoneticCompany,label:ZaMsg.NAD_zimbraPhoneticCompany,labelLocation:_LEFT_,width:250,visibilityChecks:[[ZaZimbraAdmin.isLanguage,"ja"]]}
,{
ref:ZaAccount.A_company,type:_TEXTFIELD_,msgName:ZaMsg.NAD_company,label:ZaMsg.NAD_company,labelLocation:_LEFT_,width:250}
,{
ref:ZaAccount.A_title,type:_TEXTFIELD_,msgName:ZaMsg.NAD_title,label:ZaMsg.NAD_title,labelLocation:_LEFT_,width:250}
]}
,{
type:_ZAWIZGROUP_,items:ZaAccountXFormView.getAddressFormItemForDialog()}
]};
o.push(d)
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.ALIASES_TAB_ATTRS,ZaAccountXFormView.ALIASES_TAB_RIGHTS)){
ZaNewAccountXWizard.ALIASES_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.ALIASES_STEP,label:ZaMsg.TABT_Aliases}
);
o.push({
type:_CASE_,tabGroupKey:ZaNewAccountXWizard.ALIASES_STEP,caseKey:ZaNewAccountXWizard.ALIASES_STEP,numCols:1,items:[{
type:_OUTPUT_,value:ZaMsg.NAD_AccountAliases}
,{
ref:ZaAccount.A_zimbraMailAlias,type:_REPEAT_,label:null,repeatInstance:l,showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddAlias,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveAlias,removeButtonCSSStyle:"margin-left:50px;",visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]],items:[{
ref:".",type:_EMAILADDR_,label:null,enableDisableChecks:[],visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]]}
]}
]}
)
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.MEMBEROF_TAB_ATTRS,ZaAccountXFormView.MEMBEROF_TAB_RIGHTS)){
var v=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.DIRECT);
var p=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.INDIRECT,150);
var m=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.NON);
ZaNewAccountXWizard.MEMBEROF_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.MEMBEROF_STEP,label:ZaMsg.TABT_MemberOf}
);
var s={
type:_CASE_,caseKey:ZaNewAccountXWizard.MEMBEROF_STEP,tabGroupKey:ZaNewAccountXWizard.MEMBEROF_STEP,numCols:2,colSizes:["50%","50%"],id:"memberof_step",items:[{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_DirectGroupLabel,containerCssStyle:"padding-top:5px;",items:[{
ref:ZaAccount.A2_directMemberList,type:_S_DWT_LIST_,width:"98%",height:208,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:v,defaultColumnSortable:0,onSelection:ZaAccountXFormView.directMemberOfSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[90,5,90,"auto",30,5,30,5],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemoveAll,width:90,enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAllButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList],onActivate:"ZaAccountMemberOfListView.removeAllGroups.call(this,event, ZaAccount.A2_directMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemove,width:90,id:"removeButton",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAddRemoveButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberListSelected],onActivate:"ZaAccountMemberOfListView.removeGroups.call(this,event, ZaAccount.A2_directMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:"",width:30,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_offset"]}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:"",width:30,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_more"]}
,{
type:_CELLSPACER_,height:"100%"}
]}
]}
,{
type:_SPACER_,height:"5"}
,{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_IndirectGroupLabel,containerCssStyle:"padding-top:5px;",items:[{
ref:ZaAccount.A2_indirectMemberList,type:_S_DWT_LIST_,width:"98%",height:208,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:p,defaultColumnSortable:0,onSelection:ZaAccountXFormView.indirectMemberOfSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:5,colSizes:["auto",30,5,30,5],items:[{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:"",width:30,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_offset"]}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:"",width:30,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_more"]}
,{
type:_CELLSPACER_,height:"100%"}
]}
]}
]}
,{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_ZARIGHT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_NonGroupLabel,containerCssStyle:"padding-top:5px;",items:[{
type:_GROUP_,numCols:3,colSizes:["40","auto","80"],width:"98%",items:[{
ref:"query",type:_TEXTFIELD_,width:"100%",cssClass:"admin_xform_name_input",nowrap:false,labelWrap:true,label:ZaMsg.DLXV_LabelFind,visibilityChecks:[],enableDisableChecks:[],elementChanged:function(z,j,q){
var x=q.charCode;
if(x==13||x==3){
ZaAccountMemberOfListView.prototype.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,z,q)
}}}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,width:80,onActivate:ZaAccountMemberOfListView.prototype.srchButtonHndlr}
,{
ref:ZaAccount.A2_showSameDomain,type:_WIZ_CHECKBOX_,labelLocation:_RIGHT_,align:_RIGHT_,subLabel:"",label:null,labelLocation:_NONE_,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[]}
,{
type:_OUTPUT_,value:ZaMsg.NAD_SearchSameDomain,colSpan:2}
]}
,{
ref:ZaAccount.A2_nonMemberList,type:_S_DWT_LIST_,width:"98%",height:460,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:m,defaultColumnSortable:0,onSelection:ZaAccountXFormView.nonMemberOfSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[90,5,90,"auto",30,5,30,5],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddFromList,width:90,enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAddRemoveButton,ZaAccount.A2_nonMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_nonMemberListSelected],onActivate:"ZaAccountMemberOfListView.addGroups.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddAll,width:90,enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableAllButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.addAllGroups.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:"",width:30,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_offset"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
,{
type:_DWT_BUTTON_,label:"",width:30,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_more"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_,height:"100%"}
]}
]}
]}
,{
type:_GROUP_,width:"100%",items:[{
type:_CELLSPACER_}
]}
]};
o.push(s)
}
var k={
ref:ZaAccount.A_zimbraFeatureMailForwardingEnabled,msgName:ZaMsg.LBL_zimbraFeatureMailForwardingEnabled,trueValue:"TRUE",falseValue:"FALSE"};
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.FORWARDING_TAB_ATTRS,ZaAccountXFormView.FORWARDING_TAB_RIGHTS)){
ZaNewAccountXWizard.FORWARDING_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.FORWARDING_STEP,label:ZaMsg.TABT_Forwarding}
);
o.push({
type:_CASE_,caseKey:ZaNewAccountXWizard.FORWARDING_STEP,tabGroupKey:ZaNewAccountXWizard.FORWARDING_STEP,numCols:2,colSizes:["250px","auto"],id:"account_form_forwarding_step",items:[{
ref:ZaAccount.A_zimbraFeatureMailForwardingEnabled,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailForwardingEnabled,trueValue:"TRUE",falseValue:"FALSE",colSizes:["250px","250px","auto"]}
,{
ref:ZaAccount.A_zimbraPrefMailLocalDeliveryDisabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMailLocalDeliveryDisabled,label:ZaMsg.LBL_zimbraPrefMailLocalDeliveryDisabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMailForwardingAddress,width:250,labelCssClass:"xform_label",type:_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraPrefMailForwardingAddress,label:ZaMsg.LBL_zimbraPrefMailForwardingAddress,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",nowrap:false,labelWrap:true,enableDisableChecks:[ZaAccountXFormView.isMailForwardingEnabled],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureMailForwardingEnabled,ZaAccount.A_COSId]}
,{
type:_SEPARATOR_,colSpan:2}
,{
type:_DWT_ALERT_,colSpan:2,containerCssStyle:"padding:0 10px 10px;width:100%;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_Bouncing_Reveal_Hidden_Adds}
,{
ref:ZaAccount.A_zimbraMailForwardingAddress,type:_REPEAT_,label:ZaMsg.NAD_EditFwdGroup,labelLocation:_LEFT_,labelCssClass:"xform_label",repeatInstance:l,showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddAddress,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveAddress,nowrap:false,labelWrap:true,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:250,enableDisableChecks:[],visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailForwardingAddress]]}
]}
,{
ref:ZaAccount.A_zimbraPrefCalendarForwardInvitesTo,type:_REPEAT_,label:ZaMsg.zimbraPrefCalendarForwardInvitesTo,labelLocation:_LEFT_,labelCssClass:"xform_label",repeatInstance:l,showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddAddress,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveAddress,nowrap:false,labelWrap:true,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:250,enableDisableChecks:[],visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefCalendarForwardInvitesTo]]}
]}
]}
)
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.FEATURE_TAB_ATTRS,ZaAccountXFormView.FEATURE_TAB_RIGHTS)&&!ZaSettings.isOctopus()){
ZaNewAccountXWizard.FEATURES_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.FEATURES_STEP,label:ZaMsg.TABT_Features}
);
var u={
type:_CASE_,caseKey:ZaNewAccountXWizard.FEATURES_STEP,tabGroupKey:ZaNewAccountXWizard.FEATURES_STEP,id:"account_form_features_step",numCols:1,width:"100%",items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-top:20px;width:400px;",style:DwtAlert.WARNING,iconVisible:false,content:ZaMsg.NAD_CheckFeaturesInfo}
]};
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraFeatureMailEnabled,ZaAccount.A_zimbraFeatureContactsEnabled,ZaAccount.A_zimbraFeatureCalendarEnabled,ZaAccount.A_zimbraFeatureTasksEnabled,ZaAccount.A_zimbraFeatureTasksEnabled,ZaAccount.A_zimbraFeatureBriefcasesEnabled,ZaAccount.A_zimbraFeatureOptionsEnabled],[])){
u.items.push({
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMajorFeature,id:"account_wiz_features_major",colSizes:["auto"],numCols:1,items:[{
ref:ZaAccount.A_zimbraFeatureMailEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMailEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureContactsEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureContactsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureContactsEnabled,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureCalendarEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureCalendarEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureTasksEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureTaskEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureTaskEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureBriefcasesEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureOptionsEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureOptionsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureOptionsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraFeatureTaggingEnabled,ZaAccount.A_zimbraFeatureSharingEnabled,ZaAccount.A_zimbraFeatureChangePasswordEnabled,ZaAccount.A_zimbraFeatureSkinChangeEnabled,ZaAccount.A_zimbraFeatureManageZimlets,ZaAccount.A_zimbraFeatureGalEnabled,ZaAccount.A_zimbraFeatureMAPIConnectorEnabled,ZaAccount.A_zimbraFeatureEwsEnabled,ZaAccount.A_zimbraFeatureTouchClientEnabled,ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled,ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled,ZaAccount.A_zimbraFeatureImportFolderEnabled,ZaAccount.A_zimbraFeatureExportFolderEnabled,ZaAccount.A_zimbraDumpsterEnabled],[])){
u.items.push({
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraGeneralFeature,id:"account_wiz_features_general",colSizes:["auto"],numCols:1,items:[{
ref:ZaAccount.A_zimbraFeatureTaggingEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureTaggingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureTaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureSharingEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSharingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSharingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraExternalSharingEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraExternalSharingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraExternalSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaAccount.A_zimbraPublicSharingEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPublicSharingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPublicSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaAccount.A_zimbraFeatureChangePasswordEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureSkinChangeEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureManageZimlets,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureManageZimlets,checkBoxLabel:ZaMsg.LBL_zimbraFeatureManageZimlets,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureHtmlComposeEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureGalEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureGalEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureGalEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureMAPIConnectorEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureEwsEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureEwsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureEwsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureTouchClientEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureTouchClientEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureTouchClientEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureWebClientOfflineAccessEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureWebClientOfflineAccessEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureWebClientOfflineAccessEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureGalAutoCompleteEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureImportFolderEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureExportFolderEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraDumpsterEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraDumpsterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraDumpsterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraDumpsterPurgeEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraDumpsterPurgeEnabled,checkBoxLabel:ZaMsg.LBL_zimbraDumpsterPurgeEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraDumpsterEnabled]}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraFeatureMailPriorityEnabled,ZaAccount.A_zimbraFeatureFlaggingEnabled,ZaAccount.A_zimbraImapEnabled,ZaAccount.A_zimbraPop3Enabled,ZaAccount.A_zimbraFeatureImapDataSourceEnabled,ZaAccount.A_zimbraFeaturePop3DataSourceEnabled,ZaAccount.A_zimbraFeatureConversationsEnabled,ZaAccount.A_zimbraFeatureFiltersEnabled,ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled,ZaAccount.A_zimbraFeatureNewMailNotificationEnabled,ZaAccount.A_zimbraFeatureMailSendLaterEnabled,ZaAccount.A_zimbraFeatureIdentitiesEnabled,ZaAccount.A_zimbraFeatureReadReceiptsEnabled],[])){
u.items.push({
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMailFeature,id:"account_wiz_features_mail",colSizes:["auto"],numCols:1,enableDisableChecks:[ZaAccountXFormView.isMailFeatureEnabled],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureMailEnabled,ZaAccount.A_COSId],items:[{
ref:ZaAccount.A_zimbraFeatureMailPriorityEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureFlaggingEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraImapEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraImapEnabled,checkBoxLabel:ZaMsg.LBL_zimbraImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPop3Enabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPop3Enabled,checkBoxLabel:ZaMsg.LBL_zimbraPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureImapDataSourceEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraExternalImapEnabled,checkBoxLabel:ZaMsg.LBL_zimbraExternalImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeaturePop3DataSourceEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraExternalPop3Enabled,checkBoxLabel:ZaMsg.LBL_zimbraExternalPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureMailSendLaterEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureConversationsEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureConversationsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureConversationsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureFiltersEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureFiltersEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureFiltersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureOutOfOfficeReplyEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureNewMailNotificationEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureIdentitiesEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureReadReceiptsEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraFeatureReadReceiptsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraFeatureContactsEnabled,ZaAccount.A_zimbraFeatureDistributionListFolderEnabled],[])){
u.items.push({
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraContactFeature,id:"account_wiz_features_contact",enableDisableChecks:[ZaNewAccountXWizard.isContactsFeatureEnabled],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureContactsEnabled,ZaAccount.A_COSId],items:[{
ref:ZaAccount.A_zimbraFeatureDistributionListFolderEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraFeatureDistributionListFolderEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureDistributionListFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraFeatureGroupCalendarEnabled,ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled],[])){
u.items.push({
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraCalendarFeature,id:"account_wiz_features_calendar",colSizes:["auto"],numCols:1,enableDisableChecks:[ZaAccountXFormView.isCalendarFeatureEnabled],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureCalendarEnabled,ZaAccount.A_COSId],items:[{
ref:ZaAccount.A_zimbraFeatureGroupCalendarEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraFeatureAdvancedSearchEnabled,ZaAccount.A_zimbraFeatureSavedSearchesEnabled,ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled,ZaAccount.A_zimbraFeaturePeopleSearchEnabled],[])){
u.items.push({
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSearchFeature,id:"account_wiz_features_search",colSizes:["auto"],numCols:1,items:[{
ref:ZaAccount.A_zimbraFeatureAdvancedSearchEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureSavedSearchesEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeatureInitialSearchPreferenceEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraFeaturePeopleSearchEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraFeatureSMIMEEnabled],[])){
u.items.push({
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSMIMEFeature,id:"account_wiz_features_smime",colSizes:["auto"],numCols:1,items:[{
ref:ZaAccount.A_zimbraFeatureSMIMEEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,checkBoxLabel:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
o.push(u)
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.PREFERENCES_TAB_ATTRS,ZaAccountXFormView.PREFERENCES_TAB_RIGHTS)){
ZaNewAccountXWizard.PREFS_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.PREFS_STEP,label:ZaMsg.TABT_Preferences}
);
var g=[];
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPrefImapSearchFoldersEnabled,ZaAccount.A_zimbraPrefShowSearchString,ZaAccount.A_zimbraPrefUseKeyboardShortcuts,ZaAccount.A_zimbraPrefMailInitialSearch,ZaAccount.A_zimbraPrefWarnOnExit,ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit,ZaAccount.A_zimbraPrefShowSelectionCheckbox,ZaAccount.A_zimbraJunkMessagesIndexingEnabled,ZaAccount.A_zimbraPrefLocale],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_general",label:ZaMsg.NAD_GeneralOptions,items:[{
ref:ZaAccount.A_zimbraPrefImapSearchFoldersEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefShowSearchString,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefShowSearchString,checkBoxLabel:ZaMsg.LBL_zimbraPrefShowSearchString,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefUseKeyboardShortcuts,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraPrefUseKeyboardShortcuts,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefClientType,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.MSG_zimbraPrefClientType,label:ZaMsg.LBL_zimbraPrefClientType,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefMailInitialSearch,type:_SUPERWIZ_TEXTFIELD_,colSpan:2,colSizes:["200px","300px","*"],msgName:ZaMsg.LBL_zimbraPrefMailInitialSearch,txtBoxLabel:ZaMsg.LBL_zimbraPrefMailInitialSearch,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefWarnOnExit,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraPrefWarnOnExit,labelWrap:true,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZabMsg.LBL_zimbraPrefAdminConsoleWarnOnExit,labelWrap:true,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefShowSelectionCheckbox,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraPrefShowSelectionCheckbox,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraJunkMessagesIndexingEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,checkBoxLabel:ZaMsg.LBL_zimbraJunkMessagesIndexingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefLocale,type:_SUPERWIZ_SELECT1_,msgName:ZaMsg.LBL_zimbraPrefMailLocale,choices:ZaSettings.getLocaleChoices(),colSizes:["300px","*"],label:ZaMsg.LBL_zimbraPrefLocale,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPrefMailItemsPerPage,ZaAccount.A_zimbraMaxMailItemsPerPage],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_standard_client",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsStandardClient,items:[{
ref:ZaAccount.A_zimbraMaxMailItemsPerPage,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],editable:true,inputSize:4,choices:[10,25,50,100,250,500,1000],msgName:ZaMsg.MSG_zimbraMaxMailItemsPerPage,label:ZaMsg.LBL_zimbraMaxMailItemsPerPage,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,valueLabel:null}
,{
ref:ZaAccount.A_zimbraPrefMailItemsPerPage,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.MSG_zimbraPrefMailItemsPerPage,label:ZaMsg.LBL_zimbraPrefMailItemsPerPage,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,valueLabel:null}
]}
);
g.push({
type:_SPACER_,height:"10px"}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPrefMessageViewHtmlPreferred,ZaAccount.A_zimbraPrefDisplayExternalImages,ZaAccount.A_zimbraPrefMailToasterEnabled,ZaAccount.A_zimbraPrefMessageIdDedupingEnabled,ZaAccount.A_zimbraPrefGroupMailBy,ZaAccount.A_zimbraPrefMailDefaultCharset,ZaAccount.A_zimbraPrefItemsPerVirtualPage],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_mail_general",label:ZaMsg.NAD_MailOptions,items:[{
ref:ZaAccount.A_zimbraPrefMessageViewHtmlPreferred,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,checkBoxLabel:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefDisplayExternalImages,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefDisplayExternalImages,checkBoxLabel:ZaMsg.LBL_zimbraPrefDisplayExternalImages,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefGroupMailBy,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefGroupMailBy,label:ZaMsg.LBL_zimbraPrefGroupMailBy,labelLocation:_LEFT_}
,{
ref:ZaAccount.A_zimbraPrefMailDefaultCharset,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.LBL_zimbraPrefMailDefaultCharset,label:ZaMsg.LBL_zimbraPrefMailDefaultCharset,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefMailToasterEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefMailToasterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefMailToasterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMessageIdDedupingEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefMessageIdDedupingEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefMessageIdDedupingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefItemsPerVirtualPage,type:_SUPERWIZ_TEXTFIELD_,colSizes:["200px","*"],colSpan:2,nowrap:false,labelWrap:true,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage,txtBoxLabel:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPrefMailPollingInterval,ZaAccount.A_zimbraMailMinPollingInterval,ZaAccount.A_zimbraPrefNewMailNotificationEnabled,ZaAccount.A_zimbraPrefNewMailNotificationAddress,ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration,ZaAccount.A_zimbraPrefOutOfOfficeReply,ZaAccount.A_zimbraPrefReadReceiptsToAddress,ZaAccount.A_zimbraPrefMailSendReadReceipts],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_mail_receiving",label:ZaMsg.NAD_MailOptionsReceiving,items:[{
ref:ZaAccount.A_zimbraPrefMailPollingInterval,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.MSG_zimbraPrefMailPollingInterval,label:ZaMsg.LBL_zimbraPrefMailPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,onChange:ZaAccountXFormView.validatePollingInterval,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraMailMinPollingInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","130px","170px","*"],msgName:ZaMsg.MSG_zimbraMailMinPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraMailMinPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,onChange:ZaAccountXFormView.validatePollingInterval,colSpan:2,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefNewMailNotificationEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefNewMailNotificationEnabled,label:ZaMsg.LBL_zimbraPrefNewMailNotificationEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefNewMailNotificationAddress,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPrefNewMailNotificationAddress,label:ZaMsg.LBL_zimbraPrefNewMailNotificationAddress,labelLocation:_LEFT_,enableDisableChecks:[ZaAccountXFormView.isMailNotificationAddressEnabled],enableDisableChangeEventSources:[ZaAccount.A_zimbraPrefNewMailNotificationEnabled]}
,{
ref:ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefOutOfOfficeReplyEnabled,label:ZaMsg.LBL_zimbraPrefOutOfOfficeReplyEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefOutOfOfficeCacheDuration,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","130px","170px","*"],msgName:ZaMsg.LBL_zimbraPrefOutOfOfficeCacheDuration,txtBoxLabel:ZaMsg.LBL_zimbraPrefOutOfOfficeCacheDuration,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:2,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefOutOfOfficeReply,type:_TEXTAREA_,msgName:ZaMsg.LBL_zimbraPrefOutOfOfficeReply,label:ZaMsg.LBL_zimbraPrefOutOfOfficeReply,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em",enableDisableChecks:[ZaAccountXFormView.isOutOfOfficeReplyEnabled],enableDisableChangeEventSources:[ZaAccount.A_zimbraPrefOutOfOfficeReplyEnabled]}
,{
ref:ZaAccount.A_zimbraPrefMailSendReadReceipts,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,label:ZaMsg.LBL_zimbraPrefMailSendReadReceipts,nowrap:false,labelWrap:true,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureReadReceiptsEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefMailSendReadReceipts]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureReadReceiptsEnabled]}
,{
ref:ZaAccount.A_zimbraPrefReadReceiptsToAddress,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraPrefReadReceiptsToAddress,nowrap:false,labelWrap:true,msgName:ZaMsg.LBL_zimbraPrefReadReceiptsToAddress,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",width:150,enableDisableChecks:[[XForm.checkInstanceValue,ZaAccount.A_zimbraFeatureReadReceiptsEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaAccount.A_zimbraPrefReadReceiptsToAddress]],enableDisableChangeEventSources:[ZaAccount.A_zimbraFeatureReadReceiptsEnabled]}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_prefSaveToSent,ZaAccount.A_zimbraAllowAnyFromAddress,ZaAccount.A_zimbraAllowFromAddress],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_mail_sending",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsSending,items:[{
ref:ZaAccount.A_zimbraPrefSaveToSent,colSpan:2,colSizes:["200px","300px","*"],type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefSaveToSent,checkBoxLabel:ZaMsg.LBL_zimbraPrefSaveToSent,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraAllowAnyFromAddress,colSpan:2,colSizes:["200px","300px","*"],type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraAllowAnyFromAddress,checkBoxLabel:ZaMsg.LBL_zimbraAllowAnyFromAddress,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraAllowFromAddress,type:_REPEAT_,label:ZaMsg.LBL_zimbraAllowFromAddress,labelLocation:_LEFT_,addButtonLabel:ZaMsg.NAD_AddAddress,align:_LEFT_,repeatInstance:l,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveAddress,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:"200px",enableDisableChecks:[],visibilityChecks:[]}
],nowrap:false,labelWrap:true,enableDisableChecks:[],visibilityChecks:[ZaAccountXFormView.isSendingFromAnyAddressDisAllowed,[ZaItem.hasWritePermission,ZaAccount.A_zimbraAllowFromAddress]],visibilityChangeEventSources:[ZaAccount.A_zimbraAllowAnyFromAddress,ZaAccount.A_zimbraAllowFromAddress,ZaAccount.A_COSId]}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPrefComposeInNewWindow,ZaAccount.A_zimbraPrefComposeFormat,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize,ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor,ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat,ZaAccount.A_zimbraPrefMailSignatureEnabled,ZaAccount.A_zimbraMailSignatureMaxLength,ZaAccount.A_zimbraPrefMailSignature,ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled,ZaAccount.A_zimbraPrefAutoSaveDraftInterval],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_mail_composing",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsComposing,items:[{
ref:ZaAccount.A_zimbraPrefComposeInNewWindow,colSpan:2,type:_SUPER_WIZ_CHECKBOX_,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefComposeInNewWindow,checkBoxLabel:ZaMsg.LBL_zimbraPrefComposeInNewWindow,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefComposeFormat,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefComposeFormat,label:ZaMsg.LBL_zimbraPrefComposeFormat}
,{
ref:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontFamily,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,valueLabel:null}
,{
ref:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontSize,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,valueLabel:null}
,{
ref:ZaAccount.A_zimbraPrefHtmlEditorDefaultFontColor,type:_SUPERWIZ_DWT_COLORPICKER_,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefForwardReplyInOriginalFormat,colSpan:2,type:_SUPER_WIZ_CHECKBOX_,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,checkBoxLabel:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMandatorySpellCheckEnabled,colSpan:2,type:_SUPER_WIZ_CHECKBOX_,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefMailSignatureEnabled,colSizes:["200px","300px","*"],type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMailSignatureEnabled,label:ZaMsg.LBL_zimbraPrefMailSignatureEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraMailSignatureMaxLength,type:_SUPERWIZ_TEXTFIELD_,colSpan:2,colSizes:["200px","300px","*"],txtBoxLabel:ZaMsg.LBL_zimbraMailSignatureMaxLength,msgName:ZaMsg.MSG_zimbraMailSignatureMaxLength,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefMailSignature,type:_TEXTAREA_,colSizes:["200px","300px","*"],msgName:ZaMsg.MSG_zimbraPrefMailSignature,label:ZaMsg.LBL_zimbraPrefMailSignature,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em",enableDisableChangeEventSources:[ZaAccount.A_zimbraPrefMailSignatureEnabled],enableDisableChecks:[ZaAccountXFormView.isMailSignatureEnabled]}
,{
ref:ZaAccount.A_zimbraPrefAutoSaveDraftInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],msgName:ZaMsg.MSG_zimbraPrefAutoSaveDraftInterval,txtBoxLabel:ZaMsg.LBL_zimbraPrefAutoSaveDraftInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSpan:2,nowrap:false,labelWrap:true}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPrefAutoAddAddressEnabled,ZaAccount.A_zimbraPrefGalAutoCompleteEnabled],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_contacts_general",label:ZaMsg.NAD_ContactsOptions,items:[{
ref:ZaAccount.A_zimbraPrefAutoAddAddressEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefGalAutoCompleteEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPrefTimeZoneId,ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime,ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal,ZaAccount.A_zimbraPrefCalendarUseQuickAdd,ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar,ZaAccount.A_zimbraPrefCalendarInitialView,ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek,ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges,ZaAccount.A_zimbraPrefCalendarApptVisibility,ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled,ZaAccount.A_zimbraPrefCalendarSendInviteDeniedAutoReply,ZaAccount.A_zimbraPrefCalendarAutoAddInvites,ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite,ZaAccount.A_zimbraPrefCalendarReminderFlashTitle,ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf,ZaAccount.A_zimbraPrefCalendarToasterEnabled,ZaAccount.A_zimbraPrefCalendarShowPastDueReminders,ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled],[])){
g.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_calendar_general",label:ZaMsg.NAD_CalendarOptions,items:[{
ref:ZaAccount.A_zimbraPrefTimeZoneId,type:_SUPERWIZ_SELECT1_,msgName:ZaMsg.LBL_zimbraPrefTimeZoneId,valueWidth:"280px",colSizes:["300px","*"],label:ZaMsg.LBL_zimbraPrefTimeZoneId,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefCalendarApptReminderWarningTime,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.LBL_zimbraPrefCalendarApptReminderWarningTime,label:ZaMsg.LBL_zimbraPrefCalendarApptReminderWarningTime,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefCalendarInitialView,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.MSG_zimbraPrefCalendarInitialView,label:ZaMsg.LBL_zimbraPrefCalendarInitialView,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.LBL_zimbraPrefCalendarFirstDayOfWeek,label:ZaMsg.LBL_zimbraPrefCalendarFirstDayOfWeek,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefCalendarApptVisibility,type:_SUPERWIZ_SELECT1_,colSizes:["300px","*"],msgName:ZaMsg.LBL_zimbraPrefCalendarApptVisibility,label:ZaMsg.LBL_zimbraPrefCalendarApptVisibility,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPrefAppleIcalDelegationEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefAppleIcalDelegationEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefAppleIcalDelegationEnabled,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarShowPastDueReminders,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarShowPastDueReminders,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarShowPastDueReminders,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarToasterEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarToasterEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarToasterEnabled,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAllowCancelEmailToSelf,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowCancelEmailToSelf,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAllowCancelEmailToSelf,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAllowPublishMethodInvite,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowPublishMethodInvite,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAllowPublishMethodInvite,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAllowForwardedInvite,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowForwardedInvite,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAllowForwardedInvite,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarReminderFlashTitle,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPrefCalendarReminderFlashTitle,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarReminderFlashTitle,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarReminderSoundsEnabled,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarReminderSoundsEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarReminderSoundsEnabled,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarSendInviteDeniedAutoReply,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarSendInviteDeniedAutoReply,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarSendInviteDeniedAutoReply,trueValue:"TRUE",falseValue:"FALSE",nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraPrefCalendarAutoAddInvites,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefCalendarNotifyDelegatedChanges,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefCalendarAlwaysShowMiniCal,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefCalendarUseQuickAdd,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefCalendarUseQuickAdd,checkBoxLabel:ZaMsg.LBL_zimbraPrefCalendarUseQuickAdd,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPrefUseTimeZoneListInCalendar,type:_SUPER_WIZ_CHECKBOX_,colSpan:2,colSizes:["200px","300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,checkBoxLabel:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
o.push({
type:_CASE_,caseKey:ZaNewAccountXWizard.PREFS_STEP,tabGroupKey:ZaNewAccountXWizard.PREFS_STEP,numCols:1,width:"680",items:g}
)
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.SKIN_TAB_ATTRS,ZaAccountXFormView.SKIN_TAB_RIGHTS)&&!ZaSettings.isOctopus()){
ZaNewAccountXWizard.SKINS_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.SKINS_STEP,label:ZaMsg.TABT_Themes}
);
o.push({
type:_CASE_,caseKey:ZaNewAccountXWizard.SKINS_STEP,tabGroupKey:ZaNewAccountXWizard.SKINS_STEP,id:"account_form_themes_step",numCols:1,width:"100%",items:[{
type:_GROUP_,items:[{
ref:ZaAccount.A_zimbraPrefSkin,type:_SUPERWIZ_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,choices:ZaNewAccountXWizard.themeChoices,visibilityChecks:[ZaAccountXFormView.gotSkins]}
,{
type:_OUTPUT_,ref:ZaAccount.A_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,visibilityChecks:[ZaAccountXFormView.gotNoSkins]}
]}
,{
type:_SPACER_}
,{
type:_SUPER_WIZ_SELECT_CHECK_,selectRef:ZaAccount.A_zimbraAvailableSkin,ref:ZaAccount.A_zimbraAvailableSkin,choices:ZaNewAccountXWizard.themeChoices,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaAccountXFormView.gotSkins],visibilityChangeEventSources:[ZaModel.currentStep],caseKey:ZaNewAccountXWizard.SKINS_STEP,caseVarRef:ZaModel.currentStep,limitLabel:ZaMsg.NAD_LimitThemesTo}
,{
type:_DWT_ALERT_,colSpan:2,style:DwtAlert.WARNING,iconVisible:true,visibilityChecks:[ZaAccountXFormView.gotNoSkins],value:ZaMsg.ERROR_CANNOT_FIND_SKINS_FOR_ACCOUNT}
]}
)
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.ZIMLET_TAB_ATTRS,ZaAccountXFormView.ZIMLET_TAB_RIGHTS)){
ZaNewAccountXWizard.ZIMLETS_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.ZIMLETS_STEP,label:ZaMsg.TABT_Zimlets}
);
o.push({
type:_CASE_,caseKey:ZaNewAccountXWizard.ZIMLETS_STEP,tabGroupKey:ZaNewAccountXWizard.ZIMLETS_STEP,id:"account_form_zimlets_step",numCols:1,width:"100%",items:[{
type:_ZAWIZGROUP_,numCols:1,colSizes:["auto"],items:[{
type:_SUPER_WIZ_ZIMLET_SELECT_,selectRef:ZaAccount.A_zimbraZimletAvailableZimlets,ref:ZaAccount.A_zimbraZimletAvailableZimlets,choices:ZaNewAccountXWizard.zimletChoices,limitLabel:ZaMsg.NAD_LimitZimletsTo}
]}
]}
)
}
if(ZaTabView.isTAB_ENABLED(n,ZaAccountXFormView.ADVANCED_TAB_ATTRS,ZaAccountXFormView.ADVANCED_TAB_RIGHTS)&&!ZaSettings.isOctopus()){
ZaNewAccountXWizard.ADVANCED_STEP=++this.TAB_INDEX;
this.stepChoices.push({
value:ZaNewAccountXWizard.ADVANCED_STEP,label:ZaMsg.TABT_Advanced}
);
advancedCaseItems=[];
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraAttachmentsBlocked],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_attachment_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_AttachmentsGrouper,items:[{
ref:ZaAccount.A_zimbraAttachmentsBlocked,type:_SUPER_WIZ_CHECKBOX_,colSizes:["200px","300px","*"],colSpan:3,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.NAD_RemoveAllAttachments,checkBoxLabel:ZaMsg.NAD_RemoveAllAttachments,trueValue:"TRUE",falseValue:"FALSE"}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraMailQuota,ZaAccount.A_zimbraContactMaxNumEntries,ZaAccount.A_zimbraQuotaWarnPercent,ZaAccount.A_zimbraQuotaWarnInterval,ZaAccount.A_zimbraQuotaWarnMessage],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_quota_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_QuotaGrouper,items:[{
ref:ZaAccount.A_zimbraMailForwardingAddressMaxLength,type:_SUPERWIZ_TEXTFIELD_,colSizes:["200px","300px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxLength,txtBoxLabel:ZaMsg.LBL_zimbraMailForwardingAddressMaxLength,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaAccount.A_zimbraMailForwardingAddressMaxNumAddrs,type:_SUPERWIZ_TEXTFIELD_,colSizes:["200px","300px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxNumAddrs,txtBoxLabel:ZaMsg.LBL_zimbraMailForwardingAddressMaxNumAddrs,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaAccount.A_zimbraMailQuota,type:_SUPERWIZ_TEXTFIELD_,colSizes:["200px","300px","*"],colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraMailQuota,msgName:ZaMsg.MSG_zimbraMailQuota,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraContactMaxNumEntries,type:_SUPERWIZ_TEXTFIELD_,colSizes:["200px","300px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraContactMaxNumEntries,txtBoxLabel:ZaMsg.LBL_zimbraContactMaxNumEntries,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaAccount.A_zimbraQuotaWarnPercent,type:_SUPERWIZ_TEXTFIELD_,colSizes:["200px","300px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,txtBoxLabel:ZaMsg.LBL_zimbraQuotaWarnPercent,msgName:ZaMsg.MSG_zimbraQuotaWarnPercent,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraQuotaWarnInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,textFieldCssClass:"admin_xform_number_input",txtBoxLabel:ZaMsg.LBL_zimbraQuotaWarnInterval,msgName:ZaMsg.MSG_zimbraQuotaWarnInterval,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraQuotaWarnMessage,type:_SUPERWIZ_TEXTAREA_,colSizes:["200px","300px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,txtBoxLabel:ZaMsg.LBL_zimbraQuotaWarnMessage,msgName:ZaMsg.MSG_zimbraQuotaWarnMessage,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraDataSourceMinPollingInterval,ZaAccount.A_zimbraDataSourcePop3PollingInterval,ZaAccount.A_zimbraDataSourceImapPollingInterval,ZaAccount.A_zimbraDataSourceCalendarPollingInterval,ZaAccount.A_zimbraDataSourceRssPollingInterval,ZaAccount.A_zimbraDataSourceCaldavPollingInterval],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_datasourcepolling_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_DataSourcePolling,items:[{
ref:ZaAccount.A_zimbraDataSourceMinPollingInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],msgName:ZaMsg.MSG_zimbraDataSourceMinPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceMinPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourcePop3PollingInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],msgName:ZaMsg.MSG_zimbraDataSourcePop3PollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourcePop3PollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceImapPollingInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],msgName:ZaMsg.MSG_zimbraDataSourceImapPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceImapPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceCalendarPollingInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],msgName:ZaMsg.MSG_zimbraDataSourceCalendarPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceCalendarPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceRssPollingInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],msgName:ZaMsg.MSG_zimbraDataSourceRssPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceRssPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,nowrap:false,labelWrap:true}
,{
ref:ZaAccount.A_zimbraDataSourceCaldavPollingInterval,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],msgName:ZaMsg.MSG_zimbraDataSourceCaldavPollingInterval,txtBoxLabel:ZaMsg.LBL_zimbraDataSourceCaldavPollingInterval,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,nowrap:false,labelWrap:true}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraProxyAllowedDomains],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_proxyalloweddomains_settings",colSizes:["200px","auto"],numCols:2,label:ZaMsg.NAD_ProxyAllowedDomains,items:[{
ref:ZaAccount.A_zimbraProxyAllowedDomains,label:ZaMsg.LBL_zimbraProxyAllowedDomains,labelCssStyle:"vertical-align:top;",type:_SUPER_REPEAT_,colSizes:["300px","*"],resetToSuperLabel:ZaMsg.NAD_ResetToCOS,repeatInstance:"",addButtonLabel:ZaMsg.NAD_ProxyAddAllowedDomain,removeButtonLabel:ZaMsg.NAD_ProxyRemoveAllowedDomain,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,enableDisableChecks:[ZaItem.hasWritePermission],visibilityChecks:[ZaItem.hasReadPermission],width:"15em"}
]}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPasswordLocked,ZaAccount.A_zimbraMinPwdLength,ZaAccount.A_zimbraMaxPwdLength,ZaAccount.A_zimbraPasswordMinUpperCaseChars,ZaAccount.A_zimbraPasswordMinLowerCaseChars,ZaAccount.A_zimbraPasswordMinPunctuationChars,ZaAccount.A_zimbraPasswordMinNumericChars,ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,ZaAccount.A_zimbraMinPwdAge,ZaAccount.A_zimbraMaxPwdAge,ZaAccount.A_zimbraEnforcePwdHistory],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,id:"account_password_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_PasswordGrouper,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:false,content:ZaMsg.Alert_InternalPassword,colSpan:3}
,{
ref:ZaAccount.A_zimbraPasswordLocked,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.NAD_PwdLocked,checkBoxLabel:ZaMsg.NAD_PwdLocked,trueValue:"TRUE",falseValue:"FALSE",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMinPwdLength,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMinPwdLength,txtBoxLabel:ZaMsg.LBL_zimbraMinPwdLength,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMaxPwdLength,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMaxPwdLength,txtBoxLabel:ZaMsg.LBL_zimbraMaxPwdLength,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinUpperCaseChars,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinUpperCaseChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinUpperCaseChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinLowerCaseChars,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinLowerCaseChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinLowerCaseChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinPunctuationChars,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinPunctuationChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinPunctuationChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinNumericChars,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinNumericChars,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinNumericChars,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraPasswordMinDigitsOrPuncs,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraPasswordMinDigitsOrPuncs,txtBoxLabel:ZaMsg.LBL_zimbraPasswordMinDigitsOrPuncs,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMinPwdAge,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_passMinAge,txtBoxLabel:ZaMsg.LBL_passMinAge,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraMaxPwdAge,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_passMaxAge,txtBoxLabel:ZaMsg.LBL_passMaxAge,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
,{
ref:ZaAccount.A_zimbraEnforcePwdHistory,type:_SUPERWIZ_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraEnforcePwdHistory,txtBoxLabel:ZaMsg.LBL_zimbraEnforcePwdHistory,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","300px","*"],visibilityChecks:[],enableDisableChecks:[[ZaNewAccountXWizard.isAuthfromInternal,c,ZaAccount.A_name]]}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_zimbraPasswordLockoutMaxFailures,ZaAccount.A_zimbraPasswordLockoutDuration,ZaAccount.A_zimbraPasswordLockoutFailureLifetime],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,id:"password_lockout_settings",colSizes:["auto"],numCols:1,label:ZaMsg.NAD_FailedLoginGrouper,items:[{
ref:ZaAccount.A_zimbraPasswordLockoutEnabled,type:_SUPER_WIZ_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.LBL_zimbraPasswordLockoutEnabled,checkBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutEnabled,colSizes:["200px","300px","*"],colSpan:1,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaAccount.A_zimbraPasswordLockoutMaxFailures,type:_SUPERWIZ_TEXTFIELD_,enableDisableChecks:[[ZaAccountXFormView.isPasswordLockoutEnabled],[XForm.checkInstanceValue,ZaAccount.A_zimbraPasswordLockoutEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_COSId,ZaAccount.A_zimbraPasswordLockoutEnabled],txtBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutMaxFailures,toolTipContent:ZaMsg.TTP_zimbraPasswordLockoutMaxFailuresSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutMaxFailures,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS,colSizes:["200px","300px","*"],colSpan:1}
,{
ref:ZaAccount.A_zimbraPasswordLockoutDuration,type:_SUPERWIZ_LIFETIME_,enableDisableChecks:[[ZaAccountXFormView.isPasswordLockoutEnabled],[XForm.checkInstanceValue,ZaAccount.A_zimbraPasswordLockoutEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_COSId,ZaAccount.A_zimbraPasswordLockoutEnabled],txtBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutDuration,toolTipContent:ZaMsg.TTP_zimbraPasswordLockoutDurationSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutDuration,textFieldCssClass:"admin_xform_number_input",colSizes:["200px","80px","220px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaAccount.A_zimbraPasswordLockoutFailureLifetime,type:_SUPERWIZ_LIFETIME_,enableDisableChecks:[[ZaAccountXFormView.isPasswordLockoutEnabled],[XForm.checkInstanceValue,ZaAccount.A_zimbraPasswordLockoutEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaAccount.A_zimbraPasswordLockoutEnabled,ZaAccount.A_COSId,ZaAccount.A_zimbraPasswordLockoutEnabled],txtBoxLabel:ZaMsg.LBL_zimbraPasswordLockoutFailureLifetime,toolTipContent:ZaMsg.TTP_zimbraPasswordLockoutFailureLifetimeSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutFailureLifetime,textFieldCssClass:"admin_xform_number_input",resetToSuperLabel:ZaMsg.NAD_ResetToCOS,labelCssStyle:"white-space:normal;",colSizes:["200px","80px","220px","*"],colSpan:1,nowrap:false,labelWrap:true}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraAdminAuthTokenLifetime,ZaAccount.A_zimbraAuthTokenLifetime,ZaAccount.A_zimbraMailIdleSessionTimeout,ZaAccount.A_zimbraDumpsterUserVisibleAge],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,colSizes:["auto"],numCols:1,label:ZaMsg.NAD_TimeoutGrouper,id:"timeout_settings",items:[{
ref:ZaAccount.A_zimbraAdminAuthTokenLifetime,type:_SUPERWIZ_LIFETIME_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraAdminAuthTokenLifetime,txtBoxLabel:ZaMsg.LBL_zimbraAdminAuthTokenLifetime,enableDisableChecks:[ZaAccountXFormView.isAdminAccount],colSizes:["200px","80px","220px","*"],colSpan:1,enableDisableChangeEventSources:[ZaAccount.A_zimbraIsAdminAccount]}
,{
ref:ZaAccount.A_zimbraAuthTokenLifetime,type:_SUPERWIZ_LIFETIME_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraAuthTokenLifetime,colSizes:["200px","80px","220px","*"],colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraAuthTokenLifetime}
,{
ref:ZaAccount.A_zimbraMailIdleSessionTimeout,type:_SUPERWIZ_LIFETIME_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailIdleSessionTimeout,colSizes:["200px","80px","220px","*"],colSpan:1,txtBoxLabel:ZaMsg.LBL_zimbraMailIdleSessionTimeout}
,{
ref:ZaAccount.A_zimbraDumpsterUserVisibleAge,type:_SUPERWIZ_LIFETIME_,colSizes:["200px","80px","220px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraDumpsterUserVisibleAge,txtBoxLabel:ZaMsg.LBL_zimbraDumpsterUserVisibleAge,visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraDumpsterEnabled]}
]}
)
}
if(ZAWizTopGrouper_XFormItem.isGroupVisible(n,[ZaAccount.A_zimbraMailMessageLifetime,ZaAccount.A_zimbraMailTrashLifetime,ZaAccount.A_zimbraMailSpamLifetime,ZaAccount.A_zimbraMailDumpsterLifetime],[])){
advancedCaseItems.push({
type:_ZAWIZ_TOP_GROUPER_,colSizes:["auto"],numCols:1,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaAccount.A_zimbraMailMessageLifetime,ZaAccount.A_zimbraMailTrashLifetime,ZaAccount.A_zimbraMailSpamLifetime,ZaAccount.A_zimbraMailDumpsterLifetime]],[XForm.checkInstanceValueNot,ZaAccount.A_zimbraIsExternalVirtualAccount,"TRUE"]],label:ZaMsg.NAD_MailRetentionGrouper,id:"mailretention_settings",items:[{
type:_DWT_ALERT_,containerCssStyle:"padding:0 10px 10px;width:100%;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Alert_EnableMailRetention}
,{
ref:ZaAccount.A_zimbraMailMessageLifetime,type:_SUPERWIZ_LIFETIME2_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailMessageLifetime,colSizes:["200px","80px","220px","*"],colSpan:1,visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled]],txtBoxLabel:ZaMsg.LBL_zimbraMailMessageLifetime}
,{
ref:ZaAccount.A_zimbraMailTrashLifetime,type:_SUPERWIZ_LIFETIME1_,colSizes:["200px","80px","220px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailTrashLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled]],txtBoxLabel:ZaMsg.LBL_zimbraMailTrashLifetime}
,{
ref:ZaAccount.A_zimbraMailSpamLifetime,type:_SUPERWIZ_LIFETIME1_,colSizes:["200px","80px","220px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailSpamLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled]],txtBoxLabel:ZaMsg.LBL_zimbraMailSpamLifetime}
,{
ref:ZaAccount.A_zimbraMailDumpsterLifetime,type:_SUPERWIZ_LIFETIME1_,colSizes:["200px","80px","220px","*"],colSpan:1,resetToSuperLabel:ZaMsg.NAD_ResetToCOS,msgName:ZaMsg.MSG_zimbraMailDumpsterLifetime,txtBoxLabel:ZaMsg.LBL_zimbraMailDumpsterLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[ZaAccount.isEmailRetentionPolicyEnabled],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterEnabled,"TRUE"],[XForm.checkInstanceValue,ZaAccount.A_zimbraDumpsterPurgeEnabled,"TRUE"]],visibilityChangeEventSources:[ZaAccount.A_zimbraDumpsterEnabled,ZaAccount.A_zimbraDumpsterPurgeEnabled]}
]}
)
}
o.push({
type:_CASE_,caseKey:ZaNewAccountXWizard.ADVANCED_STEP,tabGroupKey:ZaNewAccountXWizard.ADVANCED_STEP,id:"account_form_advanced_step",numCols:1,width:"100%",items:advancedCaseItems}
)
}
this._lastStep=this.stepChoices.length;
w.items=[{
type:_OUTPUT_,colSpan:2,align:_CENTER_,valign:_TOP_,ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep]}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:680,align:_LEFT_,valign:_TOP_,items:o}
]
};
ZaXDialog.XFormModifiers.ZaNewAccountXWizard.push(ZaNewAccountXWizard.myXFormModifier)
}
if(AjxPackage.define("zimbraAdmin.accounts.view.MoveAliasXDialog")){
MoveAliasXDialog=function(s,e,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.CANCEL_BUTTON];
var r=new DwtDialog_ButtonDescriptor(ZaXWizardDialog.HELP_BUTTON,ZaMsg.TBB_Help,DwtDialog.ALIGN_LEFT,new AjxCallback(this,this._helpButtonListener));
var o=new DwtDialog_ButtonDescriptor(MoveAliasXDialog.MOVE_BUTTON,ZaMsg._move,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.doMove));
var t=new DwtDialog_ButtonDescriptor(MoveAliasXDialog.CLOSE_BUTTON,AjxMsg._close,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.closeMe));
this._extraButtons=[r,o,t];
ZaXDialog.call(this,s,null,ZaMsg.MoveAlias_Title,e,n,"MoveAliasXDialog");
if(this._button[MoveAliasXDialog.MOVE_BUTTON]){
this._button[MoveAliasXDialog.MOVE_BUTTON].setEnabled(false)
}
this._containedObject=new ZaSearch();
this.initForm(ZaSearch.myXModel,this.getMyXForm());
this._helpURL=[location.pathname,ZaUtil.HELP_URL,ZaAccChangePwdXDlg.helpURL,"managing_accounts/creating_a_mail_aliases.htm?locid=",AjxEnv.DEFAULT_LOCALE].join("")
};
MoveAliasXDialog.prototype=new ZaXDialog;
MoveAliasXDialog.prototype.constructor=MoveAliasXDialog;
MoveAliasXDialog.resultChoices=new XFormChoices([],XFormChoices.OBJECT_REFERENCE_LIST,null,"name");
MoveAliasXDialog.MOVE_BUTTON=++DwtDialog.LAST_BUTTON;
MoveAliasXDialog.CLOSE_BUTTON=++DwtDialog.LAST_BUTTON;
MoveAliasXDialog.prototype.popup=function(t){
this._containedObject[ZaModel.currentStep]=1;
this._containedObject[ZaSearch.A_selected]=null;
this._localXForm.setInstance(this._containedObject);
ZaXWizardDialog.prototype.popup.call(this,t);
this._button[MoveAliasXDialog.CLOSE_BUTTON].setEnabled(false);
var e=this._localXForm.getItemsById(ZaSearch.A_selected)[0];
if(e){
e.resetChoices()
}};
MoveAliasXDialog.prototype.closeMe=function(){
this.popdown()
};
MoveAliasXDialog.prototype.doMove=function(){
this._button[MoveAliasXDialog.MOVE_BUTTON].setEnabled(false);
this._button[MoveAliasXDialog.CLOSE_BUTTON].setEnabled(true);
if(this.moveAlias()){
this.goPage(2)
}};
MoveAliasXDialog.prototype.goPage=function(e){
this._containedObject[ZaModel.currentStep]=e;
this._localXForm.refresh()
};
MoveAliasXDialog.prototype.setAlias=function(e){
this._alias=e
};
MoveAliasXDialog.prototype.moveAlias=function(){
var e;
try{
if(this._containedObject[ZaSearch.A_selected]&&this._containedObject[ZaSearch.A_selected].addAlias!=null){
try{
e=this._alias.name;
ZaAlias.prototype.remove.call(this._alias)
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"MoveAliasXDialog.prototype.moveAlias:_alias.remove",null,false);
return false
}
if(e){
this._containedObject[ZaSearch.A_selected].addAlias(e)
}else{
throw (new AjxException(ZaMsg.FAILED_MOVE_ALIAS,AjxException.UNKNOWN_ERROR,"MoveAliasXDialog.prototype.moveAlias","Alias name is not available"))
}
ZaApp.getInstance().getCurrentController().show();
this._containedObject[ZaSearch.A_ResultMsg]=String(ZaMsg.Alias_Moved_To).replace("{0}",e).replace("{1}",this._containedObject[ZaSearch.A_selected].name);
return true
}else{
ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.WARNING_ALIASES_TARGET_NON_EXIST,[this._containedObject[ZaSearch.A_selected]]))
}}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"MoveAliasXDialog.prototype.moveAlias",null,false);
return false
}
return false
};
MoveAliasXDialog.prototype.getMyXForm=function(){
var e={
numCols:2,items:[{
type:_SWITCH_,items:[{
type:_CASE_,caseKey:1,items:[{
type:_DWT_ALERT_,content:null,ref:"name",getDisplayValue:function(t){
return AjxMessageFormat.format(ZaMsg.MoveAlias_HelpMsg,this.getForm().parent._alias.name)
}
,iconVisible:false,align:_CENTER_,style:DwtAlert.INFORMATION}
,{
type:_DYNSELECT_,ref:ZaSearch.A_selected,dataFetcherClass:ZaSearch,dataFetcherMethod:ZaSearch.prototype.dynSelectSearch,dataFetcherTypes:[ZaSearch.ACCOUNTS,ZaSearch.RESOURCES,ZaSearch.DLS],dataFetcherAttrs:[ZaItem.A_zimbraId,ZaItem.A_cn,ZaAccount.A_name,ZaAccount.A_displayname,ZaAccount.A_mail],toolTipContent:ZaMsg.tt_StartTypingAccountName,label:ZaMsg.NAD_AccountName,labelLocation:_LEFT_,width:"100%",inputSize:30,editable:true,forceUpdate:true,choices:new XFormChoices([],XFormChoices.OBJECT_REFERENCE_LIST,"name","name"),visibilityChecks:[],enableDisableChecks:[],onChange:function(n,o,t){
if(((n instanceof ZaAccount)||n instanceof ZaDistributionList)&&(n.id)){
t.parent._button[MoveAliasXDialog.MOVE_BUTTON].setEnabled(true)
}
this.setInstanceValue(n)
}}
]}
,{
type:_CASE_,caseKey:2,items:[{
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,iconVisible:false,content:null,ref:ZaSearch.A_ResultMsg,align:_CENTER_,valign:_MIDDLE_,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaSearch.A_ResultMsg]],visibilityChangeEventSources:[ZaSearch.A_ResultMsg]}
]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ReindexMailboxXDialog")){
ReindexMailboxXDialog=function(o,e,t){
if(arguments.length==0){
return
}
ZaXDialog.call(this,o,null,ZaMsg.Reindex_Title,null,null);
this.initForm(ZaReindexMailbox.myXModel,this.getMyXForm());
this._button[DwtDialog.OK_BUTTON].setToolTipContent(ZaMsg.Reindex_Mbx_tt);
this._containedObject=new ZaReindexMailbox();
this.pollAction=new AjxTimedAction(this,this.getReindexStatus);
this._pollHandler=null;
this._helpURL=ReindexMailboxXDialog.helpURL
};
ReindexMailboxXDialog.prototype=new ZaXDialog;
ReindexMailboxXDialog.prototype.constructor=ReindexMailboxXDialog;
ReindexMailboxXDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/re-indexing_a_mailbox.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ReindexMailboxXDialog.isStartEnabled=function(){
return(this.getInstanceValue(ZaReindexMailbox.A_status)!="running"&&this.getInstanceValue(ZaReindexMailbox.A_status)!="started")
};
ReindexMailboxXDialog.isAbortEnabled=function(){
return(this.getInstanceValue(ZaReindexMailbox.A_status)=="running"||this.getInstanceValue(ZaReindexMailbox.A_status)=="started")
};
ReindexMailboxXDialog.isStatusNotError=function(){
return(this.getInstanceValue(ZaReindexMailbox.A_status)!="error")
};
ReindexMailboxXDialog.prototype.popup=function(){
DwtDialog.prototype.popup.call(this);
this._localXForm.setInstance(this._containedObject);
if(this._containedObject.mbxId){
var e=new AjxCallback(this,ReindexMailboxXDialog.prototype.getReindexStatusCallBack);
ZaAccount.getReindexStatus(this._containedObject.mbxId,e)
}};
ReindexMailboxXDialog.prototype.popdown=function(){
if(this._pollHandler){
AjxTimedAction.cancelAction(this._pollHandler)
}
DwtDialog.prototype.popdown.call(this)
};
ReindexMailboxXDialog.abortReindexMailbox=function(t){
try{
var e=this.getInstance();
if(this.getForm().parent.asynCommand){
this.getForm().parent.asynCommand.cancel()
}
var n=new AjxCallback(this.getForm().parent,ReindexMailboxXDialog.prototype.getReindexStatusCallBack);
ZaAccount.abortReindexMailbox(e.mbxId,n);
this.getForm().refresh()
}
catch(o){
this.getForm().getController().getCurrentController()._handleException(o,"ReindexMailboxXDialog.abortReindexMailbox",null,false)
}};
ReindexMailboxXDialog.startReindexMailbox=function(t){
try{
var e=this.getInstance();
var n=new AjxCallback(this.getForm().parent,ReindexMailboxXDialog.prototype.getReindexStatusCallBack);
ZaAccount.startReindexMailbox(e.mbxId,n);
this.getForm().refresh()
}
catch(o){
this.getForm().getController().getCurrentController()._handleException(o,"ReindexMailboxXDialog.startReindexMailbox",null,false)
}};
ReindexMailboxXDialog.prototype.getReindexStatusCallBack=function(e){
ZaAccount.parseReindexResponse(e,this._containedObject,this._localXForm);
if((this._containedObject.status=="running"||this._containedObject.status=="started")&&this.isPoppedUp()){
this._pollHandler=AjxTimedAction.scheduleAction(this.pollAction,this._containedObject.pollInterval)
}else{
if(this._pollHandler){
AjxTimedAction.cancelAction(this._pollHandler);
this._pollHandler=null
}}};
ReindexMailboxXDialog.prototype.getReindexStatus=function(){
var e=new AjxCallback(this,this.getReindexStatusCallBack);
this.asynCommand=ZaAccount.getReindexStatus(this._containedObject.mbxId,e)
};
ReindexMailboxXDialog.prototype.getMyXForm=function(){
var e={
numCols:2,height:"300px",align:_CENTER_,cssStyle:"text-align:center",items:[{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.WARNING_REINDEX,colSpan:"*",align:_CENTER_,valign:_TOP_}
,{
type:_DWT_ALERT_,style:DwtAlert.CRITICAL,iconVisible:true,content:null,ref:ZaReindexMailbox.A_resultMsg,visibilityChangeEventSources:[ZaReindexMailbox.A_status],visibilityChecks:[[XForm.checkInstanceValue,ZaReindexMailbox.A_status,"error"],[XForm.checkInstanceValueNotEmty,ZaReindexMailbox.A_resultMsg]],valueChangeEventSources:[ZaReindexMailbox.A_resultMsg],align:_CENTER_,colSpan:"*"}
,{
type:_TEXTAREA_,visibilityChangeEventSources:[ZaReindexMailbox.A_status],visibilityChecks:[[XForm.checkInstanceValue,ZaReindexMailbox.A_status,"error"],[XForm.checkInstanceValueNotEmty,ZaReindexMailbox.A_errorDetail]],valueChangeEventSources:[ZaReindexMailbox.A_errorDetail],ref:ZaReindexMailbox.A_errorDetail,label:ZaMsg.FAILED_REINDEX_DETAILS,height:"100px",width:"200px",colSpan:"*"}
,{
type:_DWT_ALERT_,ref:ZaReindexMailbox.A_progressMsg,content:null,colSpan:"*",iconVisible:true,align:_CENTER_,style:DwtAlert.INFORMATION,bmolsnr:true}
,{
type:_DWT_PROGRESS_BAR_,label:ZaMsg.ReindexMbx_Progress,maxValue:null,maxValueRef:ZaReindexMailbox.A_numTotal,ref:ZaReindexMailbox.A_numDone,valign:_CENTER_,align:_CENTER_,wholeCssClass:"progressbar",progressCssClass:"progressused",bmolsnr:true}
,{
type:_SPACER_,visibilityChecks:[ReindexMailboxXDialog.isStatusNotError],visibilityChangeEventSources:[ZaReindexMailbox.A_status],height:"150px",width:"490px",colSpan:"*"}
,{
type:_GROUP_,colSpan:"*",numCols:5,width:"490px",cssStyle:"text-align:center; overflow:hidden",align:_CENTER_,items:[{
type:_SPACER_,width:"30px",colSpan:1}
,{
type:_DWT_BUTTON_,onActivate:"ReindexMailboxXDialog.startReindexMailbox.call(this)",label:ZaMsg.NAD_ACC_Start_Reindexing,enableDisableChecks:[ReindexMailboxXDialog.isStartEnabled],enableDisableChangeEventSources:[ZaReindexMailbox.A_status],visibilityChecks:[],valign:_BOTTOM_,width:"150px"}
,{
type:_SPACER_,width:"90px",colSpan:1}
,{
type:_DWT_BUTTON_,onActivate:"ReindexMailboxXDialog.abortReindexMailbox.call(this)",label:ZaMsg.NAD_ACC_Abort_Reindexing,enableDisableChecks:[ReindexMailboxXDialog.isAbortEnabled],enableDisableChangeEventSources:[ZaReindexMailbox.A_status],visibilityChecks:[],valign:_BOTTOM_,width:"150px"}
,{
type:_SPACER_,width:"30px",colSpan:1}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.DeleteAcctsPgrsDlg")){
DeleteAcctsPgrsDlg=function(o,e,t){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON];
var s=new DwtDialog_ButtonDescriptor(ZaXWizardDialog.HELP_BUTTON,ZaMsg.TBB_Help,DwtDialog.ALIGN_LEFT,new AjxCallback(this,this._helpButtonListener));
var n=new DwtDialog_ButtonDescriptor(DeleteAcctsPgrsDlg.ABORT_BUTTON,ZaMsg.NAD_AbortDeleting,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this.abortDeletingAccounts));
this._extraButtons=[s,n];
ZaXDialog.call(this,o,null,ZaMsg.NAD_DeletingAccTitle,e,t);
this._containedObject=[];
this._currentIndex=0;
this._currentAccount=null;
this.initForm(DeleteAcctsPgrsDlg.myXModel,this.getMyXForm());
this._pollHandler=null;
this._aborted=false;
this._helpURL=[location.pathname,ZaUtil.HELP_URL,DeleteAcctsPgrsDlg.helpURL,"?locid=",AjxEnv.DEFAULT_LOCALE].join("")
};
DeleteAcctsPgrsDlg._ERROR_MSG="errorMsg";
DeleteAcctsPgrsDlg._STATUS="status";
DeleteAcctsPgrsDlg._DELETED_ACCTS="deletedAccounts";
DeleteAcctsPgrsDlg.helpURL="managing_accounts/provisioning_accounts.htm";
DeleteAcctsPgrsDlg.myXModel={
getDeletedAccounts:function(t,e){
return e.deletedAccounts
}
,setDeletedAccounts:function(n,e,o,t){
e.deletedAccounts=n
}
,items:[{
ref:DeleteAcctsPgrsDlg._STATUS,type:_STRING_}
,{
ref:DeleteAcctsPgrsDlg._ERROR_MSG,type:_STRING_}
,{
ref:DeleteAcctsPgrsDlg._DELETED_ACCTS,type:_LIST_,setter:"set",setterScope:_MODEL_,getter:"getDeletedAccounts",getterScope:_MODEL_}
]};
DeleteAcctsPgrsDlg.prototype=new ZaXDialog;
DeleteAcctsPgrsDlg.prototype.constructor=DeleteAcctsPgrsDlg;
DeleteAcctsPgrsDlg.prototype.miniType=2;
DeleteAcctsPgrsDlg.prototype.supportMinimize=true;
DeleteAcctsPgrsDlg.prototype.toString=function(){
return"DeleteAcctsPgrsDlg"
};
DeleteAcctsPgrsDlg.prototype.getCacheName=function(){
return"removeProgressDlg"
};
DeleteAcctsPgrsDlg.ABORT_BUTTON=++DwtDialog.LAST_BUTTON;
DeleteAcctsPgrsDlg.prototype.setObject=function(e){
this._containedObject=e;
var t=new Object();
t._uuid=e._uuid||ZaUtil.getItemUUid();
t[DeleteAcctsPgrsDlg._DELETED_ACCTS]=e[DeleteAcctsPgrsDlg._DELETED_ACCTS]||[];
t[DeleteAcctsPgrsDlg._STATUS]=e[DeleteAcctsPgrsDlg._STATUS]||"";
t[DeleteAcctsPgrsDlg._ERROR_MSG]=e[DeleteAcctsPgrsDlg._ERROR_MSG]||null;
this._localXForm.setInstance(t);
this._button[DeleteAcctsPgrsDlg.ABORT_BUTTON].setEnabled(false);
this._button[DwtDialog.OK_BUTTON].setEnabled(true)
};
DeleteAcctsPgrsDlg.prototype.getObject=function(){
if(this._localXForm){
return this._localXForm.getInstance()
}else{
return this._containedObject
}};
DeleteAcctsPgrsDlg.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e)
};
DeleteAcctsPgrsDlg.prototype.abortDeletingAccounts=function(e){
try{
var o=this._containedObject[this._currentIndex];
this._button[DeleteAcctsPgrsDlg.ABORT_BUTTON].setEnabled(false);
var n=this._localXForm.getInstance();
AjxTimedAction.cancelAction(this._pollHandler);
this._pollHandler=null;
this._aborted=true;
this._localXForm.getInstance().status=ZaMsg.NAD_DeletingCancelled;
this._localXForm.refresh()
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"DeleteAcctsPgrsDlg.abortDeletingAccounts",null,false)
}};
DeleteAcctsPgrsDlg.prototype.startDeletingAccounts=function(e){
try{
this._aborted=false;
this.pollAction=new AjxTimedAction(this,this.deleteOneAccount);
this._currentIndex=0;
var o=new Object();
o._uuid=ZaUtil.getItemUUid();
o[DeleteAcctsPgrsDlg._STATUS]=AjxMessageFormat.format(ZaMsg.NAD_DeleteAccStatus,[this._containedObject[this._currentIndex][ZaAccount.A_name]]);
o[DeleteAcctsPgrsDlg._DELETED_ACCTS]=new Array();
this._localXForm.setInstance(o);
this._pollHandler=AjxTimedAction.scheduleAction(this.pollAction,"50")
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"DeleteAcctsPgrsDlg.startDeletingAccounts",null,false)
}};
DeleteAcctsPgrsDlg.prototype.deleteOneAccountCallback=function(e){
var n=this._localXForm.getInstance();
var t=false;
var o=e.getException();
if(o){
if(o.code!=ZmCsfeException.ACCT_NO_SUCH_ACCOUNT){
t=true
}}
if(t){
AjxTimedAction.cancelAction(this._pollHandler);
this._pollHandler=null;
this._localXForm.refresh();
ZaApp.getInstance().getCurrentController()._handleException(o,"DeleteAcctsPgrsDlg.prototype.deleteOneAccountCallback",null,false)
}else{
n[DeleteAcctsPgrsDlg._DELETED_ACCTS].push(this._containedObject[this._currentIndex]);
this._currentIndex++;
if((this._currentIndex<this._containedObject.length)&&!this._aborted){
n.status=AjxMessageFormat.format(ZaMsg.NAD_DeleteAccStatus,[this._containedObject[this._currentIndex][ZaAccount.A_name]]);
this._pollHandler=AjxTimedAction.scheduleAction(this.pollAction,"50")
}else{
this._button[DeleteAcctsPgrsDlg.ABORT_BUTTON].setEnabled(false);
ZaApp.getInstance().getCurrentController().fireRemovalEvent(n[DeleteAcctsPgrsDlg._DELETED_ACCTS]);
AjxTimedAction.cancelAction(this._pollHandler);
this._pollHandler=null;
if(!this._aborted){
n.status=ZaMsg.NAD_FinishedDeletingAccounts
}}
this._localXForm.refresh()
}};
DeleteAcctsPgrsDlg.prototype.deleteOneAccount=function(){
var e=new AjxCallback(this,this.deleteOneAccountCallback);
if(this._containedObject[this._currentIndex]&&this._containedObject[this._currentIndex].remove){
this._containedObject[this._currentIndex].remove(e);
this._button[DeleteAcctsPgrsDlg.ABORT_BUTTON].setEnabled(true)
}};
DeleteAcctsPgrsDlg.prototype.getMyXForm=function(){
var e=new Array();
var o=1;
e[0]=new ZaListHeaderItem("type",ZaMsg.ALV_Type_col,null,34,null,"objectClass",true,true);
e[1]=new ZaListHeaderItem(ZaAccount.A_name,ZaMsg.ALV_NameAddress_col,null,"auto",o++,ZaAccount.A_name,true,true);
var t={
numCols:1,height:"300px",width:(AjxEnv.isIE?"490px":"495px"),align:_CENTER_,cssStyle:"text-align:center",items:[{
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,iconVisible:true,content:null,ref:DeleteAcctsPgrsDlg._STATUS,align:_CENTER_,valign:_MIDDLE_,colSpan:"*",width:(AjxEnv.isIE?"490px":"495px"),visibilityChecks:[[XForm.checkInstanceValueEmty,DeleteAcctsPgrsDlg._ERROR_MSG]],visibilityChangeEventSources:[DeleteAcctsPgrsDlg._ERROR_MSG]}
,{
type:_DWT_ALERT_,style:DwtAlert.CRITICAL,iconVisible:true,content:null,ref:DeleteAcctsPgrsDlg._ERROR_MSG,align:_CENTER_,valign:_MIDDLE_,colSpan:"*",width:(AjxEnv.isIE?"490px":"495px"),visibilityChecks:[[XForm.checkInstanceValueNotEmty,DeleteAcctsPgrsDlg._ERROR_MSG]],visibilityChangeEventSources:[DeleteAcctsPgrsDlg._ERROR_MSG]}
,{
type:_SPACER_,height:"5"}
,{
type:_OUTPUT_,value:ZaMsg.NAD_DeletedAccounts,colSpan:"*",colSpan:"*",align:_LEFT_}
,{
type:_SPACER_,height:"10"}
,{
ref:DeleteAcctsPgrsDlg._DELETED_ACCTS,type:_DWT_LIST_,height:(AjxEnv.isIE?"180px":"210px"),width:(AjxEnv.isIE?"490px":"495px"),colSpan:"*",cssClass:"DLSource",align:_CENTER_,forceUpdate:true,widgetClass:ZaAccMiniListView,headerList:e,hideHeader:false}
]};
return t
}
}
if(AjxPackage.define("zimbraAdmin.servers.view.ZaServerVolumesListView")){
ZaServerVolumesListView=function(n,o,t,e){
ZaListView.call(this,n,o,t,e)
};
ZaServerVolumesListView.prototype=new ZaListView;
ZaServerVolumesListView.prototype.constructor=ZaServerVolumesListView;
ZaServerVolumesListView.prototype.toString=function(){
return"ZaServerVolumesListView"
};
ZaServerVolumesListView.prototype._createItemHtml=function(r){
var s=new Array(50);
var l=document.createElement("div");
l[DwtListView._STYLE_CLASS]="Row";
l[DwtListView._SELECTED_STYLE_CLASS]=l[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
l.className=l[DwtListView._STYLE_CLASS];
this.associateItemWithElement(r,l,DwtListView.TYPE_LIST_ITEM);
var e=0;
s[e++]="<table width='100%' cellspacing='0' cellpadding='0'>";
s[e++]="<tr>";
if(this._headerList){
var n=this._headerList.length;
for(var o=0;
o<n;
o++){
var h=this._headerList[o]._field;
if(h==ZaServer.A_isCurrentVolume){
s[e++]="<td align=left height=20px width="+this._headerList[o]._width+">";
var t=false;
for(a in ZaServer.currentkeys){
if(this.parent&&this.parent.instance&&this.parent.instance[ZaServer.currentkeys[a]]){
if(this.parent.instance[ZaServer.currentkeys[a]]==r[ZaServer.A_VolumeId]){
t=true;
break
}}}
if(t){
s[e++]=AjxImg.getImageHtml("Check")
}
s[e++]="</td>"
}else{
if(h==ZaServer.A_VolumeName){
s[e++]="<td align=left height=20px width="+this._headerList[o]._width+">";
s[e++]=r[ZaServer.A_VolumeName];
s[e++]="</td>"
}else{
if(h==ZaServer.A_VolumeRootPath){
s[e++]="<td align=left height=20px width="+this._headerList[o]._width+">";
s[e++]=r[ZaServer.A_VolumeRootPath];
s[e++]="</td>"
}else{
if(h==ZaServer.A_VolumeType){
s[e++]="<td align=left height=20px width="+this._headerList[o]._width+">";
s[e++]=ZaServer.volumeTypeChoices.getChoiceByValue(r[ZaServer.A_VolumeType]);
s[e++]="</td>"
}else{
if(h==ZaServer.A_VolumeCompressBlobs){
s[e++]="<td align=left height=20px width="+this._headerList[o]._width+">";
if(r[ZaServer.A_VolumeCompressBlobs]){
s[e++]=ZaMsg.Yes
}else{
s[e++]=ZaMsg.No
}
s[e++]="</td>"
}else{
if(h==ZaServer.A_VolumeCompressionThreshold){
s[e++]="<td align=left height=20px width="+this._headerList[o]._width+">";
s[e++]=AjxMessageFormat.format(ZaMsg.VM_VolumeCompressThresholdBytes,[r[ZaServer.A_VolumeCompressionThreshold]]);
s[e++]="</td>"
}}}}}}}}else{
s[e++]="<td width=100%>";
s[e++]=AjxStringUtil.htmlEncode(r);
s[e++]="</td>"
}
s[e++]="</tr></table>";
l.innerHTML=s.join("");
return l
};
ZaServerVolumesListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br>&nbsp","</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaServerVolumesListView.prototype._sortColumn=function(t,o){
if(o){
var e=function(s,n){
return(s<n)?1:((s>n)?-1:0)
};
this.getList().sort(e)
}else{
this.getList().sort()
}}
}
if(AjxPackage.define("zimbraAdmin.servers.view.ZaEditVolumeXDialog")){
ZaEditVolumeXDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t);
this._containedObject={};
this.initForm(ZaServer.volumeObjModel,this.getMyXForm());
this._helpURL=ZaEditVolumeXDialog.helpURL
};
ZaEditVolumeXDialog.prototype=new ZaXDialog;
ZaEditVolumeXDialog.prototype.constructor=ZaEditVolumeXDialog;
ZaEditVolumeXDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/adding_a_new_storage_volume_to_the_server.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaEditVolumeXDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_ZAWIZGROUP_,isTabGroup:true,items:[{
ref:ZaServer.A_VolumeName,type:_TEXTFIELD_,label:ZaMsg.LBL_VM_VolumeName,labelLocation:_LEFT_,width:250,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaServer.A_VolumeRootPath,type:_TEXTFIELD_,label:ZaMsg.LBL_VM_VolumeRootPath,labelLocation:_LEFT_,width:250,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaServer.A_VolumeType,type:_OSELECT1_,choices:ZaServer.volumeTypeChoices,width:250,label:ZaMsg.LBL_VM_VolumeType,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaServer.A_VolumeCompressBlobs,type:_WIZ_CHECKBOX_,label:ZaMsg.VM_VolumeCompressBlobs,trueValue:true,falseValue:false,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_GROUP_,numCols:3,colSpan:2,colSizes:["200px","150px","125px"],items:[{
ref:ZaServer.A_VolumeCompressionThreshold,type:_TEXTFIELD_,label:ZaMsg.LBL_VM_VolumeCompressThreshold,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.NAD_bytes,align:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.servers.view.ZaProxyPortWarningXDialog")){
ZaProxyPortWarningXDialog=function(n,t,o,r,e){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,n,null,r,t,o);
this._containedObject=e?e:{
selectedChoice:0,choice1Label:"",choice2Label:"",choice3Label:"",warningMsg:""};
var s={
items:[{
id:"selectedChoice",type:_NUMBER_,defaultValue:0}
,{
id:"choice1Label",type:_STRING_,defaultValue:ZaMsg.Server_WrongPortWarning_OP1}
,{
id:"choice2Label",type:_STRING_,defaultValue:ZaMsg.Server_WrongPortWarning_OP2}
,{
id:"choice3Label",type:_STRING_,defaultValue:ZaMsg.Server_WrongPortWarning_OP3}
,{
id:"warningMsg",type:_STRING_,defaultValue:ZaMsg.Server_WrongPortWarning}
]};
this.initForm(s,this.getMyXForm(),this._containedObject)
};
ZaProxyPortWarningXDialog.prototype=new ZaXDialog;
ZaProxyPortWarningXDialog.prototype.constructor=ZaProxyPortWarningXDialog;
ZaProxyPortWarningXDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_ZAWIZGROUP_,numCols:2,colSizes:["100px","400px"],items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0px",style:DwtAlert.WARNING,iconVisible:true,ref:"warningMsg",forceUpdate:true}
,{
type:_RADIO_LABEL_,forceUpdate:true,ref:"selectedChoice",labelRef:"choice1Label",label:"N/A",groupname:"proxyChoice",value:0}
,{
type:_RADIO_LABEL_,forceUpdate:true,ref:"selectedChoice",labelRef:"choice2Label",label:"N/A",groupname:"proxyChoice",value:1}
,{
type:_RADIO_LABEL_,forceUpdate:true,ref:"selectedChoice",labelRef:"choice3Label",label:"N/A",groupname:"proxyChoice",value:2}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.servers.view.ZaServerListView")){
ZaServerListView=function(n){
if(arguments.length==0){
return
}
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
var e=ZaServerListView._getHeaderList();
ZaListView.call(this,{
parent:n,className:o,posStyle:t,headerList:e,id:ZaId.TAB_SERVER_MANAGE}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaServerListView.prototype=new ZaListView;
ZaServerListView.prototype.constructor=ZaServerListView;
ZaServerListView.prototype.toString=function(){
return"ZaServerListView"
};
ZaServerListView.prototype.getTitle=function(){
return ZaMsg.Servers_view_title
};
ZaServerListView.prototype.getTabIcon=function(){
return"Server"
};
ZaServerListView.prototype._createItemHtml=function(n,t,s){
var h=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(n,e,DwtListView.TYPE_LIST_ITEM);
var c=0;
h[c++]="<table width='100%'>";
h[c++]="<tr>";
var o=this._headerList.length;
for(var r=0;
r<o;
r++){
var l=this._headerList[r]._field;
if(l=="type"){
h[c++]="<td width="+this._headerList[r]._width+">"+AjxImg.getImageHtml("Server")+"</td>"
}else{
if(l==ZaServer.A_ServiceHostname){
h[c++]="<td align='left' width="+this._headerList[r]._width+"><nobr>";
h[c++]=AjxStringUtil.htmlEncode(n.attrs[ZaServer.A_ServiceHostname]);
h[c++]="</nobr></td>"
}else{
if(l==ZaServer.A_description){
h[c++]="<td align='left' width="+this._headerList[r]._width+"><nobr>";
h[c++]=AjxStringUtil.htmlEncode(ZaItem.getDescriptionValue(n.attrs[ZaServer.A_description]));
h[c++]="</nobr></td>"
}}}}
h[c++]="</tr></table>";
e.innerHTML=h.join("");
return e
};
ZaServerListView._getHeaderList=function(){
var e=new Array();
var o=1;
var t=0;
e[t++]=new ZaListHeaderItem("type",null,null,"22px",null,"objectClass",false,true);
e[t++]=new ZaListHeaderItem(ZaServer.A_ServiceHostname,ZaMsg.SLV_ServiceHName_col,null,200,o++,ZaServer.A_ServiceHostname,true,true);
e[t++]=new ZaListHeaderItem(ZaServer.A_description,ZaMsg.DLV_Description_col,null,"auto",null,ZaServer.A_description,true,true);
return e
}
}
if(AjxPackage.define("zimbraAdmin.servers.view.ZaServerMiniListView")){
ZaServerMiniListView=function(n,o,t,e){
if(arguments.length==0){
return
}
ZaListView.call(this,n,o,t,e);
this.hideHeader=false
};
ZaServerMiniListView.prototype=new ZaListView;
ZaServerMiniListView.prototype.constructor=ZaServerMiniListView;
ZaServerMiniListView.prototype.toString=function(){
return"ZaServerMiniListView"
};
ZaServerMiniListView.prototype.createHeaderHtml=function(e){
if(!this.hideHeader){
DwtListView.prototype.createHeaderHtml.call(this,e)
}};
ZaServerMiniListView.prototype._createItemHtml=function(r){
var n=new Array(50);
var h=document.createElement("div");
h[DwtListView._STYLE_CLASS]="Row";
h[DwtListView._SELECTED_STYLE_CLASS]=h[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
h.className=h[DwtListView._STYLE_CLASS];
this.associateItemWithElement(r,h,DwtListView.TYPE_LIST_ITEM);
var e=0;
n[e++]="<table width='100%' cellspacing='0' cellpadding='0'>";
n[e++]="<tr>";
var o=this._headerList.length;
for(var t=0;
t<o;
t++){
var s=this._headerList[t]._field;
if(s==ZaServer.A_ServiceHostname){
n[e++]="<td align='left' width="+this._headerList[t]._width+"><nobr>";
n[e++]=AjxStringUtil.htmlEncode(r.attrs[ZaServer.A_ServiceHostname]);
n[e++]="</nobr></td>"
}else{
if(s=="status"){
n[e++]="<td width="+this._headerList[t]._width+">";
switch(r.status){
case"processing":n[e++]=AjxImg.getImageHtml("DwtWait16Icon");
break;
case"error":n[e++]=AjxImg.getImageHtml("Cancel");
break;
case"success":n[e++]=AjxImg.getImageHtml("Check");
break;
default:n[e++]=AjxImg.getImageHtml("QuestionMark");
break
}
n[e++]="</td>"
}}}
n[e++]="</tr></table>";
h.innerHTML=n.join("");
return h
}
}
if(AjxPackage.define("zimbraAdmin.servers.view.ZaFlushCacheXDialog")){
ZaFlushCacheXDialog=function(e,t){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON];
ZaXDialog.call(this,e,null,ZaMsg.FlushCacheDlgTitle+" ("+t.name+")","480px","380px","ZaFlushCacheXDialog",ZaId.FLUSH_SERVER_CACHE+t.id);
this._containedObject={};
this.initForm(ZaServer.volumeObjModel,this.getMyXForm());
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/flushing_the_server_cache.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaApp.getInstance().dialogs["ZaFlushCacheXDialog_"+t.id]=this
};
ZaFlushCacheXDialog.prototype=new ZaXDialog;
ZaFlushCacheXDialog.prototype.supportMinimize=true;
ZaFlushCacheXDialog.prototype.constructor=ZaFlushCacheXDialog;
ZaFlushCacheXDialog.flushingServerModel={
type:_OBJECT_,items:[{
id:ZaItem.A_zimbraId,type:_STRING_,ref:"attrs/"+ZaItem.A_zimbraId}
,{
id:"status",type:_NUMBER_,ref:"status"}
,{
id:ZaServer.A_name,ref:"attrs/"+ZaServer.A_name,type:_STRING_}
,{
id:ZaServer.A_ServiceHostname,ref:"attrs/"+ZaServer.A_ServiceHostname,type:_HOSTNAME_OR_IP_,maxLength:256}
,{
id:ZaServer.A_zimbraMailProxyServiceEnabled,ref:"attrs/"+ZaServer.A_zimbraMailProxyServiceEnabled,type:_ENUM_,choices:[false,true]}
,{
id:ZaServer.A_zimbraMailboxServiceInstalled,ref:"attrs/"+ZaServer.A_zimbraMailboxServiceInstalled,type:_ENUM_,choices:[false,true]}
]};
ZaFlushCacheXDialog.xModel={
items:[{
id:"statusMessage",ref:"statusMessage",type:_STRING_}
,{
id:"flushZimlet",ref:"flushZimlet",type:_ENUM_,choices:[false,true]}
,{
id:"flushSkin",ref:"flushSkin",type:_ENUM_,choices:[false,true]}
,{
id:"flushLocale",ref:"flushSkin",type:_ENUM_,choices:[false,true]}
,{
id:"serverList",ref:"serverList",type:_LIST_,listItem:ZaFlushCacheXDialog.flushingServerModel}
,{
id:"status",type:_NUMBER_,ref:"status"}
]};
ZaFlushCacheXDialog.flushCacheCalback=function(s,r){
if(s.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,s.busyId)
}
var t=s.ix;
var o=[];
var l=this.getInstanceValue("serverList");
o._version=l._version+1;
for(var h=0;
h<l.length;
h++){
o.push(l[h])
}
if(r.isException&&r.isException()){
this.getModel().setInstanceValue(this.getInstance(),"status",0);
var e=AjxMessageFormat.format(ZaMsg.ERROR_FAILED_FLUSH_CACHE,[s.serverList[s.ix].attrs[ZaServer.A_name]]);
this.getModel().setInstanceValue(this.getInstance(),"statusMessage",e);
o[t].status="error";
this.getModel().setInstanceValue(this.getInstance(),"serverList",o);
ZaApp.getInstance().getCurrentController()._handleException(r.getException(),"ZaFlushCacheXDialog.flushCacheCalback",null,false)
}else{
if(r.getResponse()&&r.getResponse().Body&&r.getResponse().Body.BatchResponse&&r.getResponse().Body.BatchResponse.Fault){
this.getModel().setInstanceValue(this.getInstance(),"status",0);
this.getModel().setInstanceValue(this.getInstance(),"statusMessage",e);
var d=r.getResponse().Body.BatchResponse.Fault;
if(d instanceof Array){
d=d[0]
}
if(d){
var c=ZmCsfeCommand.faultToEx(d);
ZaApp.getInstance().getCurrentController()._handleException(c,"ZaFlushCacheXDialog.flushCacheCalback",null,false)
}}else{
var n=Dwt.getNextId();
t++;
o._version=l._version+1;
o[t-1].status="success";
if(t>=l.length){
this.getModel().setInstanceValue(this.getInstance(),"status",0);
this.getModel().setInstanceValue(this.getInstance(),"statusMessage",ZaMsg.FinishedFlushCache);
this.getModel().setInstanceValue(this.getInstance(),"serverList",o)
}else{
o[t].status="processing";
this.getModel().setInstanceValue(this.getInstance(),"serverList",o);
s.busyid=n;
s.ix=t;
var u=new AjxCallback(this,ZaFlushCacheXDialog.flushCacheCalback,s);
s.callback=u;
this.getModel().setInstanceValue(this.getInstance(),"status",1);
this.getModel().setInstanceValue(this.getInstance(),"statusMessage",AjxMessageFormat.format(ZaMsg.BUSY_FLUSH_CACHE_SERVER,[s.serverList[s.ix].attrs[ZaServer.A_name]]));
ZaServer.flushCache(s)
}}}};
ZaFlushCacheXDialog.flushButtonListener=function(){
var e=Dwt.getNextId();
var t=this.getInstance();
t.ix=0;
t.busyId=e;
var o=new AjxCallback(this,ZaFlushCacheXDialog.flushCacheCalback,t);
t.callback=o;
this.getModel().setInstanceValue(this.getInstance(),"status",1);
this.getModel().setInstanceValue(this.getInstance(),"statusMessage",AjxMessageFormat.format(ZaMsg.BUSY_FLUSH_CACHE_SERVER,[t.serverList[t.ix].attrs[ZaServer.A_name]]));
ZaServer.flushCache(t)
};
ZaFlushCacheXDialog.prototype.isFlushBtnEnabled=function(){
return((this.getInstanceValue("status")<1)&&(this.getInstanceValue("serverList").length>0)&&(this.getInstanceValue("flushZimlet")||this.getInstanceValue("flushSkin")||this.getInstanceValue("flushLocale")))
};
ZaFlushCacheXDialog.prototype.getMyXForm=function(){
var e=[];
var o=1;
e[0]=new ZaListHeaderItem(ZaServer.A_ServiceHostname,ZaMsg.SLV_ServiceHName_col,null,"auto",o++,ZaServer.A_ServiceHostname,true,true);
e[1]=new ZaListHeaderItem("status",ZaMsg.STV_Status_col,null,40,o++,"status",true,true);
var t={
numCols:1,items:[{
type:_ZAWIZGROUP_,isTabGroup:true,colSizes:["200px","275px"],items:[{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_FlushCache,align:_CENTER_,valign:_MIDDLE_,colSpan:2,width:"460px",visibilityChecks:[]}
,{
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,iconVisible:true,content:null,ref:"statusMessage",align:_CENTER_,valign:_MIDDLE_,colSpan:2,width:"460px",visibilityChecks:[[XForm.checkInstanceValueNotEmty,"statusMessage"]],visibilityChangeEventSources:["statusMessage"],bmolsnr:true}
,{
ref:"serverList",type:_DWT_LIST_,labelLocation:_NONE_,label:null,height:"120",width:"460",colSpan:2,headerList:e,align:_CENTER_,visibilityChecks:[],enableDisableChecks:[],widgetClass:ZaServerMiniListView,valueChangeEventSources:["serverList"]}
,{
ref:"flushZimlet",type:_WIZ_CHECKBOX_,label:ZaMsg.Flush_zimlet_cache,trueValue:true,falseValue:false,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:"flushSkin",type:_WIZ_CHECKBOX_,label:ZaMsg.Flush_theme_cache,trueValue:true,falseValue:false,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:"flushLocale",type:_WIZ_CHECKBOX_,label:ZaMsg.Flush_locale_cache,trueValue:true,falseValue:false,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.FlushCacheBtn,width:"100px",onActivate:"ZaFlushCacheXDialog.flushButtonListener.call(this);",enableDisableChangeEventSources:["status","flushZimlet","flushSkin","flushLocale"],enableDisableChecks:[ZaFlushCacheXDialog.prototype.isFlushBtnEnabled]}
]}
]};
return t
}
}
if(AjxPackage.define("zimbraAdmin.servers.view.ZaServerXFormView")){
ZaServerXFormView=function(e,t){
ZaTabView.call(this,{
parent:e,iKeyName:"ZaServerXFormView",contextId:ZaId.TAB_SERVER_EDIT}
);
this.TAB_INDEX=0;
this.initForm(ZaServer.myXModel,this.getMyXForm(t),null);
this._localXForm.setController(ZaApp.getInstance())
};
ZaServerXFormView.prototype=new ZaTabView();
ZaServerXFormView.prototype.constructor=ZaServerXFormView;
ZaTabView.XFormModifiers.ZaServerXFormView=new Array();
ZaServerXFormView.setObjectMethods=new Array();
ZaServerXFormView.indexVolChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,ZaServer.A_VolumeId,ZaServer.A_VolumeName);
ZaServerXFormView.messageVolChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,ZaServer.A_VolumeId,ZaServer.A_VolumeName);
ZaServerXFormView.onFormFieldChanged=function(o,t,e){
e.parent.setDirty(true);
this.setInstanceValue(o);
return o
};
ZaServerXFormView.onReverseLookupTargetFieldChanged=function(o,t,e){
DBG.println(AjxDebug.DBG1,"On Form Field Changed ...");
e.parent.setDirty(true);
this.setInstanceValue(o);
if(o=="TRUE"){
this.setInstanceValue("TRUE","/attrs/"+ZaServer.A_ImapCleartextLoginEnabled);
this.setInstanceValue("TRUE","/attrs/"+ZaServer.A_Pop3CleartextLoginEnabled)
}
return o
};
ZaServerXFormView.prototype.setObject=function(d){
this.entry=d;
this._containedObject=new ZaServer();
this._containedObject.attrs=new Object();
this._containedObject[ZaServer.A_showVolumes]=d[ZaServer.A_showVolumes];
this._containedObject[ZaServer.A_ServiceHostname]=d[ZaServer.A_ServiceHostname];
this._containedObject.name=d.name;
this._containedObject.type=d.type;
if(d.rights){
this._containedObject.rights=d.rights
}
if(d.setAttrs){
this._containedObject.setAttrs=d.setAttrs
}
if(d.getAttrs){
this._containedObject.getAttrs=d.getAttrs
}
if(d._defaultValues){
this._containedObject._defaultValues=d._defaultValues
}
if(d.id){
this._containedObject.id=d.id
}
this._containedObject[ZaServer.A_Volumes]=[];
if(d.attrs){
for(var c in d.attrs){
var h=this._localXForm.getModel().getItem(c);
if((h!=null&&h.type==_LIST_)||(d.attrs[c]!=null&&d.attrs[c] instanceof Array)){
this._containedObject.attrs[c]=ZaItem.deepCloneListItem(d.attrs[c])
}else{
this._containedObject.attrs[c]=d.attrs[c]
}}}
if(ZaItem.modelExtensions.ZaServer){
for(var r=0;
r<ZaItem.modelExtensions.ZaServer.length;
r++){
var o=ZaItem.modelExtensions.ZaServer[r];
if(d[o]){
this._containedObject[o]={};
for(var c in d[o]){
var h=this._localXForm.getModel().getItem(c);
if((h!=null&&h.type==_LIST_)||(d[o][c]!=null&&d[o][c] instanceof Array)){
this._containedObject[o][c]=ZaItem.deepCloneListItem(d[o][c])
}else{
this._containedObject[o][c]=d[o][c]
}}}}}
if(d[ZaServer.A_Volumes]){
for(var c in d[ZaServer.A_Volumes]){
this._containedObject[ZaServer.A_Volumes][c]={};
if(d[ZaServer.A_Volumes][c]){
for(var m in d[ZaServer.A_Volumes][c]){
this._containedObject[ZaServer.A_Volumes][c][m]=d[ZaServer.A_Volumes][c][m]
}}}}
if(!d[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=d[ZaModel.currentTab]
}
if(d[ZaServer.A_showVolumes]&&this._containedObject[ZaServer.A_Volumes]){
this._containedObject[ZaServer.A_Volumes].sort(ZaServer.compareVolumesByName);
this._containedObject[ZaServer.A_Volumes]._version=d[ZaServer.A_Volumes]._version?d[ZaServer.A_Volumes]._version:1;
var n=this._containedObject[ZaServer.A_Volumes].length;
var e=[];
var t=[];
for(var r=0;
r<n;
r++){
if(this._containedObject[ZaServer.A_Volumes][r][ZaServer.A_VolumeType]==ZaServer.INDEX){
e.push(this._containedObject[ZaServer.A_Volumes][r])
}else{
if(this._containedObject[ZaServer.A_Volumes][r][ZaServer.A_VolumeType]==ZaServer.MSG){
t.push(this._containedObject[ZaServer.A_Volumes][r])
}}}}
ZaServerXFormView.indexVolChoices.setChoices(e);
ZaServerXFormView.indexVolChoices.dirtyChoices();
ZaServerXFormView.messageVolChoices.setChoices(t);
ZaServerXFormView.messageVolChoices.dirtyChoices();
if(ZaServerXFormView.setObjectMethods){
var s=ZaServerXFormView.setObjectMethods;
var n=s.length;
for(var r=0;
r<n;
r++){
if(typeof(s[r])=="function"){
try{
s[r].call(this,d)
}
catch(l){
this._handleException(l,"ZaServerXFormView.prototype.setObject");
break
}}}}
for(var u in ZaServer.currentkeys){
if(d[ZaServer.currentkeys[u]]){
this._containedObject[ZaServer.currentkeys[u]]=d[ZaServer.currentkeys[u]]
}}
this._containedObject.newVolID=-1;
this._localXForm.setInstance(this._containedObject);
this.formDirtyLsnr=new AjxListener(ZaApp.getInstance().getCurrentController(),ZaXFormViewController.prototype.handleXFormChange);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,this.formDirtyLsnr);
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,this.formDirtyLsnr)
};
ZaServerXFormView.getTLSEnabled=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_zimbraMtaSaslAuthEnable);
return e=="yes"
};
ZaServerXFormView.getIMAPEnabled=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_ImapServerEnabled);
return e=="TRUE"
};
ZaServerXFormView.getIMAPSSLEnabled=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_ImapSSLServerEnabled);
return(e=="TRUE"&&ZaServerXFormView.getIMAPEnabled.call(this))
};
ZaServerXFormView.getPOP3Enabled=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_Pop3ServerEnabled);
return e=="TRUE"
};
ZaServerXFormView.getPOP3SSLEnabled=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_Pop3SSLServerEnabled);
return(e=="TRUE"&&ZaServerXFormView.getPOP3Enabled.call(this))
};
ZaServerXFormView.getMailClientEnabled=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_showVolumes);
return e
};
ZaServerXFormView.getIsReverseProxyLookupTarget=function(){
return(this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_zimbraReverseProxyLookupTarget)=="TRUE")
};
ZaServerXFormView.volumeSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort(ZaServer.compareVolumesByName);
this.getModel().setInstanceValue(this.getInstance(),ZaServer.A2_volume_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaServer.A2_volume_selection_cache,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaServerXFormView.editButtonListener.call(this)
}};
ZaServerXFormView.isEditVolumeEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaServer.A2_volume_selection_cache))&&this.getInstanceValue(ZaServer.A2_volume_selection_cache).length==1)
};
ZaServerXFormView.isDeleteVolumeEnabled=function(){
if(!AjxUtil.isEmpty(this.getInstanceValue(ZaServer.A2_volume_selection_cache))){
var e=this.getInstanceValue(ZaServer.A2_volume_selection_cache);
for(var t=0;
t<e.length;
t++){
for(a in ZaServer.currentkeys){
if(e[t][ZaServer.A_VolumeId]==this.getInstanceValue(ZaServer.currentkeys[a])){
return false
}}}
return true
}else{
return false
}};
ZaServerXFormView.updateVolume=function(){
if(this.parent.editVolumeDlg){
this.parent.editVolumeDlg.popdown();
var n=this.parent.editVolumeDlg.getObject();
var t=AjxSoapDoc.create("ModifyVolumeRequest",ZaZimbraAdmin.URN,null);
t.getMethod().setAttribute(ZaServer.A_VolumeId,n[ZaServer.A_VolumeId]);
var o=t.set("volume",null);
o.setAttribute("type",n[ZaServer.A_VolumeType]);
o.setAttribute("name",n[ZaServer.A_VolumeName]);
o.setAttribute("rootpath",n[ZaServer.A_VolumeRootPath]);
o.setAttribute("compressBlobs",n[ZaServer.A_VolumeCompressBlobs]);
o.setAttribute("compressionThreshold",n[ZaServer.A_VolumeCompressionThreshold]);
var r=new AjxCallback(this,ZaServerXFormView.prototype.modifyVolumeCallback);
var s={
soapDoc:t,targetServer:this.getInstanceValue(ZaItem.A_zimbraId),asyncMode:true,callback:r};
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_VOL};
ZaRequestMgr.invoke(s,e)
}};
ZaServerXFormView.prototype.modifyVolumeCallback=function(e){
if(e&&e.isException()){
ZaApp.getInstance().getCurrentController()._handleException(e.getException(),"ZaServerXFormView.createVolumeCallback")
}else{
ZaApp.getInstance().getCurrentController().popupMsgDialog(ZaMsg.UPDATE_VOLUME_CONFIRMATION);
var t=new AjxCallback(this,ZaServerXFormView.loadVolumesCallback);
ZaServer.prototype.loadVolumes.call(this.parent.getObject(),t)
}};
ZaServerXFormView.prototype.createVolumeCallback=function(s){
if(s&&s.isException()){
ZaApp.getInstance().getCurrentController()._handleException(s.getException(),"ZaServerXFormView.createVolumeCallback")
}else{
this.addVolumeDlg.popdown();
var t=s.getResponse().Body.CreateVolumeResponse;
var n=this._localXForm.getInstanceValue(ZaServer.A_Volumes);
var e=[];
for(var o=0;
o<n.length;
o++){
e.push(n[o])
}
e.push(t.volume[0]);
this._localXForm.setInstanceValue(e,ZaServer.A_Volumes);
ZaApp.getInstance().getCurrentController().popupMsgDialog(AjxMessageFormat.format(ZaMsg.VolumeCreated,[t.volume[0][ZaServer.A_VolumeRootPath]]))
}};
ZaServerXFormView.prototype.doAddVolume=function(n){
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown();
var t=AjxSoapDoc.create("CreateVolumeRequest",ZaZimbraAdmin.URN,null);
var o=t.set("volume",null);
o.setAttribute("type",n[ZaServer.A_VolumeType]);
o.setAttribute("name",n[ZaServer.A_VolumeName]);
o.setAttribute("rootpath",n[ZaServer.A_VolumeRootPath]);
o.setAttribute("compressBlobs",n[ZaServer.A_VolumeCompressBlobs]);
o.setAttribute("compressionThreshold",n[ZaServer.A_VolumeCompressionThreshold]);
var r=new AjxCallback(this,ZaServerXFormView.prototype.createVolumeCallback);
var s={
soapDoc:t,targetServer:this._containedObject.id,asyncMode:true,callback:r};
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATE_VOL};
ZaRequestMgr.invoke(s,e)
};
ZaServerXFormView.addVolume=function(){
if(this.parent.addVolumeDlg){
var e=this.parent.addVolumeDlg.getObject();
ZaApp.getInstance().dialogs.confirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.VIEW_STATUS+"_confirmMessage");
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(AjxMessageFormat.format(ZaMsg.Q_CREATE_VOLUME,[e[ZaServer.A_VolumeRootPath]]),DwtMessageDialog.INFO_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaServerXFormView.prototype.doAddVolume,this.parent,[e]);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}};
ZaServerXFormView.editButtonListener=function(){
var e=this.getInstance();
if(e.volume_selection_cache&&e.volume_selection_cache[0]){
var r=this.getForm().parent;
if(!r.editVolumeDlg){
r.editVolumeDlg=new ZaEditVolumeXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.VM_Edit_Volume_Title);
r.editVolumeDlg.registerCallback(DwtDialog.OK_BUTTON,ZaServerXFormView.updateVolume,this.getForm(),null)
}
var s={};
s[ZaServer.A_VolumeId]=e.volume_selection_cache[0][ZaServer.A_VolumeId];
s[ZaServer.A_VolumeName]=e.volume_selection_cache[0][ZaServer.A_VolumeName];
s[ZaServer.A_VolumeRootPath]=e.volume_selection_cache[0][ZaServer.A_VolumeRootPath];
s[ZaServer.A_VolumeCompressBlobs]=e.volume_selection_cache[0][ZaServer.A_VolumeCompressBlobs];
s[ZaServer.A_VolumeCompressionThreshold]=e.volume_selection_cache[0][ZaServer.A_VolumeCompressionThreshold];
s[ZaServer.A_VolumeType]=e.volume_selection_cache[0][ZaServer.A_VolumeType];
var t=this.getModel().getInstanceValue(this.getInstance(),ZaServer.A_Volumes);
var n=t.length;
for(var o=0;
o<n;
o++){
if(t[o][ZaServer.A_VolumeId]==s[ZaServer.A_VolumeId]||(!t[o][ZaServer.A_VolumeId]&&(t[o][ZaServer.A_VolumeName]==s[ZaServer.A_VolumeName])&&(t[o][ZaServer.A_VolumeRootPath]==s[ZaServer.A_VolumeRootPath]))){
s._index=o;
break
}}
r.editVolumeDlg.setObject(s);
r.editVolumeDlg.popup()
}};
ZaServerXFormView.loadVolumesCallback=function(r){
if(r&&r.isException()){
ZaApp.getInstance().getCurrentController()._handleException(r.getException(),"ZaServerXFormView.loadVolumesCallback")
}else{
var t=r.getResponse().Body.GetAllVolumesResponse;
var e=[];
var s=t.volume;
if(s){
var n=s.length;
for(var o=0;
o<n;
o++){
e.push(s[o])
}}
this.setInstanceValue(e,ZaServer.A_Volumes)
}};
ZaServerXFormView.doDeleteVolume=function(t,n,o){
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown();
if(o!=null&&o.isException&&o.isException()){
ZaApp.getInstance().getCurrentController()._handleException(o.getException(),"ZaServerXFormView.doDeleteVolume")
}else{
if(AjxUtil.isEmpty(t)){
if(!AjxUtil.isEmpty(n)){
ZaApp.getInstance().getCurrentController().popupMsgDialog(ZaMsg.DELETED_VOLUMES_CONFIRMATION);
var s=new AjxCallback(this,ZaServerXFormView.loadVolumesCallback);
ZaServer.prototype.loadVolumes.call(this.getForm().parent.getObject(),s)
}
return
}
var e=t.shift();
if(!n){
n=[]
}
n.push(e);
var s=new AjxCallback(this,ZaServerXFormView.doDeleteVolume,[t,n]);
ZaServer.prototype.deleteVolume.call(this.getForm().parent.getObject(),e[ZaServer.A_VolumeId],s)
}};
ZaServerXFormView.deleteButtonListener=function(){
var t=this.getInstance();
var o=[];
if(!t.volume_selection_cache){
return
}
var e=this.getInstanceValue(ZaServer.A2_volume_selection_cache);
ZaApp.getInstance().dialogs.confirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.VIEW_STATUS+"_confirmMessage");
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_DELETE_VOLUMES,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaServerXFormView.doDeleteVolume,this,[e,[]]);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
};
ZaServerXFormView.addButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addVolumeDlg){
o.addVolumeDlg=new ZaEditVolumeXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.VM_Add_Volume_Title);
o.addVolumeDlg.registerCallback(DwtDialog.OK_BUTTON,ZaServerXFormView.addVolume,this.getForm(),null)
}
var t={};
t[ZaServer.A_VolumeId]=e.newVolID--;
t[ZaServer.A_VolumeName]="";
t[ZaServer.A_VolumeRootPath]="/opt/zimbra";
t[ZaServer.A_VolumeCompressBlobs]=false;
t[ZaServer.A_VolumeCompressionThreshold]=4096;
t[ZaServer.A_VolumeType]=ZaServer.MSG;
t.current=false;
o.addVolumeDlg.setObject(t);
o.addVolumeDlg.popup()
};
ZaServerXFormView.SERVICE_TAB_ATTRS=[ZaServer.A_zimbraLdapServiceEnabled,ZaServer.A_zimbraMailboxServiceEnabled,ZaServer.A_zimbraMailProxyServiceEnabled,ZaServer.A_zimbraMtaServiceEnabled,ZaServer.A_zimbraSnmpServiceEnabled,ZaServer.A_zimbraAntiSpamServiceEnabled,ZaServer.A_zimbraAntiVirusServiceEnabled,ZaServer.A_zimbraOpenDKIMServiceEnabled,ZaServer.A_zimbraSpellServiceEnabled,ZaServer.A_zimbraLoggerServiceEnabled];
ZaServerXFormView.SERVICE_TAB_RIGHTS=[];
ZaServerXFormView.MTA_TAB_ATTRS=[ZaServer.A_zimbraMtaSaslAuthEnable,ZaServer.A_zimbraMtaTlsAuthOnly,ZaServer.A_zimbraSmtpHostname,ZaServer.A_SmtpPort,ZaServer.A_zimbraMtaRelayHost,ZaServer.A_zimbraMtaFallbackRelayHost,ZaServer.A_SmtpTimeout,ZaServer.A_zimbraMtaMyNetworks,ZaServer.A_zimbraMtaSmtpDnsSupportLevel];
ZaServerXFormView.MTA_TAB_RIGHTS=[];
ZaServerXFormView.AUTH_TAB_ATTRS=[ZaServer.A_zimbraSpnegoAuthPrincipal,ZaServer.A_zimbraSpnegoAuthTargetName];
ZaServerXFormView.AUTH_TAB_RIGHTS=[];
ZaServerXFormView.IMAP_TAB_ATTRS=[ZaServer.A_ImapServerEnabled,ZaServer.A_ImapSSLServerEnabled,ZaServer.A_ImapCleartextLoginEnabled,ZaServer.A_zimbraImapNumThreads,ZaServer.A_zimbraImapBindPort,ZaServer.A_ImapSSLBindPort,ZaServer.A_zimbraImapProxyBindPort,ZaServer.A_zimbraImapSSLProxyBindPort];
ZaServerXFormView.IMAP_TAB_RIGHTS=[];
ZaServerXFormView.POP_TAB_ATTRS=[ZaServer.A_Pop3ServerEnabled,ZaServer.A_Pop3SSLServerEnabled,ZaServer.A_Pop3CleartextLoginEnabled,ZaServer.A_zimbraPop3NumThreads,ZaServer.A_Pop3AdvertisedName,ZaServer.A_Pop3BindAddress,ZaServer.A_zimbraPop3BindPort,ZaServer.A_zimbraPop3SSLBindPort,ZaServer.A_zimbraPop3ProxyBindPort,ZaServer.A_zimbraPop3SSLProxyBindPort];
ZaServerXFormView.POP_TAB_RIGHTS=[];
ZaServerXFormView.VOLUMES_TAB_ATTRS=[];
ZaServerXFormView.VOLUMES_TAB_RIGHTS=[ZaServer.MANAGE_VOLUME_RIGHT];
ZaServerXFormView.MTA_NETWORK_GROUP_ATTRS=[ZaServer.A_zimbraImapBindPort,ZaServer.A_ImapSSLBindPort,ZaServer.A_zimbraImapProxyBindPort,ZaServer.A_zimbraImapProxyBindPort,ZaServer.A_zimbraImapSSLProxyBindPort];
ZaServerXFormView.MTA_SERVICE_GROUP_ATTRS=[ZaServer.A_ImapServerEnabled,ZaServer.A_ImapSSLServerEnabled,ZaServer.A_ImapCleartextLoginEnabled,ZaServer.A_zimbraImapNumThreads];
ZaServerXFormView.BIND_IP_TAB_ATTRS=[ZaServer.A_zimbraMailBindAddress,ZaServer.A_zimbraMailSSLBindAddress,ZaServer.A_zimbraMailSSLClientCertBindAddress,ZaServer.A_zimbraAdminBindAddress];
ZaServerXFormView.BIND_IP_TAB_RIGHTS=[];
ZaServerXFormView.myXFormModifier=function(g,t){
var h=new Array();
h[0]=new ZaListHeaderItem(ZaServer.A_VolumeName,ZaMsg.VM_VolumeName,null,"100px",false,null,false,true);
h[1]=new ZaListHeaderItem(ZaServer.A_VolumeRootPath,ZaMsg.VM_VolumeRootPath,null,"200px",false,null,false,true);
h[2]=new ZaListHeaderItem(ZaServer.A_VolumeType,ZaMsg.VM_VolumeType,null,"120px",null,null,false,true);
h[3]=new ZaListHeaderItem(ZaServer.A_VolumeCompressBlobs,ZaMsg.VM_VolumeCompressBlobs,null,"120px",null,null,false,true);
h[4]=new ZaListHeaderItem(ZaServer.A_VolumeCompressionThreshold,ZaMsg.VM_VolumeCompressThreshold,null,"120px",null,null,false,true);
h[5]=new ZaListHeaderItem(ZaServer.A_isCurrentVolume,ZaMsg.VM_CurrentVolume,null,"auto",null,null,false,true);
var q,k,v,w,b,y,p,f,m;
var e=[];
this.helpMap={};
q=++this.TAB_INDEX;
e.push({
value:q,label:ZaMsg.TABT_GeneralPage}
);
this.helpMap[q]=[location.pathname,ZaUtil.HELP_URL,"managing_servers/managing_servers.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
if(ZaTabView.isTAB_ENABLED(t,ZaServerXFormView.SERVICE_TAB_ATTRS,ZaServerXFormView.SERVICE_TAB_RIGHTS)){
k=++this.TAB_INDEX;
e.push({
value:k,label:ZaMsg.NAD_Tab_Services}
);
this.helpMap[k]=[location.pathname,ZaUtil.HELP_URL,"managing_servers/managing_servers.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaServerXFormView.MTA_TAB_ATTRS,ZaServerXFormView.MTA_TAB_RIGHTS)){
v=++this.TAB_INDEX;
e.push({
value:v,label:ZaMsg.NAD_Tab_MTA}
);
this.helpMap[v]=[location.pathname,ZaUtil.HELP_URL,"managing_servers/configuring_the_mta_tab_for_servers.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaServerXFormView.IMAP_TAB_ATTRS,ZaServerXFormView.IMAP_TAB_RIGHTS)){
b=++this.TAB_INDEX;
e.push({
value:b,label:ZaMsg.NAD_Tab_IMAP}
);
this.helpMap[b]=[location.pathname,ZaUtil.HELP_URL,"managing_servers/configuring_imap_settings.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaServerXFormView.POP_TAB_ATTRS,ZaServerXFormView.POP_TAB_RIGHTS)){
y=++this.TAB_INDEX;
e.push({
value:y,label:ZaMsg.NAD_Tab_POP}
);
this.helpMap[y]=[location.pathname,ZaUtil.HELP_URL,"managing_server/configuring_pop_Settings.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaServerXFormView.VOLUMES_TAB_ATTRS,ZaServerXFormView.VOLUMES_TAB_RIGHTS)){
p=++this.TAB_INDEX;
e.push({
value:p,label:ZaMsg.NAD_Tab_VolumeMgt}
);
this.helpMap[p]=[location.pathname,ZaUtil.HELP_URL,"managing_servers/volume_management.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaServerXFormView.BIND_IP_TAB_ATTRS,ZaServerXFormView.BIND_IP_TAB_RIGHTS)){
f=++this.TAB_INDEX;
e.push({
value:f,label:ZaMsg.NAD_Tab_Bind_IP}
);
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_servers/setting_up_ip_address_binding.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
var x=[];
var d={
type:_ZATABCASE_,numCols:1,caseKey:q,id:"server_general_tab",paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_ZA_TOP_GROUPER_,width:"100%",numCols:2,colSizes:["275px","100%"],label:ZaMsg.TABT_GeneralPage,items:[{
ref:ZaServer.A_name,type:_OUTPUT_,label:ZaMsg.NAD_DisplayName,labelLocation:_LEFT_}
,ZaItem.descriptionXFormItem,{
ref:ZaServer.A_ServiceHostname,type:_OUTPUT_,label:ZaMsg.LBL_ServiceHostname,cssClass:"admin_xform_name_input"}
,{
ref:ZaServer.A_LmtpAdvertisedName,type:_INPUT_,label:ZaMsg.NAD_LmtpAdvertisedName,cssClass:"admin_xform_name_input",onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_LmtpBindAddress,type:_INPUT_,label:ZaMsg.NAD_LmtpBindAddress,cssClass:"admin_xform_name_input",onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraScheduledTaskNumThreads,labelWrap:true,type:_INPUT_,label:ZaMsg.NAD_zimbraScheduledTaskNumThreads,cssClass:"admin_xform_name_input",onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraMailPurgeSleepInterval,type:_SUPER_LIFETIME_,labelCssStyle:"text-align:left;background-color:#DEE5F1 !important;padding-left:10px;border-right:1px solid;",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,msgName:ZaMsg.MSG_zimbraMailPurgeSleepInterval,txtBoxLabel:ZaMsg.LBL_zimbraMailPurgeSleepInterval,colSpan:2,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraReverseProxyLookupTarget,type:_SUPER_CHECKBOX_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,conSpan:4,msgName:ZaMsg.NAD_zimbraReverseProxyLookupTarget,checkBoxLabel:ZaMsg.NAD_zimbraReverseProxyLookupTarget,colSpan:2,colSizes:["275px","275px","*"],trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onReverseLookupTargetFieldChanged}
,{
ref:ZaServer.A_notes,type:_TEXTAREA_,label:ZaMsg.NAD_Notes,labelCssStyle:"vertical-align:top;",width:"30em",onChange:ZaServerXFormView.onFormFieldChanged}
]}
]};
x.push(d);
if(k){
var c={
type:_ZATABCASE_,colSizes:["auto"],numCols:1,id:"server_services_tab",caseKey:k,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_Service_EnabledServices,items:[{
ref:ZaServer.A_zimbraLdapServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraLdapServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraLdapServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_LDAP,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraMailboxServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraMailboxServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraMailboxServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_Mailbox,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraMailProxyServiceEnabled,type:_CHECKBOX_,enableDisableChecks:[[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_Imapproxy,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraMtaServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraMtaServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraMtaServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_MTA,onChange:ZaServerXFormView.onMtaServiceChanged}
,{
ref:ZaServer.A_zimbraPolicydServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraPolicydServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraPolicydServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_Policyd,onChange:ZaServerXFormView.onMtaServiceChanged}
,{
ref:ZaServer.A_zimbraSnmpServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraSnmpServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraSnmpServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_SNMP,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraAntiSpamServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraAntiSpamServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraAntiSpamServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_AntiSpam,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraAntiVirusServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraAntiVirusServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraAntiVirusServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_AntiVirus,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraSpellServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraSpellServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraSpellServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_Spell,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraLoggerServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraLoggerServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraLoggerServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_Logger,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraVmwareHAServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraVmwareHAServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraVmwareHAServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraServiceEnabled]],label:ZaMsg.NAD_Service_VmwareHA,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraOpenDKIMServiceEnabled,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraOpenDKIMServiceInstalled],enableDisableChecks:[[XForm.checkInstanceValue,ZaServer.A_zimbraOpenDKIMServiceInstalled,true],[ZaItem.hasWritePermission,ZaServer.A_zimbraOpenDKIMServiceEnabled]],label:ZaMsg.NAD_Service_OpenDKIM,onChange:ZaServerXFormView.onFormFieldChanged}
]}
]};
x.push(c)
}
if(v){
var l={
type:_ZATABCASE_,id:"server_mta_tab",caseKey:v,colSizes:["auto"],numCols:1,items:[{
type:_ZA_TOP_GROUPER_,colSizes:["auto"],numCols:1,label:ZaMsg.Global_MTA_AuthenticationGrp,items:[{
ref:ZaServer.A_zimbraMtaSaslAuthEnable,type:_SUPER_CHECKBOX_,trueValue:"yes",falseValue:"no",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,checkBoxLabel:ZaMsg.NAD_MTA_Authentication}
,{
ref:ZaServer.A_zimbraMtaTlsAuthOnly,type:_SUPER_CHECKBOX_,enableDisableChangeEventSources:[ZaServer.A_zimbraMtaSaslAuthEnable],enableDisableChecks:[ZaServerXFormView.getTLSEnabled],trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,checkBoxLabel:ZaMsg.NAD_MTA_TlsAuthenticationOnly}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["275","100%"],numCols:2,label:ZaMsg.Global_MTA_NetworkGrp,items:[{
type:_SUPER_REPEAT_,ref:ZaServer.A_zimbraSmtpHostname,label:ZaMsg.LBL_zimbraSmtpHostname,colSizes:["310px","150px","*"],colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.Add_zimbraSmtpHostname,removeButtonLabel:ZaMsg.Remove_zimbraSmtpHostname,removeButtonCSSStyle:"margin-left:5px;",bmolsnr:true,repeatItems:[{
type:_TEXTFIELD_,ref:".",toolTipContent:ZaMsg.tt_zimbraSmtpHostname,cssClass:"admin_xform_name_input",enableDisableChecks:[],visibilityChecks:[],bmolsnr:true,elementChanged:function(T,z,j){
this.getForm().itemChanged(this,T,j);
this.getForm().itemChanged(this.getParentItem(),T,j)
}}
]}
,{
ref:ZaServer.A_SmtpPort,type:_OUTPUT_,label:ZaMsg.NAD_MTA_WebMailPort,width:"4em"}
,{
ref:ZaServer.A_zimbraMtaRelayHost,type:_SUPER_HOSTPORT_,label:ZaMsg.NAD_MTA_RelayMTA,colSpan:1,onClick:"ZaController.showTooltip",toolTipContent:ZaMsg.tt_MTA_RelayMTA,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,bmolsnr:true,elementChanged:function(T,z,j){
this.getForm().itemChanged(this,T,j);
this.getForm().itemChanged(this.getParentItem(),T,j)
}}
,{
ref:ZaServer.A_zimbraMtaFallbackRelayHost,type:_SUPER_HOSTPORT_,label:ZaMsg.NAD_MTA_FallbackRelay,colSpan:1,toolTipContent:ZaMsg.tt_MTA_FallbackRelay,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,bmolsnr:true,elementChanged:function(T,z,j){
this.getForm().itemChanged(this,T,j);
this.getForm().itemChanged(this.getParentItem(),T,j)
}}
,{
ref:ZaServer.A_SmtpTimeout,type:_TEXTFIELD_,label:ZaMsg.NAD_MTA_WebMailTimeout,width:"4em",onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraMtaMyNetworks,txtBoxLabel:ZaMsg.NAD_MTA_MyNetworks,msgName:ZaMsg.NAD_MTA_MyNetworks,type:_SUPER_TEXTAREA_,labelCssClass:"gridGroupBodyLabel",labelCssStyle:"text-align:left;border-right:1px solid;",colSpan:2,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,onChange:ZaServerXFormView.onFormFieldChanged,textAreaWidth:"220px"}
,{
ref:ZaServer.A_zimbraMtaSmtpDnsSupportLevel,type:_SUPER_SELECT1_,colSpan:2,label:ZaMsg.NAD_MTA_SMTP_Dns,onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,labelLocation:_LEFT_}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["275px","100%"],numCols:2,label:ZaMsg.Global_MTA_MilterServer,items:[{
ref:ZaServer.A_zimbraMilterServerEnabled,type:_SUPER_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,checkBoxLabel:ZaMsg.NAD_MTA_MilterServerEnabled}
,{
type:_REPEAT_,ref:ZaServer.A_zimbraMilterBindAddress,label:ZaMsg.NAD_MTA_MilterBindAddress,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.NAD_MTA_AddBindAddress,removeButtonLabel:ZaMsg.NAD_MTA_RemoveBindAddress,removeButtonCSSStyle:"margin-left:50px;",bmolsnr:true,items:[{
type:_TEXTFIELD_,ref:".",enableDisableChecks:[],visibilityChecks:[],bmolsnr:true,elementChanged:function(T,z,j){
this.getForm().itemChanged(this,T,j);
this.getForm().itemChanged(this.getParentItem(),T,j)
}}
]}
,{
ref:ZaServer.A_zimbraMilterBindPort,type:_OUTPUT_,label:ZaMsg.NAD_MTA_MilterBindPort}
]}
]};
x.push(l)
}
if(b){
var r={
type:_ZATABCASE_,colSizes:["auto"],numCols:1,caseKey:b,id:"server_imap_tab",items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Alert_ServerRestart}
]};
if(ZAGroup_XFormItem.isGroupVisible(t,ZaServerXFormView.MTA_SERVICE_GROUP_ATTRS,[])){
r.items.push({
type:_ZA_TOP_GROUPER_,colSizes:["auto"],numCols:1,label:ZaMsg.Global_IMAP_ServiceGrp,items:[{
ref:ZaServer.A_ImapServerEnabled,type:_SUPER_CHECKBOX_,checkBoxLabel:ZaMsg.IMAP_Service,trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
,{
ref:ZaServer.A_ImapSSLServerEnabled,type:_SUPER_CHECKBOX_,checkBoxLabel:ZaMsg.IMAP_SSLService,trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
,{
ref:ZaServer.A_ImapCleartextLoginEnabled,type:_SUPER_CHECKBOX_,checkBoxLabel:ZaMsg.IMAP_CleartextLoginEnabled,trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
,{
ref:ZaServer.A_zimbraImapNumThreads,type:_SUPER_TEXTFIELD_,txtBoxLabel:ZaMsg.IMAP_NumThreads,width:"5em",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
]}
)
}
if(ZAGroup_XFormItem.isGroupVisible(t,ZaServerXFormView.MTA_NETWORK_GROUP_ATTRS,[])){
r.items.push({
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_IMAP_NetworkGrp,items:[{
ref:ZaServer.A_zimbraImapBindPort,type:_TEXTFIELD_,enableDisableChecks:[ZaServerXFormView.getIMAPEnabled,ZaItem.hasReadPermission],enableDisableChangeEventSources:[ZaServer.A_ImapServerEnabled],label:ZaMsg.LBL_IMAP_Port,width:"5em",onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_ImapSSLBindPort,type:_TEXTFIELD_,enableDisableChecks:[ZaServerXFormView.getIMAPSSLEnabled,ZaItem.hasReadPermission],enableDisableChangeEventSources:[ZaServer.A_ImapServerEnabled,ZaServer.A_ImapSSLServerEnabled],label:ZaMsg.LBL_IMAP_SSLPort,width:"5em",onChange:ZaServerXFormView.onFormFieldChanged}
]}
)
}
x.push(r)
}
if(y){
var s={
type:_ZATABCASE_,caseKey:y,id:"server_pop_tab",colSizes:["auto"],numCols:1,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Alert_ServerRestart}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_POP_ServiceGrp,items:[{
ref:ZaServer.A_Pop3ServerEnabled,type:_SUPER_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,checkBoxLabel:ZaMsg.NAD_POP_Service}
,{
ref:ZaServer.A_Pop3SSLServerEnabled,type:_SUPER_CHECKBOX_,checkBoxLabel:ZaMsg.NAD_POP_SSL,trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
,{
ref:ZaServer.A_Pop3CleartextLoginEnabled,type:_SUPER_CHECKBOX_,checkBoxLabel:ZaMsg.NAD_POP_CleartextLoginEnabled,trueValue:"TRUE",falseValue:"FALSE",onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
,{
ref:ZaServer.A_zimbraPop3NumThreads,type:_SUPER_TEXTFIELD_,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",txtBoxLabel:ZaMsg.NAD_POP_NumThreads,onChange:ZaServerXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_POP_NetworkGrp,items:[{
type:_GROUP_,numCols:2,colSpan:2,colSizes:["275px","*"],enableDisableChangeEventSources:[ZaServer.A_Pop3ServerEnabled],enableDisableChecks:[ZaServerXFormView.getPOP3Enabled],items:[{
ref:ZaServer.A_Pop3AdvertisedName,type:_TEXTFIELD_,labelLocation:_LEFT_,label:ZaMsg.NAD_POP_AdvertisedName,onChange:ZaServerXFormView.onFormFieldChanged,labelCssClass:"gridGroupBodyLabel",labelCssStyle:"text-align:left;border-right:1px solid;"}
]}
,{
type:_GROUP_,numCols:2,colSpan:2,colSizes:["275px","*"],enableDisableChangeEventSources:[ZaServer.A_Pop3ServerEnabled],enableDisableChecks:[ZaServerXFormView.getPOP3Enabled],items:[{
ref:ZaServer.A_Pop3BindAddress,type:_TEXTFIELD_,labelCssClass:"gridGroupBodyLabel",labelCssStyle:"text-align:left;border-right:1px solid;",label:ZaMsg.NAD_POP_Address,onChange:ZaServerXFormView.onFormFieldChanged}
,{
type:_OUTPUT_,ref:".",label:"",labelCssClass:"gridGroupBodyLabel",labelCssStyle:"text-align:left;border-right:1px solid;",labelLocation:_LEFT_,value:ZaMsg.NAD_POP_Address_NOTE}
]}
,{
ref:ZaServer.A_zimbraPop3BindPort,type:_TEXTFIELD_,enableDisableChangeEventSources:[ZaServer.A_Pop3ServerEnabled],enableDisableChecks:[ZaServerXFormView.getPOP3Enabled,ZaItem.hasWritePermission],label:ZaMsg.LBL_POP_Port,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraPop3SSLBindPort,type:_TEXTFIELD_,visibilityChecks:[ZaServerXFormView.getPOP3SSLEnabled,ZaItem.hasReadPermission],visibilityChangeEventSources:[ZaServer.A_Pop3SSLServerEnabled,ZaServer.A_Pop3ServerEnabled],labelLocation:_LEFT_,label:ZaMsg.LBL_POP_SSL_Port,onChange:ZaServerXFormView.onFormFieldChanged}
]}
]};
x.push(s)
}
if(p){
var n={
type:_ZATABCASE_,width:"100%",id:"server_form_volumes_tab",caseKey:p,visibilityChangeEventSources:[ZaModel.currentTab],visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaServerXFormView.getMailClientEnabled],numCols:1,items:[{
type:_ZA_TOP_GROUPER_,id:"server_form_volumes_group",width:"98%",numCols:1,colSizes:["auto"],label:ZaMsg.VM_VolumesGrpTitle,cssStyle:"margin:10px;padding-bottom:0;",items:[{
ref:ZaServer.A_Volumes,type:_DWT_LIST_,height:"200",width:"99%",preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:h,widgetClass:ZaServerVolumesListView,onSelection:ZaServerXFormView.volumeSelectionListener,valueChangeEventSources:[ZaServer.A_Volumes,ZaServer.A_CurrentMsgVolumeId,ZaServer.A_CurrentIndexVolumeId,ZaServer.A_RemovedVolumes]}
,{
type:_GROUP_,numCols:5,colSizes:["100px","auto","100px","auto","100px"],width:"350px",cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaServerXFormView.deleteButtonListener.call(this);",enableDisableChangeEventSources:[ZaServer.A2_volume_selection_cache],enableDisableChecks:[ZaServerXFormView.isDeleteVolumeEnabled]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaServerXFormView.editButtonListener.call(this);",enableDisableChangeEventSources:[ZaServer.A2_volume_selection_cache],enableDisableChecks:[ZaServerXFormView.isEditVolumeEnabled]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",onActivate:"ZaServerXFormView.addButtonListener.call(this);"}
]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.VM_CurrentVolumesGrpTitle,id:"server_form_current_vol_group",items:[{
type:_OSELECT1_,editable:false,valueChangeEventSources:[ZaServer.A_Volumes,ZaServer.A_RemovedVolumes],enableDisableChecks:[],visibilityChecks:[],ref:ZaServer.A_CurrentMsgVolumeId,choices:ZaServerXFormView.messageVolChoices,label:ZaMsg.LBL_VM_CurrentMessageVolume}
,{
type:_OSELECT1_,editable:false,valueChangeEventSources:[ZaServer.A_Volumes,ZaServer.A_RemovedVolumes],enableDisableChecks:[],visibilityChecks:[],ref:ZaServer.A_CurrentIndexVolumeId,choices:ZaServerXFormView.indexVolChoices,label:ZaMsg.LBL_VM_CurrentIndexVolume}
]}
]};
x.push(n);
var u={
type:_ZATABCASE_,caseKey:p,visibilityChangeEventSources:[ZaModel.currentTab],visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,[XForm.checkInstanceValue,ZaServer.A_showVolumes,false]],items:[{
type:_DWT_ALERT_,cssClass:"DwtTabTable",containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_MbxSvcNotInstalled,colSpan:"*"}
]};
x.push(u)
}
if(f){
var o={
type:_ZATABCASE_,id:"server_bind_ip_tab",caseKey:f,colSizes:["auto"],numCols:1,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.MSG_ConfigIpAddressBindings}
,{
type:_ZA_TOP_GROUPER_,colSizes:["275px","*"],numCols:2,label:ZaMsg.NAD_IpAddressBindingsForWebClient,items:[{
ref:ZaServer.A_zimbraMailBindAddress,type:_TEXTFIELD_,containerCssStyle:"padding-top:6px;padding-bottom:6px;",labelLocation:_LEFT_,label:ZaMsg.NAD_zimbraMailBindAddress,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraMailSSLBindAddress,type:_TEXTFIELD_,containerCssStyle:"padding-top:6px;padding-bottom:6px;",labelLocation:_LEFT_,label:ZaMsg.NAD_zimbraMailSSLBindAddress,onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaServer.A_zimbraMailSSLClientCertBindAddress,type:_TEXTFIELD_,containerCssStyle:"padding-top:6px;padding-bottom:6px;",labelLocation:_LEFT_,label:ZaMsg.NAD_zimbraMailSSLClientCertBindAddress,onChange:ZaServerXFormView.onFormFieldChanged}
]}
,{
type:_ZA_TOP_GROUPER_,colSizes:["275px","*"],numCols:2,label:ZaMsg.NAD_IpAddressBindingsForAdminConsole,items:[{
ref:ZaServer.A_zimbraAdminBindAddress,type:_TEXTFIELD_,containerCssStyle:"padding-top:6px;padding-bottom:6px;",labelLocation:_LEFT_,label:ZaMsg.NAD_zimbraAdminBindAddress,onChange:ZaServerXFormView.onFormFieldChanged}
]}
]};
x.push(o)
}
g.tableCssStyle="width:100%;position:static;overflow:auto;";
this.tabBarChoices=e;
g.items=[{
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:4,colSizes:["32px","*","80px","*"],items:[{
type:_AJX_IMAGE_,src:"Server_32",label:null,rowSpan:3}
,{
type:_OUTPUT_,ref:ZaServer.A_name,label:null,cssClass:"AdminTitle",visibilityChecks:[ZaItem.hasReadPermission],height:32,rowSpan:3}
,{
type:_OUTPUT_,ref:ZaServer.A_ServiceHostname,label:ZaMsg.NAD_ServiceHostname+":"}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var j=ZaItem.formatServerTime(this.getInstanceValue());
if(!j){
return ZaMsg.Server_Time_NA
}else{
return j
}}
,visibilityChecks:[ZaItem.hasReadPermission]}
]}
]}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,containerCssStyle:"padding-top:0;",choices:e,cssStyle:"display:none;",cssClass:"ZaTabBar",id:"xform_tabbar"}
,{
type:_SWITCH_,items:x}
]
};
ZaTabView.XFormModifiers.ZaServerXFormView.push(ZaServerXFormView.myXFormModifier);
ZaServerXFormView.prototype.getTabChoices=function(){
return this.tabBarChoices
};
ZaServerXFormView.showMtaServiceEnableRelatedNotice=function(o){
var t;
var e;
if(o){
t=ZaMsg.NAD_MTA_notice_related_statistics_tabs_enable;
e=DwtMessageDialog.WARNING_STYLE
}else{
t=ZaMsg.NAD_MTA_notice_related_statistics_tabs_disable;
e=DwtMessageDialog.INFO_STYLE
}
ZaApp.getInstance().dialogs.msgDialog.setMessage(t,e);
ZaApp.getInstance().dialogs.msgDialog.popup()
};
ZaServerXFormView.onMtaServiceChanged=function(o,t,e){
ZaServerXFormView.showMtaServiceEnableRelatedNotice(o);
e.parent.setDirty(true);
this.setInstanceValue(o);
return o
}
}
if(AjxPackage.define("zimbraAdmin.adminext.view.ZaAdminExtListView")){
ZaAdminExtListView=function(n){
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:n,className:o,posStyle:t,headerList:e,id:ZaId.TAB_AE_MANAGE}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaAdminExtListView.prototype=new ZaListView;
ZaAdminExtListView.prototype.constructor=ZaAdminExtListView;
ZaAdminExtListView.prototype.toString=function(){
return"ZaAdminExtListView"
};
ZaAdminExtListView.prototype.getTitle=function(){
return ZaMsg.AdminZimlets_view_title
};
ZaAdminExtListView.prototype.getTabIcon=function(){
return"AdminExtension"
};
ZaAdminExtListView.prototype._createItemHtml=function(o,t,r){
var c=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(o,e,DwtListView.TYPE_LIST_ITEM);
var m=0;
c[m++]="<table width='100%' cellspacing='0' cellpadding='0'>";
c[m++]="<tr>";
var n=this._headerList.length;
for(var l=0;
l<n;
l++){
var u=this._headerList[l]._field;
var s=this._getCellWidth(l,{}
);
if(u==ZaZimlet.A_name){
c[m++]="<td align='left' width="+s+">";
c[m++]=AjxStringUtil.htmlEncode(o[ZaZimlet.A_name]);
c[m++]="</td>"
}else{
if(u=="display"){
c[m++]="<td align='left' width="+s+">";
c[m++]=AjxStringUtil.htmlEncode(o.getDisplayName());
c[m++]="</td>"
}else{
if(u==ZaZimlet.A_zimbraZimletDescription){
c[m++]="<td align='left' width="+s+">";
c[m++]=AjxStringUtil.htmlEncode(o.getDescription());
c[m++]="</td>"
}else{
if(u==="spacer"){
c[m++]="<td align='left' width="+s+"></td>"
}else{
if(u==ZaZimlet.A_zimbraZimletVersion){
c[m++]="<td align='left' width="+s+">";
var d=o.attrs[ZaZimlet.A_zimbraZimletVersion];
if(d&&d.length>0){
var h=d.lastIndexOf("_");
if(h>-1){
d=d.substring(0,h)
}}
c[m++]=AjxStringUtil.htmlEncode(d);
c[m++]="</td>"
}}}}}}
c[m++]="</tr></table>";
e.innerHTML=c.join("");
return e
};
ZaAdminExtListView.prototype._getHeaderList=function(){
var e=new Array();
var t=1;
e[0]=new ZaListHeaderItem(ZaZimlet.A_name,ZaMsg.CLV_Name_col,null,250,t++,"name",true,true);
e[1]=new ZaListHeaderItem("display",ZaMsg.ALV_DspName_col,null,250,null,"display",true,true);
e[2]=new ZaListHeaderItem(ZaZimlet.A_zimbraZimletDescription,ZaMsg.DLV_Description_col,null,"auto",null,ZaZimlet.A_zimbraZimletDescription,true,true);
e[3]=new ZaListHeaderItem("spacer",null,null,"5px",null,null,false,false);
e[4]=new ZaListHeaderItem(ZaZimlet.A_zimbraZimletVersion,ZaMsg.CLV_Version_col,null,"80px",null,ZaZimlet.A_zimbraZimletVersion,true,true);
return e
}
}
if(AjxPackage.define("zimbraAdmin.zimlets.view.ZaZimletListView")){
ZaZimletListView=function(n){
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:n,className:o,posStyle:t,headerList:e,id:ZaId.TAB_ZIM_MANAGE}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaZimletListView.prototype=new ZaListView;
ZaZimletListView.prototype.constructor=ZaZimletListView;
ZaZimletListView.prototype.toString=function(){
return"ZaZimletListView"
};
ZaZimletListView.prototype.getTitle=function(){
return ZaMsg.Zimlets_view_title
};
ZaZimletListView.prototype.getTabIcon=function(){
return"zimlet"
};
ZaZimletListView.prototype._createItemHtml=function(o,t,r){
var c=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(o,e,DwtListView.TYPE_LIST_ITEM);
var f=0;
c[f++]="<table width='100%' cellspacing='0' cellpadding='0'>";
c[f++]="<tr>";
var n=this._headerList.length;
for(var l=0;
l<n;
l++){
var s=this._getCellWidth(l,{}
);
var m=this._headerList[l]._field;
if(m==ZaZimlet.A_name){
c[f++]="<td align='left' width="+s+">";
c[f++]=AjxStringUtil.htmlEncode(o[ZaZimlet.A_name]);
c[f++]="</td>"
}else{
if(m=="display"){
c[f++]="<td align='left' width="+s+">";
c[f++]=AjxStringUtil.htmlEncode(o.getDisplayName());
c[f++]="</td>"
}else{
if(m==ZaZimlet.A_zimbraZimletDescription){
c[f++]="<td align='left' width="+s+">";
var d=ZaZimletListView.__processMessage(o[ZaZimlet.A_name],o.attrs[ZaZimlet.A_zimbraZimletDescription]);
c[f++]=AjxStringUtil.htmlEncode(d);
c[f++]="</td>"
}else{
if(m==="spacer"){
c[f++]="<td align='left' width="+s+"></td>"
}else{
if(m==ZaZimlet.A_zimbraZimletVersion){
c[f++]="<td align='left' width="+s+">";
var u=o.attrs[ZaZimlet.A_zimbraZimletVersion];
if(u&&u.length>0){
var h=u.lastIndexOf("_");
if(h>-1){
u=u.substring(0,h)
}}
c[f++]=AjxStringUtil.htmlEncode(u);
c[f++]="</td>"
}else{
if(m==ZaZimlet.A_zimbraZimletEnabled){
c[f++]="<td align='left' width="+s+">";
c[f++]=(o.attrs[ZaZimlet.A_zimbraZimletEnabled]=="TRUE")?AjxStringUtil.htmlEncode(ZaMsg.NAD_Enabled):AjxStringUtil.htmlEncode(ZaMsg.NAD_Disabled);
c[f++]="</td>"
}}}}}}}
c[f++]="</tr></table>";
e.innerHTML=c.join("");
return e
};
ZaZimletListView.prototype._getHeaderList=function(){
var e=new Array();
var t=1;
e[0]=new ZaListHeaderItem(ZaZimlet.A_name,ZaMsg.CLV_Name_col,null,"200px",t++,"name",true,true);
e[1]=new ZaListHeaderItem("display",ZaMsg.ALV_DspName_col,null,"200px",null,"display",true,true);
e[2]=new ZaListHeaderItem(ZaZimlet.A_zimbraZimletDescription,ZaMsg.DLV_Description_col,null,"auto",null,ZaZimlet.A_zimbraZimletDescription,true,true);
e[3]=new ZaListHeaderItem("spacer",null,null,"5px",null,null,false,false);
e[4]=new ZaListHeaderItem(ZaZimlet.A_zimbraZimletVersion,ZaMsg.CLV_Version_col,null,"80px",null,ZaZimlet.A_zimbraZimletVersion,true,true);
e[5]=new ZaListHeaderItem(ZaZimlet.A_zimbraZimletEnabled,ZaMsg.ALV_Status_col,null,"120px",null,ZaZimlet.A_zimbraZimletEnabled,true,true);
return e
};
ZaZimletListView.__RE_MSG=/\$\{msg\.(.*?)\}/g;
ZaZimletListView.__processMessage=function(e,t){
return(t||"").replace(ZaZimletListView.__RE_MSG,function(n,o){
var s=window[e];
return(s&&s[o])||n
}
)
}
}
if(AjxPackage.define("zimbraAdmin.zimlets.view.ZaZimletXFormView")){
ZaZimletXFormView=function(e){
ZaTabView.call(this,{
parent:e,iKeyName:"ZaZimletXFormView",contextId:ZaId.TAB_ZIM_EDIT}
);
this.TAB_INDEX=0;
this.initForm(ZaZimlet.myXModel,this.getMyXForm())
};
ZaZimletXFormView.prototype=new ZaTabView();
ZaZimletXFormView.prototype.constructor=ZaZimletXFormView;
ZaTabView.XFormModifiers.ZaZimletXFormView=new Array();
ZaZimletXFormView.prototype.setObject=function(t){
this._containedObject=new Object();
this._containedObject.attrs=new Object();
for(var e in t.attrs){
if(t.attrs[e] instanceof Array){
this._containedObject.attrs[e]=new Array();
for(var o in t.attrs[e]){
this._containedObject.attrs[e][o]=t.attrs[e][o]
}}else{
this._containedObject.attrs[e]=t.attrs[e]
}}
this._containedObject.name=t.name;
this._containedObject.type=t.type;
if(t.id){
this._containedObject.id=t.id
}
if(!t[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=t[ZaModel.currentTab]
}
this._localXForm.setInstance(this._containedObject)
};
ZaZimletXFormView.myXFormModifier=function(t){
this.tabChoices=[];
var e=[];
t.tableCssStyle="width:100%;";
t.items=[{
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:4,colSizes:["90px","350px","100px","200px"],items:[{
type:_OUTPUT_,ref:"name",label:ZaMsg.NAD_zimletName}
,{
type:_OUTPUT_,ref:ZaZimlet.A_zimbraZimletEnabled,label:ZaMsg.NAD_zimletStatus,choices:ZaModel.BOOLEAN_CHOICES}
,{
type:_OUTPUT_,ref:ZaZimlet.A_zimbraZimletDescription,label:ZaMsg.NAD_Description,colSpan:"*",getDisplayValue:function(s){
var n=this.getInstanceValue(ZaZimlet.A_name);
var o=ZaZimletListView.__processMessage(n,s);
return o
}}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var o=ZaItem.formatServerTime(this.getInstanceValue());
if(!o){
return ZaMsg.Server_Time_NA
}else{
return o
}}
,visibilityChecks:[ZaItem.hasReadPermission]}
]}
],cssStyle:"padding-top:5px; padding-bottom:5px"}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,choices:this.tabChoices,cssClass:"ZaTabBar",cssStyle:"display:none;",id:"xform_tabbar"}
,{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:e}
]
};
ZaTabView.XFormModifiers.ZaZimletXFormView.push(ZaZimletXFormView.myXFormModifier);
ZaZimletXFormView.prototype.getTabChoices=function(){
return this.tabChoices
}
}
if(AjxPackage.define("zimbraAdmin.zimlets.view.ZaZimletDeployXWizard")){
ZaZimletDeployXWizard=function(e){
ZaXWizardDialog.call(this,e,null,ZaMsg.ZMLT_DeployZimletWizardTitle,"550px","300px","ZaZimletDeployXWizard",null,ZaId.DLG_ZIM_DEPLOY);
this._app=ZaApp.getInstance();
this.stepChoices=[{
label:ZaMsg.ZMLT_SelectZimletStepTitle,value:1}
,{
label:ZaMsg.ZMLT_DeployZimletStepTitle,value:2}
];
this.currentPageNum=0;
this.initForm(ZaZimlet.myXModel,this.getMyXForm());
this._helpURL=ZaZimletDeployXWizard.helpURL;
this.pollInterval=500;
this.pollAction=new AjxTimedAction(this,this.getDeploymentStatus);
this._pollHandler=null
};
ZaZimletDeployXWizard.helpURL=location.pathname+ZaUtil.HELP_URL+"zimlets/setting_up_zimlets_in_zcs.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaZimletDeployXWizard.prototype=new ZaXWizardDialog;
ZaZimletDeployXWizard.prototype.constructor=ZaZimletDeployXWizard;
ZaZimletDeployXWizard.prototype.miniType=2;
ZaXDialog.XFormModifiers.ZaZimletDeployXWizard=new Array();
ZaZimletDeployXWizard.ZimletUploadFormId=null;
ZaZimletDeployXWizard.ZimletUploadAttachmentInputId=null;
ZaZimletDeployXWizard.prototype.getUploadFormHtml=function(){
ZaZimletDeployXWizard.ZimletUploadFormId=Dwt.getNextId();
ZaZimletDeployXWizard.ZimletUploadAttachmentInputId=Dwt.getNextId();
var o=appContextPath+"/../service/upload";
var t=new Array();
var e=0;
t[e++]="<div style='overflow:hidden'><form method='POST' action='";
t[e++]=o;
t[e++]="' id='";
t[e++]=ZaZimletDeployXWizard.ZimletUploadFormId;
t[e++]="' enctype='multipart/form-data'><input id='";
t[e++]=ZaZimletDeployXWizard.ZimletUploadAttachmentInputId;
t[e++]="' type=file  name='zimletFile' size='50' onChange=\"ZaZimletDeployXWizard.changeDeployBtnState(this,event||window.event,'"+this.getHTMLElId()+"')\"></input>";
t[e++]="</form></div>";
return t.join("")
};
ZaZimletDeployXWizard.changeDeployBtnState=function(n,e,o){
var t=DwtControl.ALL_BY_ID[o];
if(t){
if(n.value){
t.getButton(DwtWizardDialog.NEXT_BUTTON).setEnabled(true)
}else{
t.getButton(DwtWizardDialog.NEXT_BUTTON).setEnabled(false)
}}};
ZaZimletDeployXWizard.prototype.handleXFormChange=function(){
if(this._containedObject[ZaModel.currentStep]==2){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}};
ZaZimletDeployXWizard.prototype.setObject=function(e){
this._containedObject=e;
this._containedObject[ZaModel.currentStep]=e[ZaModel.currentStep]||1;
this._containedObject[ZaZimlet.A_attachmentId]=e[ZaZimlet.A_attachmentId]||null;
this._localXForm.setInstance(this._containedObject)
};
ZaZimletDeployXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setText(ZaMsg.ZMLT_ReselectZimlet);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setText(ZaMsg.ZMLT_DeployZimlet);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
};
ZaZimletDeployXWizard.prototype.getUploadFrameId=function(){
if(!this._uploadManagerIframeId){
var o=Dwt.getNextId();
var e=["<iframe name='",o,"' id='",o,"' src='",(AjxEnv.isIE&&location.protocol=="https:")?appContextPath+"/public/blank.html":'javascript:""',"' style='position: absolute; top: 0; left: 0; visibility: hidden'></iframe>"];
var t=document.createElement("div");
t.innerHTML=e.join("");
document.body.appendChild(t.firstChild);
this._uploadManagerIframeId=o
}
return this._uploadManagerIframeId
};
ZaZimletDeployXWizard.prototype.getUploadManager=function(){
return this._uploadManager
};
ZaZimletDeployXWizard.prototype.setUploadManager=function(e){
this._uploadManager=e
};
ZaZimletDeployXWizard.prototype.goNext=function(){
var o=document.getElementById(ZaZimletDeployXWizard.ZimletUploadAttachmentInputId);
if(o&&o.value){
var t=new AjxCallback(this,this.uploadCallback);
try{
ZaUploader.upload.call(this,t,[ZaZimletDeployXWizard.ZimletUploadAttachmentInputId],ZaZimletDeployXWizard.ZimletUploadFormId)
}
catch(e){
ZaApp.getInstance().getCurrentController().popupErrorDialog((e&&e.msg)?e.msg:ZaMsg.ZMLT_zimletFileNameError)
}
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true);
ZaXWizardDialog.prototype.goNext.call(this)
}else{
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ZMLT_zimletFileNameError)
}};
ZaZimletDeployXWizard.prototype.goPrev=function(){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
var e=this._localXForm.getInstance();
e[ZaZimlet.A_attachmentId]=null;
e[ZaZimlet.A_uploadStatus]=null;
e[ZaZimlet.A_deployStatus]=null;
e[ZaZimlet.A_uploadStatusMsg]=null;
e[ZaZimlet.A_deployStatusMsg]=null;
this._localXForm.setInstance(e);
ZaXWizardDialog.prototype.goPrev.call(this)
};
ZaZimletDeployXWizard.prototype.popdown=function(){
if(this._pollHandler){
AjxTimedAction.cancelAction(this._pollHandler)
}
ZaXWizardDialog.prototype.popdown.call(this)
};
ZaZimletDeployXWizard.prototype.uploadCallback=function(t,o){
try{
if(o&&o[0]&&o[0].aid&&t==AjxPost.SC_OK){
var e=this._localXForm.getInstance();
var s=null;
e[ZaZimlet.A_attachmentId]=o[0].aid;
e[ZaZimlet.A_uploadStatus]=ZaZimlet.STATUS_SUCCEEDED;
s=AjxMessageFormat.format(ZaMsg.ZMLT_UploadZimletSuccessMsg);
ZaZimlet.deploy({
action:ZaZimlet.ACTION_DEPLOY_ALL,attId:o[0].aid,flushCache:e[ZaZimlet.A_flushCache]}
,new AjxCallback(this,this.deployZimletClbck))
}else{
e[ZaZimlet.A_uploadStatus]=ZaZimlet.STATUS_FAILED;
s=AjxMessageFormat.format(ZaMsg.ZMLT_UploadZimletErrorMsg,[t])
}
e[ZaZimlet.A_uploadStatusMsg]=s+("<br/>")
}
catch(n){
ZaApp.getInstance().getCurrentController()._handleException(n,"ZaZimletDeployXWizard.uploadCallback")
}
this._localXForm.setInstance(e)
};
ZaZimletDeployXWizard.prototype.getDeploymentStatus=function(){
try{
var e=this._localXForm.getInstance();
ZaZimlet.deploy({
action:ZaZimlet.ACTION_DEPLOY_STATUS,attId:e[ZaZimlet.A_attachmentId]}
,new AjxCallback(this,this.deployZimletClbck))
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaZimletDeployXWizard.getDeploymentStatus")
}};
ZaZimletDeployXWizard.prototype.deployZimletClbck=function(s){
var m=this._localXForm.getInstance();
try{
if(!s){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaZimletDeployXWizard.deployZimletClbck"))
}
if(s.isException()){
throw (s.getException())
}else{
var l=true;
var u=false;
var r=s.getResponse().Body.DeployZimletResponse;
var n=[];
var e=r[ZaZimlet.A_progress];
if(e){
if(!(e instanceof Array)){
e=[e]
}
var o=e.length;
for(var c=0;
c<o;
c++){
var t=e[c].server;
var h=e[c].status;
if(h==ZaZimlet.STATUS_PENDING){
l=false;
n.push(AjxMessageFormat.format(ZaMsg.ZMLT_DeployProgres,[t,ZaMsg.ZMLT_StatusPending]))
}else{
if(h==ZaZimlet.STATUS_FAILED){
u=true;
n.push(AjxMessageFormat.format(ZaMsg.ZMLT_DeployProgresFail,[t,e[c].error]))
}else{
if(h==ZaZimlet.STATUS_SUCCEEDED){
n.push(AjxMessageFormat.format(ZaMsg.ZMLT_DeployProgres,[t,ZaMsg.ZMLT_StatusSuccess]))
}}}
n.push("<br/>")
}
if(u){
m[ZaZimlet.A_deployStatus]=ZaZimlet.STATUS_FAILED
}else{
if(l){
m[ZaZimlet.A_deployStatus]=ZaZimlet.STATUS_SUCCEEDED;
n=[ZaMsg.ZMLT_DeployZimletComplete]
}else{
m[ZaZimlet.A_deployStatus]=ZaZimlet.STATUS_PENDING
}}
m[ZaZimlet.A_deployStatusMsg]=n.join("<br/>")+("<br/>");
if(!l){
this._pollHandler=AjxTimedAction.scheduleAction(this.pollAction,this.pollInterval)
}else{
AjxTimedAction.cancelAction(this._pollHandler);
ZaApp.getInstance().getCurrentController().fireCreationEvent(new ZaZimlet())
}}}}
catch(d){
ZaApp.getInstance().getCurrentController()._handleException(d,"ZaZimletDeployXWizard.deployZimletClbck")
}
this._localXForm.setInstance(m)
};
ZaZimletDeployXWizard.canShowDeployStatusMsg=function(e){
var t=this.getInstanceValue(ZaZimlet.A_uploadStatus);
if(t!=ZaZimlet.STATUS_SUCCEEDED){
return false
}
var o=this.getInstanceValue(ZaZimlet.A_deployStatus);
if(e){
return(o!=ZaZimlet.STATUS_FAILED)
}else{
return(o==ZaZimlet.STATUS_FAILED)
}};
ZaZimletDeployXWizard.myXFormModifier=function(o){
var t={
type:_CASE_,numCols:2,caseKey:1,align:_LEFT_,valign:_TOP_,width:"520px",cssStyle:"overflow:hidden",items:[{
type:_OUTPUT_,value:ZaMsg.ZMLT_uploadTitle,align:_LEFT_,colSpan:2}
,{
type:_OUTPUT_,value:this.getUploadFormHtml(),colSpan:2,width:"480px"}
,{
type:_SPACER_,colSpan:2}
,{
ref:ZaZimlet.A_flushCache,type:_CHECKBOX_,align:_RIGHT_,subLabel:"",label:ZaMsg.ZMLT_flushCache,labelLocation:_RIGHT_,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_SPACER_,colSpan:2}
]};
var e={
type:_CASE_,numCols:1,caseKey:2,width:"400px",items:[{
type:_GROUP_,numCols:1,items:[{
type:_DWT_ALERT_,style:DwtAlert.CRITICAL,iconVisible:true,content:null,width:"400px",ref:ZaZimlet.A_uploadStatusMsg,visibilityChecks:[[XForm.checkInstanceValue,ZaZimlet.A_uploadStatus,ZaZimlet.STATUS_FAILED]],visibilityChangeEventSources:[ZaZimlet.A_uploadStatus],align:_CENTER_}
,{
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,iconVisible:true,content:null,width:"400px",ref:ZaZimlet.A_uploadStatusMsg,visibilityChecks:[[XForm.checkInstanceValueNot,ZaZimlet.A_uploadStatus,ZaZimlet.STATUS_FAILED]],visibilityChangeEventSources:[ZaZimlet.A_uploadStatus],align:_CENTER_}
,{
type:_DWT_ALERT_,style:DwtAlert.CRITICAL,iconVisible:true,content:null,width:"400px",ref:ZaZimlet.A_deployStatusMsg,visibilityChecks:[[ZaZimletDeployXWizard.canShowDeployStatusMsg,false]],visibilityChangeEventSources:[ZaZimlet.A_deployStatus],align:_CENTER_}
,{
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,iconVisible:true,content:null,width:"400px",ref:ZaZimlet.A_deployStatusMsg,visibilityChecks:[[ZaZimletDeployXWizard.canShowDeployStatusMsg,true]],visibilityChangeEventSources:[ZaZimlet.A_deployStatus],align:_CENTER_}
]}
]};
o.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,ref:ZaModel.currentStep,choices:this.stepChoices,cssStyle:"white-space: normal"}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:450,align:_LEFT_,valign:_TOP_,items:[t,e]}
]
};
ZaXDialog.XFormModifiers.ZaZimletDeployXWizard.push(ZaZimletDeployXWizard.myXFormModifier)
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaDomainListView")){
ZaDomainListView=function(s,n){
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
this._listType=n;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:s,className:o,posStyle:t,headerList:e,id:ZaId.TAB_DOMAIN_MANAGE,scrollLoading:true}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaDomainListView.prototype=new ZaListView;
ZaDomainListView.prototype.constructor=ZaDomainListView;
ZaDomainListView.prototype.toString=function(){
return"ZaDomainListView"
};
ZaDomainListView.prototype.getTitle=function(){
return ZaMsg.Domain_view_title
};
ZaDomainListView.prototype.getTabIcon=function(){
return"Domain"
};
ZaDomainListView.prototype._createItemHtml=function(h,t,r){
var c=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(h,e,DwtListView.TYPE_LIST_ITEM);
var f=0;
c[f++]="<table width='100%'>";
c[f++]="<tr>";
var o=this._headerList.length;
var u=Dwt.getNextId();
var s=this._listType;
for(var l=0;
l<o;
l++){
var m=this._headerList[l]._field;
var n=this._getCellWidth(l,{}
);
if(m=="type"){
var d="Domain";
var p=h.attrs[ZaDomain.A_domainType];
if(p==="alias"){
d+="Alias"
}
c[f++]='<td id="'+s+"_data_type_"+u+'" width='+this._headerList[l]._width+">"+AjxImg.getImageHtml(d)+"</td>"
}else{
if(m==ZaDomain.A_domainName){
c[f++]='<td id="'+s+"_data_name_"+u+"\" align='left' width="+n+">";
c[f++]=AjxStringUtil.htmlEncode(h.name);
c[f++]="</td>"
}else{
if(m==ZaDomain.A_description){
c[f++]='<td id="'+s+"_data_desc_"+u+"\" align='left' width="+n+">";
c[f++]=AjxStringUtil.htmlEncode(ZaItem.getDescriptionValue(h.attrs[ZaDomain.A_description]));
c[f++]="</td>"
}else{
if(m==ZaDomain.A_zimbraDomainStatus){
c[f++]='<td id="'+s+"_data_status_"+u+"\" align='left' width="+n+">";
c[f++]=ZaDomain._domainStatus(h.attrs[ZaDomain.A_zimbraDomainStatus]);
c[f++]="</td>"
}else{
if(m==ZaDomain.A_domainType){
c[f++]='<td id="'+s+"_data_domain_type_"+u+"\" align='left' width="+n+">";
c[f++]=AjxStringUtil.htmlEncode(h.attrs[ZaDomain.A_domainType]);
c[f++]="</td>"
}}}}}}
c[f++]="</tr></table>";
e.innerHTML=c.join("");
return e
};
ZaDomainListView.prototype._getHeaderList=function(){
var e=new Array();
var o=1;
var t=0;
e[t++]=new ZaListHeaderItem("type",null,null,"22px",null,"objectClass",false,true);
e[t++]=new ZaListHeaderItem(ZaDomain.A_domainName,ZaMsg.DLV_Name_col,null,"250px",o++,ZaDomain.A_domainName,true,true);
e[t++]=new ZaListHeaderItem(ZaDomain.A_domainType,ZaMsg.DLV_Type_col,null,"100px",null,ZaDomain.A_domainType,true,true);
e[t++]=new ZaListHeaderItem(ZaDomain.A_zimbraDomainStatus,ZaMsg.DLV_Status_col,null,"100px",null,ZaDomain.A_zimbraDomainStatus,true,true);
e[t++]=new ZaListHeaderItem(ZaDomain.A_description,ZaMsg.DLV_Description_col,null,"auto",null,null,true,true);
return e
}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaDomainXFormView")){
ZaDomainXFormView=function(e,t){
ZaTabView.call(this,{
parent:e,iKeyName:"ZaDomainXFormView",contextId:ZaId.TAB_DOMAIN_EDIT}
);
this.GALModes=[{
label:ZaMsg.GALMode_internal,value:ZaDomain.GAL_Mode_internal}
,{
label:ZaMsg.GALMode_external,value:ZaDomain.GAL_Mode_external}
,{
label:ZaMsg.GALMode_both,value:ZaDomain.GAL_Mode_both}
];
this.GALServerTypes=[{
label:ZaMsg.GALServerType_ldap,value:ZaDomain.GAL_ServerType_ldap}
,{
label:ZaMsg.GALServerType_ad,value:ZaDomain.GAL_ServerType_ad}
];
this.AuthMechs=[{
label:ZaMsg.AuthMech_zimbra,value:ZaDomain.AuthMech_zimbra}
,{
label:ZaMsg.AuthMech_ldap,value:ZaDomain.AuthMech_ldap}
,{
label:ZaMsg.AuthMech_ad,value:ZaDomain.AuthMech_ad}
];
this.cosChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
this.catchAllChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
this.TAB_INDEX=0;
this.initForm(ZaDomain.myXModel,this.getMyXForm(t),null)
};
ZaDomainXFormView.prototype=new ZaTabView();
ZaDomainXFormView.prototype.constructor=ZaDomainXFormView;
ZaTabView.XFormModifiers.ZaDomainXFormView=new Array();
ZaDomainXFormView.zimletChoices=new XFormChoices([],XFormChoices.SIMPLE_LIST);
ZaTabView.XFormSetObjectMethods.ZaDomainXFormView=new Array();
ZaDomainXFormView.prototype.setObject=function(t){
ZaAccount.prototype.manageSpecialAttrs.call(t);
this._containedObject=new ZaDomain();
this._containedObject.attrs=new Object();
if(t.rights){
this._containedObject.rights=t.rights
}
if(t.setAttrs){
this._containedObject.setAttrs=t.setAttrs
}
if(t.getAttrs){
this._containedObject.getAttrs=t.getAttrs
}
if(t._defaultValues){
this._containedObject._defaultValues=t._defaultValues
}
this._containedObject.name=t.name;
this._containedObject.id=t.id;
this._containedObject.type=t.type;
for(var b in t.attrs){
var h=this._localXForm.getModel().getItem(b);
if((h!=null&&h.type==_LIST_)||(t.attrs[b]!=null&&t.attrs[b] instanceof Array)){
this._containedObject.attrs[b]=ZaItem.deepCloneListItem(t.attrs[b])
}else{
this._containedObject.attrs[b]=t.attrs[b]
}}
if(!this._containedObject.attrs[ZaDomain.A_zimbraDomainStatus]){
this._containedObject.attrs[ZaDomain.A_zimbraDomainStatus]=ZaDomain.DOMAIN_STATUS_ACTIVE
}
this._containedObject[ZaDomain.A_AuthUseBindPassword]=t[ZaDomain.A_AuthUseBindPassword];
if(!t[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=t[ZaModel.currentTab]
}
this._containedObject[ZaDomain.A_NotebookTemplateFolder]=t[ZaDomain.A_NotebookTemplateFolder];
this._containedObject[ZaDomain.A_NotebookTemplateDir]=t[ZaDomain.A_NotebookTemplateDir];
this._containedObject[ZaDomain.A_allNotebookACLS]=[];
if(t[ZaDomain.A_allNotebookACLS]){
this._containedObject[ZaDomain.A_allNotebookACLS]._version=t[ZaDomain.A_allNotebookACLS]._version?t[ZaDomain.A_allNotebookACLS]._version:1;
var f=t[ZaDomain.A_allNotebookACLS].length;
for(var p=0;
p<f;
p++){
var g=t[ZaDomain.A_allNotebookACLS][p];
var n={};
n.gt=g.gt;
n.name=g.name;
n.zid=g.zid;
n.acl={
r:0,w:0,i:0,d:0,a:0,x:0};
for(var b in g.acl){
n.acl[b]=g.acl[b]
}
this._containedObject[ZaDomain.A_allNotebookACLS][p]=n
}}
if(ZaTabView.isTAB_ENABLED(t,ZaDomainXFormView.ZIMLETS_TAB_ATTRS,ZaDomainXFormView.ZIMLETS_TAB_RIGHTS)){
var r=ZaZimlet.getAll(ZaZimlet.EXCLUDE_EXTENSIONS);
if(r==null){
r=[]
}
if(r instanceof ZaItemList||r instanceof AjxVector){
r=r.getArray()
}
var f=r.length;
var l=[];
for(var p=0;
p<f;
p++){
var u=r[p];
l.push(u.name)
}
ZaDomainXFormView.zimletChoices.setChoices(l);
ZaDomainXFormView.zimletChoices.dirtyChoices()
}
var o=this._containedObject.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled]?this._containedObject.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled]:this._containedObject._defaultValues.attrs[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled];
if(o&&o=="TRUE"){
this._containedObject[ZaAccount.A_zimbraMailCatchAllAddress]=t[ZaAccount.A_zimbraMailCatchAllAddress];
this.catchAllChoices.setChoices([t[ZaAccount.A_zimbraMailCatchAllAddress]]);
this.catchAllChoices.dirtyChoices()
}
if(this._containedObject.attrs[ZaDomain.A_domainDefaultCOSId]&&this._containedObject.getAttrs[ZaDomain.A_domainDefaultCOSId]){
var e=ZaCos.getCosById(this._containedObject.attrs[ZaDomain.A_domainDefaultCOSId]);
this.cosChoices.setChoices([e]);
this.cosChoices.dirtyChoices()
}
this._containedObject[ZaDomain.A2_gal_sync_accounts]=[];
if(t[ZaDomain.A2_gal_sync_accounts]&&t[ZaDomain.A2_gal_sync_accounts][0]){
this._containedObject[ZaDomain.A2_gal_sync_accounts][0]=new ZaAccount();
this._containedObject[ZaDomain.A2_gal_sync_accounts][0].name=t[ZaDomain.A2_gal_sync_accounts][0].name;
this._containedObject[ZaDomain.A2_gal_sync_accounts][0].id=t[ZaDomain.A2_gal_sync_accounts][0].id;
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_datasources]=t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_datasources];
this._containedObject[ZaDomain.A2_gal_sync_accounts][0].attrs[ZaDomain.A_mailHost]=t[ZaDomain.A2_gal_sync_accounts][0].attrs[ZaDomain.A_mailHost];
if(t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds]){
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds]=new ZaDataSource();
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs=[];
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].name=t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].name;
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].id=t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].id;
for(var b in t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs){
var h=this._localXForm.getModel().getItem(b);
if(t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[b]!=null&&t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[b] instanceof Array){
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[b]=ZaItem.deepCloneListItem(t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[b])
}else{
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[b]=t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_zimbra_ds].attrs[b]
}}}
if(t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds]){
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds]=new ZaDataSource();
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].name=t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].name;
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].id=t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].id;
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs=[];
for(var b in t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs){
var h=this._localXForm.getModel().getItem(b);
if(t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[b]!=null&&t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[b] instanceof Array){
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[b]=ZaItem.deepCloneListItem(t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[b])
}else{
this._containedObject[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[b]=t[ZaDomain.A2_gal_sync_accounts][0][ZaAccount.A2_ldap_ds].attrs[b]
}}}}
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode]){
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode] instanceof Array){
for(var c=0;
c<this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode].length;
c++){
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode][c]=="EAGER"){
this._containedObject[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode][c]=="LAZY"){
this._containedObject[ZaDomain.A2_zimbraAutoProvModeLAZYEnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode][c]=="MANUAL"){
this._containedObject[ZaDomain.A2_zimbraAutoProvModeMANUALEnabled]="TRUE"
}}}}}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode]=="EAGER"){
this._containedObject[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode]=="LAZY"){
this._containedObject[ZaDomain.A2_zimbraAutoProvModeLAZYEnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvMode]=="MANUAL"){
this._containedObject[ZaDomain.A2_zimbraAutoProvModeMANUALEnabled]="TRUE"
}}}}}
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech]){
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech] instanceof Array){
for(var c=0;
c<this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech].length;
c++){
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech][c]=="LDAP"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech][c]=="PREAUTH"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech][c]=="KRB5"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech][c]=="SPNEGO"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled]="TRUE"
}}}}}}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="LDAP"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="PREAUTH"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="KRB5"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled]="TRUE"
}else{
if(this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="SPNEGO"){
this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled]="TRUE"
}}}}}}
this._containedObject[ZaDomain.A2_zimbraAutoProvServerList]=ZaApp.getInstance().getServerList(true).getArray();
this._containedObject[ZaDomain.A2_zimbraAutoProvSelectedServerList]=new AjxVector();
for(var p=0;
p<this._containedObject[ZaDomain.A2_zimbraAutoProvServerList].length;
p++){
var d=this._containedObject[ZaDomain.A2_zimbraAutoProvServerList][p];
var w=d.attrs[ZaServer.A_zimbraAutoProvScheduledDomains];
for(var m=0;
w&&m<w.length;
m++){
if(w[m]==this._containedObject.name){
this._containedObject[ZaDomain.A2_zimbraAutoProvSelectedServerList].add(d.name);
d.checked=true
}}}
var v=new Array();
v._version=1;
this._containedObject[ZaDomain.A2_domain_account_quota]=v;
if(ZaTabView.XFormSetObjectMethods.ZaDomainXFormView){
var y=ZaTabView.XFormSetObjectMethods.ZaDomainXFormView;
var f=y.length;
var s=this._containedObject;
for(var p=0;
p<f;
p++){
if(typeof(y[p])=="function"){
s=y[p].call(this,s,t)
}}
this._containedObject=s
}
this._localXForm.setInstance(this._containedObject)
};
ZaDomainXFormView.isCatchAllEnabled=function(){
return(this.getInstanceValue(ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled)=="TRUE")
};
ZaDomainXFormView.aclSelectionListener=function(o){
var t=this.getInstance();
var e=this.widget.getSelection();
if(e&&e.length){
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_acl_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_acl_selection_cache,null)
}
if(o.detail==DwtListView.ITEM_DBL_CLICKED){
ZaDomainXFormView.editButtonListener.call(this)
}};
ZaDomainXFormView.isDeleteAclEnabled=function(){
var n=true;
if(!AjxUtil.isEmpty(this.getInstanceValue(ZaDomain.A2_acl_selection_cache))){
var e=this.getInstanceValue(ZaDomain.A2_acl_selection_cache);
var o=e.length;
for(var t=0;
t<o;
t++){
if(e[t].gt==ZaDomain.A_NotebookPublicACLs||e[t].gt==ZaDomain.A_NotebookAllACLs||e[t].gt==ZaDomain.A_NotebookGuestACLs){
n=false;
break
}}}else{
n=false
}
return n
};
ZaDomainXFormView.isEditAclEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDomain.A2_acl_selection_cache))&&this.getInstanceValue(ZaDomain.A2_acl_selection_cache).length==1)
};
ZaDomainXFormView.hasACEName=function(){
return(this.getInstanceValue(ZaDomain.A_domainName)!=this.getInstanceValue("name"))
};
ZaDomainXFormView.resetAllColorThemes=function(){
var e=this.getForm();
this.setInstanceValue(null,ZaDomain.A_zimbraSkinForegroundColor);
this.setInstanceValue(null,ZaDomain.A_zimbraSkinBackgroundColor);
this.setInstanceValue(null,ZaDomain.A_zimbraSkinSecondaryColor);
this.setInstanceValue(null,ZaDomain.A_zimbraSkinSelectionColor);
e.parent.setDirty(true);
e.refresh()
};
ZaDomainXFormView.isDomainModeNotInternal=function(){
return(this.getInstanceValue(ZaDomain.A_zimbraGalMode)!=ZaDomain.GAL_Mode_internal)
};
ZaDomainXFormView.addButtonListener=function(){
var t=this.getForm().parent;
if(!t.addAclDlg){
t.addAclDlg=new ZaAddDomainAclXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px");
t.addAclDlg.registerCallback(DwtDialog.OK_BUTTON,ZaDomainXFormView.addAcl,this.getForm(),null)
}
var e={};
e.gt=ZaDomain.A_NotebookUserACLs;
e.name="";
e.acl={
r:0,w:0,i:0,d:0,a:0,x:0};
t.addAclDlg.setObject(e);
t.addAclDlg.popup()
};
ZaDomainXFormView.modifyAclCallback=function(h,r){
try{
if(h.busyId){
ZaApp.getInstance().getAppCtxt().getShell().setBusy(false,h.busyId)
}
if(!r&&!ZaApp.getInstance().getCurrentController()._currentRequest.cancelled){
throw (new AjxException(ZaMsg.ERROR_EMPTY_RESPONSE_ARG,AjxException.UNKNOWN,"ZaDomainController.prototype.modifyAclCallback"))
}else{
if(r.isException&&r.isException()){
throw (r.getException())
}else{
if(r.getResponse().Body&&r.getResponse().Body.BatchResponse&&r.getResponse().Body.BatchResponse.Fault){
var s=r.getResponse().Body.BatchResponse.Fault;
if(s instanceof Array){
s=s[0]
}
if(s){
var t=ZmCsfeCommand.faultToEx(s);
throw (t)
}}}}
var n=new ZaDomain();
var e=this.getInstance();
n.attrs[ZaDomain.A_zimbraNotebookAccount]=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_zimbraNotebookAccount);
n.attrs[ZaDomain.A_zimbraDomainStatus]=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_zimbraDomainStatus);
n.id=this.getInstance().id;
n.attrs[ZaItem.A_zimbraId]=this.getModel().getInstanceValue(this.getInstance(),ZaItem.A_zimbraId);
n.name=this.getInstance().name;
ZaDomain.loadNotebookACLs.call(n);
var o=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_allNotebookACLS);
if(o){
n[ZaDomain.A_allNotebookACLS]._version=o._version+1
}else{
n[ZaDomain.A_allNotebookACLS]._version=1
}
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A_allNotebookACLS,n[ZaDomain.A_allNotebookACLS])
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaDomainXFormView.modifyAclCallback")
}};
ZaDomainXFormView.addAcl=function(){
if(this.parent.addAclDlg){
this.parent.addAclDlg.popdown();
var n=this.parent.addAclDlg.getObject();
var e=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_zimbraNotebookAccount);
var o=AjxSoapDoc.create("BatchRequest","urn:zimbra");
o.setMethodAttribute("onerror","stop");
ZaDomain.getGrantNotebookACLsRequest(n,o);
var r=new Object();
if(e){
r.accountName=e
}
var s=Dwt.getNextId();
r.soapDoc=o;
r.asyncMode=true;
r.busyId=s;
r.callback=new AjxCallback(this,ZaDomainXFormView.modifyAclCallback,[r]);
var t={
showBusy:true,busyId:s,controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_FOLDER_PERMISSIONS};
ZaRequestMgr.invoke(r,t)
}};
ZaDomainXFormView.editButtonListener=function(){
var e=this.getInstance();
if(e[ZaDomain.A2_acl_selection_cache]&&e[ZaDomain.A2_acl_selection_cache][0]){
var n=this.getForm().parent;
if(!n.editAclDlg){
n.editAclDlg=new ZaEditDomainAclXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px");
n.editAclDlg.registerCallback(DwtDialog.OK_BUTTON,ZaDomainXFormView.updateAcl,this.getForm(),null)
}
var o={};
o.gt=e[ZaDomain.A2_acl_selection_cache][0].gt;
o.name=e[ZaDomain.A2_acl_selection_cache][0].name;
o.acl={
r:0,w:0,i:0,d:0,a:0,x:0};
for(var t in e[ZaDomain.A2_acl_selection_cache][0].acl){
o.acl[t]=e[ZaDomain.A2_acl_selection_cache][0].acl[t]
}
n.editAclDlg.setObject(o);
n.editAclDlg.popup()
}};
ZaDomainXFormView.updateAcl=function(){
if(this.parent.editAclDlg){
this.parent.editAclDlg.popdown();
var s=this.parent.editAclDlg.getObject();
var o=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A2_acl_selection_cache);
var e=false;
for(var c in s.acl){
if(s.acl[c]!=o[0].acl[c]){
e=true;
break
}}
if(e){
var l=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_zimbraNotebookAccount);
var h=AjxSoapDoc.create("BatchRequest","urn:zimbra");
h.setMethodAttribute("onerror","stop");
ZaDomain.getGrantNotebookACLsRequest(s,h);
var n=new Object();
if(l){
n.accountName=l
}
var r=Dwt.getNextId();
n.soapDoc=h;
n.asyncMode=true;
n.busyId=r;
n.callback=new AjxCallback(this,ZaDomainXFormView.modifyAclCallback,[n]);
var t={
showBusy:true,busyId:r,controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_FOLDER_PERMISSIONS};
ZaRequestMgr.invoke(n,t)
}}};
ZaDomainXFormView.deleteButtonListener=function(){
var e=this.getInstanceValue(ZaDomain.A2_acl_selection_cache);
if(AjxUtil.isEmpty(e)){
return
}
var n=e.length;
if(n>0){
var t=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_zimbraNotebookAccount);
var s=AjxSoapDoc.create("BatchRequest","urn:zimbra");
s.setMethodAttribute("onerror","stop");
var t=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_zimbraNotebookAccount);
ZaDomain.getRevokeNotebookACLsRequest(e,s);
var h=new Object();
if(t){
h.accountName=t
}
var r=Dwt.getNextId();
h.soapDoc=s;
h.asyncMode=true;
h.busyId=r;
h.callback=new AjxCallback(this,ZaDomainXFormView.modifyAclCallback,[h]);
var o={
showBusy:true,busyId:r,controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_FOLDER_PERMISSIONS};
ZaRequestMgr.invoke(h,o)
}};
ZaDomainXFormView.onFormFieldChanged=function(s,n,o){
var e=this.getInstance();
if(e.attrs[ZaDomain.A_zimbraDomainStatus]&&(e.attrs[ZaDomain.A_zimbraDomainStatus]==ZaDomain.DOMAIN_STATUS_SHUTDOWN)){
var t=this.getInstanceValue();
return t
}else{
this.setInstanceValue(s);
return s
}};
ZaDomainXFormView.preProcessCOS=function(o,e){
var n=o;
if(ZaItem.ID_PATTERN.test(o)){
n=o
}else{
var t=ZaCos.getCosByName(o,e.parent._app);
if(t){
n=t.id
}}
return n
};
ZaDomainXFormView.manualAutoProvisionListener=function(){
try{
var o=this.getForm().parent;
var e=this.getInstance();
if(!o.handleManualProvDlg){
o.handleManualProvDlg=new ZaManualProvConfigDialog(ZaApp.getInstance().getAppCtxt().getShell(),"700px","350px",ZaMsg.DLG_TITILE_MANUAL_PROV);
o.handleManualProvDlg.registerCallback(DwtDialog.OK_BUTTON,ZaManualProvConfigDialog.finishConfig,this.getForm(),null)
}
o.handleManualProvDlg.setObject(e);
o.handleManualProvDlg.popup()
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaDomainXFormView.manualAutoProvisionListener",null,false)
}};
ZaDomainXFormView.checkGALAccountAttribute=function(r,n){
var s=this.getParentItem().getRefPath();
var o=s+"/"+r;
var t=this.getInstanceValue(o);
var e=AjxUtil.isEmpty(t);
return(e==n)
};
ZaDomainXFormView.getUserQuota=function(){
var t={};
t.domainName=this.getForm().getInstanceValue(ZaDomain.A_domainName);
t.sortBy=ZaAccountQuota.A2_diskUsage;
t.sortAscending=0;
var e=new AjxCallback(this.getForm(),ZaDomainXFormView.updateUserQuota,t);
ZaDomain.getAccountQuota(t.domainName,0,50,t.sortBy,t.sortAscending,e)
};
ZaDomainXFormView.updateUserQuota=function(l,h){
if(h&&!h.isException()){
h=h.getResponse().Body.GetQuotaUsageResponse;
var e={
hasMore:false,mbxes:new Array()};
if((h.account&&h.account.length>0)&&(h.searchTotal&&h.searchTotal>0)){
e.hasMore=h.more;
var n=h.account;
var s=new Array();
for(var o=0;
o<n.length;
o++){
s[o]=new ZaAccountQuota(n[o])
}
e.mbxes=s
}
var r=this.getInstanceValue(ZaDomain.A2_domain_account_quota)._version;
r=r?++r:1;
e.mbxes._version=r;
this.setInstanceValue(e.mbxes,ZaDomain.A2_domain_account_quota);
var t=this.getItemById(this.getId()+"_accountQuota").getWidget();
t.setDomainName(l.domainName);
t.setSortBy(l.sortBy);
t.setSortAscending(l.sortAscending);
t.setScrollHasMore(e.hasMore)
}};
ZaDomainXFormView.GAL_TAB_ATTRS=[ZaDomain.A_zimbraGalMode,ZaDomain.A_zimbraGalMaxResults,ZaDomain.A_GalLdapFilter,ZaDomain.A_zimbraGalAutoCompleteLdapFilter,ZaDomain.A_GalLdapSearchBase,ZaDomain.A_GalLdapURL,ZaDomain.A_GalLdapBindDn];
ZaDomainXFormView.GAL_TAB_RIGHTS=[];
ZaDomainXFormView.AUTH_TAB_ATTRS=[ZaDomain.A_AuthMech,ZaDomain.A_AuthLdapUserDn,ZaDomain.A_AuthLdapURL,ZaDomain.A_zimbraAuthLdapStartTlsEnabled,ZaDomain.A_AuthLdapSearchFilter,ZaDomain.A_AuthLdapSearchBase,ZaDomain.A_AuthLdapSearchBindDn];
ZaDomainXFormView.AUTH_TAB_RIGHTS=[];
ZaDomainXFormView.VH_TAB_ATTRS=[ZaDomain.A_zimbraVirtualHostname];
ZaDomainXFormView.VH_TAB_RIGHTS=[];
ZaDomainXFormView.ADV_TAB_ATTRS=[ZaDomain.A_zimbraBasicAuthRealm,ZaDomain.A_zimbraMailAddressValidationRegex,ZaDomain.A_zimbraMailDomainQuota,ZaDomain.A_zimbraDomainAggregateQuota,ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent,ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient,ZaDomain.A_zimbraDomainAggregateQuotaPolicy];
ZaDomainXFormView.ADV_TAB_RIGHTS=[];
ZaDomainXFormView.Feature_TAB_ATTRS=[ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled];
ZaDomainXFormView.Feature_TAB_RIGHTS=[];
ZaDomainXFormView.CERT_TAB_ATTRS=[ZaDomain.A_zimbraSSLCertificate];
ZaDomainXFormView.CERT_TAB_RIGHTS=[];
ZaDomainXFormView.PROV_TAB_ATTRS=[ZaDomain.A_zimbraAutoProvMode,ZaDomain.A_zimbraAutoProvAuthMech,ZaDomain.A_zimbraAutoProvLdapURL,ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled,ZaDomain.A_zimbraAutoProvLdapAdminBindDn,ZaDomain.A_zimbraAutoProvLdapAdminBindPassword,ZaDomain.A_zimbraAutoProvLdapSearchBase,ZaDomain.A_zimbraAutoProvLdapSearchFilter,ZaDomain.A_zimbraAutoProvLdapBindDn,ZaDomain.A_zimbraAutoProvAccountNameMap,ZaDomain.A_zimbraAutoProvAttrMap,ZaDomain.A_zimbraAutoProvNotificationFromAddress,ZaDomain.A_zimbraAutoProvBatchSize,ZaDomain.A_zimbraAutoProvLastPolledTimestamp,ZaDomain.A_zimbraAutoProvNotificationSubject,ZaDomain.A_zimbraAutoProvNotificationBody];
ZaDomainXFormView.PROV_TAB_RIGHTS=[];
ZaDomainXFormView.INTEROP_TAB_ATTRS=[ZaDomain.A_zimbraFreebusyExchangeURL,ZaDomain.A_zimbraFreebusyExchangeAuthScheme,ZaDomain.A_zimbraFreebusyExchangeAuthUsername,ZaDomain.A_zimbraFreebusyExchangeAuthPassword,ZaDomain.A_zimbraFreebusyExchangeUserOrg,ZaDomain.A_zimbraFreebusyExchangeServerType];
ZaDomainXFormView.INTEROP_TAB_RIGHTS=[];
ZaDomainXFormView.ZIMLETS_TAB_ATTRS=[ZaDomain.A_zimbraZimletDomainAvailableZimlets];
ZaDomainXFormView.ZIMLETS_TAB_RIGHTS=[];
ZaDomainXFormView.SKIN_TAB_ATTRS=[ZaDomain.A_zimbraSkinForegroundColor,ZaDomain.A_zimbraSkinBackgroundColor,ZaDomain.A_zimbraSkinSecondaryColor,ZaDomain.A_zimbraSkinSelectionColor,ZaDomain.A_zimbraSkinLogoURL,ZaDomain.A_zimbraSkinLogoLoginBanner,ZaDomain.A_zimbraSkinLogoAppBanner];
ZaDomainXFormView.SKIN_TAB_RIGHTS=[];
ZaDomainXFormView.ACCOUNT_QUOTA_TAB_ATTRS=[];
ZaDomainXFormView.ACCOUNT_QUOTA_TAB_RIGHTS=[ZaDomain.RIGHT_GET_DOMAIN_QUOTA];
ZaDomainXFormView.getCustomWidth=function(){
try{
var t=this.getForm().parent.getHtmlElement();
var e=parseInt(t.style.width);
if(isNaN(e)){
e=t.clientWidth?t.clientWidth:t.offsetWidth
}
return e
}
catch(o){}
return"100%"
};
ZaDomainXFormView.getCustomHeight=function(){
var e=this.getForm().parent;
try{
var o=e.getSize().y;
var h=this.getForm().getItemsById("xform_header");
var r=0;
if(h){
var n=h[0];
if(n.getContainer()){
n=n.getContainer()
}else{
n=n.getHtmlElement()
}
r=Dwt.getSize(n).y
}
var s=2;
if(AjxEnv.isIE){
s=3
}
if(o>(r+s)){
return o-r-s
}}
catch(t){}
return"100%"
};
ZaDomainXFormView.myXFormModifier=function(w,e){
w.tableCssStyle="width:100%;overflow:auto;";
var l=new Array();
l[0]=new ZaListHeaderItem("gt",ZaMsg.Domain_Notebook_type_col,null,"150px",false,null,false,true);
l[1]=new ZaListHeaderItem("name",ZaMsg.Domain_Notebook_name_col,null,"200px",false,null,false,true);
l[2]=new ZaListHeaderItem("acl",ZaMsg.Domain_Notebook_perms_col,null,"auto",null,null,false,true);
w.items=[];
w.items.push({
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:4,colSizes:["32px","*","80px","*"],items:[{
type:_AJX_IMAGE_,src:"Domain_32",label:null,rowSpan:3}
,{
type:_OUTPUT_,ref:"name",label:null,cssClass:"AdminTitle",height:32,rowSpan:3}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID,visibilityChecks:[ZaItem.hasReadPermission]}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var k=ZaItem.formatServerTime(this.getInstanceValue());
if(!k){
return ZaMsg.Server_Time_NA
}else{
return k
}}
,visibilityChecks:[ZaItem.hasReadPermission]}
,{
type:_OUTPUT_,choices:ZaDomain.domainStatusChoices,bmolsnr:true,ref:ZaDomain.A_zimbraDomainStatus,label:ZaMsg.LBL_zimbraDomainStatus,visibilityChecks:[ZaItem.hasReadPermission]}
]}
]}
);
var f=++this.TAB_INDEX;
var v={
type:_TAB_BAR_,ref:ZaModel.currentTab,choices:[],cssClass:"ZaTabBar",id:"xform_tabbar",cssStyle:"display:none;"};
v.choices.push({
value:f,label:ZaMsg.TABT_GeneralPage}
);
var g={
type:_SWITCH_,items:[]};
this.helpMap={};
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_domains/managing_domains.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
var m={
type:_ZATABCASE_,caseKey:f,numCols:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2};
var y=[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.TABT_GeneralPage,width:"100%",numCols:2,colSizes:["275px","auto"],items:[{
type:_DWT_ALERT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_zimbraDomainStatus,ZaDomain.DOMAIN_STATUS_SHUTDOWN]],visibilityChangeEventSources:[ZaDomain.A_zimbraDomainStatus],containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Domain_Locked_Note,colSpan:"*"}
,{
ref:"name",type:_OUTPUT_,label:ZaMsg.Domain_DomainName}
,{
ref:ZaAccount.A_zimbraMailCatchAllAddress,id:ZaAccount.A_zimbraMailCatchAllAddress,type:_DYNSELECT_,visibilityChecks:[ZaDomainXFormView.isCatchAllEnabled],visibilityChangeEventSources:[ZaDomain.A_zimbraAdminConsoleCatchAllAddressEnabled],dataFetcherClass:null,choices:this.catchAllChoices,emptyText:ZaMsg.enterSearchTerm,dataFetcherInstance:true,width:250,dataFetcherMethod:function(j){
try{
var q=j.value;
var x=j.event;
var O=j.callback;
var T=Dwt.getNextId();
var z=new Object();
dataCallback=new AjxCallback(this,ZaSearch.prototype.dynSelectDataCallback,{
callback:O,busyId:T}
);
z.types=[ZaSearch.ACCOUNTS,ZaSearch.DLS];
z.callback=dataCallback;
z.sortBy=ZaAccount.A_name;
z.domain=this.name;
z.query=ZaSearch.getSearchByNameQuery(q,z.types);
z.controller=ZaApp.getInstance().getCurrentController();
z.showBusy=true;
z.busyMsg=ZaMsg.BUSY_SEARCHING;
z.busyId=T;
z.skipCallbackIfCancelled=false;
ZaSearch.searchDirectory(z)
}
catch(k){
this._app.getCurrentController()._handleException(k,"ZaSearch.prototype.dynSelectDataFetcher")
}}
,label:ZaMsg.L_catchAll,labelLocation:_LEFT_,onChange:ZaDomainXFormView.onFormFieldChanged,getDisplayValue:function(k){
if(k&&k.name){
return k.name
}else{
if(!AjxUtil.isEmpty(k)){
return k
}else{
return""
}}}}
,{
ref:ZaDomain.A_domainName,type:_OUTPUT_,label:ZaMsg.Domain_ACEName+":",visibilityChecks:[ZaDomainXFormView.hasACEName],visibilityChangeEventSources:[ZaDomain.A_domainName]}
,{
ref:ZaDomain.A_zimbraPrefTimeZoneId,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefTimeZoneId,label:ZaMsg.LBL_zimbraPrefTimeZoneId,labelLocation:_LEFT_,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraPublicServiceHostname,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraPublicServiceHostname,width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraPublicServiceProtocol,type:_OSELECT1_,label:ZaMsg.Domain_zimbraPublicServiceProtocol,choices:ZaDomain.protocolChoices,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraPublicServicePort,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraPublicServicePort,width:100,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:true,content:ZaMsg.Domain_InboundSMTPNote,visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraDNSCheckHostname]],colSpan:"2"}
,{
ref:ZaDomain.A_zimbraDNSCheckHostname,type:_SUPER_TEXTFIELD_,colSpan:2,txtBoxLabel:ZaMsg.Domain_zimbraDNSCheckHostname,onChange:ZaDomainXFormView.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
,ZaItem.descriptionXFormItem,{
ref:ZaDomain.A_domainDefaultCOSId,type:_DYNSELECT_,label:ZaMsg.Domain_DefaultCOS,labelLocation:_LEFT_,inputPreProcessor:ZaDomainXFormView.preProcessCOS,searchByProcessedValue:false,dataFetcherMethod:ZaSearch.prototype.dynSelectSearchCoses,choices:this.cosChoices,dataFetcherClass:ZaSearch,emptyText:ZaMsg.enterSearchTerm,editable:true,autoCompleteEnabled:true,getDisplayValue:function(x){
if(ZaItem.ID_PATTERN.test(x)){
var k=ZaCos.getCosById(x,this.getForm().parent._app);
if(k){
x=k.name
}}
if(x==null){
x=""
}else{
x=""+x
}
return x
}}
,{
ref:ZaDomain.A_zimbraDomainStatus,type:_OSELECT1_,msgName:ZaMsg.Domain_zimbraDomainStatus,label:ZaMsg.LBL_zimbraDomainStatus,labelLocation:_LEFT_,choices:ZaDomain.domainStatusChoices,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_notes,type:_TEXTAREA_,label:ZaMsg.NAD_Notes,labelCssStyle:"vertical-align:top;",width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraHelpAdminURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraHelpAdminURL,width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraHelpDelegatedURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraHelpDelegatedURL,width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
]}
];
m.items=y;
g.items.push(m);
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.GAL_TAB_ATTRS,ZaDomainXFormView.GAL_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_domains/how_to_configure_gal.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.Domain_Tab_GAL}
);
var u={
type:_ZATABCASE_,caseKey:f,numCols:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2};
var b=[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_GAL_Configuration,numCols:2,colSizes:["275px","auto"],items:[{
type:_DWT_ALERT_,visibilityChangeEventSources:[ZaDomain.A_zimbraDomainStatus],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_zimbraDomainStatus,ZaDomain.DOMAIN_STATUS_SHUTDOWN]],containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Domain_Locked_Note,colSpan:"*"}
,{
ref:ZaDomain.A_zimbraGalMode,type:_OUTPUT_,label:ZaMsg.Domain_GalMode,choices:this.GALModes,visibilityChecks:[ZaItem.hasReadPermission]}
,{
ref:ZaDomain.A_zimbraGalMaxResults,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraGalMaxResults,msgName:ZaMsg.MSG_zimbraGalMaxResults,autoSaveValue:true,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.LBL_GALAccount,numCols:2,colSizes:["275px","auto"],visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_gal_sync_accounts],[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId]],items:[{
type:_REPEAT_,ref:ZaDomain.A2_gal_sync_accounts,colSpan:"*",label:null,showAddButton:false,showRemoveButton:false,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_gal_sync_accounts],[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId]],items:[{
type:_GROUP_,ref:".",numCols:1,width:"100%",items:[{
ref:"name",type:_OUTPUT_,label:ZaMsg.Domain_GalSyncAccount}
,{
ref:("attrs."+ZaDomain.A_mailHost),type:_OUTPUT_,label:ZaMsg.NAD_MailServer,required:true}
,{
ref:(ZaAccount.A2_zimbra_ds+".name"),label:ZaMsg.Domain_InternalGALDSName,type:_OUTPUT_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotExternal,[ZaDomainXFormView.checkGALAccountAttribute,ZaAccount.A2_zimbra_ds,false]]}
,{
ref:(ZaAccount.A2_zimbra_ds+".attrs."+ZaDataSource.A_zimbraDataSourcePollingInterval),type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_internal,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_internal,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotExternal,[ZaDomainXFormView.checkGALAccountAttribute,ZaAccount.A2_zimbra_ds,false]]}
,{
ref:(ZaAccount.A2_ldap_ds+".name"),label:ZaMsg.Domain_ExternalGALDSName,type:_OUTPUT_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[ZaDomainXFormView.checkGALAccountAttribute,ZaAccount.A2_ldap_ds,false]]}
,{
ref:(ZaAccount.A2_ldap_ds+".attrs."+ZaDataSource.A_zimbraDataSourcePollingInterval),type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_external,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_external,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[ZaDomainXFormView.checkGALAccountAttribute,ZaAccount.A2_ldap_ds,false]]}
]}
]}
,{
ref:ZaDomain.A_GALServerType,type:_OUTPUT_,label:ZaMsg.Domain_GALServerType,visibilityChecks:[ZaDomainXFormView.isDomainModeNotInternal],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],choices:this.GALServerTypes,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_GalLdapFilter,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap],[ZaDomainXFormView.isDomainModeNotInternal]],visibilityChangeEventSources:[ZaDomain.A_GALServerType,ZaDomain.A_zimbraGalMode]}
,{
ref:ZaDomain.A_zimbraGalAutoCompleteLdapFilter,type:_OUTPUT_,label:ZaMsg.Domain_zimbraGalAutoCompleteLdapFilter,labelLocation:_LEFT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap],[ZaDomainXFormView.isDomainModeNotInternal]],visibilityChangeEventSources:[ZaDomain.A_GALServerType,ZaDomain.A_zimbraGalMode]}
,{
ref:ZaDomain.A_GalLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapSearchBase,visibilityChecks:[ZaDomainXFormView.isDomainModeNotInternal],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],labelLocation:_LEFT_}
,{
ref:ZaDomain.A_GalLdapURL,type:_REPEAT_,label:ZaMsg.LBL_Domain_GalLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,visibilityChecks:[ZaDomainXFormView.isDomainModeNotInternal],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_}
]}
,{
ref:ZaDomain.A_GalLdapBindDn,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[ZaDomainXFormView.isDomainModeNotInternal],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],enableDisableChangeEventSources:[ZaDomain.A_UseBindPassword],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]]}
]}
];
u.items=b;
g.items.push(u)
}
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.AUTH_TAB_ATTRS,ZaDomainXFormView.AUTH_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_domains/authentication_settings.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.Domain_Tab_Authentication}
);
var d={
type:_ZATABCASE_,caseKey:f,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_DWT_ALERT_,visibilityChangeEventSources:[ZaDomain.A_zimbraDomainStatus],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_zimbraDomainStatus,ZaDomain.DOMAIN_STATUS_SHUTDOWN]],containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Domain_Locked_Note,colSpan:"*"}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_AuthSetting,colSizes:["275px","*"],colSpan:"*",items:[{
ref:ZaDomain.A_AuthMech,type:_OUTPUT_,label:ZaMsg.Domain_AuthMech,choices:this.AuthMechs}
,{
type:_GROUP_,useParentTable:true,colSpan:"*",visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthLdapUserDn,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapUserDn,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_}
]}
]}
,{
type:_GROUP_,useParentTable:true,colSpan:"*",visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthLdapUserDn,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapUserDn,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_}
]}
,{
ref:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_OUTPUT_,label:ZaMsg.Domain_llAuthLdapStartTlsEnabled,labelLocation:_LEFT_,choices:ZaModel.BOOLEAN_CHOICES}
,{
ref:ZaDomain.A_AuthLdapSearchFilter,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapFilter,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapSearchBase,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthUseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_AuthUseBindPassword,labelLocation:_LEFT_,choices:ZaModel.BOOLEAN_CHOICES}
,{
ref:ZaDomain.A_AuthLdapSearchBindDn,type:_INPUT_,label:ZaMsg.Domain_AuthLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],visibilityChangeEventSources:[ZaDomain.A_AuthUseBindPassword]}
]}
,{
ref:ZaDomain.A_zimbraPasswordChangeListener,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraPasswordChangeListener,labelLocation:_LEFT_,visibilityChecks:[function(){
var k=this.getInstance();
return(k.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra)
}
],visibilityChangeEventSources:[ZaDomain.A_AuthMech]}
,{
ref:ZaDomain.A_zimbraAuthFallbackToLocal,type:_CHECKBOX_,label:ZaMsg.Domain_zimbraAuthFallbackToLocal,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[function(){
var k=this.getInstance();
return(k.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra)
}
],visibilityChangeEventSources:[ZaDomain.A_AuthMech]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_URLSetting,colSpan:"*",numCols:2,colSizes:["275px","*"],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaDomain.A_zimbraAdminConsoleLoginURL,ZaDomain.A_zimbraAdminConsoleLogoutURL]]],items:[{
ref:ZaDomain.A_zimbraAdminConsoleLoginURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraAdminConsoleLoginURL,width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraAdminConsoleLogoutURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraAdminConsoleLogoutURL,width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_WEBCLIENT_Configure,colSpan:"*",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaDomain.A_zimbraWebClientLoginURL,ZaDomain.A_zimbraWebClientLogoutURL,ZaDomain.A_zimbraWebClientLoginURLAllowedUA,ZaDomain.A_zimbraWebClientLogoutURLAllowedUA,ZaDomain.A_zimbraWebClientLoginURLAllowedIP,ZaDomain.A_zimbraWebClientLogoutURLAllowedIP,ZaDomain.A_zimbraForceClearCookies]]],items:[{
ref:ZaDomain.A_zimbraWebClientLoginURL,useParentTable:false,colSpan:2,type:_SUPER_TEXTFIELD_,textFieldWidth:"220px",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,msgName:ZaMsg.LBL_zimbraWebClientLoginURL,txtBoxLabel:ZaMsg.LBL_zimbraWebClientLoginURL,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraWebClientLogoutURL,useParentTable:false,colSpan:2,type:_SUPER_TEXTFIELD_,textFieldWidth:"220px",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,msgName:ZaMsg.LBL_zimbraWebClientLogoutURL,txtBoxLabel:ZaMsg.LBL_zimbraWebClientLogoutURL,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraWebClientLoginURLAllowedUA,label:ZaMsg.LBL_zimbraWebClientLoginURLAllowedUA,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["275px","*"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
],onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraWebClientLogoutURLAllowedUA,label:ZaMsg.LBL_zimbraWebClientLogoutURLAllowedUA,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["275px","*"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
],onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraWebClientLoginURLAllowedIP,label:ZaMsg.LBL_zimbraWebClientLoginURLAllowedIP,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["275px","*"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
],onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraWebClientLogoutURLAllowedIP,label:ZaMsg.LBL_zimbraWebClientLogoutURLAllowedIP,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["275px","*"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
],onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraForceClearCookies,useParentTable:false,colSpan:2,type:_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,msgName:ZaMsg.MSG_zimbraForceClearCookies,label:ZaMsg.LBL_zimbraForceClearCookies,labelLocation:_LEFT_,onChange:ZaDomainXFormView.onFormFieldChanged}
]}
]};
g.items.push(d)
}
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.VH_TAB_ATTRS,ZaDomainXFormView.VH_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_domains/configuring_virtual_hosts.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.Domain_Tab_VirtualHost}
);
var c={
type:_ZATABCASE_,caseKey:f,cssStyle:"padding-left:10px;",items:[{
type:_DWT_ALERT_,visibilityChangeEventSources:[ZaDomain.A_zimbraDomainStatus],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_zimbraDomainStatus,ZaDomain.DOMAIN_STATUS_SHUTDOWN]],containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Domain_Locked_Note,colSpan:"*"}
,{
type:_DWT_ALERT_,content:null,ref:ZaDomain.A_domainName,getDisplayValue:function(k){
return AjxMessageFormat.format(ZaMsg.Domain_VH_Explanation,k)
}
,colSpan:"*",iconVisible:false,align:_CENTER_,style:DwtAlert.INFORMATION}
,{
ref:ZaDomain.A_zimbraVirtualHostname,type:_REPEAT_,label:null,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddVirtualHost,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveVirtualHost,items:[{
ref:".",type:_TEXTFIELD_,label:null,enableDisableChecks:[[ZaItem.hasWritePermission,ZaDomain.A_zimbraVirtualHostname]],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraVirtualHostname]],onChange:ZaDomainXFormView.onFormFieldChanged}
]}
]};
g.items.push(c)
}
if(ZaDomainXFormView.Feature_TAB_ATTRS&&ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.Feature_TAB_ATTRS,ZaDomainXFormView.Feature_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"setting_up_sms_reminders_feature.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.TABT_Features}
);
var r={
type:_ZATABCASE_,caseKey:f,cssStyle:"padding-left:10px;",items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraCalendarFeature,items:[{
ref:ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_CHECKBOX_,labelLocation:_RIGHT_,msgName:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,label:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
]};
g.items.push(r)
}
if(ZaDomainXFormView.ADV_TAB_ATTRS&&ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.ADV_TAB_ATTRS,ZaDomainXFormView.ADV_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/account_email_validation.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.Domain_Tab_Advanced}
);
var h={
type:_ZATABCASE_,caseKey:f,colSizes:["auto"],numCols:1,id:"domain_advanced_tab",cssStyle:"padding-left:10px;",items:[{
type:_DWT_ALERT_,visibilityChangeEventSources:[ZaDomain.A_zimbraDomainStatus],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_zimbraDomainStatus,ZaDomain.DOMAIN_STATUS_SHUTDOWN]],containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Domain_Locked_Note,colSpan:"*"}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_BC_ShareConf,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,ZaDomain.A_zimbraBasicAuthRealm]],items:[{
ref:ZaDomain.A_zimbraBasicAuthRealm,type:_SUPER_TEXTFIELD_,width:250,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,onChange:ZaDomainXFormView.onFormFieldChanged,txtBoxLabel:ZaMsg.Domain_zimbraBasicAuthRealm}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_AD_EmailValidate,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,ZaDomain.A_zimbraMailAddressValidationRegex]],items:[{
ref:ZaDomain.A_zimbraMailAddressValidationRegex,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_EmailValidate,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddRegex,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveRegex,items:[{
ref:".",type:_TEXTFIELD_,label:null,enableDisableChecks:[],visibilityChecks:[],onChange:ZaDomainXFormView.onFormFieldChanged}
]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_QUOTA_Configuration,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaDomain.A_zimbraMailDomainQuota,ZaDomain.A_zimbraDomainAggregateQuota,ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent,ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient,ZaDomain.A_zimbraDomainAggregateQuotaPolicy]]],items:[{
ref:ZaDomain.A_zimbraMailDomainQuota,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainQuota,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuota,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainAggregateQuota,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainAggregateQuotaWarnPercent,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainAggregateQuotaWarnEmailRecipient,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuotaPolicy,type:_OSELECT1_,label:ZaMsg.LBL_DomainAggregateQuotaPolicy,labelLocation:_LEFT_,onChange:ZaDomainXFormView.onFormFieldChanged}
]}
]};
g.items.push(h)
}
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.INTEROP_TAB_ATTRS,ZaDomainXFormView.INTEROP_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/making_free_busy_view__available_.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.TABT_Interop}
);
var s={
type:_ZATABCASE_,caseKey:f,colSizes:["auto"],numCols:1,id:"global_interop_tab",paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_Exchange_Settings,colSizes:["275px","100%"],items:[{
ref:ZaDomain.A_zimbraFreebusyExchangeURL,type:_SUPER_TEXTFIELD_,width:"30em",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,onChange:ZaDomainXFormView.onFormFieldChanged,txtBoxLabel:ZaMsg.NAD_Exchange_URL}
,{
ref:ZaDomain.A_zimbraFreebusyExchangeAuthScheme,label:ZaMsg.NAD_Exchange_Auth_Schema,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraFreebusyExchangeServerType,label:ZaMsg.NAD_Exchange_Server_Type,type:_SUPER_SELECT1_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraFreebusyExchangeAuthUsername,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,type:_SUPER_TEXTFIELD_,width:"20em",txtBoxLabel:ZaMsg.NAD_Exchange_Auth_User,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraFreebusyExchangeAuthPassword,type:_PASSWORD_,label:ZaMsg.NAD_Exchange_Auth_Password,width:"20em",onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraFreebusyExchangeUserOrg,type:_SUPER_TEXTFIELD_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,txtBoxLabel:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,width:"30em",onChange:ZaDomainXFormView.onFormFieldChanged}
,{
type:_GROUP_,colSpan:2,numCols:5,colSizes:["20%","22%","6%","22%","20%"],width:"100%",items:[{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Check_Settings,autoPadding:false,onActivate:ZaItem.checkInteropSettings}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Clear_Settings,autoPadding:false,onActivate:ZaItem.clearInteropSettings}
,{
type:_CELLSPACER_}
]}
]}
]};
g.items.push(s)
}
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.ZIMLETS_TAB_ATTRS,ZaDomainXFormView.ZIMLETS_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"zimlets/about_zimlets.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.TABT_Zimlets}
);
var n={
type:_ZATABCASE_,id:"account_form_zimlets_tab",numCols:1,caseKey:f,items:[{
type:_ZAGROUP_,numCols:1,colSizes:["auto"],border:0,items:[{
type:_OUTPUT_,value:ZaMsg.NAD_LimitZimletsToDomain}
,{
type:_ZA_ZIMLET_SELECT_COMBO_,selectRef:ZaDomain.A_zimbraZimletDomainAvailableZimlets,ref:ZaDomain.A_zimbraZimletDomainAvailableZimlets,choices:ZaDomainXFormView.zimletChoices}
,{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Zimlet_Note}
]}
]};
g.items.push(n)
}
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.SKIN_TAB_ATTRS,ZaDomainXFormView.SKIN_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_domains/managing_domains.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.TABT_Themes}
);
var o={
type:_ZATABCASE_,id:"domain_form_skin_tab",colSizes:["auto"],numCols:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,caseKey:f,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_Skin_Color_Settings,colSizes:["275px","*"],items:[{
type:_DWT_ALERT_,style:DwtAlert.INFO,iconVisible:true,content:ZaMsg.Domain_Chameleon_Note,colSpan:2,visibilityChecks:[],ref:null}
,{
ref:ZaDomain.A_zimbraSkinForegroundColor,type:_SUPER_DWT_COLORPICKER_,label:ZaMsg.NAD_zimbraSkinForegroundColor,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,buttonImage:"Color",width:"50px"}
,{
ref:ZaDomain.A_zimbraSkinBackgroundColor,type:_SUPER_DWT_COLORPICKER_,label:ZaMsg.NAD_zimbraSkinBackgroundColor,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,buttonImage:"Color",width:"50px"}
,{
ref:ZaDomain.A_zimbraSkinSecondaryColor,type:_SUPER_DWT_COLORPICKER_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,label:ZaMsg.NAD_zimbraSkinSecondaryColor,labelLocation:_LEFT_,buttonImage:"Color",width:"50px"}
,{
ref:ZaDomain.A_zimbraSkinSelectionColor,type:_SUPER_DWT_COLORPICKER_,label:ZaMsg.NAD_zimbraSkinSelectionColor,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,buttonImage:"Color",width:"50px"}
,{
type:_GROUP_,colSpan:2,cssStyle:"margin-top: 10px; margin-left: 200px; width: 200px;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.bt_ResetAllSkinColor,onActivate:ZaDomainXFormView.resetAllColorThemes}
]}
]}
]};
g.items.push(o)
}
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.CERT_TAB_ATTRS,ZaDomainXFormView.CERT_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_domains/installing_ssl_certificate_for_a_domain.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.TABT_Certificate}
);
var t={
type:_ZATABCASE_,numCols:1,caseKey:f,colSizes:["100%"],items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.MSG_DOMAIN_CERT_KEY}
,{
type:_SPACER_,height:"10"}
,{
type:_GROUP_,width:"100%",numCols:2,colSizes:["50%","50%"],items:[{
type:_SPACER_,height:"10"}
,{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.NAD_DomainSSLCertificate,containerCssStyle:"padding-top:5px;",items:[{
ref:ZaDomain.A_zimbraSSLCertificate,type:_TEXTAREA_,width:"100%",height:450,onChange:ZaDomainXFormView.onFormFieldChanged}
]}
,{
type:_ZARIGHT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.NAD_DomainSSLPrivateKey,containerCssStyle:"padding-top:5px;",items:[{
ref:ZaDomain.A_zimbraSSLPrivateKey,type:_TEXTAREA_,width:"100%",height:450,onChange:ZaDomainXFormView.onFormFieldChanged}
]}
]}
]};
g.items.push(t)
}
if(ZaTabView.isTAB_ENABLED(e,ZaDomainXFormView.ACCOUNT_QUOTA_TAB_ATTRS,ZaDomainXFormView.ACCOUNT_QUOTA_TAB_RIGHTS)){
f=++this.TAB_INDEX;
this.helpMap[f]=[location.pathname,ZaUtil.HELP_URL,"managing_servers/viewing_mailbox_quotas.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
v.choices.push({
value:f,label:ZaMsg.TABT_MBX}
);
var p={
type:_SUPER_TABCASE_,numCols:1,caseKey:f,colSizes:["100%"],paddingStyle:"padding: 0px",width:"100%",getCustomPaddingStyle:"return 0",loadDataMethods:[ZaDomainXFormView.getUserQuota],items:[{
type:_DWT_LIST_,id:"accountQuota",ref:ZaDomain.A2_domain_account_quota,forceUpdate:true,cssStyle:"height:100%",cssClass:"DLSource",widgetClass:ZaDomainAccountQuotaListView,hideHeader:false,getCustomWidth:ZaDomainXFormView.getCustomWidth,getCustomHeight:ZaDomainXFormView.getCustomHeight}
]};
g.items.push(p)
}
w.items.push(v);
w.items.push(g);
this.tabChoices=v.choices
};
ZaTabView.XFormModifiers.ZaDomainXFormView.push(ZaDomainXFormView.myXFormModifier);
ZaDomainXFormView.prototype.getTabChoices=function(){
return this.tabChoices
};
ZaAccMiniListView=function(n,o,t,e){
if(arguments.length==0){
return
}
ZaListView.call(this,n,o,t,e);
this.hideHeader=true
};
ZaAccMiniListView.prototype=new ZaListView;
ZaAccMiniListView.prototype.constructor=ZaAccMiniListView;
ZaAccMiniListView.prototype.toString=function(){
return"ZaAccMiniListView"
};
ZaAccMiniListView.prototype.createHeaderHtml=function(e){
if(!this.hideHeader){
DwtListView.prototype.createHeaderHtml.call(this,e)
}};
ZaDomainCOSMaxAccountsListView=function(n,o,t,e){
if(arguments.length==0){
return
}
ZaListView.call(this,n,o,t,e);
this.hideHeader=true;
this._app=this.parent.parent._app
};
ZaDomainCOSMaxAccountsListView.prototype=new ZaListView;
ZaDomainCOSMaxAccountsListView.prototype.constructor=ZaDomainCOSMaxAccountsListView;
ZaDomainCOSMaxAccountsListView.prototype.toString=function(){
return"ZaDomainCOSMaxAccountsListView"
};
ZaDomainCOSMaxAccountsListView.prototype.createHeaderHtml=function(e){
if(!this.hideHeader){
DwtListView.prototype.createHeaderHtml.call(this,e)
}};
ZaDomainCOSMaxAccountsListView.prototype._createItemHtml=function(c){
var o=new Array(50);
var t=document.createElement("div");
t[DwtListView._STYLE_CLASS]="Row";
t[DwtListView._SELECTED_STYLE_CLASS]=t[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
t.className=t[DwtListView._STYLE_CLASS];
this.associateItemWithElement(c,t,DwtListView.TYPE_LIST_ITEM);
var r=c.split(":");
var s=r[0];
var l=ZaCos.getCosById(s);
var n;
if(l){
n=l.name
}else{
n=AjxMessageFormat.format(ZaMsg.ERROR_INVALID_COS_VALUE,[s])
}
var e=r[1];
var h=0;
o[h++]="<table width='100%' cellspacing='2' cellpadding='0'>";
o[h++]="<tr>";
o[h++]="<td width="+this._headerList[0]._width+">";
o[h++]=AjxStringUtil.htmlEncode(n);
o[h++]="</td>";
o[h++]="<td align='left' width="+this._headerList[1]._width+"><nobr>";
o[h++]=AjxStringUtil.htmlEncode(e);
o[h++]="</nobr></td>";
o[h++]="</tr></table>";
t.innerHTML=o.join("");
return t
};
ZaDomainCOSMaxAccountsListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br />",ZaMsg.NO_LIMITS,"</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaDomainFeatureMaxAccountsListView=function(n,o,t,e){
if(arguments.length==0){
return
}
ZaListView.call(this,n,o,t,e);
this.hideHeader=true;
this._app=this.parent.parent._app
};
ZaDomainFeatureMaxAccountsListView.prototype=new ZaListView;
ZaDomainFeatureMaxAccountsListView.prototype.constructor=ZaDomainFeatureMaxAccountsListView;
ZaDomainFeatureMaxAccountsListView.prototype.toString=function(){
return"ZaDomainFeatureMaxAccountsListView"
};
ZaDomainFeatureMaxAccountsListView.prototype.createHeaderHtml=function(e){
if(!this.hideHeader){
DwtListView.prototype.createHeaderHtml.call(this,e)
}};
ZaDomainFeatureMaxAccountsListView.prototype._createItemHtml=function(r){
var n=new Array(50);
var h=document.createElement("div");
h[DwtListView._STYLE_CLASS]="Row";
h[DwtListView._SELECTED_STYLE_CLASS]=h[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
h.className=h[DwtListView._STYLE_CLASS];
this.associateItemWithElement(r,h,DwtListView.TYPE_LIST_ITEM);
var s=r.split(":");
var o=ZaUtil.getListItemLabel(ZaCos.MAJOR_FEATURES_CHOICES,s[0])||s[0];
var t=s[1];
var e=0;
n[e++]="<table width='100%' cellspacing='2' cellpadding='0'>";
n[e++]="<tr>";
n[e++]="<td width="+this._headerList[0]._width+">";
n[e++]=AjxStringUtil.htmlEncode(o);
n[e++]="</td>";
n[e++]="<td align='left' width="+this._headerList[1]._width+"><nobr>";
n[e++]=AjxStringUtil.htmlEncode(t);
n[e++]="</nobr></td>";
n[e++]="</tr></table>";
h.innerHTML=n.join("");
return h
};
ZaDomainFeatureMaxAccountsListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br />",ZaMsg.NO_LIMITS,"</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaNewDomainXWizard")){
ZaNewDomainXWizard=function(e,t){
ZaXWizardDialog.call(this,e,null,ZaMsg.NDD_Title,"700px","350px","ZaNewDomainXWizard",null,ZaId.DLG_NEW_DOMAIN);
this.TAB_INDEX=0;
ZaNewDomainXWizard.GENERAL_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.GALMODE_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.GAL_CONFIG_STEP_2=++this.TAB_INDEX;
ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1=++this.TAB_INDEX;
ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2=++this.TAB_INDEX;
ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.GAL_TEST_RESULT_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.SYNC_CONFIG_SUM_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.SYNC_TEST_RESULT_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.AUTH_URL_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.AUTH_MODE_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.AUTH_CONFIG_STEP_2=++this.TAB_INDEX;
ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.AUTH_TEST_RESULT_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.VHOST_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.ADVANCED_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.FEATURE_STEP=++this.TAB_INDEX;
ZaNewDomainXWizard.CONFIG_COMPLETE_STEP=++this.TAB_INDEX;
this.stepChoices=[{
label:ZaMsg.TABT_GeneralPage,value:ZaNewDomainXWizard.GENERAL_STEP}
,{
label:ZaMsg.GALConfiguration,value:ZaNewDomainXWizard.GALMODE_STEP}
,{
label:ZaMsg.GALDnConfiguration,value:ZaNewDomainXWizard.GAL_CONFIG_STEP_2}
,{
label:ZaMsg.GALSyncConfiguration,value:ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1}
,{
label:ZaMsg.GALSyncDnConfiguration,value:ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2}
,{
label:ZaMsg.GALConfigSummary,value:ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP}
,{
label:ZaMsg.GalTestResult,value:ZaNewDomainXWizard.GAL_TEST_RESULT_STEP}
,{
label:ZaMsg.SyncConfigSummary,value:ZaNewDomainXWizard.SYNC_CONFIG_SUM_STEP}
,{
label:ZaMsg.SyncTestResult,value:ZaNewDomainXWizard.SYNC_TEST_RESULT_STEP}
,{
label:ZaMsg.DomainSSO,value:ZaNewDomainXWizard.AUTH_URL_STEP}
,{
label:ZaMsg.AuthMode,value:ZaNewDomainXWizard.AUTH_MODE_STEP}
,{
label:ZaMsg.AuthSettings,value:ZaNewDomainXWizard.AUTH_CONFIG_STEP_2}
,{
label:ZaMsg.AuthSettingsSummary,value:ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP}
,{
label:ZaMsg.AuthTestResult,value:ZaNewDomainXWizard.AUTH_TEST_RESULT_STEP}
,{
label:ZaMsg.Domain_Tab_VirtualHost,value:ZaNewDomainXWizard.VHOST_STEP}
,{
label:ZaMsg.Domain_Tab_Advanced,value:ZaNewDomainXWizard.ADVANCED_STEP}
,{
label:ZaMsg.TABT_Feature,value:ZaNewDomainXWizard.FEATURE_STEP}
,{
label:ZaMsg.DomainConfigComplete,value:ZaNewDomainXWizard.CONFIG_COMPLETE_STEP}
];
this.GALModes=[{
label:ZaMsg.GALMode_internal,value:ZaDomain.GAL_Mode_internal}
,{
label:ZaMsg.GALMode_external,value:ZaDomain.GAL_Mode_external}
,{
label:ZaMsg.GALMode_both,value:ZaDomain.GAL_Mode_both}
];
this.GALServerTypes=[{
label:ZaMsg.GALServerType_ldap,value:ZaDomain.GAL_ServerType_ldap}
,{
label:ZaMsg.GALServerType_ad,value:ZaDomain.GAL_ServerType_ad}
];
this.AuthMechs=[{
label:ZaMsg.AuthMech_zimbra,value:ZaDomain.AuthMech_zimbra}
,{
label:ZaMsg.AuthMech_ldap,value:ZaDomain.AuthMech_ldap}
,{
label:ZaMsg.AuthMech_ad,value:ZaDomain.AuthMech_ad}
];
this.TestResultChoices=[{
label:ZaMsg.AuthTest_check_OK,value:ZaDomain.Check_OK}
,{
label:ZaMsg.AuthTest_check_UNKNOWN_HOST,value:ZaDomain.Check_UNKNOWN_HOST}
,{
label:ZaMsg.AuthTest_check_CONNECTION_REFUSED,value:ZaDomain.Check_CONNECTION_REFUSED}
,{
label:ZaMsg.AuthTest_check_SSL_HANDSHAKE_FAILURE,value:ZaDomain.Check_SSL_HANDSHAKE_FAILURE}
,{
label:ZaMsg.AuthTest_check_COMMUNICATION_FAILURE,value:ZaDomain.Check_COMMUNICATION_FAILURE}
,{
label:ZaMsg.AuthTest_check_AUTH_FAILED,value:ZaDomain.Check_AUTH_FAILED}
,{
label:ZaMsg.AuthTest_check_AUTH_NOT_SUPPORTED,value:ZaDomain.Check_AUTH_NOT_SUPPORTED}
,{
label:ZaMsg.AuthTest_check_NAME_NOT_FOUND,value:ZaDomain.Check_NAME_NOT_FOUND}
,{
label:ZaMsg.AuthTest_check_INVALID_SEARCH_FILTER,value:ZaDomain.Check_INVALID_SEARCH_FILTER}
,{
label:ZaMsg.AuthTest_check_FAILURE,value:ZaDomain.Check_FAILURE}
];
this.initForm(ZaDomain.myXModel,this.getMyXForm(t),null);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaNewDomainXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaNewDomainXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_CHANGED,new AjxListener(this,ZaNewDomainXWizard.prototype.handleXFormChange));
this.lastErrorStep=0;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/creating_a_domain.htm?locid="+AjxEnv.DEFAULT_LOCALE
};
ZaNewDomainXWizard.prototype=new ZaXWizardDialog;
ZaNewDomainXWizard.prototype.constructor=ZaNewDomainXWizard;
ZaXDialog.XFormModifiers.ZaNewDomainXWizard=new Array();
ZaNewDomainXWizard.prototype.handleXFormChange=function(){
if(this._localXForm.hasErrors()){
if(this.lastErrorStep<this._containedObject[ZaModel.currentStep]){
this.lastErrorStep=this._containedObject[ZaModel.currentStep]
}}else{
this.lastErrorStep=0
}
this.changeButtonStateForStep(this._containedObject[ZaModel.currentStep])
};
ZaNewDomainXWizard.prototype.changeButtonStateForStep=function(e){
if(this.lastErrorStep==e){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
if(e>ZaNewDomainXWizard.GENERAL_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}else{
if(e==ZaNewDomainXWizard.GENERAL_STEP){
if(this._containedObject.attrs[ZaDomain.A_domainName]){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}else{
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
if(e==ZaNewDomainXWizard.GALMODE_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
if(this.checkGALAccount()){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}else{
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
if(e==ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
if(e==ZaNewDomainXWizard.AUTH_TEST_STEP){
this._button[DwtWizardDialog.NEXT_BUTTON].setText(AjxMsg._next);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}else{
if(e==ZaNewDomainXWizard.CONFIG_COMPLETE_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}else{
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}}}}}}
if(this._containedObject.attrs[ZaDomain.A_domainName]&&this._containedObject.attrs[ZaDomain.A_domainName].length>0&&this.lastErrorStep!=e&&this.checkGALAccount()){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}};
ZaNewDomainXWizard.prototype.setObject=function(o){
this._containedObject=new Object();
this._containedObject.attrs=new Object();
for(var e in o.attrs){
this._containedObject.attrs[e]=o.attrs[e]
}
this._containedObject.attrs[ZaDomain.A_zimbraDomainStatus]=ZaDomain.DOMAIN_STATUS_ACTIVE;
this._containedObject[ZaDomain.A2_isTestingGAL]=o[ZaDomain.A2_isTestingGAL]||0;
this._containedObject[ZaDomain.A2_isTestingSync]=o[ZaDomain.A2_isTestingSync]||0;
this._containedObject[ZaDomain.A2_isTestingAuth]=o[ZaDomain.A2_isTestingAuth]||0;
this._containedObject[ZaDomain.A2_create_gal_acc]=o[ZaDomain.A2_create_gal_acc]||"TRUE";
this._containedObject[ZaDomain.A2_gal_sync_accounts_set]=[];
for(var t in o[ZaDomain.A2_gal_sync_accounts_set]){
if(o[ZaDomain.A2_gal_sync_accounts_set][t]){
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][t]={};
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_gal_sync_account_name]=o[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_gal_sync_account_name];
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_internal_gal_ds_name]=o[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_internal_gal_ds_name];
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_external_gal_ds_name]=o[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_external_gal_ds_name];
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_internal_gal_polling_interval]=o[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_internal_gal_polling_interval]||"1d";
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_external_gal_polling_interval]=o[ZaDomain.A2_gal_sync_accounts_set][t][ZaDomain.A2_new_external_gal_polling_interval]||"1d"
}}
if(o.rights){
this._containedObject.rights=o.rights
}
if(o.setAttrs){
this._containedObject.setAttrs=o.setAttrs
}
if(o.getAttrs){
this._containedObject.getAttrs=o.getAttrs
}
if(o._defaultValues){
this._containedObject._defaultValues=o._defaultValues
}
if(o._uuid){
this._containedObject._uuid=o._uuid
}
this._containedObject[ZaModel.currentStep]=o[ZaModel.currentStep]||1;
this._localXForm.setInstance(this._containedObject)
};
ZaNewDomainXWizard.onGALServerTypeChange=function(o,t,e){
if(o=="ad"){
e.getModel().setInstanceValue(e.getInstance(),ZaDomain.A_GalLdapFilter,"ad");
e.getModel().setInstanceValue(e.getInstance(),ZaDomain.A_zimbraGalAutoCompleteLdapFilter,"adAutoComplete")
}else{
e.getModel().setInstanceValue(e.getInstance(),ZaDomain.A_GalLdapFilter,"");
e.getModel().setInstanceValue(e.getInstance(),ZaDomain.A_zimbraGalAutoCompleteLdapFilter,"(|(cn=%s*)(sn=%s*)(gn=%s*)(mail=%s*))")
}
this.setInstanceValue(o)
};
ZaNewDomainXWizard.onGalModeChange=function(r,s,n){
this.setInstanceValue(r);
if(r!="zimbra"){
n.getModel().setInstanceValue(n.getInstance(),ZaDomain.A_GalLdapFilter,"");
if(AjxUtil.isEmpty(n.getModel().getInstanceValue(n.getInstance(),ZaDomain.A_GALServerType))){
n.getModel().setInstanceValue(n.getInstance(),ZaDomain.A_GALServerType,"ldap")
}
if(AjxUtil.isEmpty(n.getModel().getInstanceValue(n.getInstance(),ZaDomain.A_GalLdapSearchBase))){
if(!AjxUtil.isEmpty(n.getModel().getInstanceValue(n.getInstance(),ZaDomain.A_domainName))){
var h=n.getModel().getInstanceValue(n.getInstance(),ZaDomain.A_domainName).split(".");
var t="";
var o="";
for(var e in h){
t+=o;
t+="dc=";
t+=h[e];
var o=","
}
n.getModel().setInstanceValue(n.getInstance(),ZaDomain.A_GalLdapSearchBase,t)
}}}};
ZaNewDomainXWizard.onGALSyncServerTypeChange=function(o,t,e){
if(o=="ad"){
e.getModel().setInstanceValue(e.getInstance(),ZaDomain.A_zimbraGalSyncLdapFilter,"ad")
}
this.setInstanceValue(o)
};
ZaNewDomainXWizard.onGALSyncChange=function(o,t,e){
this.setInstanceValue(o);
if(o=="FALSE"){
if(e.getModel().getInstanceValue(e.getInstance(),ZaDomain.A_zimbraGalSyncLdapFilter)=="ad"){
e.getModel().setInstanceValue(e.getInstance(),ZaDomain.A_GALSyncServerType,"ad")
}else{
if(AjxUtil.isEmpty(e.getModel().getInstanceValue(e.getInstance(),ZaDomain.A_GALSyncServerType))){
e.getModel().setInstanceValue(e.getInstance(),ZaDomain.A_GALSyncServerType,"ldap")
}}}};
ZaNewDomainXWizard.testSyncSettings=function(){
var e=this.getInstance();
this.getModel().setInstanceValue(e,ZaDomain.A2_isTestingSync,1);
var t=new AjxCallback(this,ZaNewDomainXWizard.checkSyncConfigCallBack);
ZaDomain.testSyncSettings(e,t)
};
ZaNewDomainXWizard.checkSyncConfigCallBack=function(t){
if(!t){
return
}
var e=this.getInstance();
this.getModel().setInstanceValue(e,ZaDomain.A2_isTestingSync,0);
if(t.isException()){
var n=[t.getException().detail,t.getException().msg,t.getException().trace].join("\n");
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestResultCode,t.getException().code);
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestMessage,n)
}else{
var o=t.getResponse().Body.CheckGalConfigResponse;
if(o){
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestResultCode,o.code[0]._content);
if(o.code[0]._content!=ZaDomain.Check_OK){
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestMessage,o.message[0]._content)
}}}
this.getForm().parent.goPage(ZaNewDomainXWizard.SYNC_TEST_RESULT_STEP)
};
ZaNewDomainXWizard.testGALSettings=function(){
var e=this.getInstance();
this.getModel().setInstanceValue(e,ZaDomain.A2_isTestingGAL,1);
var t=new AjxCallback(this,ZaNewDomainXWizard.checkGALConfigCallBack);
ZaDomain.testGALSettings(e,t,e[ZaDomain.A_GALSampleQuery])
};
ZaNewDomainXWizard.checkGALConfigCallBack=function(c){
if(!c){
return
}
var l=this.getInstance();
this.getModel().setInstanceValue(l,ZaDomain.A2_isTestingGAL,0);
if(c.isException()){
var t=[c.getException().detail,c.getException().msg,c.getException().trace].join("\n");
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestResultCode,c.getException().code);
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestMessage,t);
this.getModel().setInstanceValue(l,ZaDomain.A_GALTestSearchResults,null)
}else{
var s=c.getResponse().Body.CheckGalConfigResponse;
if(s){
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestResultCode,s.code[0]._content);
if(s.code[0]._content!=ZaDomain.Check_OK){
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestMessage,s.message[0]._content);
this.getModel().setInstanceValue(l,ZaDomain.A_GALTestSearchResults,null)
}else{
var e=new Array();
if(s.cn&&s.cn.length){
var r=s.cn.length;
for(var o=0;
o<r;
o++){
var n=new Object();
if(s.cn[o]._attrs){
for(var h in s.cn[o]._attrs){
n[h]=s.cn[o]._attrs[h]
}
e.push(n)
}}}
this.getModel().setInstanceValue(l,ZaDomain.A_GALTestSearchResults,e)
}}}
this.getForm().parent.goPage(ZaNewDomainXWizard.GAL_TEST_RESULT_STEP)
};
ZaNewDomainXWizard.onAuthMechChange=function(o,t,e){
this.setInstanceValue(o);
if(o==ZaDomain.AuthMech_ad){
if(!e.getInstance().attrs[ZaDomain.A_AuthADDomainName]){
e.getInstance().attrs[ZaDomain.A_AuthADDomainName]=e.getInstance().attrs[ZaDomain.A_domainName]
}}};
ZaNewDomainXWizard.onCOSChanged=function(n,t,e){
if(ZaItem.ID_PATTERN.test(n)){
this.setInstanceValue(n)
}else{
var o=ZaCos.getCosByName(n,e.parent._app);
if(o){
n=o.id
}}
this.setInstanceValue(n);
return n
};
ZaNewDomainXWizard.testAuthSettings=function(){
var e=this.getInstance();
if(e.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
this.getModel().setInstanceValue(e,ZaDomain.A_AuthLdapUserDn,"%u@"+e.attrs[ZaDomain.A_AuthADDomainName])
}
var t=new AjxCallback(this,ZaNewDomainXWizard.checkAuthCallBack);
ZaDomain.testAuthSettings(e,t)
};
ZaNewDomainXWizard.checkAuthCallBack=function(t){
if(!t){
return
}
var e=this.getInstance();
if(t.isException()){
this.getModel().setInstanceValue(e,ZaDomain.A_AuthTestResultCode,t.getException().code);
this.getModel().setInstanceValue(e,ZaDomain.A_AuthTestMessage,t.getException().detail+"\n"+t.getException().msg)
}else{
var o=t.getResponse().Body.CheckAuthConfigResponse;
this.getModel().setInstanceValue(e,ZaDomain.A_AuthTestResultCode,o.code[0]._content);
if(e[ZaDomain.A_AuthTestResultCode]!=ZaDomain.Check_OK){
this.getModel().setInstanceValue(e,ZaDomain.A_AuthTestMessage,o.message[0]._content);
if(o.bindDn!=null){
this.getModel().setInstanceValue(e,ZaDomain.A_AuthComputedBindDn,o.bindDn[0]._content)
}else{
this.getModel().setInstanceValue(e,ZaDomain.A_AuthComputedBindDn,"")
}}}
this.getForm().parent.goPage(ZaNewDomainXWizard.AUTH_TEST_RESULT_STEP)
};
ZaNewDomainXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this._button[DwtWizardDialog.NEXT_BUTTON].setText(AjxMsg._next);
if(this._containedObject.attrs[ZaDomain.A_domainName]){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}else{
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
};
ZaNewDomainXWizard.prototype.goPrev=function(){
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.AUTH_MODE_STEP){
this.goPage(ZaNewDomainXWizard.AUTH_URL_STEP);
this.changeButtonStateForStep(ZaNewDomainXWizard.AUTH_URL_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.AUTH_URL_STEP&&this._containedObject.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_internal){
this.goPage(ZaNewDomainXWizard.GALMODE_STEP);
this.changeButtonStateForStep(ZaNewDomainXWizard.GALMODE_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP){
if(this._containedObject.attrs[ZaDomain.A_GALSyncUseGALSearch]=="TRUE"){
this.goPage(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1);
this.changeButtonStateForStep(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1)
}else{
this.goPage(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2);
this.changeButtonStateForStep(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2)
}}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.VHOST_STEP){
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
this.goPage(ZaNewDomainXWizard.AUTH_MODE_STEP)
}else{
this.goPage(ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP)
}}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.CONFIG_COMPLETE_STEP){
this.goPage(ZaNewDomainXWizard.FEATURE_STEP);
this.changeButtonStateForStep(ZaNewDomainXWizard.FEATURE_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP){
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
this.goPage(ZaNewDomainXWizard.AUTH_MODE_STEP)
}else{
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
this.goPage(ZaNewDomainXWizard.AUTH_MODE_STEP)
}else{
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ldap){
this.goPage(ZaNewDomainXWizard.AUTH_CONFIG_STEP_2)
}}}}else{
this.changeButtonStateForStep(this._containedObject[ZaModel.currentStep]-1);
this.goPage(this._containedObject[ZaModel.currentStep]-1)
}}}}}}};
ZaNewDomainXWizard.prototype.goNext=function(){
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GALMODE_STEP){
if(!this.checkGALAccount()){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_CREATE_GAL_ACCOUNT);
return
}
if(this._containedObject.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal){
if(!this._containedObject.attrs[ZaDomain.A_GalLdapFilter]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_SEARCH_FILTER_REQUIRED);
return
}
if(!this._containedObject.attrs[ZaDomain.A_GalLdapURL]||this._containedObject.attrs[ZaDomain.A_GalLdapURL].length<1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_LDAP_URL_REQUIRED);
return
}}}
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GENERAL_STEP){
this._containedObject.attrs[ZaDomain.A_AuthADDomainName]=this._containedObject.attrs[ZaDomain.A_domainName];
this.changeButtonStateForStep(ZaNewDomainXWizard.GALMODE_STEP);
this.goPage(ZaNewDomainXWizard.GALMODE_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GALMODE_STEP&&this._containedObject.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_internal){
this.changeButtonStateForStep(ZaNewDomainXWizard.AUTH_URL_STEP);
this.goPage(ZaNewDomainXWizard.AUTH_URL_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GAL_CONFIG_STEP_2){
if(this._containedObject.attrs[ZaDomain.A_UseBindPassword]=="FALSE"){
this._containedObject.attrs[ZaDomain.A_GalLdapBindPassword]=null;
this._containedObject.attrs[ZaDomain.A_GalLdapBindPasswordConfirm]=null;
this._containedObject.attrs[ZaDomain.A_GalLdapBindDn]=null
}
if(this._containedObject.attrs[ZaDomain.A_GalLdapBindPassword]!=this._containedObject.attrs[ZaDomain.A_GalLdapBindPasswordConfirm]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}
this.goPage(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1);
this.changeButtonStateForStep(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1){
if(this._containedObject.attrs[ZaDomain.A_GALSyncUseGALSearch]=="FALSE"){
this.goPage(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2);
this.changeButtonStateForStep(ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2)
}else{
this.goPage(ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP);
this.changeButtonStateForStep(ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP)
}}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP){
this._localXForm.setInstanceValue(ZaDomain.Check_SKIPPED,ZaDomain.A_GALSearchTestResultCode);
this.goPage(ZaNewDomainXWizard.GAL_TEST_RESULT_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.SYNC_CONFIG_SUM_STEP){
this._localXForm.setInstanceValue(ZaDomain.Check_SKIPPED,ZaDomain.A_GALSyncTestResultCode);
this.goPage(ZaNewDomainXWizard.SYNC_TEST_RESULT_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2){
if(this._containedObject.attrs[ZaDomain.A_SyncUseBindPassword]=="FALSE"){
this._containedObject.attrs[ZaDomain.A_zimbraGalSyncLdapBindPassword]=null;
this._containedObject.attrs[ZaDomain.A_GalSyncLdapBindPasswordConfirm]=null;
this._containedObject.attrs[ZaDomain.A_zimbraGalSyncLdapBindDn]=null
}
if(this._containedObject.attrs[ZaDomain.A_zimbraGalSyncLdapBindPassword]!=this._containedObject.attrs[ZaDomain.A_GalSyncLdapBindPasswordConfirm]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}
this.goPage(ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.AUTH_MODE_STEP){
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
this.goPage(ZaNewDomainXWizard.VHOST_STEP);
this.changeButtonStateForStep(ZaNewDomainXWizard.VHOST_STEP)
}else{
if(!this._containedObject.attrs[ZaDomain.A_AuthLdapURL]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_LDAP_URL_REQUIRED);
return false
}
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
var e=this._containedObject.attrs[ZaDomain.A_AuthLdapURL].join(" ");
if(this._containedObject.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]=="TRUE"){
if(e.indexOf("ldaps://")>-1){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.Domain_WarningStartTLSIgnored)
}}
this.goPage(ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP);
this.changeButtonStateForStep(ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP)
}else{
this.goPage(ZaNewDomainXWizard.AUTH_CONFIG_STEP_2);
this.changeButtonStateForStep(ZaNewDomainXWizard.AUTH_CONFIG_STEP_2)
}}}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.AUTH_CONFIG_STEP_2){
if(this._containedObject[ZaDomain.A_AuthUseBindPassword]=="FALSE"){
this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindDn]=null;
this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindPassword]=null;
this._containedObject[ZaDomain.A_AuthLdapSearchBindPasswordConfirm]=null
}
if(this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindPassword]!=this._containedObject[ZaDomain.A_AuthLdapSearchBindPasswordConfirm]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}
this.goPage(ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP){
this._localXForm.setInstanceValue(ZaDomain.Check_SKIPPED,ZaDomain.A_AuthTestResultCode);
this.goPage(ZaNewDomainXWizard.AUTH_TEST_RESULT_STEP)
}else{
this.goPage(this._containedObject[ZaModel.currentStep]+1);
this.changeButtonStateForStep(this._containedObject[ZaModel.currentStep])
}}}}}}}}}}};
ZaNewDomainXWizard.getGalSyncLdapFilterEnabled=function(){
var t=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_GALSyncUseGALSearch);
var e=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_GALSyncServerType);
return(t=="FALSE"&&e=="ldap")
};
ZaNewDomainXWizard.prototype.checkGALAccount=function(){
var t=this._containedObject[ZaDomain.A2_create_gal_acc]=="TRUE";
if(!t){
return true
}
var e=this._containedObject[ZaDomain.A2_gal_sync_accounts_set];
var s=false;
var n;
for(var o in e){
n=e[o];
if(!n[ZaDomain.A2_new_gal_sync_account_name]||!n[ZaDomain.A_mailHost]){
continue
}
if((this._containedObject.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_internal||this._containedObject.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_both)&&n[ZaDomain.A2_new_internal_gal_ds_name]){
s=true;
break
}
if(this._containedObject.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal&&n[ZaDomain.A2_new_external_gal_ds_name]){
s=true;
break
}}
return s
};
ZaNewDomainXWizard.getGalSyncConfigSeparate=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_GALSyncUseGALSearch);
return(e=="FALSE")
};
ZaNewDomainXWizard.isDomainModeNotInternal=function(){
return(this.getInstanceValue(ZaDomain.A_zimbraGalMode)!=ZaDomain.GAL_Mode_internal)
};
ZaNewDomainXWizard.isDomainModeNotExternal=function(){
return(this.getInstanceValue(ZaDomain.A_zimbraGalMode)!=ZaDomain.GAL_Mode_external)
};
ZaNewDomainXWizard.isAuthMechNotZimbra=function(){
return(this.getInstanceValue(ZaDomain.A_AuthMech)!=ZaDomain.AuthMech_zimbra)
};
ZaNewDomainXWizard.myXFormModifier=function(o,e){
var n=new Array();
n[0]=new ZaListHeaderItem("email",ZaMsg.ALV_Name_col,null,"116px",null,"email",true,true);
n[1]=new ZaListHeaderItem("fullName",ZaMsg.ALV_FullName_col,null,"auto",null,"fullName",true,true);
var t={};
t[ZaNewDomainXWizard.GAL_CONFIG_STEP_2]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2]={
checks:[[ZaNewDomainXWizard.isDomainModeNotInternal],[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],sources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch]};
t[ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaNewDomainXWizard.GAL_TEST_RESULT_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaNewDomainXWizard.SYNC_CONFIG_SUM_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaNewDomainXWizard.SYNC_TEST_RESULT_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaNewDomainXWizard.AUTH_CONFIG_STEP_2]={
checks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],sources:[ZaDomain.A_AuthMech]};
t[ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP]={
checks:[ZaNewDomainXWizard.isAuthMechNotZimbra],sources:[ZaDomain.A_AuthMech]};
t[ZaNewDomainXWizard.AUTH_TEST_RESULT_STEP]={
checks:[ZaNewDomainXWizard.isAuthMechNotZimbra],sources:[ZaDomain.A_AuthMech]};
o.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,cssStyle:"white-space: normal",ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep],labelVisibility:t}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:"100%",valign:_TOP_,cssStyle:"white-space: normal",items:[{
type:_CASE_,caseKey:ZaNewDomainXWizard.GENERAL_STEP,colSizes:["200px","*"],numCols:2,items:[{
type:_ZAWIZ_TOP_GROUPER_,colSpan:"*",label:ZaMsg.TABT_GeneralPage,items:[{
ref:ZaDomain.A_domainName,type:_TEXTFIELD_,label:ZaMsg.Domain_DomainName,labelLocation:_LEFT_,required:true,width:200}
,{
ref:ZaDomain.A_zimbraPublicServiceHostname,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraPublicServiceHostname,labelLocation:_LEFT_,width:200}
,{
ref:ZaDomain.A_zimbraPublicServiceProtocol,type:_OSELECT1_,choices:ZaDomain.protocolChoices,label:ZaMsg.Domain_zimbraPublicServiceProtocol,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_zimbraPublicServicePort,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraPublicServicePort,labelLocation:_LEFT_,width:100}
,{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0px",style:DwtAlert.INFO,iconVisible:true,content:ZaMsg.Domain_InboundSMTPNote,colSpan:"*"}
,{
type:_GROUP_,colSpan:"2",colSizes:["*"],numCols:1,width:"100%",id:"dns_check_group",items:[{
ref:ZaDomain.A_zimbraDNSCheckHostname,type:_SUPERWIZ_TEXTFIELD_,textFieldWidth:200,colSizes:["200px","250px","*"],label:null,txtBoxLabel:ZaMsg.Domain_zimbraDNSCheckHostname,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
]}
,{
ref:ZaDomain.A_description,type:_TEXTFIELD_,label:ZaMsg.NAD_Description,labelLocation:_LEFT_,width:200}
,{
ref:ZaDomain.A_domainDefaultCOSId,type:_INPUT_,label:ZaMsg.Domain_DefaultCOS,onChange:ZaNewDomainXWizard.onCOSChanged,getDisplayValue:function(r){
this.createDataList(ZaApp.getInstance().getCosListName());
if(r){
var s=ZaCos.getCosById(r);
return s&&s.name
}}}
,{
ref:ZaDomain.A_zimbraDomainStatus,type:_OSELECT1_,msgName:ZaMsg.NAD_DomainStatus,label:ZaMsg.LBL_zimbraDomainStatus,labelLocation:_LEFT_,choices:ZaDomain.domainStatusChoices}
,{
ref:ZaDomain.A_notes,type:_TEXTAREA_,label:ZaMsg.NAD_Notes,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top",width:250}
,{
ref:ZaDomain.A_zimbraHelpAdminURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraHelpAdminURL,msgName:ZaMsg.Domain_zimbraHelpAdminURL,labelLocation:_LEFT_,width:200}
,{
ref:ZaDomain.A_zimbraHelpDelegatedURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraHelpDelegatedURL,msgName:ZaMsg.Domain_zimbraHelpDelegatedURL,labelLocation:_LEFT_,width:200}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.GALMODE_STEP,numCols:2,colSizes:["220px","450px"],items:[{
ref:ZaDomain.A_zimbraGalMode,type:_OSELECT1_,label:ZaMsg.Domain_GalMode,labelLocation:_LEFT_,choices:this.GALModes,onChange:ZaNewDomainXWizard.onGalModeChange}
,{
ref:ZaDomain.A_zimbraGalMaxResults,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraGalMaxResults,msgName:ZaMsg.MSG_zimbraGalMaxResults,labelLocation:_LEFT_,width:100}
,{
ref:ZaDomain.A2_create_gal_acc,type:_CHECKBOX_,label:ZaMsg.Domain_CreateGALSyncAccts,subLabel:"",labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,labelWrap:true,enableDisableChecks:[],visibilityChecks:[]}
,{
ref:ZaDomain.A2_gal_sync_accounts_set,type:_COLLAB_SELECT_,label:null,repeatInstance:"",showAddButton:true,showRemoveButton:true,visibilityChangeEventSources:[ZaDomain.A2_create_gal_acc],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"],[function(){
if(this.removeButton){
this.removeButton.visibilityChecks=[];
this.removeButton.visibilityChecks.push(function(){
return(this.getParentItem().getInstanceCount()>1)
}
)
}
if(this.getInstanceValue().length==0){
this.addRowButtonClicked(this.getParentItem().instanceNum)
}
return true
}
]],enableDisableChecks:[],colSpan:2,addButtonLabel:ZaMsg.Domain_GAL_Add,addButtonWidth:220,number:0,removeButtonLabel:ZaMsg.Domain_GAL_Remove,showAddOnNextRow:true,showRemoveNextRow:false,items:[{
type:_GROUP_,ref:".",numCols:1,width:"100%",visibilityChangeEventSources:[ZaDomain.A2_gal_sync_accounts_set],visibilityChecks:[function(){
return((this.instanceNum==0)||(this.instanceNum<this.getNumberToShow())||(this.instanceNum<this.getInstanceCount()))
}
],items:[{
type:_SPACER_,colSpan:"*"}
,{
type:_GROUP_,ref:".",numCols:2,colSizes:["220px","100%"],width:"100%",enableDisableChecks:[],visibilityChangeEventSources:[ZaDomain.A2_gal_sync_accounts_set],visibilityChecks:[function(){
var s=this.getParentItem().instanceNum;
return((s<this.getNumberToShow())||(s<this.getInstanceCount()))
}
],items:[{
type:_GROUP_,label:ZaMsg.Domain_GalSyncAccount,numCols:3,colSizes:["130px","25px","auto"],colSpan:"1",ref:".",items:[{
ref:ZaDomain.A2_new_gal_sync_account_name,width:130,label:null,type:_TEXTFIELD_,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_OUTPUT_,value:"@",visibilityChecks:[],enableDisableChecks:[]}
,{
type:_OUTPUT_,refPath:ZaDomain.A_domainName,label:null,align:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]],required:true}
,{
ref:ZaDomain.A_mailHost,type:_OSELECT1_,label:ZaMsg.NAD_MailServer,choices:ZaApp.getInstance().getServerListChoices(),colSelect:true,required:true,width:300,enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]],visibilityChecks:[]}
,{
ref:ZaDomain.A2_new_internal_gal_ds_name,label:ZaMsg.Domain_InternalGALDSName,type:_TEXTFIELD_,required:true,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotExternal],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]]}
,{
ref:ZaDomain.A2_new_internal_gal_polling_interval,type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_internal,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_internal,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotExternal],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]]}
,{
ref:ZaDomain.A2_new_external_gal_ds_name,label:ZaMsg.Domain_ExternalGALDSName,type:_TEXTFIELD_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]]}
,{
ref:ZaDomain.A2_new_external_gal_polling_interval,type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_external,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_external,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]]}
]}
]}
]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["220px","430px"],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal],cssStyle:"overflow:auto",items:[{
ref:ZaDomain.A_GALServerType,type:_OSELECT1_,label:ZaMsg.Domain_GALServerType,labelLocation:_LEFT_,choices:this.GALServerTypes,onChange:ZaNewDomainXWizard.onGALServerTypeChange,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_GROUP_,numCols:6,colSpan:6,label:"   ",labelLocation:_LEFT_,items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerPort,width:"40px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALUseSSL,width:"40px"}
]}
,{
ref:ZaDomain.A_GalLdapURL,type:_REPEAT_,label:ZaMsg.Domain_GalLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"3269",ldapPort:"3268",labelLocation:_NONE_,enableDisableChecks:[],visibilityChecks:[]}
]}
,{
ref:ZaDomain.A_GalLdapFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],enableDisableChangeEventSources:[ZaDomain.A_GALServerType]}
,{
ref:ZaDomain.A_zimbraGalAutoCompleteLdapFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_zimbraGalAutoCompleteLdapFilter,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],enableDisableChangeEventSources:[ZaDomain.A_GALServerType],bmolsnr:true}
,{
ref:ZaDomain.A_GalLdapSearchBase,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,bmolsnr:true}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.GAL_CONFIG_STEP_2,colSizes:["220px","430px"],numCols:2,visibilityChangeEventSources:[ZaModel.currentStep],visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isDomainModeNotInternal],items:[{
ref:ZaDomain.A_UseBindPassword,type:_CHECKBOX_,subLabel:"",label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,enableDisableChecks:[],visibilityChecks:[]}
,{
ref:ZaDomain.A_GalLdapBindDn,type:_TEXTFIELD_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,subLabel:"",enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_UseBindPassword]}
,{
ref:ZaDomain.A_GalLdapBindPassword,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPassword,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_UseBindPassword]}
,{
ref:ZaDomain.A_GalLdapBindPasswordConfirm,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPasswordConfirm,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"],[ZaItem.hasWritePermission,ZaDomain.A_GalLdapBindPassword]],enableDisableChangeEventSources:[ZaDomain.A_UseBindPassword],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_GalLdapBindPassword]]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_1,numCols:2,colSizes:["220px","430px"],items:[{
ref:ZaDomain.A_GALSyncUseGALSearch,type:_CHECKBOX_,label:ZaMsg.Domain_GALSyncUseGALSearch,subLabel:"",labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,labelWrap:true,onChange:ZaNewDomainXWizard.onGALSyncChange,enableDisableChecks:[],visibilityChecks:[]}
,{
ref:ZaDomain.A_GALSyncServerType,type:_OSELECT1_,label:ZaMsg.Domain_GALServerType,labelLocation:_LEFT_,choices:this.GALServerTypes,onChange:ZaNewDomainXWizard.onGALSyncServerTypeChange,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch],enableDisableChecks:[],visibilityChecks:[]}
,{
type:_GROUP_,numCols:6,colSpan:6,label:"   ",labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch],items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerPort,width:"40px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALUseSSL,width:"60px"}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapURL,type:_REPEAT_,label:ZaMsg.LBL_Domain_GalLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncServerType,ZaDomain.GAL_ServerType_ad]],visibilityChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType],addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"3269",ldapPort:"3268",labelLocation:_NONE_,enableDisableChecks:[],visibilityChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapURL,type:_REPEAT_,label:ZaMsg.LBL_Domain_GalLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncServerType,ZaDomain.GAL_ServerType_ldap]],visibilityChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType],addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"636",ldapPort:"389",labelLocation:_NONE_,enableDisableChecks:[],visibilityChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,textWrapping:"soft",enableDisableChecks:[ZaNewDomainXWizard.getGalSyncLdapFilterEnabled],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapSearchBase,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,textWrapping:"soft",enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch]}
]}
,{
type:_CASE_,numCols:2,colSizes:["220px","430px"],caseKey:ZaNewDomainXWizard.GAL_SYNC_CONFIG_STEP_2,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaModel.currentStep],items:[{
ref:ZaDomain.A_SyncUseBindPassword,type:_CHECKBOX_,subLabel:"",label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,enableDisableChecks:[],visibilityChecks:[]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapBindDn,type:_TEXTFIELD_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_SyncUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_SyncUseBindPassword]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapBindPassword,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPassword,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_SyncUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_SyncUseBindPassword]}
,{
ref:ZaDomain.A_GalSyncLdapBindPasswordConfirm,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPasswordConfirm,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_SyncUseBindPassword,"TRUE"],[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalSyncLdapBindPassword]],enableDisableChangeEventSources:[ZaDomain.A_SyncUseBindPassword],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalSyncLdapBindPassword]]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.GAL_CONFIG_SUM_STEP,numCols:2,colSizes:["220px","430px"],items:[{
type:_GROUP_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A2_isTestingGAL],useParentTable:false,numCols:2,colSpan:2,width:"100%",colSizes:["220px","430px"],items:[{
ref:ZaDomain.A_zimbraGalMode,type:_OUTPUT_,label:ZaMsg.Domain_GalMode,choices:this.GALModes,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
,{
ref:ZaDomain.A_zimbraGalMaxResults,type:_OUTPUT_,label:ZaMsg.LBL_zimbraGalMaxResults,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
,{
ref:ZaDomain.A_GALServerType,type:_OUTPUT_,label:ZaMsg.Domain_GALServerType,choices:this.GALServerTypes,labelLocation:_LEFT_,bmolsnr:true}
,{
ref:ZaDomain.A_GalLdapURL,type:_REPEAT_,label:ZaMsg.Domain_GalLdapURL+":",labelLocation:_LEFT_,showAddButton:false,bmolsnr:true,showRemoveButton:false,items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_,bmolsnr:true}
]}
,{
ref:ZaDomain.A_GalLdapFilter,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,required:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],visibilityChangeEventSources:[ZaDomain.GAL_ServerType_ldap],bmolsnr:true}
,{
ref:ZaDomain.A_GalLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,bmolsnr:true}
,{
ref:ZaDomain.A_UseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",bmolsnr:true}
,{
ref:ZaDomain.A_GalLdapBindDn,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]],visibilityChangeEventSources:[ZaDomain.A_UseBindPassword],bmolsnr:true}
,{
ref:ZaDomain.A_GALSampleQuery,type:_INPUT_,label:ZaMsg.Domain_GALSampleSearchName,labelLocation:_LEFT_,labelWrap:true,cssStyle:"width:100px;",bmolsnr:true,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,enableDisableChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSampleQuery," "],[XForm.checkInstanceValueNotEmty,ZaDomain.A_GALSampleQuery]],enableDisableChangeEventSources:[ZaDomain.A_GALSampleQuery],onActivate:"ZaNewDomainXWizard.testGALSettings.call(this)",label:ZaMsg.Domain_GALTestSettings,visibilityChecks:[],valign:_BOTTOM_,width:"100px"}
]}
,{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALTestingInProgress,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.INFORMATION,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,1]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.GAL_TEST_RESULT_STEP,numCols:2,colSizes:["220px","430px"],items:[{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_GALSearchTestResultCode],numCols:2,width:"100%",colSpan:"2",items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSearchTestSuccessful,ref:null,colSpan:"2",iconVisible:false,align:_CENTER_,style:DwtAlert.INFORMATION}
,{
type:_OUTPUT_,value:ZaMsg.Domain_GALSearchResult,align:_CENTER_,colSpan:2,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A_GALTestSearchResults]]}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_,colSpan:"*"}
,{
ref:ZaDomain.A_GALTestSearchResults,type:_DWT_LIST_,height:"140px",width:"260px",colSpan:2,cssClass:"DLSource",forceUpdate:true,widgetClass:ZaGalObjMiniListView,headerList:n,hideHeader:true}
]}
,{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_OK],[XForm.checkInstanceValueNot,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSearchTestResultCode],numCols:2,width:"100%",colSpan:"2",items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSearchTestFailed,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING}
,{
type:_OUTPUT_,ref:ZaDomain.A_GALSearchTestResultCode,label:ZaMsg.Domain_GALTestResult,choices:this.TestResultChoices}
,{
type:_TEXTAREA_,ref:ZaDomain.A_GALSearchTestMessage,label:ZaMsg.Domain_GALTestMessage,height:"200px",width:"380px"}
]}
,{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSearchTestSkipped,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSearchTestResultCode]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.SYNC_CONFIG_SUM_STEP,items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestingInProgress,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.INFORMATION,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingSync,1]],visibilityChangeEventSources:[ZaDomain.A2_isTestingSync]}
,{
type:_GROUP_,useParentTable:false,numCols:2,colSpan:2,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingSync,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingSync],items:[{
ref:ZaDomain.A_zimbraGalMode,type:_OUTPUT_,label:ZaMsg.Domain_GalMode,choices:this.GALModes,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
,{
ref:ZaDomain.A_GALSyncUseGALSearch,type:_OUTPUT_,label:ZaMsg.Domain_GALSyncUseGALSearch,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",bmolsnr:true}
,{
ref:ZaDomain.A_GALSyncServerType,type:_OUTPUT_,label:ZaMsg.Domain_GALServerType,choices:this.GALServerTypes,labelLocation:_LEFT_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],bmolsnr:true}
,{
ref:ZaDomain.A_zimbraGalSyncLdapURL,type:_REPEAT_,label:ZaMsg.Domain_GalLdapURL+":",labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,bmolsnr:true,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_,bmolsnr:true}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapFilter,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,required:true,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"],[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALServerType],bmolsnr:true}
,{
ref:ZaDomain.A_zimbraGalSyncLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],bmolsnr:true}
,{
ref:ZaDomain.A_SyncUseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],bmolsnr:true}
,{
ref:ZaDomain.A_zimbraGalSyncLdapBindDn,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"],[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_UseBindPassword],bmolsnr:true}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,onActivate:"ZaNewDomainXWizard.testSyncSettings.call(this)",label:ZaMsg.Domain_GALTestSettings,enableDisableChecks:[],visibilityChecks:[],valign:_BOTTOM_,width:"100px"}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.SYNC_TEST_RESULT_STEP,items:[{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode],numCols:2,items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestSuccessful,ref:null,colSpan:"*",iconVisible:false,align:_CENTER_,style:DwtAlert.INFORMATION}
]}
,{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode],numCols:2,items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestFailed,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
,{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestSkipped,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
,{
type:_OUTPUT_,ref:ZaDomain.A_GALSyncTestResultCode,label:ZaMsg.Domain_GALTestResult,choices:this.TestResultChoices,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
,{
type:_TEXTAREA_,ref:ZaDomain.A_GALSyncTestMessage,label:ZaMsg.Domain_GALTestMessage,height:"200px",width:"380px",visibilityChecks:[function(){
return((this.getInstanceValue(ZaDomain.A_GALSyncTestResultCode)!=ZaDomain.Check_SKIPPED)&&(this.getInstanceValue(ZaDomain.A_GALSyncTestResultCode)!=ZaDomain.Check_OK))
}
],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.AUTH_URL_STEP,numCols:2,colSizes:["220px","430px"],items:[{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.Domain_URLSetting,colSpan:"*",items:[{
ref:ZaDomain.A_zimbraAdminConsoleLoginURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraAdminConsoleLoginURL,width:250}
,{
ref:ZaDomain.A_zimbraAdminConsoleLogoutURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraAdminConsoleLogoutURL,width:250}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_AUTH_ClientConfigure,colSpan:"*",items:[{
ref:ZaDomain.A_zimbraMailSSLClientCertPrincipalMap,labelCssStyle:"vertical-align:top",type:_TEXTAREA_,label:ZaMsg.NAD_zimbraMailSSLClientCertPrincipalMap,width:250}
,{
type:_DWT_ALERT_,cssClass:"DwtTabTable",containerCssStyle:"padding-bottom:0px",style:DwtAlert.WARNING,iconVisible:false,content:ZaMsg.Alert_Ngnix,id:"xform_header_ngnix"}
,{
type:_SPACER_,height:10}
,{
ref:ZaDomain.A_zimbraReverseProxyClientCertMode,type:_SUPER_SELECT1_,colSizes:["250px","*"],label:ZaMsg.NAD_zimbraReverseProxyClientCertMode,labelLocation:_LEFT_,resetToSuperLabel:ZaMsg.NAD_ResetToCOS}
,{
ref:ZaDomain.A_zimbraReverseProxyClientCertCA,type:_TEXTAREA_,label:ZaMsg.NAD_zimbraReverseProxyClientCertCA,width:400}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_WEBCLIENT_Configure,colSpan:"*",items:[{
ref:ZaDomain.A_zimbraWebClientLoginURL,useParentTable:false,colSpan:2,type:_SUPERWIZ_TEXTFIELD_,textFieldWidth:"250px",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,msgName:ZaMsg.LBL_zimbraWebClientLoginURL,txtBoxLabel:ZaMsg.LBL_zimbraWebClientLoginURL}
,{
ref:ZaDomain.A_zimbraWebClientLogoutURL,useParentTable:false,colSpan:2,type:_SUPERWIZ_TEXTFIELD_,textFieldWidth:"250px",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,msgName:ZaMsg.LBL_zimbraWebClientLogoutURL,txtBoxLabel:ZaMsg.LBL_zimbraWebClientLogoutURL}
,{
ref:ZaDomain.A_zimbraWebClientLoginURLAllowedUA,label:ZaMsg.LBL_zimbraWebClientLoginURLAllowedUA,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["250px","150px"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
]}
,{
ref:ZaDomain.A_zimbraWebClientLogoutURLAllowedUA,label:ZaMsg.LBL_zimbraWebClientLogoutURLAllowedUA,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["250px","150px"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
]}
,{
ref:ZaDomain.A_zimbraWebClientLoginURLAllowedIP,label:ZaMsg.LBL_zimbraWebClientLoginURLAllowedIP,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["250px","150px"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
]}
,{
ref:ZaDomain.A_zimbraWebClientLogoutURLAllowedIP,label:ZaMsg.LBL_zimbraWebClientLogoutURLAllowedIP,type:_SUPER_REPEAT_,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,repeatInstance:"",colSizes:["250px","150px"],addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,repeatItems:[{
ref:".",type:_TEXTFIELD_,width:"150px"}
]}
,{
ref:ZaDomain.A_zimbraForceClearCookies,useParentTable:false,colSpan:2,type:_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,msgName:ZaMsg.MSG_zimbraForceClearCookies,label:ZaMsg.LBL_zimbraForceClearCookies,labelLocation:_LEFT_}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.AUTH_MODE_STEP,numCols:2,colSizes:["220px","450px"],items:[{
type:_OSELECT1_,label:ZaMsg.Domain_AuthMech,choices:this.AuthMechs,ref:ZaDomain.A_AuthMech,onChange:ZaNewDomainXWizard.onAuthMechChange}
,{
type:_GROUP_,numCols:2,colSizes:["220px","auto"],colSpan:2,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthADDomainName,type:_TEXTFIELD_,label:ZaMsg.Domain_AuthADDomainName,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_GROUP_,numCols:6,label:"   ",labelLocation:_LEFT_,items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADServerPort,width:"40px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADUseSSL,width:"40px"}
]}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.Domain_AddURL,showAddOnNextRow:true,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,items:[{
ref:".",type:_LDAPURL_,label:null,labelLocation:_NONE_,ldapSSLPort:"3269",ldapPort:"3268",visibilityChecks:[],enableDisableChecks:[]}
]}
]}
,{
type:_GROUP_,numCols:2,colSizes:["220px","auto"],colSpan:2,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
type:_GROUP_,numCols:6,label:"   ",labelLocation:_LEFT_,items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerPort,width:"40px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPUseSSL,width:"40px"}
]}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.Domain_AddURL,showAddOnNextRow:true,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"636",ldapPort:"389",labelLocation:_NONE_,visibilityChecks:[],enableDisableChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_CHECKBOX_,label:ZaMsg.Domain_AuthLdapStartTlsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaDomain.A_AuthLdapSearchFilter,type:_TEXTAREA_,width:"30em",height:100,label:ZaMsg.Domain_AuthLdapFilter,labelLocation:_LEFT_,textWrapping:"soft"}
,{
ref:ZaDomain.A_AuthLdapSearchBase,type:_TEXTAREA_,width:"30em",height:50,label:ZaMsg.Domain_AuthLdapSearchBase,labelLocation:_LEFT_,textWrapping:"soft"}
,{
type:_OUTPUT_,value:ZaMsg.NAD_DomainsAuthStr,colSpan:2}
]}
]}
,{
type:_CASE_,numCols:2,colSizes:["220px","auto"],caseKey:ZaNewDomainXWizard.AUTH_CONFIG_STEP_2,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],items:[{
ref:ZaDomain.A_AuthUseBindPassword,type:_CHECKBOX_,subLabel:"",label:ZaMsg.Domain_AuthUseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBindDn,type:_TEXTFIELD_,label:ZaMsg.Domain_AuthLdapBindDn,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword]}
,{
ref:ZaDomain.A_AuthLdapSearchBindPassword,type:_SECRET_,label:ZaMsg.Domain_AuthLdapBindPassword,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword]}
,{
ref:ZaDomain.A_AuthLdapSearchBindPasswordConfirm,type:_SECRET_,label:ZaMsg.Domain_AuthLdapBindPasswordConfirm,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"],[ZaItem.hasWritePermission,ZaDomain.A_AuthLdapSearchBindPassword]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_AuthLdapSearchBindPassword]]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.AUTH_CONFIG_SUM_STEP,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isAuthMechNotZimbra],items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_AuthTestingInProgress,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.INFORMATION,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingAuth,1]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
,{
type:_GROUP_,numCols:2,colSizes:["220px","430px"],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingAuth,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingAuth],items:[{
type:_OUTPUT_,value:ZaMsg.Domain_Auth_ConfigSummary,align:_CENTER_,colSpan:"*"}
,{
type:_SPACER_,height:10}
,{
ref:ZaDomain.A_AuthMech,type:_OUTPUT_,label:ZaMsg.Domain_AuthMech,choices:this.AuthMechs,alignment:_LEFT_}
,{
type:_GROUP_,useParentTable:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthADDomainName,type:_OUTPUT_,label:ZaMsg.Domain_AuthADDomainName,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_}
]}
]}
,{
type:_GROUP_,useParentTable:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_}
]}
,{
ref:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapStartTlsEnabled,labelLocation:_LEFT_,choices:ZaModel.BOOLEAN_CHOICES}
,{
ref:ZaDomain.A_AuthLdapSearchFilter,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapFilter,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapSearchBase,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthUseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_AuthUseBindPassword,labelLocation:_LEFT_,choices:ZaModel.BOOLEAN_CHOICES}
,{
ref:ZaDomain.A_AuthLdapSearchBindDn,type:_TEXTFIELD_,label:ZaMsg.Domain_AuthLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],visibilityChangeEventSources:[ZaDomain.A_AuthUseBindPassword]}
]}
,{
type:_SPACER_,height:10}
,{
type:_OUTPUT_,value:ZaMsg.Domain_AuthProvideLoginPwd,align:_CENTER_,colSpan:"*"}
,{
type:_TEXTFIELD_,label:ZaMsg.LBL_Domain_AuthTestUserName,ref:ZaDomain.A_AuthTestUserName,alignment:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_SECRET_,label:ZaMsg.LBL_Domain_AuthTestPassword,ref:ZaDomain.A_AuthTestPassword,alignment:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,onActivate:"ZaNewDomainXWizard.testAuthSettings.call(this)",label:ZaMsg.Domain_GALTestSettings,enableDisableChecks:[],visibilityChecks:[],valign:_BOTTOM_,width:"100px"}
]}
]}
,{
type:_CASE_,numCols:1,caseKey:ZaNewDomainXWizard.AUTH_TEST_RESULT_STEP,colSizes:["380px","290px"],visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isAuthMechNotZimbra],visibilityChangeEventSources:[ZaModel.currentStep],items:[{
type:_DWT_ALERT_,colSpan:"2",iconVisible:false,align:_CENTER_,style:DwtAlert.INFORMATION,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_AuthTestResultCode],content:ZaMsg.Domain_AuthTestSuccessful,alignment:_CENTER_}
,{
type:_DWT_ALERT_,content:ZaMsg.Domain_AuthTestSkipped,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_AuthTestResultCode]}
,{
type:_GROUP_,visibilityChangeEventSources:[ZaDomain.A_AuthTestResultCode],visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_AuthTestResultCode,ZaDomain.Check_OK],[XForm.checkInstanceValueNot,ZaDomain.A_AuthTestResultCode,ZaDomain.Check_SKIPPED]],items:[{
type:_OUTPUT_,value:ZaMsg.Domain_AuthTestFailed,alignment:_CENTER_,colSpan:2,label:null}
,{
type:_OUTPUT_,ref:ZaDomain.A_AuthTestResultCode,label:ZaMsg.Domain_AuthTestResultCode,choices:this.TestResultChoices,alignment:_LEFT_}
,{
type:_OUTPUT_,ref:ZaDomain.A_AuthComputedBindDn,label:ZaMsg.Domain_AuthComputedBindDn,alignment:_LEFT_,visibilityChangeEventSources:[ZaDomain.A_AuthMech],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]]}
,{
type:_TEXTAREA_,ref:ZaDomain.A_AuthTestMessage,label:ZaMsg.Domain_AuthTestMessage,height:150,alignment:_LEFT_,width:"320px"}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.VHOST_STEP,items:[{
type:_DWT_ALERT_,content:null,ref:ZaDomain.A_domainName,getDisplayValue:function(s){
return AjxMessageFormat.format(ZaMsg.Domain_VH_Explanation,s)
}
,iconVisible:false,align:_CENTER_,style:DwtAlert.INFORMATION}
,{
ref:ZaDomain.A_zimbraVirtualHostname,type:_REPEAT_,label:null,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddVirtualHost,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveVirtualHost,cssStyle:"text-align:center",tableCssStyle:"margin-left:auto;margin-right:auto",items:[{
ref:".",type:_TEXTFIELD_,label:null,width:220,visibilityChecks:[],enableDisableChecks:[]}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.FEATURE_STEP,items:[{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraCalendarFeature,items:[{
ref:ZaDomain.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,label:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.ADVANCED_STEP,numCols:1,items:[{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.Domain_BC_ShareConf,items:[{
ref:ZaDomain.A_zimbraBasicAuthRealm,type:_SUPERWIZ_TEXTFIELD_,width:250,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal,txtBoxLabel:ZaMsg.Domain_zimbraBasicAuthRealm}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.Domain_AD_EmailValidate,colSizes:["200px","*"],items:[{
ref:ZaDomain.A_zimbraMailAddressValidationRegex,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_EmailValidate,repeatInstance:"",labelWrap:true,showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddRegex,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveRegex,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:250}
]}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.Domain_QUOTA_Configuration,colSizes:["200px","*"],items:[{
ref:ZaDomain.A_zimbraMailDomainQuota,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainQuota}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuota,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainAggregateQuota}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuotaWarnPercent,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainAggregateQuotaWarnPercent}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuotaWarnEmailRecipient,type:_TEXTFIELD_,label:ZaMsg.LBL_DomainAggregateQuotaWarnEmailRecipient}
,{
ref:ZaDomain.A_zimbraDomainAggregateQuotaPolicy,type:_OSELECT1_,label:ZaMsg.LBL_DomainAggregateQuotaPolicy,labelLocation:_LEFT_}
]}
]}
,{
type:_CASE_,caseKey:ZaNewDomainXWizard.CONFIG_COMPLETE_STEP,items:[{
type:_OUTPUT_,value:ZaMsg.Domain_Config_Complete,cssStyle:"text-align:center"}
]}
]}
]
};
ZaXDialog.XFormModifiers.ZaNewDomainXWizard.push(ZaNewDomainXWizard.myXFormModifier)
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaDomainAliasWizard")){
ZaDomainAliasWizard=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t);
this._containedObject={};
this.initForm(ZaDomain.myXModel,this.getMyXForm());
this._helpURL=ZaDomainAliasWizard.helpURL
};
ZaDomainAliasWizard.prototype=new ZaXDialog;
ZaDomainAliasWizard.prototype.constructor=ZaDomainAliasWizard;
ZaDomainAliasWizard.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/creating_a_domain_alias.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaDomainAliasWizard.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaDomain.A_domainName,type:_TEXTFIELD_,label:ZaMsg.LBL_domainAlias,width:250,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaDomain.A2_zimbraDomainAliasTarget,type:_INPUT_,label:ZaMsg.LBL_targetDomain,getDisplayValue:function(t){
this.createDataList(ZaApp.getInstance().getDomainNameListByType(ZaDomain.domainTypes.local));
return t
}
,onChange:ZaDomainAliasWizard.onTargetDomainChanged}
]}
]};
return e
};
ZaDomainAliasWizard.onTargetDomainChanged=function(e){
this.setInstanceValue(e)
};
ZaDomainAliasEditWizard=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t);
this._containedObject={};
this.initForm(ZaDomain.myXModel,this.getMyXForm());
this._helpURL=ZaDomainAliasEditWizard.helpURL
};
ZaDomainAliasEditWizard.prototype=new ZaXDialog;
ZaDomainAliasEditWizard.prototype.constructor=ZaDomainAliasEditWizard;
ZaDomainAliasEditWizard.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/creating_a_domain_alias.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaDomainAliasEditWizard.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaDomain.A_domainName,type:_OUTPUT_,label:ZaMsg.LBL_domainAlias,width:250,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaDomain.A2_zimbraDomainAliasTarget,type:_INPUT_,label:ZaMsg.LBL_targetDomain,getDisplayValue:function(t){
this.createDataList(ZaApp.getInstance().getDomainNameListByType(ZaDomain.domainTypes.local));
return t
}
,onChange:ZaDomainAliasEditWizard.onTargetDomainChanged}
]}
]};
return e
};
ZaDomainAliasEditWizard.prototype.editDomainAlias=function(r,s){
var n=this._localXForm;
var e=n.getInstance();
if(s){
r.load("id",r.id)
}
var o=r.attrs[ZaDomain.A_domainName];
var t=r.attrs[ZaDomain.A_zimbraMailCatchAllForwardingAddress];
if(t!=null){
t=t.replace("@","")
}
if(!e){
e={}
}
if(!e.attrs){
e.attrs={}
}
e.attrs[ZaDomain.A_domainName]=o;
e[ZaDomain.A2_zimbraDomainAliasTarget]=t;
e.type=ZaItem.DOMAIN;
e.attrs[ZaDomain.A_domainType]=ZaDomain.domainTypes.alias;
e.attrs[ZaDomain.A_zimbraMailCatchAllForwardingAddress]="@"+t;
this.setObject(r);
n.setInstance(e);
this.registerCallback(DwtDialog.OK_BUTTON,ZaDomain.prototype.modifyDomainAlias,r,this._localXForm);
this.popup()
};
ZaDomainAliasEditWizard.onTargetDomainChanged=function(e){
this.setInstanceValue(e)
}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaGALConfigXWizard")){
ZaGALConfigXWizard=function(e,t){
ZaXWizardDialog.call(this,e,null,ZaMsg.NCD_GALConfigTitle,"700px","350px","ZaGALConfigXWizard");
this.TAB_INDEX=0;
ZaGALConfigXWizard.GALMODE_STEP=++this.TAB_INDEX;
ZaGALConfigXWizard.GAL_CONFIG_STEP_2=++this.TAB_INDEX;
ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1=++this.TAB_INDEX;
ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_2=++this.TAB_INDEX;
ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP=++this.TAB_INDEX;
ZaGALConfigXWizard.GAL_TEST_RESULT_STEP=++this.TAB_INDEX;
ZaGALConfigXWizard.SYNC_CONFIG_SUM_STEP=++this.TAB_INDEX;
ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP=++this.TAB_INDEX;
ZaGALConfigXWizard.CONFIG_COMPLETE_STEP=++this.TAB_INDEX;
this.stepChoices=[{
label:ZaMsg.GALMode,value:ZaGALConfigXWizard.GALMODE_STEP}
,{
label:ZaMsg.GALDnConfiguration,value:ZaGALConfigXWizard.GAL_CONFIG_STEP_2}
,{
label:ZaMsg.GALSyncConfiguration,value:ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1}
,{
label:ZaMsg.GALSyncDnConfiguration,value:ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_2}
,{
label:ZaMsg.GALConfigSummary,value:ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP}
,{
label:ZaMsg.GalTestResult,value:ZaGALConfigXWizard.GAL_TEST_RESULT_STEP}
,{
label:ZaMsg.SyncConfigSummary,value:ZaGALConfigXWizard.SYNC_CONFIG_SUM_STEP}
,{
label:ZaMsg.SyncTestResult,value:ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP}
,{
label:ZaMsg.DomainConfigComplete,value:ZaGALConfigXWizard.CONFIG_COMPLETE_STEP}
];
this.GALModes=[{
label:ZaMsg.GALMode_internal,value:ZaDomain.GAL_Mode_internal}
,{
label:ZaMsg.GALMode_external,value:ZaDomain.GAL_Mode_external}
,{
label:ZaMsg.GALMode_both,value:ZaDomain.GAL_Mode_both}
];
this.GALServerTypes=[{
label:ZaMsg.GALServerType_ldap,value:ZaDomain.GAL_ServerType_ldap}
,{
label:ZaMsg.GALServerType_ad,value:ZaDomain.GAL_ServerType_ad}
];
this.initForm(ZaDomain.myXModel,this.getMyXForm(t),null);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaGALConfigXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaGALConfigXWizard.prototype.handleXFormChange));
this.lastErrorStep=0;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/using_the_global_address_list_(gal).htm?locid="+AjxEnv.DEFAULT_LOCALE
};
ZaGALConfigXWizard.prototype=new ZaXWizardDialog;
ZaGALConfigXWizard.prototype.constructor=ZaGALConfigXWizard;
ZaGALConfigXWizard.prototype.cacheDialog=false;
ZaXDialog.XFormModifiers.ZaGALConfigXWizard=new Array();
ZaGALConfigXWizard.prototype.handleXFormChange=function(){
if(this._localXForm.hasErrors()){
if(this.lastErrorStep<this._containedObject[ZaModel.currentStep]){
this.lastErrorStep=this._containedObject[ZaModel.currentStep]
}}else{
this.lastErrorStep=0
}
this.changeButtonStateForStep(this._containedObject[ZaModel.currentStep])
};
ZaGALConfigXWizard.prototype.changeButtonStateForStep=function(e){
if(this.lastErrorStep==e){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
if(e>1){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}else{
if(e==ZaGALConfigXWizard.GALMODE_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}else{
if(e==ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}else{
if(e==ZaGALConfigXWizard.GAL_TEST_STEP){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}else{
if(e==ZaGALConfigXWizard.GAL_TEST_RESULT_STEP){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
if(e==ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1||e==ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_2){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}else{
if(e==ZaGALConfigXWizard.CONFIG_COMPLETE_STEP){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}}}}}}}};
ZaGALConfigXWizard.prototype.setObject=function(t){
this._containedObject=new ZaDomain();
ZaItem.prototype.copyTo.call(t,this._containedObject,true,4);
this._containedObject[ZaDomain.A2_create_gal_acc]=t[ZaDomain.A2_create_gal_acc]||"TRUE";
this._containedObject[ZaDomain.A2_isTestingGAL]=t[ZaDomain.A2_isTestingGAL]||0;
this._containedObject[ZaDomain.A2_isTestingSync]=t[ZaDomain.A2_isTestingSync]||0;
this._containedObject[ZaDomain.A2_gal_sync_accounts_set]=[];
for(var e in t[ZaDomain.A2_gal_sync_accounts_set]){
if(t[ZaDomain.A2_gal_sync_accounts_set][e]){
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][e]={};
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_gal_sync_account_name]=t[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_gal_sync_account_name];
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_internal_gal_ds_name]=t[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_internal_gal_ds_name];
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_external_gal_ds_name]=t[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_external_gal_ds_name];
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_internal_gal_polling_interval]=t[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_internal_gal_polling_interval]||"1d";
this._containedObject[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_external_gal_polling_interval]=t[ZaDomain.A2_gal_sync_accounts_set][e][ZaDomain.A2_new_external_gal_polling_interval]||"1d"
}}
this.setTitle(ZaMsg.NCD_GALConfigTitle+" ("+t.name+")");
this._containedObject[ZaModel.currentStep]=t[ZaModel.currentStep]||1;
this._containedObject._uuid=t._extid||t._uuid;
this._containedObject._editObject=t._editObject;
this._localXForm.setInstance(this._containedObject)
};
ZaGALConfigXWizard.prototype.finishWizard=function(){
try{
this._containedObject._editObject.createGalAccount=true;
ZaDomain.modifyGalSettings.call(this._containedObject._editObject,this._containedObject);
ZaApp.getInstance().getDomainListController()._fireDomainChangeEvent(this._containedObject._editObject);
this.popdown()
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaGALConfigXWizard.prototype.finishWizard",null,false)
}};
ZaGALConfigXWizard.onGALServerTypeChange=function(o,t,e){
if(o=="ad"){
e.getInstance().attrs[ZaDomain.A_GalLdapFilter]="ad";
e.getInstance().attrs[ZaDomain.A_zimbraGalAutoCompleteLdapFilter]="adAutoComplete"
}else{
e.getInstance().attrs[ZaDomain.A_zimbraGalAutoCompleteLdapFilter]="(|(cn=%s*)(sn=%s*)(gn=%s*)(mail=%s*))"
}
this.setInstanceValue(o)
};
ZaGALConfigXWizard.onGALSyncServerTypeChange=function(o,t,e){
if(o=="ad"){
e.getInstance().attrs[ZaDomain.A_zimbraGalSyncLdapFilter]="ad"
}
this.setInstanceValue(o)
};
ZaGALConfigXWizard.onGALSyncChange=function(n,t,e){
this.setInstanceValue(n);
var o=e.getInstance();
if(n=="FALSE"){
if(o.attrs[ZaDomain.A_zimbraGalSyncLdapFilter]=="ad"){
e.setInstanceValue("ad",ZaDomain.A_GALSyncServerType)
}else{
if(!o.attrs[ZaDomain.A_GALSyncServerType]){
e.setInstanceValue("ldap",ZaDomain.A_GALSyncServerType)
}}}};
ZaGALConfigXWizard.onGalModeChange=function(r,s,n){
this.setInstanceValue(r);
if(r!="zimbra"){
if(!n.getInstance().attrs[ZaDomain.A_GALServerType]){
this.setInstanceValue("ldap",ZaDomain.A_GALServerType)
}
if(!n.getInstance().attrs[ZaDomain.A_GalLdapSearchBase]){
if(n.getInstance().attrs[ZaDomain.A_domainName]){
var h=n.getInstance().attrs[ZaDomain.A_domainName].split(".");
var t="";
var o="";
for(var e in h){
t+=o;
t+="dc=";
t+=h[e];
var o=","
}
this.setInstanceValue(t,ZaDomain.A_GalLdapSearchBase)
}}}};
ZaGALConfigXWizard.testSyncSettings=function(){
var e=this.getInstance();
this.getModel().setInstanceValue(e,ZaDomain.A2_isTestingSync,1);
var t=new AjxCallback(this,ZaGALConfigXWizard.checkSyncConfigCallBack);
ZaDomain.testSyncSettings(e,t)
};
ZaGALConfigXWizard.isGALServerType=function(t){
var e=this.getInstanceValue(ZaDomain.A_GALSyncServerType);
if(!e){
if(t=="ldap"){
return true
}else{
return false
}}else{
return(e==t)
}};
ZaGALConfigXWizard.checkSyncConfigCallBack=function(t){
if(!t){
return
}
var e=this.getInstance();
this.getModel().setInstanceValue(e,ZaDomain.A2_isTestingSync,0);
if(t.isException()){
var n=[t.getException().detail,t.getException().msg,t.getException().trace].join("\n");
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestResultCode,t.getException().code);
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestMessage,n)
}else{
var o=t.getResponse().Body.CheckGalConfigResponse;
if(o){
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestResultCode,o.code[0]._content);
if(o.code[0]._content!=ZaDomain.Check_OK){
this.getModel().setInstanceValue(e,ZaDomain.A_GALSyncTestMessage,o.message[0]._content)
}}}
this.getForm().parent.goPage(ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP)
};
ZaGALConfigXWizard.testGALSettings=function(){
var e=this.getInstance();
this.getModel().setInstanceValue(e,ZaDomain.A2_isTestingGAL,1);
var t=new AjxCallback(this,ZaGALConfigXWizard.checkGALConfigCallBack);
ZaDomain.testGALSettings(e,t,e[ZaDomain.A_GALSampleQuery])
};
ZaGALConfigXWizard.checkGALConfigCallBack=function(c){
if(!c){
return
}
var l=this.getInstance();
this.getModel().setInstanceValue(l,ZaDomain.A2_isTestingGAL,0);
if(c.isException()){
var t=[c.getException().detail,c.getException().msg,c.getException().trace].join("\n");
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestResultCode,c.getException().code);
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestMessage,t);
this.getModel().setInstanceValue(l,ZaDomain.A_GALTestSearchResults,null)
}else{
var s=c.getResponse().Body.CheckGalConfigResponse;
if(s){
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestResultCode,s.code[0]._content);
if(s.code[0]._content!=ZaDomain.Check_OK){
this.getModel().setInstanceValue(l,ZaDomain.A_GALSearchTestMessage,s.message[0]._content);
this.getModel().setInstanceValue(l,ZaDomain.A_GALTestSearchResults,null)
}else{
var e=new Array();
if(s.cn&&s.cn.length){
var r=s.cn.length;
for(var o=0;
o<r;
o++){
var n=new Object();
if(s.cn[o]._attrs){
for(var h in s.cn[o]._attrs){
n[h]=s.cn[o]._attrs[h]
}
e.push(n)
}}}
this.getModel().setInstanceValue(l,ZaDomain.A_GALTestSearchResults,e)
}}}
this.getForm().parent.goPage(ZaGALConfigXWizard.GAL_TEST_RESULT_STEP)
};
ZaGALConfigXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this._button[DwtWizardDialog.NEXT_BUTTON].setText(AjxMsg._next);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
};
ZaGALConfigXWizard.filterExistingServer=function(n){
var e=[];
if(!n){
return e
}
var o=n[ZaDomain.A2_gal_sync_accounts];
if(!o||!(o instanceof Array)){
return e
}
for(var t=0;
t<o.length;
t++){
e.push(o[t].attrs[ZaDomain.A_mailHost])
}
return e
};
ZaGALConfigXWizard.prototype.goPage=function(e){
ZaXWizardDialog.prototype.goPage.call(this,e);
this.changeButtonStateForStep(e)
};
ZaGALConfigXWizard.prototype.goPrev=function(){
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GAL_TEST_RESULT_STEP){
this.goPage(ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP){
this.goPage(ZaGALConfigXWizard.SYNC_CONFIG_SUM_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP&&this._containedObject.attrs[ZaDomain.A_GALSyncUseGALSearch]=="TRUE"){
this.goPage(ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.CONFIG_COMPLETE_STEP){
if(this._containedObject.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_internal){
this.goPage(ZaGALConfigXWizard.GALMODE_STEP)
}else{
this.goPage(ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP)
}}else{
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this.goPage(this._containedObject[ZaModel.currentStep]-1)
}}}}};
ZaGALConfigXWizard.prototype.goNext=function(){
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GALMODE_STEP&&this._containedObject.attrs[ZaDomain.A_zimbraGalMode]==ZaDomain.GAL_Mode_internal){
this.goPage(ZaGALConfigXWizard.CONFIG_COMPLETE_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP){
this.goPage(ZaGALConfigXWizard.CONFIG_COMPLETE_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GAL_TEST_RESULT_STEP){
this.goPage(ZaGALConfigXWizard.SYNC_CONFIG_SUM_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GALMODE_STEP&&this._containedObject.attrs[ZaDomain.A_zimbraGalMode]!=ZaDomain.GAL_Mode_internal){
if(!this._containedObject.attrs[ZaDomain.A_GalLdapFilter]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_SEARCH_FILTER_REQUIRED);
return
}
if(!this._containedObject.attrs[ZaDomain.A_GalLdapURL]||this._containedObject.attrs[ZaDomain.A_GalLdapURL].length<1){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_LDAP_URL_REQUIRED);
return
}
this.goPage(ZaGALConfigXWizard.GAL_CONFIG_STEP_2)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GAL_CONFIG_STEP_2){
if(this._containedObject.attrs[ZaDomain.A_UseBindPassword]=="FALSE"){
this._containedObject.attrs[ZaDomain.A_GalLdapBindPassword]=null;
this._containedObject.attrs[ZaDomain.A_GalLdapBindPasswordConfirm]=null;
this._containedObject.attrs[ZaDomain.A_GalLdapBindDn]=null
}
if(this._containedObject.attrs[ZaDomain.A_GalLdapBindPassword]!=this._containedObject.attrs[ZaDomain.A_GalLdapBindPasswordConfirm]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}
this.goPage(ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1){
if(this._containedObject.attrs[ZaDomain.A_GALSyncUseGALSearch]=="FALSE"){
this.goPage(ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_2)
}else{
this.goPage(ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP)
}}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP){
this._localXForm.setInstanceValue(ZaDomain.Check_SKIPPED,ZaDomain.A_GALSearchTestResultCode);
this.goPage(ZaGALConfigXWizard.GAL_TEST_RESULT_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaGALConfigXWizard.SYNC_CONFIG_SUM_STEP){
this._localXForm.setInstanceValue(ZaDomain.Check_SKIPPED,ZaDomain.A_GALSyncTestResultCode);
this.goPage(ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP)
}else{
this.goPage(this._containedObject[ZaModel.currentStep]+1)
}}}}}}}}};
ZaGALConfigXWizard.getGalSyncLdapFilterEnabled=function(){
var t=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_GALSyncUseGALSearch);
var e=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_GALSyncServerType);
return(t=="FALSE"&&e=="ldap")
};
ZaGALConfigXWizard.getGalSyncConfigSeparate=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),ZaDomain.A_GALSyncUseGALSearch);
return(e=="FALSE")
};
ZaGALConfigXWizard.checkGALAccountAttribute=ZaDomainXFormView.checkGALAccountAttribute;
ZaGALConfigXWizard.myXFormModifier=function(o,e){
var n=new Array();
n[0]=new ZaListHeaderItem("email",ZaMsg.ALV_Name_col,null,"116px",null,"email",true,true);
n[1]=new ZaListHeaderItem("fullName",ZaMsg.ALV_FullName_col,null,"auto",null,"fullName",true,true);
var t={};
t[ZaGALConfigXWizard.GAL_CONFIG_STEP_2]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_2]={
checks:[[ZaNewDomainXWizard.isDomainModeNotInternal],[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],sources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch]};
t[ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaGALConfigXWizard.GAL_TEST_RESULT_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaGALConfigXWizard.SYNC_CONFIG_SUM_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
t[ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP]={
checks:[ZaNewDomainXWizard.isDomainModeNotInternal],sources:[ZaDomain.A_zimbraGalMode]};
o.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,cssStyle:"white-space: normal",ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep],labelVisibility:t}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:650,valign:_TOP_,cssStyle:"white-space: normal",items:[{
type:_CASE_,caseKey:ZaGALConfigXWizard.GALMODE_STEP,numCols:2,colSizes:["220px","430px"],items:[{
ref:ZaDomain.A_zimbraGalMode,type:_OSELECT1_,label:ZaMsg.Domain_GalMode,labelLocation:_LEFT_,choices:this.GALModes,onChange:ZaGALConfigXWizard.onGalModeChange}
,{
ref:ZaDomain.A_zimbraGalMaxResults,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraGalMaxResults,msgName:ZaMsg.MSG_zimbraGalMaxResults,labelLocation:_LEFT_}
,{
type:_DWT_ALERT_,style:DwtAlert.WARNING,content:ZaMsg.WARNING_DOMAIN_DS_NOT_CONFIGRED,visibilityChecks:[[XForm.checkInstanceValueEmty,ZaDomain.A_zimbraGalAccountId]],colSpan:"*"}
,{
ref:ZaDomain.A2_create_gal_acc,type:_CHECKBOX_,label:ZaMsg.Domain_UseGALSyncAccts,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,labelWrap:true,visibilityChecks:[[XForm.checkInstanceValueEmty,ZaDomain.A2_gal_sync_accounts],[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId]],enableDisableChecks:[[ZaItem.hasRight,ZaDomain.RIGHT_CREATE_ACCOUNT]]}
,{
type:_REPEAT_,ref:ZaDomain.A2_gal_sync_accounts,colSpan:"*",showAddButton:false,showRemoveButton:false,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_gal_sync_accounts],[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId]],items:[{
type:_GROUP_,ref:".",numCols:2,width:"100%",colSizes:["220px","430px"],items:[{
ref:"name",type:_OUTPUT_,label:ZaMsg.Domain_GalSyncAccount,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_gal_sync_accounts],[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId]]}
,{
ref:(ZaAccount.A2_zimbra_ds+".name"),label:ZaMsg.Domain_InternalGALDSName,type:_OUTPUT_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotExternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_zimbra_ds,false]]}
,{
ref:ZaDomain.A2_new_internal_gal_ds_name,label:ZaMsg.Domain_InternalGALDSName,type:_TEXTFIELD_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotExternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_zimbra_ds,true]],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"],[ZaItem.hasRight,ZaDomain.RIGHT_CREATE_ACCOUNT]]}
,{
ref:(ZaAccount.A2_zimbra_ds+".attrs."+ZaDataSource.A_zimbraDataSourcePollingInterval),type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_internal,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_internal,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotExternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_zimbra_ds,false]]}
,{
ref:ZaDomain.A2_new_internal_gal_polling_interval,type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_internal,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_internal,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotExternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_zimbra_ds,true]],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]]}
,{
ref:(ZaAccount.A2_ldap_ds+".name"),label:ZaMsg.Domain_ExternalGALDSName,type:_OUTPUT_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotInternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_ldap_ds,false]]}
,{
ref:ZaDomain.A2_new_external_gal_ds_name,label:ZaMsg.Domain_ExternalGALDSName,type:_TEXTFIELD_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotInternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_ldap_ds,true]],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]]}
,{
ref:(ZaAccount.A2_ldap_ds+".attrs."+ZaDataSource.A_zimbraDataSourcePollingInterval),type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_external,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_external,enableDisableChecks:[],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotInternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_ldap_ds,false]]}
,{
ref:ZaDomain.A2_new_external_gal_polling_interval,type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_external,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_external,enableDisableChecks:[],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],ZaNewDomainXWizard.isDomainModeNotInternal,[ZaGALConfigXWizard.checkGALAccountAttribute,ZaAccount.A2_ldap_ds,true]],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"]]}
]}
]}
,{
ref:ZaDomain.A2_gal_sync_accounts_set,id:ZaDomain.A2_gal_sync_accounts_set+"_config_wizard",type:_COLLAB_SELECT_,label:null,repeatInstance:"",showAddButton:true,showRemoveButton:true,filterMethod:ZaGALConfigXWizard.filterExistingServer,addButtonLabel:ZaMsg.Domain_GAL_Add,addButtonWidth:220,number:0,removeButtonLabel:ZaMsg.Domain_GAL_Remove,visibilityChangeEventSources:[ZaDomain.A2_create_gal_acc],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"],[ZaItem.hasReadPermission,ZaDomain.A_zimbraGalAccountId],[function(){
var s=this.getParentItem().getInstanceValue(ZaDomain.A2_gal_sync_accounts);
if(s&&s instanceof Array&&s.length>=this.__availNum){
return false
}
if(this.removeButton){
this.removeButton.visibilityChecks=[];
this.removeButton.visibilityChecks.push(function(){
var h=this.getParentItem().getInstanceValue(ZaDomain.A2_gal_sync_accounts);
var r=0;
if(h&&h instanceof Array){
r=h.length
}
return(this.getParentItem().getInstanceCount()+r)>1
}
)
}
if(this.getInstanceValue().length==0){
if(!s||(s&&s instanceof Array&&s.length==0)){
this.addRowButtonClicked(this.getParentItem().instanceNum)
}}
return true
}
]],enableDisableChangeEventSources:[ZaDomain.A2_create_gal_acc],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_create_gal_acc,"TRUE"],[ZaItem.hasRight,ZaDomain.RIGHT_CREATE_ACCOUNT]],showAddOnNextRow:true,showRemoveNextRow:false,colSpan:2,items:[{
type:_GROUP_,ref:".",numCols:1,width:"100%",visibilityChangeEventSources:[ZaDomain.A2_gal_sync_accounts_set],visibilityChecks:[function(){
return(this.instanceNum==0||(this.instanceNum<this.getNumberToShow())||(this.instanceNum<this.getInstanceCount()))
}
],items:[{
type:_SPACER_,colSpan:"*"}
,{
type:_GROUP_,ref:".",numCols:2,colSizes:["220x","100%"],width:"100%",visibilityChangeEventSources:[ZaDomain.A2_gal_sync_accounts_set],visibilityChecks:[function(){
var s=this.getParentItem().instanceNum;
return((s<this.getNumberToShow())||(s<this.getInstanceCount()))
}
],items:[{
type:_GROUP_,label:ZaMsg.Domain_GalSyncAccount,numCols:3,colSizes:["130px","25px","auto"],colSpan:"1",ref:".",items:[{
ref:ZaDomain.A2_new_gal_sync_account_name,width:130,label:null,type:_TEXTFIELD_,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_OUTPUT_,value:"@"}
,{
type:_OUTPUT_,refPath:ZaDomain.A_domainName,label:null,align:_LEFT_}
],required:true}
,{
ref:ZaDomain.A_mailHost,type:_OSELECT1_,label:ZaMsg.NAD_MailServer,choices:ZaApp.getInstance().getServerListChoices(),colSelect:true,required:true,width:300}
,{
ref:ZaDomain.A2_new_internal_gal_ds_name,label:ZaMsg.Domain_InternalGALDSName,type:_TEXTFIELD_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotExternal]}
,{
ref:ZaDomain.A2_new_internal_gal_polling_interval,type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_internal,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_internal,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotExternal]}
,{
ref:ZaDomain.A2_new_external_gal_ds_name,label:ZaMsg.Domain_ExternalGALDSName,type:_TEXTFIELD_,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal]}
,{
ref:ZaDomain.A2_new_external_gal_polling_interval,type:_LIFETIME_,label:ZaMsg.LBL_zimbraDataSourcePollingInterval_external,labelLocation:_LEFT_,msgName:ZaMsg.MSG_zimbraDataSourcePollingInterval_external,visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal]}
]}
]}
]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["220px","430px"],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode],visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal],cssStyle:"overflow:auto",items:[{
ref:ZaDomain.A_GALServerType,type:_OSELECT1_,label:ZaMsg.Domain_GALServerType,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[],choices:this.GALServerTypes,onChange:ZaGALConfigXWizard.onGALServerTypeChange}
,{
type:_GROUP_,numCols:6,colSpan:6,label:"   ",labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasWritePermission,ZaDomain.A_GalLdapURL]],items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerPort,width:"45px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALUseSSL,width:"65px"}
]}
,{
ref:ZaDomain.A_GalLdapURL,type:_REPEAT_,label:ZaMsg.LBL_Domain_GalLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,visibilityChecks:[[ZaItem.hasWritePermission,ZaDomain.A_GalLdapURL]],addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"3269",ldapPort:"3268",labelLocation:_NONE_,visibilityChecks:[],enableDisableChecks:[]}
]}
,{
ref:ZaDomain.A_GalLdapFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],bmolsnr:true,enableDisableChangeEventSources:[ZaDomain.A_GALServerType]}
,{
ref:ZaDomain.A_zimbraGalAutoCompleteLdapFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_zimbraGalAutoCompleteLdapFilter,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],enableDisableChangeEventSources:[ZaDomain.A_GALServerType]}
,{
ref:ZaDomain.A_GalLdapSearchBase,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,bmolsnr:true}
]}
]}
,{
type:_CASE_,numCols:2,colSizes:["300px","*"],caseKey:ZaGALConfigXWizard.GAL_CONFIG_STEP_2,visibilityChangeEventSources:[ZaModel.currentStep],visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isDomainModeNotInternal],items:[{
ref:ZaDomain.A_UseBindPassword,type:_CHECKBOX_,label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,enableDisableChecks:[],visibilityChecks:[]}
,{
ref:ZaDomain.A_GalLdapBindDn,type:_INPUT_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_UseBindPassword]}
,{
ref:ZaDomain.A_GalLdapBindPassword,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPassword,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_UseBindPassword]}
,{
ref:ZaDomain.A_GalLdapBindPasswordConfirm,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPasswordConfirm,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_UseBindPassword],visibilityChecks:[]}
]}
,{
type:_CASE_,numCols:2,colSizes:["220px","430px"],caseKey:ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_1,items:[{
ref:ZaDomain.A_GALSyncUseGALSearch,type:_CHECKBOX_,label:ZaMsg.Domain_GALSyncUseGALSearch,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,labelWrap:true,onChange:ZaGALConfigXWizard.onGALSyncChange,enableDisableChecks:[],visibilityChecks:[]}
,{
ref:ZaDomain.A_GALSyncServerType,type:_OSELECT1_,label:ZaMsg.Domain_GALServerType,labelLocation:_LEFT_,choices:this.GALServerTypes,onChange:ZaGALConfigXWizard.onGALSyncServerTypeChange,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch],visibilityChecks:[]}
,{
type:_GROUP_,numCols:6,colSpan:6,label:"   ",labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch],items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALServerPort,width:"45px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_GALUseSSL,width:"65px"}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapURL,type:_REPEAT_,label:ZaMsg.LBL_Domain_GalLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch],visibilityChecks:[[ZaGALConfigXWizard.isGALServerType,ZaDomain.GAL_ServerType_ad]],visibilityChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType],addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"3269",ldapPort:"3268",labelLocation:_NONE_,visibilityChecks:[],enableDisableChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapURL,type:_REPEAT_,label:ZaMsg.LBL_Domain_GalLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,visibilityChecks:[[ZaGALConfigXWizard.isGALServerType,ZaDomain.GAL_ServerType_ldap]],visibilityChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType],enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType],addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"636",ldapPort:"389",labelLocation:_NONE_,visibilityChecks:[],enableDisableChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,textWrapping:"soft",enableDisableChecks:[ZaGALConfigXWizard.getGalSyncLdapFilterEnabled],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALSyncServerType]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapSearchBase,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,textWrapping:"soft",enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],enableDisableChangeEventSources:[ZaDomain.A_GALSyncUseGALSearch]}
]}
,{
type:_CASE_,numCols:2,colSizes:["220px","430px"],caseKey:ZaGALConfigXWizard.GAL_SYNC_CONFIG_STEP_2,visibilityChangeEventSources:[ZaModel.currentStep],visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],items:[{
ref:ZaDomain.A_SyncUseBindPassword,type:_CHECKBOX_,label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,enableDisableChecks:[],visibilityChecks:[]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapBindDn,type:_INPUT_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_SyncUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_SyncUseBindPassword]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapBindPassword,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPassword,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_SyncUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_SyncUseBindPassword]}
,{
ref:ZaDomain.A_GalSyncLdapBindPasswordConfirm,type:_SECRET_,label:ZaMsg.Domain_GalLdapBindPasswordConfirm,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_SyncUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_SyncUseBindPassword],visibilityChecks:[]}
]}
,{
type:_CASE_,caseKey:ZaGALConfigXWizard.GAL_CONFIG_SUM_STEP,numCols:2,colSizes:["220px","430px"],items:[{
type:_GROUP_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A2_isTestingGAL],useParentTable:false,numCols:2,colSpan:2,items:[{
ref:ZaDomain.A_zimbraGalMode,type:_OUTPUT_,label:ZaMsg.Domain_GalMode,choices:this.GALModes,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
,{
ref:ZaDomain.A_zimbraGalMaxResults,type:_OUTPUT_,label:ZaMsg.LBL_zimbraGalMaxResults,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
,{
ref:ZaDomain.A_GALServerType,type:_OUTPUT_,label:ZaMsg.Domain_GALServerType,choices:this.GALServerTypes,labelLocation:_LEFT_,bmolsnr:true}
,{
ref:ZaDomain.A_GalLdapURL,type:_REPEAT_,label:ZaMsg.Domain_GalLdapURL+":",labelLocation:_LEFT_,showAddButton:false,bmolsnr:true,showRemoveButton:false,items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_,bmolsnr:true}
]}
,{
ref:ZaDomain.A_GalLdapFilter,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,required:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],visibilityChangeEventSources:[ZaDomain.GAL_ServerType_ldap],bmolsnr:true}
,{
ref:ZaDomain.A_GalLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,bmolsnr:true}
,{
ref:ZaDomain.A_UseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",bmolsnr:true}
,{
ref:ZaDomain.A_GalLdapBindDn,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"]],visibilityChangeEventSources:[ZaDomain.A_UseBindPassword],bmolsnr:true}
,{
ref:ZaDomain.A_GALSampleQuery,type:_TEXTFIELD_,label:ZaMsg.Domain_GALSampleSearchName,labelLocation:_LEFT_,labelWrap:true,cssStyle:"width:100px;",bmolsnr:true,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,enableDisableChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSampleQuery," "],[XForm.checkInstanceValueNotEmty,ZaDomain.A_GALSampleQuery]],enableDisableChangeEventSources:[ZaDomain.A_GALSampleQuery],onActivate:"ZaGALConfigXWizard.testGALSettings.call(this)",label:ZaMsg.Domain_GALTestSettings,visibilityChecks:[],valign:_BOTTOM_,width:"100px"}
]}
,{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALTestingInProgress,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.INFORMATION,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,1]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
]}
,{
type:_CASE_,caseKey:ZaGALConfigXWizard.GAL_TEST_RESULT_STEP,numCols:2,colSizes:["220px","430px"],items:[{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_GALSearchTestResultCode],numCols:2,colSpan:2,items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSearchTestSuccessful,ref:null,colSpan:"2",iconVisible:true,style:DwtAlert.SUCCESS}
,{
type:_OUTPUT_,value:ZaMsg.Domain_GALSearchResult,colSpan:2,visibilityChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A_GALTestSearchResults]]}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_,colSpan:"*"}
,{
ref:ZaDomain.A_GALTestSearchResults,type:_DWT_LIST_,height:"200px",width:"100%",colSpan:2,cssClass:"DLSource",forceUpdate:true,widgetClass:ZaGalObjMiniListView,headerList:n,hideHeader:true}
]}
,{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_OK],[XForm.checkInstanceValueNot,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSearchTestResultCode],numCols:2,colSpan:2,items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSearchTestFailed,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING}
,{
type:_OUTPUT_,ref:ZaDomain.A_GALSearchTestResultCode,label:ZaMsg.Domain_GALTestResult,choices:this.TestResultChoices}
,{
type:_TEXTAREA_,ref:ZaDomain.A_GALSearchTestMessage,label:ZaMsg.Domain_GALTestMessage,height:"200px",width:"400px",enableDisableChecks:[]}
]}
,{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSearchTestSkipped,ref:null,colSpan:2,iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSearchTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSearchTestResultCode]}
]}
,{
type:_CASE_,caseKey:ZaGALConfigXWizard.SYNC_CONFIG_SUM_STEP,items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestingInProgress,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.INFORMATION,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingSync,1]],visibilityChangeEventSources:[ZaDomain.A2_isTestingSync]}
,{
type:_GROUP_,useParentTable:false,numCols:2,colSpan:2,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingSync,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingSync],items:[{
ref:ZaDomain.A_zimbraGalMode,type:_OUTPUT_,label:ZaMsg.Domain_GalMode,choices:this.GALModes,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_isTestingGAL,0]],visibilityChangeEventSources:[ZaDomain.A2_isTestingGAL]}
,{
ref:ZaDomain.A_GALSyncUseGALSearch,type:_OUTPUT_,label:ZaMsg.Domain_GALSyncUseGALSearch,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",bmolsnr:true}
,{
ref:ZaDomain.A_GALSyncServerType,type:_OUTPUT_,label:ZaMsg.Domain_GALServerType,choices:this.GALServerTypes,labelLocation:_LEFT_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],bmolsnr:true}
,{
ref:ZaDomain.A_zimbraGalSyncLdapURL,type:_REPEAT_,label:ZaMsg.Domain_GalLdapURL+":",labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,bmolsnr:true,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_,bmolsnr:true}
]}
,{
ref:ZaDomain.A_zimbraGalSyncLdapFilter,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapFilter,labelLocation:_LEFT_,required:true,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"],[XForm.checkInstanceValue,ZaDomain.A_GALServerType,ZaDomain.GAL_ServerType_ldap]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_GALServerType],bmolsnr:true}
,{
ref:ZaDomain.A_zimbraGalSyncLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapSearchBase,labelLocation:_LEFT_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],bmolsnr:true}
,{
ref:ZaDomain.A_SyncUseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_UseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch],bmolsnr:true}
,{
ref:ZaDomain.A_zimbraGalSyncLdapBindDn,type:_OUTPUT_,label:ZaMsg.Domain_GalLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[ZaNewDomainXWizard.isDomainModeNotInternal,[XForm.checkInstanceValue,ZaDomain.A_UseBindPassword,"TRUE"],[XForm.checkInstanceValue,ZaDomain.A_GALSyncUseGALSearch,"FALSE"]],visibilityChangeEventSources:[ZaDomain.A_zimbraGalMode,ZaDomain.A_GALSyncUseGALSearch,ZaDomain.A_UseBindPassword],bmolsnr:true}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,onActivate:"ZaGALConfigXWizard.testSyncSettings.call(this)",label:ZaMsg.Domain_GALTestSettings,enableDisableChecks:[],visibilityChecks:[],valign:_BOTTOM_,width:"100px"}
]}
]}
,{
type:_CASE_,caseKey:ZaGALConfigXWizard.SYNC_TEST_RESULT_STEP,items:[{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode],numCols:2,width:"100%",items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestSuccessful,ref:null,colSpan:"*",iconVisible:false,align:_CENTER_,style:DwtAlert.INFORMATION}
]}
,{
type:_GROUP_,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode],numCols:2,width:"100%",items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestFailed,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
,{
type:_DWT_ALERT_,content:ZaMsg.Domain_GALSyncTestSkipped,ref:null,colSpan:"2",iconVisible:true,align:_CENTER_,style:DwtAlert.WARNING,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
,{
type:_OUTPUT_,ref:ZaDomain.A_GALSyncTestResultCode,label:ZaMsg.Domain_GALTestResult,choices:this.TestResultChoices,visibilityChecks:[[XForm.checkInstanceValueNot,ZaDomain.A_GALSyncTestResultCode,ZaDomain.Check_SKIPPED]],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
,{
type:_TEXTAREA_,ref:ZaDomain.A_GALSyncTestMessage,label:ZaMsg.Domain_GALTestMessage,height:"200px",width:"380px",visibilityChecks:[function(){
return((this.getInstanceValue(ZaDomain.A_GALSyncTestResultCode)!=ZaDomain.Check_SKIPPED)&&(this.getInstanceValue(ZaDomain.A_GALSyncTestResultCode)!=ZaDomain.Check_OK))
}
],visibilityChangeEventSources:[ZaDomain.A_GALSyncTestResultCode]}
]}
]}
,{
type:_CASE_,caseKey:ZaGALConfigXWizard.CONFIG_COMPLETE_STEP,items:[{
type:_OUTPUT_,value:ZaMsg.Domain_GalConfig_Complete}
]}
]}
]
};
ZaXDialog.XFormModifiers.ZaGALConfigXWizard.push(ZaGALConfigXWizard.myXFormModifier)
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaAuthConfigXWizard")){
ZaAuthConfigXWizard=function(e){
ZaXWizardDialog.call(this,e,null,ZaMsg.NCD_AuthConfigTitle,"700px","350px","ZaAuthConfigXWizard",null,ZaId.DLG_AUTH_CONFIG);
this.AuthMechs=[{
label:ZaMsg.AuthMech_zimbra,value:ZaDomain.AuthMech_zimbra}
,{
label:ZaMsg.AuthMech_ldap,value:ZaDomain.AuthMech_ldap}
,{
label:ZaMsg.AuthMech_ad,value:ZaDomain.AuthMech_ad}
];
this.TestResultChoices=[{
label:ZaMsg.AuthTest_check_OK,value:ZaDomain.Check_OK}
,{
label:ZaMsg.AuthTest_check_UNKNOWN_HOST,value:ZaDomain.Check_UNKNOWN_HOST}
,{
label:ZaMsg.AuthTest_check_CONNECTION_REFUSED,value:ZaDomain.Check_CONNECTION_REFUSED}
,{
label:ZaMsg.AuthTest_check_SSL_HANDSHAKE_FAILURE,value:ZaDomain.Check_SSL_HANDSHAKE_FAILURE}
,{
label:ZaMsg.AuthTest_check_COMMUNICATION_FAILURE,value:ZaDomain.Check_COMMUNICATION_FAILURE}
,{
label:ZaMsg.AuthTest_check_AUTH_FAILED,value:ZaDomain.Check_AUTH_FAILED}
,{
label:ZaMsg.AuthTest_check_AUTH_NOT_SUPPORTED,value:ZaDomain.Check_AUTH_NOT_SUPPORTED}
,{
label:ZaMsg.AuthTest_check_NAME_NOT_FOUND,value:ZaDomain.Check_NAME_NOT_FOUND}
,{
label:ZaMsg.AuthTest_check_INVALID_SEARCH_FILTER,value:ZaDomain.Check_INVALID_SEARCH_FILTER}
,{
label:ZaMsg.AuthTest_check_FAILURE,value:ZaDomain.Check_FAILURE}
];
this.TAB_INDEX=0;
ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1=++this.TAB_INDEX;
ZaAuthConfigXWizard.AUTH_CONFIG_BIND_PWD_STEP=++this.TAB_INDEX;
ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP=++this.TAB_INDEX;
ZaAuthConfigXWizard.AUTH_TEST_STEP=++this.TAB_INDEX;
ZaAuthConfigXWizard.AUTH_TEST_RESULT_STEP=++this.TAB_INDEX;
ZaAuthConfigXWizard.CONFIG_COMPLETE_STEP=++this.TAB_INDEX;
this.stepChoices=[{
label:ZaMsg.AuthSettings,value:ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1}
,{
label:ZaMsg.AuthSettings,value:ZaAuthConfigXWizard.AUTH_CONFIG_BIND_PWD_STEP}
,{
label:ZaMsg.AuthSettings,value:ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP}
,{
label:ZaMsg.TestAuthSettings,value:ZaAuthConfigXWizard.AUTH_TEST_STEP}
,{
label:ZaMsg.AuthTestResult,value:ZaAuthConfigXWizard.AUTH_TEST_RESULT_STEP}
,{
label:ZaMsg.DomainConfigComplete,value:ZaAuthConfigXWizard.CONFIG_COMPLETE_STEP}
];
this.initForm(ZaDomain.myXModel,this.getMyXForm());
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaAuthConfigXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaAuthConfigXWizard.prototype.handleXFormChange));
this.lastErrorStep=0;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/authentication_settings.htm?locid="+AjxEnv.DEFAULT_LOCALE
};
ZaAuthConfigXWizard.prototype=new ZaXWizardDialog;
ZaAuthConfigXWizard.prototype.constructor=ZaAuthConfigXWizard;
ZaXDialog.XFormModifiers.ZaAuthConfigXWizard=new Array();
ZaAuthConfigXWizard.prototype.handleXFormChange=function(){
if(this._localXForm.hasErrors()){
if(this.lastErrorStep<this._containedObject[ZaModel.currentStep]){
this.lastErrorStep=this._containedObject[ZaModel.currentStep]
}}else{
this.lastErrorStep=0
}
this.changeButtonStateForStep(this._containedObject[ZaModel.currentStep])
};
ZaAuthConfigXWizard.prototype.changeButtonStateForStep=function(e){
if(this.lastErrorStep==e){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
if(e>1){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}else{
if(e==ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1){
this._button[DwtWizardDialog.NEXT_BUTTON].setText(AjxMsg._next);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
}else{
if(e==ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP){
this._button[DwtWizardDialog.NEXT_BUTTON].setText(ZaMsg.Domain_AuthTestSettings);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}else{
if(e==ZaAuthConfigXWizard.AUTH_TEST_STEP){
this._button[DwtWizardDialog.NEXT_BUTTON].setText(AjxMsg._next);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}else{
if(e==ZaAuthConfigXWizard.CONFIG_COMPLETE_STEP){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
this._button[DwtWizardDialog.NEXT_BUTTON].setText(AjxMsg._next);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}}}}}};
ZaAuthConfigXWizard.prototype.testSetings=function(){
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
this._containedObject.attrs[ZaDomain.A_AuthLdapUserDn]="%u@"+this._containedObject.attrs[ZaDomain.A_AuthADDomainName]
}
var e=new AjxCallback(this,this.checkCallBack);
ZaDomain.testAuthSettings(this._containedObject,e)
};
ZaAuthConfigXWizard.prototype.checkCallBack=function(e){
if(!e){
return
}
if(e.isException()){
this._containedObject[ZaDomain.A_AuthTestResultCode]=e.getException().code;
this._containedObject[ZaDomain.A_AuthTestMessage]=e.getException().detail+"\n"+e.getException().msg
}else{
var t=e.getResponse().Body.CheckAuthConfigResponse;
this._containedObject[ZaDomain.A_AuthTestResultCode]=t.code[0]._content;
if(this._containedObject[ZaDomain.A_AuthTestResultCode]!=ZaDomain.Check_OK){
this._containedObject[ZaDomain.A_AuthTestMessage]=t.message[0]._content;
if(t.bindDn!=null){
this._containedObject[ZaDomain.A_AuthComputedBindDn]=t.bindDn[0]._content
}else{
this._containedObject[ZaDomain.A_AuthComputedBindDn]=""
}}}
this.goPage(ZaAuthConfigXWizard.AUTH_TEST_RESULT_STEP)
};
ZaAuthConfigXWizard.onAuthMechChange=function(o,t,e){
this.setInstanceValue(o);
if(o==ZaDomain.AuthMech_ad){
if(!e.getInstance().attrs[ZaDomain.A_AuthADDomainName]){
this.setInstanceValue(e.getInstance().attrs[ZaDomain.A_domainName],ZaDomain.A_AuthADDomainName)
}}};
ZaAuthConfigXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this.changeButtonStateForStep(ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1)
};
ZaAuthConfigXWizard.prototype.goPage=function(e){
ZaXWizardDialog.prototype.goPage.call(this,e);
this.changeButtonStateForStep(e)
};
ZaAuthConfigXWizard.prototype.goPrev=function(){
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.AUTH_TEST_RESULT_STEP){
this.goPage(ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
this.goPage(ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.CONFIG_COMPLETE_STEP&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
this.goPage(ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1)
}else{
this.goPage(this._containedObject[ZaModel.currentStep]-1)
}}}};
ZaAuthConfigXWizard.prototype.goNext=function(){
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP){
this.testSetings();
this.goPage(ZaAuthConfigXWizard.AUTH_TEST_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
if(!this._containedObject.attrs[ZaDomain.A_AuthLdapURL]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_LDAP_URL_REQUIRED);
return false
}
this.goPage(ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ldap){
var e=this._containedObject.attrs[ZaDomain.A_AuthLdapURL].join(" ");
if(this._containedObject.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]=="TRUE"){
if(e.indexOf("ldaps://")>-1){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.Domain_WarningStartTLSIgnored)
}}
this.goPage(ZaAuthConfigXWizard.AUTH_CONFIG_BIND_PWD_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.AUTH_CONFIG_BIND_PWD_STEP){
if(this._containedObject[ZaDomain.A_AuthUseBindPassword]=="FALSE"){
this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindDn]=null;
this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindPassword]=null;
this._containedObject[ZaDomain.A_AuthLdapSearchBindPasswordConfirm]=null
}
if(this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindPassword]!=this._containedObject[ZaDomain.A_AuthLdapSearchBindPasswordConfirm]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}
this.goPage(ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP)
}else{
if(this._containedObject[ZaModel.currentStep]==ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
this.goPage(ZaAuthConfigXWizard.CONFIG_COMPLETE_STEP)
}else{
this.goPage(this._containedObject[ZaModel.currentStep]+1)
}}}}}};
ZaAuthConfigXWizard.prototype.setObject=function(t){
this._containedObject=new Object();
this._containedObject.attrs=new Object();
for(var e in t.attrs){
this._containedObject.attrs[e]=t.attrs[e]
}
this._containedObject.name=t.name;
this._containedObject.type=t.type;
this._containedObject.id=t.id;
if(t.rights){
this._containedObject.rights=t.rights
}
if(t.setAttrs){
this._containedObject.setAttrs=t.setAttrs
}
if(t.getAttrs){
this._containedObject.getAttrs=t.getAttrs
}
if(t._defaultValues){
this._containedObject._defaultValues=t._defaultValues
}
this._containedObject[ZaDomain.A_AuthUseBindPassword]=t[ZaDomain.A_AuthUseBindPassword];
this.setTitle(ZaMsg.NCD_AuthConfigTitle+" ("+t.name+")");
if(ZaSettings.isDomainAdmin&&(t.attrs[ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled]=="TRUE")&&t.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]!="TRUE"){
this._containedObject[ZaDomain.A2_allowClearTextLDAPAuth]="FALSE"
}
this._containedObject[ZaModel.currentStep]=ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1;
this._localXForm.setInstance(this._containedObject)
};
ZaAuthConfigXWizard.myXFormModifier=function(e){
e.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,cssStyle:"white-space: normal",ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep]}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:650,valign:_TOP_,cssStyle:"white-space: normal",items:[{
type:_CASE_,numCols:2,colSizes:["220px","430px"],caseKey:ZaAuthConfigXWizard.AUTH_CONFIG_STEP_1,items:[{
type:_OSELECT1_,label:ZaMsg.Domain_AuthMech,choices:this.AuthMechs,ref:ZaDomain.A_AuthMech,onChange:ZaAuthConfigXWizard.onAuthMechChange,enableDisableChecks:[],visibilityChecks:[]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["220px","430px"],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
type:_SPACER_,height:5,colSpan:2}
,{
ref:ZaDomain.A_AuthADDomainName,type:_TEXTFIELD_,label:ZaMsg.Domain_AuthADDomainName,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[],bmolsnr:true}
,{
type:_GROUP_,numCols:6,colSpan:2,label:"   ",labelLocation:_LEFT_,items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADServerPort,width:"40px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADUseSSL,width:"40px"}
]}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthADURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,labelLocation:_NONE_,ldapSSLPort:"3269",ldapPort:"3268",visibilityChecks:[],enableDisableChecks:[]}
]}
]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["220px","430px"],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
type:_GROUP_,numCols:6,colSpan:2,label:"   ",labelLocation:_LEFT_,items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerPort,width:"40px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPUseSSL,width:"40px"}
]}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"636",ldapPort:"389",labelLocation:_NONE_,visibilityChecks:[],enableDisableChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_CHECKBOX_,label:ZaMsg.Domain_AuthLdapStartTlsEnabled,onChange:ZaAuthConfigXWizard.startTlsEnabledChanged,trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
,{
ref:ZaDomain.A_AuthLdapSearchFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_AuthLdapFilter,labelLocation:_LEFT_,textWrapping:"soft"}
,{
ref:ZaDomain.A_AuthLdapSearchBase,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_AuthLdapSearchBase,labelLocation:_LEFT_,textWrapping:"soft"}
,{
type:_OUTPUT_,value:ZaMsg.NAD_DomainsAuthStr,colSpan:2}
]}
]}
,{
type:_CASE_,numCols:2,colSizes:["220px","430px"],caseKey:ZaAuthConfigXWizard.AUTH_CONFIG_BIND_PWD_STEP,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],items:[{
ref:ZaDomain.A_AuthUseBindPassword,type:_CHECKBOX_,label:ZaMsg.Domain_AuthUseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBindDn,type:_INPUT_,label:ZaMsg.Domain_AuthLdapBindDn,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword],visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBindPassword,type:_SECRET_,label:ZaMsg.Domain_AuthLdapBindPassword,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword],visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBindPasswordConfirm,type:_SECRET_,label:ZaMsg.Domain_AuthLdapBindPasswordConfirm,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword],visibilityChecks:[]}
]}
,{
type:_CASE_,numCols:2,colSizes:["220px","430px"],caseKey:ZaAuthConfigXWizard.AUTH_CONFIG_SUMMARY_STEP,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isAuthMechNotZimbra],items:[{
type:_OUTPUT_,value:ZaMsg.Domain_Auth_ConfigSummary,align:_CENTER_,colSpan:"*"}
,{
type:_SPACER_,height:10}
,{
ref:ZaDomain.A_AuthMech,type:_OUTPUT_,label:ZaMsg.Domain_AuthMech,choices:this.AuthMechs,alignment:_LEFT_}
,{
type:_GROUP_,useParentTable:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthADDomainName,type:_OUTPUT_,label:ZaMsg.Domain_AuthADDomainName,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_}
]}
]}
,{
type:_GROUP_,useParentTable:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,visibilityChecks:[],items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_,visibilityChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapStartTlsEnabled,labelLocation:_LEFT_,choices:ZaModel.BOOLEAN_CHOICES,visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchFilter,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapFilter,labelLocation:_LEFT_,visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapSearchBase,labelLocation:_LEFT_,visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthUseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_AuthUseBindPassword,labelLocation:_LEFT_,choices:ZaModel.BOOLEAN_CHOICES}
,{
ref:ZaDomain.A_AuthLdapSearchBindDn,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapBindDn,labelLocation:_LEFT_,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],visibilityChangeEventSources:[ZaDomain.A_AuthUseBindPassword]}
]}
,{
type:_SPACER_,height:10}
,{
type:_OUTPUT_,value:ZaMsg.Domain_AuthProvideLoginPwd,align:_CENTER_,colSpan:"*",visibilityChecks:[]}
,{
type:_TEXTFIELD_,label:ZaMsg.LBL_Domain_AuthTestUserName,ref:ZaDomain.A_AuthTestUserName,alignment:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_SECRET_,label:ZaMsg.LBL_Domain_AuthTestPassword,ref:ZaDomain.A_AuthTestPassword,alignment:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
]}
,{
type:_CASE_,caseKey:ZaAuthConfigXWizard.AUTH_TEST_STEP,numCols:1,colSizes:["100%"],visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isAuthMechNotZimbra],visibilityChangeEventSources:[ZaModel.currentStep],items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_AuthTestingInProgress,style:DwtAlert.WARNING}
]}
,{
type:_CASE_,numCols:2,colSizes:["220px","430px"],caseKey:ZaAuthConfigXWizard.AUTH_TEST_RESULT_STEP,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isAuthMechNotZimbra],visibilityChangeEventSources:[ZaModel.currentStep],items:[{
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,content:ZaMsg.Domain_AuthTestSuccessful,alignment:_CENTER_,colSpan:2,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthTestResultCode,ZaDomain.Check_OK]],visibilityChangeEventSources:[ZaDomain.A_AuthTestResultCode]}
,{
type:_GROUP_,isTabGroup:false,deferred:false,colSpan:2,visibilityChangeEventSources:[ZaDomain.A_AuthTestResultCode],visibilityChecks:[function(){
return(this.getInstanceValue(ZaDomain.A_AuthTestResultCode)!=ZaDomain.Check_OK)
}
],items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_AuthTestFailed,alignment:_CENTER_,colSpan:2,style:DwtAlert.CRITICAL}
,{
type:_OUTPUT_,ref:ZaDomain.A_AuthTestResultCode,label:ZaMsg.LBL_Domain_AuthTestResultCode,choices:this.TestResultChoices}
,{
type:_OUTPUT_,ref:ZaDomain.A_AuthComputedBindDn,label:ZaMsg.LBL_Domain_AuthComputedBindDn,visibilityChangeEventSources:[ZaDomain.A_AuthMech],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]]}
,{
type:_TEXTAREA_,ref:ZaDomain.A_AuthTestMessage,label:ZaMsg.LBL_Domain_AuthTestMessage,height:150,alignment:_LEFT_,width:"320px"}
]}
]}
,{
type:_CASE_,caseKey:ZaAuthConfigXWizard.CONFIG_COMPLETE_STEP,items:[{
type:_OUTPUT_,value:ZaMsg.Domain_Auth_Config_Complete}
]}
]}
]
};
ZaXDialog.XFormModifiers.ZaAuthConfigXWizard.push(ZaAuthConfigXWizard.myXFormModifier);
ZaAuthConfigXWizard.startTlsEnabledChanged=function(h,r,s){
this.setInstanceValue(h);
var e=s.getInstance();
var l=e.attrs[ZaDomain.A_AuthLdapURL];
var n=[];
if(ZaSettings.isDomainAdmin&&(e.attrs[ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled]=="TRUE")&&e.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]!="TRUE"){
e[ZaDomain.A2_allowClearTextLDAPAuth]="FALSE";
for(var o=0;
o<l.length;
o++){
var t=l[o];
if(t==null||t.length<=0){}else{
l[o]=t.replace("ldap://","ldaps://");
n.push(l[o])
}}}else{
for(var o=0;
o<l.length;
o++){
var t=l[o];
if(t==null||t.length<=0){}else{
n.push(l[o])
}}
e[ZaDomain.A2_allowClearTextLDAPAuth]="TRUE"
}
e.attrs[ZaDomain.A_AuthLdapURL]=n;
s.refresh()
}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaTaskAuthConfigWizard")){
ZaTaskAuthConfigWizard=function(e){
ZaXWizardDialog.call(this,e,null,ZaMsg.NCD_AuthConfigTitle,"700px","350px","ZaTaskAuthConfigWizard",null,ZaId.DLG_AUTH_CONFIG);
this.AuthMechs=[{
label:"<b>"+ZaMsg.AuthMech_zimbra+"</b>",value:ZaDomain.AuthMech_zimbra}
,{
label:"<b>"+ZaMsg.AuthMech_ldap+"</b>",value:ZaDomain.AuthMech_ldap}
,{
label:"<b>"+ZaMsg.AuthMech_ad+"</b>",value:ZaDomain.AuthMech_ad}
];
this.TestResultChoices=[{
label:ZaMsg.AuthTest_check_OK,value:ZaDomain.Check_OK}
,{
label:ZaMsg.AuthTest_check_UNKNOWN_HOST,value:ZaDomain.Check_UNKNOWN_HOST}
,{
label:ZaMsg.AuthTest_check_CONNECTION_REFUSED,value:ZaDomain.Check_CONNECTION_REFUSED}
,{
label:ZaMsg.AuthTest_check_SSL_HANDSHAKE_FAILURE,value:ZaDomain.Check_SSL_HANDSHAKE_FAILURE}
,{
label:ZaMsg.AuthTest_check_COMMUNICATION_FAILURE,value:ZaDomain.Check_COMMUNICATION_FAILURE}
,{
label:ZaMsg.AuthTest_check_AUTH_FAILED,value:ZaDomain.Check_AUTH_FAILED}
,{
label:ZaMsg.AuthTest_check_AUTH_NOT_SUPPORTED,value:ZaDomain.Check_AUTH_NOT_SUPPORTED}
,{
label:ZaMsg.AuthTest_check_NAME_NOT_FOUND,value:ZaDomain.Check_NAME_NOT_FOUND}
,{
label:ZaMsg.AuthTest_check_INVALID_SEARCH_FILTER,value:ZaDomain.Check_INVALID_SEARCH_FILTER}
,{
label:ZaMsg.AuthTest_check_FAILURE,value:ZaDomain.Check_FAILURE}
];
this.TAB_INDEX=0;
ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP=++this.TAB_INDEX;
ZaTaskAuthConfigWizard.AUTH_CONFIG_AUTH_SET_STEP=++this.TAB_INDEX;
ZaTaskAuthConfigWizard.AUTH_CONFIG_BIND_PWD_STEP=++this.TAB_INDEX;
ZaTaskAuthConfigWizard.AUTH_CONFIG_SUMMARY_STEP=++this.TAB_INDEX;
ZaTaskAuthConfigWizard.EXTERNAL_LDAP_GROUP_STEP=++this.TAB_INDEX;
ZaTaskAuthConfigWizard.CONFIG_COMPLETE_STEP=++this.TAB_INDEX;
ZaTaskAuthConfigWizard.AUTH_CONFIG_START_STEP=ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP;
this.STEPS=[ZaTaskAuthConfigWizard.AUTH_CONFIG_START_STEP];
this.stepChoices=[{
label:ZaMsg.stepAuthModeForDomain,value:ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP}
,{
label:ZaMsg.stepAuthSetting,value:ZaTaskAuthConfigWizard.AUTH_CONFIG_AUTH_SET_STEP}
,{
label:ZaMsg.stepAuthBindLDAP,value:ZaTaskAuthConfigWizard.AUTH_CONFIG_BIND_PWD_STEP}
,{
label:ZaMsg.stepAuthSummary,value:ZaTaskAuthConfigWizard.AUTH_CONFIG_SUMMARY_STEP}
,{
label:ZaMsg.NAD_ExternalGroup_Setting,value:ZaTaskAuthConfigWizard.EXTERNAL_LDAP_GROUP_STEP}
,{
label:ZaMsg.DomainConfigComplete,value:ZaTaskAuthConfigWizard.CONFIG_COMPLETE_STEP}
];
this.initForm(ZaDomain.myXModel,this.getMyXForm());
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaTaskAuthConfigWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaTaskAuthConfigWizard.prototype.handleXFormChange));
this.lastErrorStep=0;
this._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domains/authentication_settings.htm?locid="+AjxEnv.DEFAULT_LOCALE
};
ZaTaskAuthConfigWizard.prototype=new ZaXWizardDialog;
ZaTaskAuthConfigWizard.prototype.constructor=ZaTaskAuthConfigWizard;
ZaTaskAuthConfigWizard.prototype.cacheDialog=false;
ZaXDialog.XFormModifiers.ZaTaskAuthConfigWizard=new Array();
if(ZaDomain){
ZaDomain.A2_zimbraSpnegoAuthRealm="zimbraSpnegoAuthRealm";
ZaDomain.A2_zimbraSpnegoAuthErrorURL="zimbraSpnegoAuthErrorURL";
ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled="zimbraSpnegoGlobalAuthEnabled";
ZaDomain.A2_zimbraSpnegoAuthSummary="zimbraSpnegoAuthSummary";
ZaDomain.A2_zimbraSpnegoApplyFor="zimbraSpnegoApplyFor";
ZaDomain.A2_zimbraSpnegoAuthPrincipal="zimbraSpnegoAuthPrincipal";
ZaDomain.A2_zimbraSpnegoAuthTargetName="zimbraSpnegoAuthTargetName";
ZaDomain.A2_zimbraSpnegoUAAllBrowsers="zimbraSpnegoUA_AllBrowsers";
ZaDomain.A2_zimbraSpnegoUASupportedBrowsers="zimbraSpnegoUA_SupportedBrowsers";
ZaDomain.A2_zimbraSpnegoUACustomBrowsers="zimbraSpnegoUA_CustomBrowsers";
ZaDomain.A2_zimbraWebClientURLAllowedUA="zimbraWebClientURLAllowedUA";
ZaDomain.A2_zimbraSpnegoTargetServer="zimbraSpnegoTargetServer";
ZaDomain.A2_zimbraSpnegoGlobalSettingStatus="zimbraSpnegoGlobalSettingStatus";
ZaDomain.A_zimbraExternalGroupLdapSearchBase="zimbraExternalGroupLdapSearchBase";
ZaDomain.A_zimbraExternalGroupLdapSearchFilter="zimbraExternalGroupLdapSearchFilter";
ZaDomain.A_zimbraExternalGroupHandlerClass="zimbraExternalGroupHandlerClass";
ZaDomain.A_zimbraAuthMechAdmin="zimbraAuthMechAdmin";
ZaDomain.A2_zimbraExternalGroupLdapEnabled="zimbraExternalGroupLdapEnabled";
ZaDomain.A2_zimbraAuthConfigTestStatus="zimbraAuthConfigTestStatus";
if(ZaDomain.myXModel){
ZaDomain.myXModel.items.push({
id:ZaDomain.A2_zimbraSpnegoApplyFor,ref:ZaDomain.A2_zimbraSpnegoApplyFor,type:_STRING_}
,{
id:ZaDomain.A2_zimbraSpnegoGlobalSettingStatus,ref:ZaDomain.A2_zimbraSpnegoGlobalSettingStatus,type:_STRING_}
,{
id:ZaDomain.A2_zimbraWebClientURLAllowedUA,ref:ZaDomain.A2_zimbraWebClientURLAllowedUA,type:_STRING_}
,{
id:ZaDomain.A2_zimbraSpnegoTargetServer,type:_STRING_,ref:ZaDomain.A2_zimbraSpnegoTargetServer}
,{
id:ZaDomain.A2_zimbraSpnegoAuthPrincipal,ref:ZaDomain.A2_zimbraSpnegoAuthPrincipal,type:_STRING_}
,{
id:ZaDomain.A2_zimbraSpnegoAuthRealm,ref:ZaDomain.A2_zimbraSpnegoAuthRealm,type:_STRING_}
,{
id:ZaDomain.A2_zimbraSpnegoAuthTargetName,ref:ZaDomain.A2_zimbraSpnegoAuthTargetName,type:_STRING_}
,{
id:ZaDomain.A2_zimbraSpnegoAuthErrorURL,ref:ZaDomain.A2_zimbraSpnegoAuthErrorURL,type:_STRING_}
,{
id:ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled,ref:ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A2_zimbraSpnegoAuthSummary,ref:ZaDomain.A2_zimbraSpnegoAuthSummary,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A2_zimbraSpnegoUAAllBrowsers,ref:ZaDomain.A2_zimbraSpnegoUAAllBrowsers,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A2_zimbraSpnegoUASupportedBrowsers,ref:ZaDomain.A2_zimbraSpnegoUASupportedBrowsers,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A2_zimbraSpnegoUACustomBrowsers,ref:ZaDomain.A2_zimbraSpnegoUACustomBrowsers,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A2_zimbraAuthConfigTestStatus,ref:ZaDomain.A2_zimbraAuthConfigTestStatus,type:_ENUM_,choices:["STANDBY","RUNNING","RUNNED"]}
);
ZaDomain.myXModel.items.push({
id:ZaDomain.A2_zimbraExternalGroupLdapEnabled,ref:ZaDomain.A2_zimbraExternalGroupLdapEnabled,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES}
,{
id:ZaDomain.A_zimbraExternalGroupLdapSearchBase,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraExternalGroupLdapSearchBase}
,{
id:ZaDomain.A_zimbraExternalGroupLdapSearchFilter,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraExternalGroupLdapSearchFilter}
,{
id:ZaDomain.A_zimbraExternalGroupHandlerClass,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraExternalGroupHandlerClass}
,{
id:ZaDomain.A_zimbraAuthMechAdmin,type:_STRING_,ref:"attrs/"+ZaDomain.A_zimbraAuthMechAdmin}
)
}
ZaTaskAuthConfigWizard.loadExtLdapGroup=function(e){
if(!this.attrs[ZaDomain.A_zimbraExternalGroupHandlerClass]){
this.attrs[ZaDomain.A_zimbraExternalGroupHandlerClass]="com.zimbra.cs.account.grouphandler.ADGroupHandler"
}
if(!this.attrs[ZaDomain.A_zimbraAuthMechAdmin]){
this.attrs[ZaDomain.A_zimbraAuthMechAdmin]=ZaDomain.AuthMech_ad
}
if(this.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_zimbra){
this[ZaDomain.A2_zimbraExternalGroupLdapEnabled]="TRUE"
}else{
this[ZaDomain.A2_zimbraExternalGroupLdapEnabled]="FALSE"
}};
ZaTaskAuthConfigWizard.loadAuthConfWizard=function(e){
this[ZaDomain.A2_zimbraAuthConfigTestStatus]="STANDBY"
};
ZaItem.loadMethods.ZaDomain.push(ZaTaskAuthConfigWizard.loadAuthConfWizard);
ZaItem.loadMethods.ZaDomain.push(ZaTaskAuthConfigWizard.loadExtLdapGroup)
}
ZaDomain.TARGET_SERVER_CHOICES=[];
ZaTaskAuthConfigWizard.prototype.handleXFormChange=function(){
if(this._localXForm.hasErrors()){
if(this.lastErrorStep<this._containedObject[ZaModel.currentStep]){
this.lastErrorStep=this._containedObject[ZaModel.currentStep]
}}else{
this.lastErrorStep=0
}
this.changeButtonStateForStep(this._containedObject[ZaModel.currentStep])
};
ZaTaskAuthConfigWizard.prototype.changeButtonStateForStep=function(o){
this._button[DwtDialog.CANCEL_BUTTON].setVisible(true);
this._button[ZaXWizardDialog.HELP_BUTTON].setVisible(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setVisible(true);
if(this.lastErrorStep==o){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
if(o>1){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}else{
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
}else{
if(o==ZaTaskAuthConfigWizard.CONFIG_COMPLETE_STEP){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true)
}else{
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_AUTH_SET_STEP){
var e=false;
var t=this._containedObject.attrs[ZaDomain.A_AuthMech];
if(((t==ZaDomain.AuthMech_ad)&&!AjxUtil.isEmpty(this._localXForm.getInstanceValue(ZaDomain.A_AuthADDomainName)))||((t==ZaDomain.AuthMech_ldap)&&!AjxUtil.isEmpty(this._localXForm.getInstanceValue(ZaDomain.A_AuthLdapURL)))){
e=true
}
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(e);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}else{
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}}}}};
ZaTaskAuthConfigWizard.prototype.testSetings=function(){
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
this._containedObject.attrs[ZaDomain.A_AuthLdapUserDn]="%u@"+this._containedObject.attrs[ZaDomain.A_AuthADDomainName]
}
var e=new AjxCallback(this,this.checkCallBack);
ZaDomain.testAuthSettings(this._containedObject,e)
};
ZaTaskAuthConfigWizard.prototype.checkCallBack=function(e){
if(!e){
return
}
if(e.isException()){
this._containedObject[ZaDomain.A_AuthTestResultCode]=e.getException().code;
this._containedObject[ZaDomain.A_AuthTestMessage]=e.getException().detail+"\n"+e.getException().msg
}else{
var t=e.getResponse().Body.CheckAuthConfigResponse;
this._containedObject[ZaDomain.A_AuthTestResultCode]=t.code[0]._content;
if(this._containedObject[ZaDomain.A_AuthTestResultCode]!=ZaDomain.Check_OK){
this._containedObject[ZaDomain.A_AuthTestMessage]=t.message[0]._content
}else{
if(t.bindDn!=null){
this._containedObject[ZaDomain.A_AuthComputedBindDn]=t.bindDn[0]._content
}else{
this._containedObject[ZaDomain.A_AuthComputedBindDn]=""
}}}
this._containedObject[ZaDomain.A2_zimbraAuthConfigTestStatus]="RUNNED";
this._localXForm.refresh()
};
ZaTaskAuthConfigWizard.onAuthMechChange=function(o,t,e){
this.setInstanceValue(o);
if(o==ZaDomain.AuthMech_ad){
if(!e.getInstance().attrs[ZaDomain.A_AuthADDomainName]){
this.setInstanceValue(e.getInstance().attrs[ZaDomain.A_domainName],ZaDomain.A_AuthADDomainName)
}}};
ZaTaskAuthConfigWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this.changeButtonStateForStep(ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP)
};
ZaTaskAuthConfigWizard.prototype.goPage=function(e){
ZaXWizardDialog.prototype.goPage.call(this,e);
this.changeButtonStateForStep(e)
};
ZaTaskAuthConfigWizard.prototype.goPrev=function(){
if(this.STEPS.length>1){
this.STEPS.pop();
this.goPage(this.STEPS[this.STEPS.length-1])
}else{
this.goPage(this.STEPS[0])
}};
ZaTaskAuthConfigWizard.prototype.goNext=function(){
var o=this._containedObject[ZaModel.currentStep];
var e=o+1;
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_AUTH_SET_STEP&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ldap){
var t=this._containedObject.attrs[ZaDomain.A_AuthLdapURL].join(" ");
if(this._containedObject.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]=="TRUE"){
if(t.indexOf("ldaps://")>-1){
ZaApp.getInstance().getCurrentController().popupWarningDialog(ZaMsg.Domain_WarningStartTLSIgnored)
}}}else{
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_BIND_PWD_STEP){
if(this._containedObject[ZaDomain.A_AuthUseBindPassword]=="FALSE"){
this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindDn]=null;
this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindPassword]=null;
this._containedObject[ZaDomain.A_AuthLdapSearchBindPasswordConfirm]=null
}
if(this._containedObject.attrs[ZaDomain.A_AuthLdapSearchBindPassword]!=this._containedObject[ZaDomain.A_AuthLdapSearchBindPasswordConfirm]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}}}
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
e=ZaTaskAuthConfigWizard.CONFIG_COMPLETE_STEP
}else{
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_SUMMARY_STEP){
if(this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
e=ZaTaskAuthConfigWizard.EXTERNAL_LDAP_GROUP_STEP
}else{
e=ZaTaskAuthConfigWizard.CONFIG_COMPLETE_STEP
}}else{
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_AUTH_SET_STEP&&this._containedObject.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_ad){
if(!this._containedObject.attrs[ZaDomain.A_AuthLdapURL]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_LDAP_URL_REQUIRED);
return false
}}else{
if(o==ZaTaskAuthConfigWizard.AUTH_TEST_RESULT_STEP){
if(this._containedObject.attrs[ZaDomain.A_AuthMech]!=ZaDomain.AuthMech_ad){
e=ZaTaskAuthConfigWizard.CONFIG_COMPLETE_STEP
}}}}}
if(o==ZaTaskAuthConfigWizard.AUTH_CONFIG_SUMMARY_STEP||e==ZaTaskAuthConfigWizard.AUTH_CONFIG_SUMMARY_STEP){
this._localXForm.setInstanceValue("STANDBY",ZaDomain.A2_zimbraAuthConfigTestStatus)
}
this.STEPS.push(e);
this.goPage(e)
};
ZaTaskAuthConfigWizard.prototype.setObject=function(n){
this._containedObject=new Object();
this._containedObject.attrs=new Object();
for(var t in n.attrs){
this._containedObject.attrs[t]=n.attrs[t]
}
this._containedObject.name=n.name;
this._containedObject.type=n.type;
this._containedObject.id=n.id;
if(n.rights){
this._containedObject.rights=n.rights
}
if(n.setAttrs){
this._containedObject.setAttrs=n.setAttrs
}
if(n.getAttrs){
this._containedObject.getAttrs=n.getAttrs
}
if(n._defaultValues){
this._containedObject._defaultValues=n._defaultValues
}
if(n[ZaDomain.A2_zimbraExternalGroupLdapEnabled]){
this._containedObject[ZaDomain.A2_zimbraExternalGroupLdapEnabled]=n[ZaDomain.A2_zimbraExternalGroupLdapEnabled]
}
this._containedObject[ZaDomain.A_AuthUseBindPassword]=n[ZaDomain.A_AuthUseBindPassword];
this.setTitle(ZaMsg.NCD_AuthConfigTitle+" ("+n.name+")");
if(ZaSettings.isDomainAdmin&&(n.attrs[ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled]=="TRUE")&&n.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]!="TRUE"){
this._containedObject[ZaDomain.A2_allowClearTextLDAPAuth]="FALSE"
}
var o=ZaApp.getInstance().getServerList().getArray();
for(var e=0;
e<o.length;
e++){
ZaDomain.TARGET_SERVER_CHOICES.push({
label:o[e].name,value:o[e].id}
)
}
if(o.length>0){
this._containedObject[ZaDomain.A2_zimbraSpnegoTargetServer]=o[0].id
}
if(this._containedObject.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]&&this._containedObject.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]&&(this._containedObject.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA].join(";")==this._containedObject.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA].join(";"))&&(this._containedObject.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA].join(";")==ZaDomain.SPNEGO_SUPPORT_UA.join(";"))){
this._containedObject[ZaDomain.A2_zimbraSpnegoUASupportedBrowsers]="TRUE"
}else{
this._containedObject[ZaDomain.A2_zimbraSpnegoUACustomBrowsers]="TRUE"
}
if(this._containedObject.attrs[ZaDomain.A_zimbraWebClientLoginURL]||this._containedObject.attrs[ZaDomain.A_zimbraWebClientLogoutURL]||(this._containedObject.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]&&this._containedObject.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA].length>0)){
this._containedObject[ZaDomain.A2_zimbraSpnegoAuthEnabled]="TRUE"
}
var s=ZaApp.getInstance().getGlobalConfig();
this._containedObject[ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled]=s.attrs[ZaGlobalConfig.A_zimbraSpnegoAuthEnabled];
this._containedObject[ZaDomain.A2_zimbraSpnegoAuthErrorURL]=s.attrs[ZaGlobalConfig.A_zimbraSpnegoAuthErrorURL];
this._containedObject[ZaDomain.A2_zimbraSpnegoAuthRealm]=s.attrs[ZaGlobalConfig.A_zimbraSpnegoAuthRealm];
this._containedObject[ZaDomain.A2_zimbraSpnegoGlobalSettingStatus]=ZaTaskAuthConfigWizard.getGlobalSettingMsg(this._containedObject);
this._containedObject[ZaModel.currentStep]=n[ZaModel.currentStep]||ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP;
this._containedObject[ZaDomain.A2_zimbraSpnegoUAAllBrowsers]=n[ZaDomain.A2_zimbraSpnegoUAAllBrowsers]||"FALSE";
this._containedObject[ZaDomain.A2_zimbraSpnegoUASupportedBrowsers]=n[ZaDomain.A2_zimbraSpnegoUASupportedBrowsers]||"FALSE";
this._containedObject[ZaDomain.A2_zimbraSpnegoUACustomBrowsers]=n[ZaDomain.A2_zimbraSpnegoUACustomBrowsers]||"FALSE";
this._containedObject._uuid=n._extid||n._uuid;
this._containedObject._editObject=n._editObject;
this._localXForm.setInstance(this._containedObject)
};
ZaTaskAuthConfigWizard.prototype.finishWizard=function(){
try{
ZaDomain.modifyAuthSettings.call(this._containedObject._editObject,this._containedObject);
ZaApp.getInstance().getDomainListController()._fireDomainChangeEvent(this._containedObject._editObject);
this.popdown();
ZaApp.getInstance().getDomainListController().notifyAllOpenTabs(this._containedObject._editObject)
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaTaskAuthConfigWizard.prototype.finishWizard",null,false)
}};
ZaTaskAuthConfigWizard.myXFormModifier=function(t){
var e={};
e[ZaTaskAuthConfigWizard.AUTH_CONFIG_AUTH_SET_STEP]={
checks:[[XForm.checkInstanceValueNot,ZaDomain.A_AuthMech,ZaDomain.AuthMech_zimbra]],sources:[ZaDomain.A_AuthMech]};
e[ZaTaskAuthConfigWizard.AUTH_CONFIG_BIND_PWD_STEP]={
checks:[[XForm.checkInstanceValueNot,ZaDomain.A_AuthMech,ZaDomain.AuthMech_zimbra]],sources:[ZaDomain.A_AuthMech]};
e[ZaTaskAuthConfigWizard.AUTH_CONFIG_BIND_PWD_STEP]={
checks:[[XForm.checkInstanceValueNot,ZaDomain.A_AuthMech,ZaDomain.AuthMech_zimbra]],sources:[ZaDomain.A_AuthMech]};
e[ZaTaskAuthConfigWizard.AUTH_CONFIG_SUMMARY_STEP]={
checks:[[XForm.checkInstanceValueNot,ZaDomain.A_AuthMech,ZaDomain.AuthMech_zimbra]],sources:[ZaDomain.A_AuthMech]};
e[ZaTaskAuthConfigWizard.EXTERNAL_LDAP_GROUP_STEP]={
checks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],sources:[ZaDomain.A_AuthMech]};
t.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,cssStyle:"white-space: normal",ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep],labelVisibility:e}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:580,valign:_TOP_,cssStyle:"white-space: normal",items:[{
type:_CASE_,numCols:2,colSizes:["60px","430px"],caseKey:ZaTaskAuthConfigWizard.AUTH_CONFIG_CHOOSE_MODE_STEP,items:[{
type:_OUTPUT_,value:ZaMsg.authForDomainMsg,colSpan:"*",cssStyle:"padding-left:10px;padding-top:10px;"}
,{
type:_SPACER_,height:10}
,{
ref:ZaDomain.A_AuthMech,type:_RADIO_,groupname:"auth_mechanism_group",label:"<b>"+ZaMsg.AuthMech_zimbra+"</b>",labelLocation:_RIGHT_,updateElement:function(o){
this.getElement().checked=(o==ZaDomain.AuthMech_zimbra)
}
,elementChanged:function(s,n,o){
this.getForm().itemChanged(this,ZaDomain.AuthMech_zimbra,o);
this.setInstanceValue("FALSE",ZaDomain.A2_zimbraExternalGroupLdapEnabled)
}
,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["80px","*"],items:[{
type:_OUTPUT_,label:"",value:ZaMsg.domainAuthDlgInternalHelp}
]}
,{
type:_SPACER_,height:15}
,{
ref:ZaDomain.A_AuthMech,type:_RADIO_,groupname:"auth_mechanism_group",label:"<b>"+ZaMsg.AuthMech_ad+"</b>",labelLocation:_RIGHT_,updateElement:function(o){
this.getElement().checked=(o==ZaDomain.AuthMech_ad)
}
,elementChanged:function(s,n,o){
this.getForm().itemChanged(this,ZaDomain.AuthMech_ad,o);
this.setInstanceValue("TRUE",ZaDomain.A2_zimbraExternalGroupLdapEnabled)
}
,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["80px","*"],items:[{
type:_OUTPUT_,label:"",value:ZaMsg.domainAuthDlgADHelp}
]}
,{
type:_SPACER_,height:15}
,{
ref:ZaDomain.A_AuthMech,type:_RADIO_,groupname:"auth_mechanism_group",label:"<b>"+ZaMsg.AuthMech_ldap+"</b>",labelLocation:_RIGHT_,updateElement:function(o){
this.getElement().checked=(o==ZaDomain.AuthMech_ldap)
}
,elementChanged:function(s,n,o){
this.getForm().itemChanged(this,ZaDomain.AuthMech_ldap,o);
this.setInstanceValue("TRUE",ZaDomain.A2_zimbraExternalGroupLdapEnabled)
}
,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["80px","*"],items:[{
type:_OUTPUT_,label:"",value:ZaMsg.domainAuthDlgExternalHelp}
]}
]}
,{
type:_CASE_,numCols:2,colSizes:["150px","430px"],caseKey:ZaTaskAuthConfigWizard.AUTH_CONFIG_AUTH_SET_STEP,cellpadding:10,items:[{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["150px","430px"],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
type:_OUTPUT_,value:ZaMsg.authForADMsg,colSpan:"*"}
,{
type:_SPACER_,height:20,colSpan:2}
,{
ref:ZaDomain.A_AuthADDomainName,type:_TEXTFIELD_,label:ZaMsg.Domain_AuthADDomainName,labelLocation:_LEFT_,labelCssStyle:"text-align:left;padding-left:20px;",required:true,visibilityChecks:[],enableDisableChecks:[],bmolsnr:true}
,{
type:_SPACER_,height:10,colSpan:2}
,{
type:_OUTPUT_,label:ZaMsg.Domain_AuthADServer,value:" ",labelCssStyle:"text-align:left;padding-left:20px;"}
,{
type:_GROUP_,numCols:6,colSpan:2,label:null,labelLocation:_LEFT_,containerCssStyle:"padding-left:20px;",items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADServerName,width:"200px",getDisplayValue:function(o){
return o+'<span class="redAsteric">*</span>'
}}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADServerPort,width:"40px",getDisplayValue:function(o){
return o+'<span class="redAsteric">*</span>'
}}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthADUseSSL,width:"40px"}
]}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,colSpan:"*",containerCssStyle:"padding-left:20px;",repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,labelLocation:_NONE_,ldapSSLPort:"3269",ldapPort:"3268",visibilityChecks:[],enableDisableChecks:[]}
]}
]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["150px","430px"],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
type:_OUTPUT_,value:ZaMsg.authForLDAPMsg,colSpan:"*"}
,{
type:_SPACER_,height:20,colSpan:2}
,{
type:_OUTPUT_,value:"LDAP Setting",colSpan:"*"}
,{
type:_GROUP_,numCols:6,colSpan:2,label:null,labelLocation:_LEFT_,items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerName,width:"200px",getDisplayValue:function(o){
return o+'<span class="redAsteric">*</span>'
}}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerPort,width:"40px",getDisplayValue:function(o){
return o+'<span class="redAsteric">*</span>'
}}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPUseSSL,width:"40px"}
]}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,colSpan:"*",cssStyle:"padding-left:10px;",addButtonLabel:ZaMsg.Domain_AddURL,removeButtonLabel:ZaMsg.Domain_REPEAT_REMOVE,showAddOnNextRow:true,items:[{
ref:".",type:_LDAPURL_,label:null,ldapSSLPort:"636",ldapPort:"389",labelLocation:_NONE_,visibilityChecks:[],enableDisableChecks:[]}
]}
,{
type:_SPACER_,height:10,colSpan:2}
,{
ref:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_CHECKBOX_,label:ZaMsg.Domain_AuthLdapStartTlsEnabled,onChange:ZaTaskAuthConfigWizard.startTlsEnabledChanged,trueValue:"TRUE",falseValue:"FALSE"}
,{
type:_SPACER_,height:10,colSpan:2}
,{
ref:ZaDomain.A_AuthLdapSearchFilter,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_AuthLdapFilter,labelCssStyle:"text-align:left;",labelLocation:_LEFT_,textWrapping:"soft"}
,{
type:_SPACER_,height:10,colSpan:2}
,{
ref:ZaDomain.A_AuthLdapSearchBase,type:_TEXTAREA_,width:380,height:40,label:ZaMsg.Domain_AuthLdapSearchBase,labelCssStyle:"text-align:left;",labelLocation:_LEFT_,textWrapping:"soft"}
,{
type:_SPACER_,height:20,colSpan:2}
,{
type:_OUTPUT_,value:ZaMsg.NAD_DomainsAuthStr,colSpan:2}
]}
]}
,{
type:_CASE_,numCols:2,colSizes:["150px","430px"],caseKey:ZaTaskAuthConfigWizard.AUTH_CONFIG_BIND_PWD_STEP,visibilityChecks:[[Case_XFormItem.prototype.isCurrentTab]],items:[{
ref:ZaDomain.A_AuthUseBindPassword,type:_CHECKBOX_,label:ZaMsg.Domain_AuthUseBindPassword,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBindDn,type:_INPUT_,label:ZaMsg.Domain_AuthLdapBindDn,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword],visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBindPassword,type:_SECRET_,label:ZaMsg.Domain_AuthLdapBindPassword,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword],visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBindPasswordConfirm,type:_SECRET_,label:ZaMsg.Domain_AuthLdapBindPasswordConfirm,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A_AuthUseBindPassword],visibilityChecks:[]}
]}
,{
type:_CASE_,numCols:2,colSizes:["180px","430px"],caseKey:ZaTaskAuthConfigWizard.AUTH_CONFIG_SUMMARY_STEP,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewDomainXWizard.isAuthMechNotZimbra],items:[{
type:_OUTPUT_,value:ZaMsg.authSummaryMsg,colSpan:"*"}
,{
type:_SPACER_,height:10}
,{
type:_OUTPUT_,ref:ZaDomain.A_AuthMech,label:ZaMsg.Domain_AuthMech,choices:this.AuthMechs,alignment:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;"}
,{
type:_GROUP_,useParentTable:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ad]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthADDomainName,type:_OUTPUT_,label:ZaMsg.Domain_AuthADDomainName,labelLocation:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;"}
,{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,showAddButton:false,showRemoveButton:false,labelCssStyle:"text-align:right;padding-left:20px;",items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_}
]}
]}
,{
type:_GROUP_,useParentTable:true,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthMech,ZaDomain.AuthMech_ldap]],visibilityChangeEventSources:[ZaDomain.A_AuthMech],items:[{
ref:ZaDomain.A_AuthLdapURL,type:_REPEAT_,label:ZaMsg.Domain_AuthLdapURL,labelLocation:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",showAddButton:false,showRemoveButton:false,visibilityChecks:[],items:[{
type:_OUTPUT_,ref:".",label:null,labelLocation:_NONE_,visibilityChecks:[]}
]}
,{
ref:ZaDomain.A_zimbraAuthLdapStartTlsEnabled,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapStartTlsEnabled,labelLocation:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",choices:ZaModel.BOOLEAN_CHOICES,visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchFilter,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapFilter,labelLocation:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthLdapSearchBase,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapSearchBase,labelLocation:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",visibilityChecks:[]}
,{
ref:ZaDomain.A_AuthUseBindPassword,type:_OUTPUT_,label:ZaMsg.Domain_AuthUseBindPassword,labelLocation:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",choices:ZaModel.BOOLEAN_CHOICES}
,{
ref:ZaDomain.A_AuthLdapSearchBindDn,type:_OUTPUT_,label:ZaMsg.Domain_AuthLdapBindDn,labelLocation:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A_AuthUseBindPassword,"TRUE"]],visibilityChangeEventSources:[ZaDomain.A_AuthUseBindPassword]}
]}
,{
type:_SPACER_,height:20}
,{
type:_OUTPUT_,value:ZaMsg.Domain_AuthProvideLoginPwd,align:_LEFT_,colSpan:"*",visibilityChecks:[]}
,{
type:_SPACER_,height:10}
,{
type:_GROUP_,numCols:2,colSpan:"*",colSizes:["100px","auto"],width:"100%",items:[{
type:_TEXTFIELD_,label:ZaMsg.LBL_Domain_AuthTestUserName,ref:ZaDomain.A_AuthTestUserName,alignment:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",width:"150px",visibilityChecks:[],enableDisableChecks:[]}
,{
type:_SECRET_,label:ZaMsg.LBL_Domain_AuthTestPassword,ref:ZaDomain.A_AuthTestPassword,alignment:_LEFT_,labelCssStyle:"text-align:right;padding-left:20px;",width:"150px",visibilityChecks:[],enableDisableChecks:[]}
]}
,{
type:_GROUP_,numCols:1,colSpan:"*",colSizes:["300px","200px","auto"],cssStyle:"margin-bottom:10px;padding-bottom:0px;margin-top:10px;margin-left:10px;margin-right:10px;",items:[{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Domain_AuthTestSettings,width:"100px",ref:ZaDomain.A2_zimbraAuthConfigTestStatus,onActivate:"ZaTaskAuthConfigWizard.autoTestSetting.call(this);"}
,{
type:_GROUP_,isTabGroup:false,deferred:false,colSpan:2,colSizes:["100px","400px"],visibilityChangeEventSources:[ZaModel.currentStep,ZaDomain.A2_zimbraAuthConfigTestStatus],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAuthConfigTestStatus,"RUNNING"]],items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_AuthTestingInProgress,alignment:_CENTER_,colSpan:2,style:DwtAlert.INFO}
]}
,{
type:_GROUP_,isTabGroup:false,deferred:false,colSpan:2,colSizes:["100px","400px"],visibilityChangeEventSources:[ZaDomain.A2_zimbraAuthConfigTestStatus,ZaDomain.A_AuthTestResultCode],visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAuthConfigTestStatus,"RUNNED"],[XForm.checkInstanceValue,ZaDomain.A_AuthTestResultCode,ZaDomain.Check_OK]],items:[{
type:_DWT_ALERT_,style:DwtAlert.INFORMATION,content:ZaMsg.Domain_AuthTestSuccessful,alignment:_CENTER_,colSpan:2}
,{
type:_OUTPUT_,ref:ZaDomain.A_AuthComputedBindDn,label:ZaMsg.LBL_Domain_AuthComputedBindDn}
]}
,{
type:_GROUP_,isTabGroup:false,deferred:false,colSpan:2,colSizes:["100px","400px"],visibilityChangeEventSources:[ZaDomain.A2_zimbraAuthConfigTestStatus,ZaDomain.A_AuthTestResultCode],visibilityChecks:[function(){
return(this.getInstanceValue(ZaDomain.A2_zimbraAuthConfigTestStatus)=="RUNNED")&&(this.getInstanceValue(ZaDomain.A_AuthTestResultCode)!=ZaDomain.Check_OK)
}
],items:[{
type:_DWT_ALERT_,content:ZaMsg.Domain_AuthTestFailed,alignment:_CENTER_,colSpan:2,style:DwtAlert.CRITICAL}
,{
type:_OUTPUT_,ref:ZaDomain.A_AuthTestResultCode,label:ZaMsg.LBL_Domain_AuthTestResultCode,choices:this.TestResultChoices}
,{
type:_OUTPUT_,value:ZaMsg.LBL_Domain_AuthTestMessage,colSpan:2}
,{
type:_TEXTAREA_,ref:ZaDomain.A_AuthTestMessage,height:80,alignment:_LEFT_,colSpan:2}
]}
]}
]}
,{
type:_CASE_,caseKey:ZaTaskAuthConfigWizard.EXTERNAL_LDAP_GROUP_STEP,colSizes:["200px","*"],items:[{
type:_OUTPUT_,ref:ZaDomain.A_zimbraAuthMechAdmin,label:"Auth Mech for Admin:",choices:this.AuthMechs}
,{
type:_TEXTAREA_,ref:ZaDomain.A_zimbraExternalGroupLdapSearchBase,label:"External Group LDAP Search Base:"}
,{
type:_TEXTAREA_,ref:ZaDomain.A_zimbraExternalGroupLdapSearchFilter,label:"External Group LDAP Search Filter:"}
,{
type:_TEXTFIELD_,ref:ZaDomain.A_zimbraExternalGroupHandlerClass,width:"100%",label:"External Group Handle Class Name:"}
]}
,{
type:_CASE_,caseKey:ZaTaskAuthConfigWizard.CONFIG_COMPLETE_STEP,items:[{
type:_OUTPUT_,value:ZaMsg.Domain_Auth_Config_Complete}
]}
]}
]
};
ZaXDialog.XFormModifiers.ZaTaskAuthConfigWizard.push(ZaTaskAuthConfigWizard.myXFormModifier);
ZaTaskAuthConfigWizard.startTlsEnabledChanged=function(h,r,s){
this.setInstanceValue(h);
var e=s.getInstance();
var l=e.attrs[ZaDomain.A_AuthLdapURL];
var n=[];
if(ZaSettings.isDomainAdmin&&(e.attrs[ZaDomain.A_zimbraAdminConsoleLDAPAuthEnabled]=="TRUE")&&e.attrs[ZaDomain.A_zimbraAuthLdapStartTlsEnabled]!="TRUE"){
e[ZaDomain.A2_allowClearTextLDAPAuth]="FALSE";
for(var o=0;
o<l.length;
o++){
var t=l[o];
if(t==null||t.length<=0){}else{
l[o]=t.replace("ldap://","ldaps://");
n.push(l[o])
}}}else{
for(var o=0;
o<l.length;
o++){
var t=l[o];
if(t==null||t.length<=0){}else{
n.push(l[o])
}}
e[ZaDomain.A2_allowClearTextLDAPAuth]="TRUE"
}
e.attrs[ZaDomain.A_AuthLdapURL]=n;
s.refresh()
};
ZaTaskAuthConfigWizard.autoTestSetting=function(){
this.getForm().setInstanceValue("RUNNING",ZaDomain.A2_zimbraAuthConfigTestStatus);
var e=this.getForm().parent;
e.testSetings()
};
ZaTaskAuthConfigWizard.checkSpnegoApplyType=function(t,o){
var e=this.getInstance();
return(e[t]==o)
};
ZaTaskAuthConfigWizard.changeSpnegoGlobalConfig=function(){
var e=this.getInstance();
ZaTaskAuthConfigWizard.spnegoGlobalServerSetting(e,ZaItem.GLOBAL_CONFIG)
};
ZaTaskAuthConfigWizard.changeSpnegoServerConfig=function(){
var e=this.getInstance();
ZaTaskAuthConfigWizard.spnegoGlobalServerSetting(e,ZaItem.SERVER)
};
ZaTaskAuthConfigWizard.changeSpnegoDomainConfig=function(){
var e=this.getInstance();
e[ZaDomain.A2_zimbraSpnegoApplyFor]=ZaItem.DOMAIN;
var t=this.getForm().parent;
t.goPage(ZaTaskAuthConfigWizard.SPNEGO_CONFIG_STEP_1)
};
ZaTaskAuthConfigWizard.checkRadioEnableDisable=function(e,t){
if(!e){
return false
}
if(e.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA]&&e.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA]&&(e.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA].join(";")==e.attrs[ZaDomain.A_zimbraWebClientLogoutURLAllowedUA].join(";"))&&(e.attrs[ZaDomain.A_zimbraWebClientLoginURLAllowedUA].join(";")==ZaDomain.SPNEGO_SUPPORT_UA.join(";"))){
if(ZaDomain.A2_zimbraSpnegoUASupportedBrowsers==t){
return true
}}else{
if(ZaDomain.A2_zimbraSpnegoUACustomBrowsers==t){
return true
}}
return false
};
ZaTaskAuthConfigWizard.getGlobalSettingMsg=function(e){
if((!e[ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled]||e[ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled]=="FALSE")&&!e[ZaDomain.A2_zimbraSpnegoAuthErrorURL]&&!e[ZaDomain.A2_zimbraSpnegoAuthRealm]){
return ZaMsg.spnegoGlobalSettingEmpty
}
if(!e[ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled]||e[ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled]=="FALSE"){
return ZaMsg.spnegoGlobalSettingUnenabled
}else{
return ZaMsg.spnegoGlobalSettingUnempty
}};
ZaTaskAuthConfigWizard.customAllowedUASetting=function(){
if(!ZaApp.getInstance().dialogs.spnegoUACustomDialog){
ZaApp.getInstance().dialogs.spnegoUACustomDialog=new ZaSpnegoUACustomDialog(ZaApp.getInstance().getAppCtxt().getShell(),"450px","280px",ZaMsg.SpnegoSettingCustomDialogTitle);
ZaApp.getInstance().dialogs.spnegoUACustomDialog.registerCallback(DwtDialog.OK_BUTTON,ZaSpnegoUACustomDialog.updateSpnegoUASetting,this,ZaApp.getInstance().dialogs.spnegoUACustomDialog._localXForm)
}
var t=this.getInstanceValue(ZaDomain.A_zimbraWebClientLoginURLAllowedUA);
var e={};
if(typeof t=="string"){
e[ZaDomain.A2_zimbraWebClientURLAllowedUA]=t
}else{
if(t instanceof Array){
e[ZaDomain.A2_zimbraWebClientURLAllowedUA]=t.join("\n")
}}
ZaApp.getInstance().dialogs.spnegoUACustomDialog.setObject(e);
ZaApp.getInstance().dialogs.spnegoUACustomDialog.popup()
};
ZaTaskAuthConfigWizard.spnegoGlobalServerSetting=function(h,n){
var e={};
if(h){
e=h
}
var t=ZaMsg.SpnegoSettingGlobalDialogTitle;
if(n==ZaItem.GLOBAL_CONFIG){
e[ZaDomain.A2_zimbraSpnegoApplyFor]=ZaItem.GLOBAL_CONFIG
}else{
if(n==ZaItem.SERVER){
t=ZaMsg.SpnegoSettingServerDialogTitle;
e[ZaDomain.A2_zimbraSpnegoApplyFor]=ZaItem.SERVER;
var o=ZaApp.getInstance().getServerList().getArray();
var r=null;
for(var s=0;
s<o.length;
s++){
if(o[s].id==e[ZaDomain.A2_zimbraSpnegoTargetServer]){
r=o[s];
break
}}
if(r){
e[ZaDomain.A2_zimbraSpnegoAuthPrincipal]=r.attrs[ZaServer.A_zimbraSpnegoAuthPrincipal];
e[ZaDomain.A2_zimbraSpnegoAuthTargetName]=r.attrs[ZaServer.A_zimbraSpnegoAuthTargetName]
}}}
if(!ZaApp.getInstance().dialogs.updateGlobalServerDialog){
ZaApp.getInstance().dialogs.updateGlobalServerDialog=new ZaSpnegoGlobalServerDialog(ZaApp.getInstance().getAppCtxt().getShell(),"700px","350px",t);
ZaApp.getInstance().dialogs.updateGlobalServerDialog.registerCallback(DwtDialog.OK_BUTTON,ZaSpnegoGlobalServerDialog.updateGlobalServerSetting,e,ZaApp.getInstance().dialogs.updateGlobalServerDialog._localXForm)
}else{
ZaApp.getInstance().dialogs.updateGlobalServerDialog.setTitle(t)
}
ZaApp.getInstance().dialogs.updateGlobalServerDialog.setObject(e);
ZaApp.getInstance().dialogs.updateGlobalServerDialog.popup()
};
ZaTaskAuthConfigWizard.clientUAChanged=function(n,o,t){
var e=this.getInstance()
};
ZaSpnegoUACustomDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,"ZaSpnegoUACustomDialog",n,e,t,null,ZaId.DLG_AUTH_SPNEGO_UA);
this._containedObject={};
this.initForm(ZaAlias.myXModel,this.getMyXForm())
};
ZaSpnegoUACustomDialog.prototype=new ZaXDialog;
ZaSpnegoUACustomDialog.prototype.constructor=ZaSpnegoUACustomDialog;
ZaSpnegoUACustomDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,numCols:1,colSizes:["100%"],items:[{
type:_OUTPUT_,value:ZaMsg.SpnegoSettingCustomDialogHeader,cssStyle:"padding-bottom:20px;padding-top:10px;"}
,{
ref:ZaDomain.A2_zimbraWebClientURLAllowedUA,type:_TEXTAREA_,width:450,height:100,align:_CENTER_}
,{
type:_OUTPUT_,value:ZaMsg.SpnegoSettingCustomDialogHelp,cssStyle:"padding-bottom:10px;padding-top:20px;"}
]}
]};
return e
};
ZaSpnegoUACustomDialog.updateSpnegoUASetting=function(){
if(ZaApp.getInstance().dialogs.spnegoUACustomDialog){
ZaApp.getInstance().dialogs.spnegoUACustomDialog.popdown()
}
var t=ZaApp.getInstance().dialogs.spnegoUACustomDialog.getObject();
var e=[];
if(t[ZaDomain.A2_zimbraWebClientURLAllowedUA]){
e=t[ZaDomain.A2_zimbraWebClientURLAllowedUA].split("\n")
}
this.setInstanceValue(e,ZaDomain.A_zimbraWebClientLoginURLAllowedUA);
this.setInstanceValue(e,ZaDomain.A_zimbraWebClientLogoutURLAllowedUA)
};
ZaSpnegoGlobalServerDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,"ZaSpnegoUACustomDialog",n,e,t,null,ZaId.DLG_AUTH_SPNEGO);
this._containedObject={};
this.initForm(ZaAlias.myXModel,this.getMyXForm())
};
ZaSpnegoGlobalServerDialog.prototype=new ZaXDialog;
ZaSpnegoGlobalServerDialog.prototype.constructor=ZaSpnegoGlobalServerDialog;
ZaSpnegoGlobalServerDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,numCols:1,colSizes:["100%"],items:[{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["150px","430px"],visibilityChecks:[[ZaTaskAuthConfigWizard.checkSpnegoApplyType,ZaDomain.A2_zimbraSpnegoApplyFor,ZaItem.GLOBAL_CONFIG]],visibilityChangeEventSources:[ZaDomain.A2_zimbraSpnegoApplyFor],items:[{
type:_OUTPUT_,value:ZaMsg.spnegoGlobalSettingPageTitle,colSpan:2}
,{
type:_SPACER_,height:10,colSpan:"*"}
,{
ref:ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled,type:_CHECKBOX_,label:ZaMsg.EnableSpnegoGlobal,width:"200px",subLabel:"",labelLocation:_RIGHT_,align:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaDomain.A2_zimbraSpnegoAuthRealm,type:_TEXTFIELD_,width:"200px",label:ZaMsg.LBL_zimbraSpnegoAuthRealm,labelCssStyle:"text-align:left;padding-left:20px;"}
,{
ref:ZaDomain.A2_zimbraSpnegoAuthErrorURL,type:_TEXTFIELD_,width:"200px",label:ZaMsg.LBL_zimbraSpnegoAuthErrorURL,labelCssStyle:"text-align:left;padding-left:20px;"}
]}
,{
type:_GROUP_,colSpan:2,numCols:2,colSizes:["150px","430px"],visibilityChecks:[[ZaTaskAuthConfigWizard.checkSpnegoApplyType,ZaDomain.A2_zimbraSpnegoApplyFor,ZaItem.SERVER]],visibilityChangeEventSources:[ZaDomain.A2_zimbraSpnegoApplyFor],items:[{
type:_OUTPUT_,value:ZaMsg.spnegoServerSettingPageTitle,colSpan:2}
,{
type:_SPACER_,height:10,colSpan:"*"}
,{
ref:ZaDomain.A2_zimbraSpnegoAuthPrincipal,type:_TEXTFIELD_,labelCssStyle:"text-align:left;padding-left:20px;",label:ZaMsg.NAD_MTA_SpnegoAuthPrincipal,width:"20em",onChange:ZaServerXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A2_zimbraSpnegoAuthTargetName,type:_TEXTFIELD_,labelCssStyle:"text-align:left;padding-left:20px;",label:ZaMsg.NAD_MTA_SpnegoAuthTargetName,width:"20em",onChange:ZaServerXFormView.onFormFieldChanged}
]}
]}
]};
return e
};
ZaSpnegoGlobalServerDialog.updateGlobalServerSetting=function(){
if(ZaApp.getInstance().dialogs.updateGlobalServerDialog){
ZaApp.getInstance().dialogs.updateGlobalServerDialog.popdown()
}else{
return
}
var e=null;
var n=null;
var s=ZaApp.getInstance().dialogs.updateGlobalServerDialog.getObject();
if(s[ZaDomain.A2_zimbraSpnegoApplyFor]==ZaItem.GLOBAL_CONFIG){
var o=ZaApp.getInstance().dialogs.authWizard._localXForm;
o.setInstanceValue(ZaTaskAuthConfigWizard.getGlobalSettingMsg(s),ZaDomain.A2_zimbraSpnegoGlobalSettingStatus);
n=AjxSoapDoc.create("ModifyConfigRequest",ZaZimbraAdmin.URN,null);
if(s[ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled]){
e=n.set("a",s[ZaDomain.A2_zimbraSpnegoGlobalAuthEnabled]);
e.setAttribute("n",ZaGlobalConfig.A_zimbraSpnegoAuthEnabled)
}
if(s[ZaDomain.A2_zimbraSpnegoAuthRealm]){
e=n.set("a",s[ZaDomain.A2_zimbraSpnegoAuthRealm]);
e.setAttribute("n",ZaDomain.A2_zimbraSpnegoAuthRealm)
}
if(s[ZaDomain.A2_zimbraSpnegoAuthErrorURL]){
e=n.set("a",s[ZaDomain.A2_zimbraSpnegoAuthErrorURL]);
e.setAttribute("n",ZaDomain.A2_zimbraSpnegoAuthErrorURL)
}
var r=new Object();
r.soapDoc=n;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_CONFIG};
ZaRequestMgr.invoke(r,t)
}else{
if(s[ZaDomain.A2_zimbraSpnegoApplyFor]==ZaItem.SERVER&&s[ZaDomain.A2_zimbraSpnegoTargetServer]){
n=AjxSoapDoc.create("ModifyServerRequest",ZaZimbraAdmin.URN,null);
n.set("id",s[ZaDomain.A2_zimbraSpnegoTargetServer]);
if(s[ZaDomain.A2_zimbraSpnegoAuthPrincipal]){
e=n.set("a",s[ZaDomain.A2_zimbraSpnegoAuthPrincipal]);
e.setAttribute("n",ZaDomain.A2_zimbraSpnegoAuthPrincipal)
}
if(s[ZaDomain.A2_zimbraSpnegoAuthTargetName]){
e=n.set("a",s[ZaDomain.A2_zimbraSpnegoAuthTargetName]);
e.setAttribute("n",ZaDomain.A2_zimbraSpnegoAuthTargetName)
}
var r=new Object();
r.soapDoc=n;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_MODIFY_SERVER};
ZaRequestMgr.invoke(r,t)
}}}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaTaskAutoProvDialog")){
ZaTaskAutoProvDialog=function(n,r,o,e){
if(arguments.length==0){
return
}
var t=new DwtDialog_ButtonDescriptor(ZaTaskAutoProvDialog.APPLY_BUTTON,ZaMsg.LBL_ApplyButton,DwtDialog.ALIGN_RIGHT,new AjxCallback(this,this._applyButtonListener));
var s=new DwtDialog_ButtonDescriptor(ZaXWizardDialog.HELP_BUTTON,ZaMsg.TBB_Help,DwtDialog.ALIGN_LEFT,new AjxCallback(this,this._helpButtonListener));
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
this._extraButtons=[s,t];
this._width=o||"680px";
this._height=e||"390px";
ZaXDialog.call(this,n,null,r,this._width,this._height,null,ZaId.DLG_AUTPROV_MANUAL+"_ENHANCE");
this._containedObject={};
this.initForm(ZaDomain.myXModel,this.getMyXForm());
this._helpURL=ZaTaskAutoProvDialog.helpURL;
this._forceApplyMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+ZaId.VIEW_DMLIST+"_forceApplyConfirm");
this._forceApplyMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaTaskAutoProvDialog.prototype._forceApplyCallback,this);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaTaskAutoProvDialog.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaTaskAutoProvDialog.prototype.handleXFormChange))
};
ZaTaskAutoProvDialog.prototype=new ZaXDialog;
ZaTaskAutoProvDialog.prototype.constructor=ZaTaskAutoProvDialog;
ZaTaskAutoProvDialog.prototype.supportMinimize=true;
ZaTaskAutoProvDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domain/autoprov_manual_config.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaTaskAutoProvDialog.APPLY_BUTTON=++DwtDialog.LAST_BUTTON;
ZaTaskAutoProvDialog.prototype.getCacheName=function(){
return"ZaTaskAutoProvDialog"
};
ZaTaskAutoProvDialog.prototype.setObject=function(e){
this._containedObject=new ZaDomain();
ZaItem.prototype.copyTo.call(e,this._containedObject,true,4);
this._containedObject[ZaDomain.A2_zimbraAutoProvSearchActivated]=e[ZaDomain.A2_zimbraAutoProvSearchActivated]||"TRUE";
if(e.attrs[ZaDomain.A_zimbraAutoProvAttrMap]&&(typeof e.attrs[ZaDomain.A_zimbraAutoProvAttrMap]=="string")){
this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAttrMap]=[e.attrs[ZaDomain.A_zimbraAutoProvAttrMap]]
}
this._backupLdapObj(this._containedObject);
this._containedObject[ZaDomain.A2_zimbraAutoProvAccountPool]=e[ZaDomain.A2_zimbraAutoProvAccountPool]||[];
this._containedObject[ZaDomain.A2_zimbraAutoProvAccountTargetPool]=e[ZaDomain.A2_zimbraAutoProvAccountTargetPool]||[];
this._separateConfigureValues(this._containedObject);
this._containedObject._uuid=e._extid||e._uuid;
this._containedObject._editObject=e._editObject;
this._localXForm.setInstance(this._containedObject);
this._button[DwtDialog.OK_BUTTON].setEnabled(false);
this._button[ZaTaskAutoProvDialog.APPLY_BUTTON].setEnabled(false)
};
ZaTaskAutoProvDialog.prototype.finishWizard=function(t){
try{
if(!this._checkGeneralConfig()||!this._checkEagerConfig()||!this._checkLazyConfig()){
return
}
this._combineConfigureValues(this._containedObject);
ZaDomain.modifyAutoPovSettings.call(this._containedObject._editObject,this._containedObject);
ZaApp.getInstance().getDomainListController()._fireDomainChangeEvent(this._containedObject._editObject);
this.popdown();
ZaApp.getInstance().getDomainListController()._notifyAllOpenTabs()
}
catch(e){
this._handleException(e,"ZaDomainListController.prototype._finishAutoProvButtonListener",null,false)
}
return
};
ZaTaskAutoProvDialog.prototype.handleXFormChange=function(){
if(this._localXForm.hasErrors()){
this._button[DwtDialog.OK_BUTTON].setEnabled(false);
this._button[ZaTaskAutoProvDialog.APPLY_BUTTON].setEnabled(false)
}else{
this._button[DwtDialog.OK_BUTTON].setEnabled(true);
this._button[ZaTaskAutoProvDialog.APPLY_BUTTON].setEnabled(true)
}
this.tabClickHandler()
};
ZaTaskAutoProvDialog.prototype.getMyXForm=function(){
this.tabChoices=new Array();
this.TAB_INDEX=0;
var s,n,o,t,e;
s=++this.TAB_INDEX;
this.tabChoices.push({
value:s,label:ZaMsg.TBB_AUTOPROV_GENERAL}
);
n=++this.TAB_INDEX;
this.tabChoices.push({
value:n,label:ZaMsg.TBB_AUTOPROV_EAGER}
);
o=++this.TAB_INDEX;
this.tabChoices.push({
value:o,label:ZaMsg.TBB_AUTOPROV_LAZY}
);
this.TAB_STEP_MANUAL=t=++this.TAB_INDEX;
this.tabChoices.push({
value:t,label:ZaMsg.TBB_AUTOPROV_MANUAL}
);
e=++this.TAB_INDEX;
this.tabChoices.push({
value:e,label:ZaMsg.TBB_zimbraAutoProvEmailSetting}
);
var m=[];
var u={
type:_ZATABCASE_,numCols:2,colSizes:["150px","490px"],caseKey:s,id:"auto_provision_config_general",getCustomWidth:ZaTaskAutoProvDialog.getCustomWidth,getCustomHeight:ZaTaskAutoProvDialog.getCustomHeight,items:[{
type:_SPACER_,height:10}
,{
type:_GROUPER_,colSpan:"*",width:"100%",label:"LDAP Configuration",containerCssStyle:"padding-top:5px",enableDisableChecks:[],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled,ZaDomain.A2_zimbraAutoProvModeLAZYEnabled,ZaDomain.A2_zimbraAutoProvModeMANUALEnabled],items:[{
type:_GROUP_,numCols:6,label:"   ",labelLocation:_LEFT_,visibilityChecks:[],visibilityChangeEventSources:[],items:[{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"35px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerName,width:"200px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:" ",width:"5px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPServerPort,width:"40px"}
,{
type:_OUTPUT_,label:null,labelLocation:_NONE_,value:ZaMsg.Domain_AuthLDAPUseSSL,width:"80px"}
]}
,{
ref:ZaDomain.A_zimbraAutoProvLdapURL,type:_LDAPURL_,label:ZaMsg.LBL_zimbraAutoProvLdapURL,ldapSSLPort:"636",ldapPort:"389",labelLocation:_LEFT_,label:ZaMsg.LBL_zimbraAutoProvLdapURL}
,{
ref:ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvLdapStartTlsEnabled,subLabel:"",align:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
,{
ref:ZaDomain.A_zimbraAutoProvLdapAdminBindDn,type:_INPUT_,label:ZaMsg.LBL_zimbraAutoProvLdapAdminBindDn,labelLocation:_LEFT_,enableDisableChecks:[],enableDisableChangeEventSources:[]}
,{
ref:ZaDomain.A_zimbraAutoProvLdapAdminBindPassword,type:_SECRET_,label:ZaMsg.LBL_zimbraAutoProvLdapAdminBindPassword,labelLocation:_LEFT_}
,{
ref:ZaDomain.A_zimbraAutoProvLdapSearchFilter,type:_TEXTAREA_,width:350,height:40,label:ZaMsg.LBL_zimbraAutoProvLdapSearchFilter,labelLocation:_LEFT_,textWrapping:"soft"}
,{
ref:ZaDomain.A_zimbraAutoProvLdapSearchBase,type:_TEXTAREA_,width:350,height:40,label:ZaMsg.LBL_zimbraAutoProvLdapSearchBase,labelLocation:_LEFT_,textWrapping:"soft"}
,{
ref:ZaDomain.A_zimbraAutoProvLdapBindDn,type:_INPUT_,label:ZaMsg.LBL_zimbraAutoProvLdapBindDn,labelLocation:_LEFT_}
]}
,{
type:_SPACER_,height:10}
,{
ref:ZaDomain.A_zimbraAutoProvNotificationFromAddress,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraAutoProvNotificationFromAddress,labelLocation:_LEFT_,width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraAutoProvAccountNameMap,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraAutoProvAccountNameMap,labelLocation:_LEFT_,width:250,onChange:ZaDomainXFormView.onFormFieldChanged}
,{
ref:ZaDomain.A_zimbraAutoProvAttrMap,type:_REPEAT_,label:ZaMsg.LBL_zimbraAutoProvAttrMap,repeatInstance:"",showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_Add,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null,enableDisableChecks:[],visibilityChecks:[],onChange:ZaDomainXFormView.onFormFieldChanged}
]}
]};
m.push(u);
var d={
type:_ZATABCASE_,numCols:2,colSizes:["45px","*"],caseKey:n,id:"auto_provision_config_eager",getCustomWidth:ZaTaskAutoProvDialog.getCustomWidth,getCustomHeight:ZaTaskAutoProvDialog.getCustomHeight,items:[{
type:_SPACER_,height:20}
,{
ref:ZaDomain.A2_zimbraAutoProvModeEAGEREnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvModeEAGER,subLabel:"",align:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
,{
type:_SPACER_,height:20}
,{
type:_GROUPER_,colSpan:"*",width:"100%",label:"Configuration",containerCssStyle:"padding-top:5px",colSizes:["175px","*"],numCols:2,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvModeEAGEREnabled,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled],items:[{
ref:ZaDomain.A_zimbraAutoProvBatchSize,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraAutoProvBatchSize,autoSaveValue:true,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvModeEAGEREnabled,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled],cssClass:"admin_xform_number_input"}
,{
ref:ZaDomain.A2_zimbraAutoProvPollingInterval,type:_LIFETIME_,colSizes:["80px","100px","*"],label:ZaMsg.LBL_zimbraAutoProvPollingInterval,labelLocation:_LEFT_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvModeEAGEREnabled,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]}
,{
type:_DWT_LIST_,ref:ZaDomain.A2_zimbraAutoProvServerList,width:250,height:50,label:ZaMsg.LBL_zimbraAutoProvServerList,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top",nowrap:false,labelWrap:true,forceUpdate:true,widgetClass:ZaServerOptionList,multiselect:true,preserveSelection:true,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvModeEAGEREnabled,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled],onSelection:ZaTaskAutoProvDialog.filterSelectionListener}
]}
,{
type:_GROUPER_,colSpan:"*",width:"100%",label:"Note",containerCssStyle:"padding-top:15px",numCols:1,items:[{
type:_OUTPUT_,value:ZaMsg.MSG_AUTOPROV_DLG_EAGER}
]}
]};
m.push(d);
var c={
type:_ZATABCASE_,numCols:2,colSizes:["45px","*"],caseKey:o,id:"auto_provision_config_lazy",getCustomWidth:ZaTaskAutoProvDialog.getCustomWidth,getCustomHeight:ZaTaskAutoProvDialog.getCustomHeight,items:[{
type:_SPACER_,height:20}
,{
ref:ZaDomain.A2_zimbraAutoProvModeLAZYEnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvModeLAZY,subLabel:"",align:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
,{
type:_SPACER_,height:20}
,{
type:_GROUPER_,colSpan:"*",width:"100%",label:"Configuration",containerCssStyle:"padding-top:5px",colSizes:["200px","*"],numCols:2,items:[{
type:_GROUP_,numCols:2,label:ZaMsg.LBL_zimbraAutoProvAuthMech,labelLocation:_LEFT_,colSizes:["20px","150px"],labelCssStyle:"vertical-align:top",nowrap:false,labelWrap:true,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvModeLAZYEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvModeLAZYEnabled],items:[{
ref:ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvAuthMechLDAP,subLabel:"",trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
,{
ref:ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvAuthMechPREAUTH,subLabel:"",trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
,{
ref:ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvAuthMechKRB5,subLabel:"",trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
,{
ref:ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvAuthMechSPNEGO,subLabel:"",trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
]}
]}
,{
type:_GROUPER_,colSpan:"*",width:"100%",label:"Note",containerCssStyle:"padding-top:15px",numCols:1,items:[{
type:_OUTPUT_,value:ZaMsg.MSG_AUTOPROV_DLG_LAZY}
]}
]};
m.push(c);
var l={
type:_ZATABCASE_,numCols:2,colSizes:["45px","*"],caseKey:t,id:"auto_provision_config_lazy",getCustomWidth:ZaTaskAutoProvDialog.getCustomWidth,getCustomHeight:ZaTaskAutoProvDialog.getCustomHeight,items:[{
type:_SPACER_,height:20}
,{
ref:ZaDomain.A2_zimbraAutoProvModeMANUALEnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraAutoProvModeMANUAL,subLabel:"",align:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_,onChange:ZaTaskAutoProvDialog.onFormFieldChanged}
,{
type:_SPACER_,height:20}
,{
type:_GROUPER_,colSpan:"*",width:"100%",label:"Find & Provisioning",enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvModeMANUALEnabled,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvModeMANUALEnabled],containerCssStyle:"padding-top:5px",items:[{
type:_GROUP_,colSpan:2,numCols:3,width:"100%",colSizes:["180px","85px","180px"],cellspacing:"5px",items:[{
type:_TEXTFIELD_,cssClass:"admin_xform_name_input",width:"185px",ref:ZaSearch.A_query,label:null,elementChanged:function(y,g,p){
var f=p.charCode;
if(f==13||f==3){
ZaTaskAutoProvDialog.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,y,p)
}}
,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,width:"80px",onActivate:ZaTaskAutoProvDialog.srchButtonHndlr,align:_CENTER_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvSearchActivated,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvSearchActivated]}
,{
type:_OUTPUT_,value:ZaMsg.LBL_ManualProvAccount,visibilityChecks:[]}
,{
ref:ZaDomain.A2_zimbraAutoProvAccountPool,type:_DWT_LIST_,height:"180px",width:"180px",cssClass:"DLSource",widgetClass:ZaAccMiniListView,rowSpan:4,onSelection:ZaTaskAutoProvDialog.accPoolSelectionListener,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DWT_BUTTON_,label:AjxMsg.addAll,width:"80px",onActivate:ZaTaskAutoProvDialog.addAllButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountPool]}
,{
ref:ZaDomain.A2_zimbraAutoProvAccountTargetPool,type:_DWT_LIST_,height:"180px",width:"180px",cssClass:"DLSource",widgetClass:ZaAccMiniListView,rowSpan:4,onSelection:ZaTaskAutoProvDialog.accTargetSelectionListener,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DWT_BUTTON_,label:AjxMsg.add,width:"80px",onActivate:ZaTaskAutoProvDialog.addButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool]}
,{
type:_DWT_BUTTON_,label:AjxMsg.remove,width:"80px",onActivate:ZaTaskAutoProvDialog.removeButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool]}
,{
type:_DWT_BUTTON_,label:AjxMsg.removeAll,width:"80px",onActivate:ZaTaskAutoProvDialog.removeAllButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountTargetPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountTargetPool]}
,{
type:_GROUP_,numCols:3,colSizes:["90px","*","90px"],items:[{
type:_SPACER_,colSpan:3}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,width:75,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:ZaTaskAutoProvDialog.backPoolButtonHndlr,align:_CENTER_,enableDisableChecks:[ZaTaskAutoProvDialog.backBtnEnabled],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum,ZaDomain.A2_zimbraAutoProvSearchActivated]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,width:75,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:ZaTaskAutoProvDialog.fwdPoolButtonHndlr,align:_CENTER_,enableDisableChecks:[ZaTaskAutoProvDialog.forwardBtnEnabled],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum,ZaDomain.A2_zimbraAutoProvSearchActivated]}
]}
,{
type:_CELLSPACER_}
]}
]}
]};
m.push(l);
var h={
type:_ZATABCASE_,numCols:1,width:"98%",caseKey:e,id:"auto_provision_email_setting",getCustomWidth:ZaTaskAutoProvDialog.getCustomWidth,getCustomHeight:ZaTaskAutoProvDialog.getCustomHeight,items:[{
type:_SPACER_,height:20}
,{
type:_GROUPER_,colSpan:"*",width:"100%",label:ZaMsg.LBL_zimbraAutoProvConfiguration,containerCssStyle:"padding-top:5px",colSizes:["100px","auto"],numCols:2,items:[{
ref:ZaDomain.A_zimbraAutoProvNotificationSubject,type:_SUPER_TEXTFIELD_,colSpan:2,label:ZaMsg.LBL_zimbraAutoProvEmailSubject,labelLocation:_LEFT_,textFieldCssStyle:"width:300; margin-right:5",onChange:ZaTaskAutoProvDialog.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
,{
ref:ZaDomain.A_zimbraAutoProvNotificationBody,type:_SUPER_TEXTAREA_,colSpan:2,label:ZaMsg.LBL_zimbraAutoProvEmailBody,labelLocation:_LEFT_,textAreaCssStyle:"width:300; margin-right:5",onChange:ZaTaskAutoProvDialog.onFormFieldChanged,resetToSuperLabel:ZaMsg.NAD_ResetToGlobal}
]}
]};
m.push(h);
var r={
numCols:1,items:[{
type:_TAB_BAR_,ref:ZaModel.currentTab,choices:this.tabChoices,cssClass:"ZaTabBar",id:"xform_tabbar"}
,{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:m}
]};
return r
};
ZaTaskAutoProvDialog.onFormFieldChanged=function(s,n,o){
var t=this.getRefPath();
if(t==ZaDomain.A_zimbraAutoProvNotificationSubject||t==ZaDomain.A_zimbraAutoProvNotificationBody){
this.setInstanceValue(s);
return
}
var e=this.getInstance();
e[ZaDomain.A2_zimbraAutoProvSearchActivated]="TRUE";
this.setInstanceValue(s);
return s
};
ZaTaskAutoProvDialog.prototype._forceApplyCallback=function(){
this._applyButtonListener()
};
ZaTaskAutoProvDialog.prototype._confirmPasswordSettingCallback=function(){
if(this._confirmPasswordSettingDialog){
this._confirmPasswordSettingDialog.popdown()
}
var e=this.getObject();
if(e[ZaDomain.A2_zimbraAutoProvAccountPasswordInDlg]){
e[ZaDomain.A2_zimbraAutoProvAccountPassword]=e[ZaDomain.A2_zimbraAutoProvAccountPasswordInDlg]
}};
ZaTaskAutoProvDialog.getCustomWidth=function(){
return"100%"
};
ZaTaskAutoProvDialog.getCustomHeight=function(){
return"100%"
};
ZaTaskAutoProvDialog.prototype._applyButtonListener=function(){
if(this._forceApplyMessageDialog){
this._forceApplyMessageDialog.popdown()
}
try{
var e=ZaApp.getInstance().getCurrentController();
if(this._checkGeneralConfig()&&this._checkEagerConfig()&&this._checkLazyConfig()){
var o=this.getObject();
this._combineConfigureValues(o);
ZaDomain.modifyAutoPovSettings.call(this._containedObject,o);
e._notifyAllOpenTabs();
if(o.currentTab==4){
if(this._checkManualConfig()){
this.finishConfig()
}else{
return
}}
this._button[DwtDialog.OK_BUTTON].setEnabled(false);
this._button[ZaTaskAutoProvDialog.APPLY_BUTTON].setEnabled(false);
this._backupLdapObj(o)
}}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaTaskAutoProvDialog.prototype._applyButtonListener",null,false)
}};
ZaTaskAutoProvDialog.prototype._checkGeneralConfig=function(){
var e=false;
var t="";
if(!this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapURL]||this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapURL]==""){
e=true;
t=AjxMessageFormat.format(ZaMsg.ERROR_AUTOPROV,ZaMsg.MSG_zimbraAutoProvLdapURL)
}else{
if(!this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]||this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]==""){
e=true;
t=AjxMessageFormat.format(ZaMsg.ERROR_AUTOPROV,ZaMsg.MSG_zimbraAutoProvLdapAdminBindDn)
}else{
if(!this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]||this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]==""){
e=true;
t=AjxMessageFormat.format(ZaMsg.ERROR_AUTOPROV,ZaMsg.MSG_zimbraAutoProvLdapAdminBindPassword)
}else{
if(!this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase]||this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase]==""){
e=true;
t=AjxMessageFormat.format(ZaMsg.ERROR_AUTOPROV,ZaMsg.MSG_zimbraAutoProvLdapSearchBase)
}}}}
if(!e&&this._containedObject[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]=="TRUE"){
if(!this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter]||this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter]==""){
e=true;
t=AjxMessageFormat.format(ZaMsg.ERROR_AUTOPROV,ZaMsg.MSG_zimbraAutoProvLdapSearchFilter)
}else{
if(!this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn]||this._containedObject.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn]==""){
e=true;
t=AjxMessageFormat.format(ZaMsg.ERROR_AUTOPROV,ZaMsg.MSG_zimbraAutoProvLdapBindDn)
}}}
if(e){
ZaApp.getInstance().getCurrentController().popupErrorDialog(t);
return false
}else{
return true
}};
ZaTaskAutoProvDialog.prototype._checkEagerConfig=function(){
var e=false;
var t="";
if(!e&&this._containedObject[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]=="TRUE"){
if(!this._containedObject.attrs[ZaDomain.A_zimbraAutoProvBatchSize]||this._containedObject.attrs[ZaDomain.A_zimbraAutoProvBatchSize]==""){
e=true;
t=AjxMessageFormat.format(ZaMsg.ERROR_AUTOPROV,ZaMsg.MSG_zimbraAutoProvBatchSize)
}}
if(e){
ZaApp.getInstance().getCurrentController().popupErrorDialog(t);
return false
}else{
return true
}};
ZaTaskAutoProvDialog.prototype._checkLazyConfig=function(){
if(this._containedObject[ZaDomain.A2_zimbraAutoProvModeLAZYEnabled]=="TRUE"&&(!this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled]||this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled]=="FALSE")&&(!this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled]||this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled]=="FALSE")&&(!this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled]||this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled]=="FALSE")&&(!this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled]||this._containedObject[ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled]=="FALSE")){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_AUTOPROV_LAZYAUTH);
return false
}else{
return true
}};
ZaTaskAutoProvDialog.prototype._checkManualConfig=function(){
var r=this._containedObject.attrs[ZaDomain.A_zimbraAutoProvAttrMap];
var s=this.getObject();
var t=false;
if(r){
if(!(r instanceof Array)){
r=[r]
}
for(var o=0;
o<r.length&&!t;
o++){
var n=r[o].split("=");
if(n.length>0&&n[0].indexOf("userPassword")==0){
t=true
}}}
if(s[ZaDomain.A2_zimbraAutoProvAccountPassword]){
return true
}else{
if(!t){
if(!this._confirmPasswordSettingDialog){
var e="220px";
if(AjxEnv.isIE){
e="245px"
}
this._confirmPasswordSettingDialog=new ZaConfirmPasswordDialog(ZaApp.getInstance().getAppCtxt().getShell(),"450px",e,ZaMsg.DLG_TITILE_MANUAL_PROV)
}
this._confirmPasswordSettingDialog.registerCallback(DwtDialog.OK_BUTTON,ZaTaskAutoProvDialog.prototype._confirmPasswordSettingCallback,this,null);
this._confirmPasswordSettingDialog.setObject(this._containedObject);
this._confirmPasswordSettingDialog.popup()
}}
return t
};
ZaTaskAutoProvDialog.prototype._separateConfigureValues=function(n){
if(n.attrs[ZaDomain.A_zimbraAutoProvMode]){
if(n.attrs[ZaDomain.A_zimbraAutoProvMode] instanceof Array){
for(var r=0;
r<n.attrs[ZaDomain.A_zimbraAutoProvMode].length;
r++){
if(n.attrs[ZaDomain.A_zimbraAutoProvMode][r]=="EAGER"){
n[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvMode][r]=="LAZY"){
n[ZaDomain.A2_zimbraAutoProvModeLAZYEnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvMode][r]=="MANUAL"){
n[ZaDomain.A2_zimbraAutoProvModeMANUALEnabled]="TRUE"
}}}}}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvMode]=="EAGER"){
n[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvMode]=="LAZY"){
n[ZaDomain.A2_zimbraAutoProvModeLAZYEnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvMode]=="MANUAL"){
n[ZaDomain.A2_zimbraAutoProvModeMANUALEnabled]="TRUE"
}}}}}
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech]){
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech] instanceof Array){
for(var r=0;
r<n.attrs[ZaDomain.A_zimbraAutoProvAuthMech].length;
r++){
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech][r]=="LDAP"){
n[ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech][r]=="PREAUTH"){
n[ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech][r]=="KRB5"){
n[ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech][r]=="SPNEGO"){
n[ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled]="TRUE"
}}}}}}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="LDAP"){
n[ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="PREAUTH"){
n[ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="KRB5"){
n[ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled]="TRUE"
}else{
if(n.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=="SPNEGO"){
n[ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled]="TRUE"
}}}}}}
n[ZaDomain.A2_zimbraAutoProvServerList]=ZaApp.getInstance().getServerList(true).getArray();
n[ZaDomain.A2_zimbraAutoProvSelectedServerList]=new AjxVector();
for(var t=0;
t<n[ZaDomain.A2_zimbraAutoProvServerList].length;
t++){
var s=n[ZaDomain.A2_zimbraAutoProvServerList][t];
var o=s.attrs[ZaServer.A_zimbraAutoProvScheduledDomains];
for(var e=0;
o&&e<o.length;
e++){
if(o[e]==n.name){
n[ZaDomain.A2_zimbraAutoProvSelectedServerList].add(s.name);
s.checked=true;
if(s.attrs[ZaServer.A_zimbraAutoProvPollingInterval]){
n[ZaDomain.A2_zimbraAutoProvPollingInterval]=s.attrs[ZaServer.A_zimbraAutoProvPollingInterval]
}}}}};
ZaTaskAutoProvDialog.prototype._combineConfigureValues=function(e){
e.attrs[ZaDomain.A_zimbraAutoProvMode]=[];
if(e[ZaDomain.A2_zimbraAutoProvModeEAGEREnabled]=="TRUE"){
e.attrs[ZaDomain.A_zimbraAutoProvMode].push("EAGER")
}
if(e[ZaDomain.A2_zimbraAutoProvModeLAZYEnabled]=="TRUE"){
e.attrs[ZaDomain.A_zimbraAutoProvMode].push("LAZY")
}
if(e[ZaDomain.A2_zimbraAutoProvModeMANUALEnabled]=="TRUE"){
e.attrs[ZaDomain.A_zimbraAutoProvMode].push("MANUAL")
}
e.attrs[ZaDomain.A_zimbraAutoProvAuthMech]=[];
if(e[ZaDomain.A2_zimbraAutoProvAuthMechLDAPEnabled]=="TRUE"){
e.attrs[ZaDomain.A_zimbraAutoProvAuthMech].push("LDAP")
}
if(e[ZaDomain.A2_zimbraAutoProvAuthMechPREAUTHEnabled]=="TRUE"){
e.attrs[ZaDomain.A_zimbraAutoProvAuthMech].push("PREAUTH")
}
if(e[ZaDomain.A2_zimbraAutoProvAuthMechKRB5Enabled]=="TRUE"){
e.attrs[ZaDomain.A_zimbraAutoProvAuthMech].push("KRB5")
}
if(e[ZaDomain.A2_zimbraAutoProvAuthMechSPNEGOEnabled]=="TRUE"){
e.attrs[ZaDomain.A_zimbraAutoProvAuthMech].push("SPNEGO")
}};
ZaTaskAutoProvDialog.prototype._backupLdapObj=function(e){
if(!this._autoprovLdapObject){
this._autoprovLdapObject={}
}
if(!e||!e.attrs){
return
}
if(e.attrs[ZaDomain.A_zimbraAutoProvLdapURL]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapURL]=e.attrs[ZaDomain.A_zimbraAutoProvLdapURL]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapURL]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]=e.attrs[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]=e.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]=e.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapSearchBase]=e.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapSearchBase]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapSearchFilter]=e.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapSearchFilter]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapBindDn]=e.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvLdapBindDn]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvNotificationSubject]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvNotificationSubject]=e.attrs[ZaDomain.A_zimbraAutoProvNotificationSubject]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvNotificationSubject]=null
}
if(e.attrs[ZaDomain.A_zimbraAutoProvNotificationBody]){
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvNotificationBody]=e.attrs[ZaDomain.A_zimbraAutoProvNotificationBody]
}else{
this._autoprovLdapObject[ZaDomain.A_zimbraAutoProvNotificationBody]=null
}};
ZaTaskAutoProvDialog.prototype._checkModified=function(){
var t=this.getObject();
var e=this._autoprovLdapObject;
if((e[ZaDomain.A_zimbraAutoProvLdapURL]==t.attrs[ZaDomain.A_zimbraAutoProvLdapURL]||!e[ZaDomain.A_zimbraAutoProvLdapURL]&&!t.attrs[ZaDomain.A_zimbraAutoProvLdapURL])&&(e[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]==t.attrs[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]||!e[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled]&&!t.attrs[ZaDomain.A_zimbraAutoProvLdapStartTlsEnabled])&&(e[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]==t.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]||!e[ZaDomain.A_zimbraAutoProvLdapAdminBindDn]&&!t.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindDn])&&(e[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]==t.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]||!e[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword]&&!t.attrs[ZaDomain.A_zimbraAutoProvLdapAdminBindPassword])&&(e[ZaDomain.A_zimbraAutoProvLdapSearchBase]==t.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase]||!e[ZaDomain.A_zimbraAutoProvLdapSearchBase]&&!t.attrs[ZaDomain.A_zimbraAutoProvLdapSearchBase])&&(e[ZaDomain.A_zimbraAutoProvLdapSearchFilter]==t.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter]||!e[ZaDomain.A_zimbraAutoProvLdapSearchFilter]&&!t.attrs[ZaDomain.A_zimbraAutoProvLdapSearchFilter])&&(e[ZaDomain.A_zimbraAutoProvLdapBindDn]==t.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn]||!e[ZaDomain.A_zimbraAutoProvLdapBindDn]&&!t.attrs[ZaDomain.A_zimbraAutoProvLdapBindDn])&&(e[ZaDomain.A_zimbraAutoProvNotificationSubject]==t.attrs[ZaDomain.A_zimbraAutoProvNotificationSubject]||!e[ZaDomain.A_zimbraAutoProvNotificationSubject]&&!t.attrs[ZaDomain.A_zimbraAutoProvNotificationSubject])&&(e[ZaDomain.A_zimbraAutoProvNotificationBody]==t.attrs[ZaDomain.A_zimbraAutoProvNotificationBody]||!e[ZaDomain.A_zimbraAutoProvNotificationBody]&&!t.attrs[ZaDomain.A_zimbraAutoProvNotificationBody])){
return false
}else{
return true
}};
ZaTaskAutoProvDialog.prototype.tabClickHandler=function(){
if(this.getObject().currentTab!=this.TAB_STEP_MANUAL){
return
}
if(this._checkModified()){
var e=ZaMsg.MSG_LDAP_CHANGED;
this._forceApplyMessageDialog.setMessage(e,DwtMessageDialog.INFO_STYLE);
this._forceApplyMessageDialog.popup()
}};
ZaTaskAutoProvDialog.srchButtonHndlr=function(){
var w=this.getForm().getInstance();
var v=this.getForm().parent;
if(!v._checkGeneralConfig()){
return
}
var x=AjxSoapDoc.create("SearchAutoProvDirectoryRequest",ZaZimbraAdmin.URN,null);
x.getMethod().setAttribute("keyAttr","name");
var f=x.set("domain",w.id);
f.setAttribute("by","id");
var n="(|(mail=*)(zimbraMailAlias=*)(uid=*))";
if(w[ZaSearch.A_query]){
n=ZaSearch.getSearchByNameQuery(w[ZaSearch.A_query])
}
x.set("query",n);
var b=ZaSettings.RESULTSPERPAGE;
if(!w[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum]){
w[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum]=0
}
var s=w[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum]*ZaSettings.RESULTSPERPAGE;
var m=[ZaAccount.A_name,ZaAccount.A_mail,ZaItem.A_zimbraId,ZaAccount.A_displayname].join(",");
x.getMethod().setAttribute("keyAttr","name");
x.getMethod().setAttribute("offset",s);
x.getMethod().setAttribute("limit",b);
x.getMethod().setAttribute("attrs",m);
x.getMethod().setAttribute("refresh","1");
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvSearchActivated,"FALSE");
var k={};
k.soapDoc=x;
k.asyncMode=false;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_AUTOPROV_GETACCT};
try{
var u=ZaRequestMgr.invoke(k,t);
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvSearchActivated,"TRUE");
if(!u||u.Body.SearchAutoProvDirectoryResponse.Fault){
return
}
if(!u.Body.SearchAutoProvDirectoryResponse||!u.Body.SearchAutoProvDirectoryResponse.entry){
return
}
var d=[];
var r=u.Body.SearchAutoProvDirectoryResponse.entry;
var c=u.Body.SearchAutoProvDirectoryResponse.searchTotal;
for(var p=0;
r&&p<r.length;
p++){
var l=r[p];
var h=new Object();
h.dn=l.dn;
var g=l.a.length;
h.attrs=new Array();
for(var o=0;
o<g;
o++){
if(!h.attrs[[l.a[o].n]]){
h.attrs[[l.a[o].n]]=l.a[o]._content
}else{
if(!(h.attrs[[l.a[o].n]] instanceof Array)){
h.attrs[[l.a[o].n]]=[h.attrs[[l.a[o].n]]]
}
h.attrs[[l.a[o].n]].push(l.a[o]._content)
}}
h.name=h.attrs[ZaAccount.A_mail];
d.push(h)
}
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountPool,d);
var e=Math.ceil(c/ZaSettings.RESULTSPERPAGE);
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountPoolPageTotal,e)
}
catch(y){
ZaApp.getInstance().getCurrentController()._handleException(y,"ZaTaskAutoProvDialog.srchButtonHndlr",null,false)
}};
ZaTaskAutoProvDialog.accPoolSelectionListener=function(){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool,null)
}};
ZaTaskAutoProvDialog.addButtonHndlr=function(u){
var e=this.getForm();
var p=e.getInstance();
var m=e.getItemsById(ZaDomain.A2_zimbraAutoProvAccountPool);
if(m&&(m instanceof Array)&&m[0]&&m[0].widget){
var f=m[0].widget.getSelection();
var n=p[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?p[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
var d=(f instanceof AjxVector)?f.getArray():(f instanceof Array)?f:[f];
if(d){
d.sort(ZaItem.compareNamesDesc);
var s=[];
var l=n.length;
for(var h=0;
h<l;
h++){
s.push(n[h])
}
s.sort(ZaItem.compareNamesDesc);
var c=[];
var o=d.length;
for(var h=o-1;
h>=0;
h--){
var t=false;
l=s.length;
for(var r=l-1;
r>=0;
r--){
if(d[h].name==s[r].name){
t=true;
s.splice(r,l-r);
break
}}
if(!t){
n.push(d[h])
}}
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTargetPool,n)
}}
if(n.length>0){
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}};
ZaTaskAutoProvDialog.accTargetSelectionListener=function(){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool,null)
}};
ZaTaskAutoProvDialog.addAllButtonHndlr=function(c){
var t=this.getForm();
var u=t.getInstance();
var e=u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
var h=u[ZaDomain.A2_zimbraAutoProvAccountPool];
var l=new Array();
if(h){
var o=h.length;
var d=e.length;
for(var n=0;
n<o;
n++){
var m=false;
for(var r=d-1;
r>=0;
r--){
if(e[r].name==h[n].name){
m=true;
break
}}
if(!m){
l.push(h[n])
}}}
l=l.concat(e);
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTargetPool,l);
var u=t.getInstance();
var s=u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
if(s.length>0){
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}};
ZaTaskAutoProvDialog.removeButtonHndlr=function(d){
var e=this.getForm();
var m=e.getInstance();
var c=e.getItemsById(ZaDomain.A2_zimbraAutoProvAccountTargetPool);
if(c&&(c instanceof Array)&&c[0]&&c[0].widget){
var u=c[0].widget.getSelection();
var o=m[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?m[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
o.sort(ZaItem.compareNamesDesc);
var n=[];
var l=(u instanceof AjxVector)?u.getArray():(u instanceof Array)?u:[u];
if(l){
l.sort(ZaItem.compareNamesDesc);
var t=l.length;
var h=o.length;
for(var r=0;
r<h;
r++){
n.push(o[r])
}
for(var r=t-1;
r>=0;
r--){
var h=n.length;
for(var s=h-1;
s>=0;
s--){
if(l[r].name==n[s].name){
o.splice(s,1);
n.splice(s,h-s)
}}}
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTargetPool,o)
}}
if(o.length>0){
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}};
ZaTaskAutoProvDialog.removeAllButtonHndlr=function(o){
var t=this.getForm();
var e=t.getInstance();
e[ZaDomain.A2_zimbraAutoProvAccountTargetPool]=new Array();
var n=e[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?e[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
if(n.length>0){
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}
this.getForm().setInstance(e)
};
ZaTaskAutoProvDialog.backPoolButtonHndlr=function(e){
var t=parseInt(this.getInstanceValue("/poolPagenum"))-1;
this.setInstanceValue(t,"/poolPagenum");
ZaTaskAutoProvDialog.srchButtonHndlr.call(this,e)
};
ZaTaskAutoProvDialog.fwdPoolButtonHndlr=function(e){
var t=parseInt(this.getInstanceValue("/poolPagenum"));
this.setInstanceValue(t+1,"/poolPagenum");
ZaTaskAutoProvDialog.srchButtonHndlr.call(this,e)
};
ZaTaskAutoProvDialog.forwardBtnEnabled=function(){
return(parseInt(this.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPoolPageNum))<(parseInt(this.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPoolPageTotal))-1)&&this.getInstanceValue(ZaDomain.A2_zimbraAutoProvSearchActivated)=="TRUE")
};
ZaTaskAutoProvDialog.backBtnEnabled=function(){
return(parseInt(this.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPoolPageNum))>0&&this.getInstanceValue(ZaDomain.A2_zimbraAutoProvSearchActivated)=="TRUE")
};
ZaTaskAutoProvDialog.prototype.finishConfig=function(){
var t=this.getObject();
var n=t[ZaDomain.A2_zimbraAutoProvAccountTargetPool];
if(!n||n.length<1){
return
}
var h=AjxSoapDoc.create("BatchRequest","urn:zimbra");
h.setMethodAttribute("onerror","continue");
for(var r=0;
r<n.length;
r++){
var o=h.set("AutoProvAccountRequest",null,null,ZaZimbraAdmin.URN);
var e=h.set("domain",t.id,o);
e.setAttribute("by","id");
e=h.set("principal",n[r].dn,o);
e.setAttribute("by","dn");
if(t[ZaDomain.A2_zimbraAutoProvAccountPassword]){
e=h.set("password",t[ZaDomain.A2_zimbraAutoProvAccountPassword],o)
}}
var l=new Object();
l.soapDoc=h;
var s={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATING_GALDS,showBusy:true};
ZaRequestMgr.invoke(l,s)
};
ZaTaskAutoProvDialog.filterSelectionListener=function(n){
var r=n.target;
if(r.type&&r.type=="checkbox"){
var o=r.value;
var t=this.getForm();
var e=t.getInstance();
var s=null;
s=e[ZaDomain.A2_zimbraAutoProvSelectedServerList];
if(r.checked){
s.remove(o)
}else{
s.add(o)
}}};
ZaServerOptionList=function(t,e){
DwtListView.call(this,t,null)
};
ZaServerOptionList.prototype=new DwtListView;
ZaServerOptionList.prototype.constructor=ZaServerOptionList;
ZaServerOptionList.prototype.toString=function(){
return"ZaServerOptionList"
};
ZaServerOptionList.prototype._createItemHtml=function(r,h,t,s){
var o=new Array(10);
var l=document.createElement("div");
l[DwtListView._STYLE_CLASS]="Row";
l[DwtListView._SELECTED_STYLE_CLASS]=l[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
l.className=l[DwtListView._STYLE_CLASS];
this.associateItemWithElement(r,l,DwtListView.TYPE_LIST_ITEM);
var e=0;
var n="";
if(r.checked){
n="checked"
}
o[e++]="<table width='100%' cellspacing='0' cellpadding='0' ><tr><td width=20>";
if(this.initializeDisable){
o[e++]="<input id='"+this._htmlElId+"_schedule_"+s+"'  disabled type=checkbox value='"+r+"' "+n+"/></td>"
}else{
o[e++]="<input id='"+this._htmlElId+"_schedule_"+s+"' type=checkbox value='"+r+"' "+n+"/></td>"
}
o[e++]="<td>"+r+"</td></tr></table>";
l.innerHTML=o.join("");
return l
};
ZaConfirmPasswordDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t,null,ZaId.DLG_AUTPROV_MANUAL_PWD);
this._containedObject={};
this.initForm(ZaAlias.myXModel,this.getMyXForm());
this._helpURL=ZaConfirmPasswordDialog.helpURL;
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaConfirmPasswordDialog.prototype.handleXFormChange))
};
ZaConfirmPasswordDialog.prototype=new ZaXDialog;
ZaConfirmPasswordDialog.prototype.constructor=ZaConfirmPasswordDialog;
ZaConfirmPasswordDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domain/autoprov_manual_config.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaConfirmPasswordDialog.prototype.popup=function(e){
ZaXDialog.prototype.popup.call(this,e);
this._button[DwtDialog.OK_BUTTON].setEnabled(true);
this._localXForm.setInstanceValue(false,ZaDomain.A2_zimbraAutoProvAccountPasswordUnmatchedWarning)
};
ZaConfirmPasswordDialog.prototype.handleXFormChange=function(){
var e=this._localXForm;
if(!e||e.hasErrors()||!e.getInstance()){
return
}
var o=e.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPasswordInDlg);
var t=e.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPasswordAgainInDlg);
if(o==t){
e.setInstanceValue(false,ZaDomain.A2_zimbraAutoProvAccountPasswordUnmatchedWarning);
this._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
var n=AjxUtil.isEmpty(t);
e.setInstanceValue(!n,ZaDomain.A2_zimbraAutoProvAccountPasswordUnmatchedWarning);
this._button[DwtDialog.OK_BUTTON].setEnabled(false)
}};
ZaConfirmPasswordDialog.prototype.getMyXForm=function(){
var e={
items:[{
type:_GROUP_,numCols:2,colSizes:["200px","*"],colSpan:"*",items:[{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.MSG_AUTOPROV_MANUAL_PASSSET,width:"100%",colSpan:"*"}
,{
type:_SPACER_,height:10,colSpan:"*"}
,{
ref:ZaDomain.A2_zimbraAutoProvAccountPasswordInDlg,type:_SECRET_,msgName:ZaMsg.LBL_provisionedAccountPassword,label:ZaMsg.LBL_provisionedAccountPassword,labelLocation:_LEFT_,width:"190px",cssClass:"admin_xform_name_input"}
,{
type:_SPACER_,height:10,colSpan:"*"}
,{
ref:ZaDomain.A2_zimbraAutoProvAccountPasswordAgainInDlg,type:_SECRET_,msgName:ZaMsg.NAD_ConfirmPassword,label:ZaMsg.NAD_ConfirmPassword,labelLocation:_LEFT_,width:"190px",cssClass:"admin_xform_name_input"}
,{
ref:ZaDomain.A2_zimbraAutoProvAccountPasswordUnmatchedWarning,type:_DWT_ALERT_,style:DwtAlert.CRITICAL,iconVisible:false,label:"",labelLocation:_LEFT_,width:"180px",colSpan:"1",content:ZaMsg.ERROR_PASSWORD_MISMATCH,visibilityChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvAccountPasswordUnmatchedWarning,true]],visibilityChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountPasswordUnmatchedWarning]}
]}
]};
return e
};
ZaServerOptionList.prototype.setEnabled=function(e){
DwtListView.prototype.setEnabled.call(this,e);
this.initializeDisable=!e;
if(!AjxUtil.isEmpty(this._list)){
for(var t=0;
t<this._list.size();
t++){
document.getElementById(this._htmlElId+"_schedule_"+t).disabled=!e
}}}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaManualProvConfigDialog")){
ZaManualProvConfigDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t,null,ZaId.DLG_AUTPROV_MANUAL);
this._containedObject={};
this.initForm(ZaDomain.myXModel,this.getMyXForm());
this._helpURL=ZaManualProvConfigDialog.helpURL
};
ZaManualProvConfigDialog.prototype=new ZaXDialog;
ZaManualProvConfigDialog.prototype.constructor=ZaManualProvConfigDialog;
ZaManualProvConfigDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_domain/autoprov_manual_config.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaManualProvConfigDialog.prototype.setObject=function(e){
e[ZaDomain.A2_zimbraAutoProvSearchActivated]="TRUE";
this._button[DwtDialog.OK_BUTTON].setEnabled(false);
ZaXDialog.prototype.setObject.call(this,e)
};
ZaManualProvConfigDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0px",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.MSG_AUTOPROV_MANUAL,visibilityChecks:[],colSpan:"2"}
,{
type:_SPACER_,height:10}
,{
type:_GROUP_,colSpan:2,numCols:3,width:"100%",colSizes:["180px","85px","180px"],cellspacing:"5px",items:[{
type:_TEXTFIELD_,cssClass:"admin_xform_name_input",width:"185px",ref:ZaSearch.A_query,label:null,elementChanged:function(s,n,o){
var t=o.charCode;
if(t==13||t==3){
ZaManualProvConfigDialog.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,s,o)
}}
,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,width:"80px",onActivate:ZaManualProvConfigDialog.srchButtonHndlr,align:_CENTER_,enableDisableChecks:[[XForm.checkInstanceValue,ZaDomain.A2_zimbraAutoProvSearchActivated,"TRUE"]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvSearchActivated]}
,{
type:_OUTPUT_,value:ZaMsg.LBL_ManualProvAccount,visibilityChecks:[]}
,{
ref:ZaDomain.A2_zimbraAutoProvAccountPool,type:_DWT_LIST_,height:"200px",width:"180px",cssClass:"DLSource",widgetClass:ZaAccMiniListView,rowSpan:4,onSelection:ZaManualProvConfigDialog.accPoolSelectionListener,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DWT_BUTTON_,label:AjxMsg.addAll,width:"80px",onActivate:ZaManualProvConfigDialog.addAllButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountPool]}
,{
ref:ZaDomain.A2_zimbraAutoProvAccountTargetPool,type:_DWT_LIST_,height:"200px",width:"180px",cssClass:"DLSource",widgetClass:ZaAccMiniListView,rowSpan:4,onSelection:ZaManualProvConfigDialog.accTargetSelectionListener,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DWT_BUTTON_,label:AjxMsg.add,width:"80px",onActivate:ZaManualProvConfigDialog.addButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool]}
,{
type:_DWT_BUTTON_,label:AjxMsg.remove,width:"80px",onActivate:ZaManualProvConfigDialog.removeButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool]}
,{
type:_DWT_BUTTON_,label:AjxMsg.removeAll,width:"80px",onActivate:ZaManualProvConfigDialog.removeAllButtonHndlr,enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDomain.A2_zimbraAutoProvAccountTargetPool]],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountTargetPool]}
,{
type:_GROUP_,numCols:3,colSizes:["90px","*","90px"],items:[{
type:_SPACER_,colSpan:3}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,width:75,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:ZaManualProvConfigDialog.backPoolButtonHndlr,align:_CENTER_,enableDisableChecks:[ZaManualProvConfigDialog.backBtnEnabled],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum,ZaDomain.A2_zimbraAutoProvSearchActivated]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,width:75,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:ZaManualProvConfigDialog.fwdPoolButtonHndlr,align:_CENTER_,enableDisableChecks:[ZaManualProvConfigDialog.forwardBtnEnabled],enableDisableChangeEventSources:[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum,ZaDomain.A2_zimbraAutoProvSearchActivated]}
]}
,{
type:_CELLSPACER_}
]}
]}
]};
return e
};
ZaManualProvConfigDialog.srchButtonHndlr=function(){
var w=this.getForm().getInstance();
var v=this.getForm().parent;
var x=AjxSoapDoc.create("SearchAutoProvDirectoryRequest",ZaZimbraAdmin.URN,null);
x.getMethod().setAttribute("keyAttr","name");
var f=x.set("domain",w.id);
f.setAttribute("by","id");
var n="";
if(w[ZaSearch.A_query]){
n=ZaSearch.getSearchByNameQuery(w[ZaSearch.A_query])
}
x.set("query",n);
var b=ZaSettings.RESULTSPERPAGE;
if(!w[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum]){
w[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum]=0
}
var s=w[ZaDomain.A2_zimbraAutoProvAccountPoolPageNum]*ZaSettings.RESULTSPERPAGE;
var m=[ZaAccount.A_name,ZaAccount.A_mail,ZaItem.A_zimbraId,ZaAccount.A_displayname].join(",");
x.getMethod().setAttribute("keyAttr","name");
x.getMethod().setAttribute("offset",s);
x.getMethod().setAttribute("limit",b);
x.getMethod().setAttribute("attrs",m);
x.getMethod().setAttribute("refresh","1");
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvSearchActivated,"FALSE");
var k={};
k.soapDoc=x;
k.asyncMode=false;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_AUTOPROV_GETACCT};
try{
var u=ZaRequestMgr.invoke(k,t);
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvSearchActivated,"TRUE");
if(!u||u.Body.SearchAutoProvDirectoryResponse.Fault){
return
}
if(!u.Body.SearchAutoProvDirectoryResponse||!u.Body.SearchAutoProvDirectoryResponse.entry){
return
}
var d=[];
var r=u.Body.SearchAutoProvDirectoryResponse.entry;
var c=u.Body.SearchAutoProvDirectoryResponse.searchTotal;
for(var p=0;
r&&p<r.length;
p++){
var l=r[p];
var h=new Object();
h.dn=l.dn;
var g=l.a.length;
h.attrs=new Array();
for(var o=0;
o<g;
o++){
if(!h.attrs[[l.a[o].n]]){
h.attrs[[l.a[o].n]]=l.a[o]._content
}else{
if(!(h.attrs[[l.a[o].n]] instanceof Array)){
h.attrs[[l.a[o].n]]=[h.attrs[[l.a[o].n]]]
}
h.attrs[[l.a[o].n]].push(l.a[o]._content)
}}
h.name=h.attrs[ZaAccount.A_mail];
d.push(h)
}
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountPool,d);
var e=Math.ceil(c/ZaSettings.RESULTSPERPAGE);
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountPoolPageTotal,e)
}
catch(y){
ZaApp.getInstance().getCurrentController()._handleException(y,"ZaManualProvConfigDialog.srchButtonHndlr",null,false)
}};
ZaManualProvConfigDialog.accPoolSelectionListener=function(){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountSrcSelectedPool,null)
}};
ZaManualProvConfigDialog.addButtonHndlr=function(u){
var e=this.getForm();
var p=e.getInstance();
var m=e.getItemsById(ZaDomain.A2_zimbraAutoProvAccountPool);
if(m&&(m instanceof Array)&&m[0]&&m[0].widget){
var f=m[0].widget.getSelection();
var n=p[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?p[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
var d=(f instanceof AjxVector)?f.getArray():(f instanceof Array)?f:[f];
if(d){
d.sort(ZaItem.compareNamesDesc);
var s=[];
var l=n.length;
for(var h=0;
h<l;
h++){
s.push(n[h])
}
s.sort(ZaItem.compareNamesDesc);
var c=[];
var o=d.length;
for(var h=o-1;
h>=0;
h--){
var t=false;
l=s.length;
for(var r=l-1;
r>=0;
r--){
if(d[h].name==s[r].name){
t=true;
s.splice(r,l-r);
break
}}
if(!t){
n.push(d[h])
}}
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTargetPool,n)
}}
if(n.length>0){
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}};
ZaManualProvConfigDialog.accTargetSelectionListener=function(){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTgtSelectedPool,null)
}};
ZaManualProvConfigDialog.addAllButtonHndlr=function(c){
var t=this.getForm();
var u=t.getInstance();
var e=u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
var h=u[ZaDomain.A2_zimbraAutoProvAccountPool];
var l=new Array();
if(h){
var o=h.length;
var d=e.length;
for(var n=0;
n<o;
n++){
var m=false;
for(var r=d-1;
r>=0;
r--){
if(e[r].name==h[n].name){
m=true;
break
}}
if(!m){
l.push(h[n])
}}}
l=l.concat(e);
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTargetPool,l);
var u=t.getInstance();
var s=u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?u[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
if(s.length>0){
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}};
ZaManualProvConfigDialog.removeButtonHndlr=function(d){
var e=this.getForm();
var m=e.getInstance();
var c=e.getItemsById(ZaDomain.A2_zimbraAutoProvAccountTargetPool);
if(c&&(c instanceof Array)&&c[0]&&c[0].widget){
var u=c[0].widget.getSelection();
var o=m[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?m[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
o.sort(ZaItem.compareNamesDesc);
var n=[];
var l=(u instanceof AjxVector)?u.getArray():(u instanceof Array)?u:[u];
if(l){
l.sort(ZaItem.compareNamesDesc);
var t=l.length;
var h=o.length;
for(var r=0;
r<h;
r++){
n.push(o[r])
}
for(var r=t-1;
r>=0;
r--){
var h=n.length;
for(var s=h-1;
s>=0;
s--){
if(l[r].name==n[s].name){
o.splice(s,1);
n.splice(s,h-s)
}}}
this.getModel().setInstanceValue(this.getInstance(),ZaDomain.A2_zimbraAutoProvAccountTargetPool,o)
}}
if(o.length>0){
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
e.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}};
ZaManualProvConfigDialog.removeAllButtonHndlr=function(o){
var t=this.getForm();
var e=t.getInstance();
e[ZaDomain.A2_zimbraAutoProvAccountTargetPool]=new Array();
var n=e[ZaDomain.A2_zimbraAutoProvAccountTargetPool]?e[ZaDomain.A2_zimbraAutoProvAccountTargetPool]:[];
if(n.length>0){
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(true)
}else{
t.parent._button[DwtDialog.OK_BUTTON].setEnabled(false)
}
this.getForm().setInstance(e)
};
ZaManualProvConfigDialog.backPoolButtonHndlr=function(e){
var t=parseInt(this.getInstanceValue("/poolPagenum"))-1;
this.setInstanceValue(t,"/poolPagenum");
ZaManualProvConfigDialog.srchButtonHndlr.call(this,e)
};
ZaManualProvConfigDialog.fwdPoolButtonHndlr=function(e){
var t=parseInt(this.getInstanceValue("/poolPagenum"));
this.setInstanceValue(t+1,"/poolPagenum");
ZaManualProvConfigDialog.srchButtonHndlr.call(this,e)
};
ZaManualProvConfigDialog.forwardBtnEnabled=function(){
return(parseInt(this.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPoolPageNum))<(parseInt(this.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPoolPageTotal))-1)&&this.getInstanceValue(ZaDomain.A2_zimbraAutoProvSearchActivated)=="TRUE")
};
ZaManualProvConfigDialog.backBtnEnabled=function(){
return(parseInt(this.getInstanceValue(ZaDomain.A2_zimbraAutoProvAccountPoolPageNum))>0&&this.getInstanceValue(ZaDomain.A2_zimbraAutoProvSearchActivated)=="TRUE")
};
ZaManualProvConfigDialog.finishConfig=function(){
if(!this.parent.handleManualProvDlg){
return
}
this.parent.handleManualProvDlg.popdown();
var n=this.parent.handleManualProvDlg.getObject();
var c=this.getInstance();
var t=this.getModel().getInstanceValue(c,ZaDomain.A2_zimbraAutoProvAccountTargetPool);
var h=AjxSoapDoc.create("BatchRequest","urn:zimbra");
h.setMethodAttribute("onerror","continue");
for(var s=0;
s<t.length;
s++){
var l=h.set("AutoProvAccountRequest",null,null,ZaZimbraAdmin.URN);
var r=h.set("domain",c.id,l);
r.setAttribute("by","id");
r=h.set("principal",t[s].dn,l);
r.setAttribute("by","dn")
}
var o=new Object();
o.soapDoc=h;
var e={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_CREATING_GALDS,showBusy:true};
ZaRequestMgr.invoke(o,e)
}
}
if(AjxPackage.define("zimbraAdmin.domains.view.AddrACL_XFormItem")){
AddrACL_XFormItem=function(){};
XFormItemFactory.createItemType("_ADDR_ACL_","addracl",AddrACL_XFormItem,Composite_XFormItem);
AddrACL_XFormItem.prototype.numCols=5;
AddrACL_XFormItem.prototype.nowrap=true;
AddrACL_XFormItem.prototype.initializeItems=function(){
var e=this.getInheritedProperty("onChange");
if(e){
this.items[0].onChange=e;
this.items[1].onChange=e
}else{
this.items[0].onChange=null;
this.items[1].onChange=null
}
var t=this.getInheritedProperty("visibleBoxes");
if(t){
this.items[1].visibleBoxes=t
}
var n=this.getInheritedProperty("dataFetcherMethod");
if(n){
this.items[0].dataFetcherMethod=n
}
var o=this.getInheritedProperty("toolTipContent");
if(o){
this.items[0].toolTipContent=o
}
Composite_XFormItem.prototype.initializeItems.call(this)
};
AddrACL_XFormItem.prototype.items=[{
type:_DYNSELECT_,width:"200px",inputSize:30,ref:"name",editable:true,forceUpdate:true,dataFetcherClass:ZaSearch,visibilityChecks:[],enableDisableChecks:[],emptyText:ZaMsg.enterSearchTerm,elementChanged:function(o,t,e){
this.getForm().itemChanged(this,o,e)
}}
,{
type:_ACL_,forceUpdate:true,ref:"acl",labelLocation:_NONE_,label:null}
];
StaticAddrACL_XFormItem=function(){};
XFormItemFactory.createItemType("_STATIC_ADDR_ACL_","staticaddracl",StaticAddrACL_XFormItem,Composite_XFormItem);
StaticAddrACL_XFormItem.prototype.numCols=5;
StaticAddrACL_XFormItem.prototype.nowrap=true;
StaticAddrACL_XFormItem.prototype.initializeItems=function(){
var e=this.getInheritedProperty("onChange");
if(e){
this.items[0].onChange=e;
this.items[1].onChange=e
}else{
this.items[0].onChange=null;
this.items[1].onChange=null
}
var t=this.getInheritedProperty("visibleBoxes");
if(t){
this.items[1].visibleBoxes=t
}
Composite_XFormItem.prototype.initializeItems.call(this)
};
StaticAddrACL_XFormItem.prototype.items=[{
type:_OUTPUT_,width:"200px",ref:"name",visibilityChecks:[],enableDisableChecks:[]}
,{
type:_ACL_,forceUpdate:true,ref:"acl",labelLocation:_NONE_,label:null}
]
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaEditDomainAclXDialog")){
ZaEditDomainAclXDialog=function(o,e,t){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,ZaMsg.Edit_perms_title,e,t);
this._containedObject={
acl:{
r:0,w:0,i:0,d:0,a:0,x:0}
,name:"",gt:""};
this.initForm(ZaDomain.aclXModel,this.getMyXForm())
};
ZaEditDomainAclXDialog.prototype=new ZaXDialog;
ZaEditDomainAclXDialog.prototype.constructor=ZaEditDomainAclXDialog;
ZaEditDomainAclXDialog.prototype.getMyXForm=function(){
var e={
numCols:2,items:[{
type:_SWITCH_,items:[{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookGroupACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:".",type:_STATIC_ADDR_ACL_,label:null,labelLocation:_NONE_,visibleBoxes:{
r:true,w:true,a:false,i:true,d:true,x:false}
,forceUpdate:true,dataFetcherMethod:ZaSearch.prototype.dynSelectSearchGroups}
]}
,{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookUserACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:".",type:_STATIC_ADDR_ACL_,label:null,labelLocation:_NONE_,visibleBoxes:{
r:true,w:true,a:false,i:true,d:true,x:false}
,forceUpdate:true,dataFetcherMethod:ZaSearch.prototype.dynSelectSearch,dataFetcherTypes:[ZaSearch.ACCOUNTS],dataFetcherAttrs:[ZaItem.A_zimbraId,ZaItem.A_cn,ZaAccount.A_name,ZaAccount.A_displayname,ZaAccount.A_mail]}
]}
,{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookDomainACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:".",type:_STATIC_ADDR_ACL_,label:null,labelLocation:_NONE_,visibleBoxes:{
r:true,w:true,a:false,i:true,d:true,x:false}
,forceUpdate:true,dataFetcherMethod:ZaSearch.prototype.dynSelectSearchDomains}
]}
,{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookAllACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:"acl",type:_ACL_,label:ZaMsg.ACL_All,labelLocation:_LEFT_,visibleBoxes:{
r:true,w:true,a:false,i:true,d:true,x:false}}
]}
,{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookPublicACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:"acl",type:_ACL_,visibleBoxes:{
r:true,w:false,a:false,i:false,d:false,x:false}
,label:ZaMsg.ACL_Public,labelLocation:_LEFT_}
]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaAddDomainAclXDialog")){
ZaAddDomainAclXDialog=function(o,e,t){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,ZaMsg.Add_perms_title,e,t);
this._containedObject={
acl:{
r:0,w:0,i:0,d:0,a:0,x:0}
,name:"",gt:""};
this.initForm(ZaDomain.aclXModel,this.getMyXForm())
};
ZaAddDomainAclXDialog.prototype=new ZaXDialog;
ZaAddDomainAclXDialog.prototype.constructor=ZaAddDomainAclXDialog;
ZaAddDomainAclXDialog.prototype.getMyXForm=function(){
var e={
numCols:2,items:[{
type:_OSELECT1_,ref:"gt",choices:[{
value:ZaDomain.A_NotebookGroupACLs,label:ZaMsg.ACL_Grp}
,{
value:ZaDomain.A_NotebookUserACLs,label:ZaMsg.ACL_User}
,{
value:ZaDomain.A_NotebookDomainACLs,label:ZaMsg.ACL_Dom}
],visibilityChecks:[],enableDisableChecks:[]}
,{
type:_SWITCH_,items:[{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookGroupACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:".",type:_ADDR_ACL_,label:null,labelLocation:_NONE_,visibleBoxes:{
r:true,w:true,a:false,i:true,d:true,x:false}
,toolTipContent:ZaMsg.tt_StartTypingDLName,forceUpdate:true,dataFetcherMethod:ZaSearch.prototype.dynSelectSearchGroups}
]}
,{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookUserACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:".",type:_ADDR_ACL_,label:null,labelLocation:_NONE_,visibleBoxes:{
r:true,w:true,a:false,i:true,d:true,x:false}
,toolTipContent:ZaMsg.tt_StartTypingAccountName,forceUpdate:true,dataFetcherMethod:ZaSearch.prototype.dynSelectSearch,dataFetcherTypes:[ZaSearch.ACCOUNTS],dataFetcherAttrs:[ZaItem.A_zimbraId,ZaItem.A_cn,ZaAccount.A_name,ZaAccount.A_displayname,ZaAccount.A_mail]}
]}
,{
type:_CASE_,visibilityChecks:[[XForm.checkInstanceValue,"gt",ZaDomain.A_NotebookDomainACLs]],visibilityChangeEventSources:["gt"],items:[{
ref:".",type:_ADDR_ACL_,label:null,labelLocation:_NONE_,visibleBoxes:{
r:true,w:true,a:false,i:true,d:true,x:false}
,toolTipContent:ZaMsg.tt_StartTypingDomainName,forceUpdate:true,dataFetcherMethod:ZaSearch.prototype.dynSelectSearchDomains}
]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaGalObjMiniListView")){
ZaGalObjMiniListView=function(n,o,t,e){
if(arguments.length==0){
return
}
ZaListView.call(this,n,o,t,e);
this.hideHeader=true
};
ZaGalObjMiniListView.prototype=new ZaListView;
ZaGalObjMiniListView.prototype.constructor=ZaGalObjMiniListView;
ZaGalObjMiniListView.prototype.toString=function(){
return"ZaGalObjMiniListView"
};
ZaGalObjMiniListView.prototype.createHeaderHtml=function(e){
if(!this.hideHeader){
DwtListView.prototype.createHeaderHtml.call(this,e)
}};
ZaGalObjMiniListView.prototype._createItemHtml=function(h,t,n){
var r=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(h,e,DwtListView.TYPE_LIST_ITEM);
var c=0;
r[c++]="<table width='100%' cellspacing='2' cellpadding='0'>";
r[c++]="<tr>";
if(typeof(h)=="string"){
r[c++]="<td width=100%>";
r[c++]=AjxStringUtil.htmlEncode(h);
r[c++]="</td>"
}else{
if(this._headerList){
var o=this._headerList.length;
for(var s=0;
s<o;
s++){
var l=this._headerList[s]._field;
if(l=="fullName"){
r[c++]="<td align='left' width="+this._headerList[s]._width+"><nobr>";
r[c++]=AjxStringUtil.htmlEncode(h.fullName);
r[c++]="</nobr></td>"
}else{
if(l=="email"){
r[c++]="<td align='left' width="+this._headerList[s]._width+"><nobr>";
r[c++]=AjxStringUtil.htmlEncode(h.email);
r[c++]="</nobr></td>"
}}}}else{
if(typeof(h)=="object"&&h.email){
r[c++]="<td width=100%>";
r[c++]=AjxStringUtil.htmlEncode(h.email);
r[c++]="</td>"
}else{
r[c++]="<td width=100%>";
r[c++]=AjxStringUtil.htmlEncode(String(h));
r[c++]="</td>"
}}}
r[c++]="</tr></table>";
e.innerHTML=r.join("");
return e
};
ZaGalObjMiniListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br>",ZaMsg.Domain_GALTestNoResults,"</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaGalObjMiniListView.prototype._sortColumn=function(e,t){
if(this.parent.parent.searchAccounts){
this.parent.parent.searchAccounts(e.getSortField(),t)
}}
}
if(AjxPackage.define("zimbraAdmin.domains.view.ZaDomainAccountQuotaListView")){
ZaDomainAccountQuotaListView=function(n){
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:n,className:o,posStyle:t,headerList:e,id:ZaId.TAB_DOMAIN_MANAGE,scrollLoading:true}
);
this.setLocation(0,0);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaDomainAccountQuotaListView.prototype=new ZaListView;
ZaDomainAccountQuotaListView.prototype.constructor=ZaDomainAccountQuotaListView;
ZaDomainAccountQuotaListView.prototype.toString=function(){
return"ZaDomainAccountQuotaListView"
};
ZaDomainAccountQuotaListView.prototype._createItemHtml=function(r,t,s){
var c=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(r,e,DwtListView.TYPE_LIST_ITEM);
var p=0;
c[p++]="<table width='100%'  cellspacing='0' cellpadding='0'>";
c[p++]="<tr>";
if(this._headerList){
var n=this._headerList.length;
var d=null;
var o=null;
var l=null;
var u=null;
var m=null;
for(var h=0;
h<n;
h++){
var f=this._headerList[h]._field;
if(f==ZaAccountQuota.A2_name){
c[p++]="<td width="+this._headerList[h]._width+"><nobr>";
c[p++]=AjxStringUtil.htmlEncode(r[ZaAccountQuota.A2_name]);
c[p++]="</nobr></td>"
}else{
if(f==ZaAccountQuota.A2_quotaUsage){
c[p++]="<td width="+this._headerList[h]._width+">";
o="mbxprogressused";
l="mbxprogressbar";
d=new DwtProgressBar(this);
u=r[ZaAccountQuota.A2_quotaUsage];
m=parseInt(u);
if(m>85){
o+="Critical"
}else{
if(m>65){
o+="Warning"
}}
d.setProgressCssClass(o);
d.setWholeCssClass(l);
d.setLabel(u,true);
d.setValueByPercent(u);
c[p++]=d.getHtmlElement().innerHTML;
c[p++]="</td>";
d.dispose()
}else{
if(f==ZaAccountQuota.A2_quota){
c[p++]="<td width="+this._headerList[h]._width+">";
c[p++]=AjxStringUtil.htmlEncode(r[ZaAccountQuota.A2_quota]);
c[p++]="</td>"
}else{
if(f==ZaAccountQuota.A2_diskUsage){
c[p++]="<td width="+this._headerList[h]._width+">";
c[p++]=AjxStringUtil.htmlEncode(r[ZaAccountQuota.A2_diskUsage]);
c[p++]="</td>"
}}}}}}else{
c[p++]="<td width=100%><nobr>";
c[p++]=AjxStringUtil.htmlEncode(r[ZaAccountQuota.A2_name]);
c[p++]="</nobr></td>"
}
c[p++]="</tr></table>";
e.innerHTML=c.join("");
return e
};
ZaDomainAccountQuotaListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'>",AjxStringUtil.htmlEncode(ZaMsg.MBXStats_NoMbx),"</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaDomainAccountQuotaListView.prototype.setDomainName=function(e){
this._domainName=e
};
ZaDomainAccountQuotaListView.prototype.setSortBy=function(e){
this._sortBy=e
};
ZaDomainAccountQuotaListView.prototype.setSortAscending=function(e){
this._sortAscending=e
};
ZaDomainAccountQuotaListView.prototype._getHeaderList=function(){
var e=new Array();
var o=1;
var t=0;
e[t++]=new ZaListHeaderItem(ZaAccountQuota.A2_name,ZaMsg.MBXStats_ACCOUNT,null,250,o++,ZaAccountQuota.A2_name,true,true);
e[t++]=new ZaListHeaderItem(ZaAccountQuota.A2_diskUsage,ZaMsg.MBXStats_DISKUSAGE,null,120,o++,ZaAccountQuota.A2_diskUsage,true,true);
e[t++]=new ZaListHeaderItem(ZaAccountQuota.A2_quotaUsage,ZaMsg.MBXStats_QUOTAUSAGE,null,200,o++,ZaAccountQuota.A2_quotaUsage,true,true);
e[t++]=new ZaListHeaderItem(ZaAccountQuota.A2_quota,ZaMsg.MBXStats_QUOTA,null,"auto",o++,ZaAccountQuota.A2_quota,false,true);
return e
};
ZaDomainAccountQuotaListView.prototype._sortColumn=function(n,h){
var o=h?1:0;
var l=n._sortField;
var e=this.parent;
var t=this._domainName?this._domainName:"";
var r={};
r.domainName=t;
r.sortBy=l;
r.sortAscending=o;
var s=new AjxCallback(e,ZaDomainXFormView.updateUserQuota,r);
ZaDomain.getAccountQuota(t,0,50,l,o,s)
};
ZaDomainAccountQuotaListView.prototype._loadMsg=function(r){
var s=r.offset;
var t=this._domainName?this._domainName:"";
var h=this._sortBy?this._sortBy:null;
var o=this._sortAscending?this._sortAscending:null;
var e=r.limit;
var n=new AjxCallback(this,this.updateMoreItems);
ZaDomain.getAccountQuota(t,s,e,h,o,n)
};
ZaDomainAccountQuotaListView.prototype.updateMoreItems=function(n){
if(n&&!n.isException()){
n=n.getResponse().Body.GetQuotaUsageResponse;
if((n.account&&n.account.length>0)&&(n.searchTotal&&n.searchTotal>0)){
var t=n.account;
var o=new Array();
for(var e=0;
e<t.length;
e++){
o[e]=new ZaAccountQuota(t[e])
}
this.replenish(AjxVector.fromArray(o));
this.setScrollHasMore(n.more)
}}};
ZaAccountQuota=function(e){
this._init(e)
};
ZaAccountQuota.BytePerMB=1048576;
ZaAccountQuota.prototype.constructor=ZaAccountQuota;
ZaAccountQuota.prototype.toString=function(){
return this.name
};
ZaAccountQuota.A2_name="name";
ZaAccountQuota.A2_diskUsage="diskUsage";
ZaAccountQuota.A2_quotaUsage="quotaUsage";
ZaAccountQuota.A2_quota="quota";
ZaAccountQuota.prototype._init=function(o){
var t=0;
var e=0;
var n=0;
n=(o.used/ZaAccountQuota.BytePerMB).toFixed(2);
if(o.limit==0){
t=ZaMsg.Unlimited;
e=0
}else{
if(o.limit>=ZaAccountQuota.BytePerMB){
t=(o.limit/ZaAccountQuota.BytePerMB).toFixed()
}else{
t=1
}
e=((n*100)/t).toFixed()
}
this.name=o.name;
this.diskUsage=AjxMessageFormat.format(ZaMsg.MBXStats_DISK_MSB,[n]);
this.quotaUsage=e+"%";
this.quota=t+" MB"
}
}
if(AjxPackage.define("zimbraAdmin.cos.view.ZaCosListView")){
ZaCosListView=function(s,n){
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
this._listType=n;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:s,className:o,posStyle:t,headerList:e,id:ZaId.TAB_COS_MANAGE,scrollLoading:true}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaCosListView.prototype=new ZaListView;
ZaCosListView.prototype.constructor=ZaCosListView;
ZaCosListView.prototype.toString=function(){
return"ZaCosListView"
};
ZaCosListView.prototype.getTitle=function(){
return ZaMsg.COS_view_title
};
ZaCosListView.prototype.getTabIcon=function(){
return"COS"
};
ZaCosListView.prototype._createItemHtml=function(m,u,s){
var h=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(m,e,DwtListView.TYPE_LIST_ITEM);
var d=0;
h[d++]="<table width='100%'>";
h[d++]="<tr>";
var t=this._headerList.length;
var l=Dwt.getNextId();
var n=this._listType;
for(var r=0;
r<t;
r++){
var c=this._headerList[r]._field;
var o=this._getCellWidth(r,{}
);
if(c=="type"){
h[d++]='<td id="'+n+"_data_type_"+l+'" width='+this._headerList[r]._width+">"+AjxImg.getImageHtml("COS")+"</td>"
}else{
if(c==ZaCos.A_name){
h[d++]='<td id="'+n+"_data_name_"+l+"\" align='left' width="+this._headerList[r]._width+"><nobr>";
h[d++]=AjxStringUtil.htmlEncode(m.name);
h[d++]="</nobr></td>"
}else{
if(c==ZaCos.A_description){
h[d++]='<td id="'+n+"_data_desc_"+l+"\" align='left' width="+this._headerList[r]._width+"><nobr>";
h[d++]=AjxStringUtil.htmlEncode(ZaItem.getDescriptionValue(m.attrs[ZaCos.A_description]));
h[d++]="</nobr></td>"
}}}}
h[d++]="</tr></table>";
e.innerHTML=h.join("");
return e
};
ZaCosListView.prototype._getHeaderList=function(){
var e=new Array();
var o=1;
var t=0;
e[t++]=new ZaListHeaderItem("type",null,null,"22px",null,"objectClass",false,true);
e[t++]=new ZaListHeaderItem(ZaCos.A_name,ZaMsg.CLV_Name_col,null,"200px",o++,ZaCos.A_name,true,true);
e[t++]=new ZaListHeaderItem(ZaCos.A_description,ZaMsg.CLV_Description_col,null,"auto",null,null,true,true);
return e
}
}
if(AjxPackage.define("zimbraAdmin.cos.view.ZaCosXFormView")){
ZaCosXFormView=function(e,t){
ZaTabView.call(this,{
parent:e,iKeyName:"ZaCosXFormView",contextId:ZaId.TAB_COS_EDIT}
);
this.TAB_INDEX=0;
this.initForm(ZaCos.myXModel,this.getMyXForm(t),null)
};
ZaCosXFormView.prototype=new ZaTabView();
ZaCosXFormView.prototype.constructor=ZaCosXFormView;
ZaTabView.XFormModifiers.ZaCosXFormView=new Array();
ZaTabView.ObjectModifiers.ZaCosXFormView=[];
ZaCosXFormView.prototype.TAB_INDEX=0;
ZaCosXFormView.zimletChoices=new XFormChoices([],XFormChoices.SIMPLE_LIST);
ZaCosXFormView.themeChoices=new XFormChoices([],XFormChoices.OBJECT_LIST);
ZaCosXFormView.prototype.setObject=function(d){
d.manageSpecialAttrs();
this._containedObject=new ZaCos();
this._containedObject.attrs=new Object();
this._containedObject.name=d.name;
this._containedObject.type=d.type;
if(d.rights){
this._containedObject.rights=d.rights
}
if(d.setAttrs){
this._containedObject.setAttrs=d.setAttrs
}
if(d.getAttrs){
this._containedObject.getAttrs=d.getAttrs
}
if(d._defaultValues){
this._containedObject._defaultValues=d._defaultValues
}
if(d.id){
this._containedObject.id=d.id
}
if(d.name){
d.name=AjxStringUtil.htmlEncode(d.name)
}
if(d.attrs&&d.attrs[ZaCos.A_name]){
d.attrs[ZaCos.A_name]=AjxStringUtil.htmlEncode(d.attrs[ZaCos.A_name])
}
for(var c in d.attrs){
var r=this._localXForm.getModel().getItem(c);
if((r!=null&&r.type==_LIST_)||(d.attrs[c]!=null&&d.attrs[c] instanceof Array)){
this._containedObject.attrs[c]=ZaItem.deepCloneListItem(d.attrs[c])
}else{
this._containedObject.attrs[c]=d.attrs[c]
}}
if(d.getAttrs){
if(d.getAttrs[ZaCos.A_zimbraAvailableSkin]||d.getAttrs.all){
var h=d.attrs[ZaCos.A_zimbraAvailableSkin];
if(h!=null&&h!=""){
if(AjxUtil.isString(h)){
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin]=[h]
}else{
var o=h.length;
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin]=[];
for(var n=0;
n<o;
n++){
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin].push(h[n])
}}}else{
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin]=null
}
var h=ZaApp.getInstance().getInstalledSkins();
if(h==null){
h=[]
}else{
if(AjxUtil.isString(h)){
h=[h]
}}
var s=ZaApp.getInstance().getSkinChoices(h);
ZaCosXFormView.themeChoices.setChoices(s);
ZaCosXFormView.themeChoices.dirtyChoices()
}
if(d.getAttrs[ZaCos.A_zimbraZimletAvailableZimlets]||d.getAttrs.all){
var t=ZaZimlet.getAll(ZaZimlet.EXCLUDE_EXTENSIONS);
if(t==null){
t=[]
}
if(t instanceof ZaItemList||t instanceof AjxVector){
t=t.getArray()
}
var o=t.length;
var l=[];
for(var n=0;
n<o;
n++){
var e=t[n];
l.push(e.name)
}
ZaCosXFormView.zimletChoices.setChoices(l);
ZaCosXFormView.zimletChoices.dirtyChoices()
}}
ZaCosXFormView._domainList=ZaApp.getInstance().getDomainList(true).getArray();
if(!d[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=d[ZaModel.currentTab]
}
this.modifyContainedObject();
this._localXForm.setInstance(this._containedObject)
};
ZaCosXFormView.gotSkins=function(){
return((ZaApp.getInstance().getInstalledSkins()!=null)&&(ZaApp.getInstance().getInstalledSkins().length>0))
};
ZaCosXFormView.gotNoSkins=function(){
return !ZaCosXFormView.gotSkins.call(this)
};
ZaCosXFormView.isPasswordLockoutEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraPasswordLockoutEnabled)=="TRUE")
};
ZaCosXFormView.isMailFeatureEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraFeatureMailEnabled)=="TRUE")
};
ZaCosXFormView.isContactsFeatureEnabled=function(){
return this.getInstanceValue(ZaCos.A_zimbraFeatureContactsEnabled)=="TRUE"
};
ZaCosXFormView.isCalendarFeatureEnabled=function(){
return this.getInstanceValue(ZaCos.A_zimbraFeatureCalendarEnabled)=="TRUE"
};
ZaCosXFormView.isMailForwardingEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraFeatureMailForwardingEnabled)=="TRUE")
};
ZaCosXFormView.isBriefcaseFeatureEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraFeatureBriefcasesEnabled)=="TRUE")
};
ZaCosXFormView.FEATURE_TAB_ATTRS=[ZaCos.A_zimbraFeatureMailEnabled,ZaCos.A_zimbraFeatureReadReceiptsEnabled,ZaCos.A_zimbraFeatureContactsEnabled,ZaCos.A_zimbraFeatureDistributionListFolderEnabled,ZaCos.A_zimbraFeatureCalendarEnabled,ZaCos.A_zimbraFeatureTasksEnabled,ZaCos.A_zimbraFeatureBriefcasesEnabled,ZaCos.A_zimbraFeatureOptionsEnabled,ZaCos.A_zimbraFeatureTaggingEnabled,ZaCos.A_zimbraFeatureSharingEnabled,ZaCos.A_zimbraExternalSharingEnabled,ZaCos.A_zimbraPublicSharingEnabled,ZaCos.A_zimbraFeatureChangePasswordEnabled,ZaCos.A_zimbraFeatureSkinChangeEnabled,ZaCos.A_zimbraFeatureManageZimlets,ZaCos.A_zimbraFeatureHtmlComposeEnabled,ZaCos.A_zimbraFeatureGalEnabled,ZaCos.A_zimbraFeatureMAPIConnectorEnabled,ZaCos.A_zimbraFeatureEwsEnabled,ZaCos.A_zimbraFeatureTouchClientEnabled,ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,ZaCos.A_zimbraFeatureMailPriorityEnabled,ZaCos.A_zimbraFeatureFlaggingEnabled,ZaCos.A_zimbraImapEnabled,ZaCos.A_zimbraPop3Enabled,ZaCos.A_zimbraFeatureImapDataSourceEnabled,ZaCos.A_zimbraFeaturePop3DataSourceEnabled,ZaCos.A_zimbraFeatureConversationsEnabled,ZaCos.A_zimbraFeatureFiltersEnabled,ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,ZaCos.A_zimbraFeatureNewMailNotificationEnabled,ZaCos.A_zimbraFeatureIdentitiesEnabled,ZaCos.A_zimbraFeatureGroupCalendarEnabled,ZaCos.A_zimbraFeaturePeopleSearchEnabled,ZaCos.A_zimbraFeatureAdvancedSearchEnabled,ZaCos.A_zimbraFeatureSavedSearchesEnabled,ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,ZaCos.A_zimbraFeatureImportFolderEnabled,ZaCos.A_zimbraFeatureExportFolderEnabled,ZaCos.A_zimbraDumpsterEnabled,ZaCos.A_zimbraDumpsterPurgeEnabled,ZaCos.A_zimbraFeatureMailSendLaterEnabled,ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,ZaCos.A_zimbraFeatureSMIMEEnabled];
ZaCosXFormView.FEATURE_TAB_RIGHTS=[];
ZaCosXFormView.PREFERENCES_TAB_ATTRS=[ZaCos.A_zimbraPrefMailSendReadReceipts,ZaCos.A_zimbraPrefUseTimeZoneListInCalendar,ZaCos.A_zimbraPrefCalendarUseQuickAdd,ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,ZaCos.A_zimbraPrefTimeZoneId,ZaCos.A_zimbraPrefGalAutoCompleteEnabled,ZaCos.A_zimbraPrefAutoAddAddressEnabled,ZaCos.A_zimbraMailSignatureMaxLength,ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,ZaCos.A_zimbraPrefComposeFormat,ZaCos.A_zimbraPrefComposeInNewWindow,ZaCos.A_zimbraAllowAnyFromAddress,ZaCos.A_zimbraMailMinPollingInterval,ZaCos.A_zimbraPrefMailPollingInterval,ZaCos.A_zimbraPrefAutoSaveDraftInterval,ZaCos.A_zimbraPrefMailDefaultCharset,ZaCos.A_zimbraMaxMailItemsPerPage,ZaCos.A_zimbraPrefMailItemsPerPage,ZaCos.A_zimbraPrefGroupMailBy,ZaCos.A_zimbraPrefDisplayExternalImages,ZaCos.A_zimbraPrefMessageViewHtmlPreferred,ZaCos.A_zimbraPrefLocale,ZaCos.A_zimbraJunkMessagesIndexingEnabled,ZaCos.A_zimbraPrefShowSelectionCheckbox,ZaCos.A_zimbraPrefWarnOnExit,ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,ZaCos.A_zimbraPrefUseKeyboardShortcuts,ZaCos.A_zimbraPrefImapSearchFoldersEnabled,ZaCos.A_zimbraPrefShowSearchString,ZaCos.A_zimbraPrefMailInitialSearch,ZaCos.A_zimbraPrefClientType,ZaCos.A_zimbraPrefCalendarInitialView,ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,ZaCos.A_zimbraPrefCalendarReminderFlashTitle,ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,ZaCos.A_zimbraPrefCalendarToasterEnabled,ZaCos.A_zimbraPrefCalendarShowPastDueReminders,ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,ZaCos.A_zimbraPrefMandatorySpellCheckEnabled];
ZaCosXFormView.PREFERENCES_TAB_RIGHTS=[];
ZaCosXFormView.SKIN_TAB_ATTRS=[ZaCos.A_zimbraPrefSkin,ZaCos.A_zimbraAvailableSkin];
ZaCosXFormView.SKIN_TAB_RIGHTS=[];
ZaCosXFormView.ZIMLET_TAB_ATTRS=[ZaCos.A_zimbraZimletAvailableZimlets];
ZaCosXFormView.ZIMLET_TAB_RIGHTS=[ZaCos.RIGHT_GET_ZIMLET,ZaCos.RIGHT_LIST_ZIMLET];
ZaCosXFormView.SERVERPOOL_TAB_ATTRS=[ZaCos.A_zimbraMailHostPool];
ZaCosXFormView.SERVERPOOL_TAB_RIGHTS=[ZaCos.RIGHT_GET_HOSTNAME];
ZaCosXFormView.ADVANCED_TAB_ATTRS=[ZaCos.A_zimbraAttachmentsBlocked,ZaCos.A_zimbraMailQuota,ZaCos.A_zimbraContactMaxNumEntries,ZaCos.A_zimbraQuotaWarnPercent,ZaCos.A_zimbraQuotaWarnInterval,ZaCos.A_zimbraQuotaWarnMessage,ZaCos.A_zimbraPasswordLocked,ZaCos.A_zimbraMinPwdLength,ZaCos.A_zimbraMaxPwdLength,ZaCos.A_zimbraPasswordMinUpperCaseChars,ZaCos.A_zimbraPasswordMinLowerCaseChars,ZaCos.A_zimbraPasswordMinPunctuationChars,ZaCos.A_zimbraPasswordMinNumericChars,ZaCos.A_zimbraPasswordMinPunctuationChars,ZaCos.A_zimbraMinPwdAge,ZaCos.A_zimbraMaxPwdAge,ZaCos.A_zimbraEnforcePwdHistory,ZaCos.A_zimbraTwoFactorAuthEnabled,ZaCos.A_zimbraFeatureTwoFactorAuthRequired,ZaCos.A_zimbraTwoFactorAuthNumScratchCodes,ZaCos.A_zimbraFeatureAppSpecificPasswordsEnabled,ZaCos.A_zimbraPasswordLockoutEnabled,ZaCos.A_zimbraPasswordLockoutMaxFailures,ZaCos.A_zimbraPasswordLockoutDuration,ZaCos.A_zimbraPasswordLockoutFailureLifetime,ZaCos.A_zimbraAdminAuthTokenLifetime,ZaCos.A_zimbraAuthTokenLifetime,ZaCos.A_zimbraMailIdleSessionTimeout,ZaCos.A_zimbraMailMessageLifetime,ZaCos.A_zimbraMailTrashLifetime,ZaCos.A_zimbraMailSpamLifetime,ZaCos.A_zimbraMailDumpsterLifetime,ZaCos.A_zimbraDumpsterUserVisibleAge,ZaCos.A_zimbraFreebusyExchangeUserOrg,ZaCos.A_zimbraDataSourcePop3PollingInterval,ZaCos.A_zimbraDataSourceImapPollingInterval,ZaCos.A_zimbraDataSourceCalendarPollingInterval,ZaCos.A_zimbraDataSourceRssPollingInterval,ZaCos.A_zimbraDataSourceCaldavPollingInterval,ZaCos.A_zimbraDataSourceMinPollingInterval];
ZaCosXFormView.ADVANCED_TAB_RIGHTS=[];
ZaCosXFormView.RETENTION_POLICY_TAB_ATTRS=[];
ZaCosXFormView.RETENTION_POLICY_TAB_RIGHTS=[];
ZaCosXFormView.prototype.loadRetentionPolicies=function(){
var e=ZaRetentionPolicy.getRetentionPolicies("id",this.getForm().getInstance().id);
var t=ZaRetentionPolicy.getRetentionPolicies();
if(e[ZaRetentionPolicy.TYPE_KEEP].length){
if(ZaCosXFormView._arrayContains(t[ZaRetentionPolicy.TYPE_KEEP],e[ZaRetentionPolicy.TYPE_KEEP][0])){
this.getForm().setInstanceValue(t[ZaRetentionPolicy.TYPE_KEEP],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(t[ZaRetentionPolicy.TYPE_PURGE],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue("FALSE",ZaCos.A2_retentionPoliciesKeepInherited);
return
}}
if(e[ZaRetentionPolicy.TYPE_PURGE].length){
if(ZaCosXFormView._arrayContains(t[ZaRetentionPolicy.TYPE_PURGE],e[ZaRetentionPolicy.TYPE_PURGE][0])){
this.getForm().setInstanceValue(t[ZaRetentionPolicy.TYPE_KEEP],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(t[ZaRetentionPolicy.TYPE_PURGE],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue("FALSE",ZaCos.A2_retentionPoliciesKeepInherited);
return
}}
if(e[ZaRetentionPolicy.TYPE_PURGE].length==0&&e[ZaRetentionPolicy.TYPE_KEEP].length==0){
this.getForm().setInstanceValue(t[ZaRetentionPolicy.TYPE_KEEP],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(t[ZaRetentionPolicy.TYPE_PURGE],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue("FALSE",ZaCos.A2_retentionPoliciesKeepInherited)
}else{
this.getForm().setInstanceValue(e[ZaRetentionPolicy.TYPE_KEEP],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(e[ZaRetentionPolicy.TYPE_PURGE],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue("TRUE",ZaCos.A2_retentionPoliciesKeepInherited)
}};
ZaCosXFormView._arrayContains=function(e,o){
if(!e||!(e instanceof Array)||!o){
return false
}
for(var t=0;
t<e.length;
t++){
if(e[t].id&&o.id&&e[t].id==o.id){
return true
}}
return false
};
ZaCosXFormView.retentionSelectionListener=function(e){
this.getForm().setInstanceValue(this.getSelection(),ZaCos.A2_retentionPoliciesKeep_Selection)
};
ZaCosXFormView.purgeSelectionListener=function(){
this.getForm().setInstanceValue(this.getSelection(),ZaCos.A2_retentionPoliciesPurge_Selection)
};
ZaCosXFormView.deleteButtonListener=function(t){
var e=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep_Selection);
if(t==1){
e=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge_Selection)
}else{
if(t==2){
e=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge).length+this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep).length
}}
if(e===0){
ZaCosXFormView.deleteRetentionPolicies.call(this,t);
return
}
if(!e){
return
}
if(!ZaApp.getInstance().dialogs.DeleteRetionPolicyConfirmMessageDialog){
ZaApp.getInstance().dialogs.DeleteRetionPolicyConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+"DELETE_RETENTION_POLICY_ConfirmMessage")
}
ZaApp.getInstance().dialogs.DeleteRetionPolicyConfirmMessageDialog.setMessage(ZaMsg.Q_Delete_RetentionPolicy_Confirm,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.DeleteRetionPolicyConfirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,ZaCosXFormView.deleteRetentionPolicies,this,[t]);
ZaApp.getInstance().dialogs.DeleteRetionPolicyConfirmMessageDialog.popup()
};
ZaCosXFormView.deleteRetentionPolicies=function(n){
if(ZaApp.getInstance().dialogs.DeleteRetionPolicyConfirmMessageDialog){
ZaApp.getInstance().dialogs.DeleteRetionPolicyConfirmMessageDialog.popdown()
}
var o;
var t;
if(n==1){
o=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge_Selection);
t=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge);
if(!o){
return
}
for(var e=0;
e<o.length;
e++){
o[e].deletePolicy("id",this.getForm().getInstance().id);
AjxUtil.arrayRemove(t,o[e])
}
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue(t,ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge_Selection)
}else{
if(n==2){
t=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge);
t=t.concat(this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep));
for(var e=0;
e<t.length;
e++){
t[e].deletePolicy("id",this.getForm().getInstance().id)
}
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep);
var s=ZaRetentionPolicy.getRetentionPolicies();
this.getForm().setInstanceValue(s[ZaRetentionPolicy.TYPE_KEEP],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(s[ZaRetentionPolicy.TYPE_PURGE],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue("FALSE",ZaCos.A2_retentionPoliciesKeepInherited)
}else{
o=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep_Selection);
t=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep);
if(!o){
return
}
for(var e=0;
e<o.length;
e++){
o[e].deletePolicy("id",this.getForm().getInstance().id);
AjxUtil.arrayRemove(t,o[e])
}
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(t,ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep_Selection)
}}};
ZaCosXFormView.addButtonListener=function(e){
var t;
if(e){
t=new ZaRetentionPolicy(null,null,null,ZaRetentionPolicy.TYPE_PURGE)
}else{
t=new ZaRetentionPolicy()
}
if(!ZaApp.getInstance().dialogs.newRetentionPolicyDialog){
ZaApp.getInstance().dialogs.newRetentionPolicyDialog=new ZaRetentionPolicyDlg(ZaApp.getInstance().getAppCtxt().getShell(),"500px","100px",ZaMsg.TTL_Policy_Add);
ZaApp.getInstance().dialogs.newRetentionPolicyDialog.registerCallback(DwtDialog.OK_BUTTON,ZaCosXFormView.createRetentionPolicy,this,ZaApp.getInstance().dialogs.newRetentionPolicyDialog._localXForm)
}
ZaApp.getInstance().dialogs.newRetentionPolicyDialog.setObject(t);
ZaApp.getInstance().dialogs.newRetentionPolicyDialog.popup()
};
ZaCosXFormView.createRetentionPolicy=function(t){
if(ZaApp.getInstance().dialogs.newRetentionPolicyDialog){
var o=t.getInstance();
var e;
if(o[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
e=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep)
}else{
e=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge)
}
if(!e){
e=[]
}
if(!ZaRetentionPolicy.checkValues(o,e)){
return false
}
ZaApp.getInstance().dialogs.newRetentionPolicyDialog.popdown();
o.createPolicy("id",this.getForm().getInstance().id);
e.push(o);
if(o[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(e,ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep_Selection)
}else{
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue(e,ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge_Selection)
}}};
ZaCosXFormView.editButtonListener=function(e){
var t;
if(e){
t=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge_Selection)[0]
}else{
t=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep_Selection)[0]
}
if(!ZaApp.getInstance().dialogs.editRetentionPolicyDialog){
ZaApp.getInstance().dialogs.editRetentionPolicyDialog=new ZaRetentionPolicyDlg(ZaApp.getInstance().getAppCtxt().getShell(),"500px","100px",ZaMsg.TTL_Policy_Edit);
ZaApp.getInstance().dialogs.editRetentionPolicyDialog.registerCallback(DwtDialog.OK_BUTTON,ZaCosXFormView.updateRetentionPolicy,this,ZaApp.getInstance().dialogs.editRetentionPolicyDialog._localXForm)
}
ZaApp.getInstance().dialogs.editRetentionPolicyDialog.setObject(t);
ZaApp.getInstance().dialogs.editRetentionPolicyDialog.popup()
};
ZaCosXFormView.updateRetentionPolicy=function(o){
if(ZaApp.getInstance().dialogs.editRetentionPolicyDialog){
var n=o.getInstance();
var t;
if(n[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
t=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep)
}else{
t=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge)
}
if(!t){
t=[]
}
if(!ZaRetentionPolicy.checkValues(n,t)){
return false
}
ZaApp.getInstance().dialogs.editRetentionPolicyDialog.popdown();
n.modifyPolicy("id",this.getForm().getInstance().id);
var e=AjxUtil.indexOf(t,n);
AjxUtil.arrayRemove(t,n);
AjxUtil.arrayAdd(t,n,e);
if(n[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(t,ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep_Selection)
}else{
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue(t,ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge_Selection)
}}};
ZaCosXFormView.inheritCOSRetentionPolicies=function(o,t,e){
if(o=="TRUE"){
this.setInstanceValue(o);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesKeep_Selection);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaCos.A2_retentionPoliciesPurge_Selection)
}else{
if(o=="FALSE"){
ZaCosXFormView.deleteButtonListener.call(this,2)
}}};
ZaCosXFormView.myXFormModifier=function(z,o){
var k=new Array();
var n=1;
var T=0;
k[T++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_name,ZaMsg.CLV_Policy_Name_col,null,"200px",n,ZaRetentionPolicy.A2_name,true,true);
k[T++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_lifetime,ZaMsg.CLV_Policy_Retention_col,null,"auto",null,null,true,true);
var d=new Array();
T=0;
d[T++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_name,ZaMsg.CLV_Policy_Name_col,null,"200px",n++,ZaRetentionPolicy.A2_name,true,true);
d[T++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_lifetime,ZaMsg.CLV_Policy_Purge_col,null,"auto",null,null,true,true);
this.helpMap={};
this.tabChoices=new Array();
var D=++this.TAB_INDEX;
var C,B,W,A,O,q,x;
var r=[{
type:_AJX_IMAGE_,src:"COS_32",label:null,rowSpan:2}
,{
type:_OUTPUT_,ref:ZaCos.A_name,label:null,cssClass:"AdminTitle",visibilityChecks:[ZaItem.hasReadPermission],height:32,rowSpan:2}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID,visibilityChecks:[ZaItem.hasReadPermission]}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var F=ZaItem.formatServerTime(this.getInstanceValue());
if(!F){
return ZaMsg.Server_Time_NA
}else{
return F
}}
,visibilityChecks:[ZaItem.hasReadPermission]}
];
this.tabChoices.push({
value:D,label:ZaMsg.TABT_GeneralPage}
);
this.helpMap[D]=[location.pathname,ZaUtil.HELP_URL,ZaCosController.helpURL,"?locid=",AjxEnv.DEFAULT_LOCALE].join("");
if(ZaTabView.isTAB_ENABLED(o,ZaCosXFormView.FEATURE_TAB_ATTRS,ZaCosXFormView.FEATURE_TAB_RIGHTS)){
C=++this.TAB_INDEX;
this.tabChoices.push({
value:C,label:ZaMsg.TABT_Features}
);
this.helpMap[C]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/user_interface_features.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(o,ZaCosXFormView.PREFERENCES_TAB_ATTRS,ZaCosXFormView.PREFERENCES_TAB_RIGHTS)){
B=++this.TAB_INDEX;
this.tabChoices.push({
value:B,label:ZaMsg.TABT_Preferences}
);
this.helpMap[B]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/preferences.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(o,ZaCosXFormView.SKIN_TAB_ATTRS,ZaCosXFormView.SKIN_TAB_RIGHTS)){
W=++this.TAB_INDEX;
this.tabChoices.push({
value:W,label:ZaMsg.TABT_Themes}
);
this.helpMap[W]=[location.pathname,ZaUtil.HELP_URL,"ui_themes/defining_theme_for_the_zimbra_web_client_ui.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
var u=ZaZimlet.getAll(ZaZimlet.EXCLUDE_EXTENSIONS);
if(u!=null&&!AjxUtil.isEmpty(u.getArray())&&ZaTabView.isTAB_ENABLED(o,ZaCosXFormView.ZIMLET_TAB_ATTRS,ZaCosXFormView.ZIMLET_TAB_RIGHTS)){
A=++this.TAB_INDEX;
this.tabChoices.push({
value:A,label:ZaMsg.TABT_Zimlets}
);
this.helpMap[A]=[location.pathname,ZaUtil.HELP_URL,"zimlets/about_zimlets.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(o,ZaCosXFormView.SERVERPOOL_TAB_ATTRS,ZaCosXFormView.SERVERPOOL_TAB_RIGHTS)){
O=++this.TAB_INDEX;
this.tabChoices.push({
value:O,label:ZaMsg.TABT_ServerPool}
);
this.helpMap[O]=[location.pathname,ZaUtil.HELP_URL,"cos/assigning_accounts_to_different_servers.htm?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(o,ZaCosXFormView.ADVANCED_TAB_ATTRS,ZaCosXFormView.ADVANCED_TAB_RIGHTS)){
q=++this.TAB_INDEX;
this.tabChoices.push({
value:q,label:ZaMsg.TABT_Advanced}
);
this.helpMap[q]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/account_advanced_features.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(o,ZaCosXFormView.RETENTION_POLICY_TAB_ATTRS,ZaCosXFormView.RETENTION_POLICY_TAB_RIGHTS)){
x=++this.TAB_INDEX;
this.tabChoices.push({
value:x,label:ZaMsg.TABT_RetentionPolicy}
);
this.helpMap[x]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/retention_policies.htm?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
var t=[];
var w={
type:_ZATABCASE_,caseKey:D,numCols:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2};
var v=[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.TABT_GeneralPage,numCols:2,colSizes:["275px","auto"],items:[{
ref:ZaCos.A_name,type:_INPUT_,enableDisableChecks:[[ZaItem.hasRight,ZaCos.RENAME_COS_RIGHT]],msgName:ZaMsg.NAD_DisplayName,label:ZaMsg.NAD_DisplayName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",required:true,width:"30em"}
,ZaItem.descriptionXFormItem,{
ref:ZaCos.A_zimbraNotes,type:_TEXTAREA_,msgName:ZaMsg.NAD_Notes,label:ZaMsg.NAD_Notes,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em"}
]}
];
w.items=v;
t.push(w);
if(C){
var b={
type:_ZATABCASE_,caseKey:C,numCols:1,colSizes:["auto"],paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,id:"cos_form_features_tab"};
var j=[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMajorFeature,id:"cos_form_features_major",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureMailEnabled,ZaCos.A_zimbraFeatureContactsEnabled,ZaCos.A_zimbraFeatureCalendarEnabled,ZaCos.A_zimbraFeatureTasksEnabled,ZaCos.A_zimbraFeatureBriefcasesEnabled,ZaCos.A_zimbraFeatureOptionsEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureMailEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailEnabled,label:ZaMsg.LBL_zimbraFeatureMailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureContactsEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureContactsEnabled,label:ZaMsg.LBL_zimbraFeatureContactsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureCalendarEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureCalendarEnabled,label:ZaMsg.LBL_zimbraFeatureCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureTasksEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureTaskEnabled,label:ZaMsg.LBL_zimbraFeatureTaskEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureBriefcasesEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,label:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureOptionsEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureOptionsEnabled,label:ZaMsg.LBL_zimbraFeatureOptionsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraGeneralFeature,id:"cos_form_features_general",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureTaggingEnabled,ZaCos.A_zimbraFeatureSharingEnabled,ZaCos.A_zimbraFeatureChangePasswordEnabled,ZaCos.A_zimbraFeatureSkinChangeEnabled,ZaCos.A_zimbraFeatureManageZimlets,ZaCos.A_zimbraFeatureHtmlComposeEnabled,ZaCos.A_zimbraFeatureGalEnabled,ZaCos.A_zimbraFeatureMAPIConnectorEnabled,ZaCos.A_zimbraFeatureEwsEnabled,ZaCos.A_zimbraFeatureTouchClientEnabled,ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,ZaCos.A_zimbraFeatureImportFolderEnabled,ZaCos.A_zimbraFeatureExportFolderEnabled,ZaCos.A_zimbraDumpsterEnabled,ZaCos.A_zimbraDumpsterPurgeEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureTaggingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureTaggingEnabled,label:ZaMsg.LBL_zimbraFeatureTaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureSharingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSharingEnabled,label:ZaMsg.LBL_zimbraFeatureSharingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraExternalSharingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraExternalSharingEnabled,label:ZaMsg.LBL_zimbraExternalSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaCos.A_zimbraPublicSharingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPublicSharingEnabled,label:ZaMsg.LBL_zimbraPublicSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaCos.A_zimbraFeatureChangePasswordEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,label:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureSkinChangeEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,label:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureManageZimlets,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureManageZimlets,label:ZaMsg.LBL_zimbraFeatureManageZimlets,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureHtmlComposeEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,label:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureGalEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureGalEnabled,label:ZaMsg.LBL_zimbraFeatureGalEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureMAPIConnectorEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,label:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureEwsEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraFeatureEwsEnabled,label:ZaMsg.LBL_zimbraFeatureEwsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureTouchClientEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraFeatureTouchClientEnabled,label:ZaMsg.LBL_zimbraFeatureTouchClientEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraFeatureWebClientOfflineAccessEnabled,label:ZaMsg.LBL_zimbraFeatureWebClientOfflineAccessEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,label:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureImportFolderEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,label:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureExportFolderEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,label:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraDumpsterEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraDumpsterEnabled,label:ZaMsg.LBL_zimbraDumpsterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraDumpsterPurgeEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraDumpsterPurgeEnabled,label:ZaMsg.LBL_zimbraDumpsterPurgeEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraDumpsterEnabled]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMailFeature,id:"cos_form_features_mail",enableDisableChecks:[ZaCosXFormView.isMailFeatureEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraFeatureMailEnabled],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureMailPriorityEnabled,ZaCos.A_zimbraFeatureFlaggingEnabled,ZaCos.A_zimbraImapEnabled,ZaCos.A_zimbraPop3Enabled,ZaCos.A_zimbraFeatureImapDataSourceEnabled,ZaCos.A_zimbraFeaturePop3DataSourceEnabled,ZaCos.A_zimbraFeatureMailForwardingEnabled,ZaCos.A_zimbraFeatureMailSendLaterEnabled,ZaCos.A_zimbraFeatureConversationsEnabled,ZaCos.A_zimbraFeatureFiltersEnabled,ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,ZaCos.A_zimbraFeatureNewMailNotificationEnabled,ZaCos.A_zimbraFeatureIdentitiesEnabled,ZaCos.A_zimbraFeatureReadReceiptsEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureMailPriorityEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,label:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureFlaggingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,label:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraImapEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraImapEnabled,label:ZaMsg.LBL_zimbraImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPop3Enabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPop3Enabled,label:ZaMsg.LBL_zimbraPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureImapDataSourceEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraExternalImapEnabled,label:ZaMsg.LBL_zimbraExternalImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeaturePop3DataSourceEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraExternalPop3Enabled,label:ZaMsg.LBL_zimbraExternalPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureMailForwardingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailForwardingEnabled,label:ZaMsg.LBL_zimbraFeatureMailForwardingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureMailSendLaterEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,label:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureConversationsEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureConversationsEnabled,label:ZaMsg.LBL_zimbraFeatureConversationsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureFiltersEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureFiltersEnabled,label:ZaMsg.LBL_zimbraFeatureFiltersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,label:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureNewMailNotificationEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,label:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureIdentitiesEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,label:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureReadReceiptsEnabled,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraFeatureReadReceiptsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraContactFeature,id:"cos_form_features_contact",enableDisableChecks:[ZaCosXFormView.isContactsFeatureEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraFeatureContactsEnabled],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureDistributionListFolderEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureDistributionListFolderEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraFeatureDistributionListFolderEnabled,label:ZaMsg.LBL_zimbraFeatureDistributionListFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraCalendarFeature,id:"cos_form_features_calendar",enableDisableChecks:[ZaCosXFormView.isCalendarFeatureEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraFeatureCalendarEnabled],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureGroupCalendarEnabled,ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureGroupCalendarEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,label:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,label:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSearchFeature,id:"cos_form_features_search",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureAdvancedSearchEnabled,ZaCos.A_zimbraFeatureSavedSearchesEnabled,ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,ZaCos.A_zimbraFeaturePeopleSearchEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureAdvancedSearchEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,label:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureSavedSearchesEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,label:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,label:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeaturePeopleSearchEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,label:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSMIMEFeature,id:"cos_form_features_smime",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureSMIMEEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureSMIMEEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,label:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
];
b.items=j;
t.push(b)
}
if(B){
var y={
type:_ZATABCASE_,caseKey:B,id:"cos_for_prefs_tab",paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,numCols:1};
var S=[{
type:_ZA_TOP_GROUPER_,id:"account_prefs_general",colSizes:["275px","auto"],numCols:2,label:ZaMsg.NAD_GeneralOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefClientType,ZaCos.A_zimbraPrefShowSearchString,ZaCos.A_zimbraPrefMailInitialSearch,ZaCos.A_zimbraPrefImapSearchFoldersEnabled,ZaCos.A_zimbraPrefUseKeyboardShortcuts,ZaCos.A_zimbraPrefWarnOnExit,ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,ZaCos.A_zimbraPrefShowSelectionCheckbox,ZaCos.A_zimbraJunkMessagesIndexingEnabled,ZaCos.A_zimbraPrefLocale]]],items:[{
ref:ZaCos.A_zimbraPrefClientType,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefClientType,label:ZaMsg.LBL_zimbraPrefClientType,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefShowSearchString,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefShowSearchString,label:ZaMsg.LBL_zimbraPrefShowSearchString,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailInitialSearch,type:_TEXTFIELD_,cssClass:"admin_xform_name_input",msgName:ZaMsg.LBL_zimbraPrefMailInitialSearch,label:ZaMsg.LBL_zimbraPrefMailInitialSearch,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefImapSearchFoldersEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,label:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefUseKeyboardShortcuts,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefUseKeyboardShortcuts,label:ZaMsg.LBL_zimbraPrefUseKeyboardShortcuts,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefWarnOnExit,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefWarnOnExit,label:ZaMsg.LBL_zimbraPrefWarnOnExit,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,type:_CHECKBOX_,msgName:ZabMsg.LBL_zimbraPrefAdminConsoleWarnOnExit,label:ZabMsg.LBL_zimbraPrefAdminConsoleWarnOnExit,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefShowSelectionCheckbox,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefShowSelectionCheckbox,label:ZaMsg.LBL_zimbraPrefShowSelectionCheckbox,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraJunkMessagesIndexingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraJunkMessagesIndexingEnabled,label:ZaMsg.LBL_zimbraJunkMessagesIndexingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefLocale,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefLocale,label:ZaMsg.LBL_zimbraPrefLocale,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true,choices:ZaSettings.getLocaleChoices()}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_prefs_standard_client",label:ZaMsg.NAD_MailOptionsStandardClient,colSizes:["275px","auto"],numCols:2,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraMaxMailItemsPerPage,ZaCos.A_zimbraPrefMailItemsPerPage]]],items:[{
ref:ZaCos.A_zimbraMaxMailItemsPerPage,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraMaxMailItemsPerPage,label:ZaMsg.LBL_zimbraMaxMailItemsPerPage,labelLocation:_LEFT_,choices:[10,25,50,100,250,500,1000],editable:true,inputSize:4}
,{
ref:ZaCos.A_zimbraPrefMailItemsPerPage,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefMailItemsPerPage,label:ZaMsg.LBL_zimbraPrefMailItemsPerPage,labelLocation:_LEFT_}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_prefs_mail_general",colSizes:["275px","auto"],numCols:2,label:ZaMsg.NAD_MailOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefMessageViewHtmlPreferred,ZaCos.A_zimbraPrefDisplayExternalImages,ZaCos.A_zimbraPrefGroupMailBy,ZaCos.A_zimbraPrefMailDefaultCharset,ZaCos.A_zimbraPrefCalendarToasterEnabled,ZaCos.A_zimbraPrefItemsPerVirtualPage]]],items:[{
ref:ZaCos.A_zimbraPrefMessageViewHtmlPreferred,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,label:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefDisplayExternalImages,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefDisplayExternalImages,label:ZaMsg.LBL_zimbraPrefDisplayExternalImages,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefGroupMailBy,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefGroupMailBy,label:ZaMsg.LBL_zimbraPrefGroupMailBy,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefMailDefaultCharset,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefMailDefaultCharset,label:ZaMsg.LBL_zimbraPrefMailDefaultCharset,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefMailToasterEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMailToasterEnabled,label:ZaMsg.LBL_zimbraPrefMailToasterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMessageIdDedupingEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMessageIdDedupingEnabled,label:ZaMsg.LBL_zimbraPrefMessageIdDedupingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefItemsPerVirtualPage,type:_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage,label:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage,labelLocation:_LEFT_}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_prefs_mail_receiving",label:ZaMsg.NAD_MailOptionsReceiving,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefMailSoundsEnabled,ZaCos.A_zimbraPrefMailFlashIcon,ZaCos.A_zimbraPrefMailFlashTitle,ZaCos.A_zimbraPrefMailPollingInterval,ZaCos.A_zimbraMailMinPollingInterval,ZaCos.A_zimbraPrefOutOfOfficeCacheDuration,ZaCos.A_zimbraPrefMailSendReadReceipts]]],items:[{
ref:ZaCos.A_zimbraPrefMailSoundsEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_playSound,label:ZaMsg.LBL_playSound,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailFlashIcon,type:_CHECKBOX_,msgName:ZaMsg.LBL_flashIcon,label:ZaMsg.LBL_flashIcon,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailFlashTitle,type:_CHECKBOX_,msgName:ZaMsg.LBL_flashTitle,label:ZaMsg.LBL_flashTitle,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailPollingInterval,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefMailPollingInterval,label:ZaMsg.LBL_zimbraPrefMailPollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraMailMinPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraMailMinPollingInterval,label:ZaMsg.LBL_zimbraMailMinPollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefOutOfOfficeCacheDuration,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraPrefOutOfOfficeCacheDuration,label:ZaMsg.LBL_zimbraPrefOutOfOfficeCacheDuration,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefMailSendReadReceipts,type:_OSELECT1_,label:ZaMsg.LBL_zimbraPrefMailSendReadReceipts,labelLocation:_LEFT_,nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_prefs_mail_sending",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsSending,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefSaveToSent,ZaCos.A_zimbraAllowAnyFromAddress]]],items:[{
ref:ZaCos.A_zimbraPrefSaveToSent,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefSaveToSent,label:ZaMsg.LBL_zimbraPrefSaveToSent,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraAllowAnyFromAddress,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraAllowAnyFromAddress,label:ZaMsg.LBL_zimbraAllowAnyFromAddress,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_prefs_mail_sending",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsComposing,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefComposeInNewWindow,ZaCos.A_zimbraPrefComposeFormat,ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,ZaCos.A_zimbraPrefMandatorySpellCheckEnabled,ZaCos.A_zimbraMailSignatureMaxLength,ZaCos.A_zimbraPrefAutoSaveDraftInterval]]],items:[{
ref:ZaCos.A_zimbraPrefComposeInNewWindow,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefComposeInNewWindow,label:ZaMsg.LBL_zimbraPrefComposeInNewWindow,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefComposeFormat,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefComposeFormat,label:ZaMsg.LBL_zimbraPrefComposeFormat,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,type:_DWT_COLORPICKER_,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,height:"25px",label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,label:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMandatorySpellCheckEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,label:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraMailSignatureMaxLength,type:_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraMailSignatureMaxLength,label:ZaMsg.LBL_zimbraMailSignatureMaxLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraPrefAutoSaveDraftInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraPrefAutoSaveDraftInterval,label:ZaMsg.LBL_zimbraPrefAutoSaveDraftInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_prefs_contacts_general",colSizes:["275px","auto"],numCols:2,label:ZaMsg.NAD_ContactsOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefAutoAddAddressEnabled,ZaCos.A_zimbraPrefGalAutoCompleteEnabled]]],items:[{
ref:ZaCos.A_zimbraPrefAutoAddAddressEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,label:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefGalAutoCompleteEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,label:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_prefs_calendar_general",colSizes:["275px","auto"],numCols:2,label:ZaMsg.NAD_CalendarOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefTimeZoneId,ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,ZaCos.A_zimbraPrefCalendarInitialView,ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,ZaCos.A_zimbraPrefCalendarApptVisibility,ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,ZaCos.A_zimbraPrefCalendarShowPastDueReminders,ZaCos.A_zimbraPrefCalendarToasterEnabled,ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,ZaCos.A_zimbraPrefCalendarAllowForwardedInvite,ZaCos.A_zimbraPrefCalendarReminderFlashTitle,ZaCos.A_zimbraPrefCalendarReminderSoundsEnabled,ZaCos.A_zimbraPrefCalendarSendInviteDeniedAutoReply,ZaCos.A_zimbraPrefCalendarAutoAddInvites,ZaCos.A_zimbraPrefCalendarNotifyDelegatedChanges,ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,ZaCos.A_zimbraPrefCalendarUseQuickAdd,ZaCos.A_zimbraPrefUseTimeZoneListInCalendar]]],items:[{
ref:ZaCos.A_zimbraPrefTimeZoneId,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefTimeZoneId,label:ZaMsg.LBL_zimbraPrefTimeZoneId,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefCalendarApptReminderWarningTime,label:ZaMsg.LBL_zimbraPrefCalendarApptReminderWarningTime,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarInitialView,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefCalendarInitialView,label:ZaMsg.LBL_zimbraPrefCalendarInitialView,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefCalendarFirstDayOfWeek,label:ZaMsg.LBL_zimbraPrefCalendarFirstDayOfWeek,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarApptVisibility,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefCalendarApptVisibility,label:ZaMsg.LBL_zimbraPrefCalendarApptVisibility,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefAppleIcalDelegationEnabled,label:ZaMsg.LBL_zimbraPrefAppleIcalDelegationEnabled,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarShowPastDueReminders,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarShowPastDueReminders,label:ZaMsg.LBL_zimbraPrefCalendarShowPastDueReminders,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarToasterEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarToasterEnabled,label:ZaMsg.LBL_zimbraPrefCalendarToasterEnabled,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowCancelEmailToSelf,label:ZaMsg.LBL_zimbraPrefCalendarAllowCancelEmailToSelf,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowPublishMethodInvite,label:ZaMsg.LBL_zimbraPrefCalendarAllowPublishMethodInvite,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAllowForwardedInvite,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowForwardedInvite,label:ZaMsg.LBL_zimbraPrefCalendarAllowForwardedInvite,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarReminderFlashTitle,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarReminderFlashTitle,label:ZaMsg.LBL_zimbraPrefCalendarReminderFlashTitle,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarReminderSoundsEnabled,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarReminderSoundsEnabled,label:ZaMsg.LBL_zimbraPrefCalendarReminderSoundsEnabled,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarSendInviteDeniedAutoReply,type:_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarSendInviteDeniedAutoReply,label:ZaMsg.LBL_zimbraPrefCalendarSendInviteDeniedAutoReply,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAutoAddInvites,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,label:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarNotifyDelegatedChanges,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,label:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,label:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarUseQuickAdd,type:_CHECKBOX_,msgName:ZaMsg.NAD_useQuickAdd,label:ZaMsg.LBL_zimbraPrefCalendarUseQuickAdd,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefUseTimeZoneListInCalendar,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,label:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,trueValue:"TRUE",falseValue:"FALSE"}
]}
];
y.items=S;
t.push(y)
}
if(W){
var g={
type:_ZATABCASE_,numCols:1,caseKey:W};
var e=[{
type:_SPACER_}
,{
type:_GROUP_,numCols:2,colSizes:["275px","auto"],items:[{
type:_OSELECT1_,ref:ZaCos.A_zimbraPrefSkin,msgName:ZaMsg.LBL_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,choices:ZaCosXFormView.themeChoices,visibilityChecks:[ZaCosXFormView.gotSkins]}
]}
,{
type:_GROUP_,items:[{
type:_OUTPUT_,ref:ZaCos.A_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,visibilityChecks:[ZaCosXFormView.gotNoSkins]}
]}
,{
type:_SPACER_}
,{
type:_GROUP_,numCols:1,colSizes:["auto"],items:[{
type:_ZASELECT_RADIO_,selectRef:ZaCos.A_zimbraAvailableSkin,ref:ZaCos.A_zimbraAvailableSkin,choices:ZaCosXFormView.themeChoices,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaCosXFormView.gotSkins],visibilityChangeEventSources:[ZaModel.currentTab],caseKey:W,caseVarRef:ZaModel.currentTab,radioBoxLabel1:ZaMsg.COS_DontLimitThemes,radioBoxLabel2:ZaMsg.COS_LimitThemesTo}
,{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,visibilityChecks:[ZaCosXFormView.gotNoSkins,ZaZimbraAdmin.isGlobalAdmin],value:ZaMsg.ERROR_CANNOT_FIND_SKINS_FOR_COS}
,{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,visibilityChecks:[ZaCosXFormView.gotNoSkins,[function(){
return !ZaZimbraAdmin.isGlobalAdmin()
}
]],value:ZaMsg.ERROR_CANNOT_FIND_SKINS_FOR_COS_OR_NO_PERM}
]}
];
g.items=e;
t.push(g)
}
if(A){
var p={
type:_ZATABCASE_,caseKey:A};
var s=[{
type:_ZAGROUP_,numCols:1,colSizes:["auto"],border:0,items:[{
type:_OUTPUT_,value:ZaMsg.COS_LimitZimletsTo}
,{
type:_ZA_ZIMLET_SELECT_COMBO_,selectRef:ZaCos.A_zimbraZimletAvailableZimlets,ref:ZaCos.A_zimbraZimletAvailableZimlets,choices:ZaCosXFormView.zimletChoices,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab],visibilityChangeEventSources:[ZaModel.currentTab],caseKey:A,caseVarRef:ZaModel.currentTab,selectLabel:"",selectLabelLocation:_NONE_}
,{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Zimlet_Note}
]}
];
p.items=s;
t.push(p)
}
if(O){
var m={
type:_ZATABCASE_,numCols:1,caseKey:O};
var h=[{
type:_ZAGROUP_,numCols:1,colSizes:["auto"],border:0,items:[{
type:_ZASELECT_RADIO_,selectRef:ZaCos.A_zimbraMailHostPool,ref:ZaCos.A_zimbraMailHostPool,choices:ZaApp.getInstance().getServerIdListChoices(),visibilityChecks:[Case_XFormItem.prototype.isCurrentTab],visibilityChangeEventSources:[ZaModel.currentTab],caseKey:O,caseVarRef:ZaModel.currentTab,radioBoxLabel1:ZaMsg.ServerPool_Donotlimit,radioBoxLabel2:ZaMsg.COS_LimitServersTo}
]}
];
m.items=h;
t.push(m)
}
if(q){
var c={
type:_ZATABCASE_,numCols:1,colSizes:["auto"],caseKey:q,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,id:"cos_form_advanced_tab"};
var f=[{
type:_DWT_ALERT_,style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.NAD_ZERO_UNLIMETED}
,{
type:_ZA_TOP_GROUPER_,id:"cos_attachment_settings",label:ZaMsg.NAD_AttachmentsGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraAttachmentsBlocked]]],items:[{
ref:ZaCos.A_zimbraAttachmentsBlocked,type:_CHECKBOX_,msgName:ZaMsg.NAD_RemoveAllAttachments,label:ZaMsg.NAD_RemoveAllAttachments,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_quota_settings",label:ZaMsg.NAD_QuotaGrouper,items:[{
ref:ZaCos.A_zimbraMailForwardingAddressMaxLength,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxLength,label:ZaMsg.LBL_zimbraMailForwardingAddressMaxLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraMailForwardingAddressMaxNumAddrs,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxNumAddrs,label:ZaMsg.LBL_zimbraMailForwardingAddressMaxNumAddrs,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraMailQuota,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMailQuota,label:ZaMsg.LBL_zimbraMailQuota,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraContactMaxNumEntries,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraContactMaxNumEntries,label:ZaMsg.LBL_zimbraContactMaxNumEntries,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraQuotaWarnPercent,type:_INPUT_,msgName:ZaMsg.MSG_zimbraQuotaWarnPercent,label:ZaMsg.LBL_zimbraQuotaWarnPercent,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraQuotaWarnInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraQuotaWarnInterval,label:ZaMsg.LBL_zimbraQuotaWarnInterval,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraQuotaWarnMessage,type:_TEXTAREA_,msgName:ZaMsg.MSG_zimbraQuotaWarnMessage,label:ZaMsg.LBL_zimbraQuotaWarnMessage,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em"}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_datasourcepolling_settings",label:ZaMsg.NAD_DataSourcePolling,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraDataSourceMinPollingInterval,ZaCos.A_zimbraDataSourcePop3PollingInterval,ZaCos.A_zimbraDataSourceImapPollingInterval,ZaCos.A_zimbraDataSourceCalendarPollingInterval,ZaCos.A_zimbraDataSourceRssPollingInterval,ZaCos.A_zimbraDataSourceCaldavPollingInterval]]],items:[{
ref:ZaCos.A_zimbraDataSourceMinPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceMinPollingInterval,label:ZaMsg.LBL_zimbraDataSourceMinPollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourcePop3PollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourcePop3PollingInterval,label:ZaMsg.LBL_zimbraDataSourcePop3PollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceImapPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceImapPollingInterval,label:ZaMsg.LBL_zimbraDataSourceImapPollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceCalendarPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceCalendarPollingInterval,label:ZaMsg.LBL_zimbraDataSourceCalendarPollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceRssPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceRssPollingInterval,label:ZaMsg.LBL_zimbraDataSourceRssPollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceCaldavPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceCaldavPollingInterval,label:ZaMsg.LBL_zimbraDataSourceCaldavPollingInterval,labelLocation:_LEFT_,onChange:ZaCosXFormView.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_proxyalloweddomain_settings",label:ZaMsg.NAD_ProxyAllowedDomains,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraProxyAllowedDomains]]],items:[{
ref:ZaCos.A_zimbraProxyAllowedDomains,msgName:ZaMsg.MSG_zimbraProxyAllowedDomains,label:ZaMsg.LBL_zimbraProxyAllowedDomains,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",type:_REPEAT_,align:_LEFT_,repeatInstance:"",addButtonLabel:ZaMsg.NAD_ProxyAddAllowedDomain,removeButtonLabel:ZaMsg.NAD_ProxyRemoveAllowedDomain,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,items:[{
ref:".",type:_TEXTFIELD_,enableDisableChecks:[],visibilityChecks:[],width:"15em"}
]}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_password_settings",label:ZaMsg.NAD_PasswordGrouper,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:((ZaCosXFormView.isAllAuthfromInternal())?ZaMsg.Alert_InternalPassword:ZaMsg.Alert_ExternalPassword)}
,{
ref:ZaCos.A_zimbraPasswordLocked,type:_CHECKBOX_,msgName:ZaMsg.NAD_PwdLocked,label:ZaMsg.NAD_PwdLocked,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMinPwdLength,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMinPwdLength,label:ZaMsg.LBL_zimbraMinPwdLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMaxPwdLength,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMaxPwdLength,label:ZaMsg.LBL_zimbraMaxPwdLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinUpperCaseChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinUpperCaseChars,label:ZaMsg.LBL_zimbraPasswordMinUpperCaseChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinLowerCaseChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinLowerCaseChars,label:ZaMsg.LBL_zimbraPasswordMinLowerCaseChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinPunctuationChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinPunctuationChars,label:ZaMsg.LBL_zimbraPasswordMinPunctuationChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinNumericChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinNumericChars,label:ZaMsg.LBL_zimbraPasswordMinNumericChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinDigitsOrPuncs,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinDigitsOrPuncs,label:ZaMsg.LBL_zimbraPasswordMinDigitsOrPuncs,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMinPwdAge,type:_TEXTFIELD_,msgName:ZaMsg.MSG_passMinAge,label:ZaMsg.LBL_passMinAge,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMaxPwdAge,type:_TEXTFIELD_,msgName:ZaMsg.MSG_passMaxAge,label:ZaMsg.LBL_passMaxAge,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraEnforcePwdHistory,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraEnforcePwdHistory,label:ZaMsg.LBL_zimbraEnforcePwdHistory,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_password_lockout_settings",label:ZaMsg.NAD_FailedLoginGrouper,items:[{
ref:ZaCos.A_zimbraPasswordLockoutEnabled,type:_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPasswordLockoutEnabled,label:ZaMsg.LBL_zimbraPasswordLockoutEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPasswordLockoutMaxFailures,type:_TEXTFIELD_,enableDisableChecks:[ZaCosXFormView.isPasswordLockoutEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraPasswordLockoutEnabled],label:ZaMsg.LBL_zimbraPasswordLockoutMaxFailures,subLabel:ZaMsg.TTP_zimbraPasswordLockoutMaxFailuresSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutMaxFailures,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraPasswordLockoutDuration,type:_LIFETIME_,enableDisableChecks:[ZaCosXFormView.isPasswordLockoutEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraPasswordLockoutEnabled],label:ZaMsg.LBL_zimbraPasswordLockoutDuration,subLabel:ZaMsg.TTP_zimbraPasswordLockoutDurationSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutDuration,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraPasswordLockoutFailureLifetime,type:_LIFETIME_,enableDisableChecks:[ZaCosXFormView.isPasswordLockoutEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraPasswordLockoutEnabled],label:ZaMsg.LBL_zimbraPasswordLockoutFailureLifetime,subLabel:ZaMsg.TTP_zimbraPasswordLockoutFailureLifetimeSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutFailureLifetime,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_timeout_settings",label:ZaMsg.NAD_TimeoutGrouper,items:[{
ref:ZaCos.A_zimbraAdminAuthTokenLifetime,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraAdminAuthTokenLifetime,label:ZaMsg.LBL_zimbraAdminAuthTokenLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraAuthTokenLifetime,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraAuthTokenLifetime,label:ZaMsg.LBL_zimbraAuthTokenLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailIdleSessionTimeout,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraMailIdleSessionTimeout,label:ZaMsg.LBL_zimbraMailIdleSessionTimeout,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraDumpsterUserVisibleAge,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDumpsterUserVisibleAge,label:ZaMsg.LBL_zimbraDumpsterUserVisibleAge,visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraDumpsterEnabled]}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_mail_retention_settings",label:ZaMsg.NAD_MailRetentionGrouper,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Alert_MailRetention}
,{
ref:ZaCos.A_zimbraMailMessageLifetime,type:_LIFETIME2_,msgName:ZaMsg.MSG_zimbraMailMessageLifetime,label:ZaMsg.LBL_zimbraMailMessageLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailTrashLifetime,type:_LIFETIME1_,msgName:ZaMsg.MSG_zimbraMailTrashLifetime,label:ZaMsg.LBL_zimbraMailTrashLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailSpamLifetime,type:_LIFETIME1_,msgName:ZaMsg.MSG_zimbraMailSpamLifetime,label:ZaMsg.LBL_zimbraMailSpamLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailDumpsterLifetime,type:_LIFETIME1_,msgName:ZaMsg.MSG_zimbraMailDumpsterLifetime,label:ZaMsg.LBL_zimbraMailDumpsterLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterEnabled,"TRUE"],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterPurgeEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraDumpsterEnabled,ZaCos.A_zimbraDumpsterPurgeEnabled]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_InteropGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFreebusyExchangeUserOrg]]],items:[{
ref:ZaCos.A_zimbraFreebusyExchangeUserOrg,type:_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,width:"250px",label:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,labelLocation:_LEFT_}
]}
,{
type:_SPACER_,height:"10px"}
];
c.items=f;
t.push(c)
}
if(x){
var l={
type:_SUPER_TABCASE_,caseKey:x,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["100%"],numCols:1,id:"cos_retentionpolicy_tab",loadDataMethods:[ZaCosXFormView.prototype.loadRetentionPolicies],items:[{
type:_GROUP_,numCols:2,colSizes:["20px","auto"],width:"600px",cssStyle:"margin-left:10px;",items:[{
type:_SPACER_,height:"10px"}
,{
ref:ZaCos.A2_retentionPoliciesKeepInherited,type:_CHECKBOX_,onChange:ZaCosXFormView.inheritCOSRetentionPolicies,msgName:ZaMsg.LBL_POLICY_COS_INHERIT_PROMPT,label:ZaMsg.LBL_POLICY_COS_INHERIT_PROMPT,trueValue:"TRUE",falseValue:"FALSE",labelLocation:_RIGHT_}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_form_keep_p_group",width:"98%",numCols:1,colSizes:["auto"],label:ZaMsg.Glb_RetentionPolicies,cssStyle:"margin:10px;padding-bottom:0;",items:[{
ref:ZaCos.A2_retentionPoliciesKeep,type:_DWT_LIST_,height:"200",width:"99%",preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:k,widgetClass:ZaRetentionPolicyListView,onSelection:ZaCosXFormView.retentionSelectionListener,valueChangeEventSources:[ZaCos.A2_retentionPoliciesKeep]}
,{
type:_GROUP_,numCols:5,colSizes:["100px","auto","100px","auto","100px"],width:"350px",cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaCosXFormView.deleteButtonListener.call(this);",enableDisableChangeEventSources:[ZaCos.A2_retentionPoliciesKeep_Selection,ZaCos.A2_retentionPoliciesKeepInherited],enableDisableChecks:[[function(){
var F=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep_Selection);
return F&&F.length>0
}
],[XForm.checkInstanceValue,ZaCos.A2_retentionPoliciesKeepInherited,"TRUE"]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaCosXFormView.editButtonListener.call(this);",enableDisableChangeEventSources:[ZaCos.A2_retentionPoliciesKeep_Selection,ZaCos.A2_retentionPoliciesKeepInherited],enableDisableChecks:[[function(){
var F=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesKeep_Selection);
return F&&F.length==1
}
],[XForm.checkInstanceValue,ZaCos.A2_retentionPoliciesKeepInherited,"TRUE"]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChangeEventSources:[ZaCos.A2_retentionPoliciesKeepInherited],enableDisableChecks:[[XForm.checkInstanceValue,ZaCos.A2_retentionPoliciesKeepInherited,"TRUE"]],onActivate:"ZaCosXFormView.addButtonListener.call(this);"}
]}
]}
,{
type:_ZA_TOP_GROUPER_,id:"cos_form_purge_p_group",width:"98%",numCols:1,colSizes:["auto"],label:ZaMsg.Glb_DisposalPolicies,cssStyle:"margin:10px;padding-bottom:0;",items:[{
ref:ZaCos.A2_retentionPoliciesPurge,type:_DWT_LIST_,height:"200",width:"99%",preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:d,widgetClass:ZaRetentionPolicyListView,onSelection:ZaCosXFormView.purgeSelectionListener,valueChangeEventSources:[ZaCos.A2_retentionPoliciesPurge]}
,{
type:_GROUP_,numCols:5,colSizes:["100px","auto","100px","auto","100px"],width:"350px",cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaCosXFormView.deleteButtonListener.call(this, 1);",enableDisableChangeEventSources:[ZaCos.A2_retentionPoliciesPurge_Selection,ZaCos.A2_retentionPoliciesKeepInherited],enableDisableChecks:[[function(){
var F=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge_Selection);
return F&&F.length>0
}
],[XForm.checkInstanceValue,ZaCos.A2_retentionPoliciesKeepInherited,"TRUE"]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaCosXFormView.editButtonListener.call(this, 1);",enableDisableChangeEventSources:[ZaCos.A2_retentionPoliciesPurge_Selection,ZaCos.A2_retentionPoliciesKeepInherited],enableDisableChecks:[[function(){
var F=this.getForm().getInstanceValue(ZaCos.A2_retentionPoliciesPurge_Selection);
return F&&F.length==1
}
],[XForm.checkInstanceValue,ZaCos.A2_retentionPoliciesKeepInherited,"TRUE"]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChangeEventSources:[ZaCos.A2_retentionPoliciesKeepInherited],enableDisableChecks:[[XForm.checkInstanceValue,ZaCos.A2_retentionPoliciesKeepInherited,"TRUE"]],onActivate:"ZaCosXFormView.addButtonListener.call(this,1);"}
]}
]}
]};
t.push(l)
}
z.tableCssStyle="width:100%;overflow:auto;";
z.items=[{
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:4,colSizes:["32px","*","80px","*"],items:r}
]}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,choices:this.tabChoices,cssClass:"ZaTabBar",id:"xform_tabbar",cssStyle:"display:none;"}
,{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:t}
]
};
ZaTabView.XFormModifiers.ZaCosXFormView.push(ZaCosXFormView.myXFormModifier);
ZaCosXFormView.prototype.getTabChoices=function(){
return this.tabChoices
};
ZaCosXFormView.isAllAuthfromInternal=function(){
var e=true;
var o=ZaCosXFormView._domainList;
if(!o){
return e
}
for(var t=0;
t<o.length&&e;
t++){
var n=o[t];
if(n.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
e=false
}}
return !e
};
ZaCosXFormView.validatePollingInterval=function(r,t,o){
var l=o.getInstance();
this.setInstanceValue(r);
var n=l.attrs[ZaCos.A_zimbraPrefMailPollingInterval];
var h=l.attrs[ZaCos.A_zimbraMailMinPollingInterval];
var u=o.getItemsById(ZaCos.A_zimbraPrefMailPollingInterval)[0];
try{
var d=parseInt(ZaUtil.getLifeTimeInSeconds(n));
var c=parseInt(ZaUtil.getLifeTimeInSeconds(h));
if(d<c){
u.setError(ZaMsg.tt_mailPollingIntervalError+h);
o.parent.setDirty(false)
}else{
u.clearError();
o.parent.setDirty(true)
}}
catch(s){
u.setError(s.message);
o.parent.setDirty(false)
}}
}
if(AjxPackage.define("zimbraAdmin.cos.view.ZaNewCosXWizard")){
ZaNewCosXWizard=function(e,t){
ZaXWizardDialog.call(this,e,null,ZaMsg.COSTBB_New_tt,"740px","300px","ZaNewCosXWizard",null,ZaId.DLG_NEW_COS);
this.TAB_INDEX=0;
this.initForm(ZaCos.myXModel,this.getMyXForm(t),null);
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_CHANGED,new AjxListener(this,ZaNewCosXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaNewCosXWizard.prototype.handleXFormChange));
this._helpURL=ZaNewCosXWizard.helpURL
};
ZaNewCosXWizard.prototype=new ZaXWizardDialog;
ZaNewCosXWizard.prototype.constructor=ZaNewCosXWizard;
ZaXDialog.XFormModifiers.ZaNewCosXWizard=new Array();
ZaNewCosXWizard.prototype.TAB_INDEX=0;
ZaNewCosXWizard.zimletChoices=new XFormChoices([],XFormChoices.SIMPLE_LIST);
ZaNewCosXWizard.themeChoices=new XFormChoices([],XFormChoices.OBJECT_LIST);
ZaNewCosXWizard.prototype.toString=function(){
return"ZaNewCosXWizard"
};
ZaNewCosXWizard.helpURL=location.pathname+ZaUtil.HELP_URL+"cos/creating_classes_of_service.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaNewCosXWizard.prototype.handleXFormChange=function(e){
if(e&&this._localXForm.hasErrors()){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}else{
if(this._containedObject.attrs[ZaCos.A_name]&&this._containedObject.attrs[ZaCos.A_name].length>0){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true);
if(this._containedObject[ZaModel.currentStep]!=this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}
if(this._containedObject[ZaModel.currentStep]!=1){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}}};
ZaNewCosXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
};
ZaNewCosXWizard.prototype.createDomainAndAccount=function(t){
try{
var n=new ZaDomain();
n.name=t;
n.attrs[ZaDomain.A_domainName]=t;
var o=ZaItem.create(n,ZaDomain,"ZaDomain");
if(o!=null){
ZaApp.getInstance().getCurrentController().closeCnfrmDelDlg();
this.finishWizard()
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewCosXWizard.prototype.createDomainAndAccount",null,false)
}};
ZaNewCosXWizard.prototype.finishWizard=function(){
try{
if(!ZaCos.checkValues(this._containedObject)){
return false
}
var t=ZaItem.create(this._containedObject,ZaCos,"ZaCos");
if(t!=null){
t.name=AjxStringUtil.htmlEncode(this._containedObject.attrs[ZaCos.A_name]);
t.create(t.name,this._containedObject.attrs);
ZaApp.getInstance().getCosController().fireCreationEvent(t);
this.popdown();
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.CosCreated,[t.name]))
}}
catch(e){
switch(e.code){
case ZmCsfeException.ACCT_EXISTS:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_EXISTS);
break;
case ZmCsfeException.ACCT_INVALID_PASSWORD:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_INVALID,e);
ZaApp.getInstance().getAppCtxt().getErrorDialog().showDetail(true);
break;
case ZmCsfeException.NO_SUCH_COS:ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[this._containedObject.attrs[ZaAccount.A_COSId]]),e);
break;
case ZmCsfeException.SIGNATURE_EXISTS:this.popdown();
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewResourceXWizard.prototype.finishWizard",null,false);
break;
case ZmCsfeException.NO_SUCH_DOMAIN:ZaApp.getInstance().dialogs.confirmMessageDialog2.setMessage(AjxMessageFormat.format(ZaMsg.CreateDomain_q,[ZaAccount.getDomain(this._containedObject.name)]),DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.YES_BUTTON,this.createDomainAndAccount,this,[ZaAccount.getDomain(this._containedObject.name)]);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.NO_BUTTON,ZaController.prototype.closeCnfrmDelDlg,ZaApp.getInstance().getCurrentController(),null);
ZaApp.getInstance().dialogs.confirmMessageDialog2.popup();
break;
default:ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewCosXWizard.prototype.finishWizard",null,false);
break
}}};
ZaNewCosXWizard.prototype.goNext=function(){
if(this._containedObject[ZaModel.currentStep]==1){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}
this.goPage(this._containedObject[ZaModel.currentStep]+1);
if(this._containedObject[ZaModel.currentStep]==this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}};
ZaNewCosXWizard.prototype.goPrev=function(){
if(this._containedObject[ZaModel.currentStep]==2){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
}else{
if(this._containedObject[ZaModel.currentStep]==this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}}
this.goPage(this._containedObject[ZaModel.currentStep]-1)
};
ZaNewCosXWizard.prototype.setObject=function(d){
d.manageSpecialAttrs();
this._containedObject=new ZaCos();
this._containedObject.attrs=new Object();
this._containedObject[ZaModel.currentStep]=d[ZaModel.currentStep]||1;
this._containedObject.name=d.name;
this._containedObject.type=d.type;
if(d.rights){
this._containedObject.rights=d.rights
}
if(d.setAttrs){
this._containedObject.setAttrs=d.setAttrs
}
if(d.getAttrs){
this._containedObject.getAttrs=d.getAttrs
}
if(d._defaultValues){
this._containedObject._defaultValues=d._defaultValues
}
if(d.id){
this._containedObject.id=d.id
}
if(d._uuid){
this._containedObject._uuid=d._uuid
}
for(var c in d.attrs){
var r=this._localXForm.getModel().getItem(c);
if((r!=null&&r.type==_LIST_)||(d.attrs[c]!=null&&d.attrs[c] instanceof Array)){
this._containedObject.attrs[c]=ZaItem.deepCloneListItem(d.attrs[c])
}else{
this._containedObject.attrs[c]=d.attrs[c]
}}
if(d.getAttrs){
if(d.getAttrs[ZaCos.A_zimbraAvailableSkin]||d.getAttrs.all){
var h=d.attrs[ZaCos.A_zimbraAvailableSkin];
if(h!=null&&h!=""){
if(AjxUtil.isString(h)){
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin]=[h]
}else{
var o=h.length;
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin]=[];
for(var n=0;
n<o;
n++){
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin].push(h[n])
}}}else{
this._containedObject.attrs[ZaCos.A_zimbraAvailableSkin]=null
}
var h=ZaApp.getInstance().getInstalledSkins();
if(h==null){
h=[]
}else{
if(AjxUtil.isString(h)){
h=[h]
}}
var s=ZaApp.getInstance().getSkinChoices(h);
ZaNewCosXWizard.themeChoices.setChoices(s);
ZaNewCosXWizard.themeChoices.dirtyChoices()
}
if(d.getAttrs[ZaCos.A_zimbraZimletAvailableZimlets]||d.getAttrs.all){
var t=ZaZimlet.getAll(ZaZimlet.EXCLUDE_EXTENSIONS);
if(t==null){
t=[]
}
if(t instanceof ZaItemList||t instanceof AjxVector){
t=t.getArray()
}
var o=t.length;
var l=[];
for(var n=0;
n<o;
n++){
var e=t[n];
l.push(e.name)
}
ZaNewCosXWizard.zimletChoices.setChoices(l);
ZaNewCosXWizard.zimletChoices.dirtyChoices()
}}
ZaNewCosXWizard._domainList=ZaApp.getInstance().getDomainList(true).getArray();
this._localXForm.setInstance(this._containedObject)
};
ZaNewCosXWizard.gotSkins=function(){
return((ZaApp.getInstance().getInstalledSkins()!=null)&&(ZaApp.getInstance().getInstalledSkins().length>0))
};
ZaNewCosXWizard.gotNoSkins=function(){
return !ZaNewCosXWizard.gotSkins.call(this)
};
ZaNewCosXWizard.isPasswordLockoutEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraPasswordLockoutEnabled)=="TRUE")
};
ZaNewCosXWizard.isMailFeatureEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraFeatureMailEnabled)=="TRUE")
};
ZaCosXFormView.isContactsFeatureEnabled=function(){
return this.getInstanceValue(ZaCos.A_zimbraFeatureContactsEnabled)=="TRUE"
};
ZaNewCosXWizard.isCalendarFeatureEnabled=function(){
return this.getInstanceValue(ZaCos.A_zimbraFeatureCalendarEnabled)=="TRUE"
};
ZaNewCosXWizard.isMailForwardingEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraFeatureMailForwardingEnabled)=="TRUE")
};
ZaNewCosXWizard.isBriefcaseFeatureEnabled=function(){
return(this.getInstanceValue(ZaCos.A_zimbraFeatureBriefcasesEnabled)=="TRUE")
};
ZaNewCosXWizard.FEATURE_TAB_ATTRS=[ZaCos.A_zimbraFeatureMailEnabled,ZaCos.A_zimbraFeatureReadReceiptsEnabled,ZaCos.A_zimbraFeatureContactsEnabled,ZaCos.A_zimbraFeatureDistributionListFolderEnabled,ZaCos.A_zimbraFeatureCalendarEnabled,ZaCos.A_zimbraFeatureTasksEnabled,ZaCos.A_zimbraFeatureBriefcasesEnabled,ZaCos.A_zimbraFeatureOptionsEnabled,ZaCos.A_zimbraFeatureTaggingEnabled,ZaCos.A_zimbraFeatureSharingEnabled,ZaCos.A_zimbraFeatureChangePasswordEnabled,ZaCos.A_zimbraFeatureSkinChangeEnabled,ZaCos.A_zimbraFeatureManageZimlets,ZaCos.A_zimbraFeatureHtmlComposeEnabled,ZaCos.A_zimbraFeatureGalEnabled,ZaCos.A_zimbraFeatureMAPIConnectorEnabled,ZaCos.A_zimbraFeatureEwsEnabled,ZaCos.A_zimbraFeatureTouchClientEnabled,ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,ZaCos.A_zimbraFeatureMailPriorityEnabled,ZaCos.A_zimbraFeatureFlaggingEnabled,ZaCos.A_zimbraImapEnabled,ZaCos.A_zimbraPop3Enabled,ZaCos.A_zimbraFeatureImapDataSourceEnabled,ZaCos.A_zimbraFeaturePop3DataSourceEnabled,ZaCos.A_zimbraFeatureConversationsEnabled,ZaCos.A_zimbraFeatureFiltersEnabled,ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,ZaCos.A_zimbraFeatureNewMailNotificationEnabled,ZaCos.A_zimbraFeatureIdentitiesEnabled,ZaCos.A_zimbraFeatureGroupCalendarEnabled,ZaCos.A_zimbraFeaturePeopleSearchEnabled,ZaCos.A_zimbraFeatureAdvancedSearchEnabled,ZaCos.A_zimbraFeatureSavedSearchesEnabled,ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,ZaCos.A_zimbraFeatureImportFolderEnabled,ZaCos.A_zimbraFeatureExportFolderEnabled,ZaCos.A_zimbraDumpsterEnabled,ZaCos.A_zimbraDumpsterPurgeEnabled,ZaCos.A_zimbraFeatureMailSendLaterEnabled,ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,ZaCos.A_zimbraFeatureSMIMEEnabled];
ZaNewCosXWizard.FEATURE_TAB_RIGHTS=[];
ZaNewCosXWizard.PREFERENCES_TAB_ATTRS=[ZaCos.A_zimbraPrefMailSendReadReceipts,ZaCos.A_zimbraPrefUseTimeZoneListInCalendar,ZaCos.A_zimbraPrefCalendarUseQuickAdd,ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,ZaCos.A_zimbraPrefTimeZoneId,ZaCos.A_zimbraPrefGalAutoCompleteEnabled,ZaCos.A_zimbraPrefAutoAddAddressEnabled,ZaCos.A_zimbraMailSignatureMaxLength,ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,ZaCos.A_zimbraPrefComposeFormat,ZaCos.A_zimbraPrefComposeInNewWindow,ZaCos.A_zimbraAllowAnyFromAddress,ZaCos.A_zimbraMailMinPollingInterval,ZaCos.A_zimbraPrefMailPollingInterval,ZaCos.A_zimbraPrefAutoSaveDraftInterval,ZaCos.A_zimbraPrefMailDefaultCharset,ZaCos.A_zimbraMaxMailItemsPerPage,ZaCos.A_zimbraPrefMailItemsPerPage,ZaCos.A_zimbraPrefGroupMailBy,ZaCos.A_zimbraPrefDisplayExternalImages,ZaCos.A_zimbraPrefMessageViewHtmlPreferred,ZaCos.A_zimbraPrefLocale,ZaCos.A_zimbraJunkMessagesIndexingEnabled,ZaCos.A_zimbraPrefShowSelectionCheckbox,ZaCos.A_zimbraPrefWarnOnExit,ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,ZaCos.A_zimbraPrefUseKeyboardShortcuts,ZaCos.A_zimbraPrefImapSearchFoldersEnabled,ZaCos.A_zimbraPrefShowSearchString,ZaCos.A_zimbraPrefMailInitialSearch,ZaCos.A_zimbraPrefClientType,ZaCos.A_zimbraPrefCalendarInitialView,ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,ZaCos.A_zimbraPrefCalendarReminderFlashTitle,ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,ZaCos.A_zimbraPrefCalendarToasterEnabled,ZaCos.A_zimbraPrefCalendarShowPastDueReminders,ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,ZaCos.A_zimbraPrefMandatorySpellCheckEnabled];
ZaNewCosXWizard.PREFERENCES_TAB_RIGHTS=[];
ZaNewCosXWizard.SKIN_TAB_ATTRS=[ZaCos.A_zimbraPrefSkin,ZaCos.A_zimbraAvailableSkin];
ZaNewCosXWizard.SKIN_TAB_RIGHTS=[];
ZaNewCosXWizard.ZIMLET_TAB_ATTRS=[ZaCos.A_zimbraZimletAvailableZimlets];
ZaNewCosXWizard.ZIMLET_TAB_RIGHTS=[ZaCos.RIGHT_GET_ZIMLET,ZaCos.RIGHT_LIST_ZIMLET];
ZaNewCosXWizard.SERVERPOOL_TAB_ATTRS=[ZaCos.A_zimbraMailHostPool];
ZaNewCosXWizard.SERVERPOOL_TAB_RIGHTS=[ZaCos.RIGHT_GET_HOSTNAME];
ZaNewCosXWizard.ADVANCED_TAB_ATTRS=[ZaCos.A_zimbraAttachmentsBlocked,ZaCos.A_zimbraMailQuota,ZaCos.A_zimbraContactMaxNumEntries,ZaCos.A_zimbraQuotaWarnPercent,ZaCos.A_zimbraQuotaWarnInterval,ZaCos.A_zimbraQuotaWarnMessage,ZaCos.A_zimbraPasswordLocked,ZaCos.A_zimbraMinPwdLength,ZaCos.A_zimbraMaxPwdLength,ZaCos.A_zimbraPasswordMinUpperCaseChars,ZaCos.A_zimbraPasswordMinLowerCaseChars,ZaCos.A_zimbraPasswordMinPunctuationChars,ZaCos.A_zimbraPasswordMinNumericChars,ZaCos.A_zimbraPasswordMinDigitsOrPuncs,ZaCos.A_zimbraMinPwdAge,ZaCos.A_zimbraMaxPwdAge,ZaCos.A_zimbraEnforcePwdHistory,ZaCos.A_zimbraPasswordLockoutEnabled,ZaCos.A_zimbraPasswordLockoutMaxFailures,ZaCos.A_zimbraPasswordLockoutDuration,ZaCos.A_zimbraPasswordLockoutFailureLifetime,ZaCos.A_zimbraAdminAuthTokenLifetime,ZaCos.A_zimbraAuthTokenLifetime,ZaCos.A_zimbraMailIdleSessionTimeout,ZaCos.A_zimbraMailMessageLifetime,ZaCos.A_zimbraMailTrashLifetime,ZaCos.A_zimbraMailSpamLifetime,ZaCos.A_zimbraDumpsterUserVisibleAge,ZaCos.A_zimbraMailDumpsterLifetime,ZaCos.A_zimbraFreebusyExchangeUserOrg,ZaCos.A_zimbraDataSourcePop3PollingInterval,ZaCos.A_zimbraDataSourceImapPollingInterval,ZaCos.A_zimbraDataSourceCalendarPollingInterval,ZaCos.A_zimbraDataSourceRssPollingInterval,ZaCos.A_zimbraDataSourceCaldavPollingInterval,ZaCos.A_zimbraDataSourceMinPollingInterval];
ZaNewCosXWizard.ADVANCED_TAB_RIGHTS=[];
ZaNewCosXWizard.myXFormModifier=function(v,o){
this.stepChoices=[];
var T=++this.TAB_INDEX;
var z,j,q,x,k,b;
var s=[{
type:_AJX_IMAGE_,src:"COS_32",label:null,rowSpan:2}
,{
type:_OUTPUT_,ref:ZaCos.A_name,label:null,cssClass:"AdminTitle",visibilityChecks:[ZaItem.hasReadPermission],height:32,rowSpan:2}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID,visibilityChecks:[ZaItem.hasReadPermission]}
,{
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var A=ZaItem.formatServerTime(this.getInstanceValue());
if(!A){
return ZaMsg.Server_Time_NA
}else{
return A
}}
,visibilityChecks:[ZaItem.hasReadPermission]}
];
this.stepChoices.push({
value:T,label:ZaMsg.TABT_GeneralPage}
);
if(ZaTabView.isTAB_ENABLED(o,ZaNewCosXWizard.FEATURE_TAB_ATTRS,ZaNewCosXWizard.FEATURE_TAB_RIGHTS)){
z=++this.TAB_INDEX;
this.stepChoices.push({
value:z,label:ZaMsg.TABT_Features}
)
}
if(ZaTabView.isTAB_ENABLED(o,ZaNewCosXWizard.PREFERENCES_TAB_ATTRS,ZaNewCosXWizard.PREFERENCES_TAB_RIGHTS)){
j=++this.TAB_INDEX;
this.stepChoices.push({
value:j,label:ZaMsg.TABT_Preferences}
)
}
if(ZaTabView.isTAB_ENABLED(o,ZaNewCosXWizard.SKIN_TAB_ATTRS,ZaNewCosXWizard.SKIN_TAB_RIGHTS)){
q=++this.TAB_INDEX;
this.stepChoices.push({
value:q,label:ZaMsg.TABT_Themes}
)
}
var l=ZaZimlet.getAll(ZaZimlet.EXCLUDE_EXTENSIONS);
if(l!=null&&!AjxUtil.isEmpty(l.getArray())&&ZaTabView.isTAB_ENABLED(o,ZaNewCosXWizard.ZIMLET_TAB_ATTRS,ZaNewCosXWizard.ZIMLET_TAB_RIGHTS)){
x=++this.TAB_INDEX;
this.stepChoices.push({
value:x,label:ZaMsg.TABT_Zimlets}
)
}
if(ZaTabView.isTAB_ENABLED(o,ZaNewCosXWizard.SERVERPOOL_TAB_ATTRS,ZaNewCosXWizard.SERVERPOOL_TAB_RIGHTS)){
k=++this.TAB_INDEX;
this.stepChoices.push({
value:k,label:ZaMsg.TABT_ServerPool}
)
}
if(ZaTabView.isTAB_ENABLED(o,ZaNewCosXWizard.ADVANCED_TAB_ATTRS,ZaNewCosXWizard.ADVANCED_TAB_RIGHTS)){
b=++this.TAB_INDEX;
this.stepChoices.push({
value:b,label:ZaMsg.TABT_Advanced}
)
}
var t=[];
var g={
type:_CASE_,caseKey:T,numCols:1,width:"100%",cellpadding:0};
var y=[{
type:_ZAWIZ_TOP_GROUPER_,numCols:2,colSizes:["200px","auto"],label:ZaMsg.TABT_GeneralPage,items:[{
ref:ZaCos.A_name,type:_INPUT_,enableDisableChecks:[[ZaItem.hasRight,ZaCos.RENAME_COS_RIGHT]],msgName:ZaMsg.NAD_DisplayName,label:ZaMsg.NAD_DisplayName,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",required:true,width:"30em"}
,{
ref:"description",msgName:ZaMsg.NAD_Description,label:ZaMsg.NAD_Description,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",type:_TEXTFIELD_,align:_LEFT_,enableDisableChecks:[ZaItem.hasWritePermission],visibilityChecks:[ZaItem.hasReadPermission],width:"30em"}
,{
ref:ZaCos.A_zimbraNotes,type:_TEXTAREA_,msgName:ZaMsg.NAD_Notes,label:ZaMsg.NAD_Notes,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em"}
]}
];
g.items=y;
t.push(g);
if(z){
var p={
type:_CASE_,caseKey:z,numCols:1,colSizes:["auto"],width:"100%",cellpadding:0,id:"cos_form_features_tab"};
var w=[{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMajorFeature,id:"cos_form_features_major",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureMailEnabled,ZaCos.A_zimbraFeatureContactsEnabled,ZaCos.A_zimbraFeatureCalendarEnabled,ZaCos.A_zimbraFeatureTasksEnabled,ZaCos.A_zimbraFeatureBriefcasesEnabled,ZaCos.A_zimbraFeatureOptionsEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureMailEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailEnabled,label:ZaMsg.LBL_zimbraFeatureMailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureContactsEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureContactsEnabled,label:ZaMsg.LBL_zimbraFeatureContactsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureCalendarEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureCalendarEnabled,label:ZaMsg.LBL_zimbraFeatureCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureTasksEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureTaskEnabled,label:ZaMsg.LBL_zimbraFeatureTaskEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureBriefcasesEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,label:ZaMsg.LBL_zimbraFeatureBriefcasesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureOptionsEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureOptionsEnabled,label:ZaMsg.LBL_zimbraFeatureOptionsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraGeneralFeature,id:"cos_form_features_general",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureTaggingEnabled,ZaCos.A_zimbraFeatureSharingEnabled,ZaCos.A_zimbraFeatureChangePasswordEnabled,ZaCos.A_zimbraFeatureSkinChangeEnabled,ZaCos.A_zimbraFeatureManageZimlets,ZaCos.A_zimbraFeatureHtmlComposeEnabled,ZaCos.A_zimbraFeatureGalEnabled,ZaCos.A_zimbraFeatureMAPIConnectorEnabled,ZaCos.A_zimbraFeatureEwsEnabled,ZaCos.A_zimbraFeatureTouchClientEnabled,ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,ZaCos.A_zimbraFeatureImportFolderEnabled,ZaCos.A_zimbraFeatureExportFolderEnabled,ZaCos.A_zimbraDumpsterEnabled,ZaCos.A_zimbraDumpsterPurgeEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureTaggingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureTaggingEnabled,label:ZaMsg.LBL_zimbraFeatureTaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureSharingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSharingEnabled,label:ZaMsg.LBL_zimbraFeatureSharingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraExternalSharingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraExternalSharingEnabled,label:ZaMsg.LBL_zimbraExternalSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaCos.A_zimbraPublicSharingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPublicSharingEnabled,label:ZaMsg.LBL_zimbraPublicSharingEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraFeatureSharingEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraFeatureSharingEnabled]}
,{
ref:ZaCos.A_zimbraFeatureChangePasswordEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,label:ZaMsg.LBL_zimbraFeatureChangePasswordEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureSkinChangeEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,label:ZaMsg.LBL_zimbraFeatureSkinChangeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureManageZimlets,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureManageZimlets,label:ZaMsg.LBL_zimbraFeatureManageZimlets,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureHtmlComposeEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,label:ZaMsg.LBL_zimbraFeatureHtmlComposeEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureGalEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureGalEnabled,label:ZaMsg.LBL_zimbraFeatureGalEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureMAPIConnectorEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,label:ZaMsg.LBL_zimbraFeatureMAPIConnectorEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureEwsEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureEwsEnabled,label:ZaMsg.LBL_zimbraFeatureEwsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureTouchClientEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureTouchClientEnabled,label:ZaMsg.LBL_zimbraFeatureTouchClientEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureWebClientOfflineAccessEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureWebClientOfflineAccessEnabled,label:ZaMsg.LBL_zimbraFeatureWebClientOfflineAccessEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureGalAutoCompleteEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,label:ZaMsg.LBL_zimbraFeatureGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureImportFolderEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,label:ZaMsg.LBL_zimbraFeatureImportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureExportFolderEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,label:ZaMsg.LBL_zimbraFeatureExportFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraDumpsterEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraDumpsterEnabled,label:ZaMsg.LBL_zimbraDumpsterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraDumpsterPurgeEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraDumpsterPurgeEnabled,label:ZaMsg.LBL_zimbraDumpsterPurgeEnabled,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraDumpsterEnabled]}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraMailFeature,id:"cos_form_features_mail",enableDisableChecks:[ZaNewCosXWizard.isMailFeatureEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraFeatureMailEnabled],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureMailPriorityEnabled,ZaCos.A_zimbraFeatureFlaggingEnabled,ZaCos.A_zimbraImapEnabled,ZaCos.A_zimbraPop3Enabled,ZaCos.A_zimbraFeatureImapDataSourceEnabled,ZaCos.A_zimbraFeaturePop3DataSourceEnabled,ZaCos.A_zimbraFeatureMailForwardingEnabled,ZaCos.A_zimbraFeatureMailSendLaterEnabled,ZaCos.A_zimbraFeatureConversationsEnabled,ZaCos.A_zimbraFeatureFiltersEnabled,ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,ZaCos.A_zimbraFeatureNewMailNotificationEnabled,ZaCos.A_zimbraFeatureIdentitiesEnabled,ZaCos.A_zimbraFeatureReadReceiptsEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureMailPriorityEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,label:ZaMsg.LBL_zimbraFeatureMailPriorityEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureFlaggingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,label:ZaMsg.LBL_zimbraFeatureFlaggingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraImapEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraImapEnabled,label:ZaMsg.LBL_zimbraImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPop3Enabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPop3Enabled,label:ZaMsg.LBL_zimbraPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureImapDataSourceEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraExternalImapEnabled,label:ZaMsg.LBL_zimbraExternalImapEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeaturePop3DataSourceEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraExternalPop3Enabled,label:ZaMsg.LBL_zimbraExternalPop3Enabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureMailForwardingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailForwardingEnabled,label:ZaMsg.LBL_zimbraFeatureMailForwardingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureMailSendLaterEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,label:ZaMsg.LBL_zimbraFeatureMailSendLaterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureConversationsEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureConversationsEnabled,label:ZaMsg.LBL_zimbraFeatureConversationsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureFiltersEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureFiltersEnabled,label:ZaMsg.LBL_zimbraFeatureFiltersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureOutOfOfficeReplyEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,label:ZaMsg.LBL_zimbraFeatureOutOfOfficeReplyEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureNewMailNotificationEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,label:ZaMsg.LBL_zimbraFeatureNewMailNotificationEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureIdentitiesEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,label:ZaMsg.LBL_zimbraFeatureIdentitiesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureReadReceiptsEnabled,type:_WIZ_CHECKBOX_,label:ZaMsg.LBL_zimbraFeatureReadReceiptsEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraContactFeature,id:"cos_form_features_contact",enableDisableChecks:[ZaCosXFormView.isContactsFeatureEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraFeatureContactsEnabled],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureDistributionListFolderEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureDistributionListFolderEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraFeatureDistributionListFolderEnabled,label:ZaMsg.LBL_zimbraFeatureDistributionListFolderEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraCalendarFeature,id:"cos_form_features_calendar",enableDisableChecks:[ZaNewCosXWizard.isCalendarFeatureEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraFeatureCalendarEnabled],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureGroupCalendarEnabled,ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureGroupCalendarEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,label:ZaMsg.LBL_zimbraFeatureGroupCalendarEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureCalendarReminderDeviceEmailEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,label:ZaMsg.LBL_zimbraFeatureCalendarReminderDeviceEmailEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSearchFeature,id:"cos_form_features_search",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureAdvancedSearchEnabled,ZaCos.A_zimbraFeatureSavedSearchesEnabled,ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,ZaCos.A_zimbraFeaturePeopleSearchEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureAdvancedSearchEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,label:ZaMsg.LBL_zimbraFeatureAdvancedSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureSavedSearchesEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,label:ZaMsg.LBL_zimbraFeatureSavedSearchesEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeatureInitialSearchPreferenceEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,label:ZaMsg.LBL_zimbraFeatureInitialSearchPreferenceEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraFeaturePeopleSearchEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,label:ZaMsg.LBL_zimbraFeaturePeopleSearchEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_zimbraSMIMEFeature,id:"cos_form_features_smime",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFeatureSMIMEEnabled]]],items:[{
ref:ZaCos.A_zimbraFeatureSMIMEEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,label:ZaMsg.LBL_zimbraFeatureSMIMEEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
];
p.items=w;
t.push(p)
}
if(j){
var f={
type:_CASE_,caseKey:j,id:"cos_for_prefs_tab",width:"100%",cellpadding:0,numCols:1};
var O=[{
type:_ZAWIZ_TOP_GROUPER_,id:"account_prefs_general",label:ZaMsg.NAD_GeneralOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefClientType,ZaCos.A_zimbraPrefShowSearchString,ZaCos.A_zimbraPrefMailInitialSearch,ZaCos.A_zimbraPrefImapSearchFoldersEnabled,ZaCos.A_zimbraPrefUseKeyboardShortcuts,ZaCos.A_zimbraPrefWarnOnExit,ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,ZaCos.A_zimbraPrefShowSelectionCheckbox,ZaCos.A_zimbraJunkMessagesIndexingEnabled,ZaCos.A_zimbraPrefLocale]]],items:[{
ref:ZaCos.A_zimbraPrefClientType,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefClientType,label:ZaMsg.LBL_zimbraPrefClientType,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefShowSearchString,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefShowSearchString,label:ZaMsg.LBL_zimbraPrefShowSearchString,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailInitialSearch,type:_TEXTFIELD_,cssClass:"admin_xform_name_input",msgName:ZaMsg.LBL_zimbraPrefMailInitialSearch,label:ZaMsg.LBL_zimbraPrefMailInitialSearch,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefImapSearchFoldersEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,label:ZaMsg.LBL_zimbraPrefImapSearchFoldersEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefUseKeyboardShortcuts,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefUseKeyboardShortcuts,label:ZaMsg.LBL_zimbraPrefUseKeyboardShortcuts,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefWarnOnExit,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefWarnOnExit,label:ZaMsg.LBL_zimbraPrefWarnOnExit,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefAdminConsoleWarnOnExit,type:_WIZ_CHECKBOX_,msgName:ZabMsg.LBL_zimbraPrefAdminConsoleWarnOnExit,label:ZabMsg.LBL_zimbraPrefAdminConsoleWarnOnExit,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefShowSelectionCheckbox,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefShowSelectionCheckbox,label:ZaMsg.LBL_zimbraPrefShowSelectionCheckbox,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraJunkMessagesIndexingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraJunkMessagesIndexingEnabled,label:ZaMsg.LBL_zimbraJunkMessagesIndexingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefLocale,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefLocale,label:ZaMsg.LBL_zimbraPrefLocale,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true,choices:ZaSettings.getLocaleChoices()}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_prefs_standard_client",label:ZaMsg.NAD_MailOptionsStandardClient,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraMaxMailItemsPerPage,ZaCos.A_zimbraPrefMailItemsPerPage]]],items:[{
ref:ZaCos.A_zimbraMaxMailItemsPerPage,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraMaxMailItemsPerPage,label:ZaMsg.LBL_zimbraMaxMailItemsPerPage,labelLocation:_LEFT_,choices:[10,25,50,100,250,500,1000],editable:true,inputSize:4}
,{
ref:ZaCos.A_zimbraPrefMailItemsPerPage,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefMailItemsPerPage,label:ZaMsg.LBL_zimbraPrefMailItemsPerPage,labelLocation:_LEFT_}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_prefs_mail_general",label:ZaMsg.NAD_MailOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefMessageViewHtmlPreferred,ZaCos.A_zimbraPrefDisplayExternalImages,ZaCos.A_zimbraPrefGroupMailBy,ZaCos.A_zimbraPrefMailDefaultCharset,ZaCos.A_zimbraPrefCalendarToasterEnabled,ZaCos.A_zimbraPrefItemsPerVirtualPage]]],items:[{
ref:ZaCos.A_zimbraPrefMessageViewHtmlPreferred,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,label:ZaMsg.LBL_zimbraPrefMessageViewHtmlPreferred,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefDisplayExternalImages,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefDisplayExternalImages,label:ZaMsg.LBL_zimbraPrefDisplayExternalImages,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefGroupMailBy,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefGroupMailBy,label:ZaMsg.LBL_zimbraPrefGroupMailBy,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefMailDefaultCharset,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefMailDefaultCharset,label:ZaMsg.LBL_zimbraPrefMailDefaultCharset,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefMailToasterEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMailToasterEnabled,label:ZaMsg.LBL_zimbraPrefMailToasterEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMessageIdDedupingEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMessageIdDedupingEnabled,label:ZaMsg.LBL_zimbraPrefMessageIdDedupingEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefItemsPerVirtualPage,type:_TEXTFIELD_,colSizes:["200px","*"],colSpan:2,msgName:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage,label:ZaMsg.LBL_zimbraPrefItemsPerVirtualPage,labelLocation:_LEFT_}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_prefs_mail_receiving",label:ZaMsg.NAD_MailOptionsReceiving,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefMailSoundsEnabled,ZaCos.A_zimbraPrefMailFlashIcon,ZaCos.A_zimbraPrefMailFlashTitle,ZaCos.A_zimbraPrefMailPollingInterval,ZaCos.A_zimbraMailMinPollingInterval,ZaCos.A_zimbraPrefOutOfOfficeCacheDuration,ZaCos.A_zimbraPrefMailSendReadReceipts]]],items:[{
ref:ZaCos.A_zimbraPrefMailSoundsEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_playSound,label:ZaMsg.LBL_playSound,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailFlashIcon,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_flashIcon,label:ZaMsg.LBL_flashIcon,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailFlashTitle,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_flashTitle,label:ZaMsg.LBL_flashTitle,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMailPollingInterval,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefMailPollingInterval,label:ZaMsg.LBL_zimbraPrefMailPollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraMailMinPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraMailMinPollingInterval,label:ZaMsg.LBL_zimbraMailMinPollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefOutOfOfficeCacheDuration,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraPrefOutOfOfficeCacheDuration,label:ZaMsg.LBL_zimbraPrefOutOfOfficeCacheDuration,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefMailSendReadReceipts,type:_OSELECT1_,label:ZaMsg.LBL_zimbraPrefMailSendReadReceipts,labelLocation:_LEFT_,nowrap:false,labelWrap:true}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_prefs_mail_sending",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsSending,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefSaveToSent,ZaCos.A_zimbraAllowAnyFromAddress]]],items:[{
ref:ZaCos.A_zimbraPrefSaveToSent,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefSaveToSent,label:ZaMsg.LBL_zimbraPrefSaveToSent,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraAllowAnyFromAddress,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraAllowAnyFromAddress,label:ZaMsg.LBL_zimbraAllowAnyFromAddress,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_prefs_mail_sending",borderCssClass:"LowPaddedTopGrouperBorder",label:ZaMsg.NAD_MailOptionsComposing,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefComposeInNewWindow,ZaCos.A_zimbraPrefComposeFormat,ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,ZaCos.A_zimbraPrefMandatorySpellCheckEnabled,ZaCos.A_zimbraMailSignatureMaxLength,ZaCos.A_zimbraPrefAutoSaveDraftInterval]]],items:[{
ref:ZaCos.A_zimbraPrefComposeInNewWindow,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefComposeInNewWindow,label:ZaMsg.LBL_zimbraPrefComposeInNewWindow,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefComposeFormat,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefComposeFormat,label:ZaMsg.LBL_zimbraPrefComposeFormat,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefHtmlEditorDefaultFontFamily,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontFamily,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefHtmlEditorDefaultFontSize,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize,label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontSize,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefHtmlEditorDefaultFontColor,type:_DWT_COLORPICKER_,msgName:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,height:"25px",label:ZaMsg.LBL_zimbraPrefHtmlEditorDefaultFontColor,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefForwardReplyInOriginalFormat,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,label:ZaMsg.LBL_zimbraPrefForwardReplyInOriginalFormat,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefMandatorySpellCheckEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,label:ZaMsg.LBL_zimbraPrefMandatorySpellCheckEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraMailSignatureMaxLength,type:_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraMailSignatureMaxLength,label:ZaMsg.LBL_zimbraMailSignatureMaxLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraPrefAutoSaveDraftInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraPrefAutoSaveDraftInterval,label:ZaMsg.LBL_zimbraPrefAutoSaveDraftInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_prefs_contacts_general",label:ZaMsg.NAD_ContactsOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefAutoAddAddressEnabled,ZaCos.A_zimbraPrefGalAutoCompleteEnabled]]],items:[{
ref:ZaCos.A_zimbraPrefAutoAddAddressEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,label:ZaMsg.LBL_zimbraPrefAutoAddAddressEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefGalAutoCompleteEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,label:ZaMsg.LBL_zimbraPrefGalAutoCompleteEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_prefs_calendar_general",label:ZaMsg.NAD_CalendarOptions,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraPrefTimeZoneId,ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,ZaCos.A_zimbraPrefCalendarInitialView,ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,ZaCos.A_zimbraPrefCalendarApptVisibility,ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,ZaCos.A_zimbraPrefCalendarShowPastDueReminders,ZaCos.A_zimbraPrefCalendarToasterEnabled,ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,ZaCos.A_zimbraPrefCalendarAllowForwardedInvite,ZaCos.A_zimbraPrefCalendarReminderFlashTitle,ZaCos.A_zimbraPrefCalendarReminderSoundsEnabled,ZaCos.A_zimbraPrefCalendarSendInviteDeniedAutoReply,ZaCos.A_zimbraPrefCalendarAutoAddInvites,ZaCos.A_zimbraPrefCalendarNotifyDelegatedChanges,ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,ZaCos.A_zimbraPrefCalendarUseQuickAdd,ZaCos.A_zimbraPrefUseTimeZoneListInCalendar]]],items:[{
ref:ZaCos.A_zimbraPrefTimeZoneId,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefTimeZoneId,label:ZaMsg.LBL_zimbraPrefTimeZoneId,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarApptReminderWarningTime,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefCalendarApptReminderWarningTime,label:ZaMsg.LBL_zimbraPrefCalendarApptReminderWarningTime,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarInitialView,type:_OSELECT1_,msgName:ZaMsg.MSG_zimbraPrefCalendarInitialView,label:ZaMsg.LBL_zimbraPrefCalendarInitialView,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraPrefCalendarFirstDayOfWeek,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefCalendarFirstDayOfWeek,label:ZaMsg.LBL_zimbraPrefCalendarFirstDayOfWeek,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarApptVisibility,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefCalendarApptVisibility,label:ZaMsg.LBL_zimbraPrefCalendarApptVisibility,labelLocation:_LEFT_,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefAppleIcalDelegationEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefAppleIcalDelegationEnabled,label:ZaMsg.LBL_zimbraPrefAppleIcalDelegationEnabled,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarShowPastDueReminders,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarShowPastDueReminders,label:ZaMsg.LBL_zimbraPrefCalendarShowPastDueReminders,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarToasterEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarToasterEnabled,label:ZaMsg.LBL_zimbraPrefCalendarToasterEnabled,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAllowCancelEmailToSelf,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowCancelEmailToSelf,label:ZaMsg.LBL_zimbraPrefCalendarAllowCancelEmailToSelf,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAllowPublishMethodInvite,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowPublishMethodInvite,label:ZaMsg.LBL_zimbraPrefCalendarAllowPublishMethodInvite,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAllowForwardedInvite,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarAllowForwardedInvite,label:ZaMsg.LBL_zimbraPrefCalendarAllowForwardedInvite,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarReminderFlashTitle,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarReminderFlashTitle,label:ZaMsg.LBL_zimbraPrefCalendarReminderFlashTitle,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarReminderSoundsEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarReminderSoundsEnabled,label:ZaMsg.LBL_zimbraPrefCalendarReminderSoundsEnabled,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarSendInviteDeniedAutoReply,type:_WIZ_CHECKBOX_,msgName:ZaMsg.MSG_zimbraPrefCalendarSendInviteDeniedAutoReply,label:ZaMsg.LBL_zimbraPrefCalendarSendInviteDeniedAutoReply,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAutoAddInvites,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,label:ZaMsg.LBL_zimbraPrefCalendarAutoAddInvites,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarNotifyDelegatedChanges,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,label:ZaMsg.LBL_zimbraPrefCalendarNotifyDelegatedChanges,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarAlwaysShowMiniCal,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,label:ZaMsg.LBL_zimbraPrefCalendarAlwaysShowMiniCal,trueValue:"TRUE",falseValue:"FALSE",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraPrefCalendarUseQuickAdd,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_useQuickAdd,label:ZaMsg.LBL_zimbraPrefCalendarUseQuickAdd,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPrefUseTimeZoneListInCalendar,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,label:ZaMsg.LBL_zimbraPrefUseTimeZoneListInCalendar,trueValue:"TRUE",falseValue:"FALSE"}
]}
];
f.items=O;
t.push(f)
}
if(q){
var m={
type:_CASE_,numCols:1,caseKey:q};
var e=[{
type:_GROUP_,numCols:2,colSizes:["275","auto"],items:[{
ref:ZaCos.A_zimbraPrefSkin,type:_OSELECT1_,msgName:ZaMsg.LBL_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,choices:ZaNewCosXWizard.themeChoices,visibilityChecks:[ZaNewCosXWizard.gotSkins]}
]}
,{
type:_GROUP_,items:[{
type:_OUTPUT_,ref:ZaCos.A_zimbraPrefSkin,label:ZaMsg.LBL_zimbraPrefSkin,labelLocation:_LEFT_,visibilityChecks:[ZaNewCosXWizard.gotNoSkins]}
]}
,{
type:_GROUP_,numCols:1,colSizes:["auto"],items:[{
type:_ZASELECT_RADIO_,selectRef:ZaCos.A_zimbraAvailableSkin,ref:ZaCos.A_zimbraAvailableSkin,choices:ZaNewCosXWizard.themeChoices,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab,ZaNewCosXWizard.gotSkins],visibilityChangeEventSources:[ZaModel.currentStep],caseKey:q,caseVarRef:ZaModel.currentStep,radioBoxLabel1:ZaMsg.COS_DontLimitThemes,radioBoxLabel2:ZaMsg.COS_LimitThemesTo}
,{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,visibilityChecks:[ZaNewCosXWizard.gotNoSkins],value:ZaMsg.ERROR_CANNOT_FIND_SKINS_FOR_COS}
,{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,visibilityChecks:[ZaCosXFormView.gotNoSkins,[function(){
return !ZaZimbraAdmin.isGlobalAdmin()
}
]],value:ZaMsg.ERROR_CANNOT_FIND_SKINS_FOR_COS_OR_NO_PERM}
]}
];
m.items=e;
t.push(m)
}
if(x){
var u={
type:_CASE_,caseKey:x};
var n=[{
type:_GROUP_,numCols:1,colSizes:["auto"],items:[{
type:_OUTPUT_,value:ZaMsg.COS_LimitZimletsTo,cssStyle:"margin-left:0;"}
,{
type:_ZA_ZIMLET_SELECT_COMBO_,selectRef:ZaCos.A_zimbraZimletAvailableZimlets,ref:ZaCos.A_zimbraZimletAvailableZimlets,choices:ZaNewCosXWizard.zimletChoices,visibilityChecks:[Case_XFormItem.prototype.isCurrentTab],visibilityChangeEventSources:[ZaModel.currentStep],caseKey:x,caseVarRef:ZaModel.currentStep,selectLabel:"",selectLabelLocation:_NONE_}
]}
];
u.items=n;
t.push(u)
}
if(k){
var c={
type:_CASE_,numCols:1,caseKey:k};
var r=[{
type:_GROUP_,numCols:1,colSizes:["auto"],items:[{
type:_ZASELECT_RADIO_,selectRef:ZaCos.A_zimbraMailHostPool,ref:ZaCos.A_zimbraMailHostPool,choices:ZaApp.getInstance().getServerIdListChoices(),visibilityChecks:[Case_XFormItem.prototype.isCurrentTab],visibilityChangeEventSources:[ZaModel.currentStep],caseKey:k,caseVarRef:ZaModel.currentStep,radioBoxLabel1:ZaMsg.ServerPool_Donotlimit,radioBoxLabel2:ZaMsg.COS_LimitServersTo}
]}
];
c.items=r;
t.push(c)
}
if(b){
var h={
type:_CASE_,numCols:1,colSizes:["auto"],caseKey:b,width:"100%",cellpadding:0,id:"cos_form_advanced_tab"};
var d=[{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:false,content:ZaMsg.NAD_ZERO_UNLIMETED}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_attachment_settings",label:ZaMsg.NAD_AttachmentsGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraAttachmentsBlocked]]],items:[{
ref:ZaCos.A_zimbraAttachmentsBlocked,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_RemoveAllAttachments,label:ZaMsg.NAD_RemoveAllAttachments,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE",labelCssClass:"xform_label",align:_LEFT_}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_quota_settings",label:ZaMsg.NAD_QuotaGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraMailForwardingAddressMaxLength,ZaCos.A_zimbraMailForwardingAddressMaxNumAddrs,ZaCos.A_zimbraMailQuota,ZaCos.A_zimbraContactMaxNumEntries,ZaCos.A_zimbraQuotaWarnPercent,ZaCos.A_zimbraQuotaWarnInterval,ZaCos.A_zimbraQuotaWarnMessage]]],items:[{
ref:ZaCos.A_zimbraMailForwardingAddressMaxLength,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxLength,label:ZaMsg.LBL_zimbraMailForwardingAddressMaxLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraMailForwardingAddressMaxNumAddrs,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMailForwardingAddressMaxNumAddrs,label:ZaMsg.LBL_zimbraMailForwardingAddressMaxNumAddrs,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraMailQuota,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMailQuota,label:ZaMsg.LBL_zimbraMailQuota,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraContactMaxNumEntries,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraContactMaxNumEntries,label:ZaMsg.LBL_zimbraContactMaxNumEntries,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraQuotaWarnPercent,type:_INPUT_,msgName:ZaMsg.MSG_zimbraQuotaWarnPercent,label:ZaMsg.LBL_zimbraQuotaWarnPercent,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraQuotaWarnInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraQuotaWarnInterval,label:ZaMsg.LBL_zimbraQuotaWarnInterval,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraQuotaWarnMessage,type:_TEXTAREA_,msgName:ZaMsg.MSG_zimbraQuotaWarnMessage,label:ZaMsg.LBL_zimbraQuotaWarnMessage,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",width:"30em"}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_datasourcepolling_settings",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraDataSourceMinPollingInterval,ZaCos.A_zimbraDataSourcePop3PollingInterval,ZaCos.A_zimbraDataSourceImapPollingInterval,ZaCos.A_zimbraDataSourceCalendarPollingInterval,ZaCos.A_zimbraDataSourceRssPollingInterval,ZaCos.A_zimbraDataSourceCaldavPollingInterval]]],label:ZaMsg.NAD_DataSourcePolling,items:[{
ref:ZaCos.A_zimbraDataSourceMinPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceMinPollingInterval,label:ZaMsg.LBL_zimbraDataSourceMinPollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourcePop3PollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourcePop3PollingInterval,label:ZaMsg.LBL_zimbraDataSourcePop3PollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceImapPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceImapPollingInterval,label:ZaMsg.LBL_zimbraDataSourceImapPollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceCalendarPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceCalendarPollingInterval,label:ZaMsg.LBL_zimbraDataSourceCalendarPollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceRssPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceRssPollingInterval,label:ZaMsg.LBL_zimbraDataSourceRssPollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
,{
ref:ZaCos.A_zimbraDataSourceCaldavPollingInterval,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDataSourceCaldavPollingInterval,label:ZaMsg.LBL_zimbraDataSourceCaldavPollingInterval,labelLocation:_LEFT_,onChange:ZaNewCosXWizard.validatePollingInterval,labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_proxyalloweddomain_settings",label:ZaMsg.NAD_ProxyAllowedDomains,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraProxyAllowedDomains]]],items:[{
ref:ZaCos.A_zimbraProxyAllowedDomains,msgName:ZaMsg.MSG_zimbraProxyAllowedDomains,label:ZaMsg.LBL_zimbraProxyAllowedDomains,labelLocation:_LEFT_,labelCssStyle:"vertical-align:top;",type:_REPEAT_,align:_LEFT_,repeatInstance:"",addButtonLabel:ZaMsg.NAD_ProxyAddAllowedDomain,removeButtonLabel:ZaMsg.NAD_ProxyRemoveAllowedDomain,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,items:[{
ref:".",type:_TEXTFIELD_,enableDisableChecks:[],visibilityChecks:[],width:"15em"}
]}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_password_settings",label:ZaMsg.NAD_PasswordGrouper,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:false,content:((ZaNewCosXWizard.isAllAuthfromInternal())?ZaMsg.Alert_InternalPassword:ZaMsg.Alert_ExternalPassword)}
,{
ref:ZaCos.A_zimbraPasswordLocked,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_PwdLocked,label:ZaMsg.NAD_PwdLocked,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMinPwdLength,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMinPwdLength,label:ZaMsg.LBL_zimbraMinPwdLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMaxPwdLength,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraMaxPwdLength,label:ZaMsg.LBL_zimbraMaxPwdLength,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinUpperCaseChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinUpperCaseChars,label:ZaMsg.LBL_zimbraPasswordMinUpperCaseChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinLowerCaseChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinLowerCaseChars,label:ZaMsg.LBL_zimbraPasswordMinLowerCaseChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinPunctuationChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinPunctuationChars,label:ZaMsg.LBL_zimbraPasswordMinPunctuationChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinNumericChars,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinNumericChars,label:ZaMsg.LBL_zimbraPasswordMinNumericChars,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraPasswordMinDigitsOrPuncs,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraPasswordMinDigitsOrPuncs,label:ZaMsg.LBL_zimbraPasswordMinDigitsOrPuncs,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[ZaItem.hasWritePermission],enableDisableChecks:[[ZaCosXFormView.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMinPwdAge,type:_TEXTFIELD_,msgName:ZaMsg.MSG_passMinAge,label:ZaMsg.LBL_passMinAge,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraMaxPwdAge,type:_TEXTFIELD_,msgName:ZaMsg.MSG_passMaxAge,label:ZaMsg.LBL_passMaxAge,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
,{
ref:ZaCos.A_zimbraEnforcePwdHistory,type:_TEXTFIELD_,msgName:ZaMsg.MSG_zimbraEnforcePwdHistory,label:ZaMsg.LBL_zimbraEnforcePwdHistory,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",visibilityChecks:[],enableDisableChecks:[[ZaNewCosXWizard.isAllAuthfromInternal]]}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,id:"cos_password_lockout_settings",label:ZaMsg.NAD_FailedLoginGrouper,items:[{
ref:ZaCos.A_zimbraPasswordLockoutEnabled,type:_WIZ_CHECKBOX_,msgName:ZaMsg.LBL_zimbraPasswordLockoutEnabled,label:ZaMsg.LBL_zimbraPasswordLockoutEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaCos.A_zimbraPasswordLockoutMaxFailures,type:_TEXTFIELD_,enableDisableChecks:[ZaNewCosXWizard.isPasswordLockoutEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraPasswordLockoutEnabled],label:ZaMsg.LBL_zimbraPasswordLockoutMaxFailures,subLabel:ZaMsg.TTP_zimbraPasswordLockoutMaxFailuresSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutMaxFailures,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraPasswordLockoutDuration,type:_LIFETIME_,enableDisableChecks:[ZaNewCosXWizard.isPasswordLockoutEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraPasswordLockoutEnabled],label:ZaMsg.LBL_zimbraPasswordLockoutDuration,subLabel:ZaMsg.TTP_zimbraPasswordLockoutDurationSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutDuration,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input"}
,{
ref:ZaCos.A_zimbraPasswordLockoutFailureLifetime,type:_LIFETIME_,enableDisableChecks:[ZaNewCosXWizard.isPasswordLockoutEnabled],enableDisableChangeEventSources:[ZaCos.A_zimbraPasswordLockoutEnabled],label:ZaMsg.LBL_zimbraPasswordLockoutFailureLifetime,subLabel:ZaMsg.TTP_zimbraPasswordLockoutFailureLifetimeSub,msgName:ZaMsg.MSG_zimbraPasswordLockoutFailureLifetime,labelLocation:_LEFT_,textFieldCssClass:"admin_xform_number_input",labelCssStyle:"white-space:normal;",nowrap:false,labelWrap:true}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_TimeoutGrouper,items:[{
ref:ZaCos.A_zimbraAdminAuthTokenLifetime,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraAdminAuthTokenLifetime,label:ZaMsg.LBL_zimbraAdminAuthTokenLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraAuthTokenLifetime,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraAuthTokenLifetime,label:ZaMsg.LBL_zimbraAuthTokenLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailIdleSessionTimeout,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraMailIdleSessionTimeout,label:ZaMsg.LBL_zimbraMailIdleSessionTimeout,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraDumpsterUserVisibleAge,type:_LIFETIME_,msgName:ZaMsg.MSG_zimbraDumpsterUserVisibleAge,label:ZaMsg.LBL_zimbraDumpsterUserVisibleAge,visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraDumpsterEnabled]}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_MailRetentionGrouper,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.WARNING,iconVisible:false,content:ZaMsg.Alert_MailRetention}
,{
ref:ZaCos.A_zimbraMailMessageLifetime,type:_LIFETIME2_,msgName:ZaMsg.MSG_zimbraMailMessageLifetime,label:ZaMsg.LBL_zimbraMailMessageLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailTrashLifetime,type:_LIFETIME1_,msgName:ZaMsg.MSG_zimbraMailTrashLifetime,label:ZaMsg.LBL_zimbraMailTrashLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailSpamLifetime,type:_LIFETIME1_,msgName:ZaMsg.MSG_zimbraMailSpamLifetime,label:ZaMsg.LBL_zimbraMailSpamLifetime,labelLocation:_LEFT_}
,{
ref:ZaCos.A_zimbraMailDumpsterLifetime,type:_LIFETIME1_,msgName:ZaMsg.MSG_zimbraMailDumpsterLifetime,label:ZaMsg.LBL_zimbraMailDumpsterLifetime,visibilityChecks:[[ZaItem.hasReadPermission],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterEnabled,"TRUE"],[XForm.checkInstanceValue,ZaCos.A_zimbraDumpsterPurgeEnabled,"TRUE"]],visibilityChangeEventSources:[ZaCos.A_zimbraDumpsterEnabled,ZaCos.A_zimbraDumpsterPurgeEnabled]}
]}
,{
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_InteropGrouper,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaCos.A_zimbraFreebusyExchangeUserOrg]]],items:[{
ref:ZaCos.A_zimbraFreebusyExchangeUserOrg,type:_TEXTFIELD_,msgName:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,width:"250px",label:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,labelLocation:_LEFT_}
]}
,{
type:_SPACER_,height:"10px"}
];
h.items=d;
t.push(h)
}
v.tableCssStyle="width:100%;overflow:auto;";
this._lastStep=this.stepChoices.length;
v.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep],cssStyle:"white-space: normal"}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:635,align:_LEFT_,valign:_TOP_,cssStyle:"white-space: normal",items:t}
]
};
ZaXDialog.XFormModifiers.ZaNewCosXWizard.push(ZaNewCosXWizard.myXFormModifier);
ZaNewCosXWizard.prototype.getTabChoices=function(){
return this.stepChoices
};
ZaNewCosXWizard.isAllAuthfromInternal=function(){
var e=true;
var o=ZaNewCosXWizard._domainList;
if(!o){
return e
}
for(var t=0;
t<o.length&&e;
t++){
var n=o[t];
if(n.attrs[ZaDomain.A_AuthMech]==ZaDomain.AuthMech_zimbra){
e=false
}}
return !e
};
ZaNewCosXWizard.validatePollingInterval=function(h,r,s){
var t=s.getInstance();
this.setInstanceValue(h);
var c=t.attrs[ZaCos.A_zimbraPrefMailPollingInterval];
var n=t.attrs[ZaCos.A_zimbraMailMinPollingInterval];
var o=s.getItemsById(ZaCos.A_zimbraPrefMailPollingInterval)[0];
try{
if(ZaUtil.getLifeTimeInSeconds(c)<ZaUtil.getLifeTimeInSeconds(n)){
o.setError(ZaMsg.tt_mailPollingIntervalError+n);
s.parent.setDirty(false)
}else{
o.clearError();
s.parent.setDirty(true)
}}
catch(l){
o.setError(l.message);
s.parent.setDirty(false)
}}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchToolBar")){
ZaSearchToolBar=function(t,e,o){
ZaToolBar.call(this,t,null,null,e,"SearchToolBar",o);
this._app=ZaApp.getInstance();
this._searchField=new ZaSearchField(this,"SearchTBSearchField",48,null,o)
};
ZaSearchToolBar.prototype=new ZaToolBar;
ZaSearchToolBar.prototype.constructor=ZaSearchToolBar;
ZaSearchToolBar.prototype.toString=function(){
return"ZaSearchToolBar"
};
ZaSearchToolBar.prototype.addSelectionListener=function(e,t){
if(e!=ZaSearchToolBar.SEARCHFOR_BUTTON){
ZaToolBar.prototype.addSelectionListener.call(this,e,t)
}};
ZaSearchToolBar.prototype.getSearchField=function(){
return this._searchField
}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchField")){
ZaSearchField=function(n,o,e,t,s){
DwtComposite.call(this,n,o,t,null,ZaId.getViewId(ZaId.SEARCH_VIEW,null,s));
this._containedObject=new ZaSearch();
this._initForm(ZaSearch.myXModel,this._getMyXForm());
this._localXForm.setInstance(this._containedObject);
this._app=ZaApp.getInstance();
this._searchFieldId=s
};
ZaSearchField.prototype=new DwtComposite;
ZaSearchField.prototype.constructor=ZaSearchField;
ZaSearchField.prototype.toString=function(){
return"ZaSearchField"
};
ZaSearchField.UNICODE_CHAR_RE=/\S/;
ZaSearchField.prototype.registerCallback=function(e,t){
this._callbackFunc=e;
this._callbackObj=t
};
ZaSearchField.prototype.setObject=function(e){
this._containedObject=e;
this._localXForm.setInstance(this._containedObject)
};
ZaSearchField.prototype.getObject=function(){
return this._containedObject
};
ZaSearchField.prototype.getCurrentSearchQuery=function(){
var e=this._containedObject[ZaSearch.A_query]=this.getSearchFieldElement().value;
if(e.indexOf("$set:")==0){
ZaApp.getInstance().getAppCtxt().getClientCmdHdlr().execute((e.substr(5)).split(" "));
return
}
var o={};
var t=ZaApp.getInstance().getSearchBuilderController().isAdvancedSearch(e);
o.types=this.getSearchTypes();
if(t){
o.query=e
}else{
o.query=ZaSearch.getSearchByNameQuery(e,o.types)
}
return o
};
ZaSearchField.prototype.invokeCallback=function(){
var t=this._containedObject[ZaSearch.A_query]=this.getSearchFieldElement().value;
if(t.indexOf("$set:")==0){
ZaApp.getInstance().getAppCtxt().getClientCmdHdlr().execute((t.substr(5)).split(" "));
return
}
var s={};
var n=ZaApp.getInstance().getSearchBuilderController();
var o=n.isAdvancedSearch(t);
var e=ZaApp.getInstance().getSearchListController();
e._isAdvancedSearch=o;
e._currentDomain=null;
e._currentPageNum=1;
e.fetchAttrs=ZaSearch.standardAttributes;
s.types=this.getSearchTypes();
if(o){
DBG.println(AjxDebug.DBG1,"Advanced Search ... ");
s.query=t;
DBG.println(AjxDebug.DBG1,"Query = "+s.query)
}else{
DBG.println(AjxDebug.DBG1,"Basic Search ....");
e._searchFieldInput=t;
s.query=ZaSearch.getSearchByNameQuery(t,s.types)
}
ZaApp.getInstance().getSearchListController()._currentQuery=s.query;
e._currentQuery=s.query;
this._isSearchButtonClicked=false;
if(this._callbackFunc!=null){
if(this._callbackObj!=null){
ZaApp.getInstance().getCurrentController().switchToNextView(this._callbackObj,this._callbackFunc,s)
}else{
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getSearchListController(),this._callbackFunc,s)
}}};
ZaSearchField.isLDAPQuery=function(e){
var t=/\([^\(\)\=]+=[^\(\)\=]+\)/;
if(e.match(t)!=null){
return true
}
return false
};
ZaSearchField.prototype.startSearch=function(s,t,o){
var n={};
if(!s){
s=""
}
var e=ZaApp.getInstance().getSearchListController();
e._isAdvancedSearch=true;
if(!t){
t=ZaSearchOption.getDefaultObjectTypes()
}
e._currentDomain=null;
e._currentPageNum=1;
e.fetchAttrs=ZaSearch.standardAttributes;
n.isShowBubble=o;
n.types=t;
if(!ZaSearchField.isLDAPQuery(s)){
s=ZaSearch.getSearchByNameQuery(s,t)
}
n.query=s;
ZaApp.getInstance().getSearchListController()._currentQuery=n.query;
e._currentQuery=n.query;
if(this._callbackFunc!=null){
if(this._callbackObj!=null){
ZaApp.getInstance().getCurrentController().switchToNextView(this._callbackObj,this._callbackFunc,n)
}else{
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getSearchListController(),this._callbackFunc,n)
}}};
ZaSearchField.prototype.getSearchTypes=function(){
var n=ZaApp.getInstance().getSearchBuilderController();
var o=this.getSearchFieldElement().value;
var t=n.isAdvancedSearch(o);
var e=new Array();
if(t){
e=n.getAddressTypes()
}else{
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
if(this._containedObject[ZaSearch.A_fAccounts]=="TRUE"){
e.push(ZaSearch.ACCOUNTS)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ALIAS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
if(this._containedObject[ZaSearch.A_fAliases]=="TRUE"){
e.push(ZaSearch.ALIASES)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DL_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
if(this._containedObject[ZaSearch.A_fdistributionlists]=="TRUE"){
e.push(ZaSearch.DLS)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.RESOURCE_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
if(this._containedObject[ZaSearch.A_fResources]=="TRUE"){
e.push(ZaSearch.RESOURCES)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DOMAIN_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
if(this._containedObject[ZaSearch.A_fDomains]=="TRUE"){
e.push(ZaSearch.DOMAINS)
}}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.COS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
if(this._containedObject[ZaSearch.A_fCoses]=="TRUE"){
e.push(ZaSearch.COSES)
}}}
return e
};
ZaSearchField.srchButtonHndlr=function(o){
var r=this.getForm().parent;
var l=r.getSearchFieldElement().value;
if(!l||l.length<3){
var s=this.getParentItem().getItems()[2]||this;
return s.setError(AjxMessageFormat.format(AjxMsg.stringTooShort,3))
}
var n=ZaApp.getInstance().getCurrentController();
if(n&&n.setPageNum){
n.setPageNum(1)
}
r.setCurrentSavedSearch({}
);
var t=ZaZimbraAdmin.getInstance().getOverviewPanelController();
var e=t.getOverviewPanel().getFolderTree();
var h=t.getSearchItemPath();
t.setSearchItemPath(h);
e.setSelectionByPath(h);
return;
r.invokeCallback(o)
};
ZaSearchField.entryKeyHandler=function(e,t){
ZaSearchField.srchButtonHndlr.call(e)
};
ZaSearchField.helpSrchButtonHndlr=function(t){
var e=this.getForm().getItemsById(ZaSearch.A_query)[0].getElement().value;
if(e&&e.length>0){
var n="http://support.zimbra.com/help/index.php";
var o=[];
o.push("query="+e);
if(typeof(ZaLicense)==typeof(_UNDEFINED_)){
o.push("FOSS=1")
}
if(ZaServerVersionInfo.version){
o.push("version="+ZaServerVersionInfo.version)
}
n=n+"?"+AjxStringUtil.urlEncode(o.join("&"));
window.open(n,"_blank")
}};
ZaSearchField.saveSrchButtonHndlr=function(e){
var t=this.getForm();
var n=t.parent;
var o=t.getItemsById(ZaSearch.A_query)[0].getElement().value;
if(o&&o.length>0){
n.getSaveAndEditSeachDialog().show(null,o)
}};
ZaSearchField.prototype.getSaveAndEditSeachDialog=function(){
if(!this._savedAndEditSearchDialog){
this._savedAndEditSearchDialog=new ZaSaveSearchDialog(this)
}
return this._savedAndEditSearchDialog
};
ZaSearchField.prototype.showSavedSearchButtonHndlr=function(e){
var t=this.getForm().parent;
t.showSavedSearchMenus()
};
ZaSearchField.prototype.showSavedSearchMenus=function(){
if(this._savedSearchMenu&&this._savedSearchMenu.isPoppedUp()){
return
}
if(ZaSearch.SAVED_SEARCHES.length<=0||ZaSearch._savedSearchToBeUpdated){
var e=new AjxCallback(this,this.popupSavedSearch);
ZaSearch.getSavedSearches(null,e)
}else{
this.popupSavedSearch(null)
}};
ZaSearchField.prototype.popupSavedSearch=function(o,t){
if(o){
ZaSearch.updateSavedSearch(o)
}
if(ZaSearch.SAVED_SEARCHES.length<=0){
if(this._savedSearchMenu){
this._savedSearchMenu.popdown()
}
return
}
this._queryFieldElement=this.getSearchFieldElement();
var e=Dwt.getBounds(this._queryFieldElement);
this.getSavedSearchMenu().popup(0,e.x,e.y+e.height)
};
ZaSearchField.prototype.getSearchFieldElement=function(){
var e=this._localXForm.getItemsById(ZaSearch.A_query)[0];
var t=e.getId()+"_display";
var o=document.getElementById(t);
return o
};
ZaSearchField.prototype.selectSavedSearch=function(e,n,o){
var r=ZaSearch.parseSavedSearchQuery(n);
var t=ZaApp.getInstance().getSearchListController();
if(t._uiContainer){
var s={
type:3,unique:true,query:r,displayName:e};
t._uiContainer.removeAllBubbles(true);
t._uiContainer.addBubble(s)
}};
ZaSearchField.prototype.getSavedSearchActionMenu=function(){
if(!this._savedSearchActionMenu){
this._popupOperations=[];
this._popupOperations[ZaOperation.EDIT]=new ZaOperation(ZaOperation.EDIT,ZaMsg.TBB_Edit,ZaMsg.ACTBB_Edit_tt,"Properties","PropertiesDis",new AjxListener(this,this._editSavedSearchListener));
this._popupOperations[ZaOperation.DELETE]=new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.ACTBB_Delete_tt,"Delete","DeleteDis",new AjxListener(this,this._deleteSavedSearchListener));
this._savedSearchActionMenu=new ZaPopupMenu(this,"ActionMenu",null,this._popupOperations,this._searchFieldId,ZaId.MENU_POP)
}
return this._savedSearchActionMenu
};
ZaSearchField.prototype._savedSearchItemMouseUpListener=function(e,o,t){
this.getSavedSearchActionMenu().popdown();
if(t.button==DwtMouseEvent.RIGHT){
this._currentSavedSearch={
name:e,query:o};
this.getSavedSearchActionMenu().popup(0,t.docX,t.docY);
this.getSavedSearchActionMenu().setZIndex(this._savedSearchMenu.getZIndex()+1)
}};
ZaSearchField.prototype._editSavedSearchListener=function(e){
this._savedSearchActionMenu.popdown();
this.getSaveAndEditSeachDialog().show(this._currentSavedSearch.name,this._currentSavedSearch.query)
};
ZaSearchField.prototype._deleteSavedSearchListener=function(e){
this._savedSearchActionMenu.popdown();
ZaSearch._savedSearchToBeUpdated=true;
var t=new AjxCallback(this,this.modifySavedSearchCallback);
ZaSearch.modifySavedSearches([{
name:this._currentSavedSearch.name,query:null}
],t)
};
ZaSearchField.prototype.modifySavedSearchCallback=function(){
ZaSearch.updateSavedSearch(ZaSearch.getSavedSearches());
if(ZaSettings.TREE_ENABLED){
var e=ZaApp.getInstance()._appCtxt.getAppController().getOverviewPanelController();
e.updateSavedSearchTreeList()
}
this.updateSavedSearchMenu()
};
ZaSearchField.prototype.getSavedSearchMenu=function(e){
if(!this._savedSearchMenu||e){
this.updateSavedSearchMenu()
}
return this._savedSearchMenu
};
ZaSearchField.prototype.updateSavedSearchMenu=function(){
var r=false;
this._queryFieldElement=this.getSearchFieldElement();
var e=Dwt.getBounds(this._queryFieldElement);
if(this._savedSearchMenu){
isPopup=this._savedSearchMenu.isPoppedUp();
this._savedSearchMenu.popdown();
this._savedSearchMenu.dispose()
}
this._savedSearchMenu=new DwtMenu({
parent:this,id:ZaId.getMenuId(ZaId.PANEL_APPSEARCH,ZaId.MENU_DROP)}
);
for(var t=0;
t<ZaSearch.SAVED_SEARCHES.length;
t++){
var h=ZaSearch.SAVED_SEARCHES[t].name;
var o=ZaSearch.SAVED_SEARCHES[t].query;
var s=new DwtMenuItem({
parent:this._savedSearchMenu,id:(ZaId.getMenuItemId(ZaId.SEARCH_QUERY)+"_"+(t+1))}
);
s.setText(h);
s.setSize(e.width);
s.addSelectionListener(new AjxListener(this,ZaSearchField.prototype.selectSavedSearch,[h,o]));
s.addListener(DwtEvent.ONMOUSEUP,new AjxListener(this,this._savedSearchItemMouseUpListener,[h,o]));
s.getHtmlElement().style.overflow="hidden"
}
if(r){
this.popupSavedSearch()
}};
ZaSearchField.advancedButtonHndlr=function(e){
var t=this.getForm();
var o=ZaApp.getInstance().getSearchBuilderController();
o.toggleVisible();
ZaApp.getInstance()._appViewMgr.showSearchBuilder(o.isSBVisible());
if(o.isSBVisible()){
this.widget.setToolTipContent(ZaMsg.tt_advanced_search_close)
}else{
this.widget.setToolTipContent(ZaMsg.tt_advanced_search_open)
}
o.setQuery()
};
ZaSearchField.prototype.getItemByName=function(t){
var e=this._localXForm.getItems()[0].getItems();
var n=e.length;
for(var o=0;
o<n;
o++){
if(e[o].getName()==t){
return e[o]
}}
return null
};
ZaSearchField.prototype.setTooltipForSearchBuildButton=function(t){
var e=this.getItemByName("searchBuildButton");
if(e){
e.getWidget().setToolTipContent(t)
}};
ZaSearchField.prototype.setTooltipForSearchButton=function(t){
var e=this.getItemByName("searchButton");
if(e){
e.getWidget().setToolTipContent(t)
}};
ZaSearchField.prototype.setIconForSearchMenuButton=function(t){
var e=this.getItemByName("searchMenuButton");
if(e){
e.getWidget().setImage(t)
}};
ZaSearchField.prototype.resetSearchFilter=function(){
this._containedObject[ZaSearch.A_fAccounts]="FALSE";
this._containedObject[ZaSearch.A_fdistributionlists]="FALSE";
this._containedObject[ZaSearch.A_fAliases]="FALSE";
this._containedObject[ZaSearch.A_fResources]="FALSE";
this._containedObject[ZaSearch.A_fDomains]="FALSE";
this._containedObject[ZaSearch.A_fCoses]="FALSE"
};
ZaSearchField.prototype.restoreSearchFilter=function(){
if(this.searchSelectedType==ZaSearch.ACCOUNTS){
this.accFilterSelected()
}else{
if(this.searchSelectedType==ZaSearch.ALIASES){
this.aliasFilterSelected()
}else{
if(this.searchSelectedType==ZaSearch.DLS){
this.dlFilterSelected()
}else{
if(this.searchSelectedType==ZaSearch.RESOURCES){
this.resFilterSelected()
}else{
if(this.searchSelectedType==ZaSearch.DOMAINS){
this.domainFilterSelected()
}else{
if(this.searchSelectedType==ZaSearch.COSES){
this.cosFilterSelected()
}else{
this.allFilterSelected()
}}}}}}};
ZaSearchField.prototype.allFilterSelected=function(e){
if(e){
e.item.parent.parent.setImage(e.item.getImage())
}else{
this.setIconForSearchMenuButton("SearchAll")
}
this._containedObject[ZaSearch.A_fAccounts]="TRUE";
this._containedObject[ZaSearch.A_fdistributionlists]="TRUE";
this._containedObject[ZaSearch.A_fAliases]="TRUE";
this._containedObject[ZaSearch.A_fResources]="TRUE";
this._containedObject[ZaSearch.A_fDomains]="TRUE";
this._containedObject[ZaSearch.A_fCoses]="TRUE";
this.setTooltipForSearchButton(ZaMsg.searchForAll);
this.searchSelectedType=""
};
ZaSearchField.prototype.accFilterSelected=function(e){
this.resetSearchFilter();
this.setIconForSearchMenuButton("Account");
this._containedObject[ZaSearch.A_fAccounts]="TRUE";
this.setTooltipForSearchButton(ZaMsg.searchForAccounts);
this.searchSelectedType=ZaSearch.ACCOUNTS
};
ZaSearchField.prototype.accFilterSelectedFromResults=function(e){
this.resetSearchFilter();
this._containedObject[ZaSearch.A_fAccounts]="TRUE"
};
ZaSearchField.prototype.aliasFilterSelected=function(e){
this.resetSearchFilter();
this.setIconForSearchMenuButton("AccountAlias");
this._containedObject[ZaSearch.A_fAliases]="TRUE";
this.setTooltipForSearchButton(ZaMsg.searchForAliases);
this.searchSelectedType=ZaSearch.ALIASES
};
ZaSearchField.prototype.aliasFilterSelectedFromResults=function(e){
this.resetSearchFilter();
this._containedObject[ZaSearch.A_fAliases]="TRUE"
};
ZaSearchField.prototype.dlFilterSelected=function(e){
this.resetSearchFilter();
this.setIconForSearchMenuButton("DistributionList");
this._containedObject[ZaSearch.A_fdistributionlists]="TRUE";
this.setTooltipForSearchButton(ZaMsg.searchForDLs);
this.searchSelectedType=ZaSearch.DLS
};
ZaSearchField.prototype.dlFilterSelectedFromResults=function(e){
this.resetSearchFilter();
this._containedObject[ZaSearch.A_fdistributionlists]="TRUE"
};
ZaSearchField.prototype.resFilterSelected=function(e){
this.resetSearchFilter();
this.setIconForSearchMenuButton("Resource");
this._containedObject[ZaSearch.A_fResources]="TRUE";
this.setTooltipForSearchButton(ZaMsg.searchForResources);
this.searchSelectedType=ZaSearch.RESOURCES
};
ZaSearchField.prototype.domainFilterSelected=function(e){
this.resetSearchFilter();
this.setIconForSearchMenuButton("Domain");
this._containedObject[ZaSearch.A_fDomains]="TRUE";
this.setTooltipForSearchButton(ZaMsg.searchForDomains);
this.searchSelectedType=ZaSearch.DOMAINS
};
ZaSearchField.prototype.domainFilterSelectedFromResults=function(e){
this.resetSearchFilter();
this._containedObject[ZaSearch.A_fDomains]="TRUE"
};
ZaSearchField.prototype.cosFilterSelected=function(e){
this.resetSearchFilter();
this.setIconForSearchMenuButton("COS");
this._containedObject[ZaSearch.A_fCoses]="TRUE";
this.setTooltipForSearchButton(ZaMsg.searchForCOSES);
this.searchSelectedType=ZaSearch.COSES
};
ZaSearchField.searchChoices=new XFormChoices([],XFormChoices.OBJECT_REFERENCE_LIST,null,"labelId");
ZaSearchField.prototype._getMyXForm=function(){
var t=new Array();
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t.push(new ZaOperation(ZaOperation.SEARCH_ACCOUNTS,ZaMsg.SearchFilter_Accounts,ZaMsg.searchForAccounts,"Account","AccountDis",new AjxListener(this,this.accFilterSelected)))
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DL_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t.push(new ZaOperation(ZaOperation.SEARCH_DLS,ZaMsg.SearchFilter_DLs,ZaMsg.searchForDLs,"DistributionList","DistributionListDis",new AjxListener(this,this.dlFilterSelected)))
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ALIAS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t.push(new ZaOperation(ZaOperation.SEARCH_ALIASES,ZaMsg.SearchFilter_Aliases,ZaMsg.searchForAliases,"AccountAlias","AccountAlias",new AjxListener(this,this.aliasFilterSelected)))
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.RESOURCE_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t.push(new ZaOperation(ZaOperation.SEARCH_RESOURCES,ZaMsg.SearchFilter_Resources,ZaMsg.searchForResources,"Resource","ResourceDis",new AjxListener(this,this.resFilterSelected)))
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DOMAIN_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t.push(new ZaOperation(ZaOperation.SEARCH_DOMAINS,ZaMsg.SearchFilter_Domains,ZaMsg.searchForDomains,"Domain","DomainDis",new AjxListener(this,this.domainFilterSelected)))
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.COS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t.push(new ZaOperation(ZaOperation.SEARCH_COSES,ZaMsg.SearchFilter_COSES,ZaMsg.searchForCOSES,"COS","COS",new AjxListener(this,this.cosFilterSelected)))
}
t.push(new ZaOperation(ZaOperation.SEP));
t.push(new ZaOperation(ZaOperation.SEARCH_ALL,ZaMsg.SearchFilter_All,ZaMsg.searchForAll,"SearchAll","SearchAll",new AjxListener(this,this.allFilterSelected)));
ZaSearchField.searchChoices.setChoices(t);
var s=3;
var o;
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
s=7;
o=["59","*","80","110","28","12","110"]
}else{
o=["59","*","80"];
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.HELP_SEARCH]){
s++;
o.push("100")
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SAVE_SEARCH]){
s++;
o.push("28")
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DL_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ALIAS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.RESOURCE_LIST_VIEW]){
s+=2;
o.push("12");
o.push("110")
}}
var n;
s=4;
o=["46","3","*","28"];
var e=new AjxCallback(this,ZaSearchField.entryKeyHandler);
n={
tableCssStyle:"width:100%;",numCols:s,width:"100%",colSizes:o,items:[{
type:_MENU_BUTTON_,label:null,choices:ZaSearchField.searchChoices,name:"searchMenuButton",toolTipContent:ZaMsg.searchToolTip,icon:"SearchAll",cssClass:"ZaSearchFieldButton DwtToolbarButton"}
,{
type:_SPACER_,colSpan:1,cssStyle:"",cssClass:"SearchFieldVert",height:14}
,{
type:_GROUP_,numCols:2,width:"100%",cssClass:"oselect",items:[{
type:_CATEGORIZED_DYNSELECT_,ref:ZaSearch.A_query,dataFetcherClass:ZaSearch,dataFetcherMethod:ZaSearch.prototype.dynSearchField,labelLocation:_NONE_,width:"100%",inputWidth:"100%",editable:true,forceUpdate:true,choices:new XFormChoices([],XFormChoices.OBJECT_REFERENCE_LIST,"name","value"),visibilityChecks:[],enableDisableChecks:[],entryKeyMethod:e,onChange:function(l,h,r){
if(l instanceof ZaItem){
this.setInstanceValue(l.name)
}else{
this.setInstanceValue(l)
}}}
]}
,{
type:_DWT_BUTTON_,toolTipContent:ZaMsg.searchForAll,icon:"Search",name:"searchButton",onActivate:ZaSearchField.srchButtonHndlr,autoPadding:false,cssStyle:"background-color:white;",cssClass:"ZaSearchFieldButton   DwtToolbarButton"}
]};
return n
};
ZaSearchField.canSaveSearch=function(){
return ZaItem.hasWritePermission("zimbraAdminSavedSearches",ZaZimbraAdmin.currentAdminAccount)
};
ZaSearchField.canViewSavedSearch=function(){
return ZaItem.hasReadPermission("zimbraAdminSavedSearches",ZaZimbraAdmin.currentAdminAccount)
};
ZaSearchField.prototype.setCurrentSavedSearch=function(e){
this._currentSavedSearch=e
};
ZaSearchField.prototype.getCurrentSavedSearch=function(){
if(AjxUtil.isEmpty(this._currentSavedSearch)){
this._currentSavedSearch={}
}
return this._currentSavedSearch
};
ZaSearchField.defaultName="Saved Search";
ZaSearchField.nameCache={};
ZaSearchField.prototype.getDefaultSearchName=function(t){
if(!t){
t=ZaSearchField.defaultName
}
if(!ZaSearchField.nameCache[t]){
ZaSearchField.nameCache[t]=[]
}
var e=ZaSearchField.nameCache[t].length+1;
ZaSearchField.nameCache[t].push(e);
return t+" {"+e+"}"
};
ZaSearchField.prototype.doSaveSearch=function(s){
var n=this.getCurrentSavedSearch();
var o=this.getSaveAndEditSeachDialog();
var t=n.name?false:true;
var e=this.getDefaultSearchName(n.name);
o.show(e,s,t)
};
ZaSearchField.prototype._initForm=function(t,e){
if(t==null||e==null){
throw new AjxException("Metadata for XForm and/or XModel are not defined",AjxException.INVALID_PARAM,"ZaSearchField.prototype._initForm")
}
this._localXModel=new XModel(t);
this._localXForm=new XForm(e,this._localXModel,null,this);
this._localXForm.draw();
this._drawn=true
};
ZaSaveSearchDialog=function(e){
if(!e){
return
}
this._searchField=e;
DwtDialog.call(this,e.shell);
this._okButton=this.getButton(DwtDialog.OK_BUTTON);
this.registerCallback(DwtDialog.OK_BUTTON,ZaSaveSearchDialog.prototype.okCallback,this)
};
ZaSaveSearchDialog.prototype=new DwtDialog;
ZaSaveSearchDialog.prototype.constructor=ZaSaveSearchDialog;
ZaSaveSearchDialog.prototype.okCallback=function(){
var o=[];
var e=AjxStringUtil.htmlEncode(this._nameInput.value);
var t=this._queryInput.value;
if(!e){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_SAVENAME_EMPTY);
ZaSaveSearchDialog.prototype.show(null,t)
}
o.push({
name:e,query:t}
);
if(this._isEditMode&&this._origNameOfEdittedSearch!=e){
o.push({
name:this._origNameOfEdittedSearch,query:""}
)
}
this.savedSearchArr=o;
this._checkExistSearch();
this.popdown()
};
ZaSaveSearchDialog.prototype._checkExistSearch=function(){
var n=false;
ZaSearch.updateSavedSearch(ZaSearch.getSavedSearches());
for(var o=0;
o<this.savedSearchArr.length;
o++){
var e=this.savedSearchArr[o].name;
if(ZaSearch.SAVED_SEARCHES&&e){
for(var t=0;
t<ZaSearch.SAVED_SEARCHES.length;
t++){
if(ZaSearch.SAVED_SEARCHES[t].name==e){
n=true;
break
}}}}
if(n){
ZaApp.getInstance().dialogs.confirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON]);
ZaApp.getInstance().dialogs.confirmMessageDialog.setMessage(ZaMsg.Q_SAVE_REPLACE,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this._continueDoSave,this);
ZaApp.getInstance().dialogs.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this._cancelDoSave,this);
ZaApp.getInstance().dialogs.confirmMessageDialog.popup()
}else{
ZaSearch.modifySavedSearches(this.savedSearchArr,new AjxCallback(this._searchField,this._searchField.modifySavedSearchCallback))
}
return n
};
ZaSaveSearchDialog.prototype._continueDoSave=function(){
ZaSearch.modifySavedSearches(this.savedSearchArr,new AjxCallback(this._searchField,this._searchField.modifySavedSearchCallback));
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown()
};
ZaSaveSearchDialog.prototype._cancelDoSave=function(){
ZaApp.getInstance().dialogs.confirmMessageDialog.popdown();
this.popup()
};
ZaSaveSearchDialog.prototype.show=function(t,n,e){
if(!this._createUI){
this._nameInputId=Dwt.getNextId();
this._queryInputId=Dwt.getNextId();
var o=["<table cellspacing='5' style='border-spacing: 7px;'>","<tbody>","<tr>","<td>",ZaMsg.saved_search_editor_name,"</td>","<td>","<div style='overflow: auto;'>","<input type='text' size='50' maxlength='50' id='",this._nameInputId,"' />","</div>","</td>","</tr>","<tr>","<td>",ZaMsg.saved_search_editor_query,"</td>","<td>","<div style='overflow: auto;'>","<input type='text' size='50' maxlength='200' id='",this._queryInputId,"' />","</div>","</td>","</tr>","</tbody>","</table>"];
this.setContent(o.join(""));
this._createUI=true
}
if(!t||e){
this.setTitle(ZaMsg.t_saved_search);
this._isEditMode=false
}else{
this.setTitle(ZaMsg.t_edit_saved_search);
this._isEditMode=true;
this._origNameOfEdittedSearch=t
}
this.popup();
if(!this._nameInput){
this._nameInput=document.getElementById(this._nameInputId)
}
this._nameInput.value=t||"";
if(!this._queryInput){
this._queryInput=document.getElementById(this._queryInputId)
}
this._queryInput.value=n||""
}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchListView")){
ZaSearchListView=function(n){
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:n,className:o,posStyle:t,headerList:e,id:ZaId.TAB_SEARCH_MANAGE,scrollLoading:true}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaSearchListView.prototype=new ZaListView;
ZaSearchListView.prototype.constructor=ZaSearchListView;
ZaSearchListView.prototype.toString=function(){
return"ZaSearchListView"
};
ZaSearchListView.prototype.getTitle=function(){
return ZaMsg.Accounts_view_title
};
ZaSearchListView.prototype.getTabIcon=function(){
return"search"
};
ZaSearchListView.prototype.getTabTitle=function(){
return ZaMsg.Search_view_title
};
ZaSearchListView.prototype.getTabToolTip=function(){
var e=ZaApp.getInstance().getSearchListController();
if(e){
if(e._isAdvancedSearch&&e._currentQuery){
return ZaMsg.tt_tab_Search+e._currentQuery
}else{
if(!e._isAdvancedSearch&&e._searchFieldInput){
return ZaMsg.tt_tab_Search+e._searchFieldInput
}}}
return ZaMsg.Search_view_title
};
ZaSearchListView.prototype._createItemHtml=function(c,t,r){
var l=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(c,e,DwtListView.TYPE_LIST_ITEM);
var p=0;
l[p++]="<table width='100%' cellspacing='0' cellpadding='0'>";
l[p++]="<tr>";
var o=this._headerList.length;
for(var h=0;
h<o;
h++){
var f=this._headerList[h]._field;
var m=this._headerList[h]._width+4;
var u=Dwt.getNextId();
var n=ZaId.TAB_SEARCH_MANAGE;
if(f=="type"){
l[p++]='<td id="'+n+"_data_type_"+u+'" width='+this._headerList[h]._width+">";
switch(c.type){
case ZaItem.ACCOUNT:if(c.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
l[p++]=AjxImg.getImageHtml("AdminUser")
}else{
if(c.attrs[ZaAccount.A_zimbraIsDelegatedAdminAccount]=="TRUE"){
l[p++]=AjxImg.getImageHtml("DomainAdminUser")
}else{
if(c.attrs[ZaAccount.A_zimbraIsSystemAccount]=="TRUE"){
l[p++]=AjxImg.getImageHtml("SpecialAccount")
}else{
if(c.attrs[ZaAccount.A_zimbraIsSystemResource]=="TRUE"){
l[p++]=AjxImg.getImageHtml("SystemResource")
}else{
if(c.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE"){
l[p++]=AjxImg.getImageHtml("AccountExternalVirtual")
}else{
l[p++]=AjxImg.getImageHtml("Account")
}}}}}
break;
case ZaItem.DL:if(c.attrs[ZaDistributionList.A_isAdminGroup]=="TRUE"){
l[p++]=AjxImg.getImageHtml("DistributionListGroup")
}else{
l[p++]=AjxImg.getImageHtml("DistributionList")
}
break;
case ZaItem.ALIAS:l[p++]=AjxImg.getImageHtml("AccountAlias");
break;
case ZaItem.RESOURCE:if(c.attrs[ZaResource.A_zimbraCalResType]==ZaResource.RESOURCE_TYPE_LOCATION){
l[p++]=AjxImg.getImageHtml("Location")
}else{
l[p++]=AjxImg.getImageHtml("Resource")
}
break;
case ZaItem.DOMAIN:var d="Domain";
var g=c.attrs[ZaDomain.A_domainType];
if(g==="alias"){
d+="Alias"
}
l[p++]=AjxImg.getImageHtml(d);
break;
case ZaItem.COS:l[p++]=AjxImg.getImageHtml("COS");
break;
default:l[p++]=c.type;
break
}
l[p++]="</td>"
}else{
if(f==ZaAccount.A_name){
l[p++]='<td id="'+n+"_data_emailaddress_"+u+'" nowrap width='+(AjxEnv.isIE?m:this._headerList[h]._width)+"><nobr>";
if(c.type==ZaItem.DOMAIN){
l[p++]=AjxStringUtil.htmlEncode(c.attrs[ZaDomain.A_domainName])
}else{
if(c.isExternal){
l[p++]="<span class='asterisk'>*</span>"
}
l[p++]=AjxStringUtil.htmlEncode(c.name)
}
l[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_displayname){
l[p++]='<td id="'+n+"_data_displayname_"+u+'" nowrap width='+(AjxEnv.isIE?m:this._headerList[h]._width)+"><nobr>";
l[p++]=AjxStringUtil.htmlEncode(c.attrs[ZaAccount.A_displayname]);
l[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_accountStatus){
l[p++]='<td id="'+n+"_data_status_"+u+'" width='+(AjxEnv.isIE?m:this._headerList[h]._width)+"><nobr>";
var s="";
if(c.type==ZaItem.ACCOUNT){
s=ZaAccount._accountStatus(c.attrs[ZaAccount.A_accountStatus])
}else{
if(c.type==ZaItem.DL){
s=ZaDistributionList.getDLStatus(c.attrs[ZaDistributionList.A_mailStatus])
}else{
if(c.type==ZaItem.RESOURCE){
s=ZaResource.getAccountStatusLabel(c.attrs[ZaAccount.A_accountStatus])
}else{
if(c.type==ZaItem.DOMAIN){
s=ZaDomain._domainStatus(c.attrs[ZaDomain.A_zimbraDomainStatus])
}}}}
l[p++]=s;
l[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_zimbraLastLogonTimestamp){
l[p++]='<td id="'+n+"_data_lastlogontime_"+u+'" width='+(AjxEnv.isIE?m:this._headerList[h]._width)+"><nobr>";
l[p++]=AjxStringUtil.htmlEncode(ZaAccount.getLastLoginTime(c.attrs[ZaAccount.A_zimbraLastLogonTimestamp]));
l[p++]="</nobr></td>"
}else{
if(f==ZaAccount.A_description){
l[p++]='<td id="'+n+"_data_description_"+u+'" width='+this._headerList[h]._width+"><nobr>";
l[p++]=AjxStringUtil.htmlEncode(ZaItem.getDescriptionValue(c.attrs[ZaAccount.A_description]));
l[p++]="</nobr></td>"
}}}}}}}
l[p++]="</tr></table>";
e.innerHTML=l.join("");
return e
};
ZaSearchListView.prototype._getHeaderList=function(){
var e=new Array();
var o=1;
var t=0;
e[t++]=new ZaListHeaderItem("type",ZaMsg.ALV_Type_col,null,"40px",null,null,true,true);
this._defaultColumnSortable=o;
e[t++]=new ZaListHeaderItem(ZaAccount.A_name,ZaMsg.CLV_Name_col,null,"220px",null,null,true,true);
e[t++]=new ZaListHeaderItem(ZaAccount.A_displayname,ZaMsg.ALV_DspName_col,null,"220px",null,null,true,true);
e[t++]=new ZaListHeaderItem(ZaAccount.A_accountStatus,ZaMsg.ALV_Status_col,null,"120px",null,null,true,true);
e[t++]=new ZaListHeaderItem(ZaAccount.A_zimbraLastLogonTimestamp,ZaMsg.ALV_Last_Login,null,Dwt_Button_XFormItem.estimateMyWidth(ZaMsg.ALV_Last_Login,false,0),null,null,true,true);
e[t++]=new ZaListHeaderItem(ZaAccount.A_description,ZaMsg.ALV_Description_col,null,"auto",null,null,true,true);
return e
};
ZaSearchListView.prototype._sortColumn=function(t,o){
try{
ZaApp.getInstance().getAccountListController().setSortOrder(o);
ZaApp.getInstance().getAccountListController().setSortField(t.getSortField());
ZaApp.getInstance().getAccountListController().show()
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e)
}};
function ZaSearchXFormView(e){
ZaTabView.call(this,e,"ZaSearchXFormView","DwtTabView ZaXFormListView");
this.initForm(ZaSearchEdit.myXModel,this.getMyXForm());
this._localXForm.removeListener(DwtEvent.XFORMS_VALUE_CHANGED,this.formChangeListener);
this._localXForm.setController(ZaApp.getInstance());
this._localXForm.setInstance({}
);
this._bubbleList=new ZaSearchBubbleList()
}
ZaSearchXFormView.prototype=new ZaTabView();
ZaSearchXFormView.prototype.constructor=ZaSearchXFormView;
ZaTabView.XFormModifiers.ZaSearchXFormView=new Array();
ZaSearchXFormView.prototype.bubbleChangeCallback=function(){
var e=ZaApp.getInstance().getSearchListController()._uiContainer.getQueryFormBubbles();
e=e?e:"";
ZaApp.getInstance().getSearchListController()._uiContainer.setQueryField(e);
if(ZaApp.getInstance().getSearchListController()._uiContainer.isEnableForSearch()){
var o=ZaApp.getInstance().getSearchListController()._uiContainer.getSearchTypeFormBubbles();
var t=ZaApp.getInstance().getSearchListController()._searchField;
t.startSearch(e,o,true)
}};
ZaSearchXFormView.prototype.addBubble=function(o,t){
try{
if(o.displayName){
o.parent=this;
o.parentId=this._htmlElId;
o.queryCell=this._localXForm.getItemById(this._localXForm.getId()+"_"+ZaSearchEdit.A2_currentQuery).getContainer();
this._bubbleList.addBubble(o)
}
if(!t){
this.bubbleChangeCallback()
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaSearchXFormView.prototype.addBubble")
}};
ZaSearchXFormView.prototype._removeBubble=function(o,t){
var e=DwtControl.fromElementId(o);
if(!e){
return
}
this._bubbleList.removeBubble(e);
e.dispose();
if(!t){
this.bubbleChangeCallback()
}};
ZaSearchXFormView.removeBubble=function(o,s,t){
try{
var n=DwtControl.ALL_BY_ID[s];
if(n){
n._removeBubble(o,t)
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaSearchXFormView.removeBubble")
}};
ZaSearchXFormView.prototype.removeAllBubbles=function(n){
var e=this._bubbleList.size();
for(var o=e-1;
o>=0;
o--){
var t=this._bubbleList.getBubble(o);
if(t){
this._bubbleList.removeBubble(t);
t.dispose()
}}
if(!n){
this.bubbleChangeCallback()
}};
ZaSearchXFormView.prototype.getQueryFormBubbles=function(){
return this._bubbleList.getQueryFormBubbles()
};
ZaSearchXFormView.prototype.getSearchTypeFormBubbles=function(){
return this._bubbleList.getSearchTypeFormBubbles()
};
ZaSearchXFormView.prototype.isEnableForSearch=function(){
return this._bubbleList.isEnableForSearch()
};
ZaSearchXFormView.labelSelectionListener=function(e){
if(e.detail==DwtListView.ITEM_DBL_CLICKED){
if(e.item){
this._selectedItem=e.item;
ZaApp.getInstance().getAccountViewController().show(e.item)
}}};
ZaSearchXFormView.prototype.getQueryField=function(){
return this._localXForm.getInstanceValue(ZaSearchEdit.A2_currentQuery)
};
ZaSearchXFormView.prototype.setQueryField=function(e){
this._localXForm.setInstanceValue(e,ZaSearchEdit.A2_currentQuery)
};
ZaSearchXFormView.prototype.setQueryFieldVisible=function(e){
this.queryVisible=e
};
ZaSearchXFormView.createPopupMenu=function(e){
this.getForm().parent.widget=e
};
ZaSearchXFormView.getCustomHeight=function(){
try{
var s=this.getForm();
var r=this.getForm().parent.getHtmlElement();
var o=parseInt(r.style.height);
if(isNaN(o)){
o=r.clientHeight?r.clientHeight:r.offsetHeight
}
var h=s.getItemsById("xform_header");
var e=0;
if(h){
var n=h[0];
if(n){
e=n.getElement().clientHeight?n.getElement().clientHeight:n.getElement().offsetHeight
}}
if(o<=0){
return"100%"
}else{
return o-e-2
}}
catch(t){}
return"100%"
};
ZaSearchXFormView.getCustomWidth=function(){
try{
var o=this.getForm().parent.getHtmlElement();
var e=parseInt(o.style.width);
if(isNaN(e)){
e=o.clientWidth?o.clientWidth:o.offsetWidth
}
if(e<=0){
return"100%"
}else{
return e
}}
catch(t){}
return"100%"
};
ZaSearchXFormView.doQuickSearch=function(){
if(ZaApp.getInstance().getSearchListController()._uiContainer){
ZaApp.getInstance().getSearchListController()._uiContainer.bubbleChangeCallback()
}};
ZaSearchXFormView.doSaveSearch=function(){
var e=ZaApp.getInstance().getSearchListController()._uiContainer.getQueryFormBubbles();
e=e?e:"";
ZaApp.getInstance().getSearchListController()._searchField.doSaveSearch(e)
};
ZaSearchXFormView.isSearchFieldVisible=function(){
var e=ZaApp.getInstance().getSearchListController()._uiContainer;
if(e){
if(!e.queryVisible){
return false
}}
return true
};
ZaSearchXFormView.myXFormModifier=function(t){
t.tableCssStyle="width:100%;overflow:auto;";
var e=ZaSearchListView.prototype._getHeaderList();
t.items=[{
type:_GROUP_,visibilityChecks:[ZaSearchXFormView.isSearchFieldVisible],visibilityChangeEventSources:[ZaSearchEdit.A2_currentQuery],colSizes:["*","70px","100px"],colSpan:2,numCols:3,width:"100%",id:"xform_header",items:[{
type:_OUTPUT_,ref:ZaSearchEdit.A2_currentQuery,containerCssClass:"search_field_container",cssStyle:"display:none;"}
,{
type:_DWT_BUTTON_,label:ZaMsg.LBL_QuickSearch,name:"SearchButton",autoPadding:false,onActivate:ZaSearchXFormView.doQuickSearch,visibilityChecks:[],enableDisableChecks:[]}
,{
type:_DWT_BUTTON_,label:ZaMsg.LBL_SaveSearch,name:"saveSearchButton",autoPadding:false,onActivate:ZaSearchXFormView.doSaveSearch,visibilityChecks:[],visibilityChecks:["(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SAVE_SEARCH] || ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI])"],enableDisableChangeEventSources:[ZaSearchEdit.A2_currentQuery],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaSearchEdit.A2_currentQuery]]}
]}
,{
ref:ZaSearchEdit.A2_searchResult,colSpan:2,cssClass:"ZaFullPageXFormListView",id:"searchReusltList",type:_DWT_LIST_,createPopupMenu:ZaSearchXFormView.createPopupMenu,multiselect:true,widgetClass:ZaSearchListView,headerList:e,getCustomHeight:ZaSearchXFormView.getCustomHeight,getCustomWidth:ZaSearchXFormView.getCustomWidth,visibilityChecks:[],enableDisableChecks:[]}
]
};
ZaTabView.XFormModifiers.ZaSearchXFormView.push(ZaSearchXFormView.myXFormModifier);
ZaSearchEdit=function(){};
ZaSearchEdit.A2_currentQuery="currentQuery";
ZaSearchEdit.A2_searchResult="searchResult";
ZaSearchEdit.myXModel={
items:[{
id:ZaSearchEdit.A2_currentQuery,type:_STRING_}
,{
id:ZaSearchEdit.A2_searchResult,type:_LIST_}
]}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchBuilderToolbarView")){
ZaSearchBuilderToolbarView=function(e){
this._toolbarOperations={};
this._toolbarOrder=[];
this._toolbarOperations[ZaOperation.SEARCH_BY_BASIC]=new ZaOperation(ZaOperation.SEARCH_BY_BASIC,ZaMsg.searchByBasic,ZaMsg.tt_searchByBasic,"SearchAll","SearchAll",new AjxListener(this,this.basicTypeSelectHndlr));
this._toolbarOperations[ZaOperation.SEARCH_BY_ADDESS_TYPE]=new ZaOperation(ZaOperation.SEARCH_BY_ADDESS_TYPE,ZaMsg.searchByAddressType,ZaMsg.tt_searchByAddressType,"SearchAll","SearchAll",new AjxListener(this,this.objTypeSelectHndlr));
this._toolbarOperations[ZaOperation.SEARCH_BY_DOMAIN]=new ZaOperation(ZaOperation.SEARCH_BY_DOMAIN,ZaMsg.searchByDomain,ZaMsg.tt_searchByDomain,"Domain","DomainDis",new AjxListener(this,this.domainSelectHndlr));
this._toolbarOperations[ZaOperation.SEARCH_BY_SERVER]=new ZaOperation(ZaOperation.SEARCH_BY_SERVER,ZaMsg.searchByServer,ZaMsg.tt_searchByServer,"Server","ServerDis",new AjxListener(this,this.serverSelectHndlr));
this._toolbarOperations[ZaOperation.SEARCH_BY_ADVANCED]=new ZaOperation(ZaOperation.SEARCH_BY_ADVANCED,ZaMsg.searchByAdvanced,ZaMsg.tt_searchByAdvanced,"SearchAll","SearchAll",new AjxListener(this,this.advancedSelectHndlr));
this._toolbarOperations[ZaOperation.SEP]=new ZaOperation(ZaOperation.SEP);
this._toolbarOperations[ZaOperation.SEARCH_BY_REMOVE_ALL]=new ZaOperation(ZaOperation.SEARCH_BY_REMOVE_ALL,ZaMsg.searchByRemoveAll,ZaMsg.tt_searchByRemoveAll,null,null,new AjxListener(this,this.removeSelectHndlr),null,null,"ZaSearchBuilderOptionRemoveAll");
this._toolbarOperations[ZaOperation.SEARCH_BY_COS]=new ZaOperation(ZaOperation.SEARCH_BY_COS,ZaMsg.searchByCOS,ZaMsg.tt_searchByCOS,"COS","COS",new AjxListener(this,this.cosSelectHndlr));
this._toolbarOperations[ZaOperation.NONE]=new ZaOperation(ZaOperation.NONE);
this._toolbarOperations[ZaOperation.CLOSE]=new ZaOperation(ZaOperation.CLOSE,ZaMsg.TBB_Close,ZaMsg.tt_advanced_search_close,"Close","CloseDis",new AjxListener(this,this.closeHndlr));
this._toolbarOrder.push(ZaOperation.SEARCH_BY_BASIC);
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ACCOUNT_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DL_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.ALIAS_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.RESOURCE_LIST_VIEW]){
this._toolbarOrder.push(ZaOperation.SEARCH_BY_ADDESS_TYPE)
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.DOMAIN_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._toolbarOrder.push(ZaOperation.SEARCH_BY_DOMAIN)
}
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.SERVER_LIST_VIEW]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._toolbarOrder.push(ZaOperation.SEARCH_BY_SERVER)
}
this._toolbarOrder.push(ZaOperation.SEARCH_BY_ADVANCED);
this._toolbarOrder.push(ZaOperation.SEARCH_BY_COS);
this._toolbarOrder.push(ZaOperation.SEP);
this._toolbarOrder.push(ZaOperation.SEARCH_BY_REMOVE_ALL);
this._toolbarOrder.push(ZaOperation.NONE);
this._toolbarOrder.push(ZaOperation.CLOSE);
ZaToolBar.call(this,e,this._toolbarOperations,this._toolbarOrder,null,"ZaSearchBuilderToolBar");
this._app=ZaApp.getInstance();
this.zShow(false);
this._controller=ZaApp.getInstance().getSearchBuilderController();
this._view={}
};
ZaSearchBuilderToolbarView.prototype=new ZaToolBar;
ZaSearchBuilderToolbarView.prototype.constructor=ZaSearchBuilderToolbarView;
ZaSearchBuilderToolbarView.prototype.toString=function(){
return"ZaSearchBuilderToolbarView"
};
ZaSearchBuilderToolbarView.prototype.basicTypeSelectHndlr=function(e){
this._controller.addOptionView(ZaSearchOption.BASIC_TYPE_ID)
};
ZaSearchBuilderToolbarView.prototype.objTypeSelectHndlr=function(e){
this._controller.addOptionView(ZaSearchOption.OBJECT_TYPE_ID);
e.item.setEnabled(false)
};
ZaSearchBuilderToolbarView.prototype.domainSelectHndlr=function(e){
this._controller.addOptionView(ZaSearchOption.DOMAIN_ID)
};
ZaSearchBuilderToolbarView.prototype.serverSelectHndlr=function(e){
this._controller.addOptionView(ZaSearchOption.SERVER_ID);
this._controller.listAllServers();
e.item.setEnabled(false)
};
ZaSearchBuilderToolbarView.prototype.advancedSelectHndlr=function(e){
this._controller.addOptionView(ZaSearchOption.ADVANCED_ID)
};
ZaSearchBuilderToolbarView.prototype.cosSelectHndlr=function(e){
this._controller.addOptionView(ZaSearchOption.COS_ID)
};
ZaSearchBuilderToolbarView.prototype.removeSelectHndlr=function(e){
this._controller.removeAllOptionViews();
this._controller.setQuery()
};
ZaSearchBuilderToolbarView.prototype.closeHndlr=function(e){
DBG.println(AjxDebug.DBG3,"Close ... ");
this._controller.toggleVisible();
ZaApp.getInstance()._appViewMgr.showSearchBuilder(this._controller.isSBVisible());
this._controller.setQuery();
ZaApp.getInstance().getSearchListController()._searchField.setTooltipForSearchBuildButton(ZaMsg.tt_advanced_search_open)
}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchOptionView")){
ZaSearchOptionView=function(s,r,n,o){
DwtComposite.call(this,s,"ZaSearchOptionView",Dwt.ABSOLUTE_STYLE,true);
this._width=n||ZaSearchOptionView.WIDTH;
var t=ZaSearchOptionView.HEIGHT;
var e=s.getNextOptionX();
var l=0;
this.setBounds(e,l,this._width,t);
this._app=ZaApp.getInstance();
this._position=o;
this._optionId=r;
this._controller=ZaApp.getInstance().getSearchBuilderController();
this._label;
if(r==ZaSearchOption.OBJECT_TYPE_ID){
this._label=new ZaOperation(ZaOperation.LABEL,ZaMsg.searchByAddressType,null,"SearchAll","SearchAll")
}else{
if(r==ZaSearchOption.DOMAIN_ID){
this._label=new ZaOperation(ZaOperation.LABEL,ZaMsg.SearchFilter_Domains,null,"Domain","DomainDis")
}else{
if(r==ZaSearchOption.SERVER_ID){
this._label=new ZaOperation(ZaOperation.LABEL,ZaMsg.searchByServer,null,"Server","ServerDis")
}else{
if(r==ZaSearchOption.BASIC_TYPE_ID){
this._label=new ZaOperation(ZaOperation.LABEL,ZaMsg.searchByBasic,null,"SearchAll","SearchAll")
}else{
if(r==ZaSearchOption.ADVANCED_ID){
this._label=new ZaOperation(ZaOperation.LABEL,ZaMsg.searchByAdvanced,null,"SearchAll","SearchAll")
}else{
if(r==ZaSearchOption.COS_ID){
this._label=new ZaOperation(ZaOperation.LABEL,ZaMsg.searchByCOS,null,"COS","COS")
}}}}}}
var h=[];
h.push(this._label);
h.push(new ZaOperation(ZaOperation.NONE));
h.push(new ZaOperation(ZaOperation.CLOSE,null,ZaMsg.ALTBB_Close_tt,"Close","CloseDis",new AjxListener(this,this.closeButtonListener)));
this._header=new ZaToolBar(this,h,null,null,"DwtToolBar");
this._header.setSize(this._width,ZaSearchOptionView.HEADER_HEIGHT);
this.initForm(ZaSearchOption.getObjectTypeXModel(r),ZaSearchOption.getObjectTypeXForm(r,t),ZaSearchOption.getDefaultInstance(r))
};
ZaSearchOptionView.prototype=new DwtComposite;
ZaSearchOptionView.prototype.constructor=ZaSearchOptionView;
ZaSearchOptionView.HEADER_HEIGHT=28;
ZaSearchOptionView.WIDTH=200;
ZaSearchOptionView.BASIC_OPTION_WIDTH=200;
ZaSearchOptionView.DOMAIN_OPTION_WIDTH=280;
ZaSearchOptionView.COS_OPTION_WIDTH=280;
ZaSearchOptionView.ADVANCED_OPTION_WIDTH=320;
ZaSearchOptionView.MARGIN=0;
ZaSearchOptionView.HEIGHT=225;
ZaSearchOptionView.prototype.closeButtonListener=function(e){
DBG.println(AjxDebug.DBG3,"Close options ... ");
this._controller.removeOptionView(this._position,true)
};
ZaSearchOptionView.prototype.setPosition=function(e){
this._position=e
};
ZaSearchOptionView.prototype.getPosition=function(){
return this._position
};
ZaSearchOptionView.prototype.initForm=function(o,t,e){
if(o==null||t==null){
throw new AjxException("Metadata for XForm and/or XModel are not defined",AjxException.INVALID_PARAM,"ZaSearchOptionView.prototype.initForm")
}
this._localXModel=new XModel(o);
this._localXForm=new XForm(t,this._localXModel,e,this);
this._localXForm.setController(ZaApp.getInstance());
this._localXForm.draw();
this._drawn=true
}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchBuilderView")){
ZaSearchBuilderView=function(e){
DwtComposite.call(this,e,"ZaSearchBuilderView",Dwt.ABSOLUTE_STYLE,true);
var t=false;
this.zShow(t);
this._app=ZaApp.getInstance();
this._option_next_x=0;
this._controller=ZaApp.getInstance().getSearchBuilderController();
this.setScrollStyle(DwtControl.SCROLL)
};
ZaSearchBuilderView.prototype=new DwtComposite();
ZaSearchBuilderView.prototype.constructor=ZaSearchBuilderView;
ZaSearchBuilderView.prototype.toString=function(){
return"ZaSearchBuilderView"
};
ZaSearchBuilderView.prototype.getNextOptionX=function(e){
if(e==null){
e=this._controller._option_views.length
}
if(e<=0){
return ZaSearchOptionView.MARGIN
}else{
var t=this._controller._option_views[e-1];
return t.getX()+t.getW()+ZaSearchOptionView.MARGIN
}}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchOptionDialog")){
ZaSearchOptionDialog=function(n,r,e,o,t){
if(arguments.length==0){
return
}
var s="ZaSearchOptionDialog";
if(!this._standardButtons){
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]
}
if(!this._extraButtons){
this._extraButtons=[]
}
this._contextId=t?t:ZaId.DLG_UNDEF;
this._optionId=r;
DwtDialog.call(this,{
parent:n,className:s,standardButtons:this._standardButtons,extraButtons:this._extraButtons,mode:DwtBaseDialog.MODELESS,id:ZaId.getDialogId(this._contextId)}
);
this._controller=ZaApp.getInstance().getSearchBuilderController();
this._app=ZaApp.getInstance();
this._localXForm=null;
this._localXModel=null;
this._drawn=false;
this._containedObject=null;
this._pageDiv=document.createElement("div");
this._pageDiv.className="ZaXWizardDialogPageDiv";
Dwt.setSize(this._pageDiv,e,o);
this._pageDiv.style.overflow="auto";
this._pageDiv.style["overflow-y"]="auto";
this._pageDiv.style["overflow-x"]="auto";
this._createContentHtml();
this.initForm(ZaSearchOption.getNewObjectTypeXModel(r),ZaSearchOption.getNewObjectTypeXForm(r),ZaSearchOption.getDefaultInstance(r));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_CHANGED,new AjxListener(this,this._handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,this._handleXFormError))
};
ZaSearchOptionDialog.prototype=new ZaXDialog;
ZaSearchOptionDialog.prototype.constructor=ZaSearchOptionDialog;
ZaSearchOptionDialog.TEMPLATE="admin.Widgets#ZaSeachOptionDialog";
ZaSearchOptionDialog.prototype._createHtmlFromTemplate=function(e,t){
DwtDialog.prototype._createHtmlFromTemplate.call(this,ZaSearchOptionDialog.TEMPLATE,t)
};
ZaSearchOptionDialog.prototype.getMyXForm=function(e){};
ZaSearchOptionDialog.prototype._handleXFormChange=function(e){
this._button[DwtDialog.OK_BUTTON].setEnabled(true)
};
ZaSearchOptionDialog.prototype._handleXFormError=function(e){
this._button[DwtDialog.OK_BUTTON].setEnabled(false)
}
}
if(AjxPackage.define("zimbraAdmin.search.view.ZaSearchBubbleList")){
ZaSearchBubbleList=function(){
this._bubbleList=new AjxVector()
};
ZaSearchBubbleList.prototype.constructor=ZaSearchBubbleList;
ZaSearchBubbleList.prototype.toString=function(){
return"ZaSearchBubbleList"
};
ZaSearchBubbleList.prototype.size=function(){
return this._bubbleList.size()
};
ZaSearchBubbleList.prototype.getQueryFormBubbles=function(){
var h="";
var t=0;
this._filterQuery={};
for(var n=0;
n<this._bubbleList.size();
n++){
var l=this._bubbleList.get(n);
var s=l.query;
if(s!=null&&s.length>0){
if(l.type==2){
if(!this._filterQuery[l.optionalType]){
this._filterQuery[l.optionalType]=[]
}
this._filterQuery[l.optionalType].push(s)
}else{
h+=s
}
t++
}}
var e;
var o;
for(var r in this._filterQuery){
e="";
o=0;
for(var n=0;
n<this._filterQuery[r].length;
n++){
e+=this._filterQuery[r][n];
o++
}
if(o>1){
e="(|"+e+")"
}
if(e!=null&&e.length>0){
t++;
h+=e
}}
if(t>1){
h="(&"+h+")"
}
return h
};
ZaSearchBubbleList.prototype.isEnableForSearch=function(){
var e=false;
for(var t=0;
t<this._bubbleList.size();
t++){
e=e||this._bubbleList.get(t).disableForSearch
}
return !e
};
ZaSearchBubbleList.prototype.getSearchTypeFormBubbles=function(){
var e=new Array();
var r=new Array();
var h={};
var n=0;
for(var s=0;
s<this._bubbleList.size();
s++){
var o=this._bubbleList.get(s).searchType;
if(!AjxUtil.isEmpty(o)){
for(var t=0;
t<o.length;
t++){
if(h[o[t]]==null){
h[o[t]]=1;
r.push(o[t])
}else{
h[o[t]]++
}}
n++
}}
for(var s=0;
s<r.length;
s++){
if(h[r[s]]==n){
e.push(r[s])
}}
if(!AjxUtil.isEmpty(e)){
return e
}};
ZaSearchBubbleList.prototype.getBubble=function(e){
return this._bubbleList.get(e)
};
ZaSearchBubbleList.prototype.getBubbleByDisplayName=function(e){
if(!e){
return
}
for(var t=0;
t<this._bubbleList.size();
t++){
if(this._bubbleList.get(t).displayName==e){
return this._bubbleList.get(t)
}}};
ZaSearchBubbleList.prototype._addBubble=function(e,t){
if(!e){
return
}
this._bubbleList.add(e,t)
};
ZaSearchBubbleList.prototype.addBubble=function(t){
var e;
if(t.unique){
e=this.getBubbleByDisplayName(t.displayName);
if(e){
e.update(t)
}else{
e=new ZaSearchBubble(t);
this._addBubble(e)
}}else{
e=new ZaSearchBubble(t);
this._addBubble(e)
}};
ZaSearchBubbleList.prototype.removeBubble=function(e){
if(!e){
return
}
this._bubbleList.remove(e)
};
ZaSearchBubbleList.prototype.removeAllBubbles=function(){
this._bubbleList.removeAll()
};
ZaSearchBubble=function(e){
e=e||{};
e.id=this.id=Dwt.getNextId();
e.className=this.className=e.className||"addrBubble";
DwtControl.call(this,e);
this.type=e.type;
if(e.type==2){
this.optionalType=e.optionalType||1
}
this.query=e.query;
this.searchType=e.searchType;
this.parentCell=e.queryCell;
this.parentId=e.parentId;
this.unique=e.unique||false;
this.disableForSearch=e.disableForSearch||false;
this.displayName=this.getDisplayName(e.displayName);
this._createHtml();
this._setEventHdlrs([DwtEvent.ONMOUSEOVER]);
this.addListener(DwtEvent.ONMOUSEOVER,new AjxListener(this,this._mouseOverListener))
};
ZaSearchBubble.prototype=new DwtControl;
ZaSearchBubble.prototype.constructor=ZaSearchBubble;
ZaSearchBubble.prototype.toString=function(){
return"ZaSearchBubble"
};
ZaSearchBubble.displayNameList=new Object();
ZaSearchBubble.prototype.getDisplayName=function(e){
var t;
if(!ZaSearchBubble.displayNameList[e]||this.unique){
ZaSearchBubble.displayNameList[e]=1;
t=e
}else{
t=e+" "+ZaSearchBubble.displayNameList[e];
ZaSearchBubble.displayNameList[e]++
}
return t
};
ZaSearchBubble.prototype._createElement=function(){
return document.createElement("SPAN")
};
ZaSearchBubble.prototype._createHtml=function(){
var r=this.getHtmlElement();
var t=this.id+"_remove";
var h='ZaSearchXFormView.removeBubble("'+this.id+'","'+this.parentId+'");';
var s="display:inline-block;cursor:pointer;";
var e=AjxImg.getImageHtml("BubbleDelete",s,"id='"+t+"' onclick='"+h+"'");
var o=this.displayName&&this.displayName.toString();
var n="<span id='"+this.id+"_displayName'>"+AjxStringUtil.htmlEncode(o)+"</span>"+e;
r.innerHTML=n;
this.reparentHtmlElement(this.parentCell)
};
ZaSearchBubble.prototype.setDisplayName=function(e){
this.displayName=e
};
ZaSearchBubble.prototype.setQuery=function(e){
this.query=e
};
ZaSearchBubble.prototype.setType=function(e){
this.type=e
};
ZaSearchBubble.prototype.update=function(e){
this.type=e.type;
this.query=e.query
};
ZaSearchBubble.prototype._mouseOverListener=function(e){
this._mouseOverAction(e)
};
ZaSearchBubble.prototype._mouseOverAction=function(t){
var e=AjxStringUtil.htmlEncode(this.getToolTip());
this.setToolTipContent(e);
return true
};
ZaSearchBubble.prototype.getToolTip=function(){
return this.query
}
}
if(AjxPackage.define("zimbraAdmin.status.view.ZaServicesListView")){
ZaServicesListView=function(n,s){
if(arguments.length==0){
return
}
var o=s||"ZaServicesListView";
var t=DwtControl.ABSOLUTE_STYLE;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:n,className:o,posStyle:t,headerList:e,id:ZaId.TAB_STATUS_MANAGE}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaServicesListView.prototype=new ZaListView;
ZaServicesListView.prototype.constructor=ZaServicesListView;
ZaServicesListView.STYLE_CLASS="Row";
ZaServicesListView.SELECTED_STYLE_CLASS="Row-"+DwtCssStyle.SELECTED;
ZaServicesListView.prototype.toString=function(){
return"ZaServicesListView"
};
ZaServicesListView.prototype.getTitle=function(){
return ZaMsg.Status_view_title
};
ZaServicesListView.prototype.getTabIcon=function(){
return"Status"
};
ZaServicesListView.prototype._createItemHtml=function(s,t,r){
var n=new Array(50);
var h=document.createElement("div");
this.associateItemWithElement(s,h,DwtListView.TYPE_LIST_ITEM);
var e=0;
h[DwtListView._STYLE_CLASS]=ZaServicesListView.STYLE_CLASS;
h[DwtListView._SELECTED_STYLE_CLASS]=ZaServicesListView.SELECTED_STYLE_CLASS;
h.className=ZaServicesListView.STYLE_CLASS;
e=ZaServicesListView._writeElement.call(this,n,e,s,false);
if(s.serviceMap!=null){
for(var o in s.serviceMap){
e=ZaServicesListView._writeElement.call(this,n,e,s.serviceMap[o],true,o)
}}
h.innerHTML=n.join("");
h.style.height="auto";
return h
};
ZaServicesListView._writeElement=function(n,e,h,r,s){
n[e++]="<table ";
if(r){
n[e++]="class='ZaServicesListView_table'"
}else{
n[e++]="class='ZaServicesListView_server_table'"
}
n[e++]="_serviceInfo=";
n[e++]=r;
n[e++]=">";
n[e++]="<tr>";
var o=this._headerList.length;
for(var t=0;
t<o;
t++){
var l=this._headerList[t]._field;
if(l==ZaStatus.PRFX_Server){
if(!r){
n[e++]="<td width=";
n[e++]=(this._headerList[t]._width);
n[e++]="><table cellpadding=0 cellspacing=0 border=0 style='table-layout:fixed;'>";
n[e++]="<tr>";
n[e++]="<td width=\"14px\" aligh=left onclick='javascript:ZaServicesListView.expand(event, this)'>";
n[e++]=AjxImg.getImageHtml("NodeExpanded");
n[e++]="</td>";
n[e++]="<td align=left width=20>";
if(h.status==1){
n[e++]=AjxImg.getImageHtml("Check")
}else{
if(h.status==0){
n[e++]=AjxImg.getImageHtml("Cancel")
}else{
n[e++]="&nbsp;"
}}
n[e++]="</td>";
n[e++]="<td>";
n[e++]=AjxStringUtil.htmlEncode(h.name);
n[e++]="</td>";
n[e++]="</tr></table></td>"
}else{
n[e++]="<td width=";
n[e++]=(this._headerList[t]._width);
n[e++]=" aligh=left>";
n[e++]=AjxStringUtil.htmlEncode(" ");
n[e++]="</td>"
}}else{
if(l==ZaStatus.PRFX_Service){
if(r){
n[e++]="<td width=";
n[e++]=this._headerList[t]._width;
n[e++]=" ><table cellpadding=0 cellspacing=0 border=0><tr><td width=20>";
if(h.status==1){
n[e++]=AjxImg.getImageHtml("Check")
}else{
n[e++]=AjxImg.getImageHtml("Cancel")
}
n[e++]="</td><td>";
n[e++]=AjxStringUtil.htmlEncode(s);
n[e++]="</td></tr></table></td>"
}else{
n[e++]="<td width=";
n[e++]=this._headerList[t]._width;
n[e++]=" aligh=left>";
n[e++]=AjxStringUtil.htmlEncode(" ");
n[e++]="</td>"
}}else{
if(l==ZaStatus.PRFX_Time){
n[e++]="<td width=";
n[e++]=this._headerList[t]._width;
n[e++]=" aligh=left>";
if(r){
if(((new Date()).getTime()-h.timestamp)>21*60*1000){
n[e++]="<span class='ZaStaleData'>";
n[e++]=AjxStringUtil.htmlEncode(h.time);
n[e++]="&nbsp;";
n[e++]=ZaMsg.DataIsStale;
n[e++]="</span>"
}else{
n[e++]=AjxStringUtil.htmlEncode(h.time)
}}else{
n[e++]=AjxStringUtil.htmlEncode(" ")
}
n[e++]="</td>"
}}}}
n[e++]="</tr></table>";
return e
};
ZaServicesListView.prototype._setNoResultsHtml=function(){
var e=document.createElement("div");
e.innerHTML="<table width='100%' cellspacing='0' cellpadding='1'><tr><td class='NoResults'><br>"+ZaMsg.ServerStatusUnavailable+"</td></tr></table>";
this._parentEl.appendChild(e)
};
ZaServicesListView.prototype._getHeaderList=function(){
var e=[new ZaListHeaderItem(ZaStatus.PRFX_Server,ZaMsg.STV_Server_col,null,250,null,null,true,true),new ZaListHeaderItem(ZaStatus.PRFX_Service,ZaMsg.STV_Service_col,null,100,null,null,true,true),new ZaListHeaderItem(ZaStatus.PRFX_Time,ZaMsg.STV_Time_col,null,200,null,null,true,true)];
return e
};
ZaServicesListView.expand=function(s,e){
var n=DwtUiEvent.getEvent(s);
var r=DwtUiEvent.getTarget(n);
var o=r;
while(o!=null){
if(o.getAttribute("_serviceInfo")!=null){
break
}
o=o.parentNode
}
var t=o.nextSibling;
var h=true;
if(t!=null){
if(t.style.display=="none"){
e.firstChild.className=AjxImg.getClassForImage("NodeExpanded");
h=false
}else{
e.firstChild.className=AjxImg.getClassForImage("NodeCollapsed")
}
while(t!=null&&t.getAttribute("_serviceInfo")=="true"){
if(h){
t.style.display="none"
}else{
t.style.display=""
}
t=t.nextSibling
}}else{
e.firstChild.className=""
}}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaGlobalStatsView")){
ZaGlobalStatsView=function(e){
DwtTabView.call(this,e);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL);
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.GLOBAL_ADVANCED_STATS_TAB]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
this._advancedPage=new ZaGlobalAdvancedStatsPage(this);
this.addTab(ZaMsg.TABT_Advanced_Stats,this._advancedPage)
}
this._tabBar.setVisible(false)
};
ZaGlobalStatsView.prototype=new DwtTabView;
ZaGlobalStatsView.prototype.constructor=ZaGlobalStatsView;
ZaGlobalStatsView.extTabObjects=new Array();
ZaGlobalStatsView.prototype.toString=function(){
return"ZaGlobalStatsView"
};
ZaGlobalStatsView.prototype.getAllServersInfo=function(){
try{
var o=AjxSoapDoc.create("GetAllServersRequest",ZaZimbraAdmin.URN,null);
o.getMethod().setAttribute("applyConfig","false");
o.getMethod().setAttribute("service","mta");
var r=new Object();
r.soapDoc=o;
r.asyncMode=false;
var t={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_ALL_SERVER};
var s=ZaRequestMgr.invoke(r,t).Body.GetAllServersResponse;
var n=s.server;
return n
}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaGlobalStatsView.getAllServersInfo",null,false)
}};
ZaGlobalStatsView.prototype.getAllServersMtaServiceStatus=function(){
var r=ZaGlobalStatsView.prototype.getAllServersInfo();
if(!r){
return null
}
var n=null;
var h={};
var o=0;
var t=0;
var l=false;
var d=false;
var c=[];
for(o=0;
o<r.length;
o++){
n=r[o].a;
h.id=r[o].id;
h.name=r[o].name;
var e;
for(t=0,l=d=false;
t<n.length;
t++){
e=n[t];
if("mta"==e._content){
if(e.n==ZaServer.A_zimbraServiceEnabled){
l=true
}else{
if(e.n==ZaServer.A_zimbraServiceInstalled){
d=true
}}}}
var s=(l&&d);
c[h.name]=s
}
return c
};
ZaGlobalStatsView.prototype.isAllMtaDisable=function(){
var e=ZaGlobalStatsView.prototype.getAllServersMtaServiceStatus();
if(!e){
return true
}
var t=0;
for(t in e){
if(e[t]){
return false
}}
return true
};
ZaGlobalStatsView.prototype.setObject=function(n){
this._containedObject=n;
if(!ZaGlobalStatsView.prototype.isAllMtaDisable()){
if(this._msgCountPage==null){
this._msgCountPage=new ZaGlobalMessageCountPage(this);
this.addTab(ZaMsg.TABT_InMsgs,this._msgCountPage)
}
this._msgCountPage.setObject(n);
if(this._msgsVolumePage==null){
this._msgsVolumePage=new ZaGlobalMessageVolumePage(this);
this.addTab(ZaMsg.TABT_InData,this._msgsVolumePage)
}
this._msgsVolumePage.setObject(n);
if(this._spamPage==null){
this._spamPage=new ZaGlobalSpamActivityPage(this);
this.addTab(ZaMsg.TABT_Spam_Activity,this._spamPage)
}
this._spamPage.setObject(n)
}
if(this._advancedPage){
this._advancedPage.setObject(n)
}
for(var o=0;
o<ZaGlobalStatsView.extTabObjects.length;
o++){
var t=ZaGlobalStatsView.extTabObjects[o];
if(typeof(t.memthod)=="function"){
var e=null;
if(!t.tabKey){
e=new t.memthod(this);
t.tabKey=this.addTab(t.title,e)
}else{
e=this.getTabView(t.tabKey)
}
if(e){
e.setObject(n)
}}}};
ZaGlobalStatsView.prototype.getTitle=function(){
return ZaMsg.GlobalStats_view_title
};
ZaGlobalStatsView.prototype.getTabTitle=function(){
return ZaMsg.GlobalStats_view_title
};
ZaGlobalStatsView.prototype.getTabIcon=function(){
return"Statistics"
};
ZaGlobalStatsView.prototype.getTabToolTip=function(){
return ZaMsg.GlobalStats_view_title
};
ZaGlobalStatsView.prototype._resetTabSizes=function(t,h){
var r=this._tabBar.getSize();
var c=Dwt.getSize(this.titleCell);
var n=r.y||this._tabBar.getHtmlElement().clientHeight;
var d=c.y||this.titleCell.clientHeight;
var s=t;
var e=(h-n-d);
var l=(e>50)?e:50;
if(this._tabs&&this._tabs.length){
for(var o in this._tabs){
if(this._tabs[o]["view"]){
this._tabs[o]["view"].resetSize(s,l)
}}}};
ZaGlobalStatsView.prototype._createHtml=function(){
DwtTabView.prototype._createHtml.call(this);
this._table=document.createElement("table");
var n=this.getHtmlElement();
n.insertBefore(this._table,n.firstChild);
var o;
var e;
var t;
o=this._table.insertRow(0);
o.align="center";
o.vAlign="middle";
this.titleCell=o.insertCell(o.cells.length);
this.titleCell.align="center";
this.titleCell.vAlign="middle";
this.titleCell.noWrap=true;
this.titleCell.id=Dwt.getNextId();
this.titleCell.align="left";
this.titleCell.innerHTML=AjxStringUtil.htmlEncode(ZaMsg.NAD_GlobalStatistics);
this.titleCell.className="AdminTitleBar"
};
ZaGlobalStatsView.prototype.getTabChoices=function(){
var t=[];
if(ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.GLOBAL_ADVANCED_STATS_TAB]||ZaSettings.ENABLED_UI_COMPONENTS[ZaSettings.CARTE_BLANCHE_UI]){
t.push(ZaMsg.TABT_Advanced_Stats)
}
if(!ZaGlobalStatsView.prototype.isAllMtaDisable()){
t.push(ZaMsg.TABT_InMsgs);
t.push(ZaMsg.TABT_InData);
t.push(ZaMsg.TABT_Spam_Activity)
}
for(var o=0;
o<ZaGlobalStatsView.extTabObjects.length;
o++){
var e=ZaGlobalStatsView.extTabObjects[o];
if(typeof(e.memthod)=="function"){
t.push(e.title)
}}
var n=[];
for(var o=1;
o<=t.length;
o++){
n.push({
value:o,label:t[o-1]}
)
}
return n
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaGlobalMessageVolumePage")){
ZaGlobalMessageVolumePage=function(e){
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaGlobalMessageVolumePage.prototype=new DwtTabViewPage;
ZaGlobalMessageVolumePage.prototype.constructor=ZaGlobalMessageVolumePage;
ZaGlobalMessageVolumePage.prototype.toString=function(){
return"ZaGlobalMessageVolumePage"
};
ZaGlobalMessageVolumePage.prototype.showMe=function(o){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var t=parseInt(this.parent.getHtmlElement().style.height);
var e=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(t>26){
this._contentEl.style.height=(Number(t-26).toString()+e)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
ZaGlobalAdvancedStatsPage.detectFlash(document.getElementById("loggerchartglobalmv-flashdetect"));
if(o){
this.setObject()
}
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-volume-48hours","zmmtastats",["mta_volume"],["bytes"],"now-48h","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-volume-30days","zmmtastats",["mta_volume"],["bytes"],"now-30d","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-volume-60days","zmmtastats",["mta_volume"],["bytes"],"now-60d","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-volume-year","zmmtastats",["mta_volume"],["bytes"],"now-1y","now",{
convertToCount:1}
)
};
ZaGlobalMessageVolumePage.prototype.setObject=function(){};
ZaGlobalMessageVolumePage.prototype._createHtml=function(){
DwtTabViewPage.prototype._createHtml.call(this);
var e=0;
var t=new Array(50);
t[e++]="<h1 style='display:none;' id='loggerchartglobalmv-flashdetect'></h1>";
t[e++]="<div class='StatsHeader'>"+ZaMsg.Stats_MV_Header+"</div>";
t[e++]="<div class='StatsDiv'>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsHour)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-volume-48hours'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsDay)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-volume-30days'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsMonth)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-volume-60days'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsYear)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-volume-year'></div>";
t[e++]="</div>";
t[e++]="</div>";
this.getHtmlElement().innerHTML=t.join("")
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaGlobalMessageCountPage")){
ZaGlobalMessageCountPage=function(e){
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaGlobalMessageCountPage.prototype=new DwtTabViewPage;
ZaGlobalMessageCountPage.prototype.constructor=ZaGlobalMessageCountPage;
ZaGlobalMessageCountPage.prototype.toString=function(){
return"ZaGlobalMessageCountPage"
};
ZaGlobalMessageCountPage.prototype.showMe=function(o){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var t=parseInt(this.parent.getHtmlElement().style.height);
var e=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(t>26){
this._contentEl.style.height=(Number(t-26).toString()+e)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
ZaGlobalAdvancedStatsPage.detectFlash(document.getElementById("loggerchartglobalmc-flashdetect"));
if(o){
this.setObject()
}};
ZaGlobalMessageCountPage.prototype.setObject=function(){
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-count-48hours","zmmtastats",["mta_count"],["msgs"],"now-48h","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-count-30days","zmmtastats",["mta_count"],["msgs"],"now-30d","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-count-60days","zmmtastats",["mta_count"],["msgs"],"now-60d","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-count-year","zmmtastats",["mta_count"],["msgs"],"now-1y","now",{
convertToCount:1}
)
};
ZaGlobalMessageCountPage.prototype._createHtml=function(){
DwtTabViewPage.prototype._createHtml.call(this);
var e=0;
var t=new Array(50);
t[e++]="<div style='display:none;' id='loggerchartglobalmc-flashdetect'></div>";
t[e++]="<div class='StatsHeader'>"+ZaMsg.Stats_MC_Header+"</div>";
t[e++]="<div class='StatsDiv'>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsHour)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-count-48hours'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsDay)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-count-30days'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsMonth)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-count-60days'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsYear)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-count-year'></div>";
t[e++]="</div>";
t[e++]="</div>";
this.getHtmlElement().innerHTML=t.join("")
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaGlobalSpamActivityPage")){
ZaGlobalSpamActivityPage=function(e){
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaGlobalSpamActivityPage.prototype=new DwtTabViewPage;
ZaGlobalSpamActivityPage.prototype.constructor=ZaGlobalSpamActivityPage;
ZaGlobalSpamActivityPage.prototype.toString=function(){
return"ZaGlobalSpamActivityPage"
};
ZaGlobalSpamActivityPage.prototype.showMe=function(o){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var t=parseInt(this.parent.getHtmlElement().style.height);
var e=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(t>26){
this._contentEl.style.height=(Number(t-26).toString()+e)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
ZaGlobalAdvancedStatsPage.detectFlash(document.getElementById("loggerchartglobalasav-flashdetect"));
if(o){
this.setObject()
}
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-asav-48hours","zmmtastats",["filter_virus","filter_spam"],["filtered"],"now-48h","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-asav-30days","zmmtastats",["filter_virus","filter_spam"],["filtered"],"now-30d","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-asav-60days","zmmtastats",["filter_virus","filter_spam"],["filtered"],"now-60d","now",{
convertToCount:1}
);
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart("global-message-asav-year","zmmtastats",["filter_virus","filter_spam"],["filtered"],"now-1y","now",{
convertToCount:1}
)
};
ZaGlobalSpamActivityPage.prototype.setObject=function(){};
ZaGlobalSpamActivityPage.prototype._createHtml=function(){
DwtTabViewPage.prototype._createHtml.call(this);
var e=0;
var t=new Array(50);
t[e++]="<h1 style='display:none;' id='loggerchartglobalasav-flashdetect'></h1>";
t[e++]="<div class='StatsHeader'>"+ZaMsg.Stats_AV_Header+"</div>";
t[e++]="<div class='StatsDiv'>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsHour)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-asav-48hours'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsDay)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-asav-30days'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsMonth)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-asav-60days'></div>";
t[e++]="</div>";
t[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsYear)+"</div>";
t[e++]="<div class='StatsImage'>";
t[e++]="<div id='loggerchartglobal-message-asav-year'></div>";
t[e++]="</div>";
t[e++]="</div>";
this.getHtmlElement().innerHTML=t.join("")
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaGlobalAdvancedStatsPage")){
ZaGlobalAdvancedStatsPage=function(e){
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this._app=ZaApp.getInstance();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaGlobalAdvancedStatsPage.prototype=new DwtTabViewPage;
ZaGlobalAdvancedStatsPage.prototype.constructor=ZaGlobalAdvancedStatsPage;
ZaGlobalAdvancedStatsPage.prototype.toString=function(){
return"ZaGlobalAdvancedStatsPage"
};
ZaGlobalAdvancedStatsPage.prototype.showMe=function(n){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var o=parseInt(this.parent.getHtmlElement().style.height);
var t=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(o>26){
this._contentEl.style.height=(Number(o-26).toString()+t)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
if(n){
this.setObject()
}
if(!this._chartHtmlShown){
ZaGlobalAdvancedStatsPage.insertChartHTML(this.getHtmlElement());
this._chartHtmlShown=true
}
var e=ZaApp.getInstance().getCurrentController();
e._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/creating_advanced_server_statistics.htm?locid="+AjxEnv.DEFAULT_LOCALE;
e._helpButtonText=ZaMsg.helpCreateAdvServerStat
};
ZaGlobalAdvancedStatsPage.prototype.hideMe=function(){
DwtTabViewPage.prototype.hideMe.call(this);
var e=ZaApp.getInstance().getCurrentController();
e._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/checking_usage_statistics.htm?locid="+AjxEnv.DEFAULT_LOCALE;
e._helpButtonText=ZaMsg.helpCheckStatistics
};
ZaGlobalAdvancedStatsPage.getDataTipText=function(o,e,t){
var n=AjxMessageFormat.format(ZaMsg.NAD_AdvStatsDataTip,[t.displayName,YAHOO.util.Date.format(o.timestamp,{
format:ZaMsg.NAD_AdvStatsTipDateFormat}
)])+"\n"+ZaGlobalAdvancedStatsPage.formatLabel(o[t.yField]);
return n
};
ZaGlobalAdvancedStatsPage.formatLabel=function(e){
return YAHOO.util.Number.format(e,{
thousandsSeparator:",",decimalPlaces:0}
)
};
ZaGlobalAdvancedStatsPage.formatTimeLabel=function(e){
return YAHOO.util.Date.format(e,{
format:ZaMsg.NAD_AdvStatsLabelDateFormat}
)
};
ZaGlobalAdvancedStatsPage.getTarget=function(e){
if(e&&e.target){
return e.target
}else{
return window.event.srcElement
}};
ZaGlobalAdvancedStatsPage.indexOf=function(t,o){
if(Array.indexOf){
return t.indexOf(o)
}else{
for(var e=0;
e<t.length;
e++){
if(t[e]==o){
return e
}}
return -1
}};
ZaGlobalAdvancedStatsPage.detectFlash=function(r){
var t=false;
var n=YAHOO.deconcept.SWFObjectUtil.getPlayerVersion();
if(n.major==9&&n.minor==0&&n.rev>=45){
t=true
}else{
if(n.major==9&&n.minor>0){
t=true
}else{
if(n.major>9){
t=true
}}}
if(!t){
r.style.display="block";
var h=ZaMsg.NAD_AdvStatsFlashRequired;
if(n.major>0){
h=AjxMessageFormat.format(ZaMsg.NAD_AdvStatsFlashOld,[n.major,n.minor,n.rev])
}
for(var s=r.childNodes.length;
s>0;
s--){
r.removeChild(r.childNodes.item(s-1))
}
var o=document.createElement("a");
ZaGlobalAdvancedStatsPage.setText(o,h);
o.href="http://get.adobe.com/flashplayer";
r.appendChild(o)
}};
ZaGlobalAdvancedStatsPage.setText=function(o,n){
var t=(document.getElementsByTagName("body")[0].innerText!=undefined);
if(t){
o.innerText=n
}else{
o.textContent=n
}};
ZaGlobalAdvancedStatsPage.plotGlobalQuickChart=function(e,p,h,r,t,c,g){
var n=document.getElementById("loggerchart"+e);
ZaGlobalAdvancedStatsPage.setText(n,ZaMsg.NAD_AdvStatsLoadingDataLabel);
var u=AjxSoapDoc.create("GetLoggerStatsRequest",ZaZimbraAdmin.URN,null);
u.set("startTime",{
"!time":t}
);
u.set("endTime",{
"!time":c}
);
var f=[];
for(var d=0;
d<h.length;
d++){
f.push({
"!name":h[d]}
)
}
var m={
"!name":p,"!limit":"true"};
if(f.length>0){
m.values={
stat:[]};
for(var d=0;
d<f.length;
d++){
m.values.stat.push(f[d])
}}
u.set("stats",m);
var s=function(b){
if(b.isException&&b.isException()){
ZaApp.getInstance().getCurrentController()._handleException(b.getException(),"ZaGlobalAdvancedStatsPage.plotGlobalQuickChart",null,false);
return
}
var v=b.getResponse().Body.GetLoggerStatsResponse;
if(!v.hostname||!v.hostname[0].stats){
var F=document.getElementById("loggerchart"+e);
ZaGlobalAdvancedStatsPage.setText(F,ZaMsg.NAD_AdvStatsNoDataLabel);
return
}
var M={};
var T=v.hostname;
if(T[0]&&T[0].stats[0]&&T[0].stats[0].values){
var x=T[0].stats[0].values;
var S=x.length;
var k=T.length;
for(var B=0;
B<S;
B++){
var O=0;
for(var W=0;
W<k;
W++){
if(T[W].stats[0].values[B]&&T[W].stats[0].values[B].stat[0]){
O=O+parseFloat(T[W].stats[0].values[B].stat[0].value)
}}
var D=O/k;
if(!M[T[0].stats[0].values[B].t]){
M[T[0].stats[0].values[B].t]={}
}
M[T[0].stats[0].values[B].t][T[0].stats[0].values[0].stat[0].name]=D
}}
var q=[];
var C=0;
var y=Object.keys(M);
if(y[1]!=null){
C=y[1]-y[0]
}
for(var B in M){
record={
timestamp:new Date(B*1000)};
for(var W in M[B]){
record[W]=M[B][W]
}
for(var W=0;
W<h.length;
W++){
if(!record[h[W]]){
record[h[W]]=0
}
if(g&&g.convertToCount){
record[h[W]]=record[h[W]]*C
}}
q.push(record)
}
if(q.length<1){
var F=document.getElementById("loggerchart"+e);
ZaGlobalAdvancedStatsPage.setText(F,ZaMsg.NAD_AdvStatsNoDataLabel);
return
}
var z=[];
for(var B=0;
B<h.length;
B++){
var w=h[B];
if(r!=null){
w=w+" ("+r[r.length==1?0:B]+")"
}
z.push({
displayName:w,yField:h[B]}
)
}
var A=["timestamp"];
for(var B=0;
B<h.length;
B++){
A.push(h[B])
}
ZaGlobalAdvancedStatsPage.plotChart(e,A,z,q)
};
var l={
soapDoc:u,asyncMode:true,callback:new AjxCallback(s)};
var o={
controller:ZaApp.getInstance().getCurrentController()};
ZaRequestMgr.invoke(l,o)
};
ZaGlobalAdvancedStatsPage.plotQuickChart=function(e,p,g,h,r,t,c,y){
var n=document.getElementById("loggerchart"+e);
n.style.display="block";
ZaGlobalAdvancedStatsPage.setText(n,ZaMsg.NAD_AdvStatsLoadingDataLabel);
var u=AjxSoapDoc.create("GetLoggerStatsRequest",ZaZimbraAdmin.URN,null);
u.set("hostname",{
"!hn":p}
);
u.set("startTime",{
"!time":t}
);
u.set("endTime",{
"!time":c}
);
var f=[];
for(var d=0;
d<h.length;
d++){
f.push({
"!name":h[d]}
)
}
var m={
"!name":g,"!limit":"true"};
if(f.length>0){
m.values={
stat:[]};
for(var d=0;
d<f.length;
d++){
m.values.stat.push(f[d])
}}
u.set("stats",m);
var s=function(w){
if(w.isException&&w.isException()){
ZaApp.getInstance().getCurrentController()._handleException(w.getException(),"ZaGlobalAdvancedStatsPage.plotGlobalQuickChart",null,false);
return
}
var b=w.getResponse().Body.GetLoggerStatsResponse;
if(!b.hostname||!b.hostname[0].stats){
var z=document.getElementById("loggerchart"+e);
ZaGlobalAdvancedStatsPage.setText(z,ZaMsg.NAD_AdvStatsNoDataLabel);
return
}
var C=b.hostname[0].stats[0].values;
if(!C){
var z=document.getElementById("loggerchart"+e);
ZaGlobalAdvancedStatsPage.setText(z,ZaMsg.NAD_AdvStatsNoDataLabel);
return
}
var D=[];
var O=0;
var A=new Array();
for(var k=0;
k<h.length;
k++){
A.push(h[k].replace(/[\/%:]/g,"_"))
}
for(var k=0;
k<C.length;
k++){
if(k+1<C.length){
O=C[k+1].t-C[k].t
}
var T=new Date(C[k].t*1000);
var x={
timestamp:T};
for(var v=0;
v<C[k].stat.length;
v++){
if(ZaGlobalAdvancedStatsPage.indexOf(h,C[k].stat[v].name)!=-1){
x[C[k].stat[v].name.replace(/[\/%:]/g,"_")]=C[k].stat[v].value
}}
for(var v=0;
v<A.length;
v++){
if(!x[A[v]]){
x[A[v]]=0
}
if(y&&y.convertToCount){
x[A[v]]=x[A[v]]*O
}}
D.push(x)
}
if(D.length<1){
var z=document.getElementById("loggerchart"+e);
ZaGlobalAdvancedStatsPage.setText(z,ZaMsg.NAD_AdvStatsNoDataLabel);
return
}
var W=[];
for(var k=0;
k<h.length;
k++){
var B=h[k];
if(r!=null){
if((r.length==1&&r[0]!=null)||(r.length>1&&r[k]!=null)){
B=B+" ("+r[r.length==1?0:k]+")"
}}
W.push({
displayName:B,yField:A[k]}
)
}
var q=["timestamp"];
for(var k=0;
k<A.length;
k++){
q.push(A[k])
}
ZaGlobalAdvancedStatsPage.plotChart(e,q,W,D)
};
var l={
soapDoc:u,asyncMode:true,callback:new AjxCallback(s)};
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.PQ_LOADING};
ZaRequestMgr.invoke(l,o)
};
ZaGlobalAdvancedStatsPage.plotChart=function(s,c,u,f){
var n=new YAHOO.widget.NumericAxis();
var d=0;
for(var h=0;
h<u.length;
h++){
u[h].style={
size:4,lineSize:1}
}
for(var h=0;
h<f.length;
h++){
for(var r=0;
r<u.length;
r++){
d=Math.max(d,f[h][u[r].yField])
}}
n.maximum=d+10;
n.minimum=0;
n.labelFunction=ZaGlobalAdvancedStatsPage.formatLabel;
var l=new YAHOO.widget.TimeAxis();
if(f.length>1){
var m=f[1].timestamp.getTime()-f[0].timestamp.getTime();
m=m/1000/60;
l.title=AjxMessageFormat.format(ZaMsg.NAD_AdvStatsIntervalFormatMinutes,[m])
}
l.labelFunction=function(b){
var g=f[0].timestamp.getTime();
var p=f[f.length-1].timestamp.getTime();
var w=(p-g)/1000;
var y;
if(w>2*24*60*60){
y=AjxDateFormat.getDateInstance(AjxDateFormat.SHORT)
}else{
y=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT)
}
return y.format(b)
};
l.maximum=f[f.length-1].timestamp;
l.minimum=f[0].timestamp;
var e=u;
var o=new YAHOO.util.DataSource(f);
ZaGlobalAdvancedStatsPage.CHART_DATA_SOURCE=o;
o.responseType=YAHOO.util.DataSource.TYPE_JSARRAY;
o.responseSchema={
fields:c};
var t=document.getElementById("loggerchart"+s);
t.style.height="200px";
new YAHOO.widget.LineChart("loggerchart"+s,o,{
xField:"timestamp",wmode:"transparent",series:e,yAxis:n,xAxis:l,dataTipFunction:ZaGlobalAdvancedStatsPage.getDataTipText,style:{
legend:{
display:"bottom"}}}
)
};
ZaGlobalAdvancedStatsPage.prototype.setObject=function(e){};
ZaGlobalAdvancedStatsPage.serverSelected=function(o,l){
var t=ZaGlobalAdvancedStatsPage.getTarget(o);
var n=t[t.selectedIndex].value;
var h=AjxSoapDoc.create("GetLoggerStatsRequest",ZaZimbraAdmin.URN,null);
h.set("hostname",{
"!hn":n}
);
var e=function(d){
var c=d.getResponse().Body.GetLoggerStatsResponse;
var f=document.getElementById("select-group"+l);
var g=c.hostname[0].stats;
ZaGlobalAdvancedStatsPage.clearSelect(f);
for(var m=0,u=g.length;
m<u;
m++){
var p=document.createElement("option");
if(m==0){
p.selected="selected"
}
p.value=g[m].name;
ZaGlobalAdvancedStatsPage.setText(p,g[m].name);
f.appendChild(p)
}
ZaGlobalAdvancedStatsPage.groupSelected({
target:f}
,l)
};
var s={
soapDoc:h,asyncMode:true,callback:new AjxCallback(e)};
var r={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.PQ_LOADING};
ZaRequestMgr.invoke(s,r)
};
ZaGlobalAdvancedStatsPage.clearSelect=function(o){
var e=o.getElementsByTagName("option");
for(var t=o.childNodes.length;
t>0;
t--){
o.removeChild(o.childNodes.item(t-1))
}};
ZaGlobalAdvancedStatsPage.groupSelected=function(o,h){
var e=ZaGlobalAdvancedStatsPage.getTarget(o);
var s=document.getElementById("select-servers"+h);
var n=s[s.selectedIndex].value;
var r=e[e.selectedIndex].value;
var t=document.getElementById("select-counter"+h);
ZaGlobalAdvancedStatsPage.clearSelect(t);
ZaGlobalAdvancedStatsPage._getCounters(n,r,t)
};
ZaGlobalAdvancedStatsPage._getCounters=function(o,h,t){
var r=AjxSoapDoc.create("GetLoggerStatsRequest",ZaZimbraAdmin.URN,null);
r.set("hostname",{
"!hn":o}
);
var l=r.set("stats",{
"!name":h}
);
r.set(null,"get-counters",l);
var e=function(d){
var c=d.getResponse().Body.GetLoggerStatsResponse;
var p=c.hostname[0].stats[0].values[0].stat;
if(p){
for(var m=0,u=p.length;
m<u;
m++){
var f=document.createElement("option");
f.value=p[m].name;
ZaGlobalAdvancedStatsPage.setText(f,p[m].name);
if(p[m].type){
f.columnUnit=p[m].type
}
t.appendChild(f)
}}};
var n={
soapDoc:r,asyncMode:true,callback:new AjxCallback(e)};
var s={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.PQ_LOADING};
ZaRequestMgr.invoke(n,s)
};
ZaGlobalAdvancedStatsPage.getMTAHosts=function(){
if(ZaGlobalAdvancedStatsPage.MTA_HOSTS){
return ZaGlobalAdvancedStatsPage.MTA_HOSTS
}
var l=new Array();
var h=ZaApp.getInstance().getServerList();
if(h){
var t=h.getArray();
var o=t.length;
for(var s=0;
s<o;
s++){
var d=t[s];
var u=false;
var c=false;
if(d.attrs){
var e=d.attrs[ZaServer.A_zimbraServiceEnabled];
var r=d.attrs[ZaServer.A_zimbraServiceEnabled];
var n;
for(n in e){
if(e[n]=="mta"){
c=true;
break
}}
for(n in r){
if(r[n]=="mta"){
u=true;
break
}}}
if(u&&c){
l.push(t[s].name)
}}}
ZaGlobalAdvancedStatsPage.MTA_HOSTS=l;
return ZaGlobalAdvancedStatsPage.MTA_HOSTS
};
ZaGlobalAdvancedStatsPage.hideDIVs=function(n){
if(n&&n instanceof Array){
var o=n.length;
for(var t=0;
t<o;
t++){
var e=document.getElementById("loggerchart"+n[t]);
if(e!=null){
e.style.display="none"
}}}};
ZaGlobalAdvancedStatsPage.getCounters=function(d,u){
var l=AjxSoapDoc.create("GetLoggerStatsRequest",ZaZimbraAdmin.URN,null);
l.set("hostname",{
"!hn":d}
);
var t=l.set("stats",{
"!name":u}
);
l.set(null,"get-counters",t);
var s={
soapDoc:l};
var n={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.PQ_LOADING};
var o=ZaRequestMgr.invoke(s,n).Body.GetLoggerStatsResponse;
if(o&&o.hostname&&o.hostname[0]&&o.hostname[0].stats&&o.hostname[0].stats[0]&&o.hostname[0].stats[0].values&&o.hostname[0].stats[0].values[0]&&o.hostname[0].stats[0].values[0].stat){
var e=o.hostname[0].stats[0].values[0].stat;
var c=[];
if(e){
for(var h=0,r=e.length;
h<r;
h++){
c.push(e[h].name)
}}
return c
}
return 0
};
ZaGlobalAdvancedStatsPage.counterSelected=function(p,e){
var u=ZaGlobalAdvancedStatsPage.getTarget(p);
if(AjxUtil.isEmpty(u)){
return
}
var o=document.getElementById("loggerchart"+e);
ZaGlobalAdvancedStatsPage.setText(o,ZaMsg.NAD_AdvStatsLoadingDataLabel);
var m=document.getElementById("select-servers"+e);
if(AjxUtil.isEmpty(m)||AjxUtil.isEmpty(m.selectedIndex)||m.selectedIndex<0||!m[m.selectedIndex]||!m[m.selectedIndex].value){
return
}
var d=m[m.selectedIndex].value;
var c=document.getElementById("select-group"+e);
if(AjxUtil.isEmpty(c)||AjxUtil.isEmpty(c.selectedIndex)||c.selectedIndex<0||!c[c.selectedIndex]||!c[c.selectedIndex].value){
return
}
var f=c[c.selectedIndex].value;
var n=[];
var l=[];
var h=0;
for(var s=0;
s<u.options.length;
s++){
if(u.options[s].selected){
n[h]=u.options[s].value;
l[h]=u.options[s].columnUnit?u.options[s].columnUnit:null;
h++
}}
if(n.length==0){
return
}
var t=document.getElementById("input-start-time"+e).value;
var r=document.getElementById("input-end-time"+e).value;
ZaGlobalAdvancedStatsPage.plotQuickChart(e,d,f,n,l,t,r)
};
ZaGlobalAdvancedStatsPage.showhide=function(o){
var t=document.getElementById(o);
t.style.display=(t.style.display=="none")?"":"none";
return t.style.display!="none"
};
ZaGlobalAdvancedStatsPage.removeChild=function(o){
var t=document.getElementById(o);
if(!AjxUtil.isEmpty(t)&&!AjxUtil.isEmpty(t.parentNode)){
t.parentNode.removeChild(t)
}};
ZaGlobalAdvancedStatsPage.insertChartHTML=function(s){
var p=Math.random();
var n=document.createElement("form");
n.style.margin="5px 10px";
n.id="loggerform"+p;
n.onsubmit="return false;";
n.action="#";
var b=document.createElement("table");
b.className="ChartSettings";
var t=document.createElement("tbody");
b.appendChild(t);
b.id="loggertable"+p;
b.style.tableLayout="fixed";
if(AjxEnv.isIE){
b.style.width="96%"
}
var c;
var o;
var l;
var g;
o=document.createElement("tr");
l=document.createElement("td");
c=document.createElement("label");
c.style.display="block";
c.htmlFor="select-servers"+p;
ZaGlobalAdvancedStatsPage.setText(c,ZaMsg.NAD_AdvStatsServerLabel);
g=document.createElement("select");
g.id="select-servers"+p;
g.style.width="18em";
g.name="servers";
g.onchange=function(v){
ZaGlobalAdvancedStatsPage.serverSelected(v,p)
};
l.vAlign="top";
l.appendChild(c);
l.appendChild(g);
o.appendChild(l);
l=document.createElement("td");
c=document.createElement("label");
c.style.display="block";
c.htmlFor="select-group"+p;
ZaGlobalAdvancedStatsPage.setText(c,ZaMsg.NAD_AdvStatsGroupLabel);
g=document.createElement("select");
g.id="select-group"+p;
g.style.width="18em";
g.name="groups";
g.onchange=function(v){
ZaGlobalAdvancedStatsPage.groupSelected(v,p)
};
l.vAlign="top";
l.appendChild(c);
l.appendChild(g);
o.appendChild(l);
l=document.createElement("td");
c=document.createElement("label");
c.style.display="block";
c.htmlFor="select-counter"+p;
ZaGlobalAdvancedStatsPage.setText(c,ZaMsg.NAD_AdvStatsCountersLabel);
g=document.createElement("select");
g.id="select-counter"+p;
g.style.width="18em";
g.name="counters";
g.multiple=true;
g.size=5;
g.onchange=function(v){
ZaGlobalAdvancedStatsPage.counterSelected(v,p)
};
l.vAlign="top";
l.appendChild(c);
l.appendChild(g);
o.appendChild(l);
t.appendChild(o);
var d;
o=document.createElement("tr");
l=document.createElement("td");
c=document.createElement("label");
c.style.display="block";
c.htmlFor="input-start-time"+p;
ZaGlobalAdvancedStatsPage.setText(c,ZaMsg.NAD_AdvStatsStartLabel);
d=document.createElement("input");
d.id="input-start-time"+p;
d.type="text";
d.name="startTime";
d.value="now-1d";
l.appendChild(c);
l.appendChild(d);
l.valign="top";
o.appendChild(l);
l=document.createElement("td");
c=document.createElement("label");
c.style.display="block";
c.htmlFor="input-end-time"+p;
ZaGlobalAdvancedStatsPage.setText(c,ZaMsg.NAD_AdvStatsEndLabel);
d=document.createElement("input");
d.id="input-end-time"+p;
d.type="text";
d.name="endTime";
d.value="now";
l.appendChild(c);
l.appendChild(d);
l.valign="top";
o.appendChild(l);
t.appendChild(o);
n.appendChild(b);
var w;
var y;
w=document.createElement("a");
w.href="javascript:void(0)";
w.className="LinkButton";
w.onclick=function(v){
var k=ZaGlobalAdvancedStatsPage.showhide("loggertable"+p);
var x=ZaGlobalAdvancedStatsPage.getTarget(v);
ZaGlobalAdvancedStatsPage.setText(x,(k?ZaMsg.NAD_AdvStatsHideChartSettingsLabel:ZaMsg.NAD_AdvStatsShowChartSettingsLabel));
return false
};
ZaGlobalAdvancedStatsPage.setText(w,ZaMsg.NAD_AdvStatsHideChartSettingsLabel);
n.appendChild(w);
w=document.createElement("a");
w.href="javascript:void(0)";
w.className="LinkButton";
w.onclick=function(){
var v=document.getElementById("select-counter"+p);
ZaGlobalAdvancedStatsPage.counterSelected({
target:v}
,p);
return false
};
ZaGlobalAdvancedStatsPage.setText(w,ZaMsg.NAD_AdvStatsUpdateChartLabel);
n.appendChild(w);
w=document.createElement("a");
w.href="javascript:void(0)";
w.className="LinkButton";
w.onclick=function(){
ZaGlobalAdvancedStatsPage.removeChild("loggerform"+p);
ZaGlobalAdvancedStatsPage.removeChild("loggerchart"+p);
return false
};
ZaGlobalAdvancedStatsPage.setText(w,ZaMsg.NAD_AdvStatsRemoveChartLabel);
n.appendChild(w);
var u=document.createElement("div");
u.style.padding="5px 10px 15px";
u.id="loggerchart"+p;
s.appendChild(n);
s.appendChild(u);
var e=document.getElementById("select-servers"+p);
var h=AjxSoapDoc.create("GetLoggerStatsRequest",ZaZimbraAdmin.URN,null);
var f=function(k){
var v=k.getResponse().Body.GetLoggerStatsResponse;
ZaGlobalAdvancedStatsPage.clearSelect(e);
if(v.hostname){
for(var q=0,x=v.hostname.length;
q<x;
q++){
var z=document.createElement("option");
if(q==0){
z.selected="selected"
}
z.value=v.hostname[q].hn;
ZaGlobalAdvancedStatsPage.setText(z,v.hostname[q].hn);
e.appendChild(z)
}
ZaGlobalAdvancedStatsPage.serverSelected({
target:e}
,p)
}};
var m={
soapDoc:h,asyncMode:true,callback:new AjxCallback(f)};
var r={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.PQ_LOADING};
ZaRequestMgr.invoke(m,r)
};
ZaGlobalAdvancedStatsPage.prototype._createHtml=function(){
DwtTabViewPage.prototype._createHtml.call(this);
var t=this.getHtmlElement();
var o=document.createElement("div");
o.style.padding="5px 10px";
var e=document.createElement("a");
ZaGlobalAdvancedStatsPage.setText(e,ZaMsg.NAD_AdvStatsAddChartLabel);
e.href="javascript:void(0)";
e.className="LinkButton";
e.onclick=function(){
ZaGlobalAdvancedStatsPage.insertChartHTML(t);
return false
};
o.appendChild(e);
t.appendChild(o)
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaServerStatsView")){
ZaServerStatsView=function(e){
DwtTabView.call(this,e);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL);
this._tabBar.setVisible(false);
this._lastWidth=0;
this._lastHeight=0
};
ZaServerStatsView.prototype=new DwtTabView;
ZaServerStatsView.prototype.constructor=ZaServerStatsView;
ZaServerStatsView.prototype._isMtaEnabled=function(e){
return e&&e.attrs[ZaServer.A_zimbraMtaServiceEnabled]
};
ZaServerStatsView.prototype._isMailStoreEnabled=function(e){
return e&&e.attrs[ZaServer.A_zimbraMailboxServiceEnabled]&&e.attrs[ZaServer.A_zimbraMailClientServiceEnabled]
};
ZaServerStatsView.prototype.toString=function(){
return"ZaServerStatsView"
};
ZaServerStatsView.prototype.getTabToolTip=function(){
if(this._containedObject){
return ZaMsg.tt_tab_View+" "+this._containedObject.type+" "+this._containedObject.name+" "+ZaMsg.tt_tab_Statistics
}else{
return""
}};
ZaServerStatsView.prototype.getTabIcon=function(){
return"StatisticsByServer"
};
ZaServerStatsView.prototype.getTabTitle=function(){
if(this._containedObject){
return this._containedObject.name
}else{
return""
}};
ZaServerStatsView.prototype.updateTab=function(){
var e=this.getAppTab();
e.resetLabel(this.getTabTitle());
e.setImage(this.getTabIcon());
e.setToolTipContent(this.getTabToolTip())
};
ZaServerStatsView.prototype.getAppTab=function(){
return ZaApp.getInstance().getTabGroup().getTabById(this.__internalId)
};
ZaServerStatsView.prototype.setObject=function(t){
if(!t||!t.id){
return
}
this._containedObject=t;
this.serverId=t.id;
if(this._msgCountPage==null){
this._diskPage=new ZaServerDiskStatsPage(this);
this.addTab(ZaMsg.TABT_Disk,this._diskPage)
}
this._diskPage.setObject(t);
if(this._sessionPage==null){
this._sessionPage=new ZaServerSessionStatsPage(this);
this.addTab(ZaMsg.TABT_Session,this._sessionPage)
}
this._sessionPage.setObject(t);
if(ZaZimbraAdmin.isGlobalAdmin()&&this._isMailStoreEnabled(t)){
if(this._mbxPage==null){
this._mbxPage=new ZaServerMBXStatsPage(this);
ZaServerMBXStatsPage.TAB_KEY=this.addTab(ZaMsg.TABT_MBX,this._mbxPage)
}
this._mbxPage.setObject(t)
}
if(this._isMtaEnabled(t)){
if(this._msgCountPage==null){
this._msgCountPage=new ZaServerMessageCountPage(this);
this.addTab(ZaMsg.TABT_InMsgs,this._msgCountPage)
}
this._msgCountPage.setObject(t);
if(this._msgsVolumePage==null){
this._msgsVolumePage=new ZaServerMessageVolumePage(this);
this.addTab(ZaMsg.TABT_InData,this._msgsVolumePage)
}
this._msgsVolumePage.setObject(t);
if(this._spamPage==null){
this._spamPage=new ZaServerSpamActivityPage(this);
this.addTab(ZaMsg.TABT_Spam_Activity,this._spamPage)
}
this._spamPage.setObject(t)
}
var e=AjxStringUtil.htmlEncode(ZaMsg.NAD_ServerStatistics);
if(t.name){
e=e+t.name
}
this.titleCell.innerHTML=e;
if(this._lastWidth&&this._lastHeight){
this._resetTabSizes(this._lastWidth,this._lastHeight)
}};
ZaServerStatsView.prototype._resetTabSizes=function(t,h){
this._lastWidth=t;
this._lastHeight=h;
var r=this._tabBar.getSize();
var c=Dwt.getSize(this.titleCell);
var n=r.y||this._tabBar.getHtmlElement().clientHeight;
var d=c.y||this.titleCell.clientHeight;
var s=t;
var e=(h-n-d);
var l=(e>50)?e:50;
if(this._tabs&&this._tabs.length){
for(var o in this._tabs){
if(this._tabs[o]["view"]){
this._tabs[o]["view"].resetSize(s,l)
}}}};
ZaServerStatsView.prototype._createHtml=function(){
DwtTabView.prototype._createHtml.call(this);
this._table=document.createElement("table");
var n=this.getHtmlElement();
n.insertBefore(this._table,n.firstChild);
var o;
var e;
var t;
o=this._table.insertRow(0);
o.align="center";
o.vAlign="middle";
this.titleCell=o.insertCell(o.cells.length);
this.titleCell.align="center";
this.titleCell.vAlign="middle";
this.titleCell.noWrap=true;
this.titleCell.id=Dwt.getNextId();
this.titleCell.align="left";
this.titleCell.innerHTML=AjxStringUtil.htmlEncode(ZaMsg.NAD_ServerStatistics);
this.titleCell.className="AdminTitleBar"
};
ZaServerStatsView.prototype.getTabChoices=function(){
var e=[ZaMsg.TABT_Disk,ZaMsg.TABT_Session];
var o=this._containedObject;
if(ZaZimbraAdmin.isGlobalAdmin()&&this._isMailStoreEnabled(o)){
e.push(ZaMsg.TABT_MBX)
}
if(this._isMtaEnabled(o)){
e.push(ZaMsg.TABT_InMsgs);
e.push(ZaMsg.TABT_InData);
e.push(ZaMsg.TABT_Spam_Activity)
}
var n=[];
for(var t=1;
t<=e.length;
t++){
n.push({
value:t,label:e[t-1]}
)
}
return n
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaServerMessageVolumePage")){
ZaServerMessageVolumePage=function(e){
this.serverId=e.serverId;
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaServerMessageVolumePage.prototype=new DwtTabViewPage;
ZaServerMessageVolumePage.prototype.constructor=ZaServerMessageVolumePage;
ZaServerMessageVolumePage.prototype.toString=function(){
return"ZaServerMessageVolumePage"
};
ZaServerMessageVolumePage.prototype.showMe=function(l){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var s=parseInt(this.parent.getHtmlElement().style.height);
var h=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(s>26){
this._contentEl.style.height=(Number(s-26).toString()+h)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
if(l&&this._currentObject){
this.setObject(this._currentObject)
}
if(this._currentObject){
var u=this._currentObject;
var n=this.serverId;
var o=document.getElementById("loggerchartservermv-"+n);
o.style.display="block";
var d=["servermv-no-mta-"+n,"server-message-volume-48hours-"+n,"server-message-volume-30days-"+n,"server-message-volume-60days-"+n,"server-message-volume-year-"+n];
ZaGlobalAdvancedStatsPage.hideDIVs(d);
var c=ZaGlobalAdvancedStatsPage.getMTAHosts();
if(ZaGlobalAdvancedStatsPage.indexOf(c,u.name)!=-1){
ZaGlobalAdvancedStatsPage.detectFlash(document.getElementById("loggerchartservermv-flashdetect-"+n));
var e=[null,"now-48h","now-30d","now-60d","now-1y"];
for(var t=1;
t<d.length;
t++){
ZaGlobalAdvancedStatsPage.plotQuickChart(d[t],u.name,"zmmtastats",["mta_volume"],["bytes"],e[t],"now",{
convertToCount:1}
)
}}else{
var r=document.getElementById("loggerchartservermv-no-mta-"+n);
r.style.display="block";
o.style.display="none";
ZaGlobalAdvancedStatsPage.setText(r,ZaMsg.Stats_NO_MTA)
}}};
ZaServerMessageVolumePage.prototype.setObject=function(e){
this._currentObject=e
};
ZaServerMessageVolumePage.prototype._createHtml=function(){
DwtTabViewPage.prototype._createHtml.call(this);
var e=0;
var o=new Array(50);
var t=this.serverId;
o[e++]="<h1 style='display:none;' id='loggerchartservermv-flashdetect-"+t+"'></h1>";
o[e++]="<h1 style='display:none;' id='loggerchartservermv-no-mta-"+t+"'></h1>";
o[e++]="<div class='StatsHeader'>"+ZaMsg.Stats_MV_Header+"</div>";
o[e++]="<div class='StatsDiv' id='loggerchartservermv-"+t+"'>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsHour)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-volume-48hours-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsDay)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-volume-30days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsMonth)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-volume-60days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsYear)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-volume-year-"+t+"'></div>";
o[e++]="</div>";
o[e++]="</div>";
this.getHtmlElement().innerHTML=o.join("")
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaServerMessageCountPage")){
ZaServerMessageCountPage=function(e){
this.serverId=e.serverId;
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaServerMessageCountPage.prototype=new DwtTabViewPage;
ZaServerMessageCountPage.prototype.constructor=ZaServerMessageCountPage;
ZaServerMessageCountPage.prototype.toString=function(){
return"ZaServerMessageCountPage"
};
ZaServerMessageCountPage.prototype.showMe=function(l){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var s=parseInt(this.parent.getHtmlElement().style.height);
var h=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(s>26){
this._contentEl.style.height=(Number(s-26).toString()+h)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
if(l&&this._currentObject){
this.setObject(this._currentObject)
}
if(this._currentObject){
var u=this._currentObject;
var n=this.serverId;
var o=document.getElementById("loggerchartservermc-"+n);
o.style.display="block";
var d=["servermc-no-mta-"+n,"server-message-count-48hours-"+n,"server-message-count-30days-"+n,"server-message-count-60days-"+n,"server-message-count-year-"+n];
ZaGlobalAdvancedStatsPage.hideDIVs(d);
var c=ZaGlobalAdvancedStatsPage.getMTAHosts();
if(ZaGlobalAdvancedStatsPage.indexOf(c,u.name)!=-1){
ZaGlobalAdvancedStatsPage.detectFlash(document.getElementById("loggerchartservermc-flashdetect-"+n));
var e=[null,"now-48h","now-30d","now-60d","now-1y"];
for(var t=1;
t<d.length;
t++){
ZaGlobalAdvancedStatsPage.plotQuickChart(d[t],u.name,"zmmtastats",["mta_count"],["msgs"],e[t],"now",{
convertToCount:1}
)
}}else{
var r=document.getElementById("loggerchartservermc-no-mta-"+n);
r.style.display="block";
o.style.display="none";
ZaGlobalAdvancedStatsPage.setText(r,ZaMsg.Stats_NO_MTA)
}}};
ZaServerMessageCountPage.prototype.setObject=function(e){
this._currentObject=e
};
ZaServerMessageCountPage.prototype._createHtml=function(){
var e=0;
var o=new Array(50);
var t=this.serverId;
DwtTabViewPage.prototype._createHtml.call(this);
o[e++]="<h1 style='display:none;' id='loggerchartservermc-flashdetect-"+t+"'></h1>";
o[e++]="<h1 style='display:none;' id='loggerchartservermc-no-mta-"+t+"'></h1>";
o[e++]="<div class='StatsHeader'>"+ZaMsg.Stats_MC_Header+"</div>";
o[e++]="<div class='StatsDiv' id='loggerchartservermc-"+t+"'>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsHour)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-count-48hours-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsDay)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-count-30days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsMonth)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-count-60days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsYear)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-count-year-"+t+"'></div>";
o[e++]="</div>";
o[e++]="</div>";
this.getHtmlElement().innerHTML=o.join("")
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaServerSpamActivityPage")){
ZaServerSpamActivityPage=function(e){
this.serverId=e.serverId;
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaServerSpamActivityPage.prototype=new DwtTabViewPage;
ZaServerSpamActivityPage.prototype.constructor=ZaServerSpamActivityPage;
ZaServerSpamActivityPage.prototype.toString=function(){
return"ZaServerSpamActivityPage"
};
ZaServerSpamActivityPage.prototype.showMe=function(l){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var s=parseInt(this.parent.getHtmlElement().style.height);
var h=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(s>26){
this._contentEl.style.height=(Number(s-26).toString()+h)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
if(l&&this._currentObject){
this.setObject(this._currentObject)
}
if(this._currentObject){
var u=this._currentObject;
var n=this.serverId;
var o=document.getElementById("loggerchartserverasav-"+n);
o.style.display="block";
var d=["serverasav-no-mta-"+n,"server-message-asav-48hours-"+n,"server-message-asav-30days-"+n,"server-message-asav-60days-"+n,"server-message-asav-year-"+n];
ZaGlobalAdvancedStatsPage.hideDIVs(d);
var c=ZaGlobalAdvancedStatsPage.getMTAHosts();
if(ZaGlobalAdvancedStatsPage.indexOf(c,u.name)!=-1){
ZaGlobalAdvancedStatsPage.detectFlash(document.getElementById("loggerchartserverasav-flashdetect-"+n));
var e=[null,"now-48h","now-30d","now-60d","now-1y"];
for(var t=1;
t<d.length;
t++){
ZaGlobalAdvancedStatsPage.plotQuickChart(d[t],u.name,"zmmtastats",["filter_virus","filter_spam"],["filtered"],e[t],"now",{
convertToCount:1}
)
}}else{
var r=document.getElementById("loggerchartserverasav-no-mta-"+n);
r.style.display="block";
o.style.display="none";
ZaGlobalAdvancedStatsPage.setText(r,ZaMsg.Stats_NO_MTA)
}}};
ZaServerSpamActivityPage.prototype.setObject=function(e){
this._currentObject=e
};
ZaServerSpamActivityPage.prototype._createHtml=function(){
DwtTabViewPage.prototype._createHtml.call(this);
var e=0;
var o=new Array(50);
var t=this.serverId;
o[e++]="<h1 style='display:none;' id='loggerchartserverasav-flashdetect-"+t+"'></h1>";
o[e++]="<h1 style='display:none;' id='loggerchartserverasav-no-mta-"+t+"'></h1>";
o[e++]="<div class='StatsHeader'>"+ZaMsg.Stats_AV_Header+"</div>";
o[e++]="<div class='StatsDiv' id='loggerchartserverasav-"+t+"'>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsHour)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-asav-48hours-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsDay)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-asav-30days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsMonth)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-asav-60days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsYear)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-message-asav-year-"+t+"'></div>";
o[e++]="</div>";
o[e++]="</div>";
this.getHtmlElement().innerHTML=o.join("")
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaServerDiskStatsPage")){
ZaServerDiskStatsPage=function(e){
this.serverId=e.serverId;
DwtTabViewPage.call(this,e);
this._fieldIds=new Object();
this.initialized=false;
this.setScrollStyle(DwtControl.SCROLL)
};
ZaServerDiskStatsPage.prototype=new DwtTabViewPage;
ZaServerDiskStatsPage.prototype.constructor=ZaServerDiskStatsPage;
ZaServerDiskStatsPage.prototype.toString=function(){
return"ZaServerDiskStatsPage"
};
ZaServerDiskStatsPage.prototype.showMe=function(c){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var h=parseInt(this.parent.getHtmlElement().style.height);
var l=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(h>26){
this._contentEl.style.height=(Number(h-26).toString()+l)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
if(c&&this._currentObject){
this.setObject(this._currentObject)
}
if(this._currentObject){
var f=this._currentObject;
var r=this.serverId;
ZaGlobalAdvancedStatsPage.detectFlash(document.getElementById("loggerchart-flashdetect-"+r));
if(!this._disks){
var u=ZaGlobalAdvancedStatsPage.getCounters(f.name,"df.csv");
var n={};
for(var s=0;
s<u.length;
s++){
var e=u[s].split("::");
n[e[0]]=1
}
var d=[];
for(var s in n){
d.push(s)
}
this._disks=d
}
var t=[];
for(var s=0;
s<this._disks.length;
s++){
t.push(this._disks[s]+"::disk_pct_used")
}
var m=["server-disk-stat-48hours-"+r,"server-disk-stat-30days-"+r,"server-disk-stat-60days-"+r,"server-disk-stat-year-"+r];
var o=["now-48h","now-30d","now-60d","now-1y"];
for(var s=0;
s<m.length;
s++){
ZaGlobalAdvancedStatsPage.plotQuickChart(m[s],f.name,"df.csv",t,null,o[s],"now")
}}};
ZaServerDiskStatsPage.prototype.setObject=function(e){
this._currentObject=e
};
ZaServerDiskStatsPage.prototype._createHtml=function(){
var e=0;
var o=new Array(50);
DwtTabViewPage.prototype._createHtml.call(this);
var t=this.serverId;
o[e++]="<h1 style='display:none;' id='loggerchart-flashdetect-"+t+"'></h1>";
o[e++]="<div class='StatsDiv'>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsHour)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-disk-stat-48hours-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsDay)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-disk-stat-30days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsMonth)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-disk-stat-60days-"+t+"'></div>";
o[e++]="</div>";
o[e++]="<div class='StatsImageTitle'>"+AjxStringUtil.htmlEncode(ZaMsg.NAD_StatsYear)+"</div>";
o[e++]="<div class='StatsImage'>";
o[e++]="<div id='loggerchartserver-disk-stat-year-"+t+"'></div>";
o[e++]="</div>";
o[e++]="</div>";
this.getHtmlElement().innerHTML=o.join("")
}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaServerMBXStatsPage")){
ZaServerMBXStatsPage=function(e){
DwtTabViewPage.call(this,e);
this.setScrollStyle(Dwt.SCROLL_Y);
this._rendered=false;
this._initialized=false;
this._hide=true;
this._prevSortBy=null;
this._prevAscending=null
};
ZaServerMBXStatsPage.prototype=new DwtTabViewPage;
ZaServerMBXStatsPage.prototype.constructor=ZaServerMBXStatsPage;
ZaServerMBXStatsPage.MBX_DISPLAY_LIMIT=ZaSettings.RESULTSPERPAGE;
ZaServerMBXStatsPage.XFORM_ITEM_ACCOUNT="account";
ZaServerMBXStatsPage.XFORM_ITEM_DISKUSAGE="diskUsage";
ZaServerMBXStatsPage.XFORM_ITEM_QUOTAUSAGE="quotaUsage";
ZaServerMBXStatsPage.XFORM_ITEM_QUOTA="quota";
ZaServerMBXStatsPage.XFORM_ITEM_DISKMBX="diskMbx";
ZaServerMBXStatsPage.XFORM_ITEM_QUOTAMBX="quotaMbx";
ZaServerMBXStatsPage.TAB_KEY=0;
ZaServerMBXStatsPage._offset=0;
ZaServerMBXStatsPage._totalPage=0;
ZaServerMBXStatsPage._currentPage=0;
ZaServerMBXStatsPage.prototype.toString=function(){
return"ZaServerMBXStatsPage"
};
ZaServerMBXStatsPage.prototype.setObject=function(e){
this._server=e;
DBG.println("Set the new Server Name = "+this._server.name);
this._render(e)
};
ZaServerMBXStatsPage.prototype._render=function(n){
if(!this._rendered){
var o={
getMbxPool:function(r,s){
return s.mbxPool
}
,setMbxPool:function(l,s,h,r){
s.mbxPool=l
}
,items:[{
id:"mbxPool",type:_LIST_,setter:"setMbxPool",setterScope:_MODEL_,getter:"getMbxPool",getterScope:_MODEL_}
]};
var t=new XModel(o);
var e=new Array();
this._view=new XForm(this._getXForm(),t,e,this);
this._view.setController(this);
this._view.draw();
this._rendered=true
}else{
this.showMe(true)
}};
ZaServerMBXStatsPage.prototype.getMbxes=function(h,s,f,e,n){
var d={
totalPage:0,curPage:0,hasMore:false,mbxes:new Array()};
var v=AjxSoapDoc.create("GetQuotaUsageRequest",ZaZimbraAdmin.URN,null);
this._prevAscending=e;
this._prevSortBy=f;
if(f==null||f==ZaServerMBXStatsPage.XFORM_ITEM_DISKUSAGE){
f="totalUsed"
}else{
if(f==ZaServerMBXStatsPage.XFORM_ITEM_QUOTAUSAGE){
f="percentUsed"
}else{
if(f==ZaServerMBXStatsPage.XFORM_ITEM_QUOTA){
f="quotaLimit"
}else{
if(f==ZaServerMBXStatsPage.XFORM_ITEM_ACCOUNT){
f="account"
}else{
f="totalUsed"
}}}}
v.getMethod().setAttribute("sortBy",f);
if(e){
v.getMethod().setAttribute("sortAscending",e)
}
v.getMethod().setAttribute("offset",s);
v.getMethod().setAttribute("limit",ZaServerMBXStatsPage.MBX_DISPLAY_LIMIT);
v.getMethod().setAttribute("refresh","1");
var b=new Object();
b.soapDoc=v;
b.targetServer=h;
var w=n?true:false;
if(w){
b.asyncMode=true;
b.callback=n
}
var o={
controller:ZaApp.getInstance().getCurrentController(),busyMsg:ZaMsg.BUSY_GET_QUOTA};
var m=ZaRequestMgr.invoke(b,o);
if(w){
return m
}else{
m=m.Body.GetQuotaUsageResponse
}
if((m.account&&m.account.length>0)&&(m.searchTotal&&m.searchTotal>0)){
d.hasMore=m.more;
var p=m.searchTotal;
d.totalPage=parseInt(Math.ceil(p/ZaServerMBXStatsPage.MBX_DISPLAY_LIMIT));
d.curPage=s/ZaServerMBXStatsPage.MBX_DISPLAY_LIMIT+1;
var l=m.account;
var y=0;
var u=0;
var r=0;
var t=1048576;
var c=new Array();
for(var g=0;
g<l.length;
g++){
r=(l[g].used/t).toFixed(2);
if(l[g].limit==0){
y=ZaMsg.Unlimited;
u=0
}else{
if(l[g].limit>=t){
y=(l[g].limit/t).toFixed()
}else{
y=1
}
u=((r*100)/y).toFixed()
}
c[g]={
account:l[g].name,diskUsage:AjxMessageFormat.format(ZaMsg.MBXStats_DISK_MSB,[AjxUtil.formatSizeForUnits(l[g].used,AjxUtil.SIZE_MEGABYTES,false,1)]),quotaUsage:u+"%",quota:y+" MB"};
c[g].toString=function(){
return this.account
}
}
d.mbxes=c
}
return d
};
ZaServerMBXStatsPage.prototype._getXForm=function(){
if(this._xform!=null){
return this._xform
}
var s=1;
var t=new Array();
var n=1;
t[0]=new ZaListHeaderItem(ZaServerMBXStatsPage.XFORM_ITEM_ACCOUNT,ZaMsg.MBXStats_ACCOUNT,null,250,s++,ZaServerMBXStatsPage.XFORM_ITEM_ACCOUNT,true,true);
t[1]=new ZaListHeaderItem(ZaServerMBXStatsPage.XFORM_ITEM_QUOTA,ZaMsg.MBXStats_QUOTA,null,120,s++,ZaServerMBXStatsPage.XFORM_ITEM_QUOTA,true,true);
n=s;
t[2]=new ZaListHeaderItem(ZaServerMBXStatsPage.XFORM_ITEM_DISKUSAGE,ZaMsg.MBXStats_DISKUSAGE,null,200,s++,ZaServerMBXStatsPage.XFORM_ITEM_DISKUSAGE,true,true);
t[3]=new ZaListHeaderItem(ZaServerMBXStatsPage.XFORM_ITEM_QUOTAUSAGE,ZaMsg.MBXStats_QUOTAUSAGE,null,"auto",s++,ZaServerMBXStatsPage.XFORM_ITEM_QUOTAUSAGE,false,true);
var o="width:100%;overflow:visible;";
var e=AjxEnv.isIE?o+"height:100%;":o;
this._xform={
numCols:1,tableCssStyle:e,items:[{
ref:"mbxPool",type:_DWT_LIST_,id:"mbxPool",width:"100%",cssClass:"MBXList",defaultColumnSortable:n,getCustomWidth:ZaServerMBXStatsPage.getCustomWidth,getCustomHeight:ZaServerMBXStatsPage.getCustomHeight,forceUpdate:true,widgetClass:ZaServerMbxListView,headerList:t}
]};
return this._xform
};
ZaServerMBXStatsPage.getCustomWidth=function(){
var t=this.getForm().parent;
if(t._rendered){
var e=t.getBounds();
return e.width
}
return"100%"
};
ZaServerMBXStatsPage.getCustomHeight=function(){
var t=this.getForm().parent;
if(t._rendered){
var e=t.getBounds();
return e.height
}
return"100%"
};
ZaServerMBXStatsPage.prototype.showMe=function(s){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var n=parseInt(this.parent.getHtmlElement().style.height);
var o=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(n>26){
this._contentEl.style.height=(Number(n-26).toString()+o)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
var t=null;
if(!this._initialized||s){
var r=this._server.attrs;
var h={};
if(r&&(!(r[ZaServer.A_zimbraMailboxServiceInstalled]&&r[ZaServer.A_zimbraMailboxServiceEnabled]))){
h.mbxes=[]
}else{
h=this.getMbxes(this._server.id,0,this._prevSortBy,this._prevAscending)
}
t={
serverid:this._server.id,offset:0,sortBy:this._prevSortBy,sortAscending:this._prevAscending,curPage:h.curPage,totalPage:h.totalPage,mbxPool:h.mbxes};
var e=this._view;
e.setInstance(t);
if(!this._initialized){
var l=this.parent.getBounds();
this.setSize(l.width,l.height)
}
this.mbxPoolWidget=e.getItemById(e.getId()+"_mbxPool").getWidget();
this.mbxPoolWidget.setScrollHasMore(h.hasMore);
this._initialized=true
}else{
t=this._view.getInstance()
}
this.updateToolbar(t.curPage,t.totalPage);
this._hide=false
};
ZaServerMBXStatsPage.prototype.hideMe=function(){
DwtTabViewPage.prototype.hideMe.call(this);
this.updateToolbar(null,null,true);
this._hide=true
};
ZaServerMBXStatsPage.prototype.updateMbxLists=function(n,t,r,h,o){
if(n){
if(t==null){
t=n.serverid
}
if(r==null){
r=n.offset
}
if(h==null){
h=n.sortBy
}
if(o==null){
o=n.sortAscending
}}
var s=this.getMbxes(t,r,h,o);
n={
serverid:t,offset:r,sortBy:h,sortAscending:o,curPage:s.curPage,totalPage:s.totalPage,mbxPool:s.mbxes};
var e=this._view;
e.parent.updateToolbar(n.curPage,n.totalPage);
e.setInstance(n);
this.mbxPoolWidget.setScrollHasMore(s.hasMore)
};
ZaServerMBXStatsPage.prototype.updateToolbar=function(r,s,n){
var e=ZaApp.getInstance().getCurrentController();
try{
if(e instanceof ZaServerStatsController){
var t=e.getToolBar();
if(t){
if(!n){
if(r>1){
t.enable([ZaOperation.PAGE_BACK,ZaOperation.LABEL],true)
}else{
t.enable([ZaOperation.PAGE_BACK],false)
}
if(r<s){
t.enable([ZaOperation.PAGE_FORWARD,ZaOperation.LABEL],true)
}else{
t.enable([ZaOperation.PAGE_FORWARD],false)
}
if(r&&s){
t.getButton("PageInfo").setText(AjxMessageFormat.format(ZaMsg.MBXStats_PAGEINFO,[r,s]))
}
e._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/viewing_mailbox_quotas.htm?locid="+AjxEnv.DEFAULT_LOCALE;
e._helpButtonText=ZaMsg.helpViewMailboxQuotas
}else{
t.enable([ZaOperation.PAGE_FORWARD,ZaOperation.PAGE_BACK,ZaOperation.LABEL],false);
t.getButton("PageInfo").setText(AjxMessageFormat.format(ZaMsg.MBXStats_PAGEINFO,[1,1]));
e._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/checking_usage_statistics.htm?locid="+AjxEnv.DEFAULT_LOCALE;
e._helpButtonText=ZaMsg.helpCheckStatistics
}}}}
catch(o){
e._handleException(o,"ZaServerMBXStatsPage.updateToolbar",null,false)
}};
ZaServerMbxListView=function(n,o,t,e){
var t=DwtControl.ABSOLUTE_STYLE;
ZaListView.call(this,n,o,t,e,undefined,undefined,true);
this.setLocation(0,0)
};
ZaServerMbxListView.prototype=new ZaListView;
ZaServerMbxListView.prototype.constructor=ZaServerMbxListView;
ZaServerMbxListView.prototype.toString=function(){
return"ZaServerMbxListView"
};
ZaServerMbxListView.prototype._createItemHtml=function(r,t,s){
var c=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(r,e,DwtListView.TYPE_LIST_ITEM);
var p=0;
c[p++]="<table width='100%'  cellspacing='0' cellpadding='0'>";
c[p++]="<tr>";
if(this._headerList){
var n=this._headerList.length;
var d=null;
var o=null;
var l=null;
var u=null;
var m=null;
for(var h=0;
h<n;
h++){
var f=this._headerList[h]._field;
if(f==ZaServerMBXStatsPage.XFORM_ITEM_ACCOUNT){
c[p++]="<td width="+this._headerList[h]._width+"><nobr>";
c[p++]=AjxStringUtil.htmlEncode(r[ZaServerMBXStatsPage.XFORM_ITEM_ACCOUNT]);
c[p++]="</nobr></td>"
}else{
if(f==ZaServerMBXStatsPage.XFORM_ITEM_QUOTAUSAGE){
c[p++]="<td width="+this._headerList[h]._width+">";
o="mbxprogressused";
l="mbxprogressbar";
d=new DwtProgressBar(this);
u=r[ZaServerMBXStatsPage.XFORM_ITEM_QUOTAUSAGE];
m=parseInt(u);
if(m>85){
o+="Critical"
}else{
if(m>65){
o+="Warning"
}}
d.setProgressCssClass(o);
d.setWholeCssClass(l);
d.setLabel(u,true);
d.setValueByPercent(u);
c[p++]=d.getHtmlElement().innerHTML;
c[p++]="</td>";
d.dispose()
}else{
if(f==ZaServerMBXStatsPage.XFORM_ITEM_QUOTA){
c[p++]="<td width="+this._headerList[h]._width+">";
c[p++]=AjxStringUtil.htmlEncode(r[ZaServerMBXStatsPage.XFORM_ITEM_QUOTA]);
c[p++]="</td>"
}else{
if(f==ZaServerMBXStatsPage.XFORM_ITEM_DISKUSAGE){
c[p++]="<td width="+this._headerList[h]._width+">";
c[p++]=AjxStringUtil.htmlEncode(r[ZaServerMBXStatsPage.XFORM_ITEM_DISKUSAGE]);
c[p++]="</td>"
}}}}}}else{
c[p++]="<td width=100%><nobr>";
c[p++]=AjxStringUtil.htmlEncode(r[ZaServerMBXStatsPage.XFORM_ITEM_ACCOUNT]);
c[p++]="</nobr></td>"
}
c[p++]="</tr></table>";
e.innerHTML=c.join("");
return e
};
ZaServerMbxListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'>",AjxStringUtil.htmlEncode(ZaMsg.MBXStats_NoMbx),"</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaServerMbxListView.prototype._sortColumn=function(n,r){
var o=r?1:0;
var h=n._sortField;
var e=this.parent;
var s=e.getInstance();
var t=e.parent;
t.updateMbxLists(s,null,0,h,o)
};
ZaServerMbxListView.prototype._loadMsg=function(h){
var r=h.offset;
var e=this.parent.getInstance();
var s=e.serverid;
var l=e.sortBy;
var o=e.sortAscending;
var t=h.limit;
var n=new AjxCallback(this,this.updateMoreItems);
ZaServerMBXStatsPage.prototype.getMbxes.call(this.parent.parent,s,r,l,o,n)
};
ZaServerMbxListView.prototype.updateMoreItems=function(s){
if(s&&!s.isException()){
s=s.getResponse().Body.GetQuotaUsageResponse;
var l=AjxNumberFormat.getInstance();
if((s.account&&s.account.length>0)&&(s.searchTotal&&s.searchTotal>0)){
var o=s.more;
var n=s.searchTotal;
var e=s.account;
var d=0;
var u=0;
var h=0;
var t=1048576;
var c=new Array();
for(var r=0;
r<e.length;
r++){
h=(e[r].used/t).toFixed(2);
if(e[r].limit==0){
d=ZaMsg.Unlimited;
u=0
}else{
if(e[r].limit>=t){
d=(e[r].limit/t).toFixed()
}else{
d=1
}
u=((h*100)/d).toFixed()
}
c[r]={
account:e[r].name,diskUsage:AjxMessageFormat.format(ZaMsg.MBXStats_DISK_MSB,[AjxUtil.formatSizeForUnits(e[r].used,AjxUtil.SIZE_MEGABYTES,false,1)]),quotaUsage:u+"%",quota:d+" MB"};
c[r].toString=function(){
return this.account
}
}
this.replenish(AjxVector.fromArray(c));
this.setScrollHasMore(o)
}}}
}
if(AjxPackage.define("zimbraAdmin.statistics.view.ZaServerSessionStatsPage")){
ZaServerSessionStatsPage=function(e){
DwtTabViewPage.call(this,e);
this._adminSessResp={};
this._imapSessResp={};
this._soapSessResp={};
this._offset={
soap:0,admin:0,imap:0};
this._sortBy={
soap:"nameAsc",admin:"nameAsc",imap:"nameAsc"};
this._pageObj={};
this._pageObj.soap={
curPage:1,totalPage:1};
this._pageObj.admin={
curPage:1,totalPage:1};
this._pageObj.imap={
curPage:1,totalPage:1};
this._rendered=false
};
ZaServerSessionStatsPage.PAGE_LIMIT=25;
ZaServerSessionStatsPage.prototype=new DwtTabViewPage;
ZaServerSessionStatsPage.prototype.constructor=ZaServerSessionStatsPage;
ZaServerSessionStatsPage.prototype.setObject=function(e){
this._server=e
};
ZaServerSessionStatsPage.prototype.setSortBy=function(o){
var e=this._localXForm.getInstance();
var t=e[ZaModel.currentTab];
if(t==ZaServerSessionStatsPage.SOAP_TAB_ID){
this._sortBy.soap=o
}else{
if(t==ZaServerSessionStatsPage.ADMIN_TAB_ID){
this._sortBy.admin=o
}else{
if(t==ZaServerSessionStatsPage.IMAP_TAB_ID){
this._sortBy.imap=o
}}}};
ZaServerSessionStatsPage.prototype.setOffset=function(o){
var e=this._localXForm.getInstance();
var t=e[ZaModel.currentTab];
if(t==ZaServerSessionStatsPage.SOAP_TAB_ID){
this._offset.soap=o
}else{
if(t==ZaServerSessionStatsPage.ADMIN_TAB_ID){
this._offset.admin=o
}else{
if(t==ZaServerSessionStatsPage.IMAP_TAB_ID){
this._offset.imap=o
}}}};
ZaServerSessionStatsPage.prototype._createHtml=function(){
DwtTabViewPage.prototype._createHtml.call(this)
};
ZaServerSessionStatsPage.prototype.showMe=function(s){
if(!this._rendered){
this.setZIndex(DwtTabView.Z_ACTIVE_TAB);
if(this.parent.getHtmlElement().offsetHeight>26){
this._contentEl.style.height=this.parent.getHtmlElement().offsetHeight-26
}else{
var o=parseInt(this.parent.getHtmlElement().style.height);
var t=AjxStringUtil.getUnitsFromSizeString(this.parent.getHtmlElement().style.height);
if(o>26){
this._contentEl.style.height=(Number(o-26).toString()+t)
}}
this._contentEl.style.width=this.parent.getHtmlElement().style.width;
var e={
currentTab:ZaServerSessionStatsPage.SOAP_TAB_ID};
var n=new XModel({
id:"currentTab",type:_UNTYPED_}
);
this._localXForm=this._view=new XForm(this._getXForm(),n,e,this);
this._view.setController(this);
this._view.draw()
}
var r={};
if(s&&s>1){
r.refresh="1"
}
if(!this._rendered||s>0){
this.getSessions({
type:"soap"}
);
this.getSessions({
type:"admin"}
);
this.getSessions({
type:"imap"}
)
}
this._rendered=true
};
ZaServerSessionStatsPage.prototype.hideMe=function(){
DwtTabViewPage.prototype.hideMe.call(this);
this.updateToolbar(null,true);
this._hide=true
};
ZaServerSessionStatsPage.prototype._pageListener=function(e){
var o=this.getType();
var s={};
var n=this._pageObj[o]["curPage"];
var t=this._pageObj[o]["totalPage"];
if(e){
s.offset=(n-2)*ZaServerSessionStatsPage.PAGE_LIMIT
}else{
s.offset=n*ZaServerSessionStatsPage.PAGE_LIMIT
}
s.type=o;
this.getSessions(s)
};
ZaServerSessionStatsPage.prototype.getType=function(t){
if(!t){
var e=this._localXForm.getInstance();
t=e[ZaModel.currentTab]
}
var o;
if(t==ZaServerSessionStatsPage.SOAP_TAB_ID){
o="soap"
}else{
if(t==ZaServerSessionStatsPage.ADMIN_TAB_ID){
o="admin"
}else{
if(t==ZaServerSessionStatsPage.IMAP_TAB_ID){
o="imap"
}}}
return o
};
ZaServerSessionStatsPage.prototype.updateToolbar=function(e,s){
var n=ZaApp.getInstance().getCurrentController();
try{
if(n instanceof ZaServerStatsController){
if(!this._localXForm){
return
}
var d=this._localXForm.getInstance();
var t=d[ZaModel.currentTab];
var l=this.getType(t);
var c=n.getToolBar();
var h=this._pageObj[l]["curPage"];
var o=this._pageObj[l]["totalPage"];
if(c){
if((!s)&&e&&(e==t)){
if(h>1){
c.enable([ZaOperation.PAGE_BACK,ZaOperation.LABEL],true)
}else{
c.enable([ZaOperation.PAGE_BACK],false)
}
if(h<o){
c.enable([ZaOperation.PAGE_FORWARD,ZaOperation.LABEL],true)
}else{
c.enable([ZaOperation.PAGE_FORWARD],false)
}
if(h&&o){
c.getButton("PageInfo").setText(AjxMessageFormat.format(ZaMsg.MBXStats_PAGEINFO,[h,o]))
}
n._helpURL=location.pathname+ZaUtil.HELP_URL+"managing_servers/viewing_mailbox_quotas.htm?locid="+AjxEnv.DEFAULT_LOCALE;
n._helpButtonText=ZaMsg.helpViewMailboxQuotas
}else{
if(s){
c.enable([ZaOperation.PAGE_FORWARD,ZaOperation.PAGE_BACK,ZaOperation.LABEL],false);
c.getButton("PageInfo").setText(AjxMessageFormat.format(ZaMsg.MBXStats_PAGEINFO,[1,1]));
n._helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/checking_usage_statistics.htm?locid="+AjxEnv.DEFAULT_LOCALE;
n._helpButtonText=ZaMsg.helpCheckStatistics
}}}}}
catch(r){
n._handleException(r,"ZaServerSessionStatsPage.updateToolbar",null,false)
}};
ZaServerSessionStatsPage.prototype.dumpSession=function(){
var o=AjxSoapDoc.create("DumpSessionsRequest",ZaZimbraAdmin.URN,null);
var e="1";
var n="1";
o.getMethod().setAttribute("listSessions",e);
o.getMethod().setAttribute("groupByAccount",n);
var t=new ZmCsfeCommand();
var s={};
s.soapDoc=o;
s.noAuthToken=true;
s.targetServer=this._server.id;
s.asyncMode=true;
s.callback=new AjxCallback(this,this.dumpSessionCallback);
t.invoke(s)
};
ZaServerSessionStatsPage.prototype.getSessions=function(s){
var n=AjxSoapDoc.create("GetSessionsRequest",ZaZimbraAdmin.URN,null);
if(!s){
s={}
}
var e=this._localXForm.getInstance();
var t=e[ZaModel.currentTab];
if(!s.type){
s.type=this.getType(t)
}
n.getMethod().setAttribute("type",s.type);
if(s.refresh){
n.getMethod().setAttribute("refresh",s.fresh)
}
n.getMethod().setAttribute("limit",ZaServerSessionStatsPage.PAGE_LIMIT);
if(!s.offset){
s.offset=this._offset[s.type]
}
n.getMethod().setAttribute("offset",s.offset);
if(!s.sortBy){
s.sortBy=this._sortBy[s.type]
}
n.getMethod().setAttribute("sortBy",s.sortBy);
var o=new ZmCsfeCommand();
s.soapDoc=n;
s.noAuthToken=true;
s.targetServer=this._server.id;
s.asyncMode=true;
s.callback=new AjxCallback(this,this.getSessionsCallback,[s]);
o.invoke(s)
};
ZaServerSessionStatsPage.prototype.getSessionsCallback=function(s,l){
if(l._data.Body){
var o=l._data.Body.GetSessionsResponse;
var t=this._localXForm.getInstance();
t[s.type+"_total"]=o.total;
var h=new AjxVector();
if(o.total>0&&o.s){
this._processGetSessResp(o.s,h)
}
t[s.type]=h.getArray();
t[s.type].join=ZaServerSessionStatsPage._objArrJoin;
var e=this._localXForm.getItemsById("xform_tabbar")[0];
var r=e.getWidget();
if(s.type=="soap"){
r.getItem(ZaServerSessionStatsPage.SOAP_TAB_ID-1).setText(ZaMsg.TABT_SessStatsSoap+" ("+t[s.type+"_total"]+") ")
}else{
if(s.type=="admin"){
r.getItem(ZaServerSessionStatsPage.ADMIN_TAB_ID-1).setText(ZaMsg.TABT_SessStatsAdmin+" ("+t[s.type+"_total"]+") ")
}else{
if(s.type=="imap"){
r.getItem(ZaServerSessionStatsPage.IMAP_TAB_ID-1).setText(ZaMsg.TABT_SessStatsImap+" ("+t[s.type+"_total"]+") ")
}}}
this._localXForm.setInstance(t)
}
this._updatePageObj(s,t[s.type+"_total"]);
var n=t[ZaModel.currentTab];
if((s.type=="soap"&&n==ZaServerSessionStatsPage.SOAP_TAB_ID)||(s.type=="admin"&&n==ZaServerSessionStatsPage.ADMIN_TAB_ID)||(s.type=="imap"&&n==ZaServerSessionStatsPage.IMAP_TAB_ID)){
this.updateToolbar(n,false)
}};
ZaServerSessionStatsPage.prototype._updatePageObj=function(o,t){
var e=o.type;
var n=o.offset;
this._pageObj[e]["curPage"]=n/ZaServerSessionStatsPage.PAGE_LIMIT+1;
this._pageObj[e]["totalPage"]=Math.ceil(t/ZaServerSessionStatsPage.PAGE_LIMIT)||1
};
ZaServerSessionStatsPage._objArrJoin=function(){
var e=[];
for(var t=0;
t<this.length;
t++){
e.push(this[t].sid)
}
return e.join()
};
ZaServerSessionStatsPage.prototype._processGetSessResp=function(e,o){
for(var t=0;
t<e.length;
t++){
var n=e[t];
o.add(new ZaServerSession(n.name,n.zid,n.sid,n.cd,n.ld))
}};
ZaServerSessionStatsPage.prototype.dumpSessionCallback=function(o){
var t=o._data.Body.DumpSessionsResponse;
this._activeSessions=t.activeSessions;
this._activeAdminSessions=this._activeAdminAccounts=0;
this._activeSoapSessions=this._activeSoapAccounts=0;
this._activeImapSessions=this._activeImapAccounts=0;
this._adminSessList=new AjxVector();
this._imapSessList=new AjxVector();
this._soapSessList=new AjxVector();
if(t.admin){
this._adminSessResp=t.admin[0];
this._processResponse(this._adminSessResp,this._adminSessList);
this._activeAdminSessions=this._adminSessResp.activeSessions;
this._activeAdminAccounts=this._adminSessResp.activeAccounts
}
if(t.imap){
this._imapSessResp=t.imap[0];
this._processResponse(this._imapSessResp,this._imapSessList);
this._activeImapSessions=this._imapSessResp.activeSessions;
this._activeImapAccounts=this._imapSessResp.activeAccounts
}
if(t.soap){
this._soapSessResp=t.soap[0];
this._processResponse(this._soapSessResp,this._soapSessList);
this._activeSoapSessions=this._soapSessResp.activeSessions;
this._activeSoapAccounts=this._soapSessResp.activeAccounts
}
if(this._localXForm){
var e=this._localXForm.getInstance();
e[ZaServerSession.A_activeSessions]=this._activeSessions;
e[ZaServerSession.A_activeAdminAccounts]=this._activeAdminAccounts;
e[ZaServerSession.A_activeAdminSessions]=this._activeAdminSessions;
e[ZaServerSession.A_activeSoapSessions]=this._activeSoapSessions;
e[ZaServerSession.A_activeSoapAccounts]=this._activeSoapAccounts;
e[ZaServerSession.A_activeImapAccounts]=this._activeImapAccounts;
e[ZaServerSession.A_activeImapSessions]=this._activeImapSessions;
e.admin=this._adminSessList.getArray();
e.soap=this._soapSessList.getArray();
e.imap=this._imapSessList.getArray();
this._localXForm.setInstance(e)
}};
ZaServerSessionStatsPage.prototype._processResponse=function(t,s){
for(var n=0;
n<t.zid.length;
n++){
var e=t.zid[n];
var r=e.s;
for(var o=0;
o<r.length;
o++){
s.add(new ZaServerSession(e.name,e.id,r[o].sid,r[o].cd,r[o].ld))
}}};
ZaServerSessionStatsPage.prototype.getStatCountsOutput=function(n){
var o=new AjxBuffer();
var e=this._localXForm.getInstance();
if(n==ZaServerSession.A_activeSessions){
var t=e.soap_total+e.admin_total+e.imap_total;
o.append(ZaMsg.SessStats_ActiveSessions," ",t)
}
return o.join("")
};
ZaServerSessionStatsPage.SOAP_TAB_ID=1;
ZaServerSessionStatsPage.ADMIN_TAB_ID=2;
ZaServerSessionStatsPage.IMAP_TAB_ID=3;
ZaServerSessionStatsPage.prototype._getXForm=function(){
if(this._xform!=null){
return this._xform
}
var o=ZaServerSessionListView._getHeaderList();
var t=ZaServerSessionListView._getHeaderList();
var e=ZaServerSessionListView._getHeaderList();
this._xform={
x_showBorder:1,numCols:1,cssClass:"ZaServerSessionStatsPage",tableCssStyle:"width:100%",itemDefaults:{}
,items:[{
type:_SPACER_,height:"10px",colSpan:"2",id:"xform_header"}
,{
ref:ZaServerSession.A_activeSessions,type:_OUTPUT_,height:"15px",colSpan:"*",getDisplayValue:"return this.getFormController().getStatCountsOutput(ZaServerSession.A_activeSessions)"}
,{
type:_SPACER_,height:"10px",colSpan:"2",id:"xform_header"}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,colSpan:"2",onChange:ZaServerSessionStatsPage.tabChanged,choices:[{
value:ZaServerSessionStatsPage.SOAP_TAB_ID,label:ZaMsg.TABT_SessStatsSoap}
,{
value:ZaServerSessionStatsPage.ADMIN_TAB_ID,label:ZaMsg.TABT_SessStatsAdmin}
,{
value:ZaServerSessionStatsPage.IMAP_TAB_ID,label:ZaMsg.TABT_SessStatsImap}
],cssClass:"ZaTabBar",id:"xform_tabbar"}
,{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:[{
type:_ZATABCASE_,caseKey:1,align:_LEFT_,valign:_TOP_,cssStyle:"position: absolute; overflow: auto;",paddingStyle:"",getCustomWidth:ZaServerSessionListView.getCustomWidth,getCustomHeight:ZaServerSessionListView.getCustomHeight,items:[{
ref:"soap",type:_DWT_LIST_,width:"100%",cssClass:"MBXList",height:(AjxEnv.isIE?"":"100%"),forceUpdate:true,widgetClass:ZaServerSessionListView,headerList:o,defaultColumnSortable:1}
]}
,{
type:_ZATABCASE_,caseKey:2,align:_LEFT_,valign:_TOP_,cssStyle:"position: absolute; overflow: auto;",paddingStyle:"",getCustomWidth:ZaServerSessionListView.getCustomWidth,getCustomHeight:ZaServerSessionListView.getCustomHeight,items:[{
ref:"admin",type:_DWT_LIST_,width:"100%",cssClass:"MBXList",height:(AjxEnv.isIE?"":"100%"),forceUpdate:true,widgetClass:ZaServerSessionListView,headerList:t,defaultColumnSortable:1}
]}
,{
type:_ZATABCASE_,caseKey:3,align:_LEFT_,valign:_TOP_,cssStyle:"position: absolute; overflow: auto;",paddingStyle:"",getCustomWidth:ZaServerSessionListView.getCustomWidth,getCustomHeight:ZaServerSessionListView.getCustomHeight,items:[{
ref:"imap",type:_DWT_LIST_,width:"100%",cssClass:"MBXList",height:(AjxEnv.isIE?"":"100%"),forceUpdate:true,widgetClass:ZaServerSessionListView,headerList:e,defaultColumnSortable:1}
]}
]}
]};
return this._xform
};
ZaServerSessionStatsPage.tabChanged=function(o,t,e){
this.setInstanceValue(o);
e.parent.updateToolbar(o,false)
};
ZaServerSession=function(t,n,e,s,o){
this.name=t;
this.zid=n;
this.sid=e;
this.cd=s;
this.ld=o
};
ZaServerSession.A_activeSessions="activeSessions";
ZaServerSession.A_activeSoapSessions="activeSoapSessions";
ZaServerSession.A_activeImapSessions="activeImapSessions";
ZaServerSession.A_activeAdminSessions="activeAdminSessions";
ZaServerSession.A_activeAccounts="activeAccounts";
ZaServerSession.A_activeAdminAccounts="activeAdminAccounts";
ZaServerSession.A_activeImapAccounts="activeImapAccounts";
ZaServerSession.A_activeSoapAccounts="activeSoapAccounts";
ZaServerSession.getDate=function(t){
var e=new Date();
e.setTime(t);
return AjxDateFormat.format("MM/dd/yyyy HH:mm:ss",e)
};
ZaServerSessionListView=function(s,e,n,t){
this._app=s.parent._app;
var o=null;
var n=DwtControl.ABSOLUTE_STYLE;
ZaListView.call(this,s,o,n,t);
this.setLocation(0,0);
this._bSortAsc=true
};
ZaServerSessionListView.prototype=new ZaListView;
ZaServerSessionListView.prototype.constructor=ZaServerSessionListView;
ZaServerSessionListView._getHeaderList=function(){
var t=new Array();
var e=0;
var o=1;
t[e++]=new ZaListHeaderItem("name",ZaMsg.h_account_name,null,"150px",o++,"name",true,true);
t[e++]=new ZaListHeaderItem("sid",ZaMsg.h_session_id,null,"150px",null,"sid",true,true);
t[e++]=new ZaListHeaderItem("cd",ZaMsg.h_sess_cd,null,"150px",o++,"created",true,true);
t[e++]=new ZaListHeaderItem("ld",ZaMsg.h_sess_ld,null,"auto",o++,"accessed",true,true);
return t
};
ZaServerSessionListView.prototype._createItemHtml=function(t){
var s=new Array(50);
var h=document.createElement("div");
h[DwtListView._STYLE_CLASS]="Row";
h[DwtListView._SELECTED_STYLE_CLASS]=h[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
h.className=h[DwtListView._STYLE_CLASS];
this.associateItemWithElement(t,h,DwtListView.TYPE_LIST_ITEM);
h.style.height="20";
var e=0;
s[e++]="<table width='100%' height='20' cellspacing='2' cellpadding='0'>";
s[e++]="<tr>";
if(this._headerList){
var n=this._headerList.length;
for(var o=0;
o<n;
o++){
var r=this._headerList[o]._field;
if(r=="name"){
s[e++]="<td width="+this._headerList[o]._width+"><nobr>";
s[e++]=AjxStringUtil.htmlEncode(t.name);
s[e++]="</nobr></td>"
}else{
if(r=="sid"){
s[e++]="<td width="+this._headerList[o]._width+">";
s[e++]=AjxStringUtil.htmlEncode(t.sid);
s[e++]="</td>"
}else{
if(r=="cd"){
s[e++]="<td width="+this._headerList[o]._width+">";
s[e++]=AjxStringUtil.htmlEncode(ZaServerSession.getDate(t.cd.toString()));
s[e++]="</td>"
}else{
if(r=="ld"){
s[e++]="<td width="+this._headerList[o]._width+">";
s[e++]=AjxStringUtil.htmlEncode(ZaServerSession.getDate(t.ld.toString()));
s[e++]="</td>"
}}}}}}else{
s[e++]="<td width=100%><nobr>";
s[e++]=AjxStringUtil.htmlEncode(t.zid);
s[e++]="</nobr></td>"
}
s[e++]="</tr></table>";
h.innerHTML=s.join("");
return h
};
ZaServerSessionListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'>",AjxStringUtil.htmlEncode(ZaMsg.sess_noSess),"</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaServerSessionListView.prototype._sortColumn=function(n,s){
var r=n._sortField+(s?"Asc":"Desc");
try{
var t=ZaApp.getInstance().getCurrentController();
var e=t._contentView._sessionPage;
e.setSortBy(r);
e.showMe(1)
}
catch(o){
ZaApp.getInstance().getCurrentController()._handleException(o)
}};
ZaServerSessionListView.getCustomWidth=function(){
return ZATabCase_XFormItem.prototype.getCustomWidth.call(this)
};
ZaServerSessionListView.getCustomHeight=function(){
var e=ZATabCase_XFormItem.prototype.getCustomHeight.call(this);
return e-23
}
}
if(AjxPackage.define("zimbraAdmin.rp.view.ZaRetentionPolicyListView")){
ZaRetentionPolicyListView=function(n,o,t,e){
ZaListView.call(this,n,o,t,e)
};
ZaRetentionPolicyListView.prototype=new ZaListView;
ZaRetentionPolicyListView.prototype.constructor=ZaRetentionPolicyListView;
ZaRetentionPolicyListView.prototype.toString=function(){
return"ZaRetentionPolicyListView"
};
ZaRetentionPolicyListView.prototype._createItemHtml=function(d){
var r=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(d,e,DwtListView.TYPE_LIST_ITEM);
var c=0;
r[c++]="<table width='100%' cellspacing='0' cellpadding='0'>";
r[c++]="<tr>";
if(this._headerList){
var t=this._headerList.length;
for(var s=0;
s<t;
s++){
var h=this._headerList[s]._field;
if(h==ZaRetentionPolicy.A2_name){
r[c++]="<td align=left height=20px width="+this._headerList[s]._width+">";
r[c++]=AjxStringUtil.htmlEncode(d[ZaRetentionPolicy.A2_name]);
r[c++]="</td>"
}else{
if(h==ZaRetentionPolicy.A2_lifetime){
r[c++]="<td align=left height=20px width="+this._headerList[s]._width+">";
var o=d[ZaRetentionPolicy.A2_lifetime];
var n=o.substr(0,o.length-1);
var l=o.substr(o.length-1,1);
r[c++]=AjxMessageFormat.format(ZaMsg["TTL_Retention_Policy_"+l],n);
r[c++]="</td>"
}}}}else{
r[c++]="<td width=100%>";
r[c++]=AjxStringUtil.htmlEncode(d);
r[c++]="</td>"
}
r[c++]="</tr></table>";
e.innerHTML=r.join("");
return e
};
ZaRetentionPolicyListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br>&nbsp","</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
}
}
if(AjxPackage.define("zimbraAdmin.rp.view.ZaRetentionPolicyDlg")){
ZaRetentionPolicyDlg=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.CANCEL_BUTTON,DwtDialog.OK_BUTTON];
ZaXDialog.call(this,o,null,n,e,t,"ZaRetentionPolicyDlg");
this.initForm(ZaRetentionPolicy.myXModel,this.getMyXForm());
this.setTitle(n)
};
ZaRetentionPolicyDlg.prototype=new ZaXDialog;
ZaRetentionPolicyDlg.prototype.constructor=ZaRetentionPolicyDlg;
ZaRetentionPolicyDlg.prototype.isVisible=function(t){
var e=this.getForm().getInstanceValue(ZaRetentionPolicy.A2_type);
return e==t
};
ZaRetentionPolicyDlg.prototype.getMyXForm=function(){
var e={
numCols:2,items:[{
type:_GROUP_,isTabGroup:true,numCols:2,colSizes:["150px","auto"],items:[{
ref:ZaRetentionPolicy.A2_name,type:_INPUT_,msgName:ZaMsg.LBL_Policy_Name,label:ZaMsg.LBL_Policy_Name,labelLocation:_LEFT_,cssClass:"admin_xform_number_input",width:"300px"}
,{
ref:ZaRetentionPolicy.A2_lifetime,type:_LONG_LIFETIME_,msgName:ZaMsg.LBL_Policy_Retention,label:ZaMsg.LBL_Policy_Retention,labelLocation:_LEFT_,visibilityChecks:[[ZaRetentionPolicyDlg.prototype.isVisible,ZaRetentionPolicy.TYPE_KEEP]]}
,{
ref:ZaRetentionPolicy.A2_lifetime,type:_LONG_LIFETIME_,msgName:ZaMsg.LBL_Policy_Purge,label:ZaMsg.LBL_Policy_Purge,labelLocation:_LEFT_,visibilityChecks:[[ZaRetentionPolicyDlg.prototype.isVisible,ZaRetentionPolicy.TYPE_PURGE]]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.globalconfig.view.GlobalConfigXFormView")){
GlobalConfigXFormView=function(e,t){
ZaTabView.call(this,{
parent:e,iKeyName:"GlobalConfigXFormView",contextId:ZaId.TAB_GSET_EDIT}
);
this.TAB_INDEX=0;
this.initForm(ZaGlobalConfig.myXModel,this.getMyXForm(t),null)
};
GlobalConfigXFormView.prototype=new ZaTabView();
GlobalConfigXFormView.prototype.constructor=GlobalConfigXFormView;
ZaTabView.XFormModifiers.GlobalConfigXFormView=new Array();
ZaTabView.XFormSetObjectMethods.GlobalConfigXFormView=new Array();
GlobalConfigXFormView.prototype.getTitle=function(){
return ZaMsg.GlobalConfig_view_title
};
GlobalConfigXFormView.onRepeatRemove=function(e,t){
var o=this.getInstanceValue();
if(o==null||typeof(o)=="string"||e>=o.length||e<0){
return
}
o.splice(e,1);
t.parent.setDirty(true)
};
GlobalConfigXFormView.prototype.getTabIcon=function(){
return"GlobalSettings"
};
GlobalConfigXFormView.prototype.getTabTitle=function(){
return this.getTitle()
};
GlobalConfigXFormView.prototype.getTabToolTip=function(){
return this.getTitle()
};
GlobalConfigXFormView.blockedExtSelectionListener=function(){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaGlobalConfig.A2_blocked_extension_selection,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaGlobalConfig.A2_blocked_extension_selection,null)
}};
GlobalConfigXFormView.commonExtSelectionListener=function(){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaGlobalConfig.A2_common_extension_selection,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaGlobalConfig.A2_common_extension_selection,null)
}};
GlobalConfigXFormView.shouldEnableRemoveAllButton=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaGlobalConfig.A_zimbraMtaBlockedExtension)))
};
GlobalConfigXFormView.shouldEnableRemoveButton=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaGlobalConfig.A2_blocked_extension_selection)))
};
GlobalConfigXFormView.shouldEnableAddButton=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaGlobalConfig.A2_common_extension_selection)))
};
GlobalConfigXFormView.shouldEnableAddAllButton=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension)))
};
GlobalConfigXFormView.removeExt=function(){
var e=this.getInstanceValue(ZaGlobalConfig.A_zimbraMtaBlockedExtension);
var t=this.getInstanceValue(ZaGlobalConfig.A2_blocked_extension_selection);
var o=AjxUtil.arraySubtract(e,t);
this.setInstanceValue(o,ZaGlobalConfig.A_zimbraMtaBlockedExtension);
this.getForm().parent.setDirty(true)
};
GlobalConfigXFormView.removeAllExt=function(){
this.setInstanceValue([],ZaGlobalConfig.A_zimbraMtaBlockedExtension);
this.setInstanceValue([],ZaGlobalConfig.A2_blocked_extension_selection);
this.getForm().parent.setDirty(true)
};
GlobalConfigXFormView.addCommonExt=function(){
var t=this.getInstanceValue(ZaGlobalConfig.A_zimbraMtaBlockedExtension);
var e=this.getInstanceValue(ZaGlobalConfig.A2_common_extension_selection);
t=AjxUtil.isEmpty(t)?[]:t;
e=AjxUtil.isEmpty(e)?[]:e;
this.setInstanceValue(AjxUtil.mergeArrays(t,e),ZaGlobalConfig.A_zimbraMtaBlockedExtension);
this.getForm().parent.setDirty(true)
};
GlobalConfigXFormView.addAllCommonExt=function(){
var t=this.getInstanceValue(ZaGlobalConfig.A_zimbraMtaBlockedExtension);
var e=this.getInstanceValue(ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension);
t=AjxUtil.isEmpty(t)?[]:t;
e=AjxUtil.isEmpty(e)?[]:e;
this.setInstanceValue(AjxUtil.mergeArrays(t,e),ZaGlobalConfig.A_zimbraMtaBlockedExtension);
this.getForm().parent.setDirty(true)
};
GlobalConfigXFormView.addNewExt=function(){
var e=this.getInstanceValue(ZaGlobalConfig.A_zimbraNewExtension);
if(AjxUtil.isEmpty(e)){
return
}
var o=this.getInstanceValue(ZaGlobalConfig.A_zimbraMtaBlockedExtension);
o=AjxUtil.isEmpty(o)?[]:o;
var t=e.split(/[\s,;]+/);
if(AjxUtil.isEmpty(t)){
return
}
this.setInstanceValue(AjxUtil.mergeArrays(o,t),ZaGlobalConfig.A_zimbraMtaBlockedExtension);
this.setInstanceValue(null,ZaGlobalConfig.A_zimbraNewExtension);
this.getForm().parent.setDirty(true)
};
GlobalConfigXFormView.retentionSelectionListener=function(e){
this.getForm().setInstanceValue(this.getSelection(),ZaGlobalConfig.A2_retentionPoliciesKeep_Selection)
};
GlobalConfigXFormView.purgeSelectionListener=function(){
this.getForm().setInstanceValue(this.getSelection(),ZaGlobalConfig.A2_retentionPoliciesPurge_Selection)
};
GlobalConfigXFormView.deleteButtonListener=function(e){
var t=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep_Selection);
if(e){
t=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge_Selection)
}
if(!t){
return
}
if(!ZaApp.getInstance().dialogs.deleteGlobalRetionPolicyConfirmMessageDialog){
ZaApp.getInstance().dialogs.deleteGlobalRetionPolicyConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.CTR_PREFIX+"DELETE_RETENTION_POLICY_ConfirmMessage")
}
ZaApp.getInstance().dialogs.deleteGlobalRetionPolicyConfirmMessageDialog.setMessage(ZaMsg.Q_Delete_RetentionPolicy_Confirm,DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.deleteGlobalRetionPolicyConfirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,GlobalConfigXFormView.deleteRetentionPolicies,this,[e]);
ZaApp.getInstance().dialogs.deleteGlobalRetionPolicyConfirmMessageDialog.popup()
};
GlobalConfigXFormView.deleteRetentionPolicies=function(t){
if(ZaApp.getInstance().dialogs.deleteGlobalRetionPolicyConfirmMessageDialog){
ZaApp.getInstance().dialogs.deleteGlobalRetionPolicyConfirmMessageDialog.popdown()
}
var n=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep_Selection);
var o=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep);
if(t){
n=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge_Selection);
o=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge)
}
if(!n){
return
}
for(var e=0;
e<n.length;
e++){
n[e].deletePolicy();
AjxUtil.arrayRemove(o,n[e])
}
if(t){
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue(o,ZaGlobalConfig.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesPurge_Selection)
}else{
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(o,ZaGlobalConfig.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesKeep_Selection)
}};
GlobalConfigXFormView.addButtonListener=function(e){
var t;
if(e){
t=new ZaRetentionPolicy(null,null,null,ZaRetentionPolicy.TYPE_PURGE)
}else{
t=new ZaRetentionPolicy()
}
if(!ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog){
ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog=new ZaRetentionPolicyDlg(ZaApp.getInstance().getAppCtxt().getShell(),"500px","100px",ZaMsg.TTL_Policy_Add);
ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog.registerCallback(DwtDialog.OK_BUTTON,GlobalConfigXFormView.createRetentionPolicy,this,ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog._localXForm)
}
ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog.setObject(t);
ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog.popup()
};
GlobalConfigXFormView.createRetentionPolicy=function(t){
if(ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog){
var o=t.getInstance();
var e;
if(o[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
e=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep)
}else{
e=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge)
}
if(!e){
e=[]
}
if(!ZaRetentionPolicy.checkValues(o,e)){
return false
}
ZaApp.getInstance().dialogs.newGlobalRetentionPolicyDialog.popdown();
o.createPolicy();
e.push(o);
if(o[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(e,ZaGlobalConfig.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesKeep_Selection)
}else{
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue(e,ZaGlobalConfig.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesPurge_Selection)
}}};
GlobalConfigXFormView.editButtonListener=function(e){
var t;
if(e){
t=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge_Selection)[0]
}else{
t=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep_Selection)[0]
}
if(!ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog){
ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog=new ZaRetentionPolicyDlg(ZaApp.getInstance().getAppCtxt().getShell(),"500px","100px",ZaMsg.TTL_Policy_Edit);
ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog.registerCallback(DwtDialog.OK_BUTTON,GlobalConfigXFormView.updateRetentionPolicy,this,ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog._localXForm)
}
ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog.setObject(t);
ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog.popup()
};
GlobalConfigXFormView.updateRetentionPolicy=function(o){
if(ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog){
var n=o.getInstance();
var t;
if(n[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
t=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep)
}else{
t=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge)
}
if(!t){
t=[]
}
if(!ZaRetentionPolicy.checkValues(n,t)){
return false
}
ZaApp.getInstance().dialogs.editGlobalRetentionPolicyDialog.popdown();
n.modifyPolicy();
var e=AjxUtil.indexOf(t,n);
AjxUtil.arrayRemove(t,n);
AjxUtil.arrayAdd(t,n,e);
if(n[ZaRetentionPolicy.A2_type]==ZaRetentionPolicy.TYPE_KEEP){
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(t,ZaGlobalConfig.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesKeep_Selection)
}else{
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue(t,ZaGlobalConfig.A2_retentionPoliciesPurge);
this.getForm().setInstanceValue([],ZaGlobalConfig.A2_retentionPoliciesPurge_Selection)
}}};
GlobalConfigXFormView.GENERAL_TAB_ATTRS=[ZaGlobalConfig.A_zimbraMailPurgeSleepInterval,ZaGlobalConfig.A_zimbraFileUploadMaxSize,ZaGlobalConfig.A_zimbraGalMaxResults,ZaGlobalConfig.A_zimbraDefaultDomainName,ZaGlobalConfig.A_zimbraScheduledTaskNumThreads];
GlobalConfigXFormView.GENERAL_TAB_RIGHTS=[];
GlobalConfigXFormView.ATTACHMENTS_TAB_ATTRS=[ZaGlobalConfig.A_zimbraMtaBlockedExtensionWarnRecipient,ZaGlobalConfig.A_zimbraMtaBlockedExtension,ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension];
GlobalConfigXFormView.ATTACHMENTS_TAB_RIGHTS=[];
GlobalConfigXFormView.MTA_TAB_ATTRS=[ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,ZaGlobalConfig.A_zimbraMtaTlsAuthOnly,ZaGlobalConfig.A_zimbraSmtpHostname,ZaGlobalConfig.A_zimbraSmtpPort,ZaGlobalConfig.A_zimbraMtaRelayHost,ZaGlobalConfig.A_zimbraMtaFallbackRelayHost,ZaGlobalConfig.A_zimbraMtaMyNetworks,ZaGlobalConfig.A_zimbraMtaSmtpDnsSupportLevel,ZaGlobalConfig.A_zimbraMilterServerEnabled,ZaGlobalConfig.A_zimbraMilterBindPort];
GlobalConfigXFormView.MTA_TAB_RIGHTS=[];
GlobalConfigXFormView.IMAP_TAB_ATTRS=[ZaGlobalConfig.A_zimbraImapServerEnabled,ZaGlobalConfig.A_zimbraImapSSLServerEnabled,ZaGlobalConfig.A_zimbraImapCleartextLoginEnabled,ZaGlobalConfig.A_zimbraImapNumThreads];
GlobalConfigXFormView.IMAP_TAB_RIGHTS=[];
GlobalConfigXFormView.POP_TAB_ATTRS=[ZaGlobalConfig.A_zimbraPop3ServerEnabled,ZaGlobalConfig.A_zimbraPop3SSLServerEnabled,ZaGlobalConfig.A_zimbraPop3CleartextLoginEnabled,ZaGlobalConfig.A_zimbraPop3NumThreads];
GlobalConfigXFormView.POP_TAB_RIGHTS=[];
GlobalConfigXFormView.ASAV_TAB_ATTRS=[ZaGlobalConfig.A_zimbraSpamKillPercent,ZaGlobalConfig.A_zimbraSpamTagPercent,ZaGlobalConfig.A_zimbraSpamSubjectTag,ZaGlobalConfig.A_zimbraVirusDefinitionsUpdateFrequency,ZaGlobalConfig.A_zimbraVirusBlockEncryptedArchive,ZaGlobalConfig.A_zimbraVirusWarnRecipient];
GlobalConfigXFormView.ASAV_TAB_RIGHTS=[];
GlobalConfigXFormView.INTEROP_TAB_ATTRS=[ZaGlobalConfig.A_zimbraFreebusyExchangeURL,ZaGlobalConfig.A_zimbraFreebusyExchangeAuthScheme,ZaGlobalConfig.A_zimbraFreebusyExchangeServerType,ZaGlobalConfig.A_zimbraFreebusyExchangeAuthUsername,ZaGlobalConfig.A_zimbraFreebusyExchangeAuthPassword,ZaGlobalConfig.A_zimbraFreebusyExchangeUserOrg];
GlobalConfigXFormView.INTEROP_TAB_RIGHTS=[ZaGlobalConfig.CHECK_EXCHANGE_AUTH_CONFIG_RIGHT];
GlobalConfigXFormView.AUTH_TAB_ATTRS=[ZaGlobalConfig.A_zimbraSpnegoAuthEnabled,ZaGlobalConfig.A_zimbraSpnegoAuthRealm,ZaGlobalConfig.A_zimbraSpnegoAuthErrorURL,ZaGlobalConfig.A_zimbraWebClientLoginURL,ZaGlobalConfig.A_zimbraWebClientLogoutURL,ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA,ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA,ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP,ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP,ZaGlobalConfig.A_zimbraForceClearCookies];
GlobalConfigXFormView.AUTH_TAB_RIGHTS=[];
GlobalConfigXFormView.SKIN_TAB_ATTRS=[ZaGlobalConfig.A_zimbraSkinForegroundColor,ZaGlobalConfig.A_zimbraSkinBackgroundColor,ZaGlobalConfig.A_zimbraSkinSecondaryColor,ZaGlobalConfig.A_zimbraSkinSelectionColor,ZaGlobalConfig.A_zimbraSkinLogoURL,ZaGlobalConfig.A_zimbraSkinLogoLoginBanner,ZaGlobalConfig.A_zimbraSkinLogoAppBanner];
GlobalConfigXFormView.SKIN_TAB_RIGHTS=[];
GlobalConfigXFormView.BC_TAB_ATTRS=[ZaGlobalConfig.A_zimbraBasicAuthRealm,ZaGlobalConfig.A_zimbraMailAddressValidationRegex];
GlobalConfigXFormView.BC_TAB_RIGHTS=[];
GlobalConfigXFormView.AUTO_PROV_TAB_ATTRS=[ZaGlobalConfig.A_zimbraAutoProvNotificationBody,ZaGlobalConfig.A_zimbraAutoProvNotificationSubject];
GlobalConfigXFormView.AUTO_PROV_TAB_RIGHTS=[];
GlobalConfigXFormView.RETENTION_POLICY_TAB_ATTRS=[];
GlobalConfigXFormView.RETENTION_POLICY_TAB_RIGHTS=[];
GlobalConfigXFormView.prototype.loadRetentionPolicies=function(){
var e=ZaRetentionPolicy.getRetentionPolicies();
if(e){
this.getForm().setInstanceValue(e[ZaRetentionPolicy.TYPE_KEEP],ZaGlobalConfig.A2_retentionPoliciesKeep);
this.getForm().setInstanceValue(e[ZaRetentionPolicy.TYPE_PURGE],ZaGlobalConfig.A2_retentionPoliciesPurge)
}};
GlobalConfigXFormView.prototype.setObject=function(s){
ZaTabView.prototype.setObject.call(this,s);
if(ZaTabView.XFormSetObjectMethods.GlobalConfigXFormView){
var e=ZaTabView.XFormSetObjectMethods.GlobalConfigXFormView;
var o=e.length;
var n=this._containedObject;
for(var t=0;
t<o;
t++){
if(typeof(e[t])=="function"){
n=e[t].call(this,n,s)
}}
this._containedObject=n
}
this._localXForm.setInstance(this._containedObject)
};
GlobalConfigXFormView.myXFormModifier=function(q,t){
var w=new Array();
var o=1;
var j=0;
w[j++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_name,ZaMsg.CLV_Policy_Name_col,null,"200px",o,ZaRetentionPolicy.A2_name,true,true);
w[j++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_lifetime,ZaMsg.CLV_Policy_Retention_col,null,"auto",null,null,true,true);
var h=new Array();
j=0;
h[j++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_name,ZaMsg.CLV_Policy_Name_col,null,"200px",o++,ZaRetentionPolicy.A2_name,true,true);
h[j++]=new ZaListHeaderItem(ZaRetentionPolicy.A2_lifetime,ZaMsg.CLV_Policy_Purge_col,null,"auto",null,null,true,true);
q.tableCssStyle="width:100%;overflow:auto;";
var C,B,A,O,T,z,x,k,v,p,m;
var e=[];
var W=[];
this.helpMap={};
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.GENERAL_TAB_ATTRS,GlobalConfigXFormView.GENERAL_TAB_RIGHTS)){
C=++this.TAB_INDEX;
this.helpMap[C]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/global_settings.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
var g={
type:_ZATABCASE_,caseKey:C,colSizes:["auto"],numCols:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_ZA_TOP_GROUPER_,numCols:2,colSizes:["275px","auto"],label:ZaMsg.TABT_GeneralPage,items:[{
ref:ZaGlobalConfig.A_zimbraGalMaxResults,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraGalMaxResults,msgName:ZaMsg.MSG_zimbraGalMaxResults,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaGlobalConfig.A_zimbraDefaultDomainName,type:_DYNSELECT_,label:ZaMsg.NAD_DefaultDomainName,toolTipContent:ZaMsg.tt_StartTypingDomainName,dataFetcherMethod:ZaSearch.prototype.dynSelectSearchDomains,dataFetcherClass:ZaSearch,editable:true}
,{
ref:ZaGlobalConfig.A_zimbraScheduledTaskNumThreads,type:_TEXTFIELD_,label:ZaMsg.NAD_zimbraScheduledTaskNumThreads,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaGlobalConfig.A_zimbraMailPurgeSleepInterval,type:_LIFETIME_,label:ZaMsg.LBL_zimbraMailPurgeSleepInterval,width:"5em"}
,{
ref:ZaGlobalConfig.A_zimbraFileUploadMaxSize,type:_TEXTFIELD_,label:ZaMsg.NAD_DOC_MaxUploadSize,labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
,{
ref:ZaGlobalConfig.A_zimbraHelpAdminURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraHelpAdminURL,labelLocation:_LEFT_,width:200}
,{
ref:ZaGlobalConfig.A_zimbraHelpDelegatedURL,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraHelpDelegatedURL,labelLocation:_LEFT_,width:200}
]}
]};
W.push(g);
e.push({
value:C,label:ZaMsg.TABT_GeneralPage}
)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.ATTACHMENTS_TAB_ATTRS,GlobalConfigXFormView.ATTACHMENTS_TAB_RIGHTS)){
B=++this.TAB_INDEX;
this.helpMap[B]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/blocking_attachments_to_email.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:B,label:ZaMsg.NAD_Tab_Attachments}
);
var f={
type:_ZATABCASE_,caseKey:B,id:"gs_form_attachment_tab",paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,numCols:2,colSizes:["40%","60%"],items:[{
type:_GROUP_,id:"attachment_settings",width:"98%",numCols:2,colSpan:2,colSizes:[250,"*"],items:[{
ref:ZaGlobalConfig.A_zimbraAttachmentsBlocked,type:_CHECKBOX_,label:ZaMsg.NAD_GlobalRemoveAllAttachments,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraMtaBlockedExtensionWarnRecipient,type:_CHECKBOX_,label:ZaMsg.LBL_zimbraMtaBlockedExtensionWarnRecipient,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_SPACER_,height:"10"}
,{
type:_ZACENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.NAD_GlobalBlockedExtensions,items:[{
ref:ZaGlobalConfig.A_zimbraMtaBlockedExtension,type:_DWT_LIST_,height:"200",width:"98%",cssClass:"DLTarget",cssStyle:"margin-left: 5px; ",onSelection:GlobalConfigXFormView.blockedExtSelectionListener}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:4,colSizes:[125,10,125,"*"],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemoveAll,width:120,onActivate:"GlobalConfigXFormView.removeAllExt.call(this)",enableDisableChecks:[GlobalConfigXFormView.shouldEnableRemoveAllButton,[ZaItem.hasWritePermission,ZaGlobalConfig.A_zimbraMtaBlockedExtension]],enableDisableChangeEventSources:[ZaGlobalConfig.A_zimbraMtaBlockedExtension,ZaGlobalConfig.A_zimbraMtaBlockedExtension]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemove,width:120,onActivate:"GlobalConfigXFormView.removeExt.call(this)",enableDisableChecks:[GlobalConfigXFormView.shouldEnableRemoveButton,[ZaItem.hasWritePermission,ZaGlobalConfig.A_zimbraMtaBlockedExtension]],enableDisableChangeEventSources:[ZaGlobalConfig.A2_blocked_extension_selection,ZaGlobalConfig.A_zimbraMtaBlockedExtension]}
,{
type:_CELLSPACER_}
]}
]}
]}
,{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_SPACER_,height:"10"}
,{
type:_ZACENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.NAD_GlobalCommonExtensions,items:[{
ref:ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension,type:_DWT_LIST_,height:"200",width:"98%",cssClass:"DLSource",onSelection:GlobalConfigXFormView.commonExtSelectionListener}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"98%",numCols:7,colSizes:[95,10,70,10,90,60,70],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddSelected,width:95,onActivate:"GlobalConfigXFormView.addCommonExt.call(this)",enableDisableChecks:[GlobalConfigXFormView.shouldEnableAddButton,[ZaItem.hasWritePermission,ZaGlobalConfig.A_zimbraMtaBlockedExtension]],enableDisableChangeEventSources:[ZaGlobalConfig.A2_common_extension_selection,ZaGlobalConfig.A_zimbraMtaBlockedExtension]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddAll,width:70,onActivate:"GlobalConfigXFormView.addAllCommonExt.call(this)",enableDisableChecks:[GlobalConfigXFormView.shouldEnableAddAllButton,[ZaItem.hasWritePermission,ZaGlobalConfig.A_zimbraMtaBlockedExtension]],enableDisableChangeEventSources:[ZaGlobalConfig.A_zimbraMtaCommonBlockedExtension,ZaGlobalConfig.A_zimbraMtaBlockedExtension]}
,{
type:_CELLSPACER_}
,{
type:_TEXTFIELD_,cssStyle:"width:60px;",ref:ZaGlobalConfig.A_zimbraNewExtension,label:ZaMsg.NAD_Attach_NewExtension,visibilityChecks:[],enableDisableChecks:[[ZaItem.hasWritePermission,ZaGlobalConfig.A_zimbraMtaBlockedExtension]],enableDisableChangeEventSources:[ZaGlobalConfig.A_zimbraMtaBlockedExtension]}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Attach_AddExtension,width:70,onActivate:"GlobalConfigXFormView.addNewExt.call(this)",enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaGlobalConfig.A_zimbraNewExtension],[ZaItem.hasWritePermission,ZaGlobalConfig.A_zimbraMtaBlockedExtension]],enableDisableChangeEventSources:[ZaGlobalConfig.A_zimbraNewExtension,ZaGlobalConfig.A_zimbraMtaBlockedExtension]}
]}
]}
]}
]};
W.push(f)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.MTA_TAB_ATTRS,GlobalConfigXFormView.MTA_TAB_RIGHTS)){
A=++this.TAB_INDEX;
this.helpMap[A]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/mta_smtp_restrictions.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:A,label:ZaMsg.NAD_Tab_MTA}
);
var u={
type:_ZATABCASE_,caseKey:A,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_mta_tab",items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_MTA_AuthenticationGrp,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,ZaGlobalConfig.A_zimbraMtaTlsAuthOnly]]],visibilityChangeEventSources:[ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,ZaGlobalConfig.A_zimbraMtaTlsAuthOnly],items:[{
ref:ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_Authentication,trueValue:"yes",falseValue:"no"}
,{
ref:ZaGlobalConfig.A_zimbraMtaTlsAuthOnly,type:_CHECKBOX_,enableDisableChangeEventSources:[ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,ZaGlobalConfig.A_zimbraMtaTlsAuthOnly],enableDisableChecks:[[ZaItem.hasWritePermission,ZaGlobalConfig.A_zimbraMtaTlsAuthOnly],[XForm.checkInstanceValue,ZaGlobalConfig.A_zimbraMtaSaslAuthEnable,"yes"]],label:ZaMsg.NAD_MTA_TlsAuthenticationOnly,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_MTA_NetworkGrp,id:"mta_network_group",visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaGlobalConfig.A_zimbraSmtpHostname,ZaGlobalConfig.A_zimbraSmtpPort,ZaGlobalConfig.A_zimbraMtaRelayHost,ZaGlobalConfig.A_zimbraMtaFallbackRelayHost,ZaGlobalConfig.A_zimbraDNSCheckHostname,ZaGlobalConfig.A_zimbraMtaMyNetworks,ZaGlobalConfig.A_zimbraMtaSmtpDnsSupportLevel]]],visibilityChangeEventSources:[ZaGlobalConfig.A_zimbraSmtpHostname,ZaGlobalConfig.A_zimbraSmtpPort,ZaGlobalConfig.A_zimbraMtaRelayHost,ZaGlobalConfig.A_zimbraMtaFallbackRelayHost,ZaGlobalConfig.A_zimbraDNSCheckHostname,ZaGlobalConfig.A_zimbraMtaMyNetworks,ZaGlobalConfig.A_zimbraMtaSmtpDnsSupportLevel],items:[{
ref:ZaGlobalConfig.A_zimbraSmtpHostname,type:_REPEAT_,label:ZaMsg.LBL_zimbraSmtpHostname,labelLocation:_LEFT_,align:_LEFT_,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.Add_zimbraSmtpHostname,removeButtonLabel:ZaMsg.Remove_zimbraSmtpHostname,removeButtonCSSStyle:"margin-left: 50px",visibilityChecks:[ZaItem.hasReadPermission],items:[{
ref:".",type:_TEXTFIELD_,label:null,labelLocation:_NONE_,toolTipContent:ZaMsg.tt_zimbraSmtpHostname,visibilityChecks:[ZaItem.hasReadPermission]}
]}
,{
ref:ZaGlobalConfig.A_zimbraSmtpPort,type:_OUTPUT_,label:ZaMsg.NAD_MTA_WebMailPort,visibilityChecks:[ZaItem.hasReadPermission]}
,{
ref:ZaGlobalConfig.A_zimbraMtaRelayHost,label:ZaMsg.NAD_MTA_RelayMTA,labelLocation:_LEFT_,type:_HOSTPORT_,onClick:"ZaController.showTooltip",toolTipContent:ZaMsg.tt_MTA_RelayMTA,visibilityChecks:[ZaItem.hasReadPermission],onMouseout:"ZaController.hideTooltip"}
,{
ref:ZaGlobalConfig.A_zimbraMtaFallbackRelayHost,label:ZaMsg.NAD_MTA_FallbackRelay,labelLocation:_LEFT_,type:_HOSTPORT_,onClick:"ZaController.showTooltip",toolTipContent:ZaMsg.tt_MTA_FallbackRelay,visibilityChecks:[ZaItem.hasReadPermission],onMouseout:"ZaController.hideTooltip"}
,{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0px",style:DwtAlert.INFO,iconVisible:true,content:ZaMsg.Domain_InboundSMTPNote,colSpan:"*"}
,{
ref:ZaGlobalConfig.A_zimbraDNSCheckHostname,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraDNSCheckHostname,toolTipContent:ZaMsg.Domain_zimbraDNSCheckHostname}
,{
ref:ZaGlobalConfig.A_zimbraMtaMyNetworks,type:_TEXTAREA_,label:ZaMsg.NAD_MTA_MyNetworks,msgName:ZaMsg.NAD_MTA_MyNetworks,width:250}
,{
ref:ZaGlobalConfig.A_zimbraMtaSmtpDnsSupportLevel,type:_OSELECT1_,label:ZaMsg.NAD_MTA_SMTP_Dns,choices:ZaSettings.getSmtpDnsSupportLevel}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_MTA_MilterServer,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaGlobalConfig.A_zimbraMilterBindPort,ZaGlobalConfig.A_zimbraMilterServerEnabled]]],visibilityChangeEventSources:[ZaGlobalConfig.A_zimbraMilterBindPort,ZaGlobalConfig.A_zimbraMilterServerEnabled],items:[{
ref:ZaGlobalConfig.A_zimbraMilterBindPort,type:_OUTPUT_,label:ZaMsg.NAD_MTA_MilterBindPort}
,{
ref:ZaGlobalConfig.A_zimbraMilterServerEnabled,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_MilterServerEnabled,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_MTA_Messages,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaGlobalConfig.A_zimbraMtaMaxMessageSize,ZaGlobalConfig.A_zimbraSmtpSendAddOriginatingIP]]],visibilityChangeEventSources:[ZaGlobalConfig.A_zimbraMtaMaxMessageSize,ZaGlobalConfig.A_zimbraSmtpSendAddOriginatingIP],items:[{
ref:ZaGlobalConfig.A_zimbraMtaMaxMessageSize,type:_TEXTFIELD_,label:ZaMsg.NAD_MTA_MaxMsgSize,width:"6em"}
,{
ref:ZaGlobalConfig.A_zimbraSmtpSendAddOriginatingIP,type:_CHECKBOX_,label:ZaMsg.NAD_add_x_orginate_IP,trueValue:"TRUE",falseValue:"FALSE"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_MTA_PolicyServiceChecks,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaGlobalConfig.A_zimbraMtaPolicyService]]],items:[{
ref:ZaGlobalConfig.A_zimbraMtaPolicyService,type:_REPEAT_,label:ZaMsg.NAD_MTA_policy_service,labelLocation:_LEFT_,align:_LEFT_,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null,visibilityChecks:[],enableDisableChecks:[]}
]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_MTA_ProtocolChecks,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaGlobalConfig.A_zimbraMtaRejectInvalidHeloHostname,ZaGlobalConfig.A_zimbraMtaRejectNonFqdnHeloHostname,ZaGlobalConfig.A_zimbraMtaRejectNonFqdnSender]]],visibilityChangeEventSources:[ZaGlobalConfig.A_zimbraMtaRejectUnknownClientHostname,ZaGlobalConfig.A_zimbraMtaRejectUnknownReverseClientHostname,ZaGlobalConfig.A_zimbraMtaRejectUnknownSenderDomain,ZaGlobalConfig.A_zimbraMtaRejectUnknownHeloHostname],items:[{
ref:ZaGlobalConfig.A_zimbraMtaRejectInvalidHeloHostname,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_reject_invalid_helo_hostname}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectNonFqdnHeloHostname,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_reject_non_fqdn_helo_hostname}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectNonFqdnSender,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_reject_non_fqdn_sender}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_MTA_DnsChecks,visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaGlobalConfig.A_zimbraMtaRejectUnknownClientHostname,ZaGlobalConfig.A_zimbraMtaRejectUnknownReverseClientHostname,ZaGlobalConfig.A_zimbraMtaRejectUnknownSenderDomain,ZaGlobalConfig.A_zimbraMtaRejectUnknownHeloHostname]]],visibilityChangeEventSources:[ZaGlobalConfig.A_zimbraMtaRejectUnknownClientHostname,ZaGlobalConfig.A_zimbraMtaRejectUnknownReverseClientHostname,ZaGlobalConfig.A_zimbraMtaRejectUnknownSenderDomain,ZaGlobalConfig.A_zimbraMtaRejectUnknownHeloHostname],items:[{
ref:ZaGlobalConfig.A_zimbraMtaRejectUnknownClientHostname,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_reject_unknown_client_hostname}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectUnknownReverseClientHostname,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_reject_unknown_reverse_client_hostname}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectUnknownSenderDomain,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_reject_unknown_sender_domain}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectUnknownHeloHostname,type:_CHECKBOX_,label:ZaMsg.NAD_MTA_reject_unknown_helo_hostname}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectRblClient,type:_REPEAT_,label:ZaMsg.NAD_MTA_reject_rbl_client,labelLocation:_LEFT_,align:_LEFT_,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null}
]}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectRHSblClient,type:_REPEAT_,label:ZaMsg.NAD_MTA_reject_rhsbl_client,labelLocation:_LEFT_,align:_LEFT_,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null}
]}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectRHSblReverseClient,type:_REPEAT_,label:ZaMsg.NAD_MTA_reject_rhsbl_reverse_client,labelLocation:_LEFT_,align:_LEFT_,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null}
]}
,{
ref:ZaGlobalConfig.A_zimbraMtaRejectRHSblSender,type:_REPEAT_,label:ZaMsg.NAD_MTA_reject_rhsbl_sender,labelLocation:_LEFT_,align:_LEFT_,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.NAD_Add,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null}
]}
]}
,{
type:_SPACER_,height:10}
]};
W.push(u)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.IMAP_TAB_ATTRS,GlobalConfigXFormView.IMAP_TAB_RIGHTS)){
O=++this.TAB_INDEX;
this.helpMap[O]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/imap_and_pop_proxy_server.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:O,label:ZaMsg.NAD_Tab_IMAP}
);
var d={
type:_ZATABCASE_,caseKey:O,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_imap_tab",items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0px",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_ServerRestart}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_IMAP_ServiceGrp,items:[{
ref:ZaGlobalConfig.A_zimbraImapServerEnabled,type:_CHECKBOX_,label:ZaMsg.IMAP_Service,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraImapSSLServerEnabled,type:_CHECKBOX_,label:ZaMsg.IMAP_SSLService,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraImapCleartextLoginEnabled,type:_CHECKBOX_,label:ZaMsg.IMAP_CleartextLoginEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraImapNumThreads,type:_TEXTFIELD_,label:ZaMsg.IMAP_NumThreads,width:"5em"}
]}
]};
W.push(d)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.POP_TAB_ATTRS,GlobalConfigXFormView.POP_TAB_RIGHTS)){
T=++this.TAB_INDEX;
this.helpMap[T]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/configuring_pop.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:T,label:ZaMsg.NAD_Tab_POP}
);
var c={
type:_ZATABCASE_,caseKey:T,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_pop_tab",items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0px",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_ServerRestart}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Global_POP_ServiceGrp,items:[{
ref:ZaGlobalConfig.A_zimbraPop3ServerEnabled,type:_CHECKBOX_,label:ZaMsg.NAD_POP_Service,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraPop3SSLServerEnabled,type:_CHECKBOX_,label:ZaMsg.NAD_POP_SSL,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraPop3CleartextLoginEnabled,type:_CHECKBOX_,label:ZaMsg.NAD_POP_CleartextLoginEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraPop3NumThreads,type:_TEXTFIELD_,label:ZaMsg.NAD_POP_NumThreads,width:"5em"}
]}
]};
W.push(c)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.ASAV_TAB_ATTRS,GlobalConfigXFormView.ASAV_TAB_RIGHTS)){
z=++this.TAB_INDEX;
this.helpMap[z]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/anti-spam_protection.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:z,label:ZaMsg.NAD_Tab_ASAV}
);
var l={
type:_ZATABCASE_,caseKey:z,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_asav_tab",items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_AS_Settings,items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0px",style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_AmavisdRestart}
,{
ref:ZaGlobalConfig.A_zimbraSpamKillPercent,type:_INPUT_,label:ZaMsg.NAD_Spam_KillPercent,width:"4em"}
,{
ref:ZaGlobalConfig.A_zimbraSpamTagPercent,type:_INPUT_,label:ZaMsg.NAD_Spam_TagPercent,width:"4em"}
,{
ref:ZaGlobalConfig.A_zimbraSpamSubjectTag,type:_INPUT_,label:ZaMsg.NAD_Spam_SubjectPrefix,width:"20em"}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_AV_Settings,items:[{
ref:ZaGlobalConfig.A_zimbraVirusDefinitionsUpdateFrequency,type:_INPUT_,label:ZaMsg.NAD_Virus_DefUpdateFreq,width:"5em"}
,{
ref:ZaGlobalConfig.A_zimbraVirusBlockEncryptedArchive,type:_CHECKBOX_,label:ZaMsg.NAD_Virus_BlockEncrypted,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaGlobalConfig.A_zimbraVirusWarnRecipient,type:_CHECKBOX_,label:ZaMsg.NAD_Virus_NotifyRecipient,trueValue:"TRUE",falseValue:"FALSE"}
]}
]};
W.push(l)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.INTEROP_TAB_ATTRS,GlobalConfigXFormView.INTEROP_TAB_RIGHTS)){
x=++this.TAB_INDEX;
this.helpMap[x]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/making_free_busy_view__available_.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:x,label:ZaMsg.TABT_Interop}
);
var r={
type:_ZATABCASE_,caseKey:x,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_interop_tab",items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_Exchange_Settings,items:[{
ref:ZaGlobalConfig.A_zimbraFreebusyExchangeURL,type:_TEXTFIELD_,label:ZaMsg.NAD_Exchange_URL,width:"30em"}
,{
ref:ZaGlobalConfig.A_zimbraFreebusyExchangeAuthScheme,type:_OSELECT1_,label:ZaMsg.NAD_Exchange_Auth_Schema}
,{
ref:ZaGlobalConfig.A_zimbraFreebusyExchangeServerType,type:_OSELECT1_,label:ZaMsg.NAD_Exchange_Server_Type}
,{
ref:ZaGlobalConfig.A_zimbraFreebusyExchangeAuthUsername,type:_TEXTFIELD_,label:ZaMsg.NAD_Exchange_Auth_User,width:"20em"}
,{
ref:ZaGlobalConfig.A_zimbraFreebusyExchangeAuthPassword,type:_PASSWORD_,label:ZaMsg.NAD_Exchange_Auth_Password,width:"20em"}
,{
ref:ZaGlobalConfig.A_zimbraFreebusyExchangeUserOrg,type:_TEXTFIELD_,label:ZaMsg.LBL_zimbraFreebusyExchangeUserOrg,width:"20em"}
,{
type:_GROUP_,colSpan:2,numCols:5,colSizes:["120px","10px","170px","20px","160px"],items:[{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,colSpan:2,label:ZaMsg.Check_Settings,autoPadding:false,onActivate:ZaItem.checkInteropSettings,enableDisableChecks:[ZaZimbraAdmin.canChangeExchangeConfig]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,colSpan:2,label:ZaMsg.Clear_Settings,autoPadding:false,onActivate:ZaItem.clearInteropSettings,enableDisableChecks:[ZaZimbraAdmin.canChangeExchangeConfig]}
,{
type:_CELLSPACER_}
]}
]}
]};
W.push(r)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.SKIN_TAB_ATTRS,GlobalConfigXFormView.SKIN_TAB_RIGHTS)){
k=++this.TAB_INDEX;
this.helpMap[k]=[location.pathname,ZaUtil.HELP_URL,"cos/customizing_ui_themes.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:k,label:ZaMsg.TABT_Themes}
);
var s={
type:_ZATABCASE_,caseKey:k,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_skin_tab",items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_Skin_Color_Settings,items:[{
type:_DWT_ALERT_,style:DwtAlert.WARNING,iconVisible:true,content:ZaMsg.Alert_Flush_Theme_Cache,colSpan:2,visibilityChecks:[],ref:null}
,{
ref:ZaGlobalConfig.A_zimbraSkinForegroundColor,type:_DWT_COLORPICKER_,label:ZaMsg.NAD_zimbraSkinForegroundColor,labelLocation:_LEFT_,buttonImage:"Color",width:"50px"}
,{
ref:ZaGlobalConfig.A_zimbraSkinBackgroundColor,type:_DWT_COLORPICKER_,label:ZaMsg.NAD_zimbraSkinBackgroundColor,labelLocation:_LEFT_,buttonImage:"Color",width:"50px"}
,{
ref:ZaGlobalConfig.A_zimbraSkinSecondaryColor,type:_DWT_COLORPICKER_,label:ZaMsg.NAD_zimbraSkinSecondaryColor,labelLocation:_LEFT_,buttonImage:"Color",width:"50px"}
,{
ref:ZaGlobalConfig.A_zimbraSkinSelectionColor,type:_DWT_COLORPICKER_,label:ZaMsg.NAD_zimbraSkinSelectionColor,buttonImage:"Color",width:"50px",labelLocation:_LEFT_}
,{
type:_GROUP_,colSpan:2,cssStyle:"margin-top: 10px; margin-left: 200px; width: 200px;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.bt_ResetAllSkinColor,onActivate:ZaDomainXFormView.resetAllColorThemes}
]}
]}
]};
W.push(s)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.BC_TAB_ATTRS,GlobalConfigXFormView.BC_TAB_RIGHTS)){
v=++this.TAB_INDEX;
this.helpMap[v]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/account_email_validation.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:v,label:ZaMsg.Domain_Tab_Advanced}
);
var n={
type:_ZATABCASE_,caseKey:v,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_ad_tab",items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_BC_ShareConf,items:[{
ref:ZaGlobalConfig.A_zimbraBasicAuthRealm,type:_TEXTFIELD_,label:ZaMsg.Domain_zimbraBasicAuthRealm}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.Domain_AD_EmailValidate,visibilityChecks:[[ZaItem.hasReadPermission,ZaGlobalConfig.A_zimbraMailAddressValidationRegex]],visibilityChangeEventSources:[ZaGlobalConfig.A_zimbraMailAddressValidationRegex],items:[{
ref:ZaGlobalConfig.A_zimbraMailAddressValidationRegex,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_EmailValidate,labelLocation:_LEFT_,align:_LEFT_,repeatInstance:"",showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,addButtonLabel:ZaMsg.NAD_AddRegex,removeButtonLabel:ZaMsg.NAD_RemoveRegex,removeButtonCSSStyle:"margin-left: 50px",items:[{
ref:".",type:_TEXTFIELD_,label:null}
]}
]}
]};
W.push(n)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.AUTH_TAB_ATTRS,GlobalConfigXFormView.AUTH_TAB_RIGHTS)){
p=++this.TAB_INDEX;
this.helpMap[p]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/managing_single_sign_on_as_a_global_setting.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:p,label:ZaMsg.NAD_Tab_AUTH}
);
var b={
type:_ZATABCASE_,caseKey:p,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["auto"],numCols:1,id:"global_auth_tab",items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_WEBCLIENT_Configure,items:[{
ref:ZaGlobalConfig.A_zimbraWebClientLoginURL,type:_TEXTFIELD_,width:"200px",label:ZaMsg.LBL_zimbraWebClientLoginURL}
,{
ref:ZaGlobalConfig.A_zimbraWebClientLogoutURL,type:_TEXTFIELD_,width:"200px",label:ZaMsg.LBL_zimbraWebClientLogoutURL}
,{
ref:ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedUA,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_zimbraWebClientLoginURLAllowedUA,msgName:ZaMsg.MSG_zimbraWebClientLoginURLAllowedUA,labelLocation:_LEFT_,addButtonLabel:ZaMsg.NAD_Add,align:_LEFT_,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:"200px"}
]}
,{
ref:ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedUA,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_zimbraWebClientLogoutURLAllowedUA,msgName:ZaMsg.MSG_zimbraWebClientLogoutURLAllowedUA,labelLocation:_LEFT_,addButtonLabel:ZaMsg.NAD_Add,align:_LEFT_,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:"200px"}
]}
,{
ref:ZaGlobalConfig.A_zimbraWebClientLoginURLAllowedIP,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_zimbraWebClientLoginURLAllowedIP,msgName:ZaMsg.MSG_zimbraWebClientLoginURLAllowedIP,labelLocation:_LEFT_,addButtonLabel:ZaMsg.NAD_Add,align:_LEFT_,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:"200px"}
]}
,{
ref:ZaGlobalConfig.A_zimbraWebClientLogoutURLAllowedIP,type:_REPEAT_,nowrap:false,labelWrap:true,label:ZaMsg.LBL_zimbraWebClientLogoutURLAllowedIP,msgName:ZaMsg.MSG_zimbraWebClientLogoutURLAllowedIP,labelLocation:_LEFT_,addButtonLabel:ZaMsg.NAD_Add,align:_LEFT_,showAddButton:true,showRemoveButton:true,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_Remove,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:"200px"}
]}
,{
ref:ZaGlobalConfig.A_zimbraForceClearCookies,type:_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.LBL_zimbraForceClearCookies,msgName:ZaMsg.MSG_zimbraForceClearCookies,labelLocation:_LEFT_}
]}
]};
W.push(b)
}
if(ZaTabView.isTAB_ENABLED(t,GlobalConfigXFormView.RETENTION_POLICY_TAB_ATTRS,GlobalConfigXFormView.RETENTION_POLICY_TAB_RIGHTS)){
m=++this.TAB_INDEX;
this.helpMap[m]=[location.pathname,ZaUtil.HELP_URL,"managing_global_settings/retention_policies.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
e.push({
value:m,label:ZaMsg.TABT_RetentionPolicy}
);
var y={
type:_SUPER_TABCASE_,caseKey:m,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,colSizes:["100%"],numCols:1,id:"global_retentionpolicy_tab",loadDataMethods:[GlobalConfigXFormView.prototype.loadRetentionPolicies],items:[{
type:_ZA_TOP_GROUPER_,id:"global_form_keep_p_group",width:"98%",numCols:1,colSizes:["auto"],label:ZaMsg.Glb_RetentionPolicies,cssStyle:"margin:10px;padding-bottom:0;",items:[{
ref:ZaGlobalConfig.A2_retentionPoliciesKeep,type:_DWT_LIST_,height:"200",width:"99%",preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:w,widgetClass:ZaRetentionPolicyListView,onSelection:GlobalConfigXFormView.retentionSelectionListener,valueChangeEventSources:[ZaGlobalConfig.A2_retentionPoliciesKeep]}
,{
type:_GROUP_,numCols:5,colSizes:["100px","auto","100px","auto","100px"],width:"350px",cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"GlobalConfigXFormView.deleteButtonListener.call(this);",enableDisableChangeEventSources:[ZaGlobalConfig.A2_retentionPoliciesKeep_Selection],enableDisableChecks:[function(){
var D=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep_Selection);
return D&&D.length>0
}
]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"GlobalConfigXFormView.editButtonListener.call(this);",enableDisableChangeEventSources:[ZaGlobalConfig.A2_retentionPoliciesKeep_Selection],enableDisableChecks:[function(){
var D=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesKeep_Selection);
return D&&D.length==1
}
]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",onActivate:"GlobalConfigXFormView.addButtonListener.call(this);"}
]}
]}
,{
type:_ZA_TOP_GROUPER_,id:"global_form_purge_p_group",width:"98%",numCols:1,colSizes:["auto"],label:ZaMsg.Glb_DisposalPolicies,cssStyle:"margin:10px;padding-bottom:0;",items:[{
ref:ZaGlobalConfig.A2_retentionPoliciesPurge,type:_DWT_LIST_,height:"200",width:"99%",preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:h,widgetClass:ZaRetentionPolicyListView,onSelection:GlobalConfigXFormView.purgeSelectionListener,valueChangeEventSources:[ZaGlobalConfig.A2_retentionPoliciesPurge]}
,{
type:_GROUP_,numCols:5,colSizes:["100px","auto","100px","auto","100px"],width:"350px",cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"GlobalConfigXFormView.deleteButtonListener.call(this, 1);",enableDisableChangeEventSources:[ZaGlobalConfig.A2_retentionPoliciesPurge_Selection],enableDisableChecks:[function(){
var D=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge_Selection);
return D&&D.length>0
}
]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"GlobalConfigXFormView.editButtonListener.call(this, 1);",enableDisableChangeEventSources:[ZaGlobalConfig.A2_retentionPoliciesPurge_Selection],enableDisableChecks:[function(){
var D=this.getForm().getInstanceValue(ZaGlobalConfig.A2_retentionPoliciesPurge_Selection);
return D&&D.length==1
}
]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",onActivate:"GlobalConfigXFormView.addButtonListener.call(this,1);"}
]}
]}
]};
W.push(y)
}
this.tabChoices=e;
q.items=[{
type:_DWT_ALERT_,cssClass:"DwtTabTable",containerCssStyle:"padding-bottom:0px",style:DwtAlert.INFO,iconVisible:false,content:ZaMsg.Alert_GlobalConfig,id:"xform_header"}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,id:"xform_tabbar",height:"0px",containerCssStyle:"padding-top:0px; ",cssStyle:"display:none;",choices:e}
,{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:W}
]
};
ZaTabView.XFormModifiers.GlobalConfigXFormView.push(GlobalConfigXFormView.myXFormModifier);
GlobalConfigXFormView.prototype.getTabChoices=function(){
return this.tabChoices
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaAccMiniListView")){
ZaAccMiniListView=function(r,s,n,t,e,h,o){
if(arguments.length==0){
return
}
if(n==null){
n=DwtControl.RELATIVE_STYLE
}
ZaListView.call(this,r,s,n,t,e,h,o);
this.hideHeader=true
};
ZaAccMiniListView.prototype=new ZaListView;
ZaAccMiniListView.prototype.constructor=ZaAccMiniListView;
ZaAccMiniListView.prototype.toString=function(){
return"ZaAccMiniListView"
};
ZaAccMiniListView.prototype.createHeaderHtml=function(e){
if(!this.hideHeader){
DwtListView.prototype.createHeaderHtml.call(this,e)
}};
ZaAccMiniListView.prototype._createItemHtml=function(h,t,n){
var r=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(h,e,DwtListView.TYPE_LIST_ITEM);
var d=0;
r[d++]="<table width='100%' cellspacing='0' cellpadding='0'>";
r[d++]="<tr>";
if(typeof(h)=="string"){
r[d++]="<td width=100%>";
r[d++]=AjxStringUtil.htmlEncode(h);
r[d++]="</td>"
}else{
if(this._headerList){
var o=this._headerList.length;
for(var s=0;
s<o;
s++){
var c=this._headerList[s]._field;
var l=null;
if(c!=null){
if(c=="type"){
r[d++]="<td width="+this._headerList[s]._width+">";
switch(h.type){
case ZaItem.ACCOUNT:if(h.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
l=("AdminUser")
}else{
if(h.attrs[ZaAccount.A_zimbraIsDelegatedAdminAccount]=="TRUE"){
l=("DomainAdminUser")
}else{
if(h.attrs[ZaAccount.A_zimbraIsSystemAccount]=="TRUE"){
l=("SpecialAccount")
}else{
if(h.attrs[ZaAccount.A_zimbraIsSystemResource]=="TRUE"){
l=("SystemResource")
}else{
if(h.attrs[ZaAccount.A_zimbraIsExternalVirtualAccount]=="TRUE"){
l=("AccountExternalVirtual")
}else{
if(h.isExternal){
l=("AccountIMAP")
}else{
l=("Account")
}}}}}}
break;
case ZaItem.DL:if(h.attrs[ZaDistributionList.A_isAdminGroup]=="TRUE"){
l=("DistributionListGroup")
}else{
l=("DistributionList")
}
break;
case ZaItem.ALIAS:l=("AccountAlias");
break;
case ZaItem.DOMAIN:l=("Domain");
break;
case ZaItem.COS:l=("COS");
break;
case ZaItem.RESOURCE:if(h.attrs[ZaResource.A_zimbraCalResType]==ZaResource.RESOURCE_TYPE_LOCATION){
l=("Location")
}else{
l=("Resource")
}
break;
default:r[d++]=AjxStringUtil.htmlEncode(h.type);
break
}
if(l!=null){
r[d++]=AjxImg.getImageHtml(l)
}
r[d++]="</td>"
}else{
if(c==ZaAccount.A_name){
r[d++]="<td align='left' width="+this._headerList[s]._width+"><nobr>";
r[d++]=AjxStringUtil.htmlEncode(h.name);
r[d++]="</nobr></td>"
}else{
if(c==ZaAccount.A_displayname){
r[d++]="<td align='left' width="+this._headerList[s]._width+"><nobr>";
r[d++]=AjxStringUtil.htmlEncode(h.attrs[ZaAccount.A_displayname]);
r[d++]="</nobr></td>"
}}}}}}else{
if(typeof(h)=="object"){
r[d++]="<td width=100%>";
r[d++]=AjxStringUtil.htmlEncode(h.name);
r[d++]="</td>"
}else{
r[d++]="<td width=100%>";
r[d++]=AjxStringUtil.htmlEncode(String(h));
r[d++]="</td>"
}}}
r[d++]="</tr></table>";
e.innerHTML=r.join("");
return e
};
ZaAccMiniListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br>&nbsp","</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaAccMiniListView.prototype._sortColumn=function(e,t){
if(this.parent.parent.searchAccounts){
this.parent.parent.searchAccounts(e.getSortField(),t)
}}
}
if(AjxPackage.define("zimbraAdmin.dl.view.ZaDLXFormView")){
ZaDLXFormView=function(e,t){
ZaTabView.call(this,e,"ZaDLXFormView");
this.dlStatusChoices=[{
value:"enabled",label:ZaMsg.DL_Status_enabled}
,{
value:"disabled",label:ZaMsg.DL_Status_disabled}
];
this.TAB_INDEX=0;
this.initForm(ZaDistributionList.myXModel,this.getMyXForm(t));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_CHANGED,new AjxListener(this,ZaDLXFormView.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaDLXFormView.prototype.handleXFormChange))
};
ZaDLXFormView.prototype=new ZaTabView();
ZaDLXFormView.prototype.constructor=ZaDLXFormView;
ZaTabView.XFormModifiers.ZaDLXFormView=new Array();
ZaTabView.ObjectModifiers.ZaDLXFormView=[];
ZaDLXFormView.prototype.getTitle=function(){
return ZaMsg.DL_view_title
};
ZaDLXFormView.prototype.getTabIcon=function(){
if(this._containedObject&&this._containedObject.attrs&&this._containedObject.attrs[ZaDistributionList.A_isAdminGroup]=="TRUE"){
return"DistributionListGroup"
}else{
return"DistributionList"
}};
ZaDLXFormView.prototype.handleXFormChange=function(e){
if(e&&this._localXForm.hasErrors()){
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,false)
}else{
ZaZimbraAdmin.getInstance().getCurrentAppBar().enableButton(ZaOperation.SAVE,true)
}};
ZaDLXFormView.membersSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_membersSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_membersSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaDLXFormView.removeSelectedMembers.call(this,t)
}};
ZaDLXFormView.nonmemberSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_nonmembersSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_nonmembersSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountMemberOfListView._addSelectedLists(this.getForm(),e)
}};
ZaDLXFormView.memberPoolSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_memberPoolSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_memberPoolSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaDLXFormView.addSelectedAddressesToMembers.call(this,t)
}};
ZaDLXFormView.directMemberSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_directMemberSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_directMemberSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountMemberOfListView._removeSelectedLists(this.getForm(),e)
}};
ZaDLXFormView.indirectMemberSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_indirectMemberSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_indirectMemberSelected,null)
}};
ZaDLXFormView.removeMemberListFromPage=function(s,c,d){
if(!s||AjxUtil.isEmpty(c)){
return null
}
var u={};
var l;
for(l=0;
l<c.length;
l++){
var t=c[l];
var n=t[ZaAccount.A_name];
if(n){
u[n]=t
}}
if(!d){
d=(s.getInstanceValue(ZaDistributionList.A2_memPagenum)||1)
}
var o=s.getInstanceValue(ZaDistributionList.A2_allMemberPages)||[];
if(o==null){
return null
}
--d;
if(o[d]==null){
o[d]=[]
}
var h=s.getInstanceValue(ZaDistributionList.A2_allMemberHash)||{};
var e=o[d];
var r=[];
for(l=0;
l<e.length;
l++){
var t=e[l];
var n=t[ZaAccount.A_name];
if(u[n]==null){
r.push(t)
}else{
h[n]=null
}}
o[d]=r;
s.setInstanceValue(o,ZaDistributionList.A2_allMemberPages);
s.setInstanceValue(h,ZaDistributionList.A2_allMemberHash);
return r
};
ZaDLXFormView.removeMembers=function(n,d){
var r=n.getInstanceValue(ZaDistributionList.A2_addList)||[];
r=r.sort(ZaDistributionList.compareTwoMembers);
d=d.sort(ZaDistributionList.compareTwoMembers);
var s=[];
var c=0,l=0;
var u=[];
while(c<r.length&&l<d.length){
var g=r[c];
var o=d[l];
var t=o[ZaAccount.A_name];
var m=ZaDistributionList.compareTwoMembers(g,o);
if(m>0){
s.push(o);
l++
}else{
if(m<0){
u.push(g);
c++
}else{
c++;
l++
}}}
for(;
c<r.length;
c++){
u.push(r[c])
}
if(u.length<r.length){
u._version=(r._version||0)+1;
n.setInstanceValue(u,ZaDistributionList.A2_addList)
}
for(;
l<d.length;
l++){
s.push(d[l])
}
var e=n.getInstanceValue(ZaDistributionList.A2_removeList);
for(l=0;
l<e.length;
l++){
s.push(e[l])
}
s._version=(e._version||0)+1;
n.setInstanceValue(s,ZaDistributionList.A2_removeList);
var p=n.getInstanceValue(ZaDistributionList.A2_memberList);
var f=ZaDLXFormView.removeMemberListFromPage(n,d)||[];
f._version=(p._version||0)+1;
n.setInstanceValue(f,ZaDistributionList.A2_memberList);
var h=n.getInstanceValue(ZaDistributionList.A2_numMembers)||0;
h-=d.length;
n.setInstanceValue(h,ZaDistributionList.A2_numMembers);
n.parent.setDirty(true)
};
ZaDLXFormView.removeSelectedMembers=function(o){
var t=this.getForm();
var e=t.getInstanceValue(ZaDistributionList.A2_membersSelected);
ZaDLXFormView.removeMembers(t,e)
};
ZaDLXFormView.removeOnePageMembers=function(o){
var t=this.getForm();
var e=t.getInstanceValue(ZaDistributionList.A2_memberList);
ZaDLXFormView.removeMembers(t,e)
};
ZaDLXFormView.srchButtonHndlr=function(e){
this.setInstanceValue([],ZaDistributionList.A2_memberPool);
this.setInstanceValue(1,ZaDistributionList.A2_poolPagenum);
this.setInstanceValue(1,ZaDistributionList.A2_poolNumPages);
this.setInstanceValue(-1,ZaDistributionList.A2_totalNumInPool);
this.setInstanceValue(null,ZaDistributionList.A2_memberPoolSelected);
var t=this.getForm().parent;
ZaDLXFormView.prototype.searchAccounts.call(t,null,true)
};
ZaDLXFormView.fwdPoolButtonHndlr=function(e){
var t=this.getForm().parent;
var o=this.getInstanceValue(ZaDistributionList.A2_poolPagenum);
this.setInstanceValue(o+1,ZaDistributionList.A2_poolPagenum);
ZaDLXFormView.prototype.searchAccounts.call(t,null,true)
};
ZaDLXFormView.backPoolButtonHndlr=function(e){
var t=this.getForm().parent;
var o=this.getInstanceValue(ZaDistributionList.A2_poolPagenum)-1;
this.setInstanceValue(o,ZaDistributionList.A2_poolPagenum);
ZaDLXFormView.prototype.searchAccounts.call(t,null,true)
};
ZaDLXFormView.fwdMemButtonHndlr=function(e){
var o=this.getInstanceValue(ZaDistributionList.A2_memPagenum)+1;
this.setInstanceValue(o,ZaDistributionList.A2_memPagenum);
var t=ZaApp.getInstance().getCurrentController()._currentObject;
if(t&&t[ZaDistributionList.A2_allMemberPages]){
t[ZaDistributionList.A2_memPagenum]=o;
var n=t[ZaDistributionList.A2_allMemberPages][o-1]||[];
this.setInstanceValue(n,ZaDistributionList.A2_memberList)
}};
ZaDLXFormView.backMemButtonHndlr=function(e){
var o=this.getInstanceValue(ZaDistributionList.A2_memPagenum)-1;
this.setInstanceValue(o,ZaDistributionList.A2_memPagenum);
var t=ZaApp.getInstance().getCurrentController()._currentObject;
if(t&&t[ZaDistributionList.A2_allMemberPages]){
t[ZaDistributionList.A2_memPagenum]=o;
var n=t[ZaDistributionList.A2_allMemberPages][o-1]||[];
this.setInstanceValue(n,ZaDistributionList.A2_memberList)
}};
ZaDLXFormView.getMemberSelection=function(){
var e=this.getItemsById(ZaDistributionList.A2_members)[0];
var t=null;
if(e){
var t=e.getSelection()
}
if(t){
return t
}else{
return[]
}};
ZaDLXFormView.shouldEnableMemberListButtons=function(){
return(ZaDLXFormView.getMemberSelection.call(this).length>0)
};
ZaDLXFormView.shouldEnableRemoveThisPageButton=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_memberList)))
};
ZaDLXFormView.shouldEnableAddAllButton=function(){
var e=this.getItemsById(ZaDistributionList.A2_memberPool)[0].widget.getList();
if(e!=null){
return(e.size()>0)
}
return false
};
ZaDLXFormView.getMemberPoolSelection=function(){
var e=this.getItemsById(ZaDistributionList.A2_memberPool)[0];
var t=null;
if(e){
var t=e.getSelection()
}
if(t){
return t
}else{
return[]
}};
ZaDLXFormView.shouldEnableMemberPoolListButtons=function(){
return(ZaDLXFormView.getMemberPoolSelection.call(this).length>0)
};
ZaDLXFormView.shouldEnableFreeFormButtons=function(){
var e=this.getInstance().optionalAdd;
return(e&&e.length>0)
};
ZaDLXFormView.shouldEnablePoolForwardButton=function(){
return(this.getInstanceValue(ZaDistributionList.A2_poolPagenum)<this.getInstanceValue(ZaDistributionList.A2_poolNumPages))
};
ZaDLXFormView.shouldEnablePoolBackButton=function(){
return(this.getInstanceValue(ZaDistributionList.A2_poolPagenum)>1)
};
ZaDLXFormView.shouldEnableMemForwardButton=function(){
return(this.getInstanceValue(ZaDistributionList.A2_memPagenum)<this.getInstanceValue(ZaDistributionList.A2_memNumPages))
};
ZaDLXFormView.shouldEnableMemBackButton=function(){
return(this.getInstanceValue(ZaDistributionList.A2_memPagenum)>1)
};
ZaDLXFormView.addMemberListToPage=function(o,c,l){
if(!o||AjxUtil.isEmpty(c)){
return null
}
if(!l){
l=(o.getInstanceValue(ZaDistributionList.A2_memPagenum)||1)
}
var t=o.getInstanceValue(ZaDistributionList.A2_allMemberPages)||[];
if(t==null){
return null
}
--l;
if(t[l]==null){
t[l]=[]
}
var n=o.getInstanceValue(ZaDistributionList.A2_allMemberHash)||{};
var h=t[l];
for(var r=0;
r<c.length;
r++){
var s=c[r];
if(!s||!s[ZaAccount.A_name]){
continue
}
var e=s[ZaAccount.A_name];
if(e&&n[e]==null){
h.push(s);
n[e]=s
}}
o.setInstanceValue(t,ZaDistributionList.A2_allMemberPages);
o.setInstanceValue(n,ZaDistributionList.A2_allMemberHash);
return h
};
ZaDLXFormView.excludeAddressesInAllMembers=function(r,s){
if(!r||AjxUtil.isEmpty(s)){
return null
}
var n=[];
var e=[];
var h=r.getInstanceValue(ZaDistributionList.A2_allMemberHash)||{};
for(var o=0;
o<s.length;
o++){
var l=s[o];
if(!l||!l[ZaAccount.A_name]){
continue
}
var t=l[ZaAccount.A_name];
if(t&&h[t]==null){
n.push(l)
}else{
e.push(t)
}}
return[e,n]
};
ZaDLXFormView.addAddressesToMembers=function(e,y){
var w=ZaDLXFormView.excludeAddressesInAllMembers(e,y);
var c=w[0],r=w[1];
if(c.length>0){
var u=c.join("<br>");
var s=AjxMessageFormat.format(ZaMsg.DLXV_MsgMemberExisted,[u]);
if(r.length>0){
var d=r.join("<br>");
s+=("<br><br>");
s+=AjxMessageFormat.format(ZaMsg.DLXV_MsgMemberCanBeAdded,[d])
}
ZaApp.getInstance().getCurrentController().popupMsgDialog(s)
}
if(r.length<=0){
return
}
var o=e.getInstanceValue(ZaDistributionList.A2_memberList);
var n=ZaDLXFormView.addMemberListToPage(e,r);
if(!n||!n.length){
return
}
n._version=(o._version||0)+1;
e.setInstanceValue(n,ZaDistributionList.A2_memberList);
var f=e.getInstanceValue(ZaDistributionList.A2_removeList)||[];
f=f.sort(ZaDistributionList.compareTwoMembers);
r=r.sort(ZaDistributionList.compareTwoMembers);
var b=[],h=[];
var g=0,p=0;
while(g<f.length&&p<r.length){
var m=f[g];
var k=r[p];
var x=k[ZaAccount.A_name];
var l=ZaDistributionList.compareTwoMembers(m,k);
if(l>0){
b.push(k);
p++
}else{
if(l<0){
h.push(m);
g++
}else{
g++;
p++
}}}
for(;
g<f.length;
g++){
h.push(f[g])
}
if(h.length<f.length){
h._version=(f._version||0)+1;
e.setInstanceValue(h,ZaDistributionList.A2_removeList)
}
for(;
p<r.length;
p++){
b.push(r[p])
}
var v=e.getInstanceValue(ZaDistributionList.A2_addList)||[];
for(p=0;
p<v.length;
p++){
b.push(v[p])
}
b._version=(v._version||0)+1;
e.setInstanceValue(b,ZaDistributionList.A2_addList);
var t=e.getInstanceValue(ZaDistributionList.A2_numMembers)||0;
t+=(r.length);
e.setInstanceValue(t,ZaDistributionList.A2_numMembers);
e.parent.setDirty(true)
};
ZaDLXFormView.addSelectedAddressesToMembers=function(o){
var t=this.getForm();
var e=t.getInstanceValue(ZaDistributionList.A2_memberPoolSelected);
if(AjxUtil.isEmpty(e)){
return
}
ZaDLXFormView.addAddressesToMembers(t,e)
};
ZaDLXFormView.addOnePageAddressesToMembers=function(o){
var t=this.getForm();
var e=t.getInstanceValue(ZaDistributionList.A2_memberPool);
if(AjxUtil.isEmpty(e)){
return
}
ZaDLXFormView.addAddressesToMembers(t,e)
};
ZaDLXFormView.addFreeFormAddressToMembers=function(e){
var t=this.getForm();
var h=t.getInstanceValue(ZaDistributionList.A2_optionalAdd);
if(AjxUtil.isEmpty(h)){
return
}
var h=h.split(/[\r\n,;]+/);
var n=[];
var s=/([^\<\;]*)\<([^\>]+)\>/;
for(var r=0;
r<h.length;
r++){
var l=AjxStringUtil.trim(h[r],true);
if(l){
var c=s.exec(l);
if(c!=null){
l=c[2]
}
if(!AjxEmailAddress.isValid(l)){
var o=AjxMessageFormat.format(ZaMsg.WARNING_DL_INVALID_EMAIL,[l]);
ZaApp.getInstance().getCurrentController().popupErrorDialog(o,null,DwtMessageDialog.WARNING_STYLE);
return
}
n.push(new ZaDistributionListMember(l))
}}
ZaDLXFormView.addAddressesToMembers(t,n);
this.setInstanceValue("",ZaDistributionList.A2_optionalAdd)
};
ZaDLXFormView._copyAttrFromEntry=function(t,n,r){
if(!t||!n||!r){
return
}
for(var o in r.attrs){
var s=t.getModel().getItem(o);
var e=r.attrs[o];
if((s!=null&&s.type==_LIST_)||(e!=null&&e instanceof Array)){
n.attrs[o]=ZaItem.deepCloneListItem(e)
}else{
n.attrs[o]=e
}}
if(r.setAttrs){
n.setAttrs=r.setAttrs
}
if(r.getAttrs){
n.getAttrs=r.getAttrs
}
if(r.rights){
n.rights=r.rights
}
if(r._defaultValues){
n._defaultValues=r._defaultValues
}};
ZaDLXFormView.prototype.setObject=function(e){
this._containedObject=new ZaDistributionList();
this._containedObject.attrs=new Object();
ZaDLXFormView._copyAttrFromEntry(this._localXForm,this._containedObject,e);
this._containedObject[ZaDistributionList.A2_addList]=new Array();
this._containedObject[ZaDistributionList.A2_addList]._version=1;
this._containedObject[ZaDistributionList.A2_removeList]=new Array();
this._containedObject[ZaDistributionList.A2_removeList]._version=1;
this._containedObject[ZaDistributionList.A2_memberPool]=e[ZaDistributionList.A2_memberPool]||[];
this._containedObject[ZaDistributionList.A2_memberPool]._version=1;
this._containedObject[ZaDistributionList.A2_poolPagenum]=this._containedObject[ZaDistributionList.A2_poolPagenum]||1;
this._containedObject[ZaDistributionList.A2_poolNumPages]=e[ZaDistributionList.A2_poolNumPages]||1;
this._containedObject[ZaDistributionList.A2_totalNumInPool]=e[ZaDistributionList.A2_totalNumInPool]||-1;
this._containedObject[ZaDistributionList.A2_query]="";
this._containedObject.name=e.name;
if(e.name==""){
this._containedObject.name=ZaMsg.TBB_New
}
this._containedObject.type=e.type;
this._containedObject.id=e.id;
if(!e[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=e[ZaModel.currentTab]
}
if(!e.id){
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraIsDelegatedAdminAccount,e)){
this._containedObject.attrs[ZaDistributionList.A_mailStatus]="enabled"
}}
this.modifyContainedObject();
this._localXForm.setInstance(this._containedObject)
};
ZaDLXFormView.prototype.srchResWithoutSelf=function(s,e){
var o=new Array();
var t=s.getArray();
for(var n=0;
n<t.length;
n++){
if(t[n].type==ZaItem.DL&&t[n]==e){
continue
}else{
if(t[n].type==ZaItem.ALIAS&&t[n].getAliasTargetObj()==e){
continue
}else{
o.push(t[n])
}}}
return o
};
ZaDLXFormView.prototype.searchAccounts=function(s,n){
var t=ZaDistributionList.MEMBER_POOL_PAGE_SIZE;
var o=this._containedObject[ZaDistributionList.A2_poolPagenum];
var e=ZaDLXFormView.getMatchedAccounts.call(this,s,n,o,t);
this._containedObject[ZaDistributionList.A2_memberPool]=e.list;
this._containedObject[ZaDistributionList.A2_poolNumPages]=e.numPages;
this._containedObject[ZaDistributionList.A2_totalNumInPool]=e.searchTotal||0;
this._localXForm.setInstance(this._containedObject)
};
ZaDLXFormView.prototype.getAllMatchedAccounts=function(){
var t=0;
var o=1;
var e=ZaDLXFormView.getMatchedAccounts.call(this,ZaAccount.A_name,true,o,t);
return e.list
};
ZaDLXFormView.getMatchedAccounts=function(c,n,t,r){
c=(c!=null)?c:ZaAccount.A_name;
n=!!n;
r=(r>=0)?r:ZaDistributionList.MEMBER_POOL_PAGE_SIZE;
t=(t>=0)?t:this._containedObject[ZaDistributionList.A2_poolPagenum];
var d={};
try{
var h=[ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.ALIASES];
var e=ZaSearch.getSearchByNameQuery(this._containedObject[ZaDistributionList.A2_query],h,true);
var s=this._containedObject[ZaAccount.A_name];
e=ZaDLXFormView.makeQueryStringWithoutSelf(e,s);
var o=new ZaSearchQuery(e,h,false,"",null,r);
d=ZaSearch.searchByQueryHolder(o,t,c,n);
if(d.list){
d.list=d.list.getArray()
}else{
d.list=[];
d.numPages=0;
d.searchTotal=0
}}
catch(l){
if(l.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
ZaApp.getInstance().getCurrentController()._handleException(l,"ZaDLXFormView.prototype.searchAccounts",null,false)
}else{
this.popupErrorDialog(ZaMsg.queryParseError,l);
this._searchField.setEnabled(true)
}}
return d
};
ZaDLXFormView._makeAddressExcluded=function(e){
if(AjxUtil.isEmpty(e)){
return""
}
return("(!(mail="+e+"))(!(zimbraMailAddress="+e+"))(!(zimbraMailDeliveryAddress="+e+"))(!(zimbraMailForwardingAddress="+e+"))(!(zimbraMemberOf="+e+"))")
};
ZaDLXFormView.makeQueryStringWithoutSelf=function(t,e){
if(t==null){
t=""
}
if(!e||!e.length){
return t
}
var o=ZaDLXFormView._makeAddressExcluded(e);
o=o?"(&"+t+"(&"+o+"))":t;
return o
};
ZaDLXFormView.aliasSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaDLXFormView.editAliasButtonListener.call(this)
}};
ZaDLXFormView.deleteAliasButtonListener=function(){
var e=this.getInstance();
if(e[ZaDistributionList.A2_alias_selection_cache]!=null){
var s=e[ZaDistributionList.A2_alias_selection_cache].length;
if(s&&e.attrs[ZaAccount.A_zimbraMailAlias]){
var o=e.attrs[ZaAccount.A_zimbraMailAlias];
for(var n=0;
n<s;
n++){
var r=o.length-1;
for(var t=r;
t>=0;
t--){
if(o[t]==e[ZaDistributionList.A2_alias_selection_cache][n]){
o.splice(t,1);
break
}}}
this.getModel().setInstanceValue(e,ZaAccount.A_zimbraMailAlias,o)
}}
this.getModel().setInstanceValue(e,ZaDistributionList.A2_alias_selection_cache,[]);
this.getForm().parent.setDirty(true)
};
ZaDLXFormView.editAliasButtonListener=function(){
var e=this.getInstance();
if(e.alias_selection_cache&&e.alias_selection_cache[0]){
var s=this.getForm().parent;
if(!s.editAliasDlg){
s.editAliasDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Edit_Alias_Title);
s.editAliasDlg.registerCallback(DwtDialog.OK_BUTTON,ZaDLXFormView.updateAlias,this.getForm(),null)
}
var n={};
n[ZaAccount.A_name]=e[ZaDistributionList.A2_alias_selection_cache][0];
var o=e.attrs[ZaAccount.A_zimbraMailAlias].length;
for(var t=0;
t<o;
t++){
if(e[ZaDistributionList.A2_alias_selection_cache][0]==e.attrs[ZaAccount.A_zimbraMailAlias][t]){
n[ZaAlias.A_index]=t;
break
}}
s.editAliasDlg.setObject(n);
s.editAliasDlg.popup()
}};
ZaDLXFormView.updateAlias=function(){
if(this.parent.editAliasDlg){
this.parent.editAliasDlg.popdown();
var o=this.parent.editAliasDlg.getObject();
var t=this.getInstance();
var e=t.attrs[ZaAccount.A_zimbraMailAlias];
if(o[ZaAlias.A_index]>=0&&e[o[ZaAlias.A_index]]!=o[ZaAccount.A_name]){
e[o[ZaAlias.A_index]]=o[ZaAccount.A_name];
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraMailAlias,e);
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,new Array());
this.parent.setDirty(true)
}}};
ZaDLXFormView.addAliasButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addAliasDlg){
o.addAliasDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Add_Alias_Title);
o.addAliasDlg.registerCallback(DwtDialog.OK_BUTTON,ZaDLXFormView.addAlias,this.getForm(),null)
}
var t={};
t[ZaAccount.A_name]="";
t[ZaAlias.A_index]=-1;
o.addAliasDlg.setObject(t);
o.addAliasDlg.popup()
};
ZaDLXFormView.addAlias=function(){
if(this.parent.addAliasDlg){
this.parent.addAliasDlg.popdown();
var o=this.parent.addAliasDlg.getObject();
if(o[ZaAccount.A_name]&&o[ZaAccount.A_name].length>1){
var t=this.getInstance();
var e=t.attrs[ZaAccount.A_zimbraMailAlias];
e.push(o[ZaAccount.A_name]);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraMailAlias,e);
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,new Array());
this.parent.setDirty(true)
}}};
ZaDLXFormView.isEditAliasEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_alias_selection_cache))&&this.getInstanceValue(ZaAccount.A2_alias_selection_cache).length==1)
};
ZaDLXFormView.isDeleteAliasEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_alias_selection_cache)))
};
ZaDLXFormView.ownerSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_owners_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_owners_selection_cache,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaDLXFormView.editOwnerButtonListener.call(this)
}};
ZaDLXFormView.deleteOwnerButtonListener=function(){
var e=this.getInstance();
if(e[ZaDistributionList.A2_owners_selection_cache]!=null){
var s=e[ZaDistributionList.A2_owners_selection_cache].length;
if(s&&e[ZaDistributionList.A2_DLOwners]){
var o=e[ZaDistributionList.A2_DLOwners];
for(var n=0;
n<s;
n++){
var r=o.length-1;
for(var t=r;
t>=0;
t--){
if(o[t]==e[ZaDistributionList.A2_owners_selection_cache][n]){
o.splice(t,1);
break
}}}
this.getModel().setInstanceValue(e,ZaDistributionList.A2_DLOwners,o)
}}
this.getModel().setInstanceValue(e,ZaDistributionList.A2_owners_selection_cache,[]);
this.getForm().parent.setDirty(true)
};
ZaDLXFormView.editOwnerButtonListener=function(){
var e=this.getInstance();
if(e[ZaDistributionList.A2_owners_selection_cache]&&e[ZaDistributionList.A2_owners_selection_cache][0]){
var s=this.getForm().parent;
if(!s.editOwnerDlg){
s.editOwnerDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"450px","150px",ZaMsg.Edit_Owner_Title);
s.editOwnerDlg.registerCallback(DwtDialog.OK_BUTTON,ZaDLXFormView.updateOwner,this.getForm(),null)
}
var n={};
n[ZaAccount.A_name]=e[ZaDistributionList.A2_owners_selection_cache][0];
var o=e[ZaDistributionList.A2_DLOwners].length;
for(var t=0;
t<o;
t++){
if(e[ZaDistributionList.A2_owners_selection_cache][0]==e[ZaDistributionList.A2_DLOwners][t]){
n[ZaAlias.A_index]=t;
break
}}
s.editOwnerDlg.setObject(n);
s.editOwnerDlg.popup()
}};
ZaDLXFormView.updateOwner=function(){
if(this.parent.editOwnerDlg){
this.parent.editOwnerDlg.popdown();
var o=this.parent.editOwnerDlg.getObject();
var t=this.getInstance();
var e=t[ZaDistributionList.A2_DLOwners];
if(o[ZaAlias.A_index]>=0&&e[o[ZaAlias.A_index]]!=o[ZaAccount.A_name]){
if(!ZaDLXFormView.checkOwner(o[ZaAccount.A_name])){
return
}
e[o[ZaAlias.A_index]]=o[ZaAccount.A_name];
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_DLOwners,e);
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_owners_selection_cache,new Array());
this.parent.setDirty(true)
}}};
ZaDLXFormView.addOwnerButtonListener=function(){
var t=this.getForm().parent;
if(!t.addOwnerDlg){
t.addOwnerDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"450px","150px",ZaMsg.Add_Owner_Title);
t.addOwnerDlg.registerCallback(DwtDialog.OK_BUTTON,ZaDLXFormView.addOwner,this.getForm(),null)
}
var e={};
e[ZaAccount.A_name]="";
e[ZaAlias.A_index]=-1;
t.addOwnerDlg.setObject(e);
t.addOwnerDlg.popup()
};
ZaDLXFormView.addOwner=function(){
if(this.parent.addOwnerDlg){
this.parent.addOwnerDlg.popdown();
var o=this.parent.addOwnerDlg.getObject();
if(o[ZaAccount.A_name]&&o[ZaAccount.A_name].length>1){
if(!ZaDLXFormView.checkOwner(o[ZaAccount.A_name])){
return
}
var t=this.getInstance();
var e=t[ZaDistributionList.A2_DLOwners];
e.push(o[ZaAccount.A_name]);
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_DLOwners,e);
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_owners_selection_cache,new Array());
this.parent.setDirty(true)
}}};
ZaDLXFormView.checkOwner=function(t){
var e=false;
try{
e=ZaSearch.isAccountExist({
name:t,popupError:false}
)
}
catch(o){}
if(!e){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_NO_SUCH_ACCOUNT)
}
return e
};
ZaDLXFormView.isEditOwnerEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_owners_selection_cache))&&this.getInstanceValue(ZaDistributionList.A2_owners_selection_cache).length==1)
};
ZaDLXFormView.isDeleteOwnerEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_owners_selection_cache)))
};
ZaDLXFormView.isDynamicDL=function(){
return this.getInstanceValue(ZaDistributionList.A2_dlType)===ZaDistributionList.DYNAMIC_DL_TYPE
};
ZaDLXFormView.isNotDynamicDL=function(){
return !ZaDLXFormView.isDynamicDL.call(this)
};
ZaDLXFormView.isNotACLGroup=function(){
return this.getInstanceValue(ZaDistributionList.A_zimbraIsACLGroup)==="FALSE"
};
ZaDLXFormView.isACLGroup=function(){
return !ZaDLXFormView.isNotACLGroup.call(this)
};
ZaDLXFormView.NOTES_TAB_ATTRS=[ZaAccount.A_notes];
ZaDLXFormView.NOTES_TAB_RIGHTS=[];
ZaDLXFormView.MEMBEROF_TAB_ATTRS=[];
ZaDLXFormView.MEMBEROF_TAB_RIGHTS=[ZaDistributionList.GET_DL_MEMBERSHIP_RIGHT];
ZaDLXFormView.ALIASES_TAB_ATTRS=[ZaAccount.A_zimbraMailAlias];
ZaDLXFormView.ALIASES_TAB_RIGHTS=[ZaDistributionList.ADD_DL_ALIAS_RIGHT,ZaDistributionList.REMOVE_DL_ALIAS_RIGHT];
ZaDLXFormView.OWNER_TAB_ATTRS=[];
ZaDLXFormView.OWNER_TAB_RIGHTS=[];
ZaDLXFormView.PREF_TAB_ATTRS=[ZaDistributionList.A_zimbraPrefReplyToEnabled,ZaDistributionList.A_zimbraPrefReplyToDisplay,ZaDistributionList.A_zimbraPrefReplyToAddress];
ZaDLXFormView.PREF_TAB_RIGHTS=[];
ZaDLXFormView.myXFormModifier=function(T,t){
var f=new Array();
var o=1;
f[0]=new ZaListHeaderItem("type",ZaMsg.ALV_Type_col,null,"34px",null,"objectClass",true,true);
f[1]=new ZaListHeaderItem(ZaAccount.A_name,ZaMsg.ALV_Name_col,null,"200px",o++,ZaAccount.A_name,true,true);
f[2]=new ZaListHeaderItem(ZaAccount.A_displayname,ZaMsg.ALV_DspName_col,null,null,o++,ZaAccount.A_displayname,true,true);
var p=new Array();
p[0]=new ZaListHeaderItem(ZaAccount.A_name,ZaMsg.ALV_Name_col,null,"100%",o++,ZaAccount.A_name,true,true);
var C=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.DIRECT);
var x=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.INDIRECT);
var b=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.NON);
this.tabChoices=new Array();
this.helpMap={};
var F,S,D,W,A,O;
F=++this.TAB_INDEX;
this.tabChoices.push({
value:F,label:ZaMsg.DLXV_TabMembers}
);
this.helpMap[F]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/distribution_lists.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
if(ZaTabView.isTAB_ENABLED(t,ZaDLXFormView.NOTES_TAB_ATTRS,ZaDLXFormView.NOTES_TAB_RIGHTS)){
S=++this.TAB_INDEX;
this.tabChoices.push({
value:S,label:ZaMsg.DLXV_TabProperties}
);
this.helpMap[S]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/distribution_lists.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaDLXFormView.MEMBEROF_TAB_ATTRS,ZaDLXFormView.MEMBEROF_TAB_RIGHTS)&&(!t.dynamic)){
D=++this.TAB_INDEX;
this.tabChoices.push({
value:D,label:ZaMsg.TABT_MemberOf}
);
this.helpMap[D]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/distribution_lists.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaDLXFormView.ALIASES_TAB_ATTRS,ZaDLXFormView.ALIASES_TAB_RIGHTS)){
W=++this.TAB_INDEX;
this.tabChoices.push({
value:W,label:ZaMsg.TABT_Aliases}
);
this.helpMap[W]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/distribution_lists.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaDLXFormView.OWNER_TAB_ATTRS,ZaDLXFormView.OWNER_TAB_RIGHTS)){
A=++this.TAB_INDEX;
this.tabChoices.push({
value:A,label:ZaMsg.TABT_Owners}
);
this.helpMap[A]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/distribution_lists.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
if(ZaTabView.isTAB_ENABLED(t,ZaDLXFormView.PREF_TAB_ATTRS,ZaDLXFormView.PREF_TAB_RIGHTS)){
O=++this.TAB_INDEX;
this.tabChoices.push({
value:O,label:ZaMsg.TABT_Preferences}
);
this.helpMap[O]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/distribution_lists.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("")
}
T.tableCssStyle="width:100%;overflow:auto;";
T.numCols=5;
T.colSizes=[10,"auto",20,"auto",10];
T.itemDefaults={
_INPUT_:{
cssClass:"inputBorder"}
,_TEXTAREA_:{
cssClass:"inputBorder"}
,_TEXTFIELD_:{
cssClass:"inputBorder",containerCssStyle:"width:100%"}};
var e=[];
var B,M,z,j,m,k;
if(AjxEnv.isWebKitBased||AjxEnv.isFirefox){
B=30;
M=310;
z="99%";
j=342;
m="99%"
}else{
B=25;
M=308;
z="100%";
j=338;
m="100%"
}
k="100%";
var y={
type:_ZATABCASE_,caseKey:F,numCols:2,id:"dl_form_members",colSizes:["440px","440px"],cssStyle:"table-layout:fixed; padding-top:5px;",items:[{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"98%",id:"dl_form_members_general_group",numCols:2,colSizes:[130,"*"],items:[{
ref:ZaAccount.A_name,type:_EMAILADDR_,msgName:ZaMsg.MSG_LabelListName,label:ZaMsg.LBL_LabelListName,forceUpdate:true,tableCssStyle:"width:100%",inputWidth:"100",domainPartWidth:"100%",id:"dl_name_field",nameContainerCss:"width:100px",domainContainerWidth:"100%",midContainerCss:"width:20px",visibilityChecks:[],enableDisableChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.RENAME_DL_RIGHT]]}
,{
type:_SPACER_,height:"3"}
,{
ref:ZaAccount.A_displayname,type:_TEXTFIELD_,label:ZaMsg.NAD_DisplayName,msgName:ZaMsg.NAD_DisplayName,align:_LEFT_,cssClass:"admin_xform_name_input",width:"100%"}
,{
type:_SPACER_,height:"3"}
,{
ref:"description",msgName:ZaMsg.NAD_Description,label:ZaMsg.NAD_Description,labelLocation:_LEFT_,align:_LEFT_,type:_TEXTAREA_,enableDisableChecks:[ZaItem.hasWritePermission],visibilityChecks:[ZaItem.hasReadPermission],cssClass:"admin_xform_name_input",width:"100%",height:"100"}
]}
,{
type:_SPACER_,height:"20"}
,{
type:_GROUPER_,borderCssClass:"LeftGrouperBorder",width:"100%",numCols:1,colSizes:["auto"],label:ZaMsg.DLXV_LabelListMembers,items:[{
type:_GROUP_,width:"100%",height:B,numCols:3,colSizes:["*","20px","104px"],items:[{
type:_OUTPUT_,ref:ZaDistributionList.A2_numMembers,align:_LEFT_,valueChangeEventSources:[ZaDistributionList.A2_numMembers,ZaDistributionList.A2_memNumPages],getDisplayValue:ZaDLXFormView.showMembersNum}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,width:"100%",numCols:3,colSizes:["32px","40px","32px"],visibilityChangeEventSources:[ZaDistributionList.A2_memNumPages],visibilityChecks:[[ZaDLXFormView.isMoreThanOnePage,ZaDistributionList.A2_memNumPages]],items:[{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,width:"100%",id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnableMemBackButton],enableDisableChangeEventSources:[ZaDistributionList.A2_memberList,ZaDistributionList.A2_memNumPages,ZaDistributionList.A2_memPagenum],onActivate:"ZaDLXFormView.backMemButtonHndlr.call(this,event)"}
,{
type:_OUTPUT_,ref:ZaDistributionList.A2_memPagenum,valueChangeEventSources:[ZaDistributionList.A2_memPagenum,ZaDistributionList.A2_memNumPages],align:_CENTER_,getDisplayValue:ZaDLXFormView.showMembersPaging}
,{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,width:"100%",id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnableMemForwardButton],enableDisableChangeEventSources:[ZaDistributionList.A2_memberList,ZaDistributionList.A2_memNumPages,ZaDistributionList.A2_memPagenum],onActivate:"ZaDLXFormView.fwdMemButtonHndlr.call(this,event)"}
]}
]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaDistributionList.A2_memberList,type:_DWT_LIST_,height:M,width:z,cssClass:"DLTarget",cssStyle:"margin-left: 5px; ",widgetClass:ZaAccMiniListView,headerList:p,hideHeader:true,onSelection:ZaDLXFormView.membersSelectionListener,bmolsnr:true}
,{
type:_SPACER_,height:"8"}
,{
type:_GROUP_,width:"99%",numCols:3,colSizes:["45%","10%","45%"],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemoveSelected,id:"removeButton",onActivate:"ZaDLXFormView.removeSelectedMembers.call(this,event)",nowrap:true,cssStyle:"padding:0px;",enableDisableChangeEventSources:[ZaDistributionList.A2_membersSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_membersSelected],[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_MEMBER_RIGHT]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemovePage,nowrap:true,cssStyle:"padding:0px;",visibilityChangeEventSources:[ZaDistributionList.A2_numMembers],visibilityChecks:[[XForm.checkInstanceValueNot,ZaDistributionList.A2_numMembers,0]],enableDisableChangeEventSources:[ZaDistributionList.A2_memberList],enableDisableChecks:[ZaDLXFormView.shouldEnableRemoveThisPageButton,[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_MEMBER_RIGHT]],onActivate:"ZaDLXFormView.removeOnePageMembers.call(this,event)"}
]}
]}
]}
,{
type:_ZARIGHT_GROUPER_,numCols:1,width:k,label:ZaMsg.DLXV_GroupLabelAddMembers,items:[{
type:_GROUP_,width:"100%",numCols:3,colSizes:["*","10px","104px"],items:[{
type:_GROUP_,width:"100%",items:[{
type:_TEXTFIELD_,cssClass:"admin_xform_name_input",ref:ZaSearch.A_query,label:ZaMsg.DLXV_LabelFind,labelLocation:_LEFT_,labelCssStyle:"white-space: nowrap;",visibilityChecks:[],enableDisableChecks:[],width:"100%",align:_LEFT_,elementChanged:function(E,Y,I){
var H=I.charCode;
if(H==13||H==3){
ZaDLXFormView.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,E,I)
}}}
]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,onActivate:ZaDLXFormView.srchButtonHndlr}
]}
,{
type:_SPACER_,height:"5",colSpan:"*"}
,{
type:_GROUP_,width:"100%",numCols:3,colSizes:["*","10px","104px"],items:[{
type:_GROUP_,items:[{
type:_OUTPUT_,ref:ZaDistributionList.A2_totalNumInPool,align:_LEFT_,visibilityChecks:[[ZaDLXFormView.checkTotalNumInPool,-1]],getDisplayValue:ZaDLXFormView.showSearchFoundNum,nowrap:false}
]}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,visibilityChangeEventSources:[ZaDistributionList.A2_poolNumPages],visibilityChecks:[[ZaDLXFormView.isMoreThanOnePage,ZaDistributionList.A2_poolNumPages]],numCols:3,colSizes:["32px","40px","32px"],items:[{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnablePoolBackButton],enableDisableChangeEventSources:[ZaDistributionList.A2_poolPagenum],onActivate:"ZaDLXFormView.backPoolButtonHndlr.call(this,event)"}
,{
type:_OUTPUT_,ref:ZaDistributionList.A2_poolPagenum,align:_CENTER_,getDisplayValue:ZaDLXFormView.showSearchFoundPaging}
,{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnablePoolForwardButton],enableDisableChangeEventSources:[ZaDistributionList.A2_poolPagenum],onActivate:"ZaDLXFormView.fwdPoolButtonHndlr.call(this,event)"}
]}
]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaDistributionList.A2_memberPool,type:_DWT_LIST_,height:j,width:m,cssClass:"DLSource",forceUpdate:true,widgetClass:ZaAccMiniListView,headerList:f,hideHeader:false,onSelection:ZaDLXFormView.memberPoolSelectionListener}
,{
type:_SPACER_,height:"5",colSpan:"*"}
,{
type:_GROUP_,width:k,items:[{
type:_GROUP_,width:"99%",numCols:3,colSizes:["45%","10%","45%"],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddSelected,nowrap:true,onActivate:"ZaDLXFormView.addSelectedAddressesToMembers.call(this,event)",enableDisableChangeEventSources:[ZaDistributionList.A2_memberPoolSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_memberPoolSelected],[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddPage,nowrap:true,onActivate:"ZaDLXFormView.addOnePageAddressesToMembers.call(this,event)",visibilityChangeEventSources:[ZaDistributionList.A2_totalNumInPool],visibilityChecks:[[ZaDLXFormView.checkTotalNumInPool,1]],enableDisableChangeEventSources:[ZaDistributionList.A2_memberPool],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_memberPool],[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
]}
,{
type:_SPACER_}
]}
,{
type:_SPACER_,height:"5"}
,{
type:_OUTPUT_,value:ZaMsg.DLXV_GroupLabelEnterAddressBelow,visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaDistributionList.A2_optionalAdd,type:_TEXTAREA_,width:k,height:98,bmolsnr:true,visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]],enableDisableChecks:[]}
,{
type:_SPACER_,height:"5",visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
,{
type:_GROUP_,numCols:2,width:k,colSizes:[80,"auto"],visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddFromFreeForm,width:"100%",onActivate:"ZaDLXFormView.addFreeFormAddressToMembers.call(this,event)",enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_optionalAdd]],enableDisableChangeEventSources:[ZaDistributionList.A2_optionalAdd]}
,{
type:_OUTPUT_,value:ZaMsg.DLXV_SeparateAddresses,align:"right"}
]}
]}
,{
type:_CELLSPACER_}
]};
e.push(y);
if(S){
var g={
type:_ZATABCASE_,caseKey:S,id:"dl_form_properties",colSizes:[10,"auto"],colSpan:"*",paddingStyle:"padding-left:15px;",cellpadding:2,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.DLXV_LabelProperties,id:"dl_properties",colSpan:"*",numCols:2,colSizes:[275,"*"],visibilityChangeEventSources:[],items:[{
type:_INPUT_,ref:ZaDistributionList.A_memberOfURL,label:ZaMsg.LBL_Member_URL,labelLocation:_LEFT_,labelCssClass:"xform_label",width:"100%",visibilityChecks:[[ZaDLXFormView.isDynamicDL],[ZaDLXFormView.isNotACLGroup]]}
,{
type:_OUTPUT_,ref:ZaDistributionList.A_memberOfURL,label:ZaMsg.LBL_Member_URL,labelLocation:_LEFT_,labelCssClass:"xform_label",visibilityChecks:[[ZaDLXFormView.isDynamicDL],[ZaDLXFormView.isACLGroup]]}
,{
ref:ZaDistributionList.A2_dlType,type:_WIZ_CHECKBOX_,trueValue:ZaDistributionList.DYNAMIC_DL_TYPE,falseValue:ZaDistributionList.STATIC_DL_TYPE,label:ZaMsg.LBL_DL_Type,labelLocation:_LEFT_,labelCssClass:"xform_label",labelWrap:true,align:_LEFT_,nowrap:false,msgName:ZaMsg.LBL_DL_Type,subLabel:"",visibilityChecks:[],enableDisableChecks:false}
,{
ref:ZaDistributionList.A_zimbraIsACLGroup,type:_WIZ_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.LBL_ACL_Group,labelLocation:_LEFT_,labelCssClass:"xform_label",align:_LEFT_,subLabel:"",visibilityChecks:[ZaDLXFormView.isDynamicDL],enableDisableChecks:false}
,{
ref:ZaAccount.A_zimbraHideInGal,type:_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.LBL_zimbraHideInGal,labelLocation:_LEFT_,labelCssClass:"xform_label",labelWrap:true,align:_LEFT_,nowrap:false,msgName:ZaMsg.LBL_zimbraHideInGal,cssStyle:"padding-left:0px"}
,{
ref:"zimbraMailStatus",type:_CHECKBOX_,trueValue:"enabled",falseValue:"disabled",align:_LEFT_,nowrap:false,labelWrap:true,label:ZaMsg.DLXV_LabelEnabled,msgName:ZaMsg.DLXV_LabelEnabled,labelLocation:_LEFT_,labelCssClass:"xform_label",cssStyle:"padding-left:0px"}
,{
type:_GROUP_,numCols:2,label:ZaMsg.DLXV_SubscriptionRequest,labelLocation:_LEFT_,items:[{
ref:ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,type:_RADIO_,groupname:"subscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyAccept,label:ZaMsg.DLXV_SubscriptionPolicyAccept,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept)
}
,elementChanged:function(Y,I,H){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept,H)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,type:_RADIO_,groupname:"subscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyApproval,label:ZaMsg.DLXV_SubscriptionPolicyApproval,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval)
}
,elementChanged:function(Y,I,H){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval,H)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,type:_RADIO_,groupname:"subscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyReject,label:ZaMsg.DLXV_SubscriptionPolicyReject,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject)
}
,elementChanged:function(Y,I,H){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject,H)
}}
]}
,{
type:_GROUP_,numCols:2,label:ZaMsg.DLXV_UnsubscriptionRequest,labelLocation:_LEFT_,items:[{
ref:ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,type:_RADIO_,groupname:"unsubscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyAccept,label:ZaMsg.DLXV_SubscriptionPolicyAccept,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept)
}
,elementChanged:function(Y,I,H){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept,H)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,type:_RADIO_,groupname:"unsubscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyApproval,label:ZaMsg.DLXV_SubscriptionPolicyApproval,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval)
}
,elementChanged:function(Y,I,H){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval,H)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,type:_RADIO_,groupname:"unsubscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyReject,label:ZaMsg.DLXV_SubscriptionPolicyReject,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject)
}
,elementChanged:function(Y,I,H){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject,H)
}}
]}
,{
ref:ZaDistributionList.A_zimbraDistributionListSendShareMessageToNewMembers,type:_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,nowrap:false,labelWrap:true,label:ZaMsg.DL_zimbraDistributionListSendShareMessageToNewMembers,msgName:ZaMsg.DL_zimbraDistributionListSendShareMessageToNewMembers,labelLocation:_LEFT_,labelCssClass:"xform_label",cssStyle:"padding-left: 0px"}
,{
ref:ZaAccount.A_notes,type:_TEXTAREA_,label:ZaMsg.DLXV_LabelNotes,labelLocation:_LEFT_,width:"98%",height:"100",labelCssStyle:"vertical-align: top",cssStyle:"margin-left:5px"}
]}
]};
e.push(g)
}
if(D){
var R="7";
if(AjxEnv.isIE){
R="3"
}
var u={
type:_ZATABCASE_,numCols:2,colSpan:"*",caseKey:D,colSizes:["450px","420px"],items:[{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_SPACER_,height:"5"}
,{
type:_ZALEFT_GROUPER_,numCols:1,label:ZaMsg.Account_DirectGroupLabel,containerCssStyle:"padding-top:5px",width:"100%",items:[{
ref:ZaAccount.A2_directMemberList,type:_S_DWT_LIST_,width:"98%",height:200,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:C,defaultColumnSortable:0,onSelection:ZaDLXFormView.directMemberSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[65,10,65,55,75,10,65,10],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemoveAll,enableDisableChangeEventSources:[ZaDistributionList.A2_directMemberList],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_directMemberList]],onActivate:"ZaAccountMemberOfListView.removeAllGroups.call(this,event, ZaAccount.A2_directMemberList)"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemove,id:"removeButton",onActivate:"ZaAccountMemberOfListView.removeGroups.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChangeEventSources:[ZaDistributionList.A2_directMemberSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_directMemberSelected]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_offset"]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_more"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_directMemberList]]}
,{
type:_CELLSPACER_}
]}
]}
,{
type:_SPACER_,height:"10"}
,{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_IndirectGroupLabel,containerCssStyle:"padding-top:5px",items:[{
ref:ZaAccount.A2_indirectMemberList,type:_S_DWT_LIST_,width:"98%",height:200,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:x,defaultColumnSortable:0,onSelection:ZaDLXFormView.indirectMemberSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[65,10,65,55,75,10,65,10],items:[{
type:_CELLSPACER_}
,{
type:_CELLSPACER_}
,{
type:_CELLSPACER_}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,id:"indirectBackButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_offset"]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,id:"indirectFwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_more"]}
,{
type:_CELLSPACER_}
]}
]}
]}
,{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_SPACER_,height:"5"}
,{
type:_ZARIGHT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_NonGroupLabel,containerCssStyle:"padding-top:5px",items:[{
type:_GROUP_,numCols:3,width:"98%",items:[{
ref:"query",type:_TEXTFIELD_,width:"100%",cssClass:"admin_xform_name_input",nowrap:false,labelWrap:true,label:ZaMsg.DLXV_LabelFind,labelCssStyle:"white-space: nowrap;",visibilityChecks:[],enableDisableChecks:[],elementChanged:function(E,Y,I){
var H=I.charCode;
if(H==13||H==3){
ZaAccountMemberOfListView.prototype.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,E,I)
}}}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,width:80,onActivate:ZaAccountMemberOfListView.prototype.srchButtonHndlr}
,{
ref:ZaAccount.A2_showSameDomain,type:_CHECKBOX_,align:_RIGHT_,label:null,labelLocation:_NONE_,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[]}
,{
type:_OUTPUT_,value:ZaMsg.NAD_SearchSameDomain,colSpan:2}
]}
,{
type:_SPACER_,height:R}
,{
ref:ZaAccount.A2_nonMemberList,type:_S_DWT_LIST_,width:"98%",height:440,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:b,defaultColumnSortable:0,onSelection:ZaDLXFormView.nonmemberSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[55,10,65,10,65,10,55,10],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddFromList,onActivate:"ZaAccountMemberOfListView.addGroups.call(this,event, ZaAccount.A2_nonMemberList)",enableDisableChangeEventSources:[ZaDistributionList.A2_nonmembersSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_nonmembersSelected]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddAll,onActivate:"ZaAccountMemberOfListView.addAllGroups.call(this,event, ZaAccount.A2_nonMemberList)",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaAccount.A2_nonMemberList]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_offset"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_more"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_}
]}
]}
]}
]};
e.push(u)
}
if(W){
var q={
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",onActivate:"ZaDLXFormView.addAliasButtonListener.call(this);"};
if(t.id){
q.enableDisableChecks=[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_ALIAS_RIGHT]]
}else{
q.enableDisableChecks=[[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]]
}
var n={
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",enableDisableChangeEventSources:[ZaDistributionList.A2_alias_selection_cache],onActivate:"ZaDLXFormView.editAliasButtonListener.call(this);",id:"editAliasButton"};
if(t.id){
n.enableDisableChecks=[ZaDLXFormView.isEditAliasEnabled,[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_ALIAS_RIGHT],[XFormItem.prototype.hasRight,ZaAccount.ADD_DL_ALIAS_RIGHT]]
}else{
n.enableDisableChecks=[ZaDLXFormView.isEditAliasEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]]
}
var w={
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaDLXFormView.deleteAliasButtonListener.call(this);",id:"deleteAliasButton",enableDisableChangeEventSources:[ZaDistributionList.A2_alias_selection_cache]};
if(t.id){
w.enableDisableChecks=[ZaDLXFormView.isDeleteAliasEnabled,[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_ALIAS_RIGHT]]
}else{
w.enableDisableChecks=[ZaDLXFormView.isDeleteAliasEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]]
}
var d={
type:_ZATABCASE_,width:"100%",numCols:1,colSizes:["auto"],caseKey:W,items:[{
type:_SPACER_,height:"9"}
,{
type:_GROUPER_,borderCssClass:"LeftGrouperBorder",width:"100%",numCols:1,colSizes:["auto"],label:ZaMsg.NAD_EditDLAliasesGroup,items:[{
ref:ZaAccount.A_zimbraMailAlias,type:_DWT_LIST_,height:"200",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,onSelection:ZaDLXFormView.aliasSelectionListener}
,{
type:_GROUP_,numCols:6,colSizes:["100px","10px","100px","10px","100px","auto"],cssStyle:"margin:10px;padding-bottom:0;",items:[w,{
type:_CELLSPACER_}
,n,{
type:_CELLSPACER_}
,q]}
]}
]};
e.push(d)
}
if(A){
var h={
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",onActivate:"ZaDLXFormView.addOwnerButtonListener.call(this);"};
var s={
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",enableDisableChangeEventSources:[ZaDistributionList.A2_owners_selection_cache],enableDisableChecks:[ZaDLXFormView.isEditOwnerEnabled],onActivate:"ZaDLXFormView.editOwnerButtonListener.call(this);"};
var v={
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaDLXFormView.deleteOwnerButtonListener.call(this);",enableDisableChangeEventSources:[ZaDistributionList.A2_owners_selection_cache],enableDisableChecks:[ZaDLXFormView.isDeleteOwnerEnabled]};
var c={
type:_ZATABCASE_,width:"100%",numCols:1,colSizes:["auto"],caseKey:A,items:[{
type:_SPACER_,height:"9"}
,{
type:_GROUPER_,borderCssClass:"LeftGrouperBorder",width:"100%",numCols:1,colSizes:["auto"],label:ZaMsg.DLXV_GroupLabelDLOwners,items:[{
ref:ZaDistributionList.A2_DLOwners,type:_DWT_LIST_,height:"200",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,onSelection:ZaDLXFormView.ownerSelectionListener}
,{
type:_GROUP_,numCols:6,colSizes:["100px","10px","100px","10px","100px","auto"],cssStyle:"margin:10px;padding-bottom:0;",items:[v,{
type:_CELLSPACER_}
,s,{
type:_CELLSPACER_}
,h]}
]}
]};
e.push(c)
}
if(O){
var l={
type:_ZATABCASE_,caseKey:O,colSpan:"*",paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_MailOptionsReceiving,id:"dl_pref_replyto_group",colSpan:"*",numCols:2,colSizes:[275,"*"],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaDistributionList.A_zimbraPrefReplyToEnabled,ZaDistributionList.A_zimbraPrefReplyToDisplay,ZaDistributionList.A_zimbraPrefReplyToAddress]]],visibilityChangeEventSources:[],items:[{
ref:ZaDistributionList.A_zimbraPrefReplyToEnabled,type:_CHECKBOX_,visibilityChecks:[[ZaItem.hasReadPermission,ZaDistributionList.A_zimbraPrefReplyToEnabled]],label:ZaMsg.DLXV_ReplayToEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaDistributionList.A_zimbraPrefReplyToDisplay,type:_TEXTFIELD_,label:ZaMsg.DLXV_ReplayToAddrDisplay,labelLocation:_LEFT_,containerCssStyle:"padding-left:3px;",emptyText:ZaMsg.DLXV_ReplayToAddrEmptyText,visibilityChecks:[[ZaItem.hasReadPermission,ZaDistributionList.A_zimbraPrefReplyToDisplay]],enableDisableChecks:[[XForm.checkInstanceValue,ZaDistributionList.A_zimbraPrefReplyToEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaDistributionList.A_zimbraPrefReplyToAddress]],enableDisableChangeEventSources:[ZaDistributionList.A_zimbraPrefReplyToEnabled],width:"15em"}
,{
type:_DYNSELECT_,ref:ZaDistributionList.A_zimbraPrefReplyToAddress,dataFetcherClass:ZaSearch,dataFetcherMethod:ZaSearch.prototype.dynSelectSearch,dataFetcherTypes:[ZaSearch.ACCOUNTS,ZaSearch.RESOURCES,ZaSearch.DLS],dataFetcherAttrs:[ZaItem.A_zimbraId,ZaItem.A_cn,ZaAccount.A_name,ZaAccount.A_displayname,ZaAccount.A_mail],label:ZaMsg.DLXV_ReplayToAddr,labelLocation:_LEFT_,emptyText:ZaMsg.DLXV_ReplayToAddrEmptyText,width:"24em",inputWidth:"32em",editable:true,forceUpdate:true,choices:new XFormChoices([],XFormChoices.OBJECT_LIST,"name","name"),visibilityChecks:[[ZaItem.hasReadPermission,ZaDistributionList.A_zimbraPrefReplyToAddress]],enableDisableChangeEventSources:[ZaDistributionList.A_zimbraPrefReplyToEnabled],enableDisableChecks:[[XForm.checkInstanceValue,ZaDistributionList.A_zimbraPrefReplyToEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaDistributionList.A_zimbraPrefReplyToAddress]],onChange:function(Y,I,H){
if(Y instanceof ZaItem){
this.setInstanceValue(Y.name)
}else{
this.setInstanceValue(Y)
}}}
]}
]};
e.push(l)
}
var r=[{
type:_AJX_IMAGE_,src:"Group_32",label:null,rowSpan:3}
,{
type:_OUTPUT_,ref:"name",label:null,cssClass:"AdminTitle",height:"auto",width:350,rowSpan:3,cssStyle:"word-wrap:break-word;overflow:hidden"}
];
if(ZaItem.hasReadPermission(ZaItem.A_zimbraId,t)){
r.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID}
)
}
if(ZaItem.hasReadPermission(ZaItem.A_zimbraCreateTimestamp,t)){
r.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var H=ZaItem.formatServerTime(this.getInstanceValue());
if(!H){
return ZaMsg.Server_Time_NA
}else{
return H
}}}
)
}
if(ZaItem.hasReadPermission(ZaDistributionList.A_mailStatus,t)){
r.push({
type:_OUTPUT_,ref:ZaDistributionList.A_mailStatus,label:ZaMsg.NAD_ResourceStatus,choices:this.dlStatusChoices}
)
}
T.items=[{
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:4,colSizes:["32px","*","80px","*"],items:r}
]}
,{
type:_TAB_BAR_,choices:this.tabChoices,cssStyle:"display:none;",ref:ZaModel.currentTab,colSpan:"*",cssClass:"ZaTabBar",id:"xform_tabbar"}
,{
type:_SWITCH_,items:e}
]
};
ZaTabView.XFormModifiers.ZaDLXFormView.push(ZaDLXFormView.myXFormModifier);
ZaDLXFormView.prototype.getTabChoices=function(){
return this.tabChoices
};
ZaDLXFormView.isMoreThanOnePage=function(o){
var t=this.getForm();
var e=t.getInstanceValue(o)||0;
return e>1
};
ZaDLXFormView.showSearchFoundNum=function(e){
if(AjxUtil.isEmpty(e)){
return
}
return AjxMessageFormat.format(ZaMsg.DLXV_MsgSearchFound,[e])
};
ZaDLXFormView.showSearchFoundPaging=function(o){
var t=o||1;
var e=this.getForm().getInstanceValue(ZaDistributionList.A2_poolNumPages)||1;
return t+"/"+e
};
ZaDLXFormView.showMembersNum=function(e){
if(e==null){
return ZaMsg.splashScreenLoading
}
if(e<0){
e=0
}
return AjxMessageFormat.format(ZaMsg.DLXV_MsgMemberNum,[e])
};
ZaDLXFormView.showMembersPaging=function(o){
var t=o||1;
var e=this.getForm().getInstanceValue(ZaDistributionList.A2_memNumPages)||1;
return t+"/"+e
};
ZaDLXFormView.checkTotalNumInPool=function(t){
if(AjxUtil.isEmpty(t)){
t=0
}
var e=this.getForm().getInstanceValue(ZaDistributionList.A2_totalNumInPool);
if(e==null){
e=-1
}
return e>t
};
ZaDLXFormView.prototype.updateMemberList=function(n){
if(AjxUtil.isEmpty(n)){
return
}
var t=this.getMyForm();
if(t){
var e=t.getInstance()||{};
e[ZaDistributionList.A2_allMemberHash]=n[ZaDistributionList.A2_allMemberHash]||{};
e[ZaDistributionList.A2_numMembers]=n[ZaDistributionList.A2_numMembers]||0;
var o=n[ZaDistributionList.A2_allMemberPages]||[];
e[ZaDistributionList.A2_allMemberPages]=o;
var s=(o&&o.length)?o[0]:[];
s._version=1;
e[ZaDistributionList.A2_memberList]=n[ZaDistributionList.A2_memberList]=s;
e[ZaDistributionList.A2_memPagenum]=1;
e[ZaDistributionList.A2_memNumPages]=n[ZaDistributionList.A2_memNumPages]||1;
e[ZaAccount.A2_memberOf]=ZaAccountMemberOfListView.cloneMemberOf(n);
e[ZaAccount.A2_directMemberList+"_more"]=n[ZaAccount.A2_directMemberList+"_more"];
e[ZaAccount.A2_directMemberList+"_offset"]=n[ZaAccount.A2_directMemberList+"_offset"];
e[ZaAccount.A2_indirectMemberList+"_more"]=n[ZaAccount.A2_indirectMemberList+"_more"];
e[ZaAccount.A2_indirectMemberList+"_offset"]=n[ZaAccount.A2_indirectMemberList+"_offset"];
e[ZaAccount.A2_nonMemberList+"_more"]=n[ZaAccount.A2_nonMemberList+"_more"];
e[ZaAccount.A2_nonMemberList+"_offset"]=n[ZaAccount.A2_nonMemberList+"_offset"];
if(n[ZaDistributionList.A2_DLOwners]){
e[ZaDistributionList.A2_DLOwners]=ZaItem.deepCloneListItem(n[ZaDistributionList.A2_DLOwners])
}
if(n[ZaDistributionList.A2_dlType]){
e[ZaDistributionList.A2_dlType]=n[ZaDistributionList.A2_dlType]
}
if(e.id!=n.id){
e.id=n.id
}
ZaDLXFormView._copyAttrFromEntry(t,e,n);
t.setInstance(e)
}}
}
if(AjxPackage.define("zimbraAdmin.dl.view.ZaNewDLXWizard")){
ZaNewDLXWizard=function(o,n){
var e,t;
if(AjxEnv.isWebKitBased||AjxEnv.isFirefox){
t="740px";
e="465px"
}else{
t="720px";
e="455px"
}
ZaXWizardDialog.call(this,o,null,ZaMsg.DLTBB_New_tt,t,e,"ZaNewDLXWizard",null,ZaId.DLG_NEW_DL);
this.dlStatusChoices=[{
value:"enabled",label:ZaMsg.DL_Status_enabled}
,{
value:"disabled",label:ZaMsg.DL_Status_disabled}
];
this.initForm(ZaDistributionList.myXModel,this.getMyXForm(n));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_CHANGED,new AjxListener(this,ZaNewDLXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaNewDLXWizard.prototype.handleXFormChange))
};
ZaNewDLXWizard.prototype=new ZaXWizardDialog;
ZaNewDLXWizard.prototype.constructor=ZaNewDLXWizard;
ZaNewDLXWizard.prototype.toString=function(){
return"ZaNewDLXWizard"
};
ZaXDialog.XFormModifiers.ZaNewDLXWizard=new Array();
ZaNewDLXWizard.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/create_an_account.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaNewDLXWizard.prototype.getTitle=function(){
return ZaMsg.DLTBB_New_tt
};
ZaNewDLXWizard.prototype.getTabIcon=function(){
if(this._containedObject&&this._containedObject.attrs&&this._containedObject.attrs[ZaDistributionList.A_isAdminGroup]=="TRUE"){
return"DistributionListGroup"
}else{
return"DistributionList"
}};
ZaNewDLXWizard.prototype.handleXFormChange=function(e){
if(e&&this._localXForm.hasErrors()){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}else{
if(this._containedObject[ZaAccount.A_name]&&this._containedObject[ZaAccount.A_name].indexOf("@")>0){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true);
if(this._containedObject[ZaModel.currentStep]!=this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}
if(this._containedObject[ZaModel.currentStep]!=1){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}}};
ZaNewDLXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
};
ZaNewDLXWizard.prototype.createDomainAndAccount=function(t){
try{
var n=new ZaDomain();
n.name=t;
n.attrs[ZaDomain.A_domainName]=t;
var o=ZaItem.create(n,ZaDomain,"ZaDomain");
if(o!=null){
ZaApp.getInstance().getCurrentController().closeCnfrmDelDlg();
this.finishWizard()
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewDLXWizard.prototype.createDomainAndAccount",null,false)
}};
ZaNewDLXWizard.prototype.finishWizard=function(){
try{
if(!ZaDistributionList.checkValues(this._containedObject)){
return false
}
var e=ZaItem.create(this._containedObject,ZaDistributionList,"ZaDistributionList");
if(e!=null){
ZaApp.getInstance().getDistributionListController().fireCreationEvent(this._containedObject);
this.popdown();
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.DLCreated,[e.name]))
}}
catch(t){
switch(t.code){
case ZmCsfeException.ACCT_EXISTS:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_EXISTS);
break;
case ZmCsfeException.ACCT_INVALID_PASSWORD:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_INVALID,t);
ZaApp.getInstance().getAppCtxt().getErrorDialog().showDetail(true);
break;
case ZmCsfeException.NO_SUCH_COS:ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[this._containedObject.attrs[ZaAccount.A_COSId]]),t);
break;
case ZmCsfeException.NO_SUCH_DOMAIN:ZaApp.getInstance().dialogs.confirmMessageDialog2.setMessage(AjxMessageFormat.format(ZaMsg.CreateDomain_q,[ZaAccount.getDomain(this._containedObject.name)]),DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.YES_BUTTON,this.createDomainAndAccount,this,[ZaAccount.getDomain(this._containedObject.name)]);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.NO_BUTTON,ZaController.prototype.closeCnfrmDelDlg,ZaApp.getInstance().getCurrentController(),null);
ZaApp.getInstance().dialogs.confirmMessageDialog2.popup();
break;
default:ZaApp.getInstance().getCurrentController()._handleException(t,"ZaNewDLXWizard.prototype.finishWizard",null,false);
break
}}};
ZaNewDLXWizard.prototype.goNext=function(){
if(this._containedObject[ZaModel.currentStep]==1){
if(ZaSearch.isAccountExist.call(this,{
name:this._containedObject[ZaAccount.A_name],popupError:true}
)){
return false
}
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}
this.goPage(this._containedObject[ZaModel.currentStep]+1);
if(this._containedObject[ZaModel.currentStep]==this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}};
ZaNewDLXWizard.prototype.goPrev=function(){
if(this._containedObject[ZaModel.currentStep]==2){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
}else{
if(this._containedObject[ZaModel.currentStep]==this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}}
this.goPage(this._containedObject[ZaModel.currentStep]-1)
};
ZaNewDLXWizard.nonmemberSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_nonmembersSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_nonmembersSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountMemberOfListView._addSelectedLists(this.getForm(),e)
}};
ZaNewDLXWizard.directMemberSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_directMemberSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_directMemberSelected,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaAccountMemberOfListView._removeSelectedLists(this.getForm(),e)
}};
ZaNewDLXWizard.indirectMemberSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_indirectMemberSelected,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_indirectMemberSelected,null)
}};
ZaNewDLXWizard.removeAllMembers=function(e){
var t=this.getForm();
var r=t.getModel().getInstanceValue(t.getInstance(),ZaDistributionList.A2_removeList);
var c=t.getModel().getInstanceValue(t.getInstance(),ZaDistributionList.A2_memberList);
var o=t.getModel().getInstanceValue(t.getInstance(),ZaDistributionList.A2_addList);
var l=[];
for(var h=0;
h<c.length;
h++){
var s=c[h];
if(!o||o.length==0||AjxUtil.indexOf(o,s,false)<0){
l.push(s)
}}
var n=AjxUtil.mergeArrays(r,l);
n._version=r._version+1;
this.setInstanceValue([],ZaDistributionList.A2_addList);
this.setInstanceValue([],ZaDistributionList.A2_memberList);
this.setInstanceValue(n,ZaDistributionList.A2_removeList);
this.getForm().parent.setDirty(true)
};
ZaNewDLXWizard.removeMembers=function(t){
var o=this.getForm();
var f=o.getModel().getInstanceValue(o.getInstance(),ZaDistributionList.A2_memberList);
var n=o.getModel().getInstanceValue(o.getInstance(),ZaDistributionList.A2_addList);
var e=o.getModel().getInstanceValue(o.getInstance(),ZaDistributionList.A2_membersSelected);
var c=o.getModel().getInstanceValue(o.getInstance(),ZaDistributionList.A2_removeList);
var u=o.getModel().getInstanceValue(o.getInstance(),ZaDistributionList.A2_origList);
var m=AjxUtil.arraySubtract(f,o.getModel().getInstanceValue(o.getInstance(),ZaDistributionList.A2_membersSelected));
m._version=f._version+1;
this.setInstanceValue(m,ZaDistributionList.A2_memberList);
var d=AjxUtil.arraySubtract(n,o.getModel().getInstanceValue(o.getInstance(),ZaDistributionList.A2_membersSelected));
d._version=n._version+1;
this.setInstanceValue(d,ZaDistributionList.A2_addList);
var l=[];
for(var h=0;
h<e.length;
h++){
var r=e[h];
if(!n||n.length==0||AjxUtil.indexOf(n,r,false)<0){
if(u&&u.length>0&&AjxUtil.indexOf(u,r,false)>=0){
l.push(r)
}}}
var s=AjxUtil.mergeArrays(c,l);
s._version=c._version+1;
this.setInstanceValue(s,ZaDistributionList.A2_removeList);
this.getForm().parent.setDirty(true)
};
ZaNewDLXWizard.getMemberSelection=function(){
var e=this.getItemsById(ZaDistributionList.A2_members)[0];
var t=null;
if(e){
var t=e.getSelection()
}
if(t){
return t
}else{
return[]
}};
ZaNewDLXWizard.shouldEnableMemberListButtons=function(){
return(ZaNewDLXWizard.getMemberSelection.call(this).length>0)
};
ZaNewDLXWizard.shouldEnableRemoveAllButton=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_memberList)))
};
ZaNewDLXWizard.shouldEnableAddAllButton=function(){
var e=this.getItemsById("memberPool")[0].widget.getList();
if(e!=null){
return(e.size()>0)
}
return false
};
ZaNewDLXWizard.getMemberPoolSelection=function(){
var e=this.getItemsById("memberPool")[0];
var t=null;
if(e){
var t=e.getSelection()
}
if(t){
return t
}else{
return[]
}};
ZaNewDLXWizard.shouldEnableMemberPoolListButtons=function(){
return(ZaNewDLXWizard.getMemberPoolSelection.call(this).length>0)
};
ZaNewDLXWizard.shouldEnableFreeFormButtons=function(){
var e=this.getInstance().optionalAdd;
return(e&&e.length>0)
};
ZaNewDLXWizard.addAddressesToMembers=function(h){
var r=this.getForm();
var t=r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_memberPoolSelected);
var e=[];
for(var s=0;
s<t.length;
s++){
var l=t[s];
if(l.name!=r.getInstance().name){
e.push(l)
}}
var n=AjxUtil.mergeArrays(r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_addList),e,ZaDistributionList.compareTwoMembers);
n._version=r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_addList)._version+1;
var o=AjxUtil.mergeArrays(r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_memberList),e,ZaDistributionList.compareTwoMembers);
o._version=r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_memberList)._version+1;
this.setInstanceValue(n,ZaDistributionList.A2_addList);
this.setInstanceValue(o,ZaDistributionList.A2_memberList);
this.getForm().parent.setDirty(true)
};
ZaNewDLXWizard.addAllAddressesToMembers=function(h){
var r=this.getForm();
var t=r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_memberPool);
var e=[];
for(var s=0;
s<t.length;
s++){
var l=t[s];
if(l.name!=r.getInstance().name){
e.push(l)
}}
var n=AjxUtil.mergeArrays(r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_addList),e,ZaDistributionList.compareTwoMembers);
n._version=r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_addList)._version+1;
var o=AjxUtil.mergeArrays(r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_memberList),e,ZaDistributionList.compareTwoMembers);
o._version=r.getModel().getInstanceValue(r.getInstance(),ZaDistributionList.A2_memberList)._version+1;
this.setInstanceValue(n,ZaDistributionList.A2_addList);
this.setInstanceValue(o,ZaDistributionList.A2_memberList);
this.getForm().parent.setDirty(true)
};
ZaNewDLXWizard.prototype.setObject=function(n){
this._containedObject=new ZaDistributionList();
this._containedObject.attrs=new Object();
this._containedObject[ZaDistributionList.A2_memberList]=new Array();
this._containedObject[ZaDistributionList.A2_memberList]._version=1;
if(n._uuid){
this._containedObject._uuid=n._uuid
}
if(n[ZaDistributionList.A2_memberList]){
var s;
s=n[ZaDistributionList.A2_memberList];
for(var o=0;
o<s.length;
++o){
this._containedObject[ZaDistributionList.A2_memberList].push(s[o])
}}
for(var e in n.attrs){
var t=this._localXForm.getModel().getItem(e);
if((t!=null&&t.type==_LIST_)||(n.attrs[e]!=null&&n.attrs[e] instanceof Array)){
this._containedObject.attrs[e]=ZaItem.deepCloneListItem(n.attrs[e])
}else{
this._containedObject.attrs[e]=n.attrs[e]
}}
this._containedObject[ZaDistributionList.A2_addList]=n[ZaDistributionList.A2_addList]||new Array();
this._containedObject[ZaDistributionList.A2_addList]._version=1;
this._containedObject[ZaDistributionList.A2_removeList]=n[ZaDistributionList.A2_removeList]||new Array();
this._containedObject[ZaDistributionList.A2_removeList]._version=1;
this._containedObject[ZaDistributionList.A2_poolPagenum]=n[ZaDistributionList.A2_poolPagenum]||1;
this._containedObject[ZaDistributionList.A2_poolNumPages]=n[ZaDistributionList.A2_poolNumPages];
this._containedObject[ZaDistributionList.A2_memPagenum]=n[ZaDistributionList.A2_memPagenum]||1;
this._containedObject[ZaDistributionList.A2_memNumPages]=n[ZaDistributionList.A2_memNumPages];
this._containedObject[ZaDistributionList.A2_query]=n[ZaDistributionList.A2_query]||"";
this._containedObject[ZaAccount.A2_memberOf]=ZaAccountMemberOfListView.cloneMemberOf(n);
this._containedObject[ZaDistributionList.A2_origList]=n[ZaDistributionList.A2_origList];
this._containedObject[ZaAccount.A2_directMemberList+"_more"]=n[ZaAccount.A2_directMemberList+"_more"];
this._containedObject[ZaAccount.A2_directMemberList+"_offset"]=n[ZaAccount.A2_directMemberList+"_offset"];
this._containedObject[ZaAccount.A2_indirectMemberList+"_more"]=n[ZaAccount.A2_indirectMemberList+"_more"];
this._containedObject[ZaAccount.A2_indirectMemberList+"_offset"]=n[ZaAccount.A2_indirectMemberList+"_offset"];
this._containedObject[ZaAccount.A2_nonMemberList+"_more"]=n[ZaAccount.A2_nonMemberList+"_more"];
this._containedObject[ZaAccount.A2_nonMemberList+"_offset"]=n[ZaAccount.A2_nonMemberList+"_offset"];
this._containedObject[ZaModel.currentStep]=n[ZaModel.currentStep]||1;
this._containedObject[ZaDistributionList.A2_allMemberHash]=new Array();
this._containedObject[ZaDistributionList.A2_allMemberPages]=new Array();
if(n.rights){
this._containedObject.rights=n.rights
}
if(n.setAttrs){
this._containedObject.setAttrs=n.setAttrs
}
if(n.getAttrs){
this._containedObject.getAttrs=n.getAttrs
}
if(n._defaultValues){
this._containedObject._defaultValues=n._defaultValues
}
this._containedObject[ZaDistributionList.A2_DLOwners]=new Array();
if(n[ZaDistributionList.A2_DLOwners]){
this._containedObject[ZaDistributionList.A2_DLOwners]=ZaItem.deepCloneListItem(n[ZaDistributionList.A2_DLOwners])
}
this._containedObject.name=n.name;
if(n.name==""){
this._containedObject.name=ZaMsg.TBB_New
}
this._containedObject.type=n.type;
this._containedObject.id=n.id;
if(n[ZaDistributionList.A2_dlType]===ZaDistributionList.STATIC_DL_TYPE){
this._containedObject[ZaAccount.A2_autoMailServer]=n[ZaAccount.A2_autoMailServer]
}
if(n[ZaDistributionList.A2_dlType]){
this._containedObject[ZaDistributionList.A2_dlType]=n[ZaDistributionList.A2_dlType]
}
if(!n.id){
if(ZaItem.hasWritePermission(ZaAccount.A_zimbraIsDelegatedAdminAccount,n)){
this._containedObject.attrs[ZaDistributionList.A_mailStatus]="enabled"
}}
this._localXForm.setInstance(this._containedObject)
};
ZaNewDLXWizard.prototype.srchResWithoutSelf=function(s,e){
var o=new Array();
var t=s.getArray();
for(var n=0;
n<t.length;
n++){
if(t[n].type==ZaItem.DL&&t[n]==e){
continue
}else{
if(t[n].type==ZaItem.ALIAS&&t[n].getAliasTargetObj()==e){
continue
}else{
o.push(t[n])
}}}
return o
};
ZaNewDLXWizard.prototype.searchAccounts=function(s,r){
try{
s=(s!=null)?s:ZaAccount.A_name;
var o=[ZaSearch.ACCOUNTS,ZaSearch.DLS,ZaSearch.ALIASES];
var n=new ZaSearchQuery(ZaSearch.getSearchByNameQuery(this._containedObject.query,o,true),o,false,"",null,10);
var e=ZaSearch.searchByQueryHolder(n,this._containedObject.poolPagenum,s,r);
if(e.list){
this._containedObject.memberPool=this.srchResWithoutSelf(e.list,this._containedObject[ZaAccount.A_name])
}
this._containedObject.poolNumPages=e.numPages;
this._localXForm.setInstance(this._containedObject)
}
catch(t){
if(t.code!=ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaNewDLXWizard.prototype.searchAccounts",null,false)
}else{
this.popupErrorDialog(ZaMsg.queryParseError,t);
this._searchField.setEnabled(true)
}}};
ZaNewDLXWizard.aliasSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,null)
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaNewDLXWizard.editAliasButtonListener.call(this)
}};
ZaNewDLXWizard.deleteAliasButtonListener=function(){
var e=this.getInstance();
if(e[ZaDistributionList.A2_alias_selection_cache]!=null){
var s=e[ZaDistributionList.A2_alias_selection_cache].length;
if(s&&e.attrs[ZaAccount.A_zimbraMailAlias]){
var o=e.attrs[ZaAccount.A_zimbraMailAlias];
for(var n=0;
n<s;
n++){
var r=o.length-1;
for(var t=r;
t>=0;
t--){
if(o[t]==e[ZaDistributionList.A2_alias_selection_cache][n]){
o.splice(t,1);
break
}}}
this.getModel().setInstanceValue(e,ZaAccount.A_zimbraMailAlias,o)
}}
this.getModel().setInstanceValue(e,ZaDistributionList.A2_alias_selection_cache,[]);
this.getForm().parent.setDirty(true)
};
ZaNewDLXWizard.editAliasButtonListener=function(){
var e=this.getInstance();
if(e.alias_selection_cache&&e.alias_selection_cache[0]){
var s=this.getForm().parent;
if(!s.editAliasDlg){
s.editAliasDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Edit_Alias_Title);
s.editAliasDlg.registerCallback(DwtDialog.OK_BUTTON,ZaNewDLXWizard.updateAlias,this.getForm(),null)
}
var n={};
n[ZaAccount.A_name]=e[ZaDistributionList.A2_alias_selection_cache][0];
var o=e.attrs[ZaAccount.A_zimbraMailAlias].length;
for(var t=0;
t<o;
t++){
if(e[ZaDistributionList.A2_alias_selection_cache][0]==e.attrs[ZaAccount.A_zimbraMailAlias][t]){
n[ZaAlias.A_index]=t;
break
}}
s.editAliasDlg.setObject(n);
s.editAliasDlg.popup()
}};
ZaNewDLXWizard.updateAlias=function(){
if(this.parent.editAliasDlg){
this.parent.editAliasDlg.popdown();
var o=this.parent.editAliasDlg.getObject();
var t=this.getInstance();
var e=t.attrs[ZaAccount.A_zimbraMailAlias];
if(o[ZaAlias.A_index]>=0&&e[o[ZaAlias.A_index]]!=o[ZaAccount.A_name]){
e[o[ZaAlias.A_index]]=o[ZaAccount.A_name];
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraMailAlias,e);
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,new Array());
this.parent.setDirty(true)
}}};
ZaNewDLXWizard.addAliasButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addAliasDlg){
o.addAliasDlg=new ZaEditAliasXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"550px","150px",ZaMsg.Add_Alias_Title);
o.addAliasDlg.registerCallback(DwtDialog.OK_BUTTON,ZaNewDLXWizard.addAlias,this.getForm(),null)
}
var t={};
t[ZaAccount.A_name]="";
t[ZaAlias.A_index]=-1;
o.addAliasDlg.setObject(t);
o.addAliasDlg.popup()
};
ZaNewDLXWizard.addAlias=function(){
if(this.parent.addAliasDlg){
this.parent.addAliasDlg.popdown();
var o=this.parent.addAliasDlg.getObject();
if(o[ZaAccount.A_name]&&o[ZaAccount.A_name].length>1){
var t=this.getInstance();
var e=t.attrs[ZaAccount.A_zimbraMailAlias];
e.push(o[ZaAccount.A_name]);
this.getModel().setInstanceValue(this.getInstance(),ZaAccount.A_zimbraMailAlias,e);
this.getModel().setInstanceValue(this.getInstance(),ZaDistributionList.A2_alias_selection_cache,new Array());
this.parent.setDirty(true)
}}};
ZaNewDLXWizard.isEditAliasEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_alias_selection_cache))&&this.getInstanceValue(ZaAccount.A2_alias_selection_cache).length==1)
};
ZaNewDLXWizard.isDeleteAliasEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaDistributionList.A2_alias_selection_cache)))
};
ZaNewDLXWizard.NOTES_TAB_ATTRS=[ZaAccount.A_notes];
ZaNewDLXWizard.NOTES_TAB_RIGHTS=[];
ZaNewDLXWizard.MEMBEROF_TAB_ATTRS=[];
ZaNewDLXWizard.MEMBEROF_TAB_RIGHTS=[ZaDistributionList.GET_DL_MEMBERSHIP_RIGHT];
ZaNewDLXWizard.ALIASES_TAB_ATTRS=[ZaAccount.A_zimbraMailAlias];
ZaNewDLXWizard.ALIASES_TAB_RIGHTS=[ZaDistributionList.ADD_DL_ALIAS_RIGHT,ZaDistributionList.REMOVE_DL_ALIAS_RIGHT];
ZaNewDLXWizard.OWNER_TAB_ATTRS=[];
ZaNewDLXWizard.OWNER_TAB_RIGHTS=[];
ZaNewDLXWizard.PREF_TAB_ATTRS=[ZaDistributionList.A_zimbraPrefReplyToEnabled,ZaDistributionList.A_zimbraPrefReplyToDisplay,ZaDistributionList.A_zimbraPrefReplyToAddress];
ZaNewDLXWizard.PREF_TAB_RIGHTS=[];
ZaNewDLXWizard.myXFormModifier=function(q,t){
var u=new Array();
var o=1;
u[0]=new ZaListHeaderItem("type",ZaMsg.ALV_Type_col,null,null,null,"objectClass",true,true);
u[1]=new ZaListHeaderItem(ZaAccount.A_name,ZaMsg.ALV_Name_col,null,null,o++,ZaAccount.A_name,true,true);
u[2]=new ZaListHeaderItem(ZaAccount.A_displayname,ZaMsg.ALV_DspName_col,null,null,o++,ZaAccount.A_displayname,true,true);
var m=new Array();
m[0]=new ZaListHeaderItem(ZaAccount.A_name,ZaMsg.ALV_Name_col,null,"100%",o++,ZaAccount.A_name,true,true);
var A=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.DIRECT);
var w=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.INDIRECT);
var g=new ZaAccountMemberOfsourceHeaderList(ZaAccountMemberOfsourceHeaderList.NON);
this.TAB_INDEX=0;
this.stepChoices=[];
var C,B,W,T,z,j;
C=++this.TAB_INDEX;
this.stepChoices.push({
value:C,label:ZaMsg.DLXV_TabMembers}
);
if(ZaTabView.isTAB_ENABLED(t,ZaNewDLXWizard.NOTES_TAB_ATTRS,ZaNewDLXWizard.NOTES_TAB_RIGHTS)){
B=++this.TAB_INDEX;
this.stepChoices.push({
value:B,label:ZaMsg.DLXV_TabProperties}
)
}
if(ZaTabView.isTAB_ENABLED(t,ZaNewDLXWizard.MEMBEROF_TAB_ATTRS,ZaNewDLXWizard.MEMBEROF_TAB_RIGHTS)){
W=++this.TAB_INDEX;
this.stepChoices.push({
value:W,label:ZaMsg.TABT_MemberOf}
)
}
if(ZaTabView.isTAB_ENABLED(t,ZaNewDLXWizard.ALIASES_TAB_ATTRS,ZaNewDLXWizard.ALIASES_TAB_RIGHTS)){
T=++this.TAB_INDEX;
this.stepChoices.push({
value:T,label:ZaMsg.TABT_Aliases}
)
}
if(ZaTabView.isTAB_ENABLED(t,ZaNewDLXWizard.OWNER_TAB_ATTRS,ZaNewDLXWizard.OWNER_TAB_RIGHTS)){
z=++this.TAB_INDEX;
this.stepChoices.push({
value:z,label:ZaMsg.TABT_Owners}
)
}
if(ZaTabView.isTAB_ENABLED(t,ZaNewDLXWizard.PREF_TAB_ATTRS,ZaNewDLXWizard.PREF_TAB_RIGHTS)){
j=++this.TAB_INDEX;
this.stepChoices.push({
value:j,label:ZaMsg.TABT_Preferences}
)
}
q.tableCssStyle="width:100%;overflow:auto;";
q.numCols=5;
q.colSizes=[10,"auto",20,"auto",10];
q.itemDefaults={
_INPUT_:{
cssClass:"inputBorder"}
,_TEXTAREA_:{
cssClass:"inputBorder"}
,_TEXTFIELD_:{
cssClass:"inputBorder",containerCssStyle:"width:95%"}};
var e=[];
var O,D,x,k,d,b;
O=30;
D=200;
x="98%";
k=250;
d="98%";
b="100%";
var p={
type:_CASE_,caseKey:C,numCols:2,id:"dl_form_members",colSizes:["320px","380px"],cssStyle:"padding-top:5px; table-layout:fixed;",items:[{
type:_GROUP_,width:"98%",numCols:1,items:[{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"96%",id:"dl_form_members_general_group",numCols:2,colSizes:[100,"*"],items:[{
ref:ZaAccount.A_name,type:_EMAILADDR_,msgName:ZaMsg.MSG_LabelListName,label:ZaMsg.LBL_LabelListName,forceUpdate:true,tableCssStyle:"width: 100%",inputWidth:"70px",domainPartWidth:"80px",id:"dl_name_field",nameContainerCss:"width: 70px",domainContainerWidth:"80px",midContainerCss:"width: 20px",visibilityChecks:[],enableDisableChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.RENAME_DL_RIGHT]]}
,{
type:_SPACER_,height:"3"}
,{
ref:ZaAccount.A_displayname,type:_TEXTFIELD_,label:ZaMsg.NAD_DisplayName,msgName:ZaMsg.NAD_DisplayName,align:_LEFT_,cssClass:"admin_xform_name_input",width:"95%"}
,{
type:_SPACER_,height:"3"}
,{
ref:"description",msgName:ZaMsg.NAD_Description,label:ZaMsg.NAD_Description,labelLocation:_LEFT_,align:_LEFT_,type:_TEXTAREA_,enableDisableChecks:[ZaItem.hasWritePermission],visibilityChecks:[ZaItem.hasReadPermission],cssClass:"admin_xform_name_input",cssStyle:"resize: none",width:"100%",height:"100"}
]}
,{
type:_SPACER_,height:"20"}
,{
type:_GROUPER_,borderCssClass:"LeftGrouperBorder",width:"100%",numCols:1,colSizes:["auto"],label:ZaMsg.DLXV_LabelListMembers,items:[{
type:_GROUP_,width:"100%",height:O,numCols:3,colSizes:["*","20px","104px"],items:[{
type:_OUTPUT_,ref:ZaDistributionList.A2_numMembers,align:_LEFT_,valueChangeEventSources:[ZaDistributionList.A2_numMembers,ZaDistributionList.A2_memNumPages],getDisplayValue:ZaDLXFormView.showMembersNum}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,width:"100%",numCols:3,colSizes:["32px","40px","32px"],visibilityChangeEventSources:[ZaDistributionList.A2_memNumPages],visibilityChecks:[[ZaDLXFormView.isMoreThanOnePage,ZaDistributionList.A2_memNumPages]],items:[{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,width:"100%",id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnableMemBackButton],enableDisableChangeEventSources:[ZaDistributionList.A2_memberList,ZaDistributionList.A2_memNumPages,ZaDistributionList.A2_memPagenum],onActivate:"ZaDLXFormView.backMemButtonHndlr.call(this,event)"}
,{
type:_OUTPUT_,ref:ZaDistributionList.A2_memPagenum,valueChangeEventSources:[ZaDistributionList.A2_memPagenum,ZaDistributionList.A2_memNumPages],align:_CENTER_,getDisplayValue:ZaDLXFormView.showMembersPaging}
,{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,width:"100%",id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnableMemForwardButton],enableDisableChangeEventSources:[ZaDistributionList.A2_memberList,ZaDistributionList.A2_memNumPages,ZaDistributionList.A2_memPagenum],onActivate:"ZaDLXFormView.fwdMemButtonHndlr.call(this,event)"}
]}
]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaDistributionList.A2_memberList,type:_DWT_LIST_,height:D,width:x,cssClass:"DLTarget",cssStyle:"margin-left: 5px; ",widgetClass:ZaAccMiniListView,headerList:m,hideHeader:true,onSelection:ZaDLXFormView.membersSelectionListener,bmolsnr:true}
,{
type:_SPACER_,height:"8"}
,{
type:_GROUP_,width:"98%",numCols:3,cssStyle:"table-layout:fixed",items:[{
type:_DWT_BUTTON_,id:"removeButton",label:ZaMsg.DLXV_ButtonRemoveSelected,width:"140px",nowrap:true,cssStyle:"padding:0px;",enableDisableChangeEventSources:[ZaDistributionList.A2_membersSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_membersSelected],[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_MEMBER_RIGHT]],onActivate:"ZaDLXFormView.removeSelectedMembers.call(this,event)"}
,{
type:_CELLSPACER_,width:"10px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemovePage,width:"140px",nowrap:true,cssStyle:"padding:0px;",visibilityChangeEventSources:[ZaDistributionList.A2_numMembers],visibilityChecks:[[XForm.checkInstanceValueNot,ZaDistributionList.A2_numMembers,0]],enableDisableChangeEventSources:[ZaDistributionList.A2_memberList],enableDisableChecks:[ZaDLXFormView.shouldEnableRemoveThisPageButton,[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_MEMBER_RIGHT]],onActivate:"ZaDLXFormView.removeOnePageMembers.call(this,event)"}
]}
]}
,{
type:_SPACER_,height:"5"}
]}
,{
type:_ZARIGHT_GROUPER_,numCols:1,width:b,label:ZaMsg.DLXV_GroupLabelAddMembers,items:[{
type:_GROUP_,width:"100%",numCols:3,colSizes:["64%","6%","30%"],items:[{
type:_GROUP_,width:"100%",numCols:2,colSizes:["20%","80%"],items:[{
type:_TEXTFIELD_,cssClass:"admin_xform_name_input",ref:ZaSearch.A_query,label:ZaMsg.DLXV_LabelFind,labelLocation:_LEFT_,labelCssStyle:"white-space: nowrap;",visibilityChecks:[],enableDisableChecks:[],width:"95%",align:_LEFT_,elementChanged:function(R,M,F){
var S=F.charCode;
if(S==13||S==3){
ZaDLXFormView.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,R,F)
}}}
]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,onActivate:ZaDLXFormView.srchButtonHndlr}
]}
,{
type:_SPACER_,height:"5",colSpan:"*"}
,{
type:_GROUP_,width:"100%",numCols:3,colSizes:["*","10px","104px"],items:[{
type:_GROUP_,items:[{
type:_OUTPUT_,ref:ZaDistributionList.A2_totalNumInPool,align:_LEFT_,visibilityChecks:[[ZaDLXFormView.checkTotalNumInPool,-1]],getDisplayValue:ZaDLXFormView.showSearchFoundNum,nowrap:false}
]}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,visibilityChangeEventSources:[ZaDistributionList.A2_poolNumPages],visibilityChecks:[[ZaDLXFormView.isMoreThanOnePage,ZaDistributionList.A2_poolNumPages]],numCols:3,colSizes:["32px","40px","32px"],width:"100%",items:[{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnablePoolBackButton],enableDisableChangeEventSources:[ZaDistributionList.A2_poolPagenum],onActivate:"ZaDLXFormView.backPoolButtonHndlr.call(this,event)"}
,{
type:_OUTPUT_,ref:ZaDistributionList.A2_poolPagenum,align:_CENTER_,getDisplayValue:ZaDLXFormView.showSearchFoundPaging}
,{
type:_DWT_BUTTON_,label:null,labelLocation:_NONE_,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChecks:[ZaDLXFormView.shouldEnablePoolForwardButton],enableDisableChangeEventSources:[ZaDistributionList.A2_poolPagenum],onActivate:"ZaDLXFormView.fwdPoolButtonHndlr.call(this,event)"}
]}
]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaDistributionList.A2_memberPool,type:_DWT_LIST_,height:k,width:d,cssClass:"DLSource",forceUpdate:true,widgetClass:ZaAccMiniListView,headerList:u,hideHeader:false,onSelection:ZaDLXFormView.memberPoolSelectionListener}
,{
type:_SPACER_,height:"5",colSpan:"*"}
,{
type:_GROUP_,width:b,items:[{
type:_GROUP_,width:"98%",numCols:3,cssStyle:"table-layout:fixed",items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddSelected,width:"140px",nowrap:true,onActivate:"ZaDLXFormView.addSelectedAddressesToMembers.call(this,event)",enableDisableChangeEventSources:[ZaDistributionList.A2_memberPoolSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_memberPoolSelected],[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
,{
type:_CELLSPACER_,width:"10px"}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddPage,width:"140px",nowrap:true,onActivate:"ZaDLXFormView.addOnePageAddressesToMembers.call(this,event)",visibilityChangeEventSources:[ZaDistributionList.A2_totalNumInPool],visibilityChecks:[[ZaDLXFormView.checkTotalNumInPool,1]],enableDisableChangeEventSources:[ZaDistributionList.A2_memberPool],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_memberPool],[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
]}
,{
type:_SPACER_}
]}
,{
type:_SPACER_,height:"5"}
,{
type:_OUTPUT_,value:ZaMsg.DLXV_GroupLabelEnterAddressBelow,visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaDistributionList.A2_optionalAdd,type:_TEXTAREA_,cssStyle:"resize: none",width:"98%",height:98,bmolsnr:true,visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]],enableDisableChecks:[]}
,{
type:_SPACER_,height:"5",visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]]}
,{
type:_GROUP_,numCols:2,colSizes:["20%","80%"],width:b,visibilityChecks:[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_MEMBER_RIGHT]],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddFromFreeForm,onActivate:"ZaDLXFormView.addFreeFormAddressToMembers.call(this,event)",enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_optionalAdd]],enableDisableChangeEventSources:[ZaDistributionList.A2_optionalAdd]}
,{
type:_OUTPUT_,value:ZaMsg.DLXV_SeparateAddresses}
]}
]}
]};
e.push(p);
if(B){
var f={
type:_CASE_,caseKey:B,colSpan:"*",items:[{
type:_GROUPER_,label:ZaMsg.DLXV_LabelProperties,id:"dl_properties",colSpan:"*",numCols:2,colSizes:[175,"*"],visibilityChangeEventSources:[],items:[{
ref:"zimbraMailStatus",type:_WIZ_CHECKBOX_,trueValue:"enabled",falseValue:"disabled",align:_LEFT_,nowrap:false,labelWrap:true,label:ZaMsg.DLXV_LabelEnabled,msgName:ZaMsg.DLXV_LabelEnabled,labelLocation:_LEFT_,labelCssClass:"xform_label",cssStyle:"padding-left:0px;margin-bottom-10px;"}
,{
ref:ZaAccount.A_zimbraHideInGal,type:_WIZ_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.LBL_zimbraHideInGal,labelLocation:_LEFT_,labelCssClass:"xform_label",labelWrap:true,align:_LEFT_,nowrap:false,msgName:ZaMsg.LBL_zimbraHideInGal,cssStyle:"padding-left: 0px; margin-bottom: 10px;"}
,{
type:_GROUP_,colSpan:"*",colSizes:["175px","*"],labelCssClass:"xform_label",cssStyle:"padding-left: 0px",items:[{
ref:ZaDistributionList.A2_dlType,type:_WIZ_CHECKBOX_,trueValue:ZaDistributionList.DYNAMIC_DL_TYPE,falseValue:ZaDistributionList.STATIC_DL_TYPE,label:ZaMsg.LBL_DL_Type,labelLocation:_LEFT_,labelCssClass:"xform_label",cssStyle:"margin-bottom-10px;",labelWrap:true,align:_LEFT_,nowrap:false,msgName:ZaMsg.LBL_DL_Type,subLabel:"",visibilityChecks:[],enableDisableChecks:[],elementChanged:function(R,F,S){
var M=this.getParentItem().items[2];
if(R==ZaDistributionList.STATIC_DL_TYPE){
if(M.hasError()){
M.clearError()
}
M.setInstanceValue(null)
}else{
if(this.getInstanceValue(ZaDistributionList.A_zimbraIsACLGroup)!="TRUE"){
M.setError(AjxMsg.valueIsRequired)
}}
this.getForm().itemChanged(this,R,S)
}}
,{
type:_GROUP_,numCols:3,colSizes:["25%","10%","65%"],nowrap:true,label:ZaMsg.NAD_MailServer,labelLocation:_LEFT_,visibilityChangeEventSources:[ZaDistributionList.A2_dlType],visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_mailHost],[XForm.checkInstanceValue,ZaDistributionList.A2_dlType,ZaDistributionList.STATIC_DL_TYPE]],items:[{
ref:ZaAccount.A_mailHost,type:_OSELECT1_,label:null,editable:false,choices:ZaApp.getInstance().getServerListChoices(),enableDisableChecks:[ZaAccount.isAutoMailServer],enableDisableChangeEventSources:[ZaAccount.A2_autoMailServer],visibilityChecks:[],cssStyle:"margin-left: 5px;"}
,{
ref:ZaAccount.A2_autoMailServer,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[],labelLocation:_RIGHT_,align:_RIGHT_,subLabel:"",enableDisableChecks:[]}
]}
,{
ref:ZaDistributionList.A_zimbraIsACLGroup,type:_WIZ_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",label:ZaMsg.LBL_ACL_Group,labelLocation:_LEFT_,labelCssClass:"xform_label",align:_LEFT_,subLabel:"",visibilityChangeEventSources:[ZaDistributionList.A2_dlType],visibilityChecks:[[XForm.checkInstanceValue,ZaDistributionList.A2_dlType,ZaDistributionList.DYNAMIC_DL_TYPE]],enableDisableChecks:[],elementChanged:function(R,F,S){
var M=this.getParentItem().items[2];
if(R=="TRUE"){
if(M.hasError()){
M.clearError()
}
M.setInstanceValue(null)
}else{
M.setError(AjxMsg.valueIsRequired)
}
this.getForm().itemChanged(this,R,S)
}}
,{
type:_INPUT_,ref:ZaDistributionList.A_memberOfURL,label:ZaMsg.LBL_Member_URL,labelLocation:_LEFT_,labelCssClass:"xform_label",cssStyle:"margin-left: 5px;",width:"80%",bmolsnr:true,visibilityChangeEventSources:[ZaDistributionList.A2_dlType],visibilityChecks:[[XForm.checkInstanceValue,ZaDistributionList.A2_dlType,ZaDistributionList.DYNAMIC_DL_TYPE]],enableDisableChangeEventSources:[ZaDistributionList.A_zimbraIsACLGroup],enableDisableChecks:[ZaDLXFormView.isNotACLGroup]}
]}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,numCols:2,colSizes:["5%","*"],label:ZaMsg.DLXV_SubscriptionRequest,labelLocation:_LEFT_,items:[{
ref:ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,type:_RADIO_,groupname:"subscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyAccept,label:ZaMsg.DLXV_SubscriptionPolicyAccept,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept)
}
,elementChanged:function(M,F,S){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept,S)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,type:_RADIO_,groupname:"subscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyApproval,label:ZaMsg.DLXV_SubscriptionPolicyApproval,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval)
}
,elementChanged:function(M,F,S){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval,S)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy,type:_RADIO_,groupname:"subscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyReject,label:ZaMsg.DLXV_SubscriptionPolicyReject,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListSubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject)
}
,elementChanged:function(M,F,S){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject,S)
}}
]}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,numCols:2,colSizes:["5%","*"],label:ZaMsg.DLXV_UnsubscriptionRequest,labelLocation:_LEFT_,items:[{
ref:ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,type:_RADIO_,groupname:"unsubscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyAccept,label:ZaMsg.DLXV_SubscriptionPolicyAccept,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept)
}
,elementChanged:function(M,F,S){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyAccept,S)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,type:_RADIO_,groupname:"unsubscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyApproval,label:ZaMsg.DLXV_SubscriptionPolicyApproval,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval)
}
,elementChanged:function(M,F,S){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyApproval,S)
}}
,{
ref:ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy,type:_RADIO_,groupname:"unsubscription_settings",msgName:ZaMsg.DLXV_SubscriptionPolicyReject,label:ZaMsg.DLXV_SubscriptionPolicyReject,onChange:ZaTabView.onFormFieldChanged,updateElement:function(){
this.getElement().checked=(this.getInstanceValue(ZaDistributionList.A_zimbraDistributionListUnsubscriptionPolicy)==ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject)
}
,elementChanged:function(M,F,S){
this.getForm().itemChanged(this,ZaDistributionList.A2_zimbraDLSubscriptionPolicyReject,S)
}}
]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaDistributionList.A_zimbraDistributionListSendShareMessageToNewMembers,type:_WIZ_CHECKBOX_,trueValue:"TRUE",falseValue:"FALSE",align:_LEFT_,nowrap:false,labelWrap:true,label:ZaMsg.DL_zimbraDistributionListSendShareMessageToNewMembers,subLabel:"",msgName:ZaMsg.DL_zimbraDistributionListSendShareMessageToNewMembers,labelLocation:_LEFT_,labelCssClass:"xform_label",cssStyle:"padding-left: 0px"}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaAccount.A_notes,type:_TEXTAREA_,label:ZaMsg.DLXV_LabelNotes,labelLocation:_LEFT_,width:"400",height:"100",labelCssStyle:"vertical-align: top",cssStyle:"margin-left: 5px; resize: none;"}
]}
]};
e.push(f)
}
if(W){
var c={
type:_CASE_,caseKey:W,numCols:2,colSpan:"*",colSizes:[400,400],items:[{
type:_DWT_ALERT_,containerCssStyle:"padding-bottom:0;",style:DwtAlert.INFO,colSpan:"*",iconVisible:false,content:ZaMsg.WARNING_DYNAMIC_DL_MEMBER,visibilityChecks:[[XForm.checkInstanceValue,ZaDistributionList.A2_dlType,ZaDistributionList.DYNAMIC_DL_TYPE]],visibilityChangeEventSources:[ZaDistributionList.A2_dlType]}
,{
type:_GROUP_,width:"98%",numCols:1,visibilityChecks:[[XForm.checkInstanceValue,ZaDistributionList.A2_dlType,ZaDistributionList.STATIC_DL_TYPE]],visibilityChangeEventSources:[ZaDistributionList.A2_dlType],items:[{
type:_SPACER_,height:"5"}
,{
type:_ZALEFT_GROUPER_,numCols:1,label:ZaMsg.Account_DirectGroupLabel,containerCssStyle:"padding-top: 5px",width:"100%",items:[{
ref:ZaAccount.A2_directMemberList,type:_S_DWT_LIST_,width:"98%",height:200,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:A,defaultColumnSortable:0,onSelection:ZaNewDLXWizard.directMemberSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[70,5,65,5,75,5,60,5],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemoveAll,enableDisableChangeEventSources:[ZaDistributionList.A2_directMemberList],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_directMemberList]],onActivate:"ZaAccountMemberOfListView.removeAllGroups.call(this,event, ZaAccount.A2_directMemberList)"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonRemove,id:"removeButton",onActivate:"ZaAccountMemberOfListView.removeGroups.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChangeEventSources:[ZaDistributionList.A2_directMemberSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_directMemberSelected]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_directMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_offset"]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_directMemberList)",enableDisableChangeEventSources:[ZaAccount.A2_directMemberList+"_more"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_directMemberList]]}
,{
type:_CELLSPACER_}
]}
]}
,{
type:_SPACER_,height:"10"}
,{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_IndirectGroupLabel,containerCssStyle:"padding-top: 5px",items:[{
ref:ZaAccount.A2_indirectMemberList,type:_S_DWT_LIST_,width:"98%",height:200,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:w,defaultColumnSortable:0,onSelection:ZaNewDLXWizard.indirectMemberSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[70,5,65,5,75,5,60,5],items:[{
type:_CELLSPACER_}
,{
type:_CELLSPACER_}
,{
type:_CELLSPACER_}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,id:"indirectBackButton",icon:"LeftArrow",disIcon:"LeftArrowDis",onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_offset"]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,id:"indirectFwdButton",icon:"RightArrow",disIcon:"RightArrowDis",onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_indirectMemberList)",enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_indirectMemberList]],enableDisableChangeEventSources:[ZaAccount.A2_indirectMemberList+"_more"]}
,{
type:_CELLSPACER_}
]}
]}
]}
,{
type:_GROUP_,width:"98%",numCols:1,visibilityChecks:[[XForm.checkInstanceValue,ZaDistributionList.A2_dlType,ZaDistributionList.STATIC_DL_TYPE]],visibilityChangeEventSources:[ZaDistributionList.A2_dlType],items:[{
type:_ZARIGHT_GROUPER_,numCols:1,width:"100%",label:ZaMsg.Account_NonGroupLabel,containerCssStyle:"padding-top: 5px",items:[{
type:_GROUP_,width:"100%",numCols:3,colSizes:["64%","6%","30%"],items:[{
type:_GROUP_,width:"100%",numCols:2,colSizes:["20%","80%"],items:[{
ref:"query",type:_TEXTFIELD_,width:"95%",cssClass:"admin_xform_name_input",nowrap:false,labelWrap:true,label:ZaMsg.DLXV_LabelFind,visibilityChecks:[],enableDisableChecks:[],elementChanged:function(R,M,F){
var S=F.charCode;
if(S==13||S==3){
ZaAccountMemberOfListView.prototype.srchButtonHndlr.call(this)
}else{
this.getForm().itemChanged(this,R,F)
}}}
]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonSearch,onActivate:ZaAccountMemberOfListView.prototype.srchButtonHndlr}
]}
,{
type:_GROUP_,width:"100%",numCols:2,items:[{
ref:ZaAccount.A2_showSameDomain,type:_WIZ_CHECKBOX_,label:ZaMsg.NAD_SearchSameDomain,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",visibilityChecks:[]}
]}
,{
type:_SPACER_,height:"5"}
,{
ref:ZaAccount.A2_nonMemberList,type:_S_DWT_LIST_,width:"98%",height:440,cssClass:"DLSource",widgetClass:ZaAccountMemberOfListView,headerList:g,defaultColumnSortable:0,onSelection:ZaNewDLXWizard.nonmemberSelectionListener,forceUpdate:true}
,{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:8,colSizes:[70,5,65,5,75,5,60,5],items:[{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddFromList,onActivate:"ZaAccountMemberOfListView.addGroups.call(this,event, ZaAccount.A2_nonMemberList)",enableDisableChangeEventSources:[ZaDistributionList.A2_nonmembersSelected],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaDistributionList.A2_nonmembersSelected]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.DLXV_ButtonAddAll,onActivate:"ZaAccountMemberOfListView.addAllGroups.call(this,event, ZaAccount.A2_nonMemberList)",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList],enableDisableChecks:[[XForm.checkInstanceValueNotEmty,ZaAccount.A2_nonMemberList]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Previous,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_offset"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableBackButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.backButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",enableDisableChangeEventSources:[ZaAccount.A2_nonMemberList+"_more"],enableDisableChecks:[[ZaAccountMemberOfListView.shouldEnableForwardButton,ZaAccount.A2_nonMemberList]],onActivate:"ZaAccountMemberOfListView.fwdButtonHndlr.call(this,event, ZaAccount.A2_nonMemberList)"}
,{
type:_CELLSPACER_}
]}
]}
]}
]};
e.push(c)
}
if(T){
var v={
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",onActivate:"ZaNewDLXWizard.addAliasButtonListener.call(this);"};
if(t.id){
v.enableDisableChecks=[[XFormItem.prototype.hasRight,ZaDistributionList.ADD_DL_ALIAS_RIGHT]]
}else{
v.enableDisableChecks=[[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]]
}
var n={
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",enableDisableChangeEventSources:[ZaDistributionList.A2_alias_selection_cache],onActivate:"ZaNewDLXWizard.editAliasButtonListener.call(this);",id:"editAliasButton"};
if(t.id){
n.enableDisableChecks=[ZaNewDLXWizard.isEditAliasEnabled,[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_ALIAS_RIGHT],[XFormItem.prototype.hasRight,ZaAccount.ADD_DL_ALIAS_RIGHT]]
}else{
n.enableDisableChecks=[ZaNewDLXWizard.isEditAliasEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]]
}
var y={
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaNewDLXWizard.deleteAliasButtonListener.call(this);",id:"deleteAliasButton",enableDisableChangeEventSources:[ZaDistributionList.A2_alias_selection_cache]};
if(t.id){
y.enableDisableChecks=[ZaNewDLXWizard.isDeleteAliasEnabled,[XFormItem.prototype.hasRight,ZaDistributionList.REMOVE_DL_ALIAS_RIGHT]]
}else{
y.enableDisableChecks=[ZaNewDLXWizard.isDeleteAliasEnabled,[ZaItem.hasWritePermission,ZaAccount.A_zimbraMailAlias]]
}
var l={
type:_CASE_,caseKey:T,width:"100%",numCols:1,items:[{
type:_GROUPER_,borderCssClass:"LeftGrouperBorder",width:"100%",numCols:1,label:ZaMsg.NAD_EditDLAliasesGroup,items:[{
ref:ZaAccount.A_zimbraMailAlias,type:_DWT_LIST_,height:"200",width:"98%",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,onSelection:ZaNewDLXWizard.aliasSelectionListener}
,{
type:_GROUP_,numCols:6,colSizes:["100px","10px","100px","10px","100px","auto"],cssStyle:"margin-bottom: 10px; padding-bottom: 0px; margin-top: 10px; margin-left: 10px; margin-right: 10px;",items:[y,{
type:_CELLSPACER_}
,n,{
type:_CELLSPACER_}
,v]}
]}
]};
e.push(l)
}
if(z){
var h={
type:_CASE_,caseKey:z,numCols:1,items:[{
ref:ZaDistributionList.A2_DLOwners,type:_REPEAT_,label:null,showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.BTN_Add_Owner,showAddOnNextRow:true,removeButtonLabel:ZaMsg.BTN_Remove_Owner,removeButtonCSSStyle:"margin-left: 50px",enableDisableChecks:[],visibilityChecks:[],items:[{
ref:".",type:_EMAILADDR_,label:null,enableDisableChecks:[],visibilityChecks:[]}
]}
]};
e.push(h)
}
if(j){
var r={
type:_CASE_,caseKey:j,numCols:1,items:[{
type:_GROUPER_,label:ZaMsg.NAD_MailOptionsReceiving,id:"dl_pref_replyto_group",colSpan:"*",numCols:2,colSizes:[225,"*"],visibilityChecks:[[ZATopGrouper_XFormItem.isGroupVisible,[ZaDistributionList.A_zimbraPrefReplyToEnabled,ZaDistributionList.A_zimbraPrefReplyToDisplay,ZaDistributionList.A_zimbraPrefReplyToAddress]]],visibilityChangeEventSources:[],items:[{
ref:ZaDistributionList.A_zimbraPrefReplyToEnabled,type:_WIZ_CHECKBOX_,visibilityChecks:[[ZaItem.hasReadPermission,ZaDistributionList.A_zimbraPrefReplyToEnabled]],label:ZaMsg.DLXV_ReplayToEnabled,trueValue:"TRUE",falseValue:"FALSE"}
,{
ref:ZaDistributionList.A_zimbraPrefReplyToDisplay,type:_TEXTFIELD_,label:ZaMsg.DLXV_ReplayToAddrDisplay,emptyText:ZaMsg.DLXV_ReplayToAddrEmptyText,visibilityChecks:[[ZaItem.hasReadPermission,ZaDistributionList.A_zimbraPrefReplyToDisplay]],enableDisableChecks:[[XForm.checkInstanceValue,ZaDistributionList.A_zimbraPrefReplyToEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaDistributionList.A_zimbraPrefReplyToAddress]],enableDisableChangeEventSources:[ZaDistributionList.A_zimbraPrefReplyToEnabled]}
,{
type:_DYNSELECT_,ref:ZaDistributionList.A_zimbraPrefReplyToAddress,dataFetcherClass:ZaSearch,dataFetcherMethod:ZaSearch.prototype.dynSelectSearch,dataFetcherTypes:[ZaSearch.ACCOUNTS,ZaSearch.RESOURCES,ZaSearch.DLS],dataFetcherAttrs:[ZaItem.A_zimbraId,ZaItem.A_cn,ZaAccount.A_name,ZaAccount.A_displayname,ZaAccount.A_mail],label:ZaMsg.DLXV_ReplayToAddr,emptyText:ZaMsg.DLXV_ReplayToAddrEmptyText,editable:true,forceUpdate:true,choices:new XFormChoices([],XFormChoices.OBJECT_LIST,"name","name"),visibilityChecks:[[ZaItem.hasReadPermission,ZaDistributionList.A_zimbraPrefReplyToAddress]],enableDisableChangeEventSources:[ZaDistributionList.A_zimbraPrefReplyToEnabled],enableDisableChecks:[[XForm.checkInstanceValue,ZaDistributionList.A_zimbraPrefReplyToEnabled,"TRUE"],[ZaItem.hasWritePermission,ZaDistributionList.A_zimbraPrefReplyToAddress]],onChange:function(M,F,S){
if(M instanceof ZaItem){
this.setInstanceValue(M.name)
}else{
this.setInstanceValue(M)
}}}
]}
]};
e.push(r)
}
var s=[{
type:_AJX_IMAGE_,src:"Group_32",label:null,rowSpan:3}
,{
type:_OUTPUT_,ref:"name",label:null,cssClass:"AdminTitle",height:"auto",width:350,rowSpan:3,cssStyle:"word-wrap: break-word; overflow: hidden"}
];
if(ZaItem.hasReadPermission(ZaItem.A_zimbraId,t)){
s.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID}
)
}
if(ZaItem.hasReadPermission(ZaItem.A_zimbraCreateTimestamp,t)){
s.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var S=ZaItem.formatServerTime(this.getInstanceValue());
if(!S){
return ZaMsg.Server_Time_NA
}
return S
}}
)
}
if(ZaItem.hasReadPermission(ZaDistributionList.A_mailStatus,t)){
s.push({
type:_OUTPUT_,ref:ZaDistributionList.A_mailStatus,label:ZaMsg.NAD_ResourceStatus,choices:this.dlStatusChoices}
)
}
this._lastStep=this.stepChoices.length;
q.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,cssStyle:"white-space: normal",ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep]}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:700,align:_LEFT_,valign:_TOP_,cssStyle:"white-space: normal",items:e}
]
};
ZaXDialog.XFormModifiers.ZaNewDLXWizard.push(ZaNewDLXWizard.myXFormModifier);
ZaNewDLXWizard.isAutoDisplayname=function(){
return(this.getInstanceValue(ZaResource.A2_autoLocationName)=="FALSE")
}
}
if(AjxPackage.define("zimbraAdmin.resource.view.ZaResourceXFormView")){
ZaResourceXFormView=function(e,t){
ZaTabView.call(this,{
parent:e,iKeyName:"ZaResourceXFormView",contextId:ZaId.TAB_RES_EDIT}
);
this.TAB_INDEX=0;
if(!ZaResource.accountStatusChoices){
ZaResource.accountStatusChoices=[{
value:ZaResource.ACCOUNT_STATUS_ACTIVE,label:ZaResource.getAccountStatusLabel(ZaResource.ACCOUNT_STATUS_ACTIVE)}
,{
value:ZaResource.ACCOUNT_STATUS_CLOSED,label:ZaResource.getAccountStatusLabel(ZaResource.ACCOUNT_STATUS_CLOSED)}
]
}
this.cosChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
this.signatureChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
this.initForm(ZaResource.myXModel,this.getMyXForm(t),null);
this._localXForm.setController(ZaApp.getInstance());
this._helpURL=ZaResourceXFormView.helpURL
};
ZaResourceXFormView.prototype=new ZaTabView();
ZaResourceXFormView.prototype.constructor=ZaResourceXFormView;
ZaTabView.XFormModifiers.ZaResourceXFormView=new Array();
ZaResourceXFormView.TAB_INDEX=0;
ZaResourceXFormView.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/managing_resource.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaResourceXFormView.prototype.getTabIcon=function(){
if(this._containedObject&&this._containedObject.attrs&&this._containedObject.attrs[ZaResource.A_zimbraCalResType]==ZaResource.RESOURCE_TYPE_LOCATION){
return"Location"
}else{
return"Resource"
}};
ZaResourceXFormView.prototype.setObject=function(o){
this._containedObject=new ZaResource();
this._containedObject.attrs=new Object();
for(var e in o.attrs){
var t=this._localXForm.getModel().getItem(e);
if((t!=null&&t.type==_LIST_)||(o.attrs[e]!=null&&o.attrs[e] instanceof Array)){
this._containedObject.attrs[e]=ZaItem.deepCloneListItem(o.attrs[e])
}else{
this._containedObject.attrs[e]=o.attrs[e]
}}
this._containedObject.name=o.name;
this._containedObject.type=o.type;
if(o.id){
this._containedObject.id=o.id
}
if(o.rights){
this._containedObject.rights=o.rights
}
if(o.setAttrs){
this._containedObject.setAttrs=o.setAttrs
}
if(o.getAttrs){
this._containedObject.getAttrs=o.getAttrs
}
if(o._defaultValues){
this._containedObject._defaultValues=o._defaultValues
}
if(this._containedObject.attrs[ZaResource.A_COSId]){
this._containedObject[ZaResource.A2_autoCos]="FALSE"
}
if(!this._containedObject.attrs[ZaResource.A_COSId]){
this._containedObject[ZaResource.A2_autoCos]="TRUE"
}
if(this._containedObject.setAttrs[ZaResource.A_COSId]){
var n=ZaCos.getCosById(this._containedObject.attrs[ZaResource.A_COSId]);
this.cosChoices.setChoices([n]);
this.cosChoices.dirtyChoices()
}
if(o[ZaResource.A2_signatureList]){
this._containedObject[ZaResource.A2_signatureList]=o[ZaResource.A2_signatureList]
}else{
this._containedObject[ZaResource.A2_signatureList]=[]
}
this.signatureChoices.setChoices(ZaSignature.getSignatureChoices(this._containedObject[ZaResource.A2_signatureList]));
this.signatureChoices.dirtyChoices();
this._containedObject[ZaResource.A2_autodisplayname]="FALSE";
this._containedObject[ZaResource.A2_autoLocationName]=o[ZaResource.A2_autoLocationName];
ZaResource.prototype.setSchedulePolicyFromLdapAttrs.call(this._containedObject);
if(!o[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=o[ZaModel.currentTab]
}
this._localXForm.setInstance(this._containedObject);
this.setDirty(false);
this.formDirtyLsnr=new AjxListener(ZaApp.getInstance().getCurrentController(),ZaResourceController.prototype.handleXFormChange);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,this.formDirtyLsnr);
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,this.formDirtyLsnr)
};
ZaResourceXFormView.deleteCalFwdAddrButtonListener=function(){
var t=this.getInstance();
if(t[ZaResource.A2_calFwdAddr_selection_cache]!=null){
var s=t[ZaResource.A2_calFwdAddr_selection_cache].length;
if(s&&t.attrs[ZaResource.A_zimbraPrefCalendarForwardInvitesTo]){
var e=t.attrs[ZaResource.A_zimbraPrefCalendarForwardInvitesTo];
for(var n=0;
n<s;
n++){
var r=e.length-1;
for(var o=r;
o>=0;
o--){
if(e[o]==t[ZaResource.A2_calFwdAddr_selection_cache][n]){
e.splice(o,1);
break
}}}
this.getModel().setInstanceValue(t,ZaResource.A_zimbraPrefCalendarForwardInvitesTo,e);
this.getModel().setInstanceValue(t,ZaResource.A2_calFwdAddr_selection_cache,[])
}}
this.getForm().parent.setDirty(true)
};
ZaResourceXFormView.calFwdAddrSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_calFwdAddr_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_calFwdAddr_selection_cache,[])
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaResourceXFormView.editCalFwdAddrButtonListener.call(this)
}};
ZaResourceXFormView.editCalFwdAddrButtonListener=function(){
var e=this.getInstance();
if(e[ZaResource.A2_calFwdAddr_selection_cache]&&e[ZaResource.A2_calFwdAddr_selection_cache][0]){
var s=this.getForm().parent;
if(!s.editCalFwdAddrDlg){
s.editCalFwdAddrDlg=new ZaEditFwdAddrXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Edit_FwdAddr_Title);
s.editCalFwdAddrDlg.registerCallback(DwtDialog.OK_BUTTON,ZaAccountXFormView.updateCalFwdAddr,this.getForm(),null)
}
var n={};
n[ZaAccount.A_name]=e[ZaAccount.A2_calFwdAddr_selection_cache][0];
var o=e.attrs[ZaResource.A_zimbraPrefCalendarForwardInvitesTo].length;
for(var t=0;
t<o;
t++){
if(e[ZaResource.A2_calFwdAddr_selection_cache][0]==e.attrs[ZaResource.A_zimbraPrefCalendarForwardInvitesTo][t]){
n[ZaAlias.A_index]=t;
break
}}
s.editCalFwdAddrDlg.setObject(n);
s.editCalFwdAddrDlg.popup()
}};
ZaResourceXFormView.updateCalFwdAddr=function(){
if(this.parent.editCalFwdAddrDlg){
this.parent.editCalFwdAddrDlg.popdown();
var o=this.parent.editCalFwdAddrDlg.getObject();
var t=this.getInstance();
var e=t.attrs[ZaResource.A_zimbraPrefCalendarForwardInvitesTo];
if(o[ZaAlias.A_index]>=0&&e[o[ZaAlias.A_index]]!=o[ZaResource.A_name]){
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_calFwdAddr_selection_cache,[]);
e[o[ZaAlias.A_index]]=o[ZaResource.A_name];
this.getModel().setInstanceValue(t,ZaResource.A_zimbraPrefCalendarForwardInvitesTo,e);
this.parent.setDirty(true)
}}};
ZaResourceXFormView.addCalFwdAddrButtonListener=function(){
var e=this.getInstance();
var o=this.getForm().parent;
if(!o.addCalFwdAddrDlg){
o.addCalFwdAddrDlg=new ZaEditFwdAddrXDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Add_FwdAddr_Title);
o.addCalFwdAddrDlg.registerCallback(DwtDialog.OK_BUTTON,ZaResourceXFormView.addCalFwdAddr,this.getForm(),null)
}
var t={};
t[ZaAccount.A_name]="";
t[ZaAlias.A_index]=-1;
o.addCalFwdAddrDlg.setObject(t);
o.addCalFwdAddrDlg.popup()
};
ZaResourceXFormView.addCalFwdAddr=function(){
if(this.parent.addCalFwdAddrDlg){
this.parent.addCalFwdAddrDlg.popdown();
var t=this.parent.addCalFwdAddrDlg.getObject();
if(t[ZaResource.A_name]&&t[ZaResource.A_name].length>1){
var e=this.getInstance().attrs[ZaResource.A_zimbraPrefCalendarForwardInvitesTo];
e.push(t[ZaResource.A_name]);
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A_zimbraPrefCalendarForwardInvitesTo,e);
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_calFwdAddr_selection_cache,[]);
this.parent.setDirty(true)
}}};
ZaResourceXFormView.isEditCalFwdAddrEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaResource.A2_calFwdAddr_selection_cache))&&this.getInstanceValue(ZaResource.A2_calFwdAddr_selection_cache).length==1)
};
ZaResourceXFormView.isDeleteCalFwdAddrEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaResource.A2_calFwdAddr_selection_cache)))
};
ZaResourceXFormView.isAutoDisplayname=function(){
return(this.getInstanceValue(ZaResource.A2_autoLocationName)=="FALSE")
};
ZaResourceXFormView.SignatureSelectionListener=function(t){
var e=this.widget.getSelection();
if(e&&e.length){
e.sort();
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_signature_selection_cache,e)
}else{
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_signature_selection_cache,[])
}
if(t.detail==DwtListView.ITEM_DBL_CLICKED){
ZaResourceXFormView.editSignatureButtonListener.call(this)
}};
ZaResourceXFormView.editSignatureButtonListener=function(){
try{
var e=this.getInstance();
if(e[ZaResource.A2_signature_selection_cache]&&e[ZaResource.A2_signature_selection_cache][0]){
var n=this.getForm().parent;
if(!n.editSignatureDlg){
n.editSignatureDlg=new ZaEditSignatureDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Title_EditSignature);
n.editSignatureDlg.registerCallback(DwtDialog.OK_BUTTON,ZaResourceXFormView.updateSignature,this.getForm(),null)
}
var o=ZaUtil.deepCloneObject(e[ZaResource.A2_signature_selection_cache][0]);
n.editSignatureDlg.setObject(o);
n.editSignatureDlg.popup()
}}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaResourceXFormView.editSignatureButtonListener",null,false)
}};
ZaResourceXFormView.updateSignature=function(){
try{
if(this.parent.editSignatureDlg){
this.parent.editSignatureDlg.popdown();
var s=this.parent.editSignatureDlg.getObject();
var t=this.getInstance();
var e=t[ZaResource.A2_signatureList];
var o=ZaUtil.findValueInObjArrByPropertyName(e,s[ZaSignature.A2_id],ZaSignature.A2_id);
if(o!=-1&&!ZaSignature.compareObject(s,e[o])){
ZaSignature.ModifySignature.call(s,"id",t.id);
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_signature_selection_cache,[]);
e[o]=s;
this.getModel().setInstanceValue(t,ZaResource.A2_signatureList,e)
}}}
catch(n){
ZaApp.getInstance().getCurrentController()._handleException(n,"ZaResourceXFormView.updateSignature",null,false)
}};
ZaResourceXFormView.addSignatureButtonListener=function(){
try{
var e=this.getInstance();
var n=this.getForm().parent;
if(!n.addSignatureDlg){
n.addSignatureDlg=new ZaEditSignatureDialog(ZaApp.getInstance().getAppCtxt().getShell(),"400px","150px",ZaMsg.Title_CreateSignature);
n.addSignatureDlg.registerCallback(DwtDialog.OK_BUTTON,ZaResourceXFormView.addSignature,this.getForm(),null)
}
var o=new ZaSignature();
n.addSignatureDlg.setObject(o);
n.addSignatureDlg.popup()
}
catch(t){
ZaApp.getInstance().getCurrentController()._handleException(t,"ZaResourceXFormView.addSignatureButtonListener",null,false)
}};
ZaResourceXFormView.addSignature=function(){
try{
if(this.parent.addSignatureDlg){
this.parent.addSignatureDlg.popdown();
var r=this.parent.addSignatureDlg.getObject();
if(r[ZaSignature.A2_name]&&r[ZaSignature.A2_name].length>0){
var t=this.getInstance();
var e=t[ZaResource.A2_signatureList];
var n=ZaUtil.findValueInObjArrByPropertyName(e,r[ZaSignature.A2_name],ZaSignature.A2_name);
if(n==-1){
r=ZaSignature.CreateSignature.call(r,"id",t.id);
e.push(r);
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_signatureList,e);
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_signature_selection_cache,[])
}else{
var o=AjxMessageFormat.format(ZaMsg.SignatureExist,r[ZaSignature.A2_name]);
ZaApp.getInstance().getCurrentController().popupErrorDialog(o)
}}else{
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.CreateWarningMsg)
}}}
catch(s){
ZaApp.getInstance().getCurrentController()._handleException(s,"ZaResourceXFormView.addSignature",null,false)
}};
ZaResourceXFormView.deleteSignatureButtonListener=function(){
try{
var c=this.getInstance();
if(c[ZaResource.A2_signature_selection_cache]!=null){
var e=c[ZaResource.A2_signature_selection_cache].length;
if(e&&c[ZaResource.A2_signatureList]){
var o;
var s=false;
var d;
for(o=0;
o<e;
o++){
var l=c[ZaResource.A2_signature_selection_cache][o][ZaSignature.A2_id];
if(this.getInstanceValue(ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId)==l){
s=true;
d=AjxMessageFormat.format(ZaMsg.DeleteWarningAcceptMsg,c[ZaResource.A2_signature_selection_cache][o][ZaSignature.A2_name]);
break
}
if(this.getInstanceValue(ZaResource.A_zimbraPrefCalendarAutoDenySignatureId)==l){
s=true;
d=AjxMessageFormat.format(ZaMsg.DeleteWarningDenyMsg,c[ZaResource.A2_signature_selection_cache][o][ZaSignature.A2_name]);
break
}
if(this.getInstanceValue(ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId)==l){
d=AjxMessageFormat.format(ZaMsg.DeleteWarningDeclineMsg,c[ZaResource.A2_signature_selection_cache][o][ZaSignature.A2_name]);
s=true;
break
}}
if(!s){
var n=c[ZaResource.A2_signatureList];
for(o=0;
o<e;
o++){
var r=n.length-1;
for(var t=r;
t>=0;
t--){
if(n[t][ZaSignature.A2_id]==c[ZaResource.A2_signature_selection_cache][o][ZaSignature.A2_id]){
ZaSignature.DeleteSignature.call(c[ZaResource.A2_signature_selection_cache][o],"id",c.id);
n.splice(t,1);
break
}}}
this.getModel().setInstanceValue(c,ZaResource.A2_signatureList,n);
this.getModel().setInstanceValue(c,ZaResource.A2_signature_selection_cache,[])
}else{
ZaApp.getInstance().getCurrentController().popupErrorDialog(d)
}}}}
catch(h){
ZaApp.getInstance().getCurrentController()._handleException(h,"ZaResourceXFormView.deleteSignatureButtonListener",null,false)
}};
ZaResourceXFormView.isEditSignatureEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaResource.A2_signature_selection_cache))&&this.getInstanceValue(ZaResource.A2_signature_selection_cache).length==1)
};
ZaResourceXFormView.isDeleteSignatureEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaResource.A2_signature_selection_cache)))
};
ZaResourceXFormView.isSignatureSelectionEnabled=function(){
return(!AjxUtil.isEmpty(this.getInstanceValue(ZaResource.A2_signatureList)))
};
ZaResourceXFormView.isSignagureSectionVisible=function(){
return(ZaZimbraAdmin.haveTargetRight(ZaItem.RESOURCE,ZaResource.VIEW_RESOURCE_MAIL_RIGHT,this.getInstance().name)||ZaZimbraAdmin.haveTargetRight(ZaItem.RESOURCE,ZaResource.VIEW_RESOURCE_MAIL_RIGHT,ZaAccount.getDomain(this.getInstance().name)))
};
ZaResourceXFormView.CONTACT_TAB_ATTRS=[ZaResource.A_zimbraCalResContactName,ZaResource.A_zimbraCalResContactEmail,ZaResource.A_zimbraCalResContactPhone,ZaResource.A_contactInfoAutoComplete,ZaResource.A_locationDisplayName,ZaResource.A2_autoLocationName,ZaResource.A_zimbraCalResSite,ZaResource.A_zimbraCalResBuilding,ZaResource.A_zimbraCalResFloor,ZaResource.A_zimbraCalResRoom,ZaResource.A_zimbraCalResCapacity,ZaResource.A_street,ZaResource.A_city,ZaResource.A_state,ZaResource.A_country,ZaResource.A_zip];
ZaResourceXFormView.CONTACT_TAB_RIGHTS=[];
ZaResourceXFormView.myXFormModifier=function(c,f){
ZaResource.resTypeChoices=[{
value:ZaResource.RESOURCE_TYPE_LOCATION,label:ZaMsg.resType_location}
,{
value:ZaResource.RESOURCE_TYPE_EQUIPMENT,label:ZaMsg.resType_equipment}
];
ZaResource.schedulePolicyChoices=[{
value:ZaResource.SCHEDULE_POLICY_TT,label:ZaMsg.resScheduleTT}
,{
value:ZaResource.SCHEDULE_POLICY_FT,label:ZaMsg.resScheduleFT}
,{
value:ZaResource.SCHEDULE_POLICY_TF,label:ZaMsg.resScheduleTF}
,{
value:ZaResource.SCHEDULE_POLICY_FF,label:ZaMsg.resScheduleFF}
];
var o;
o=ZaSettings.myDomainName;
var h=[{
value:ZaResource.RESOURCE_TYPE_LOCATION,label:"Location_32"}
,{
value:ZaResource.RESOURCE_TYPE_EQUIPMENT,label:"Resource_32"}
];
var l=[{
type:_AJX_IMAGE_,ref:ZaResource.A_zimbraCalResType,src:"Resource_32",label:null,rowSpan:3,choices:h,cssStyle:"margin:auto;"}
,{
type:_OUTPUT_,ref:ZaResource.A_displayname,label:null,cssClass:"AdminTitle",height:"auto",width:350,rowSpan:3,cssStyle:"word-wrap:break-word;overflow:hidden;",visibilityChecks:[ZaItem.hasReadPermission]}
];
if(ZaItem.hasReadPermission(ZaItem.A_zimbraId,f)){
l.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraId,label:ZaMsg.NAD_ZimbraID}
)
}
if(ZaItem.hasReadPermission(ZaItem.A_zimbraCreateTimestamp,f)){
l.push({
type:_OUTPUT_,ref:ZaItem.A_zimbraCreateTimestamp,label:ZaMsg.LBL_zimbraCreateTimestamp,labelLocation:_LEFT_,getDisplayValue:function(){
var w=ZaItem.formatServerTime(this.getInstanceValue());
if(!w){
return ZaMsg.Server_Time_NA
}else{
return w
}}}
)
}
if(ZaItem.hasReadPermission(ZaResource.A_mailHost,f)){
l.push({
type:_OUTPUT_,ref:ZaResource.A_mailHost,labelLocation:_LEFT_,label:ZaMsg.NAD_MailServer}
)
}
if(ZaItem.hasReadPermission(ZaResource.A_name,f)){
l.push({
type:_OUTPUT_,ref:ZaResource.A_name,label:ZaMsg.NAD_Email,labelLocation:_LEFT_,required:false}
)
}
if(ZaItem.hasReadPermission(ZaResource.A_accountStatus,f)){
l.push({
type:_OUTPUT_,ref:ZaResource.A_accountStatus,label:ZaMsg.NAD_ResourceStatus,labelLocation:_LEFT_,choices:ZaResource.accountStatusChoices}
)
}
if(ZaItem.hasReadPermission(ZaResource.A_zimbraCalResType,f)){
l.push({
type:_OUTPUT_,ref:ZaResource.A_zimbraCalResType,label:ZaMsg.NAD_ResType,labelLocation:_LEFT_,required:false,getDisplayValue:ZaResource.getResTypeLabel}
)
}
this.tabChoices=new Array();
var n;
var s=++this.TAB_INDEX;
this.tabChoices.push({
value:s,label:ZaMsg.TABT_ResourceProperties}
);
this.helpMap={};
this.helpMap[s]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/managing_resource.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
if(ZaTabView.isTAB_ENABLED(f,ZaResourceXFormView.CONTACT_TAB_ATTRS,ZaResourceXFormView.CONTACT_TAB_RIGHTS)){
n=++this.TAB_INDEX;
this.tabChoices.push({
value:n,label:ZaMsg.TABT_ResLocationContact}
)
}
var g=[];
var p={
type:_TOP_GROUPER_,label:ZaMsg.NAD_ResourceNameGrouper,id:"resource_form_name_group",colSizes:["275px","*"],numCols:2,items:[{
ref:ZaResource.A_displayname,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ResourceName,label:ZaMsg.NAD_ResourceName,labelLocation:_LEFT_,width:"200px"}
,{
ref:ZaResource.A_name,type:_EMAILADDR_,msgName:ZaMsg.NAD_ResAccountName,label:ZaMsg.NAD_ResAccountName,labelLocation:_LEFT_,enableDisableChecks:[[XFormItem.prototype.hasRight,ZaResource.RENAME_CALRES_RIGHT]],visibilityChecks:[]}
]};
var d={
type:_TOP_GROUPER_,label:ZaMsg.NAD_ResourceSetupGrouper,id:"resource_form_setup_group",colSizes:["275px","*"],numCols:2,items:[{
ref:ZaResource.A_zimbraCalResType,type:_OSELECT1_,msgName:ZaMsg.NAD_ResType,label:ZaMsg.NAD_ResType,labelLocation:_LEFT_,choices:ZaResource.resTypeChoices}
]};
d.items.push({
type:_GROUP_,numCols:3,nowrap:true,label:ZaMsg.NAD_ClassOfService,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasWritePermission,ZaResource.A_COSId]],items:[{
ref:ZaResource.A_COSId,type:_INPUT_,onChange:ZaAccount.setCosChanged,enableDisableChecks:[[XForm.checkInstanceValue,ZaResource.A2_autoCos,"FALSE"]],enableDisableChangeEventSources:[ZaResource.A2_autoCos],getDisplayValue:function(v){
this.createDataList(ZaApp.getInstance().getCosListName());
if(v){
var w=ZaCos.getCosById(v);
return w&&w.name
}}}
,{
ref:ZaResource.A2_autoCos,type:_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,subLabel:"",trueValue:"TRUE",falseValue:"FALSE",elementChanged:function(k,v,w){
this.getForm().parent.setDirty(true);
if(k=="TRUE"){
ZaAccount.setDefaultCos(this.getInstance(),this.getForm().parent._app);
this.getParentItem().getItems()[0].updateElement(null)
}
this.getForm().itemChanged(this,k,w)
}
,enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_COSId]],visibilityChecks:[]}
]}
);
d.items.push({
ref:ZaResource.A_accountStatus,type:_OSELECT1_,editable:false,msgName:ZaMsg.NAD_ResourceStatus,label:ZaMsg.NAD_ResourceStatus,labelLocation:_LEFT_,choices:ZaResource.accountStatusChoices}
);
d.items.push({
ref:ZaResource.A_zimbraCalResAutoDeclineRecurring,type:_CHECKBOX_,msgName:ZaMsg.NAD_DeclineRecurring,label:ZaMsg.NAD_DeclineRecurring,trueValue:"TRUE",falseValue:"FALSE"}
);
d.items.push({
ref:ZaResource.A2_schedulePolicy,type:_OSELECT1_,msgName:ZaMsg.NAD_ResType,label:ZaMsg.NAD_SchedulePolicy,visibilityChecks:[[ZaItem.hasWritePermission,ZaResource.A_zimbraCalResAutoAcceptDecline],[ZaItem.hasWritePermission,ZaResource.A_zimbraCalResAutoDeclineIfBusy]],enableDisableChecks:[[ZaItem.hasReadPermission,ZaResource.A_zimbraCalResAutoAcceptDecline],[ZaItem.hasReadPermission,ZaResource.A_zimbraCalResAutoDeclineIfBusy]],labelLocation:_LEFT_,width:"320px",choices:ZaResource.schedulePolicyChoices}
);
d.items.push({
ref:ZaResource.A_zimbraCalResMaxNumConflictsAllowed,type:_TEXTFIELD_,msgName:ZaMsg.zimbraCalResMaxNumConflictsAllowed,label:ZaMsg.zimbraCalResMaxNumConflictsAllowed,enableDisableChecks:[ZaResource.isAutoDeclineEnabled,[XForm.checkInstanceValueNot,ZaResource.A_zimbraCalResAutoDeclineRecurring,"TRUE"]],enableDisableChangeEventSources:[ZaResource.A2_schedulePolicy,ZaResource.A_zimbraCalResAutoDeclineRecurring],labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
);
d.items.push({
ref:ZaResource.A_zimbraCalResMaxPercentConflictsAllowed,type:_TEXTFIELD_,msgName:ZaMsg.zimbraCalResMaxPercentConflictsAllowed,label:ZaMsg.zimbraCalResMaxPercentConflictsAllowed,enableDisableChecks:[ZaResource.isAutoDeclineEnabled,[XForm.checkInstanceValueNot,ZaResource.A_zimbraCalResAutoDeclineRecurring,"TRUE"]],enableDisableChangeEventSources:[ZaResource.A2_schedulePolicy,ZaResource.A_zimbraCalResAutoDeclineRecurring],labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
);
var e={
type:_GROUP_,id:"resource_form_forwarding_group",numCols:2,label:null,colSizes:["275px","425px"],colSpan:"*",visibilityChecks:[[ZaItem.hasReadPermission,ZaResource.A_zimbraPrefCalendarForwardInvitesTo]],items:[{
ref:ZaResource.A_zimbraPrefCalendarForwardInvitesTo,type:_DWT_LIST_,height:"100",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,onSelection:ZaResourceXFormView.calFwdAddrSelectionListener,label:ZaMsg.zimbraPrefCalendarForwardInvitesTo,visibilityChecks:[ZaItem.hasReadPermission],labelCssClass:"gridGroupBodyLabel",labelCssStyle:"text-align:left;border-right:1px solid;"}
,{
type:_GROUP_,numCols:6,width:"625px",colSizes:["275","100px","auto","100px","auto","100px"],colSpan:2,cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaResourceXFormView.deleteCalFwdAddrButtonListener.call(this);",enableDisableChecks:[ZaResourceXFormView.isDeleteCalFwdAddrEnabled,[ZaItem.hasWritePermission,ZaResource.A_zimbraPrefCalendarForwardInvitesTo]],enableDisableChangeEventSources:[ZaResource.A2_calFwdAddr_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaResourceXFormView.editCalFwdAddrButtonListener.call(this);",enableDisableChecks:[ZaResourceXFormView.isEditCalFwdAddrEnabled,[ZaItem.hasWritePermission,ZaResource.A_zimbraPrefCalendarForwardInvitesTo]],enableDisableChangeEventSources:[ZaResource.A2_calFwdAddr_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChecks:[[ZaItem.hasWritePermission,ZaResource.A_zimbraPrefCalendarForwardInvitesTo]],onActivate:"ZaResourceXFormView.addCalFwdAddrButtonListener.call(this);"}
]}
]};
d.items.push(e);
var r={
type:_TOP_GROUPER_,label:ZaMsg.NAD_PasswordGrouper,id:"resource_form_password_group",visibilityChecks:[[XFormItem.prototype.hasAnyRight,[ZaResource.SET_CALRES_PASSWORD_RIGHT,ZaResource.CHANGE_CALRES_PASSWORD_RIGHT]]],colSizes:["275px","*"],numCols:2,items:[{
ref:ZaResource.A_password,type:_SECRET_,msgName:ZaMsg.NAD_Password,label:ZaMsg.NAD_Password,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaResource.A2_confirmPassword,type:_SECRET_,msgName:ZaMsg.NAD_ConfirmPassword,label:ZaMsg.NAD_ConfirmPassword,labelLocation:_LEFT_,cssClass:"admin_xform_name_input",visibilityChecks:[],enableDisableChecks:[]}
]};
var t={
type:_TOP_GROUPER_,label:ZaMsg.NAD_SignatureGrouper,id:"resource_form_signature_group",visibilityChecks:[ZaResourceXFormView.isSignagureSectionVisible],colSizes:["275px","*"],numCols:2,items:[{
type:_GROUP_,id:"resource_form_allsignature_group",numCols:2,label:null,colSizes:["275px","*"],colSpan:"*",items:[{
ref:ZaResource.A2_signatureList,type:_DWT_LIST_,height:"100",width:"350px",forceUpdate:true,preserveSelection:false,multiselect:true,cssClass:"DLSource",headerList:null,label:ZaMsg.NAD_AllSignature,labelCssClass:"gridGroupBodyLabel",labelCssStyle:"text-align:left;border-right:1px solid;",onSelection:ZaResourceXFormView.SignatureSelectionListener,bmolsnr:true,getDisplayValue:function(x){
var k=this.getForm().parent;
var w=this.getInstance();
var v=ZaSignature.getSignatureChoices(w[ZaResource.A2_signatureList]);
k.signatureChoices.setChoices(v);
k.signatureChoices.dirtyChoices();
return x
}}
,{
type:_GROUP_,numCols:6,width:"625px",colSizes:["275","100px","auto","100px","auto","100px"],colSpan:2,cssStyle:"margin:10px;padding-bottom:0;",items:[{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Delete,width:"100px",onActivate:"ZaResourceXFormView.deleteSignatureButtonListener.call(this);",enableDisableChecks:[ZaResourceXFormView.isDeleteSignatureEnabled],enableDisableChangeEventSources:[ZaResource.A2_signature_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.TBB_Edit,width:"100px",onActivate:"ZaResourceXFormView.editSignatureButtonListener.call(this);",enableDisableChecks:[ZaResourceXFormView.isEditSignatureEnabled],enableDisableChangeEventSources:[ZaResource.A2_signature_selection_cache]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.NAD_Add,width:"100px",enableDisableChecks:[[ZaItem.hasWritePermission,ZaResource.A_zimbraPrefCalendarForwardInvitesTo]],onActivate:"ZaResourceXFormView.addSignatureButtonListener.call(this);"}
]}
]}
,{
ref:ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId,type:_OSELECT1_,msgName:ZaMsg.NAD_zimbraPrefCalendarAutoAcceptSignatureId,width:"280px",label:ZaMsg.NAD_zimbraPrefCalendarAutoAcceptSignatureId,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[ZaResourceXFormView.isSignatureSelectionEnabled],enableDisableChangeEventSources:[ZaResource.A2_signatureList],valueChangeEventSources:[ZaResource.A2_signatureList],choices:this.signatureChoices}
,{
ref:ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId,type:_OSELECT1_,msgName:ZaMsg.NAD_zimbraPrefCalendarAutoDeclineSignatureId,width:"280px",label:ZaMsg.NAD_zimbraPrefCalendarAutoDeclineSignatureId,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[ZaResourceXFormView.isSignatureSelectionEnabled],enableDisableChangeEventSources:[ZaResource.A2_signatureList],valueChangeEventSources:[ZaResource.A2_signatureList],choices:this.signatureChoices}
,{
ref:ZaResource.A_zimbraPrefCalendarAutoDenySignatureId,type:_OSELECT1_,msgName:ZaMsg.NAD_zimbraPrefCalendarAutoDenySignatureId,width:"280px",label:ZaMsg.NAD_zimbraPrefCalendarAutoDenySignatureId,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[ZaResourceXFormView.isSignatureSelectionEnabled],enableDisableChangeEventSources:[ZaResource.A2_signatureList],valueChangeEventSources:[ZaResource.A2_signatureList],choices:this.signatureChoices}
]};
var b={
type:_TOP_GROUPER_,label:ZaMsg.NAD_NotesGrouper,id:"resource_form_notes_group",colSizes:["275px","*"],numCols:2,items:[ZaItem.descriptionXFormItem,{
ref:ZaResource.A_notes,type:_TEXTAREA_,width:"300px",msgName:ZaMsg.NAD_Notes,label:ZaMsg.NAD_Notes,labelLocation:_LEFT_}
]};
var m={
type:_ZATABCASE_,numCols:1,caseKey:s,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[p,d,r,t,b]};
g.push(m);
var y=200;
if(n){
this.helpMap[n]=[location.pathname,ZaUtil.HELP_URL,"managing_accounts/managing_resource.htm","?locid=",AjxEnv.DEFAULT_LOCALE].join("");
var u={
type:_ZATABCASE_,numCols:1,caseKey:n,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,items:[{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_ContactInfo,items:[{
ref:ZaResource.A_zimbraCalResContactName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ContactName,label:ZaMsg.NAD_ContactName,labelLocation:_LEFT_,width:y}
,{
ref:ZaResource.A_zimbraCalResContactEmail,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ContactEmail,label:ZaMsg.NAD_ContactEmail,labelLocation:_LEFT_,width:y}
,{
ref:ZaResource.A_zimbraCalResContactPhone,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ContactPhone,label:ZaMsg.NAD_ContactPhone,labelLocation:_LEFT_,width:y}
,{
ref:ZaResource.A_contactInfoAutoComplete,type:_AUTO_COMPLETE_LIST_,matchValue:ZaContactList.matchValue,matchText:ZaContactList.matchText,dataLoaderClass:ZaContactList,dataLoaderMethod:ZaContactList.prototype.getContactList,compCallback:ZaContactList.prototype._autocompleteCallback,inputFieldElementId:ZaResource.A_zimbraCalResContactName}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_LocationInfo,colSizes:["275px","*"],numCols:2,items:[{
type:_GROUP_,numCols:3,colSizes:["156px","22px","100px"],nowrap:true,msgName:ZaMsg.NAD_LocationDisplayName,label:ZaMsg.NAD_LocationDisplayName,labelLocation:_LEFT_,items:[{
ref:ZaResource.A_locationDisplayName,type:_TEXTFIELD_,label:null,cssClass:"admin_xform_name_input",width:y,enableDisableChecks:[ZaResourceXFormView.isAutoDisplayname],enableDisableChangeEventSources:[ZaResource.A2_autoLocationName],bmolsnr:true}
,{
ref:ZaResource.A2_autoLocationName,type:_CHECKBOX_,msgName:ZaMsg.NAD_Auto,subLabel:"",label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",elementChanged:ZaResource.setAutoLocationName}
]}
,{
ref:ZaResource.A_zimbraCalResSite,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Site,label:ZaMsg.NAD_Site,labelLocation:_LEFT_,width:y,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResBuilding,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Building,label:ZaMsg.NAD_Building,labelLocation:_LEFT_,width:y,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResFloor,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Floor,label:ZaMsg.NAD_Floor,labelLocation:_LEFT_,width:y,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResRoom,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Room,label:ZaMsg.NAD_Room,labelLocation:_LEFT_,width:y,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResCapacity,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Capacity,label:ZaMsg.NAD_Capacity,labelLocation:_LEFT_,width:y,visibilityChecks:[ZaResource.isLocation],visibilityChangeEventSources:[ZaResource.A_zimbraCalResType]}
]}
,{
type:_ZA_TOP_GROUPER_,label:ZaMsg.NAD_Address,items:ZaAccountXFormView.getAddressFormItem()}
]};
g.push(u)
}
c.tableCssStyle="width:100%;";
c.items=[{
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:4,colSizes:["60px","*","80px","*"],items:l}
]}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,choices:this.tabChoices,cssClass:"ZaTabBar",cssStyle:"display:none;",id:"xform_tabbar"}
,{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:g}
]
};
ZaTabView.XFormModifiers.ZaResourceXFormView.push(ZaResourceXFormView.myXFormModifier);
ZaResourceXFormView.prototype.getTabChoices=function(){
return this.tabChoices
}
}
if(AjxPackage.define("zimbraAdmin.resource.view.ZaNewResourceXWizard")){
ZaNewResourceXWizard=function(e){
ZaXWizardDialog.call(this,e,null,ZaMsg.NCD_NewResTitle,"760px","300px","ZaNewResourceXWizard",null,ZaId.DLG_NEW_RES);
this.TAB_INDEX=0;
ZaNewResourceXWizard.step1=++this.TAB_INDEX;
ZaNewResourceXWizard.step2=++this.TAB_INDEX;
ZaNewResourceXWizard.step3=++this.TAB_INDEX;
if(!ZaResource.accountStatusChoices){
ZaResource.accountStatusChoices=[{
value:ZaResource.ACCOUNT_STATUS_ACTIVE,label:ZaResource.getAccountStatusLabel(ZaResource.ACCOUNT_STATUS_ACTIVE)}
,{
value:ZaResource.ACCOUNT_STATUS_CLOSED,label:ZaResource.getAccountStatusLabel(ZaResource.ACCOUNT_STATUS_CLOSED)}
]
}
this.stepChoices=[{
label:ZaMsg.TABT_ResourceProperties,value:ZaNewResourceXWizard.step1}
,{
label:ZaMsg.TABT_ResLocationContact,value:ZaNewResourceXWizard.step2}
,{
label:ZaMsg.TABT_SignatureProperties,value:ZaNewResourceXWizard.step3}
];
this.signatureChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
this._lastStep=this.stepChoices.length;
this.initForm(ZaResource.myXModel,this.getMyXForm());
this._localXForm.setController(ZaApp.getInstance());
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaNewResourceXWizard.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaNewResourceXWizard.prototype.handleXFormChange));
this._helpURL=ZaNewResourceXWizard.helpURL;
this._domains={}
};
ZaNewResourceXWizard.prototype=new ZaXWizardDialog;
ZaNewResourceXWizard.prototype.constructor=ZaNewResourceXWizard;
ZaXDialog.XFormModifiers.ZaNewResourceXWizard=new Array();
ZaNewResourceXWizard.helpURL=location.pathname+ZaUtil.HELP_URL+"managing_accounts/managing_resource.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaNewResourceXWizard.prototype.handleXFormChange=function(){
if(this._localXForm.hasErrors()){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false)
}else{
if(this._containedObject.attrs[ZaResource.A_displayname]&&this._containedObject[ZaResource.A_name].indexOf("@")>0){
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(true);
if(this._containedObject[ZaModel.currentStep]!=this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true)
}
if(this._containedObject[ZaModel.currentStep]!=1){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}}}};
ZaNewResourceXWizard.prototype.popup=function(e){
ZaXWizardDialog.prototype.popup.call(this,e);
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.FINISH_BUTTON].setEnabled(false);
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
};
ZaNewResourceXWizard.prototype.createDomainAndAccount=function(t){
try{
var n=new ZaDomain();
n.name=t;
n.attrs[ZaDomain.A_domainName]=t;
var o=ZaItem.create(n,ZaDomain,"ZaDomain");
if(o!=null){
ZaApp.getInstance().getCurrentController().closeCnfrmDelDlg();
this.finishWizard()
}}
catch(e){
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewResourceXWizard.prototype.createDomainAndAccount",null,false)
}};
ZaNewResourceXWizard.prototype.finishWizard=function(){
try{
if(!ZaResource.checkValues(this._containedObject)){
return false
}
var t=ZaItem.create(this._containedObject,ZaResource,"ZaResource");
if(t!=null){
ZaApp.getInstance().getResourceController().fireCreationEvent(t);
this.popdown();
ZaApp.getInstance().getAppCtxt().getAppController().setActionStatusMsg(AjxMessageFormat.format(ZaMsg.ResourceCreated,[t.name]))
}}
catch(e){
switch(e.code){
case ZmCsfeException.ACCT_EXISTS:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_ACCOUNT_EXISTS);
break;
case ZmCsfeException.ACCT_INVALID_PASSWORD:ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_INVALID,e);
ZaApp.getInstance().getAppCtxt().getErrorDialog().showDetail(true);
break;
case ZmCsfeException.NO_SUCH_COS:ZaApp.getInstance().getCurrentController().popupErrorDialog(AjxMessageFormat.format(ZaMsg.ERROR_NO_SUCH_COS,[this._containedObject.attrs[ZaAccount.A_COSId]]),e);
break;
case ZmCsfeException.SIGNATURE_EXISTS:this.popdown();
ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewResourceXWizard.prototype.finishWizard",null,false);
break;
case ZmCsfeException.NO_SUCH_DOMAIN:ZaApp.getInstance().dialogs.confirmMessageDialog2.setMessage(AjxMessageFormat.format(ZaMsg.CreateDomain_q,[ZaAccount.getDomain(this._containedObject.name)]),DwtMessageDialog.WARNING_STYLE);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.YES_BUTTON,this.createDomainAndAccount,this,[ZaAccount.getDomain(this._containedObject.name)]);
ZaApp.getInstance().dialogs.confirmMessageDialog2.registerCallback(DwtDialog.NO_BUTTON,ZaController.prototype.closeCnfrmDelDlg,ZaApp.getInstance().getCurrentController(),null);
ZaApp.getInstance().dialogs.confirmMessageDialog2.popup();
break;
default:ZaApp.getInstance().getCurrentController()._handleException(e,"ZaNewResourceXWizard.prototype.finishWizard",null,false);
break
}}};
ZaNewResourceXWizard.prototype.goNext=function(){
if(this._containedObject[ZaModel.currentStep]==1){
if(this._containedObject.attrs[ZaResource.A_password]){
if(this._containedObject.attrs[ZaResource.A_password]!=this._containedObject[ZaResource.A2_confirmPassword]){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_PASSWORD_MISMATCH);
return false
}}
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true);
var n={
query:["(|(uid=",this._containedObject[ZaResource.A_name],")(cn=",this._containedObject[ZaResource.A_name],")(sn=",this._containedObject[ZaResource.A_name],")(gn=",this._containedObject[ZaResource.A_name],")(mail=",this._containedObject[ZaResource.A_name],")(zimbraMailDeliveryAddress=",this._containedObject[ZaResource.A_name],"))"].join(""),limit:2,applyCos:0,controller:ZaApp.getInstance().getCurrentController(),types:[ZaSearch.DLS,ZaSearch.ALIASES,ZaSearch.ACCOUNTS,ZaSearch.RESOURCES]};
var o=ZaSearch.searchDirectory(n).Body.SearchDirectoryResponse;
var t=new ZaItemList();
t.loadFromJS(o);
if(t.size()>0){
var e=t.getArray()[0];
if(e.type==ZaItem.ALIAS){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_aliasWithThisNameExists)
}else{
if(e.type==ZaItem.RESOURCE){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_resourceWithThisNameExists)
}else{
if(e.type==ZaItem.DL){
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_dlWithThisNameExists)
}else{
ZaApp.getInstance().getCurrentController().popupErrorDialog(ZaMsg.ERROR_accountWithThisNameExists)
}}}
return false
}
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(true)
}
this.goPage(this._containedObject[ZaModel.currentStep]+1);
if(this._containedObject[ZaModel.currentStep]==this._lastStep){
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(false)
}};
ZaNewResourceXWizard.prototype.goPrev=function(){
if(this._containedObject[ZaModel.currentStep]==2){
this._button[DwtWizardDialog.PREV_BUTTON].setEnabled(false)
}
this._button[DwtWizardDialog.NEXT_BUTTON].setEnabled(true);
this.goPage(this._containedObject[ZaModel.currentStep]-1)
};
ZaNewResourceXWizard.prototype.setObject=function(n){
this._containedObject=new ZaResource();
this._containedObject.attrs=new Object();
for(var e in n.attrs){
this._containedObject.attrs[e]=n.attrs[e]
}
if(n.name){
this._containedObject.name=n.name
}
if(n.rights){
this._containedObject.rights=n.rights
}
if(n.setAttrs){
this._containedObject.setAttrs=n.setAttrs
}
if(n.getAttrs){
this._containedObject.getAttrs=n.getAttrs
}
if(n._defaultValues){
this._containedObject._defaultValues=n._defaultValues
}
this._containedObject.id=n.id||null;
if(n._uuid){
this._containedObject._uuid=n._uuid
}
this._containedObject.attrs[ZaResource.A_zimbraCalResType]=n.attrs[ZaResource.A_zimbraCalResType]||ZaResource.RESOURCE_TYPE_LOCATION;
this._containedObject[ZaResource.A2_schedulePolicy]=n[ZaResource.A2_schedulePolicy]||ZaResource.SCHEDULE_POLICY_TT;
this._containedObject.attrs[ZaResource.A_accountStatus]=n.attrs[ZaResource.A_accountStatus]||ZaResource.ACCOUNT_STATUS_ACTIVE;
this._containedObject[ZaResource.A2_autodisplayname]=n[ZaResource.A2_autodisplayname]||"TRUE";
this._containedObject[ZaResource.A2_autoMailServer]=n[ZaResource.A2_autoMailServer]||"TRUE";
this._containedObject[ZaResource.A2_autoCos]=n[ZaResource.A2_autoCos]||"TRUE";
this._containedObject[ZaResource.A2_autoLocationName]=n[ZaResource.A2_autoLocationName]||"TRUE";
this._containedObject[ZaResource.A2_confirmPassword]=n[ZaResource.A2_confirmPassword]||null;
this._containedObject[ZaModel.currentStep]=n[ZaModel.currentStep]||1;
this._containedObject[ZaResource.A2_signatureList]=n[ZaResource.A2_signatureList]||[];
this.signatureChoices.setChoices(ZaSignature.getNewSignatureChoices(this._containedObject[ZaResource.A2_signatureList]));
this.signatureChoices.dirtyChoices();
var o;
if(!o){
try{
o=ZaApp.getInstance().getGlobalConfig().attrs[ZaGlobalConfig.A_zimbraDefaultDomainName]
}
catch(t){
if(t.code!=ZmCsfeException.SVC_PERM_DENIED){
throw (t)
}}}
if(!o){
o=ZaSettings.myDomainName
}
if(n[ZaResource.A_name]){
this._containedObject[ZaResource.A_name]=n[ZaResource.A_name]
}else{
this._containedObject[ZaResource.A_name]="@"+o
}
this._localXForm.setInstance(this._containedObject)
};
ZaNewResourceXWizard.onCOSChanged=function(o,t,e){
if(ZaItem.ID_PATTERN.test(o)){
e.getInstance()._defaultValues=ZaCos.getCosById(o,e.parent._app);
this.setInstanceValue(o)
}else{
e.getInstance()._defaultValues=ZaCos.getCosByName(o,e.parent._app);
if(e.getInstance().cos){
o=e.getInstance()._defaultValues.id
}}
this.setInstanceValue(o);
e.parent._isCosChanged=true;
return o
};
ZaNewResourceXWizard.isAutoDisplayname=ZaResourceXFormView.isAutoDisplayname;
ZaNewResourceXWizard.myXFormModifier=function(n){
ZaResource.resTypeChoices=[{
value:ZaResource.RESOURCE_TYPE_LOCATION,label:ZaMsg.resType_location}
,{
value:ZaResource.RESOURCE_TYPE_EQUIPMENT,label:ZaMsg.resType_equipment}
];
ZaResource.schedulePolicyChoices=[{
value:ZaResource.SCHEDULE_POLICY_TT,label:ZaMsg.resScheduleTT}
,{
value:ZaResource.SCHEDULE_POLICY_FT,label:ZaMsg.resScheduleFT}
,{
value:ZaResource.SCHEDULE_POLICY_TF,label:ZaMsg.resScheduleTF}
,{
value:ZaResource.SCHEDULE_POLICY_FF,label:ZaMsg.resScheduleFF}
];
var t;
t=ZaSettings.myDomainName;
var c="@"+t;
var u=new Array();
this.cosChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"id","name");
var d={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_ResourceNameGrouper,id:"resource_wiz_name_group",numCols:2,items:[{
ref:ZaResource.A_displayname,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ResourceName,label:ZaMsg.NAD_ResourceName,labelLocation:_LEFT_,elementChanged:function(k,w,b){
if(this.getInstance()[ZaResource.A2_autodisplayname]=="TRUE"){
try{
var p=this.getInstanceValue(ZaResource.A_name);
var v=/[^a-zA-Z0-9_\-\.]/g;
var g=k.replace(v,"")+p.substring(p.indexOf("@"));
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A_name,g);
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_autodisplayname,"TRUE")
}
catch(y){
ZaApp.getInstance().getCurrentController()._handleException(y,"XForm."+ZaResource.A_displayname+".elementChanged",null,false)
}}
this.getForm().itemChanged(this,k,b)
}}
,{
ref:ZaResource.A_name,type:_EMAILADDR_,msgName:ZaMsg.NAD_ResAccountName,label:ZaMsg.NAD_ResAccountName,labelLocation:_LEFT_,id:"resource_email_addr",bmolsnr:true,onChange:function(y,g,p){
this.getModel().setInstanceValue(this.getInstance(),ZaResource.A2_autodisplayname,"FALSE");
this.setInstanceValue(y)
}
,visibilityChecks:[],enableDisableChecks:[]}
]};
var s={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_ResourceSetupGrouper,id:"resource_wiz_name_group",numCols:2,items:[{
ref:ZaResource.A_zimbraCalResType,type:_OSELECT1_,msgName:ZaMsg.NAD_ResType,label:ZaMsg.NAD_ResType,labelLocation:_LEFT_,choices:ZaResource.resTypeChoices,visibilityChecks:[],enableDisableChecks:[]}
]};
s.items.push({
type:_GROUP_,numCols:3,nowrap:true,label:ZaMsg.NAD_ClassOfService,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_COSId]],items:[{
ref:ZaResource.A_COSId,type:_INPUT_,label:null,onChange:ZaAccount.setCosChanged,enableDisableChecks:[[XForm.checkInstanceValue,ZaResource.A2_autoCos,"FALSE"]],enableDisableChangeEventSources:[ZaResource.A2_autoCos],getDisplayValue:function(g){
if(g){
var p=ZaCos.getCosById(g);
return p&&p.name
}}}
,{
ref:ZaResource.A2_autoCos,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",elementChanged:function(w,y,g){
var b=this.getParentItem().getItems()[0];
var p=this.getForm();
if(w=="TRUE"){
b.updateElement(null);
ZaAccount.setDefaultCos(this.getInstance(),p.parent._app)
}else{
b.createDataList(ZaApp.getInstance().getCosListName())
}
p.itemChanged(this,w,g)
}
,visibilityChecks:[],enableDisableChecks:[[ZaItem.hasWritePermission,ZaAccount.A_COSId]]}
]}
);
s.items.push({
ref:ZaResource.A_accountStatus,type:_OSELECT1_,editable:false,msgName:ZaMsg.NAD_ResourceStatus,label:ZaMsg.NAD_ResourceStatus,labelLocation:_LEFT_,choices:ZaResource.accountStatusChoices,visibilityChecks:[[ZaItem.hasWritePermission,ZaResource.A_accountStatus]],enableDisableChecks:[]}
);
s.items.push({
ref:ZaResource.A_zimbraCalResAutoDeclineRecurring,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_DeclineRecurring,label:ZaMsg.NAD_DeclineRecurring,labelCssClass:"xform_label",align:_LEFT_,labelLocation:_LEFT_,trueValue:"TRUE",falseValue:"FALSE"}
);
s.items.push({
ref:ZaResource.A2_schedulePolicy,type:_OSELECT1_,msgName:ZaMsg.NAD_ResType,visibilityChecks:[[ZaItem.hasWritePermission,ZaResource.A_zimbraCalResAutoAcceptDecline],[ZaItem.hasWritePermission,ZaResource.A_zimbraCalResAutoDeclineIfBusy]],enableDisableChecks:[],label:ZaMsg.NAD_SchedulePolicy,labelLocation:_LEFT_,choices:ZaResource.schedulePolicyChoices}
);
s.items.push({
ref:ZaResource.A_zimbraCalResMaxNumConflictsAllowed,type:_TEXTFIELD_,msgName:ZaMsg.zimbraCalResMaxNumConflictsAllowed,label:ZaMsg.zimbraCalResMaxNumConflictsAllowed,enableDisableChecks:[ZaResource.isAutoDeclineEnabled,[XForm.checkInstanceValueNot,ZaResource.A_zimbraCalResAutoDeclineRecurring,"TRUE"]],enableDisableChangeEventSources:[ZaResource.A_zimbraCalResAutoDeclineRecurring,ZaResource.A2_schedulePolicy],labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
);
s.items.push({
ref:ZaResource.A_zimbraCalResMaxPercentConflictsAllowed,type:_TEXTFIELD_,msgName:ZaMsg.zimbraCalResMaxPercentConflictsAllowed,label:ZaMsg.zimbraCalResMaxPercentConflictsAllowed,enableDisableChecks:[ZaResource.isAutoDeclineEnabled,[XForm.checkInstanceValueNot,ZaResource.A_zimbraCalResAutoDeclineRecurring,"TRUE"]],enableDisableChangeEventSources:[ZaResource.A_zimbraCalResAutoDeclineRecurring,ZaResource.A2_schedulePolicy],labelLocation:_LEFT_,cssClass:"admin_xform_number_input"}
);
s.items.push({
type:_GROUP_,numCols:3,nowrap:true,label:ZaMsg.NAD_MailServer,labelLocation:_LEFT_,visibilityChecks:[[ZaItem.hasWritePermission,ZaAccount.A_mailHost]],items:[{
ref:ZaResource.A_mailHost,type:_OSELECT1_,label:null,editable:false,choices:ZaApp.getInstance().getServerListChoices(),visibilityChecks:[],enableDisableChecks:[ZaAccount.isAutoMailServer],enableDisableChangeEventSources:[ZaResource.A2_autoMailServer]}
,{
ref:ZaResource.A2_autoMailServer,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_Auto,visibilityChecks:[],enableDisableChecks:[],label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE"}
]}
);
s.items.push({
ref:ZaResource.A_zimbraPrefCalendarForwardInvitesTo,type:_REPEAT_,label:ZaMsg.zimbraPrefCalendarForwardInvitesTo,labelLocation:_LEFT_,labelCssClass:"xform_label",repeatInstance:c,showAddButton:true,showRemoveButton:true,addButtonLabel:ZaMsg.NAD_AddAddress,showAddOnNextRow:true,removeButtonLabel:ZaMsg.NAD_RemoveAddress,nowrap:false,labelWrap:true,items:[{
ref:".",type:_TEXTFIELD_,label:null,width:250,visibilityChecks:[],enableDisableChecks:[]}
]}
);
var o={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_PasswordGrouper,id:"account_wiz_password_group",numCols:2,visibilityChecks:[[XFormItem.prototype.hasAnyRight,[ZaResource.SET_CALRES_PASSWORD_RIGHT,ZaResource.CHANGE_CALRES_PASSWORD_RIGHT]]],items:[{
ref:ZaResource.A_password,type:_SECRET_,msgName:ZaMsg.NAD_Password,label:ZaMsg.NAD_Password,visibilityChecks:[],enableDisableChecks:[],labelLocation:_LEFT_,cssClass:"admin_xform_name_input"}
,{
ref:ZaResource.A2_confirmPassword,type:_SECRET_,msgName:ZaMsg.NAD_ConfirmPassword,label:ZaMsg.NAD_ConfirmPassword,visibilityChecks:[],enableDisableChecks:[],labelLocation:_LEFT_,cssClass:"admin_xform_name_input"}
]};
var f={
type:_ZAWIZ_TOP_GROUPER_,label:ZaMsg.NAD_NotesGrouper,id:"account_wiz_notes_group",numCols:2,items:[{
ref:ZaResource.A_description,type:_INPUT_,msgName:ZaMsg.NAD_Description,label:ZaMsg.NAD_Description,labelLocation:_LEFT_,width:"300px",cssClass:"admin_xform_name_input"}
,{
ref:ZaResource.A_notes,type:_TEXTAREA_,msgName:ZaMsg.NAD_Notes,label:ZaMsg.NAD_Notes,labelLocation:_LEFT_}
]};
var l={
type:_CASE_,numCols:1,caseKey:ZaNewResourceXWizard.step1,align:_LEFT_,valign:_TOP_,items:[d,s,o,f]};
u.push(l);
var m=250;
var h={
type:_CASE_,numCols:1,caseKey:ZaNewResourceXWizard.step2,items:[{
type:_ZAWIZGROUP_,colSizes:["200px","275px"],items:[{
ref:ZaResource.A_zimbraCalResContactName,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ContactName,label:ZaMsg.NAD_ContactName,labelLocation:_LEFT_,width:m}
,{
ref:ZaResource.A_zimbraCalResContactEmail,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ContactEmail,label:ZaMsg.NAD_ContactEmail,labelLocation:_LEFT_,width:m}
,{
ref:ZaResource.A_zimbraCalResContactPhone,type:_TEXTFIELD_,msgName:ZaMsg.NAD_ContactPhone,label:ZaMsg.NAD_ContactPhone,labelLocation:_LEFT_,width:m}
,{
ref:ZaResource.A_contactInfoAutoComplete,type:_AUTO_COMPLETE_LIST_,matchValue:ZaContactList.matchValue,matchText:ZaContactList.matchText,dataLoaderClass:ZaContactList,dataLoaderMethod:ZaContactList.prototype.getContactList,compCallback:ZaContactList.prototype._autocompleteCallback,inputFieldElementId:ZaResource.A_zimbraCalResContactName}
]}
,{
type:_ZAWIZGROUP_,colSizes:["200px","300px"],items:[{
type:_GROUP_,numCols:3,nowrap:true,width:200,msgName:ZaMsg.NAD_LocationDisplayName,label:ZaMsg.NAD_LocationDisplayName,labelLocation:_LEFT_,items:[{
ref:ZaResource.A_locationDisplayName,type:_TEXTFIELD_,label:null,width:m,enableDisableChecks:[ZaNewResourceXWizard.isAutoDisplayname],enableDisableChangeEventSources:[ZaResource.A2_autoLocationName],bmolsnr:true}
,{
ref:ZaResource.A2_autoLocationName,type:_WIZ_CHECKBOX_,msgName:ZaMsg.NAD_Auto,label:ZaMsg.NAD_Auto,labelLocation:_RIGHT_,trueValue:"TRUE",falseValue:"FALSE",elementChanged:ZaResource.setAutoLocationName}
]}
,{
ref:ZaResource.A_zimbraCalResSite,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Site,label:ZaMsg.NAD_Site,labelLocation:_LEFT_,width:m,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResBuilding,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Building,label:ZaMsg.NAD_Building,labelLocation:_LEFT_,width:m,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResFloor,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Floor,label:ZaMsg.NAD_Floor,labelLocation:_LEFT_,width:m,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResRoom,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Room,label:ZaMsg.NAD_Room,labelLocation:_LEFT_,width:m,elementChanged:ZaResource.setAutoLocationName}
,{
ref:ZaResource.A_zimbraCalResCapacity,type:_TEXTFIELD_,msgName:ZaMsg.NAD_Capacity,label:ZaMsg.NAD_Capacity,labelLocation:_LEFT_,width:m,visibilityChecks:[ZaResourceXFormView.isLocation],visibilityChangeEventSources:[ZaResource.A_zimbraCalResType]}
]}
,{
type:_ZAWIZGROUP_,colSizes:["200px","275px"],items:ZaAccountXFormView.getAddressFormItemForDialog()}
]};
u.push(h);
var e={
type:_ZAWIZGROUP_,id:"account_wiz_signature_group",numCols:2,colSpan:2,width:"100%",colSizes:["200px","auto"],items:[{
ref:ZaResource.A2_signatureList,type:_REPEAT_,msgName:"",colSpan:2,label:"",labelLocation:_NONE_,addButtonLabel:ZaMsg.NAD_AddSignature,removeButtonLabel:ZaMsg.NAD_RemoveSignature,showAddOnNextRow:true,addButtonCSSStyle:"margin-left:200px",showAddButton:true,showRemoveButton:true,items:[{
ref:".",type:_SIGNATURE_,width:"100%"}
],getDisplayValue:function(b){
var y=this.getForm().parent;
var p=this.getInstance();
var g=ZaSignature.getNewSignatureChoices(p[ZaResource.A2_signatureList]);
y.signatureChoices.setChoices(g);
y.signatureChoices.dirtyChoices();
return b
}}
,{
ref:ZaResource.A_zimbraPrefCalendarAutoAcceptSignatureId,type:_OSELECT1_,msgName:ZaMsg.NAD_zimbraPrefCalendarAutoAcceptSignatureId,width:"280px",label:ZaMsg.NAD_zimbraPrefCalendarAutoAcceptSignatureId,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[ZaResourceXFormView.isSignatureSelectionEnabled],enableDisableChangeEventSources:[ZaResource.A2_signatureList],valueChangeEventSources:[ZaResource.A2_signatureList],choices:this.signatureChoices}
,{
ref:ZaResource.A_zimbraPrefCalendarAutoDeclineSignatureId,type:_OSELECT1_,msgName:ZaMsg.NAD_zimbraPrefCalendarAutoDeclineSignatureId,width:"280px",label:ZaMsg.NAD_zimbraPrefCalendarAutoDeclineSignatureId,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[ZaResourceXFormView.isSignatureSelectionEnabled],enableDisableChangeEventSources:[ZaResource.A2_signatureList],valueChangeEventSources:[ZaResource.A2_signatureList],choices:this.signatureChoices}
,{
ref:ZaResource.A_zimbraPrefCalendarAutoDenySignatureId,type:_OSELECT1_,msgName:ZaMsg.NAD_zimbraPrefCalendarAutoDenySignatureId,width:"280px",label:ZaMsg.NAD_zimbraPrefCalendarAutoDenySignatureId,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[ZaResourceXFormView.isSignatureSelectionEnabled],enableDisableChangeEventSources:[ZaResource.A2_signatureList],valueChangeEventSources:[ZaResource.A2_signatureList],choices:this.signatureChoices}
]};
var r={
type:_CASE_,numCols:1,caseKey:ZaNewResourceXWizard.step3,align:_LEFT_,valign:_TOP_,items:[e]};
u.push(r);
n.items=[{
type:_OUTPUT_,colSpan:2,valign:_TOP_,cssStyle:"white-space: normal",ref:ZaModel.currentStep,choices:this.stepChoices,valueChangeEventSources:[ZaModel.currentStep]}
,{
type:_SEPARATOR_,align:_CENTER_,valign:_TOP_}
,{
type:_SPACER_,align:_CENTER_,valign:_TOP_}
,{
type:_SWITCH_,width:720,align:_LEFT_,valign:_TOP_,cssStyle:"white-space: normal",items:u}
]
};
ZaXDialog.XFormModifiers.ZaNewResourceXWizard.push(ZaNewResourceXWizard.myXFormModifier);
ZaNewResourceXWizard.isAutoDisplayname=function(){
return(this.getInstanceValue(ZaResource.A2_autoLocationName)=="FALSE")
}
}
if(AjxPackage.define("zimbraAdmin.resource.view.ZaSignatureDlg")){
ZaEditSignatureDialog=function(o,e,t,n){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON];
ZaXDialog.call(this,o,null,n,e,t,null,ZaId.DLG_EDIT_SIGNATURE);
this._containedObject={};
this.initForm(ZaSignature.myXModel,this.getMyXForm());
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaEditSignatureDialog.prototype.handleXFormChange));
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,new AjxListener(this,ZaEditSignatureDialog.prototype.handleXFormChange))
};
ZaEditSignatureDialog.prototype=new ZaXDialog;
ZaEditSignatureDialog.prototype.constructor=ZaEditSignatureDialog;
ZaEditSignatureDialog.prototype.handleXFormChange=function(){
var t=this.getObject();
var e=(!AjxUtil.isEmpty(t[ZaSignature.A2_name]))&&(!AjxUtil.isEmpty(t[ZaSignature.A2_content]));
this._button[DwtDialog.OK_BUTTON].setEnabled(e)
};
ZaEditSignatureDialog.prototype.getMyXForm=function(){
var e={
numCols:1,items:[{
type:_GROUP_,isTabGroup:true,items:[{
ref:ZaSignature.A2_name,type:_TEXTFIELD_,width:"300px",label:ZaMsg.Dlg_SignatureName,visibilityChecks:[],enableDisableChecks:[]}
,{
ref:ZaSignature.A2_content,type:_TEXTAREA_,width:"300px",label:ZaMsg.Dlg_SignatureContent,msgName:ZaMsg.Dlg_SignatureContent,labelLocation:_LEFT_,visibilityChecks:[],enableDisableChecks:[]}
]}
]};
return e
}
}
if(AjxPackage.define("zimbraAdmin.ZaZimbraAdmin")){
ZaZimbraAdmin=function(e){
if(arguments.length==0){
return
}
ZaZimbraAdmin._instance=this;
ZaController.call(this,e,null,"ZaZimbraAdmin");
ZaZimbraAdmin.showSplash(this._shell);
skin.showSkin();
e.setAppController(this);
this._appFactory=new Object();
this._appFactory[ZaZimbraAdmin.ADMIN_APP]=ZaApp;
this.startup()
};
ZaZimbraAdmin.prototype=new ZaController;
ZaZimbraAdmin.prototype.constructor=ZaZimbraAdmin;
ZaZimbraAdmin._instance=null;
ZaZimbraAdmin.ADMIN_APP="admin";
ZaZimbraAdmin.currentUserName="";
ZaZimbraAdmin.currentUserLogin="";
ZaZimbraAdmin.currentUserId="";
ZaZimbraAdmin.URN="urn:zimbraAdmin";
ZaZimbraAdmin.VIEW_INDEX=0;
ZaZimbraAdmin.FIRST_DAY_OF_WEEK=0;
ZaZimbraAdmin.isFirstRequest=false;
ZaZimbraAdmin._ADDRESSES=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SEARCHES=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ACCOUNTS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ALIASES_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DISTRIBUTION_LISTS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SYS_CONFIG=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._GLOBAL_SETTINGS=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SERVERS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DOMAINS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._COS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._MONITORING=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._TOOLS=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._STATUS=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._STATISTICS=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._STATISTICS_BY_SERVER=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SEARCH_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SEARCH_BUILDER_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SEARCH_BUILDER_TOOLBAR_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ZIMLET_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ADMIN_ZIMLET_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._RESOURCE_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SERVER_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DOMAIN_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._COS_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ACCOUNT_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ALIAS_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DL_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._HELP_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._MIGRATION_WIZ_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._POSTQ_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._POSTQ_BY_SERVER_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._RESOURCE_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ZIMLET_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._MONITOR_HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._MANAGE_ACCOUNT_HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ADMINISTRATION_HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._MIGRATION_HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DOWNLOAD_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SEARCH_HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SEARCH_RESULT_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SEARCH_FILTER_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SERVER_STATUS_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SERVER_STATISTICS_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SERVER_STATISTICS_TAB_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._SERVER_LIST_FOR_STATISTICS_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._HELP_CENTER_HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._HELP_CENTER_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._HOME_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._XFORM_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._XFORM_TAB_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._ACCOUNT_ALIAS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._COS_ACCOUNT_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._COS_DOMAIN_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DOMAIN_ACCOUNT_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DOMAIN_ALIAS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DL_ALIAS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._DL_MEMBERS_LIST_VIEW=ZaZimbraAdmin.VIEW_INDEX++;
ZaZimbraAdmin._COOKIE_NAME="ZM_ADMIN_AUTH_TOKEN";
ZaZimbraAdmin.TEST_COOKIE_NAME="ZA_TEST";
ZaZimbraAdmin.prototype.toString=function(){
return"ZaZimbraAdmin"
};
ZaZimbraAdmin.clearCookie=function(){
try{
var n=AjxSoapDoc.create("ClearCookieRequest",ZaZimbraAdmin.URN,null);
var t=n.set("cookie");
t.setAttribute("name",ZaZimbraAdmin._COOKIE_NAME);
var e=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=n;
s.skipExpiredToken=true;
s.asyncMode=false;
s.noAuthToken=true;
e.invoke(s)
}
catch(o){
this._handleException(o,"ZaZimbraAdmin.clearCookie",null,true)
}};
ZaZimbraAdmin.run=function(h){
if(window._dwtShellId){
return
}
if(!DBG){
DBG=new AjxDebug(AjxDebug.NONE,null,false)
}
ZmCsfeCommand.setServerUri(location.protocol+"//"+h+ZaSettings.CSFE_SERVER_URI);
ZmCsfeCommand.setCookieName(ZaZimbraAdmin._COOKIE_NAME);
var m=AjxSoapDoc.create("GetDomainInfoRequest",ZaZimbraAdmin.URN,null);
var f=m.set("domain",location.hostname);
f.setAttribute("by","virtualHostname");
var n=new ZmCsfeCommand();
var s=new Object();
s.soapDoc=m;
s.noAuthToken=true;
var r;
var e=false;
try{
r=n.invoke(s).Body.GetDomainInfoResponse
}
catch(d){
if(d.code==ZmCsfeException.SVC_AUTH_EXPIRED){
e=true
}else{
throw d
}}
if(e){
ZaZimbraAdmin.clearCookie();
s.resend=true;
r=n.invoke(s).Body.GetDomainInfoResponse
}
if(r){
var l={};
ZaItem.prototype.initFromJS.call(l,r.domain[0]);
ZaZimbraAdmin.zimbraAdminLoginURL=l.attrs.zimbraAdminConsoleLoginURL;
if(l.attrs.zimbraSkinLogoURL){
ZaSettings.LOGO_URI=l.attrs.zimbraSkinLogoURL
}}
var o=new ZaAppCtxt();
var t=window.document.getElementById(ZaSettings.get(ZaSettings.SKIN_SHELL_ID));
var c=new DwtShell({
userShell:t}
);
o.setShell(c);
this._kbMgr=c.getKeyboardMgr();
this._kbMgr.enable(true);
this._kbMgr.registerKeyMap(new ZaKeyMap());
this._kbMgr.pushDefaultHandler(this);
this._kbMgr.setTabGroup(o.getRootTabGroup());
var u=new ZaZimbraAdmin(o)
};
ZaZimbraAdmin.prototype.getKeymapNameToUse=function(){
if(ZaApp.getInstance()&&ZaApp.getInstance().getCurrentController()){
var e=ZaApp.getInstance().getCurrentController();
if(e&&e.handleKeyAction){
return e.toString()
}}
return"ZaGlobal"
};
ZaZimbraAdmin.prototype.handleKeyAction=function(){
switch(actionCode){
case ZaKeyMap.DBG_NONE:alert("Setting domain search limit to:"+AjxDebug.NONE);
break;
case ZaKeyMap.DBG_1:alert("Setting domain search limit to:"+AjxDebug.DBG1);
break;
case ZaKeyMap.DBG_2:alert("Setting domain search limit to:"+AjxDebug.DBG2);
break;
case ZaKeyMap.DBG_3:alert("Setting domain search limit to:"+AjxDebug.DBG3);
break;
default:if(ZaApp.getInstance()&&ZaApp.getInstance().getCurrentController()){
var e=ZaApp.getInstance().getCurrentController();
if(e&&e.handleKeyAction){
return e.handleKeyAction(actionCode,ev)
}}else{
return false
}
break
}
return true
};
ZaZimbraAdmin.getInstance=function(){
if(ZaZimbraAdmin._instance){
return ZaZimbraAdmin._instance
}else{
ZaZimbraAdmin.run(document.domain);
return ZaZimbraAdmin._instance
}};
ZaZimbraAdmin.prototype.getApp=function(){
return this._app
};
ZaZimbraAdmin.prototype.getAdminApp=function(){
return this._app
};
ZaZimbraAdmin.prototype.getAppViewMgr=function(){
return this._appViewMgr
};
ZaZimbraAdmin.prototype.getOverviewPanelController=function(){
if(ZaSettings.TREE_ENABLED){
if(this._overviewPanelController==null){
this._overviewPanelController=new ZaOverviewPanelController(this._appCtxt,this._shell);
this._overviewPanelController.addSearchListener(new AjxListener(this._overviewPanelController,ZaOverviewPanelController.prototype.handleSearchFinished))
}
return this._overviewPanelController
}else{
return null
}};
ZaZimbraAdmin.prototype.getTaskController=function(){
if(this._taskController==null){
this._taskController=new ZaTaskController(this._appCtxt,this._shell)
}
return this._taskController
};
ZaZimbraAdmin.prototype.setActiveApp=function(e){};
ZaZimbraAdmin.logOff=function(){
ZmCsfeCommand.noAuth=true;
window.onbeforeunload=null;
var t=DwtShell.getShell(window);
t.setBusy(true);
var o=location.protocol+"//"+location.hostname+((location.port=="80")?"":":"+location.port)+location.pathname+location.search;
if(location.search){
o=o+"&logoff=1"
}else{
o=o+"?logoff=1"
}
var e=new AjxTimedAction(null,ZaZimbraAdmin.redir,[o]);
AjxTimedAction.scheduleAction(e,100)
};
ZaZimbraAdmin.redir=function(e){
window.location=e
};
ZaZimbraAdmin.isLanguage=function(t){
var e=null;
if(ZaZimbraAdmin.LOCALE==null){
e=AjxEnv.DEFAULT_LOCALE
}else{
e=ZaZimbraAdmin.LOCALE
}
return e==t
};
ZaZimbraAdmin.prototype.startup=function(e){
this._appViewMgr=new ZaAppViewMgr(this._shell,this,true);
try{
if(!e){
this._refreshing=true;
this._doAuth()
}}
catch(t){
if(t&&t.code!=ZmCsfeException.NO_AUTH_TOKEN&&t.code!=ZmCsfeException.SVC_AUTH_EXPIRED&&t.code!=ZmCsfeException.SVC_AUTH_REQUIRED){
if(!ZaSettings.initialized){
ZaSettings.init()
}else{
ZaZimbraAdmin._killSplash()
}}
this._handleException(t,"ZaZimbraAdmin.prototype.startup",null,true)
}};
ZaZimbraAdmin.reload_msg=function(){
var e=[];
e.push([appContextPath,"/res/","I18nMsg,AjxMsg,ZMsg,ZaMsg,ZabMsg,AjxKeys",".js?v=",appVers,ZaZimbraAdmin.LOCALE_QS].join(""));
var t=new AjxCallback(ZaZimbraAdmin.reinit_func);
AjxInclude(e,null,t);
ZaZimbraAdmin._LOCALE_MSG_RELOADED=true
};
ZaZimbraAdmin.reinit_func=function(){
AjxFormat.initialize();
ZaItem.initDescriptionItem();
ZaSettings.initConst();
ZaDomain.initDomainStatus();
Dwt_Datetime_XFormItem.initialize()
};
ZaZimbraAdmin.initInfo=function(h){
if(h&&h.Body&&h.Body.GetInfoResponse){
ZaZimbraAdmin.currentUserLogin=h.Body.GetInfoResponse.name;
ZaZimbraAdmin.currentUserId=h.Body.GetInfoResponse.id;
var o=h.Body.GetInfoResponse.name;
if(o){
var s=o.split("@");
if(s.length>1){
ZaSettings.myDomainName=s[1]
}}
ZaZimbraAdmin.currentAdminId=h.Body.GetInfoResponse.id;
if(h.Body.GetInfoResponse.attrs){
if(h.Body.GetInfoResponse.attrs.attr&&h.Body.GetInfoResponse.attrs.attr instanceof Array){
var r=h.Body.GetInfoResponse.attrs.attr;
for(var n=0;
n<r.length;
n++){
if(r[n].name=="displayName"){
var e=r[n]._content;
if(e!=null&&e.length>0){
ZaZimbraAdmin.currentUserName=e
}}}}else{
if(h.Body.GetInfoResponse.attrs._attrs&&typeof(h.Body.GetInfoResponse.attrs._attrs)=="object"){
var r=h.Body.GetInfoResponse.attrs._attrs;
if(r.displayName&&r.displayName.length){
ZaZimbraAdmin.currentUserName=r.displayName
}}}
if(!ZaZimbraAdmin.currentUserName||ZaZimbraAdmin.currentUserName.length<=0){
ZaZimbraAdmin.currentUserName=ZaZimbraAdmin.currentUserLogin
}
if(h&&h.Body&&h.Body.GetInfoResponse&&h.Body.GetInfoResponse.prefs){
var t=h.Body.GetInfoResponse.prefs._attrs;
if(t&&t.zimbraPrefLocale){
ZaZimbraAdmin.LOCALE=t.zimbraPrefLocale
}
if(t&&t[ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit]){
ZaZimbraAdmin.isWarnOnExit=(t[ZaAccount.A_zimbraPrefAdminConsoleWarnOnExit]=="TRUE")
}
if(t&&!AjxUtil.isEmpty(t[ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek])){
ZaZimbraAdmin.FIRST_DAY_OF_WEEK=t[ZaAccount.A_zimbraPrefCalendarFirstDayOfWeek]
}}}}};
ZaZimbraAdmin.prototype._setLicenseStatusMessage=function(){
if((typeof ZaLicense=="function")&&(ZaSettings.LICENSE_ENABLED)){
ZaLicense.setLicenseStatus(this)
}};
ZaZimbraAdmin.prototype.setStatusMsg=function(t,e){
if(!ZaSettings.STATUS_ENABLED){
return
}};
ZaZimbraAdmin.prototype.clearStatus=function(){
if(!ZaSettings.STATUS_ENABLED){
return
}};
ZaZimbraAdmin.prototype._createAppTabs=function(){
var e=new ZaAppTabGroup(this._shell);
return e
};
ZaZimbraAdmin.prototype._createRefreshLink=function(){
var o=document.getElementById(ZaSettings.SKIN_REFRESH_DOM_ID);
if(!o){
return
}
var t=new DwtComposite(this._shell,"RefreshContainer",Dwt.RELATIVE_STYLE);
var e=t.getHtmlElement();
t.setCursor("pointer");
e.onclick=function(){
ZaZimbraAdmin.prototype._refreshListener.call(ZaZimbraAdmin.getInstance())
};
e.innerHTML=this._getAppLink(null,"SearchRefreshWhite");
t.reparentHtmlElement(ZaSettings.SKIN_REFRESH_DOM_ID)
};
ZaZimbraAdmin.prototype._createPreviousLink=function(){
var o=document.getElementById(ZaSettings.SKIN_PREVIOUS_DOM_ID);
if(!o){
return
}
var t=this._previousContainer=new DwtComposite(this._shell,"PreviousContainer",Dwt.RELATIVE_STYLE);
var e=t.getHtmlElement();
t.setCursor("pointer");
e.onclick=function(){
ZaZimbraAdmin.prototype._goPrevListener.call(ZaZimbraAdmin.getInstance())
};
e.innerHTML=AjxImg.getImageSpanHtml("LeftArrowNormal");
t.reparentHtmlElement(ZaSettings.SKIN_PREVIOUS_DOM_ID)
};
ZaZimbraAdmin.prototype._createNextLink=function(){
var o=document.getElementById(ZaSettings.SKIN_NEXT_DOM_ID);
if(!o){
return
}
var t=this._nextContainer=new DwtComposite(this._shell,"NextContainer",Dwt.RELATIVE_STYLE);
var e=t.getHtmlElement();
t.setCursor("pointer");
e.onclick=function(){
ZaZimbraAdmin.prototype._goNextListener.call(ZaZimbraAdmin.getInstance())
};
e.innerHTML=AjxImg.getImageSpanHtml("RightArrowNormal");
t.reparentHtmlElement(ZaSettings.SKIN_NEXT_DOM_ID)
};
ZaZimbraAdmin.prototype.updatePreNext=function(){
var e=this._historyMgr.isPrevious();
var t=this._historyMgr.isNext();
this._previousContainer.setEnabled(e);
this._nextContainer.setEnabled(t)
};
ZaZimbraAdmin.prototype._refreshListener=function(s){
var n=ZaApp.getInstance().getCurrentController();
if(AjxUtil.isInstance(n,ZaHelpViewController)){
return
}
var e=ZaZimbraAdmin.getInstance().getOverviewPanelController().getOverviewPanel().getFolderTree();
if(AjxUtil.isEmpty(e)){
return
}
var t=e.getCurrentSelectedItems().getArray();
if(AjxUtil.isEmpty(t)||AjxUtil.isEmpty(t[0])){
return
}
var o=t[0];
var r=e.getABPath(o.getData("dataItem"));
if(AjxUtil.isEmpty(r)){
return
}
e.setSelectionByPath(r,false,undefined,undefined,undefined,true)
};
ZaZimbraAdmin.prototype._goPrevListener=function(t){
var e=this._historyMgr.getPrevious();
if(e){
e.goToView();
this.updatePreNext()
}};
ZaZimbraAdmin.prototype._goNextListener=function(t){
var e=this._historyMgr.getNext();
if(e){
e.goToView();
this.updatePreNext()
}};
ZaZimbraAdmin.prototype._createHelpLink=function(){
var o=document.getElementById(ZaSettings.SKIN_HELP_DOM_ID);
if(!o){
return
}
var e=new DwtBorderlessButton(this._shell,"","",Dwt.RELATIVE_STYLE);
e.setText(ZaMsg.help);
e.setDropDownImages("NodeExpandedWhite");
o.innerHTML="";
e.reparentHtmlElement(ZaSettings.SKIN_HELP_DOM_ID);
var s=new Array();
var n=new ZaPopupMenu(e,"ZaHelpDropdown",null,s,"ZA_HELP");
var t=new DwtMenuItem({
parent:n,id:"zaHelpHomepage",className:"ZaHelpDropdownFirstItem"}
);
t.setText(ZabMsg.zimbraHomePage);
t.addSelectionListener(new AjxListener(this,this._contextHelpListener));
t=new DwtMenuItem({
parent:n,id:"zaHelpCenter",className:"ZaHelpDropdownItem"}
);
t.setText(ZaMsg.zimbraHelpCenter);
t.addSelectionListener(new AjxListener(this,this._helpListener));
t=new DwtMenuItem({
parent:n,id:"aboutZimbra",className:"ZaHelpDropdownLastItem"}
);
t.setText(ZabMsg.zimbraAbout);
t.addSelectionListener(new AjxListener(this,this._aboutZimbraListener));
n.addChild(this._createHelpSearch(),0);
n.addPopupListener(new AjxListener(this,this._helpMenuPopupListener,n));
e.setMenu(n,true)
};
ZaZimbraAdmin.prototype._createHelpSearch=function(){
var n=new DwtComposite(this._shell,"ZaHelpDropdownSearch",Dwt.RELATIVE_STYLE);
var o=new DwtComposite(n,"SearchPanel",Dwt.RELATIVE_STYLE);
var e=new DwtComposite({
parent:o,className:"ImgSearch ZaHelpSearchIcon"}
);
e.getHtmlElement().onclick=this._openSupportSite;
var t=new DwtInputField({
parent:o,validationStyle:DwtInputField.ONEXIT_VALIDATION,inputId:"ZaHelpSearchInput"}
);
t.setValidatorFunction(t.getInputElement(),this._openSupportSite);
t.getInputElement().onblur=null;
return n
};
ZaZimbraAdmin.prototype._helpMenuPopupListener=function(s){
var t=s.getItem(1);
if(!t){
return null
}
var o=t.getW()-20;
var e=Math.floor((o-30)/5.5);
var n=ZaApp.getInstance().getCurrentController()._helpButtonText;
if(e<n.length){
n=n.substring(0,(e-3))+"..."
}
t.setText(n)
};
ZaZimbraAdmin.prototype._openSupportSite=function(){
window.open(ZaSettings.ZIMBRA_SUPPORT_URL_QUERY+document.getElementById("ZaHelpSearchInput").value)
};
ZaZimbraAdmin.prototype._contextHelpListener=function(){
window.open(ZaApp.getInstance().getCurrentController()._helpURL)
};
ZaZimbraAdmin.prototype._aboutZimbraListener=function(){
if(!this.aboutZimbraDialog){
this.aboutZimbraDialog=new ZaAboutDialog(this._shell)
}
this.aboutZimbraDialog.popup()
};
ZaZimbraAdmin.prototype._createOldHelpLink=function(){
var s=document.getElementById(ZaSettings.SKIN_HELP_DOM_ID);
if(!s){
return
}
var n=new DwtComposite(this._shell,"HelpContainer",Dwt.RELATIVE_STYLE);
var t=n.getHtmlElement();
n.setCursor("pointer");
var r="";
if(ZaSettings.isYahooSmbPADomainAdmin){
n.getHtmlElement().innerHTML=this._getAppLink("SMBAccount.openHelpDesk();",r,ZaMsg.helpDesk,skin.skin_container_help_max_str_length)
}else{
var o=new AjxListener(this,this._helpListener);
var e=this;
n.getHtmlElement().onclick=function(){
ZaZimbraAdmin.prototype._helpListener.call(e)
};
n.getHtmlElement().innerHTML=this._getAppLink(null,r,ZaMsg.helpDesk,skin.skin_container_help_max_str_length)
}
n.reparentHtmlElement(ZaSettings.SKIN_HELP_DOM_ID)
};
ZaZimbraAdmin.prototype._createDownloadLink=function(){
var n=document.getElementById(ZaSettings.SKIN_DW_DOM_ID);
if(!n){
return
}
var o=new DwtComposite(this._shell,"DWContainer",Dwt.RELATIVE_STYLE);
var t=new AjxListener(this,this._dwListener);
var e=this;
o.getHtmlElement().onclick=function(){
ZaZimbraAdmin.prototype._dwListener.call(e)
};
o.setCursor("pointer");
o.getHtmlElement().innerHTML=this._getAppLink(null,"Migration",ZaMsg.goToMigrationWiz,skin.skin_container_dw_max_str_length);
o.reparentHtmlElement(ZaSettings.SKIN_DW_DOM_ID)
};
ZaZimbraAdmin.prototype._setUserName=function(){
var t=document.getElementById(ZaSettings.SKIN_USER_NAME_ID);
if(!t){
return
}
if(!ZaZimbraAdmin.currentUserName){
return
}
var n=new DwtLabel(this._shell,"","",Dwt.RELATIVE_STYLE);
var e=AjxStringUtil.htmlEncode(ZaZimbraAdmin.currentUserName);
var o="<div class='skin_container_username_div'>"+e+"</div>";
n.setText(o);
n._setMouseEvents();
n.setToolTipContent(e);
t.innerHTML="";
n.reparentHtmlElement(ZaSettings.SKIN_USER_NAME_ID)
};
ZaZimbraAdmin.prototype._createUserName=function(){
var o=document.getElementById(ZaSettings.SKIN_USERNAME_DOM_ID);
if(!o){
return
}
if(!ZaZimbraAdmin.currentUserName){
return
}
var t=new DwtBorderlessButton(this._shell,"","",Dwt.RELATIVE_STYLE);
var e=AjxStringUtil.htmlEncode(ZaZimbraAdmin.currentUserName);
var s="<div class='skin_container_username_div'>"+e+"</div>";
t.setText(s);
t.setDropDownImages("NodeExpandedWhite");
t.setToolTipContent(e);
o.innerHTML="";
t.reparentHtmlElement(ZaSettings.SKIN_USERNAME_DOM_ID);
var r=new Array();
r.push(new ZaOperation(ZaOperation.LOGOFF,ZaMsg.logOff,ZaMsg.logOff,"Logoff","LogoffDis",new AjxListener(window,ZaZimbraAdmin.logOff)));
var n=new ZaPopupMenu(t,null,null,r,"ZA_LOGOFF");
t.setMenu(n,true)
};
ZaZimbraAdmin.prototype._helpListener=function(n){
var r=ZaZimbraAdmin.currentUserLogin;
var o=r.split("@")[1];
var s=ZaDomain.getDomainByName(o);
var l=ZaZimbraAdmin.currentAdminAccount;
if(l&&s){
var t=null;
if(l.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"){
t=s.attrs[ZaDomain.A_zimbraHelpAdminURL]
}else{
t=s.attrs[ZaDomain.A_zimbraHelpDelegatedURL]
}
if(t){
window.open(t);
return
}}
var h=skin&&skin.hints&&skin.hints.helpButton;
if(h&&h.url){
var e=h.url.match(/\?/)?"&":"?";
var t=[h.url,e,"locid=",AjxEnv.DEFAULT_LOCALE].join("");
window.open(t);
return
}
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getHelpViewController(),ZaHelpViewController.prototype.show,null)
}else{
ZaApp.getInstance().getHelpViewController().show()
}};
ZaZimbraAdmin.prototype._dwListener=function(e){
if(ZaApp.getInstance().getCurrentController()){
ZaApp.getInstance().getCurrentController().switchToNextView(ZaApp.getInstance().getMigrationWizController(),ZaMigrationWizController.prototype.show,null)
}else{
ZaApp.getInstance().getMigrationWizController().show()
}};
ZaZimbraAdmin.prototype._createBanner=function(){
var t=document.getElementById(ZaSettings.SKIN_LOGO_DOM_ID);
if(!t){
return
}
var e=new DwtComposite(this._shell,"LogoContainer",Dwt.ABSOLUTE_STYLE);
var n=new Array();
var o=0;
n[o++]="<a href='";
n[o++]=ZaAppCtxt.getLogoURI();
n[o++]="' target='_blank'><div  class='"+AjxImg.getClassForImage("AppBanner")+"'></div></a>";
e.getHtmlElement().innerHTML=n.join("");
e.getHtmlElement().style.height="100%";
return e
};
ZaZimbraAdmin.prototype._createLogOff=function(){
var e;
if(ZaSettings.isYahooSmbPADomainAdmin){
e="SMBAccount.logOff();"
}else{
e="ZaZimbraAdmin.logOff();"
}
var t=document.getElementById(ZaSettings.SKIN_LOGOFF_DOM_ID);
if(t){
t.innerHTML=this._getAppLink(e,"Logoff",ZaMsg.logOff);
t.style.cursor="pointer"
}};
ZaZimbraAdmin.prototype._getLoginMsgPanel=function(){
if(!this._loginMsgPanel){
this._loginMsgPanel=new DwtComposite(this._shell,null,Dwt.ABSOLUTE_STYLE);
var e;
try{
e=ZaDomain.getLoginMessage()
}
catch(t){
this._handleException(t,"ZaZimbraAdmin.prototype._getLoginMsgPanel",null,true)
}
if(e){
var n=new DwtAlert(this._loginMsgPanel,null,Dwt.ABSOLUTE_STYLE);
n.setStyle(DwtAlert.INFORMATION);
n.setContent(e);
var o=new DwtButton({
parent:this._loginMsgPanel,className:"DwtToolbarButton"}
);
o.setImage("Close");
o.setText(ZaMsg.TBB_Close);
o.addSelectionListener(new AjxListener(this,this.closeLoginMsg));
n.setDismissContent(o)
}else{
this.closeLoginMsg()
}}
return this._loginMsgPanel
};
ZaZimbraAdmin.prototype.closeLoginMsg=function(){
var t=this._loginMsgPanel.getHTMLElId();
Dwt.hide(t);
skin.hideLoginMsg();
var e=ZaApp.getInstance().getAppViewMgr();
e.fitAll()
};
ZaZimbraAdmin.prototype._getAppLink=function(r,n,s,o){
var t=[];
var e=0;
t[e++]="<table border=0 cellpadding=1 cellspacing=1 align=right><tr>";
t[e++]="<td align=right><span ";
if(r){
t[e++]=" onclick='"+r+"' "
}
t[e++]=">";
t[e++]=AjxImg.getImageHtml(n,null,"border=0");
t[e++]="</span></td>";
t[e++]="<td width=1% align=right style='white-space:nowrap;'><span ";
if(r){
t[e++]=" onclick='"+r+"' "
}
if((o!=null)&&o>0){
if(s!=null&&s.length>o){
var h=s;
s=s.substring(0,o-3)+"...";
t[e++]="title='"+h+"'"
}}
t[e++]=">";
t[e++]=s;
t[e++]="</span></td></tr></table>";
return t.join("")
};
ZaZimbraAdmin.prototype._createActionStatus=function(){
this.actionStatusView=new ZaActionStatusView(this._shell,"ZaStatus",Dwt.ABSOLUTE_STYLE)
};
ZaZimbraAdmin.prototype.setActionStatusMsg=function(e){
if(this.actionStatusView){
e=Dwt.getParams(arguments,ZaActionStatusView.MSG_PARAMS);
this.actionStatusView.setStatusMsg(e)
}};
ZaZimbraAdmin._killSplash=function(){
if(ZaZimbraAdmin._splashScreen){
ZaZimbraAdmin._splashScreen.setVisible(false)
}};
ZaZimbraAdmin.showSplash=function(e){
if(ZaZimbraAdmin._splashScreen){
ZaZimbraAdmin._splashScreen.setVisible(true)
}else{
ZaZimbraAdmin._splashScreen=new ZaSplashScreen(e);
ZaZimbraAdmin._splashScreen.setVisible(true)
}};
ZaZimbraAdmin.prototype._createApp=function(){
this._app=ZaApp.getInstance(this._appCtxt,this._shell)
};
ZaZimbraAdmin.prototype.getHisotryMgr=function(){
return this._historyMgr
};
ZaZimbraAdmin.prototype._createHistoryMgr=function(){
if(!this._historyMgr){
this._historyMgr=new ZaHistoryMgr()
}};
ZaZimbraAdmin.prototype._launchApp=function(){
ZaSettings.TREE_ENABLED=(document.getElementById(ZaSettings.SKIN_TREE_ID)!=null);
ZaSettings.CURRENT_APP_ENABLED=(document.getElementById(ZaSettings.SKIN_CURRENT_APP_ID)!=null);
ZaSettings.BANNER_ENABLED=(document.getElementById(ZaSettings.SKIN_LOGO_DOM_ID)!=null);
ZaSettings.STATUS_ENABLED=(document.getElementById(ZaSettings.SKIN_STATUS_ID)!=null);
ZaSettings.SEARCH_PANEL_ENABLED=(document.getElementById(ZaSettings.SKIN_SEARCH_PANEL_ID)!=null);
if(!this._app){
this._createApp()
}
ZaApp.getInstance().initDialogs();
this._appCtxt.setClientCmdHdlr(new ZaClientCmdHandler());
var e=new Object();
if(skin&&skin.show){
skin.show(true);
skin.showSearchBuilder(false)
}
this._createLogOff();
this._createHelpLink();
this._createDownloadLink();
this._setUserName();
if(ZaSettings.BANNER_ENABLED){
e[ZaAppViewMgr.C_BANNER]=this._createBanner()
}
if(ZaSettings.STATUS_ENABLED){
e[ZaAppViewMgr.C_STATUS]=this._statusBox=new DwtText(this._shell,"statusBox",Dwt.ABSOLUTE_STYLE);
this.clearStatus();
this._setLicenseStatusMessage()
}
if(ZaSettings.SEARCH_PANEL_ENABLED){
this._createActionStatus();
e[ZaAppViewMgr.C_SEARCH_BUILDER_TOOLBAR]=ZaApp.getInstance().getSearchBuilderToolbarController().getSearchBuilderTBPanel();
e[ZaAppViewMgr.C_SEARCH_BUILDER]=ZaApp.getInstance().getSearchBuilderController().getSearchBuilderPanel()
}
if(ZaSettings.TREE_ENABLED){
e[ZaAppViewMgr.C_TREE]=this.getOverviewPanelController().getOverviewPanel()
}
if(document.getElementById(ZaSettings.SKIN_APP_SASH_ID)){
e[ZaAppViewMgr.C_SASH]=new DwtSash({
parent:this._shell,style:DwtSash.HORIZONTAL_STYLE,className:"AppSash-horiz",threshold:20,id:"z_sash"}
)
}
if(ZaSettings.SEARCH_PANEL_ENABLED){
e[ZaAppViewMgr.C_SEARCH]=ZaApp.getInstance().getSearchListController().getSearchPanel()
}
if(document.getElementById(ZaSettings.SKIN_SEARCH_BUILDER_APP_SASH_ID)!=null){
e[ZaAppViewMgr.C_SEARCH_BUILDER_SASH]=new DwtSash({
parent:this._shell,style:DwtSash.VERTICAL_STYLE,className:"AppSash-vert",threshod:20,id:"z_sb_sash"}
)
}
e[ZaAppViewMgr.C_LOGIN_MESSAGE]=this._getLoginMsgPanel();
e[ZaAppViewMgr.C_APP_TABS]=this._createAppTabs();
if(ZaSettings.CURRENT_APP_ENABLED){
e[ZaAppViewMgr.C_CURRENT_APP]=new ZaCurrentAppToolBar(this._shell)
}
this._appViewMgr.addComponents(e,true);
ZaApp.getInstance().launch();
ZaZimbraAdmin._killSplash()
};
ZaZimbraAdmin.prototype.updateHistory=function(e,t){
if(t){
this._historyMgr.addHistory(e)
}
if(e.displayName){
this._header.setText(e)
}
if(e.path){
this._currentAppBar.setText(e.path)
}};
ZaZimbraAdmin.prototype.refreshHistoryTreeByDelete=function(o){
var e=AjxUtil.toArray(o);
var r=false;
for(var s=0;
s<e.length;
s++){
var h=e[s].name;
var t=this._historyMgr.findHistoryByName(h);
for(var n=0;
n<t.size();
n++){
t.get(n).setEnabled(false);
r=true
}
this._historyMgr.deleteHistoryObjByName(h)
}
if(r){
this._historyMgr.refreshHistory()
}};
ZaZimbraAdmin.prototype.getSettingMenu=function(t,e){
if(!this._currentAppBar){
return""
}
return this._currentAppBar.getMenu()
};
ZaZimbraAdmin.prototype.getCurrentAppBar=function(){
return this._currentAppBar
};
ZaZimbraAdmin.prototype._lauchNewApp=function(){
ZaSettings.TREE_ENABLED=(document.getElementById(ZaSettings.SKIN_TREE_DOM_ID)!=null);
ZaSettings.BANNER_ENABLED=(document.getElementById(ZaSettings.SKIN_LOGO_DOM_ID)!=null);
ZaSettings.TOASTER_ENABLED=(document.getElementById(ZaSettings.SKIN_TOASTER_DOM_ID)!=null);
if(!this._app){
this._createApp()
}
this._createHistoryMgr();
ZaApp.getInstance().initDialogs();
this._appCtxt.setClientCmdHdlr(new ZaClientCmdHandler());
var e=new Object();
if(skin&&skin.show){
skin.show(true)
}
this._createRefreshLink();
this._createPreviousLink();
this._createNextLink();
this._historyMgr.addChangeListener(new AjxListener(this,this.updatePreNext));
this._createUserName();
this._createHelpLink();
if(ZaSettings.BANNER_ENABLED){
e[ZaAppViewMgr.C_BANNER]=this._createBanner()
}
if(ZaSettings.TOASTER_ENABLED){
this._createActionStatus()
}
e[ZaAppViewMgr.C_SEARCH]=ZaApp.getInstance().getSearchListController().getSearchPanel();
this._header=e[ZaAppViewMgr.C_TREE_TOP]=new ZaCrtAppTreeHeader(this._shell);
if(ZaSettings.TREE_ENABLED){
e[ZaAppViewMgr.C_TREE]=this.getOverviewPanelController().getOverviewPanel()
}
this._currentAppBar=e[ZaAppViewMgr.C_APP_HEADER]=new ZaCurrentAppBar(this._shell);
e[ZaAppViewMgr.C_TOOL_HEADER]=this.getTaskController().getTaskHeaderPanel();
e[ZaAppViewMgr.C_TOOL]=this.getTaskController().getTaskContentPanel();
this._appViewMgr.addComponents(e,true);
ZaApp.getInstance().launch();
ZaZimbraAdmin._killSplash()
};
ZaZimbraAdmin.noOpAction=null;
ZaZimbraAdmin.noOpHandler=null;
ZaZimbraAdmin.noOpInterval=120000;
ZaZimbraAdmin.prototype.cancelNoOp=function(){
if(ZaZimbraAdmin.noOpHandler){
AjxTimedAction.cancelAction(this.noOpHandler);
ZaZimbraAdmin.noOpHandler=null
}};
ZaZimbraAdmin.prototype.scheduleNoOp=function(){
if(!ZaZimbraAdmin.noOpAction){
ZaZimbraAdmin.noOpAction=new AjxTimedAction(this,this.sendNoOp)
}
ZaZimbraAdmin.noOpHandler=AjxTimedAction.scheduleAction(ZaZimbraAdmin.noOpAction,120000)
};
ZaZimbraAdmin.prototype.sendNoOp=function(){
try{
var o=AjxSoapDoc.create("NoOpRequest",ZaZimbraAdmin.URN,null);
var t=new ZmCsfeCommand();
var n=new Object();
n.soapDoc=o;
n.asyncMode=false;
n.noAuthToken=true;
t.invoke(n);
this.scheduleNoOp()
}
catch(e){
this._handleException(e,"ZaZimbraAdmin.prototype.sendNoOp",null,true);
this.cancelNoOp()
}};
ZaZimbraAdmin._bannerBarMouseHdlr=function(e){
window.status=ZaMsg.done;
return true
};
ZaZimbraAdmin._confirmExitMethod=function(){
var t=ZaMsg.appExitWarning;
var e=ZaAppTabGroup.getDirtyTabTitles();
if(e.length>0){
t=ZaMsg.appExitWarningWithDirtyTab+"\n"+e.join("\n")
}
return t
};
ZaZimbraAdmin._confirmAuthInvalidExitMethod=function(){
var e=ZaMsg.authInvalidExitWarning;
return e
};
ZaZimbraAdmin.setOnbeforeunload=function(e){
if(e){
window.onbeforeunload=e
}else{
window.onbeforeunload=null
}};
ZaZimbraAdmin.unloadHackCallback=function(){
if(ZaZimbraAdmin.isWarnOnExit){
ZaZimbraAdmin.setOnbeforeunload(null);
var o=function(){
ZaZimbraAdmin.setOnbeforeunload(ZaZimbraAdmin._confirmExitMethod)
};
var e=new AjxTimedAction(null,o);
AjxTimedAction.scheduleAction(e,3000)
}};
ZaZimbraAdmin.isGlobalAdmin=function(){
return(ZaZimbraAdmin.currentAdminAccount&&ZaZimbraAdmin.currentAdminAccount.attrs&&(ZaZimbraAdmin.currentAdminAccount.attrs[ZaAccount.A_zimbraIsAdminAccount]=="TRUE"))
};
ZaZimbraAdmin.hasGlobalDomainListAccess=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaCos.RIGHT_LIST_DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaCos.RIGHT_LIST_DOMAIN].some))
};
ZaZimbraAdmin.hasGlobalCOSSListAccess=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.COS]&&ZaSettings.targetRights[ZaItem.COS][ZaCos.RIGHT_LIST_COS]&&ZaSettings.targetRights[ZaItem.COS][ZaCos.RIGHT_LIST_COS].some))
};
ZaZimbraAdmin.canCreateTopDomain=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_TOP_DOMAIN]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_TOP_DOMAIN].some))
};
ZaZimbraAdmin.canCreateDomain=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_TOP_DOMAIN]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_TOP_DOMAIN].some)||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_SUB_DOMAIN]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_SUB_DOMAIN].some)||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_SUB_DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_SUB_DOMAIN].some))
};
ZaZimbraAdmin.canCreateAccount=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_ACCOUNT]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_ACCOUNT].some)||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_ACCOUNT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_ACCOUNT].some))
};
ZaZimbraAdmin.canListAccounts=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaAccount.RIGHT_LIST_ACCOUNT]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaAccount.RIGHT_LIST_ACCOUNT].some)||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaAccount.RIGHT_LIST_ACCOUNT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaAccount.RIGHT_LIST_ACCOUNT].some)||(ZaSettings.targetRights[ZaItem.ACCOUNT]&&ZaSettings.targetRights[ZaItem.ACCOUNT][ZaAccount.RIGHT_LIST_ACCOUNT]&&ZaSettings.targetRights[ZaItem.ACCOUNT][ZaAccount.RIGHT_LIST_ACCOUNT].some))
};
ZaZimbraAdmin.canCreateAlias=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_ALIAS]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_ALIAS].some)||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_ALIAS]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_ALIAS].some))
};
ZaZimbraAdmin.canCreateDL=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_DL]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_DL].some)||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_DL]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_DL].some))
};
ZaZimbraAdmin.canCreateCalRes=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_CALRES]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.RIGHT_CREATE_CALRES].some)||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_CALRES]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.RIGHT_CREATE_CALRES].some))
};
ZaZimbraAdmin.canCreateCos=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.CREATE_COS_RIGHT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.CREATE_COS_RIGHT].some))
};
ZaZimbraAdmin.canChangeExchangeConfig=function(){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[ZaItem.DOMAIN]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.CHECK_EXCHANGE_AUTH_CONFIG_RIGHT]&&ZaSettings.targetRights[ZaItem.DOMAIN][ZaDomain.CHECK_EXCHANGE_AUTH_CONFIG_RIGHT].some)||(ZaSettings.targetRights[ZaItem.GLOBAL_GRANT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.CHECK_EXCHANGE_AUTH_CONFIG_RIGHT]&&ZaSettings.targetRights[ZaItem.GLOBAL_GRANT][ZaDomain.CHECK_EXCHANGE_AUTH_CONFIG_RIGHT].some))
};
ZaZimbraAdmin.haveTargetRight=function(t,o,e){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[t][o]&&ZaSettings.targetRights[t][o][e]))
};
ZaZimbraAdmin.haveAnyTargetRight=function(e,t){
return(ZaZimbraAdmin.isGlobalAdmin()||(ZaSettings.targetRights[e][t]&&ZaSettings.targetRights[e][t].some))
}
}
if(AjxPackage.define("zimbraAdmin.helpdesk.view.ZaHelpView")){
ZaHelpView=function(e){
if(arguments.length==0){
return
}
ZaTabView.call(this,e,"ZaHelpView");
this.setScrollStyle(Dwt.SCROLL);
this.initForm(new Object(),this.getMyXForm())
};
ZaHelpView.mainHelpPage="administration_console_help.htm";
ZaHelpView.RELEASE_NOTES_URL="https://www.zimbra.com/support/documentation/zcs-ne-documentation.html";
ZaHelpView.HELP_FORUM_LINK="https://www.zimbra.com/forums/";
ZaHelpView.HELP_WIKI_LINK="https://wiki.zimbra.com";
ZaHelpView.prototype=new ZaTabView();
ZaHelpView.prototype.constructor=ZaHelpView;
ZaTabView.XFormModifiers.ZaHelpView=new Array();
ZaHelpView.prototype.getTabIcon=function(){
return"Help"
};
ZaHelpView.prototype.getTabTitle=function(){
return ZaMsg.Help_view_title
};
ZaHelpView.prototype.getTitle=function(){
return ZaMsg.Help_view_title
};
ZaHelpView.prototype.initForm=function(t,e){
if(t==null||e==null){
throw new AjxException("Metadata for XForm and/or XModel are not defined",AjxException.INVALID_PARAM,"ZaHelpView.prototype.initForm")
}
this._localXModel=new XModel(t);
this._localXForm=new XForm(e,this._localXModel,null,this);
this._localXForm.setController(this);
this._localXForm.draw();
this._localXForm.setInstance({}
);
this._drawn=true
};
ZaHelpView.prototype.showAboutDialog=function(){
var e=this._appCtxt.getAppController();
e._aboutZimbraListener()
};
ZaHelpView.showWikiLink=function(){
return !AjxUtil.isEmpty(ZabMsg.HELP_WIKI_LINK)
};
ZaHelpView.myXFormModifier=function(s){
s.tableCssStyle="width:100%;overflow:auto;";
s.itemDefaults={
_SEPARATOR_:{
containerCssStyle:"padding-right:3px;padding-left:3px;"}};
if(!ZaSettings.isOctopus()){
s.items=ZaHelpView.getAdminXFormItems();
return
}
s.items=[{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:[{
type:_ZATABCASE_,id:"help_view_tab",numCols:1,width:"100%",caseKey:1,paddingStyle:"padding-left:15px;",width:"98%",cellpadding:2,visibilityChecks:[],items:[{
type:_OUTPUT_,label:null,value:ZabMsg.HELP_PAGE_0,colSpan:"*",cssStyle:"font-size:12pt;	font-weight: bold;"}
,{
type:_OUTPUT_,label:null,value:ZabMsg.HELP_PAGE_1,colSpan:"*",cssStyle:"font-size:12px;"}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_GROUP_,numCols:2,id:"ZimbraHelpPageDownloadItems",colSpan:"*",items:[{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("Help")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.HELP_PAGE_2,href:(location.pathname+ZaUtil.HELP_URL+ZaHelpView.mainHelpPage+"?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZaMsg.HELP_PAGE_4,href:ZaHelpView.RELEASE_NOTES_URL}
]}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZabMsg.HELP_PAGE_3,cssStyle:"padding-right:10px;padding-left:10px;",containerCssStyle:"width:50%;"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZaMsg.HELP_PAGE_5,cssStyle:"padding-right:10px;padding-left:10px;",containerCssStyle:"width:50%;"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
,{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",href:ZaHelpView.HELP_FORUM_LINK,showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.HELP_PAGE_6}
]}
,{
type:_GROUP_,numCols:2,visibilityChecks:[[ZaHelpView.showWikiLink]],items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",href:ZaHelpView.HELP_WIKI_LINK,showInNewWindow:true,labelLocation:_NONE_,label:ZaMsg.HELP_PAGE_12}
]}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZabMsg.HELP_PAGE_7,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_OUTPUT_,label:null,value:ZabMsg.HELP_PAGE_13,visibilityChecks:[[ZaHelpView.showWikiLink]],cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
]}
,{
type:_SPACER_,height:10}
,{
type:_GROUP_,colSpan:"*",items:[{
type:_DWT_BUTTON_,id:"about_button",label:ZabMsg.About_Button_Label,onActivate:"this.getFormController().showAboutDialog()",width:"125px"}
]}
]}
]}
];
var n;
if(!ZaSettings.isOctopus()){
n=[{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.HELP_PAGE_8,href:(location.pathname+"adminhelp/pdf/admin.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_GROUP_,numCols:4,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZaMsg.HELP_PAGE_10_EXCHANGE,href:(location.pathname+"adminhelp/pdf/MigrationWizard.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
,{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZaMsg.HELP_PAGE_10_DOMINO,href:(location.pathname+"adminhelp/pdf/MigrationWizard_Domino.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZabMsg.HELP_PAGE_9,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZaMsg.HELP_PAGE_11,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
,{
type:_GROUP_,numCols:2,id:"HelpOtherGuides",items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZaMsg.HELP_OTHER_GUIDES_IMPORT,href:(location.pathname+"adminhelp/pdf/Import_Wizard_Outlook.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_GROUP_,numCols:2,id:"iCalMigDoc",items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZaMsg.ICAL_MIG_GUIDE,href:(location.pathname+"help/admin/pdf/Zimbra%20iCalendar%20Migration%20Guide.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_SPACER_}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZaMsg.HELP_OTHER_GUIDES_IMPORT_INFO,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZaMsg.ICAL_MIG_GUIDE_INFO,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
]
}else{
n=[{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.HELP_PAGE_8,href:(location.pathname+"help/admin/pdf/o_admin_guide.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_GROUP_,numCols:2,id:"zwcEndUserGuide",items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.ZWC_END_USER_GUIDE,href:(location.pathname+"help/admin/pdf/o_webclient_user_guide.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
,{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.ANDROID_END_USER_GUIDE,href:(location.pathname+"help/admin/pdf/o_androidclient_user_guide.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
,{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.IOS_END_USER_GUIDE,href:(location.pathname+"help/admin/pdf/o_iosclient_user_guide.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZabMsg.HELP_PAGE_9,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZabMsg.ZWC_END_USER_GUIDE_INFO,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
]
}
var o=s.items[0].items[0].items;
for(var e=0;
e<o.length;
e++){
if(o[e].id=="ZimbraHelpPageDownloadItems"){
o[e].items=o[e].items.concat(n);
break
}}
if(!ZaSettings.isNetworkVersion()&&!ZaSettings.isOctopus()){
var t=[{
type:_GROUP_,numCols:2,id:"zwcEndUserGuide",items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("PDFDoc")}
,{
type:_ANCHOR_,cssStyle:"font-size:12px;",showInNewWindow:true,labelLocation:_NONE_,label:ZabMsg.ZWC_END_USER_GUIDE,href:(location.pathname+"help/admin/pdf/zimbra_user_guide.pdf?locid="+AjxEnv.DEFAULT_LOCALE)}
]}
,{
type:_CELL_SPACER_}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",label:null,value:ZabMsg.ZWC_END_USER_GUIDE_INFO,cssStyle:"padding-right:10px;padding-left:10px;"}
,{
type:_CELL_SPACER_}
,{
type:_SEPARATOR_,colSpan:1,cssClass:"helpSeparator"}
];
var o=s.items[0].items[0].items;
for(var e=0;
e<o.length;
e++){
if(o[e].id=="ZimbraHelpPageDownloadItems"){
o[e].items=o[e].items.concat(t);
break
}}}else{}};
ZaTabView.XFormModifiers.ZaHelpView.push(ZaHelpView.myXFormModifier);
ZaHelpView.getAdminXFormItems=function(){
var e="";
var t={
type:_OUTPUT_,cssStyle:"font-size: 8px; margin-left: 20px;",label:null,value:"<li></li>"};
return[{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:[{
type:_ZATABCASE_,id:"help_view_tab",numCols:1,width:"100%",caseKey:1,paddingStyle:"padding-left: 15px;",width:"98%",cellpadding:2,visibilityChecks:[function(){
return true
}
],items:[{
type:_SPACER_,height:"10"}
,{
type:_OUTPUT_,label:null,value:ZaMsg.title_help_center,colSpan:"*",cssStyle:"font-size: 12pt; font-weight: bold;"}
,{
type:_GROUP_,width:"100%",numCols:2,colSizes:["70%","30%"],items:[{
type:_SPACER_,height:"10"}
,{
type:_ZALEFT_GROUPER_,numCols:1,width:"100%",labelCssClass:"ZaHelpViewGroupLabel",borderCssClass:"ZaHelpViewGroupBorder",items:[{
type:_GROUP_,id:"helpDocsGroup",numCols:1,width:"100%",items:[ZaHelpView._getAnchorItem(ZaMsg.subtitle_help_center_1,ZaUtil.HELP_URL+ZaHelpView.mainHelpPage,14),ZaHelpView._getDescItem(ZaMsg.desc_help_center_1),{
type:_SPACER_,height:"5"}
,{
type:_GROUP_,width:"100%",numCols:2,colSizes:["20","*"],items:[t,{
type:_ANCHOR_,cssStyle:"font-size: 13px;",showInNewWindow:true,labelLocation:_NONE_,label:ZaMsg.sub_desc_help_center_1,href:ZaHelpView.RELEASE_NOTES_URL}
]}
,{
type:_SPACER_,height:"20"}
,ZaHelpView._getAnchorItem(ZaMsg.subtitle_help_center_2,"adminhelp/pdf/admin.pdf",14),ZaHelpView._getDescItem(ZaMsg.desc_help_center_2),{
type:_SPACER_,height:"5"}
,{
visibilityChecks:[function(){
try{
return ZaSettings.EnabledZimlet.com_zimbra_mobilesync
}
catch(o){
return false
}}
],enableDisableChecks:[],type:_GROUP_,width:"100%",numCols:2,colSizes:["20","*"],items:[t,ZaHelpView._getAnchorItem(ZaMsg.sub_desc_help_center_2,"adminhelp/pdf/ZCS%20Connector%20for%20Outlook.pdf",13)]}
,{
type:_SPACER_,height:"20"}
,ZaHelpView._getAnchorItem(ZaMsg.subtitle_help_center_3,"help/admin/pdf/zimbra_user_guide.pdf",14),ZaHelpView._getDescItem(ZaMsg.desc_help_center_3),{
type:_SPACER_,height:"5"}
,{
visibilityChecks:[function(){
try{
return ZaSettings.EnabledZimlet.com_zimbra_mobilesync
}
catch(o){
return false
}}
],enableDisableChecks:[],type:_GROUP_,width:"100%",numCols:2,colSizes:["20","*"],items:[t,ZaHelpView._getAnchorItem(ZaMsg.sub_desc_help_center_3,"adminhelp/pdf/User%20Instructions%20Connector%20for%20Outlook.pdf",13)]}
]}
,{
type:_SPACER_,height:"20"}
,{
type:_GROUP_,colSpan:"*",id:"helpAskCommunity",containerCssClass:"ZaHelpAskCommunityContainer",cssClass:"ZaHelpAskCommunityPanel",numCols:1,items:[{
type:_GROUP_,colSpan:"*",numCols:1,width:"100%",containerCssClass:"ZaHelpAskCommunityContent",items:[{
type:_OUTPUT_,label:null,value:ZaMsg.title_ask_community,colSpan:"*",cssStyle:"font-size: 12px; font-weight: bold;"}
,ZaHelpView._getDescItem(ZaMsg.desc_ask_community_1),{
type:_SPACER_,height:"10"}
,ZaHelpView._getDescItem(ZaMsg.desc_ask_community_2)]}
]}
]}
,{
type:_ZARIGHT_GROUPER_,numCols:1,width:"100%",labelCssClass:"ZaHelpViewGroupLabel",borderCssClass:"ZaHelpViewGroupNoneBorder",containerCssStyle:"vertical-align:top",items:[{
type:_OUTPUT_,label:null,value:ZaMsg.title_top_migration_questions,colSpan:"*",cssStyle:"font-size: 14px; font-weight: bold;"}
,{
type:_SPACER_,height:"20"}
,{
type:_GROUP_,width:"100%",numCols:2,colSizes:["20","*"],items:[t,ZaHelpView._getAnchorItem(ZaMsg.ques_top_migration_questions_1,"adminhelp/pdf/Migration_Exch_Admin.pdf",13)]}
,{
type:_SPACER_,height:"20"}
,{
type:_GROUP_,width:"100%",numCols:2,colSizes:["20","*"],items:[t,ZaHelpView._getAnchorItem(ZaMsg.ques_top_migration_questions_2,"adminhelp/pdf/Migration_Exch_User.pdf",13)]}
,{
type:_SPACER_,height:"20"}
,{
type:_GROUP_,width:"100%",numCols:2,colSizes:["20","*"],items:[t,ZaHelpView._getAnchorItem(ZaMsg.ques_top_migration_questions_3,"adminhelp/pdf/MigrationWizard_Domino.pdf",13)]}
,{
type:_SPACER_,height:"20"}
,{
type:_GROUP_,width:"100%",numCols:2,colSizes:["20","*"],items:[t,ZaHelpView._getAnchorItem(ZaMsg.ques_top_migration_questions_4,"adminhelp/pdf/Zimbra%20iCalendar%20Migration%20Guide.pdf",13)]}
]}
]}
]}
]}
]
};
ZaHelpView._getAnchorItem=function(t,n,o){
if(!t||!n){
return
}
if(!o){
o=12
}
var e={
type:_ANCHOR_,showInNewWindow:true,labelLocation:_NONE_,label:t,href:ZaHelpView._getGuideURL(n),cssStyle:"font-size: "+o+"px;"};
return e
};
ZaHelpView._getDescItem=function(t){
if(!t){
return
}
var e={
type:_OUTPUT_,cssStyle:"font-size: 12px; padding-top: 5px; padding-right: 10px; padding-left: 10px;",label:null,value:t};
return e
};
ZaHelpView._getGuideURL=function(e){
var t=[];
t.push(location.pathname);
t.push(e);
t.push("?locid=");
t.push(AjxEnv.DEFAULT_LOCALE);
return t.join("")
}
}
if(AjxPackage.define("zimbraAdmin.helpdesk.view.ZaMWizView")){
ZaMigrationWizView=function(e){
if(arguments.length==0){
return
}
ZaTabView.call(this,{
parent:e,iKeyName:"ZaMigrationWizView",contextId:ZaId.TAB_DOWNLOADS}
);
this.setScrollStyle(Dwt.SCROLL);
this.initForm(new Object(),this.getMyXForm())
};
ZaMigrationWizView.prototype=new ZaTabView();
ZaMigrationWizView.prototype.constructor=ZaMigrationWizView;
ZaTabView.XFormModifiers.ZaMigrationWizView=new Array();
ZaMigrationWizView.prototype.getTabIcon=function(){
return"MigrationWiz"
};
ZaMigrationWizView.prototype.getTabTitle=function(){
return ZaMsg.Migration_wiz_title
};
ZaMigrationWizView.prototype.getTitle=function(){
return ZaMsg.Migration_wiz_title
};
ZaMigrationWizView.prototype.initForm=function(t,e){
if(t==null||e==null){
throw new AjxException("Metadata for XForm and/or XModel are not defined",AjxException.INVALID_PARAM,"ZaMigrationWizView.prototype.initForm")
}
this._localXModel=new XModel(t);
this._localXForm=new XForm(e,this._localXModel,null,this,ZaId.getTabViewId(this._contextId));
this._localXForm.setController(this);
this._localXForm.draw();
this._localXForm.refresh();
this._drawn=true
};
ZaMigrationWizView.myXFormModifier=function(e){
e.tableCssStyle="width:100%;overflow:auto;";
e.itemDefaults={
_SEPARATOR_:{
containerCssStyle:"padding-right:3px;padding-left:3px;"}};
e.items=[{
type:_OUTPUT_,label:null,value:ZaMsg.DOWNLOAD_PAGE_0,colSpan:"*",cssStyle:"font-size:12pt;	font-weight: bold;"}
,{
type:_GROUP_,numCols:2,colSpan:"*",items:[{
type:_OUTPUT_,label:null,value:ZaMsg.DOWNLOAD_PAGE_1,cssStyle:"font-size:12px;"}
,{
type:_OUTPUT_,value:AjxImg.getImageHtml("Help")}
]}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_OUTPUT_,label:null,value:ZaMsg.DOWNLOAD_FOR_ADMIN,colSpan:"*",cssStyle:"font-size:10pt;font-weight: bold;"}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_GROUP_,numCols:1,colSpan:"*",zName:"DownloadsForAdmin",items:[{
type:_GROUP_,numCols:3,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("Migration")}
,{
type:_OUTPUT_,cssStyle:"font-size:12px",labelLocation:_NONE_,label:null,id:"general_migration_x86_link",value:ZaMigrationWizView.getDownloadLink(ZaMsg.GENERAL_MIG_WIZ_X86_DOWNLOAD_LINK,ZaMsg.GENERAL_MIG_WIZ_X86_DOWNLOAD_LINK_MSG)}
,{
type:_OUTPUT_,cssStyle:"font-size:12px",labelLocation:_NONE_,label:null,id:"general_migration_x64_link",value:ZaMigrationWizView.getDownloadLink(ZaMsg.GENERAL_MIG_WIZ_X64_DOWNLOAD_LINK,ZaMsg.GENERAL_MIG_WIZ_X64_DOWNLOAD_LINK_MSG)}
]}
,{
type:_OUTPUT_,cssClass:"ZaDownloadText",label:null,value:ZaMsg.GENERAL_MIG_WIZ_DOWNLOAD_TEXT}
,{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("Migration")}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",labelLocation:_NONE_,label:null,id:"domino_migration_link",value:ZaMigrationWizView.getDownloadLink(ZaMsg.DOMINO_MIG_WIZ_DOWNLOAD_LINK,ZaMsg.DOMINO_MIG_WIZ_DOWNLOAD_LINK_MSG)}
]}
,{
type:_OUTPUT_,cssClass:"ZaDownloadText",label:null,value:ZaMsg.DOMINO_MIG_WIZ_DOWNLOAD_TEXT}
,{
type:_GROUP_,numCols:2,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("Migration")}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",labelLocation:_NONE_,label:null,id:"exchange_migration_link",value:ZaMigrationWizView.getDownloadLink(ZaMsg.MIG_WIZ_DOWNLOAD_LINK,ZaMsg.MIG_WIZ_DOWNLOAD_LINK_MSG)}
]}
,{
type:_OUTPUT_,cssClass:"ZaDownloadText",label:null,value:ZaMsg.MIG_WIZ_DOWNLOAD_TEXT}
,]}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_OUTPUT_,label:null,value:ZaMsg.DOWNLOAD_FOR_USER,colSpan:"*",cssStyle:"font-size:10pt;font-weight: bold;"}
,{
type:_SPACER_,colSpan:"*"}
,{
type:_GROUP_,numCols:1,colSpan:"*",zName:"DownloadsForUser",items:[{
type:_GROUP_,numCols:3,items:[{
type:_OUTPUT_,value:AjxImg.getImageHtml("Migration")}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",labelLocation:_NONE_,label:null,id:"pst_import_link",value:ZaMigrationWizView.getDownloadLink(ZaMsg.IMPORT_WIZ_DOWNLOAD_LINK,ZaMsg.IMPORT_WIZ_DOWNLOAD_LINK_MSG)}
,{
type:_OUTPUT_,cssStyle:"font-size:12px;",labelLocation:_NONE_,label:null,id:"pst_import_help_link",value:["(<A target='_blank' onclick='ZaZimbraAdmin.unloadHackCallback();' HREF='",location.pathname,"adminhelp/pdf/User Instructions for ZCS Import Wizard.pdf?locid=",AjxEnv.DEFAULT_LOCALE,"'>",ZaMsg.IMPORT_WIZ_DOWNLOAD_HELP,"</a>)"].join("")}
]}
,{
type:_OUTPUT_,cssClass:"ZaDownloadText",label:null,value:ZaMsg.IMPORT_WIZ_DOWNLOAD_TEXT}
]}
]
};
ZaTabView.XFormModifiers.ZaMigrationWizView.push(ZaMigrationWizView.myXFormModifier);
ZaMigrationWizView.getDownloadLink=function(e,t){
return'<a onclick="ZaZimbraAdmin.unloadHackCallback();" target="_blank" href="'+e+'">'+t+"</a>"
}
}
if(AjxPackage.define("zimbraAdmin.mta.view.ZaQSummaryListView")){
ZaQSummaryListView=function(n,o,t,e){
ZaListView.call(this,n,o,t,e)
};
ZaQSummaryListView.prototype=new ZaListView;
ZaQSummaryListView.prototype.constructor=ZaQSummaryListView;
ZaQSummaryListView.prototype.toString=function(){
return"ZaQSummaryListView"
};
ZaQSummaryListView.prototype._createItemHtml=function(s){
var n=new Array(50);
var h=document.createElement("div");
h[DwtListView._STYLE_CLASS]="Row";
h[DwtListView._SELECTED_STYLE_CLASS]=h[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
h.className=h[DwtListView._STYLE_CLASS];
this.associateItemWithElement(s,h,DwtListView.TYPE_LIST_ITEM);
var e=0;
n[e++]="<table width='100%' cellspacing='2' cellpadding='0'>";
n[e++]="<tr>";
if(this._headerList){
var o=this._headerList.length;
for(var t=0;
t<o;
t++){
var r=this._headerList[t]._field;
if(r==ZaMTAQSummaryItem.A_text_col){
n[e++]="<td width='"+this._headerList[t]._width+"' align=left>";
n[e++]=AjxStringUtil.htmlEncode(s[ZaMTAQSummaryItem.A_text]);
n[e++]="</td>"
}else{
if(r==ZaMTAQSummaryItem.A_count_col){
n[e++]="<td width='"+this._headerList[t]._width+"' align=left>";
n[e++]=s[ZaMTAQSummaryItem.A_count];
n[e++]="</td>"
}}}}else{
n[e++]="<td width=100%>";
n[e++]=AjxStringUtil.htmlEncode(s);
n[e++]="</td>"
}
n[e++]="</tr></table>";
h.innerHTML=n.join("");
return h
};
ZaQSummaryListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br>&nbsp","</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaQSummaryListView.prototype._sortColumn=function(t,o){
if(o){
var e=function(s,n){
return(s<n)?1:((s>n)?-1:0)
};
this.getList().sort(e)
}else{
this.getList().sort()
}};
ZaQSummaryListView.prototype._handleColHeaderResize=function(e){
ZaListView._handleColHeaderResize.call(this,e)
}
}
if(AjxPackage.define("zimbraAdmin.mta.view.ZaQMessagesListView")){
ZaQMessagesListView=function(n,o,t,e){
ZaListView.call(this,n,o,t,e)
};
ZaQMessagesListView.prototype=new ZaListView;
ZaQMessagesListView.prototype.constructor=ZaQMessagesListView;
ZaQMessagesListView.prototype.toString=function(){
return"ZaQMessagesListView"
};
ZaQMessagesListView.prototype._createItemHtml=function(s){
var n=new Array(50);
var h=document.createElement("div");
h[DwtListView._STYLE_CLASS]="Row";
h[DwtListView._SELECTED_STYLE_CLASS]=h[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
h.className=h[DwtListView._STYLE_CLASS];
this.associateItemWithElement(s,h,DwtListView.TYPE_LIST_ITEM);
var e=0;
n[e++]="<table width='100%' cellspacing='0' cellpadding='0'>";
n[e++]="<tr>";
if(this._headerList){
var o=this._headerList.length;
for(var t=0;
t<o;
t++){
var r=this._headerList[t]._field;
if(r==ZaMTAQMsgItem.A_id){
n[e++]="<td align=left height=20px width="+this._headerList[t]._width+">";
n[e++]=AjxStringUtil.htmlEncode(String(s[ZaMTAQMsgItem.A_id]));
n[e++]="</td>"
}else{
if(r==ZaMTAQMsgItem.A_recipients){
n[e++]="<td align=left height=20px width="+this._headerList[t]._width+">";
n[e++]=s[ZaMTAQMsgItem.A_recipients];
n[e++]="</td>"
}else{
if(r==ZaMTAQMsgItem.A_content_filter){
n[e++]="<td align=left height=20px width="+this._headerList[t]._width+">";
n[e++]=s[ZaMTAQMsgItem.A_content_filter];
n[e++]="</td>"
}else{
if(r==ZaMTAQMsgItem.A_time){
n[e++]="<td align=left height=20px width="+this._headerList[t]._width+">";
n[e++]=AjxDateUtil.computeDateStr(new Date(),parseInt(s[ZaMTAQMsgItem.A_time]));
n[e++]="</td>"
}else{
if(r==ZaMTAQMsgItem.A_origin_host){
n[e++]="<td align=left height=20px width="+this._headerList[t]._width+">";
n[e++]=AjxStringUtil.htmlEncode(s[ZaMTAQMsgItem.A_origin_host]);
n[e++]="</td>"
}else{
if(r==ZaMTAQMsgItem.A_sender){
n[e++]="<td align=left height=20px width="+this._headerList[t]._width+">";
n[e++]=s[ZaMTAQMsgItem.A_sender];
n[e++]="</td>"
}else{
if(r==ZaMTAQMsgItem.A_origin_ip){
n[e++]="<td align=left height=20px width="+this._headerList[t]._width+">";
n[e++]=s[ZaMTAQMsgItem.A_origin_ip];
n[e++]="</td>"
}}}}}}}}}else{
n[e++]="<td width=100%>";
n[e++]=AjxStringUtil.htmlEncode(s);
n[e++]="</td>"
}
n[e++]="</tr></table>";
h.innerHTML=n.join("");
return h
};
ZaQMessagesListView.prototype._setNoResultsHtml=function(){
var e=new AjxBuffer();
var t=document.createElement("div");
e.append("<table width='100%' cellspacing='0' cellpadding='1'>","<tr><td class='NoResults'><br>&nbsp","</td></tr></table>");
t.innerHTML=e.toString();
this._addRow(t)
};
ZaQMessagesListView.prototype._sortColumn=function(t,o){
if(o){
var e=function(s,n){
return(s<n)?1:((s>n)?-1:0)
};
this.getList().sort(e)
}else{
this.getList().sort()
}};
ZaQMessagesListView.prototype._handleColHeaderResize=function(e){
ZaListView._handleColHeaderResize.call(this,e)
}
}
if(AjxPackage.define("zimbraAdmin.mta.view.ZaMTAListView")){
ZaMTAListView=function(n){
var o=null;
var t=DwtControl.ABSOLUTE_STYLE;
var e=this._getHeaderList();
ZaListView.call(this,{
parent:n,className:o,posStyle:t,headerList:e,id:ZaId.TAB_MTX_MANAGE}
);
this._appCtxt=this.shell.getData(ZaAppCtxt.LABEL)
};
ZaMTAListView.prototype=new ZaListView;
ZaMTAListView.prototype.toString=function(){
return"ZaMTAListView"
};
ZaMTAListView.prototype.getTitle=function(){
return ZaMsg.PostQ_title
};
ZaMTAListView.prototype.getTabIcon=function(){
return"Queue"
};
ZaMTAListView.prototype.setUI=function(){
ZaListView.prototype.setUI.call(this);
var n=this._list;
var e=n.size();
for(var t=0;
t<e;
t++){
var o=n.get(t);
var s=this._getItemId(o);
this.higlightQItem(s,ZaMTA.A_DeferredQ,(parseInt(o[ZaMTA.A_DeferredQ][ZaMTA.A_count])>parseInt(ZaMTA.threashHold)));
this.higlightQItem(s,ZaMTA.A_IncomingQ,(parseInt(o[ZaMTA.A_IncomingQ][ZaMTA.A_count])>parseInt(ZaMTA.threashHold)));
this.higlightQItem(s,ZaMTA.A_ActiveQ,(parseInt(o[ZaMTA.A_ActiveQ][ZaMTA.A_count])>parseInt(ZaMTA.threashHold)));
this.higlightQItem(s,ZaMTA.A_CorruptQ,(parseInt(o[ZaMTA.A_CorruptQ][ZaMTA.A_count])>parseInt(ZaMTA.threashHold)));
this.higlightQItem(s,ZaMTA.A_HoldQ,(parseInt(o[ZaMTA.A_HoldQ][ZaMTA.A_count])>parseInt(ZaMTA.threashHold)))
}};
ZaMTAListView.prototype.higlightQItem=function(n,e,t){
var o=document.getElementById(n+"_"+e);
if(o){
o.style.color=t?"#FD4545":"black";
o.style.fontWeight=t?"bold":"normal"
}};
ZaMTAListView.prototype._createItemHtml=function(t,o,s){
var h=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(t,e,DwtListView.TYPE_LIST_ITEM);
var l=this._getItemId(t);
var d=0;
h[d++]="<table width='100%' cellspacing='0' cellpadding='0'>";
h[d++]="<tr>";
var n=this._headerList.length;
for(var r=0;
r<n;
r++){
var c=this._headerList[r]._field;
if(c==ZaMTA.A_Servername){
h[d++]="<td width="+this._headerList[r]._width+">";
h[d++]=AjxStringUtil.htmlEncode(t[ZaMTA.A_name]);
h[d++]="</td>"
}else{
if(c==ZaMTA.A_DeferredQ){
h[d++]="<td width="+this._headerList[r]._width+"><span id='"+(l+"_"+ZaMTA.A_DeferredQ)+"'>";
h[d++]=t[ZaMTA.A_DeferredQ][ZaMTA.A_count];
h[d++]="</span></td>"
}else{
if(c==ZaMTA.A_IncomingQ){
h[d++]="<td width="+this._headerList[r]._width+"><span id='"+(l+"_"+ZaMTA.A_IncomingQ)+"'>";
h[d++]=t[ZaMTA.A_IncomingQ][ZaMTA.A_count];
h[d++]="</span></td>"
}else{
if(c==ZaMTA.A_ActiveQ){
h[d++]="<td width="+this._headerList[r]._width+"><span id='"+(l+"_"+ZaMTA.A_ActiveQ)+"'>";
h[d++]=t[ZaMTA.A_ActiveQ][ZaMTA.A_count];
h[d++]="</span></td>"
}else{
if(c==ZaMTA.A_CorruptQ){
h[d++]="<td width="+this._headerList[r]._width+"><span id='"+(l+"_"+ZaMTA.A_CorruptQ)+"'>";
h[d++]=t[ZaMTA.A_CorruptQ][ZaMTA.A_count];
h[d++]="</span></td>"
}else{
if(c==ZaMTA.A_HoldQ){
h[d++]="<td width="+this._headerList[r]._width+"><span id='"+(l+"_"+ZaMTA.A_HoldQ)+"'>";
h[d++]=t[ZaMTA.A_HoldQ][ZaMTA.A_count];
h[d++]="</span></td>"
}}}}}}}
h[d++]="</tr></table>";
e.innerHTML=h.join("");
return e
};
ZaMTAListView.prototype._getHeaderList=function(){
var e=new Array();
e[0]=new ZaListHeaderItem(ZaMTA.A_Servername,ZaMsg.SLV_ServiceHName_col,null,"auto",null,null,true,true);
e[1]=new ZaListHeaderItem(ZaMTA.A_DeferredQ,ZaMsg.PQV_DeferredQ_col,null,100,null,null,true,true);
e[2]=new ZaListHeaderItem(ZaMTA.A_IncomingQ,ZaMsg.PQV_IncomingQ_col,null,100,null,null,true,true);
e[3]=new ZaListHeaderItem(ZaMTA.A_ActiveQ,ZaMsg.PQV_ActiveQ_col,null,100,null,null,true,true);
e[4]=new ZaListHeaderItem(ZaMTA.A_CorruptQ,ZaMsg.PQV_CorruptQ_col,null,100,null,null,true,true);
e[5]=new ZaListHeaderItem(ZaMTA.A_HoldQ,ZaMsg.PQV_HoldQ_col,null,100,null,null,true,true);
return e
}
}
if(AjxPackage.define("zimbraAdmin.mta.view.ZaMTAXFormView")){
ZaMTAXFormView=function(e){
ZaTabView.call(this,{
parent:e,iKeyName:"ZaMTAXFormView",contextId:ZaId.TAB_MTX_EDIT}
);
this.TAB_INDEX=0;
ZaMTAXFormView._tab1=++this.TAB_INDEX;
ZaMTAXFormView._tab2=++this.TAB_INDEX;
ZaMTAXFormView._tab3=++this.TAB_INDEX;
ZaMTAXFormView._tab4=++this.TAB_INDEX;
ZaMTAXFormView._tab5=++this.TAB_INDEX;
this.initForm(ZaMTA.myXModel,this.getMyXForm());
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,ZaMTAXFormView.prototype.handleXFormChange));
this._localXForm.setController(ZaApp.getInstance())
};
ZaMTAXFormView.prototype=new ZaTabView();
ZaMTAXFormView.prototype.constructor=ZaMTAXFormView;
ZaTabView.XFormModifiers.ZaMTAXFormView=new Array();
ZaMTAXFormView.SCANNER_STATUS_CHOICES=new XFormChoices([{
value:ZaMTA.STATUS_IDLE,label:ZaMsg.PQ_ScannerIdle}
,{
value:ZaMTA.STATUS_SCANNING,label:ZaMsg.PQ_ScannerScanning}
,{
value:ZaMTA.STATUS_SCAN_COMPLETE,label:ZaMsg.PQ_ScannerScanComplete}
,{
value:ZaMTA.STATUS_STALE,label:ZaMsg.PQ_ScannerStaleData}
],XFormChoices.OBJECT_LIST,"value","label");
ZaMTAXFormView.tabChoices=new XFormChoices([{
value:ZaMTAXFormView._tab1,label:ZaMsg.PQV_Tab_Deferred}
,{
value:ZaMTAXFormView._tab2,label:ZaMsg.PQV_Tab_IncomingQ}
,{
value:ZaMTAXFormView._tab3,label:ZaMsg.PQV_Tab_ActiveQ}
,{
value:ZaMTAXFormView._tab4,label:ZaMsg.PQV_Tab_HoldQ}
,{
value:ZaMTAXFormView._tab5,label:ZaMsg.PQV_Tab_CorruptQ}
],XFormChoices.OBJECT_LIST,"value","label");
ZaMTAXFormView.prototype.getTabIcon=function(){
return"Queue"
};
ZaMTAXFormView.prototype.setObject=function(e){
this._containedObject=e;
this._containedObject._viewInternalId=this.__internalId;
if(!e[ZaModel.currentTab]){
this._containedObject[ZaModel.currentTab]="1"
}else{
this._containedObject[ZaModel.currentTab]=e[ZaModel.currentTab]
}
ZaMTAXFormView.SCANNER_STATUS_CHOICES.setChoices([{
value:ZaMTA.STATUS_IDLE,label:ZaMsg.PQ_ScannerIdle}
,{
value:ZaMTA.STATUS_SCANNING,label:ZaMsg.PQ_ScannerScanning}
,{
value:ZaMTA.STATUS_SCAN_COMPLETE,label:ZaMsg.PQ_ScannerScanComplete}
,{
value:ZaMTA.STATUS_STALE,label:ZaMsg.PQ_ScannerStaleData}
]);
ZaMTAXFormView.tabChoices.setChoices([{
value:ZaMTAXFormView._tab1,label:ZaMsg.PQV_Tab_Deferred+" ("+this._containedObject[ZaMTA.A_DeferredQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab2,label:ZaMsg.PQV_Tab_IncomingQ+" ("+this._containedObject[ZaMTA.A_IncomingQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab3,label:ZaMsg.PQV_Tab_ActiveQ+" ("+this._containedObject[ZaMTA.A_ActiveQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab4,label:ZaMsg.PQV_Tab_HoldQ+" ("+this._containedObject[ZaMTA.A_HoldQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab5,label:ZaMsg.PQV_Tab_CorruptQ+" ("+this._containedObject[ZaMTA.A_CorruptQ][ZaMTA.A_count]+")"}
]),ZaMTAXFormView.tabChoices.dirtyChoices();
this._localXForm.setInstance(this._containedObject);
ZaMTAXFormView.prototype.handleXFormChange.call(this)
};
ZaMTAXFormView.prototype.handleXFormChange=function(){
if(this._containedObject[ZaModel.currentTab]=="1"&&(this._containedObject[ZaMTA.A_DeferredQ][ZaMTA.A_Status]==ZaMTA.STATUS_IDLE)){
this._containedObject.getMailQStatus(ZaMTA.A_DeferredQ,null,0,null,true)
}
if(this._containedObject[ZaModel.currentTab]=="2"&&(this._containedObject[ZaMTA.A_IncomingQ][ZaMTA.A_Status]==ZaMTA.STATUS_IDLE)){
this._containedObject.getMailQStatus(ZaMTA.A_IncomingQ,null,0,null,true)
}
if(this._containedObject[ZaModel.currentTab]=="3"&&(this._containedObject[ZaMTA.A_ActiveQ][ZaMTA.A_Status]==ZaMTA.STATUS_IDLE)){
this._containedObject.getMailQStatus(ZaMTA.A_ActiveQ,null,0,null,true)
}
if(this._containedObject[ZaModel.currentTab]=="4"&&(this._containedObject[ZaMTA.A_HoldQ][ZaMTA.A_Status]==ZaMTA.STATUS_IDLE)){
this._containedObject.getMailQStatus(ZaMTA.A_HoldQ,null,0,null,true)
}
if(this._containedObject[ZaModel.currentTab]=="5"&&(this._containedObject[ZaMTA.A_CorruptQ][ZaMTA.A_Status]==ZaMTA.STATUS_IDLE)){
this._containedObject.getMailQStatus(ZaMTA.A_CorruptQ,null,0,null,true)
}};
ZaMTAXFormView._listObjects={};
ZaMTAXFormView.filterListSelectionListener=function(s){
if(s.dwtObj&&this.refPath){
ZaMTAXFormView._listObjects[this.refPath]=s.dwtObj
}
var t=this.getInstance();
var o=this.getRef().split("/");
var n=o[1];
var r=o[0];
if(!t[r][ZaMTA.A_selection_cache]){
t[r][ZaMTA.A_selection_cache]={}
}
var e=this.widget.getSelection();
if(e&&e.length){
this.getModel().setInstanceValue(t,r+"/"+ZaMTA.A_selection_cache+"/"+n,e)
}else{
this.getModel().setInstanceValue(t,r+"/"+ZaMTA.A_selection_cache+"/"+n,null);
t[r][ZaMTA.A_selection_cache][n]=null
}
t._viewInternalId=this.getForm().parent.__internalId;
t.getMailQStatus(r,t[r][ZaMTA.A_selection_cache])
};
ZaMTAXFormView.msgListSelectionListener=function(o){
if(o.dwtObj&&this.refPath){
ZaMTAXFormView._listObjects[this.refPath]=o.dwtObj
}
var e=this.getInstance();
var t=this.getRef().split("/");
var n=t[0];
if(!e[n][ZaMTA.MsgIDS]){
e[n][ZaMTA.MsgIDS]={}
}
this.getModel().setInstanceValue(e,n+"/"+ZaMTA.MsgIDS,AjxUtil.isEmpty(this.widget.getSelection())?{}
:this.widget.getSelection())
};
ZaMTAXFormView.searchQueue=function(t){
var e=this.getInstance();
var o=this.getRef();
e.getMailQStatus(o,e[o][ZaMTA.A_selection_cache])
};
ZaMTAXFormView.clearFilter=function(t){
this.setInstanceValue("",this.getRef()+"/"+ZaMTA.A_selection_cache);
this.setInstanceValue("",this.getRef()+"/"+ZaMTA.A_query);
for(var e in ZaMTAXFormView._listObjects){
if(ZaMTAXFormView._listObjects[e]){
ZaMTAXFormView._listObjects[e].deselectAll()
}}};
ZaMTAXFormView.showAllMsgs=function(e){
ZaMTAXFormView.clearFilter.call(this,e);
ZaMTAXFormView.searchQueue.call(this,e)
};
ZaMTAXFormView.actionButtonListener=function(s){
var n,h,o,e;
n=this.getRef();
form=this.getForm();
e=this.getInstance();
var r=new Object();
r[ZaMTAActionDialog.QNAME]=n;
switch(s){
case ZaMTA.ActionRequeue:o=ZaMsg.PQ_REQ_DLG_TITLE;
r[ZaMTAActionDialog.MESSAGE]=ZaMsg.PQ_SELECT_WHAT_TO_REQ;
r[ZaMTAActionDialog.QUESTION]=ZaMsg.PQ_Q_REQUEUE_MESSAGES;
break;
case ZaMTA.ActionDelete:o=ZaMsg.PQ_DEL_DLG_TITLE;
r[ZaMTAActionDialog.MESSAGE]=ZaMsg.PQ_SELECT_WHAT_TO_DEL;
r[ZaMTAActionDialog.QUESTION]=ZaMsg.PQ_Q_DELETE_MESSAGES;
break;
case ZaMTA.ActionHold:o=ZaMsg.PQ_HOLD_DLG_TITLE;
r[ZaMTAActionDialog.MESSAGE]=ZaMsg.PQ_SELECT_WHAT_TO_HOLD;
r[ZaMTAActionDialog.QUESTION]=ZaMsg.PQ_Q_HOLD_MESSAGES;
break;
case ZaMTA.ActionRelease:o=ZaMsg.PQ_REL_DLG_TITLE;
r[ZaMTAActionDialog.MESSAGE]=ZaMsg.PQ_SELECT_WHAT_TO_REL;
r[ZaMTAActionDialog.QUESTION]=ZaMsg.PQ_Q_RELEASE_MESSAGES;
break
}
var t=form.parent;
t.selectActionDialog=ZaApp.getInstance().dialogs.selectActionDialog=new ZaMTAActionDialog(ZaApp.getInstance().getAppCtxt().getShell(),o,e);
r[ZaMTAActionDialog.MSG_IDS]=e[n][ZaMTA.MsgIDS];
r[ZaMTAActionDialog.FLTR_ITEMS]=e[n][ZaMTA.A_selection_cache];
r[ZaMTAActionDialog.ANSWER]=ZaMTAActionDialog.SELECTED_MSGS;
r[ZaMTAActionDialog.ACTION]=s;
t.selectActionDialog.setObject(r);
t.selectActionDialog.registerCallback(DwtDialog.OK_BUTTON,t.actionDlgCallback,t,s);
t.selectActionDialog.popup()
};
ZaMTAXFormView.prototype.actionDlgCallback=function(e){
if(this.selectActionDialog){
var n=this.selectActionDialog.getObject();
var s;
if(n[ZaMTAActionDialog.ANSWER]==ZaMTAActionDialog.SELECTED_MSGS){
s=n[ZaMTAActionDialog.MSG_IDS];
if(s&&s.length){
this.showConfirmationDlg(n[ZaMTAActionDialog.ACTION],s,n[ZaMTAActionDialog.QNAME],ZaMTA.A_messages)
}else{
this.selectActionDialog.popdown()
}}else{
if(n[ZaMTAActionDialog.ANSWER]==ZaMTAActionDialog.FLTRED_SET){
s={};
var o;
if(n[ZaMTAActionDialog.FLTR_ITEMS]){
for(var t in n[ZaMTAActionDialog.FLTR_ITEMS]){
if(n[ZaMTAActionDialog.FLTR_ITEMS][t]){
o=t;
s[t]=n[ZaMTAActionDialog.FLTR_ITEMS][t]
}}}
if(o){
this.showConfirmationDlg(n[ZaMTAActionDialog.ACTION],s,n[ZaMTAActionDialog.QNAME],o)
}else{
s=[];
s[0]={};
s[0][ZaMTAQMsgItem.A_id]=ZaMTA.ID_ALL;
this.showConfirmationDlg(n[ZaMTAActionDialog.ACTION],s,n[ZaMTAActionDialog.QNAME],ZaMTA.A_messages)
}}}}};
ZaMTAXFormView.prototype.showConfirmationDlg=function(o,t,r,l){
this.confirmMessageDialog=ZaApp.getInstance().dialogs.ConfirmMessageDialog=new ZaMsgDialog(ZaApp.getInstance().getAppCtxt().getShell(),null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.VIEW_MTA+"_confirmMessage");
if(t){
if(l==ZaMTA.A_messages){
var h="0";
if(t.length){
if(t[0][ZaMTAQMsgItem.A_id]==ZaMTA.ID_ALL){
h=ZaMsg.PQ_AllMessages
}else{
h=String(t.length)
}}
switch(o){
case ZaMTA.ActionRequeue:dlgMsg=String(ZaMsg.PQ_Q_REQUEUE_MESSAGES).replace("{0}",h).replace("{1}",r);
break;
case ZaMTA.ActionDelete:dlgMsg=String(ZaMsg.PQ_Q_DELETE_MESSAGES).replace("{0}",h).replace("{1}",r);
break;
case ZaMTA.ActionHold:dlgMsg=String(ZaMsg.PQ_Q_HOLD_MESSAGES).replace("{0}",h).replace("{1}",r);
break;
case ZaMTA.ActionRelease:dlgMsg=String(ZaMsg.PQ_Q_RELEASE_MESSAGES).replace("{0}",h).replace("{1}",r);
break
}}else{
switch(o){
case ZaMTA.ActionRequeue:dlgMsg=ZaMsg.PQ_Q_REQUEUE_MESSAGES2;
break;
case ZaMTA.ActionDelete:dlgMsg=ZaMsg.PQ_Q_DELETE_MESSAGES2;
break;
case ZaMTA.ActionHold:dlgMsg=ZaMsg.PQ_Q_HOLD_MESSAGES2;
break;
case ZaMTA.ActionRelease:dlgMsg=ZaMsg.PQ_Q_RELEASE_MESSAGES2;
break
}
dlgMsg+="<br><ul>";
var s=0;
for(var c in t){
if(t[c]){
var e=t[c].length;
dlgMsg+="<li>";
dlgMsg+=c;
dlgMsg+="<ul>";
for(var n=0;
n<e;
n++){
if(s>19){
dlgMsg+="<li>...</li>";
break
}
dlgMsg+="<li>";
dlgMsg+=t[c][n][ZaMTAQSummaryItem.A_text];
dlgMsg+=(" ("+t[c][n][ZaMTAQSummaryItem.A_count]+" "+ZaMsg.messages+")");
dlgMsg+="</li>";
s++
}
dlgMsg+="</ul></li>"
}}}
dlgMsg+="</ul>";
if(l==ZaMTA.A_messages){
this.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.actionMsgsByIDCallback,this,{
action:o,removelist:t,qName:r,field:l}
)
}else{
this.confirmMessageDialog.registerCallback(DwtDialog.YES_BUTTON,this.actionMsgsByQueryCallback,this,{
action:o,removelist:t,qName:r,field:l}
)
}}
if(dlgMsg){
this.confirmMessageDialog.setMessage(dlgMsg,DwtMessageDialog.INFO_STYLE)
}
this.confirmMessageDialog.registerCallback(DwtDialog.NO_BUTTON,this.doNotCallback,this);
this.confirmMessageDialog.popup()
};
ZaMTAXFormView.popupMenuListener=function(n){
var o,s,r;
if(this.xFormItem){
var t=this.xFormItem.getRef().split("/");
o=t[0];
if(t.length>1){
s=t[1]
}}
var e=this.xFormItem.getForm().parent;
if(s==ZaMTA.A_messages){
var r=new Array();
if(this.getSelectionCount()>0){
r=this.getSelection()
}}else{
var r={};
r[s]=new Array();
if(this.getSelectionCount()>0){
r[s]=this.getSelection()
}}
e.showConfirmationDlg(n,r,o,s)
};
ZaMTAXFormView.prototype.actionMsgsByIDCallback=function(o){
var e=[],r,s,t;
r=o.action;
t=o.removelist;
s=o.qName;
for(var n in t){
e.push(t[n][ZaMTAQMsgItem.A_id])
}
if(e.length>0){
this._containedObject.mailQueueAction(s,r,"id",e.join(","))
}
this.confirmMessageDialog.popdown();
if(this.selectActionDialog){
this.selectActionDialog.popdown()
}};
ZaMTAXFormView.prototype.actionMsgsByQueryCallback=function(o){
var e=[],s,t,n,r;
s=o.action;
t=o.removelist;
n=o.qName;
r=o.field;
this._containedObject.mailQueueAction(n,s,"query",t);
this.confirmMessageDialog.popdown();
if(this.selectActionDialog){
this.selectActionDialog.popdown()
}};
ZaMTAXFormView.prototype.doNotCallback=function(){
if(this.confirmMessageDialog){
this.confirmMessageDialog.popdown()
}};
ZaMTAXFormView.backMsgsButtonHndlr=function(o){
var e=this.getInstance();
var n=this.getRef();
var t=this.getInstanceValue(this.getRef()+"/"+ZaMTA.A_pageNum);
if(t){
t--
}else{
t=0
}
e.getMailQStatus(n,e[n][ZaMTA.A_selection_cache],t*ZaMTA.RESULTSPERPAGE)
};
ZaMTAXFormView.fwdMsgsButtonHndlr=function(o){
var e=this.getInstance();
var n=this.getRef();
var t=this.getInstanceValue(this.getRef()+"/"+ZaMTA.A_pageNum);
if(t){
t++
}else{
t=1
}
e.getMailQStatus(n,e[n][ZaMTA.A_selection_cache],t*ZaMTA.RESULTSPERPAGE)
};
ZaMTAXFormView.listActionListener=function(e){
this.actionMenu.popup(0,e.docX,e.docY)
};
ZaMTAXFormView.isParsingProgressBarVisible=function(t){
var e=this.getInstance();
return(e[t][ZaMTA.A_Status]==ZaMTA.STATUS_SCANNING||e[t][ZaMTA.A_Status]==ZaMTA.STATUS_SCAN_COMPLETE)
};
ZaMTAXFormView.refreshListener=function(o){
var e=this.getRef().split("/");
var t=e[1];
var n=e[0];
ZaMTAXFormView.clearFilter.call(this,o);
this.getInstance().getMailQStatus(n,null,null,null,true);
this.getInstance().load();
ZaMTAXFormView.tabChoices.setChoices([{
value:ZaMTAXFormView._tab1,label:ZaMsg.PQV_Tab_Deferred+" ("+this.getInstance()[ZaMTA.A_DeferredQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab2,label:ZaMsg.PQV_Tab_IncomingQ+" ("+this.getInstance()[ZaMTA.A_IncomingQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab3,label:ZaMsg.PQV_Tab_ActiveQ+" ("+this.getInstance()[ZaMTA.A_ActiveQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab4,label:ZaMsg.PQV_Tab_HoldQ+" ("+this.getInstance()[ZaMTA.A_HoldQ][ZaMTA.A_count]+")"}
,{
value:ZaMTAXFormView._tab5,label:ZaMsg.PQV_Tab_CorruptQ+" ("+this.getInstance()[ZaMTA.A_CorruptQ][ZaMTA.A_count]+")"}
]),ZaMTAXFormView.tabChoices.dirtyChoices()
};
ZaMTAXFormView.createPopupMenu=function(o){
popupOperations=[new ZaOperation(ZaOperation.DELETE,ZaMsg.TBB_Delete,ZaMsg.PQ_Delete_tt,null,null,new AjxListener(o,ZaMTAXFormView.popupMenuListener,ZaMTA.ActionDelete)),new ZaOperation(ZaOperation.REQUEUE,ZaMsg.TBB_Requeue,ZaMsg.PQ_Requeue_tt,null,null,new AjxListener(o,ZaMTAXFormView.popupMenuListener,ZaMTA.ActionRequeue))];
var e=this.getRef().split("/");
var t=e[0];
if(t==ZaMTA.A_HoldQ){
popupOperations.push(new ZaOperation(ZaOperation.RELEASE,ZaMsg.TBB_Release,ZaMsg.PQ_Release_tt,null,null,new AjxListener(o,ZaMTAXFormView.popupMenuListener,ZaMTA.ActionRelease)))
}else{
popupOperations.push(new ZaOperation(ZaOperation.HOLD,ZaMsg.TBB_Hold,ZaMsg.PQ_Hold_tt,null,null,new AjxListener(o,ZaMTAXFormView.popupMenuListener,ZaMTA.ActionHold)))
}
o.actionMenu=new ZaPopupMenu(o,"ActionMenu",null,popupOperations,ZaId.VIEW_MTA,ZaId.MENU_POP);
o.addActionListener(new AjxListener(o,ZaMTAXFormView.listActionListener));
o.xFormItem=this
};
ZaMTAXFormView.shouldEnableMsgsForwardButton=function(e){
return(this.getInstanceValue(e+"/"+ZaMTA.A_more))
};
ZaMTAXFormView.shouldEnableMsgsBackButton=function(e){
var t=this.getInstanceValue(e+"/"+ZaMTA.A_pageNum);
return(t&&(t>0))
};
ZaMTAXFormView.myXFormModifier=function(o){
o.tableCssStyle="width:100%;position:static;overflow:auto;";
var e=new Array();
e[0]=new ZaListHeaderItem(ZaMTAQSummaryItem.A_text_col,ZaMsg.PQV_name_col,null,"auto",false,null,true,true);
e[1]=new ZaListHeaderItem(ZaMTAQSummaryItem.A_count_col,ZaMsg.PQV_count_col,null,"38px",false,null,true,true);
var t=new Array();
t[0]=new ZaListHeaderItem(ZaMTAQMsgItem.A_id,ZaMsg.PQV_qid_col,null,"100px",null,null,true,true);
if(ZaZimbraAdmin.LOCALE=="en"||ZaZimbraAdmin.LOCALE=="en_AU"||ZaZimbraAdmin.LOCALE=="en_GB"){
t[1]=new ZaListHeaderItem(ZaMTAQMsgItem.A_recipients,ZaMsg.PQV_recipients_col,null,"136px",null,null,true,true);
t[2]=new ZaListHeaderItem(ZaMTAQMsgItem.A_sender,ZaMsg.PQV_sender_col,null,"136px",null,null,true,true)
}else{
t[1]=new ZaListHeaderItem(ZaMTAQMsgItem.A_recipients,ZaMsg.PQV_recipients_col,null,"106px",null,null,true,true);
t[2]=new ZaListHeaderItem(ZaMTAQMsgItem.A_sender,ZaMsg.PQV_sender_col,null,"106px",null,null,true,true)
}
t[3]=new ZaListHeaderItem(ZaMTAQMsgItem.A_origin_ip,ZaMsg.PQV_origin_ip_col,null,"97px",null,null,true,true);
t[4]=new ZaListHeaderItem(ZaMTAQMsgItem.A_origin_host,ZaMsg.PQV_origin_host_col,null,"103px",null,null,true,true);
t[5]=new ZaListHeaderItem(ZaMTAQMsgItem.A_fromdomain,ZaMsg.PQV_origin_domain_col,null,"106px",null,null,true,true);
t[6]=new ZaListHeaderItem(ZaMTAQMsgItem.A_content_filter,ZaMsg.PQV_content_filter_col,"103px",null,null,null,true,true);
t[7]=new ZaListHeaderItem(ZaMTAQMsgItem.A_time,ZaMsg.PQV_time_col,null,"78px",null,null,true,true);
t[8]=new ZaListHeaderItem(null,null,null,"auto",null,null,true,true);
o.items=[{
type:_GROUP_,cssClass:"ZmSelectedHeaderBg",colSpan:"*",id:"xform_header",items:[{
type:_GROUP_,numCols:2,colSizes:["32px","auto"],items:[{
type:_AJX_IMAGE_,src:"Queue_32",label:null}
,{
type:_OUTPUT_,ref:ZaMTA.A_name,label:null,cssClass:"AdminTitle",visibilityChecks:[ZaItem.hasReadPermission],height:32}
]}
]}
,{
type:_TAB_BAR_,ref:ZaModel.currentTab,containerCssStyle:"background-color:#DDD;padding-top:5px;",choices:ZaMTAXFormView.tabChoices,cssClass:"ZaTabBar",id:"xform_tabbar"}
,{
type:_SWITCH_,items:[{
type:_ZATABCASE_,numCols:1,width:"100%",caseKey:ZaMTAXFormView._tab1,items:[{
type:_SPACER_,height:"15"}
,{
type:_GROUP_,numCols:8,colSizes:["10%","10%","10%","15%","17%","25%","auto","10%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",width:"95%",items:[{
type:_OUTPUT_,label:ZaMsg.TBB_LastUpdated,ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_refreshTime}
,{
type:_OUTPUT_,label:ZaMsg.PQ_AnalyzerStatus,ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_Status,choices:ZaMTAXFormView.SCANNER_STATUS_CHOICES}
,{
type:_DWT_PROGRESS_BAR_,label:ZaMsg.PQ_ParsingProgress,maxValue:null,maxValueRef:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_count,ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_totalComplete,visibilityChecks:[[ZaMTAXFormView.isParsingProgressBarVisible,ZaMTA.A_DeferredQ]],visibilityChangeEventSources:[ZaMTA.A_DeferredQ+"/"+ZaMTA.A_Status],align:_CENTER_,wholeCssClass:"mtaprogressbar",progressCssClass:"progressused"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_DeferredQ,label:ZaMsg.PQ_AnalyzeQueue,onActivate:ZaMTAXFormView.refreshListener}
]}
,{
type:_SPACER_,height:"1"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:6,width:"100%",colSizes:["18%","15%","17%","17%","17%","15%"],label:ZaMsg.PQV_Summary,items:[{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupRDomain,items:[{
ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_rdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupOriginIP,items:[{
ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_origip,type:_DWT_LIST_,height:"150",width:"96%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderDomain,items:[{
ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_sdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupReceiverAddress,items:[{
ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_raddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderAddress,items:[{
ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_saddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupError,items:[{
ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_error,type:_DWT_LIST_,height:"150",width:"96%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
]}
,{
type:_SPACER_,height:"15"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_Messages,items:[{
type:_GROUP_,numCols:9,colSizes:["16%","2%","16%","2%","16%","2%","16%","2%","28%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",items:[{
type:_DWT_BUTTON_,ref:ZaMTA.A_DeferredQ,label:ZaMsg.TBB_RequeueAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionRequeue);",toolTipContent:ZaMsg.PQ_Requeue_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_DeferredQ,label:ZaMsg.TBB_HoldAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionHold);",toolTipContent:ZaMsg.PQ_Hold_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_DeferredQ,label:ZaMsg.PQ_DeleteAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionDelete);",toolTipContent:ZaMsg.PQ_Delete_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.PQ_showAllMsgs,ref:ZaMTA.A_DeferredQ,onActivate:ZaMTAXFormView.showAllMsgs}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,numCols:3,items:[{
type:_DWT_BUTTON_,label:ZaMsg.Previous,toolTipContent:ZaMsg.PrevPage_tt,width:86,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",ref:ZaMTA.A_DeferredQ,onActivate:"ZaMTAXFormView.backMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_DeferredQ+"/"+ZaMTA.A_pageNum],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsBackButton,ZaMTA.A_DeferredQ]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,toolTipContent:ZaMsg.NextPage_tt,width:86,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",ref:ZaMTA.A_DeferredQ,labelLocation:(DwtLabel.IMAGE_RIGHT|DwtLabel.ALIGN_CENTER),enableDisableChangeEventSources:[ZaMTA.A_DeferredQ+"/"+ZaMTA.A_more],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsForwardButton,ZaMTA.A_DeferredQ]],onActivate:"ZaMTAXFormView.fwdMsgsButtonHndlr.call(this,event)"}
]}
]}
,{
ref:ZaMTA.A_DeferredQ+"/"+ZaMTA.A_messages,onSelection:ZaMTAXFormView.msgListSelectionListener,type:_DWT_LIST_,height:"200",width:"99%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,multiselect:true,widgetClass:ZaQMessagesListView,headerList:t}
]}
]}
,{
type:_ZATABCASE_,numCols:1,width:"100%",caseKey:ZaMTAXFormView._tab2,items:[{
type:_SPACER_,height:"15"}
,{
type:_GROUP_,numCols:8,colSizes:["10%","10%","10%","15%","15%","25%","auto","10%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",width:"95%",items:[{
type:_OUTPUT_,label:ZaMsg.TBB_LastUpdated,ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_refreshTime}
,{
type:_OUTPUT_,label:ZaMsg.PQ_AnalyzerStatus,ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_Status,choices:ZaMTAXFormView.SCANNER_STATUS_CHOICES}
,{
type:_DWT_PROGRESS_BAR_,label:ZaMsg.PQ_ParsingProgress,maxValue:null,maxValueRef:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_count,ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_totalComplete,visibilityChecks:[[ZaMTAXFormView.isParsingProgressBarVisible,ZaMTA.A_IncomingQ]],visibilityChangeEventSources:[ZaMTA.A_IncomingQ+"/"+ZaMTA.A_Status],align:_CENTER_,wholeCssClass:"mtaprogressbar",progressCssClass:"progressused"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_IncomingQ,label:ZaMsg.PQ_AnalyzeQueue,onActivate:ZaMTAXFormView.refreshListener}
]}
,{
type:_SPACER_,height:"1"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:5,width:"100%",label:ZaMsg.PQV_Summary,colSizes:["20%","20%","20%","20%","20%"],items:[{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupRDomain,items:[{
ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_rdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupOriginIP,items:[{
ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_origip,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderDomain,items:[{
ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_sdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupReceiverAddress,items:[{
ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_raddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderAddress,items:[{
ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_saddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
]}
,{
type:_SPACER_,height:"15"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_Messages,items:[{
type:_GROUP_,numCols:9,colSizes:["16%","3%","16%","3%","16%","3%","16%","3%","24%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",items:[{
type:_DWT_BUTTON_,ref:ZaMTA.A_IncomingQ,label:ZaMsg.TBB_RequeueAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionRequeue)",toolTipContent:ZaMsg.PQ_Requeue_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_IncomingQ,label:ZaMsg.TBB_HoldAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionHold)",toolTipContent:ZaMsg.PQ_Hold_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_IncomingQ,label:ZaMsg.PQ_DeleteAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionDelete)",toolTipContent:ZaMsg.PQ_Delete_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.PQ_showAllMsgs,ref:ZaMTA.A_IncomingQ,onActivate:ZaMTAXFormView.showAllMsgs}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,numCols:3,items:[{
type:_DWT_BUTTON_,label:ZaMsg.Previous,toolTipContent:ZaMsg.PrevPage_tt,width:86,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",ref:ZaMTA.A_IncomingQ,onActivate:"ZaMTAXFormView.backMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_IncomingQ+"/"+ZaMTA.A_pageNum],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsBackButton,ZaMTA.A_IncomingQ]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,toolTipContent:ZaMsg.NextPage_tt,width:86,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",ref:ZaMTA.A_IncomingQ,labelLocation:(DwtLabel.IMAGE_RIGHT|DwtLabel.ALIGN_CENTER),onActivate:"ZaMTAXFormView.fwdMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_IncomingQ+"/"+ZaMTA.A_more],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsForwardButton,ZaMTA.A_IncomingQ]]}
]}
]}
,{
ref:ZaMTA.A_IncomingQ+"/"+ZaMTA.A_messages,onSelection:ZaMTAXFormView.msgListSelectionListener,type:_DWT_LIST_,height:"200",width:"99%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,multiselect:true,widgetClass:ZaQMessagesListView,headerList:t}
]}
]}
,{
type:_ZATABCASE_,numCols:1,cssClass:(AjxEnv.isIE?"IEcontainer":"XFormCase"),width:"100%",caseKey:ZaMTAXFormView._tab3,items:[{
type:_SPACER_,height:"15"}
,{
type:_GROUP_,numCols:8,colSizes:["10%","10%","10%","15%","15%","25%","auto","10%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",items:[{
type:_OUTPUT_,label:ZaMsg.TBB_LastUpdated,ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_refreshTime}
,{
type:_OUTPUT_,label:ZaMsg.PQ_AnalyzerStatus,ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_Status,choices:ZaMTAXFormView.SCANNER_STATUS_CHOICES}
,{
type:_DWT_PROGRESS_BAR_,label:ZaMsg.PQ_ParsingProgress,maxValue:null,maxValueRef:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_count,ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_totalComplete,visibilityChecks:[[ZaMTAXFormView.isParsingProgressBarVisible,ZaMTA.A_ActiveQ]],visibilityChangeEventSources:[ZaMTA.A_ActiveQ+"/"+ZaMTA.A_Status],align:_CENTER_,wholeCssClass:"mtaprogressbar",progressCssClass:"progressused"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_ActiveQ,label:ZaMsg.PQ_AnalyzeQueue,onActivate:ZaMTAXFormView.refreshListener}
]}
,{
type:_SPACER_,height:"1"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:5,width:"100%",label:ZaMsg.PQV_Summary,colSizes:["20%","20%","20%","20%","20%"],items:[{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupRDomain,items:[{
ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_rdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupOriginIP,items:[{
ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_origip,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderDomain,items:[{
ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_sdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupReceiverAddress,items:[{
ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_raddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderAddress,items:[{
ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_saddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
]}
,{
type:_SPACER_,height:"15"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_Messages,items:[{
type:_GROUP_,numCols:9,colSizes:["16%","3%","16%","3%","16%","3%","16%","3%","24%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",items:[{
type:_DWT_BUTTON_,ref:ZaMTA.A_ActiveQ,label:ZaMsg.TBB_RequeueAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionRequeue)",toolTipContent:ZaMsg.PQ_Requeue_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_ActiveQ,label:ZaMsg.TBB_HoldAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionHold)",toolTipContent:ZaMsg.PQ_Hold_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_ActiveQ,label:ZaMsg.PQ_DeleteAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionDelete)",toolTipContent:ZaMsg.PQ_Delete_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.PQ_showAllMsgs,ref:ZaMTA.A_ActiveQ,onActivate:ZaMTAXFormView.showAllMsgs}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,numCols:3,items:[{
type:_DWT_BUTTON_,label:ZaMsg.Previous,toolTipContent:ZaMsg.PrevPage_tt,width:86,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",ref:ZaMTA.A_ActiveQ,onActivate:"ZaMTAXFormView.backMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_ActiveQ+"/"+ZaMTA.A_pageNum],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsBackButton,ZaMTA.A_ActiveQ]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,toolTipContent:ZaMsg.NextPage_tt,width:86,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",ref:ZaMTA.A_ActiveQ,labelLocation:(DwtLabel.IMAGE_RIGHT|DwtLabel.ALIGN_CENTER),onActivate:"ZaMTAXFormView.fwdMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_ActiveQ+"/"+ZaMTA.A_more],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsForwardButton,ZaMTA.A_ActiveQ]]}
]}
]}
,{
ref:ZaMTA.A_ActiveQ+"/"+ZaMTA.A_messages,onSelection:ZaMTAXFormView.msgListSelectionListener,type:_DWT_LIST_,height:"200",width:"99%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,multiselect:true,widgetClass:ZaQMessagesListView,headerList:t}
]}
]}
,{
type:_ZATABCASE_,numCols:1,cssClass:(AjxEnv.isIE?"IEcontainer":"XFormCase"),width:"100%",caseKey:ZaMTAXFormView._tab4,items:[{
type:_SPACER_,height:"15"}
,{
type:_GROUP_,numCols:8,colSizes:["10%","10%","10%","15%","15%","25%","auto","10%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",width:"95%",items:[{
type:_OUTPUT_,label:ZaMsg.TBB_LastUpdated,ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_refreshTime}
,{
type:_OUTPUT_,label:ZaMsg.PQ_AnalyzerStatus,ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_Status,choices:ZaMTAXFormView.SCANNER_STATUS_CHOICES}
,{
type:_DWT_PROGRESS_BAR_,label:ZaMsg.PQ_ParsingProgress,maxValue:null,maxValueRef:ZaMTA.A_HoldQ+"/"+ZaMTA.A_count,ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_totalComplete,visibilityChecks:[[ZaMTAXFormView.isParsingProgressBarVisible,ZaMTA.A_HoldQ]],visibilityChangeEventSources:[ZaMTA.A_HoldQ+"/"+ZaMTA.A_Status],align:_CENTER_,wholeCssClass:"mtaprogressbar",progressCssClass:"progressused"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_HoldQ,label:ZaMsg.PQ_AnalyzeQueue,onActivate:ZaMTAXFormView.refreshListener}
]}
,{
type:_SPACER_,height:"1"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:5,width:"100%",label:ZaMsg.PQV_Summary,colSizes:["20%","20%","20%","20%","20%"],items:[{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupRDomain,items:[{
ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_rdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupOriginIP,items:[{
ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_origip,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderDomain,items:[{
ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_sdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupReceiverAddress,items:[{
ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_raddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderAddress,items:[{
ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_saddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
]}
,{
type:_SPACER_,height:"15"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_Messages,items:[{
type:_GROUP_,numCols:9,colSizes:["16%","3%","16%","3%","16%","3%","16%","3%","24%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",items:[{
type:_DWT_BUTTON_,ref:ZaMTA.A_HoldQ,label:ZaMsg.TBB_RequeueAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionRequeue)",toolTipContent:ZaMsg.PQ_Requeue_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_HoldQ,label:ZaMsg.TBB_ReleaseAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionRelease)",toolTipContent:ZaMsg.PQ_Release_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_HoldQ,label:ZaMsg.PQ_DeleteAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionDelete)",toolTipContent:ZaMsg.PQ_Delete_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.PQ_showAllMsgs,ref:ZaMTA.A_HoldQ,onActivate:ZaMTAXFormView.showAllMsgs}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,numCols:3,items:[{
type:_DWT_BUTTON_,label:ZaMsg.Previous,toolTipContent:ZaMsg.PrevPage_tt,width:86,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",ref:ZaMTA.A_HoldQ,onActivate:"ZaMTAXFormView.backMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_HoldQ+"/"+ZaMTA.A_pageNum],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsBackButton,ZaMTA.A_HoldQ]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,toolTipContent:ZaMsg.NextPage_tt,width:86,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",ref:ZaMTA.A_HoldQ,labelLocation:(DwtLabel.IMAGE_RIGHT|DwtLabel.ALIGN_CENTER),onActivate:"ZaMTAXFormView.fwdMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_HoldQ+"/"+ZaMTA.A_more],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsForwardButton,ZaMTA.A_HoldQ]]}
]}
]}
,{
ref:ZaMTA.A_HoldQ+"/"+ZaMTA.A_messages,onSelection:ZaMTAXFormView.msgListSelectionListener,type:_DWT_LIST_,height:"200",width:"99%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,multiselect:true,widgetClass:ZaQMessagesListView,headerList:t}
]}
]}
,{
type:_ZATABCASE_,numCols:1,cssClass:(AjxEnv.isIE?"IEcontainer":"XFormCase"),width:"100%",caseKey:ZaMTAXFormView._tab5,items:[{
type:_SPACER_,height:"15"}
,{
type:_GROUP_,numCols:8,colSizes:["10%","10%","10%","15%","15%","25%","auto","10%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",items:[{
type:_OUTPUT_,label:ZaMsg.TBB_LastUpdated,ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_refreshTime}
,{
type:_OUTPUT_,label:ZaMsg.PQ_AnalyzerStatus,ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_Status,choices:ZaMTAXFormView.SCANNER_STATUS_CHOICES}
,{
type:_DWT_PROGRESS_BAR_,label:ZaMsg.PQ_ParsingProgress,maxValue:null,maxValueRef:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_count,ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_totalComplete,visibilityChecks:[[ZaMTAXFormView.isParsingProgressBarVisible,ZaMTA.A_CorruptQ]],visibilityChangeEventSources:[ZaMTA.A_CorruptQ+"/"+ZaMTA.A_Status],align:_CENTER_,wholeCssClass:"mtaprogressbar",progressCssClass:"progressused"}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_CorruptQ,label:ZaMsg.PQ_AnalyzeQueue,onActivate:ZaMTAXFormView.refreshListener}
]}
,{
type:_SPACER_,height:"1"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:5,width:"100%",label:ZaMsg.PQV_Summary,colSizes:["20%","20%","20%","20%","20%"],items:[{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupRDomain,items:[{
ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_rdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupOriginIP,items:[{
ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_origip,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderDomain,items:[{
ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_sdomain,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupReceiverAddress,items:[{
ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_raddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
,{
type:_ZASMALL_CENTER_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_GroupSenderAddress,items:[{
ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_saddress,type:_DWT_LIST_,height:"150",width:"97%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,preserveSelection:true,multiselect:true,bmolsnr:true,onSelection:ZaMTAXFormView.filterListSelectionListener,widgetClass:ZaQSummaryListView,headerList:e}
]}
]}
,{
type:_SPACER_,height:"15"}
,{
type:_ZAALLSCREEN_GROUPER_,numCols:1,width:"100%",label:ZaMsg.PQV_Messages,items:[{
type:_GROUP_,numCols:9,colSizes:["16%","3%","16%","3%","16%","3%","16%","3%","24%"],tableCssClass:"search_field_tableCssClass",cssClass:"qsearch_field_bar",items:[{
type:_DWT_BUTTON_,ref:ZaMTA.A_CorruptQ,label:ZaMsg.TBB_RequeueAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionRequeue)",toolTipContent:ZaMsg.PQ_Requeue_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_CorruptQ,label:ZaMsg.TBB_HoldAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionHold)",toolTipContent:ZaMsg.PQ_Hold_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,ref:ZaMTA.A_CorruptQ,label:ZaMsg.PQ_DeleteAll,onActivate:"ZaMTAXFormView.actionButtonListener.call(this,ZaMTA.ActionDelete)",toolTipContent:ZaMsg.PQ_Delete_tt}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.PQ_showAllMsgs,ref:ZaMTA.A_CorruptQ,onActivate:ZaMTAXFormView.showAllMsgs}
,{
type:_CELLSPACER_}
,{
type:_GROUP_,numCols:3,items:[{
type:_DWT_BUTTON_,label:ZaMsg.Previous,toolTipContent:ZaMsg.PrevPage_tt,width:86,id:"backButton",icon:"LeftArrow",disIcon:"LeftArrowDis",ref:ZaMTA.A_CorruptQ,onActivate:"ZaMTAXFormView.backMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_CorruptQ+"/"+ZaMTA.A_pageNum],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsBackButton,ZaMTA.A_CorruptQ]]}
,{
type:_CELLSPACER_}
,{
type:_DWT_BUTTON_,label:ZaMsg.Next,toolTipContent:ZaMsg.NextPage_tt,width:86,id:"fwdButton",icon:"RightArrow",disIcon:"RightArrowDis",ref:ZaMTA.A_CorruptQ,labelLocation:(DwtLabel.IMAGE_RIGHT|DwtLabel.ALIGN_CENTER),onActivate:"ZaMTAXFormView.fwdMsgsButtonHndlr.call(this,event)",enableDisableChangeEventSources:[ZaMTA.A_CorruptQ+"/"+ZaMTA.A_more],enableDisableChecks:[[ZaMTAXFormView.shouldEnableMsgsForwardButton,ZaMTA.A_CorruptQ]]}
]}
]}
,{
ref:ZaMTA.A_CorruptQ+"/"+ZaMTA.A_messages,onSelection:ZaMTAXFormView.msgListSelectionListener,type:_DWT_LIST_,height:"200",width:"99%",cssClass:"DLSource",forceUpdate:false,createPopupMenu:ZaMTAXFormView.createPopupMenu,multiselect:true,widgetClass:ZaQMessagesListView,headerList:t}
]}
]}
]}
]
};
ZaTabView.XFormModifiers.ZaMTAXFormView.push(ZaMTAXFormView.myXFormModifier)
}
if(AjxPackage.define("zimbraAdmin.mta.view.ZaMTAActionDialog")){
ZaMTAActionDialog=function(n,s,e,t,o){
if(arguments.length==0){
return
}
this._standardButtons=[DwtDialog.CANCEL_BUTTON,DwtDialog.OK_BUTTON];
ZaXDialog.call(this,n,null,s,t,o);
this.initForm(ZaMTAActionDialog.myXModel,this.getMyXForm(e));
this._helpURL=ZaMTAActionDialog.helpURL
};
ZaMTAActionDialog.prototype=new ZaXDialog;
ZaMTAActionDialog.prototype.constructor=ZaMTAActionDialog;
ZaMTAActionDialog.helpURL=location.pathname+ZaUtil.HELP_URL+"monitoring/monitoring_zimbra_mta_mail_queues.htm?locid="+AjxEnv.DEFAULT_LOCALE;
ZaMTAActionDialog.ACTION="action";
ZaMTAActionDialog.QNAME="qname";
ZaMTAActionDialog.MESSAGE="message";
ZaMTAActionDialog.ANSWER="answer";
ZaMTAActionDialog.MSG_IDS="messageids";
ZaMTAActionDialog.FLTR_ITEMS="filteritems";
ZaMTAActionDialog.SELECTED_MSGS="selectedmsgs";
ZaMTAActionDialog.FLTRED_SET="filteredset";
ZaMTAActionDialog.QUESTION="question";
ZaMTAActionDialog.ANSWER_CHOICES=[{
value:ZaMTAActionDialog.SELECTED_MSGS,label:ZaMsg.PQ_SELECTED_MSGS}
,{
value:ZaMTAActionDialog.FLTRED_SET,label:ZaMsg.PQ_FILTERED_SET}
];
ZaMTAActionDialog.myXModel={
items:[{
type:_STRING_,ref:ZaMTAActionDialog.QNAME,id:ZaMTAActionDialog.QNAME}
,{
type:_STRING_,ref:ZaMTAActionDialog.ACTION,id:ZaMTAActionDialog.ACTION}
,{
type:_STRING_,ref:ZaMTAActionDialog.MESSAGE,id:ZaMTAActionDialog.MESSAGE}
,{
type:_STRING_,ref:ZaMTAActionDialog.QUESTION,id:ZaMTAActionDialog.QUESTION}
,{
type:_ENUM_,ref:ZaMTAActionDialog.ANSWER,id:ZaMTAActionDialog.ANSWER,choices:ZaMTAActionDialog.ANSWER_CHOICES}
,{
type:_LIST_,id:ZaMTAActionDialog.MSG_IDS,ref:ZaMTAActionDialog.MSG_IDS,listItem:{
type:_OBJECT_,items:[{
id:ZaMTAQMsgItem.A_id,type:_STRING_}
,{
id:ZaMTAQSummaryItem.A_text,type:_STRING_}
]}}
,{
type:_LIST_,id:ZaMTAActionDialog.FLTR_ITEMS,ref:ZaMTAActionDialog.FLTR_ITEMS,listItem:{
type:_OBJECT_,items:[{
id:ZaMTAQSummaryItem.A_text,type:_STRING_}
,{
id:ZaMTAQSummaryItem.A_count,type:_NUMBER_}
]}}
]};
Q_MSGS_QUESTION_RADIO_XFormItem=function(){};
XFormItemFactory.createItemType("_Q_MSGS_QUESTION_RADIO_","q_msgs_question_radio",Q_MSGS_QUESTION_RADIO_XFormItem,Composite_XFormItem);
Q_MSGS_QUESTION_RADIO_XFormItem.prototype.numCols=2;
Q_MSGS_QUESTION_RADIO_XFormItem.prototype.nowrap=true;
Q_MSGS_QUESTION_RADIO_XFormItem.prototype.items=[{
type:_RADIO_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:ZaMTAActionDialog.ANSWER,labelLocation:_NONE_,label:null,trueValue:ZaMTAActionDialog.SELECTED_MSGS,falseValue:ZaMTAActionDialog.FLTRED_SET,updateElement:function(e){
this.getElement().checked=(e==ZaMTAActionDialog.SELECTED_MSGS)
}
,elementChanged:function(o,t,e){
this.getForm().itemChanged(this,ZaMTAActionDialog.SELECTED_MSGS,e)
}
,bmolsnr:true}
,{
type:_OUTPUT_,ref:ZaMTAActionDialog.MSG_IDS,getDisplayValue:function(t){
var o="",e="0";
if(t){
e=t.length
}
o=AjxMessageFormat.format(ZaMsg.PQ_SelectedMessages,[e]);
return o
}}
];
Q_MSGS_QUESTION_RADIO_XFormItem.prototype.setElementEnabled=function(e){
this.getElement().disabled=(e!=true)
};
Q_MSGS_QUESTION_RADIO_XFormItem.prototype.updateEnabledDisabled=function(){
var n=true;
if(n){
var e=this.getInheritedProperty("enableDisableChecks");
if(e&&e instanceof Array){
var o=e.length;
for(var t=0;
t<o;
t++){
if(e[t]!=null){
if(typeof e[t]==="function"){
n=e[t].call(this);
if(!n){
break
}}else{
if(e[t] instanceof Array){
var s=e[t].shift();
if(!s||!s.apply){
continue
}
n=s.apply(this,e[t]);
e[t].unshift(s);
if(!n){
break
}}}}}}else{
if(e==false){
n=false
}}}
if(n){
this.enableElement()
}else{
this.disableElement()
}};
Q_MSGS_QUESTION_RADIO_XFormItem.prototype.updateVisibility=function(){
var isVisible=true;
if(isVisible){
var myVisibilityChecks=this.getInheritedProperty("visibilityChecks");
if(myVisibilityChecks&&myVisibilityChecks instanceof Array){
var cnt=myVisibilityChecks.length;
for(var i=0;
i<cnt;
i++){
if(myVisibilityChecks[i]!=null){
if(typeof myVisibilityChecks[i]==="function"){
isVisible=myVisibilityChecks[i].call(this);
if(!isVisible){
break
}}else{
if(myVisibilityChecks[i] instanceof Array){
var func=myVisibilityChecks[i].shift();
isVisible=func.apply(this,myVisibilityChecks[i]);
myVisibilityChecks[i].unshift(func);
if(!isVisible){
break
}}else{
if(typeof myVisibilityChecks==="string"){
var instance=this.getInstance();
isVisible=eval(myVisibilityChecks[i]);
if(!isVisible){
break
}}}}}}}}
if(isVisible){
this.show()
}else{
this.hide()
}};
Q_FLTRD_QUESTION_RADIO_XFormItem=function(){};
XFormItemFactory.createItemType("_Q_FLTRD_QUESTION_RADIO_","q_fltrd_question_radio",Q_FLTRD_QUESTION_RADIO_XFormItem,Composite_XFormItem);
Q_FLTRD_QUESTION_RADIO_XFormItem.prototype.numCols=2;
Q_FLTRD_QUESTION_RADIO_XFormItem.prototype.nowrap=true;
Q_FLTRD_QUESTION_RADIO_XFormItem.prototype.items=[{
type:_RADIO_,width:"40px",containerCssStyle:"width:40px",forceUpdate:true,ref:ZaMTAActionDialog.ANSWER,labelLocation:_NONE_,label:null,trueValue:ZaMTAActionDialog.FLTRED_SET,falseValue:ZaMTAActionDialog.SELECTED_MSGS,updateElement:function(e){
this.getElement().checked=(e==ZaMTAActionDialog.FLTRED_SET)
}
,elementChanged:function(o,t,e){
this.getForm().itemChanged(this,ZaMTAActionDialog.FLTRED_SET,e)
}
,bmolsnr:true}
,{
type:_OUTPUT_,ref:ZaMTAActionDialog.FLTR_ITEMS,getDisplayValue:function(r){
var h="";
var e=[];
if(r){
for(var s in r){
if(r[s]){
var n=[];
var o=r[s].length;
for(var t=0;
t<o;
t++){
n.push(r[s][t][ZaMTAQSummaryItem.A_text])
}
e.push((s+": "+n.join(", ")))
}}}
if(e.length){
h=String(ZaMsg.PQ_FilteredSet).replace("{0}",e.join("; "))
}else{
h=String(ZaMsg.PQ_FilteredSet).replace("{0}",ZaMsg.PQ_AllMessages)
}
return h
}}
];
Q_FLTRD_QUESTION_RADIO_XFormItem.prototype.setElementEnabled=function(e){
this.getElement().disabled=(e!=true)
};
Q_FLTRD_QUESTION_RADIO_XFormItem.prototype.updateEnabledDisabled=function(){
var n=true;
if(n){
var e=this.getInheritedProperty("enableDisableChecks");
if(e&&e instanceof Array){
var o=e.length;
for(var t=0;
t<o;
t++){
if(e[t]!=null){
if(typeof e[t]==="function"){
n=e[t].call(this);
if(!n){
break
}}else{
if(e[t] instanceof Array){
var s=e[t].shift();
if(!s||!s.apply){
continue
}
n=s.apply(this,e[t]);
e[t].unshift(s);
if(!n){
break
}}}}}}else{
if(e==false){
n=false
}}}
if(n){
this.enableElement()
}else{
this.disableElement()
}};
Q_FLTRD_QUESTION_RADIO_XFormItem.prototype.updateVisibility=function(){
var isVisible=true;
if(isVisible){
var myVisibilityChecks=this.getInheritedProperty("visibilityChecks");
if(myVisibilityChecks&&myVisibilityChecks instanceof Array){
var cnt=myVisibilityChecks.length;
for(var i=0;
i<cnt;
i++){
if(myVisibilityChecks[i]!=null){
if(typeof myVisibilityChecks[i]==="function"){
isVisible=myVisibilityChecks[i].call(this);
if(!isVisible){
break
}}else{
if(myVisibilityChecks[i] instanceof Array){
var func=myVisibilityChecks[i].shift();
isVisible=func.apply(this,myVisibilityChecks[i]);
myVisibilityChecks[i].unshift(func);
if(!isVisible){
break
}}else{
if(typeof myVisibilityChecks==="string"){
var instance=this.getInstance();
isVisible=eval(myVisibilityChecks[i]);
if(!isVisible){
break
}}}}}}}}
if(isVisible){
this.show()
}else{
this.hide()
}};
ZaMTAActionDialog.prototype.getMyXForm=function(e){
var t={
numCols:1,align:_CENTER_,cssStyle:"text-align:center",items:[{
type:_OUTPUT_,ref:ZaMTAActionDialog.MESSAGE,label:null,colSpan:"*",align:_LEFT_,valign:_TOP_}
,{
type:_Q_MSGS_QUESTION_RADIO_,visibilityChecks:[[ZaItem.hasAnyRight,[ZaMTA.MANAGE_MAIL_QUEUE_RIGHT],e]],enableDisableChecks:[[ZaItem.hasAnyRight,[ZaMTA.MANAGE_MAIL_QUEUE_RIGHT],e]],align:_LEFT_}
,{
type:_Q_FLTRD_QUESTION_RADIO_,visibilityChecks:[[ZaItem.hasAnyRight,[ZaMTA.MANAGE_MAIL_QUEUE_RIGHT],e]],enableDisableChecks:[[ZaItem.hasAnyRight,[ZaMTA.MANAGE_MAIL_QUEUE_RIGHT],e]],align:_LEFT_}
]};
return t
}
}
if(AjxPackage.define("zimbraAdmin.accounts.view.ZaAccountMemberOfListView")){
ZaAccountMemberOfListView=function(n,o,t,e){
ZaListView.call(this,n,o,t,e)
};
ZaAccountMemberOfListView.prototype=new ZaListView;
ZaAccountMemberOfListView.prototype.constructor=ZaAccountMemberOfListView;
ZaAccountMemberOfListView.prototype.toString=function(){
return"ZaAccountMemberOfListView"
};
ZaAccountMemberOfListView.A_name="name";
ZaAccountMemberOfListView.A_via="via";
ZaAccountMemberOfListView.SEARCH_LIMIT=25;
ZaAccountMemberOfListView.modelItems=[{
id:ZaAccount.A2_directMemberList,type:_LIST_,ref:ZaAccount.A2_memberOf+"/"+ZaAccount.A2_directMemberList}
,{
id:ZaAccount.A2_indirectMemberList,type:_LIST_,ref:ZaAccount.A2_memberOf+"/"+ZaAccount.A2_indirectMemberList}
,{
id:ZaAccount.A2_nonMemberList,type:_LIST_,ref:ZaAccount.A2_memberOf+"/"+ZaAccount.A2_nonMemberList}
,{
id:ZaAccount.A2_nonMemberListSelected,type:_LIST_,ref:ZaAccount.A2_memberOf+"/"+ZaAccount.A2_nonMemberListSelected}
,{
id:ZaAccount.A2_directMemberListSelected,type:_LIST_,ref:ZaAccount.A2_memberOf+"/"+ZaAccount.A2_directMemberListSelected}
,{
id:ZaAccount.A2_indirectMemberListSelected,type:_LIST_,ref:ZaAccount.A2_memberOf+"/"+ZaAccount.A2_indirectMemberListSelected}
,{
id:ZaAccount.A2_directMemberList+"_offset",ref:ZaAccount.A2_directMemberList+"_offset",type:_NUMBER_,defaultValue:0}
,{
id:ZaAccount.A2_nonMemberList+"_offset",ref:ZaAccount.A2_nonMemberList+"_offset",type:_NUMBER_,defaultValue:0}
,{
id:ZaAccount.A2_directMemberList+"_more",ref:ZaAccount.A2_directMemberList+"_more",type:_NUMBER_,defaultValue:0}
,{
id:ZaAccount.A2_nonMemberList+"_more",ref:ZaAccount.A2_nonMemberList+"_more",type:_NUMBER_,defaultValue:0}
,{
id:ZaAccount.A2_showSameDomain,type:_ENUM_,choices:ZaModel.BOOLEAN_CHOICES,ref:ZaAccount.A2_memberOf+"/"+ZaAccount.A2_showSameDomain,defaultValue:"FALSE"}
,{
id:"query",type:_STRING_}
];
ZaAccount.myXModel.items=ZaAccount.myXModel.items.concat(ZaAccountMemberOfListView.modelItems);
ZaDistributionList.myXModel.items=ZaDistributionList.myXModel.items.concat(ZaAccountMemberOfListView.modelItems);
ZaAccountMemberOfListView.parseGetAccMembershipResponse=function(h){
var c=[];
var e=[];
var r=[];
if(h.dl&&(h.dl instanceof Array)){
var t=h.dl;
var o=h.dl.length;
for(var l=0,u=0,s=0;
s<o;
s++){
if(t[s].via&&(t[s].via.length>0)){
e[l]={
name:t[s].name,id:t[s].id,via:t[s].via};
l++
}else{
c[u]={
name:t[s].name,id:t[s].id};
var f=ZaItem.initAttrsFromJS(t[s]);
if(f.zimbraIsAdminGroup!=null){
c[u]["zimbraIsAdminGroup"]=f.zimbraIsAdminGroup
}
u++
}}}
return{
directMemberList:c,indirectMemberList:e,nonMemberList:r}
};
ZaAccountMemberOfListView.getAccountMemberShip=function(s,w){
var g=[];
var e=[];
var l=[];
try{
soapDoc=AjxSoapDoc.create("GetAccountMembershipRequest",ZaZimbraAdmin.URN,null);
var k=soapDoc.set("account",s);
k.setAttribute("by",w);
var u=new Object();
u.soapDoc=soapDoc;
u.noAuthToken=true;
var r={
controller:ZaApp.getInstance().getCurrentController()};
var c=ZaRequestMgr.invoke(u,r).Body.GetAccountMembershipResponse;
if(c.dl&&(c.dl instanceof Array)){
var t=c.dl;
var o=c.dl.length;
for(var f=0,b=0,h=0;
h<o;
h++){
if(t[h].via&&(t[h].via.length>0)){
e[f]={
name:t[h].name,id:t[h].id,via:t[h].via};
f++
}else{
g[b]={
name:t[h].name,id:t[h].id};
var v=ZaItem.initAttrsFromJS(t[h]);
if(v.zimbraIsAdminGroup!=null){
g[b]["zimbraIsAdminGroup"]=v.zimbraIsAdminGroup
}
b++
}}}}
catch(y){
ZaApp.getInstance().getCurrentController()._handleException(y,"ZaAccountMemberOfListView.getAccountMemberShip",null,false)
}
var p={
directMemberList:g,indirectMemberList:e,nonMemberList:l};
return p
};
ZaAccountMemberOfListView.getDlMemberShip=function(s,w){
var g=[];
var e=[];
var l=[];
try{
soapDoc=AjxSoapDoc.create("GetDistributionListMembershipRequest",ZaZimbraAdmin.URN,null);
var v=soapDoc.set("dl",s);
v.setAttribute("by",w);
var u=new Object();
u.soapDoc=soapDoc;
var r={
controller:ZaApp.getInstance().getCurrentController()};
var c=ZaRequestMgr.invoke(u,r).Body.GetDistributionListMembershipResponse;
if(c.dl&&(c.dl instanceof Array)){
var t=c.dl;
var o=c.dl.length;
for(var f=0,b=0,h=0;
h<o;
h++){
if(t[h].via&&(t[h].via.length>0)){
e[f]={
name:t[h].name,id:t[h].id,via:t[h].via};
f++
}else{
g[b]={
name:t[h].name,id:t[h].id};
b++
}}}}
catch(y){
ZaApp.getInstance().getCurrentController()._handleException(y,"ZaAccountMemberOfListView.getDlMemberShip",null,false)
}
var p={
directMemberList:g,indirectMemberList:e,nonMemberList:l};
return p
};
ZaAccountMemberOfListView.cloneMemberOf=function(r){
var h={};
for(var s in r[ZaAccount.A2_memberOf]){
h[s]=[];
for(var o=0;
o<r[ZaAccount.A2_memberOf][s].length;
o++){
var t=r[ZaAccount.A2_memberOf][s][o];
if(t instanceof Object){
var e={};
for(var n in t){
e[n]=t[n]
}
h[s].push(e)
}else{
h[s].push(t)
}}}
return h
};
ZaAccountMemberOfListView.removeAllGroups=function(n,e){
var o=this.getForm();
var t=ZaAccountMemberOfListView._getAllInList(o,e);
ZaAccountMemberOfListView._removeSelectedLists(o,t)
};
ZaAccountMemberOfListView.removeGroups=function(n,e){
var o=this.getForm();
var t=ZaAccountMemberOfListView._getSelections(o,e);
ZaAccountMemberOfListView._removeSelectedLists(o,t)
};
ZaAccountMemberOfListView._removeSelectedLists=function(e,t){
var u=e.getInstance();
var l=u[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
var c=u[ZaAccount.A2_memberOf][ZaAccount.A2_indirectMemberList];
var m=u[ZaAccount.A2_memberOf][ZaAccount.A2_nonMemberList];
var s=-1;
var d=null;
var n=null;
for(var h=0;
h<t.length;
h++){
d=t[h][ZaAccountMemberOfListView.A_name];
s=ZaUtil.findValueInObjArrByPropertyName(l,d,ZaAccountMemberOfListView.A_name);
if(s>=0){
n=ZaAccountMemberOfListView._findIndirect(c,d);
if(n.length>0){
var o=n.join("<br />");
msg=AjxMessageFormat.format(ZaMsg.Q_REMOVE_INDIRECT_GROUP,[d,o]);
var r=new ZaMsgDialog(e.shell,null,[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON],null,ZaId.VIEW_MEMLIST);
r.setMessage(msg,DwtMessageDialog.WARNING_STYLE);
r.registerCallback(DwtDialog.YES_BUTTON,ZaAccountMemberOfListView._removeConfirmedList,null,[e,r,d,n]);
r.registerCallback(DwtDialog.NO_BUTTON,ZaAccountMemberOfListView._closeConfirmDialog,null,[e,r]);
r.popup();
continue
}
l.splice(s,1);
e.parent.setDirty(true)
}}
e.getModel().setInstanceValue(u,ZaAccount.A2_directMemberList,l);
e.getModel().setInstanceValue(u,ZaAccount.A2_indirectMemberList,c);
e.getModel().setInstanceValue(u,ZaAccount.A2_nonMemberList,m);
if(l==null||l.length<=ZaAccountMemberOfListView.SEARCH_LIMIT){
e.getModel().setInstanceValue(u,ZaAccount.A2_directMemberList+"_more",0)
}};
ZaAccountMemberOfListView._closeConfirmDialog=function(t,e){
if(e){
e.popdown()
}};
ZaAccountMemberOfListView._removeConfirmedList=function(e,c,l,t){
if(c){
var d=e.getInstance();
var r=d[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
var h=d[ZaAccount.A2_memberOf][ZaAccount.A2_indirectMemberList];
var u=d[ZaAccount.A2_memberOf][ZaAccount.A2_nonMemberList];
var n=-1;
var o=-1;
n=ZaUtil.findValueInObjArrByPropertyName(r,l,ZaAccountMemberOfListView.A_name);
if(n>=0){
r.splice(n,1)
}
for(var s=0;
s<t.length;
s++){
n=ZaUtil.findValueInObjArrByPropertyName(h,t[s],ZaAccountMemberOfListView.A_name);
if(n>=0){
h.splice(n,1)
}}
e.parent.setDirty(true);
ZaAccountMemberOfListView._closeConfirmDialog(e,c);
e.getModel().setInstanceValue(d,ZaAccount.A2_directMemberList,r);
e.getModel().setInstanceValue(d,ZaAccount.A2_indirectMemberList,h);
e.getModel().setInstanceValue(d,ZaAccount.A2_nonMemberList,u)
}};
ZaAccountMemberOfListView._findIndirect=function(t,s,e){
var o=-1;
if(!e){
e=new Array()
}
if(t){
for(var n=0;
n<t.length;
n++){
if(t[n][ZaAccountMemberOfListView.A_via]==s){
e.push(t[n][ZaAccountMemberOfListView.A_name]);
e=ZaAccountMemberOfListView._findIndirect(t,t[n][ZaAccountMemberOfListView.A_name],e)
}}}
return e
};
ZaAccountMemberOfListView.addGroups=function(n,e){
var o=this.getForm();
var t=ZaAccountMemberOfListView._getSelections(o,e);
ZaAccountMemberOfListView._addSelectedLists(o,t)
};
ZaAccountMemberOfListView.addAllGroups=function(n,e){
var o=this.getForm();
var t=ZaAccountMemberOfListView._getAllInList(o,e);
ZaAccountMemberOfListView._addSelectedLists(o,t)
};
ZaAccountMemberOfListView._addSelectedLists=function(r,t){
var e=r.getInstance();
var h=e[ZaAccount.A2_memberOf];
var s=[];
for(var n=0;
n<t.length;
n++){
var o=ZaUtil.findValueInObjArrByPropertyName(e[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList],t[n][ZaAccountMemberOfListView.A_name],ZaAccountMemberOfListView.A_name);
if(o>=0){
continue
}else{
s.push(t[n])
}}
if(!h[ZaAccount.A2_directMemberList]){
h[ZaAccount.A2_directMemberList]=[]
}
h[ZaAccount.A2_directMemberList]=h[ZaAccount.A2_directMemberList].concat(s);
r.parent.setDirty(true);
r.getModel().setInstanceValue(e,ZaAccount.A2_directMemberList,h[ZaAccount.A2_directMemberList]);
r.getModel().setInstanceValue(e,ZaAccount.A2_nonMemberList,h[ZaAccount.A2_nonMemberList]);
r.getModel().setInstanceValue(e,ZaAccount.A2_indirectMemberList,h[ZaAccount.A2_indirectMemberList]);
if(h[ZaAccount.A2_directMemberList].length>ZaAccountMemberOfListView.SEARCH_LIMIT){
r.getModel().setInstanceValue(e,ZaAccount.A2_directMemberList+"_more",1)
}};
ZaAccountMemberOfListView._getSelections=function(o,e){
var t=o.getItemsById(e)[0].getSelection();
return(t)?t:[]
};
ZaAccountMemberOfListView._getAllInList=function(o,e){
var t=o.getItemsById(e)[0].widget;
var n=t.getList().getArray();
t.setSelectedItems(n);
return n
};
ZaAccountMemberOfListView.shouldEnableAddRemoveButton=function(e){
return(ZaAccountMemberOfListView._getSelections(this.getForm(),e).length>0)
};
ZaAccountMemberOfListView.shouldEnableAllButton=function(e){
var t=this.getInstanceValue(e);
if(t!=null){
return(t.length>0)
}
return false
};
ZaAccountMemberOfListView.shouldEnableBackButton=function(e){
var t=this.getInstance()[e+"_offset"];
return((t&&t>0)?true:false)
};
ZaAccountMemberOfListView.shouldEnableForwardButton=function(e){
var t=this.getInstance()[e+"_more"];
return((t&&t>0)?true:false)
};
ZaAccountMemberOfListView.addMemberList=function(h,s){
try{
var r=[];
if(h[ZaAccount.A2_memberOf]&&h[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList]){
var t=h[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
if(t){
if(!t instanceof Array){
t=[t]
}
for(var n=0;
n<t.length;
n++){
var e=t[n].name;
r.push(t[n])
}
if(r.length>0){
ZaAccountMemberOfListView.addNewGroupsBySoap(s,r)
}}}}
catch(o){
ZaApp.getInstance().getCurrentController()._handleException(o,"ZaAccountMemberOfListView.addMemberList: add group failed",null,false)
}};
ZaItem.createMethods.ZaAccount.push(ZaAccountMemberOfListView.addMemberList);
ZaItem.createMethods.ZaDistributionList.push(ZaAccountMemberOfListView.addMemberList);
ZaAccountMemberOfListView.modifyMemberList=function(u,t){
try{
if(!t||(this[ZaAccount.A2_memberOf]==null)||!t[ZaAccount.A2_memberOf]){
return
}
var s=[];
var r=[];
var c=this[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
var d=t[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
for(var n=0;
n<d.length;
n++){
var l=d[n].name;
var o=ZaUtil.findValueInObjArrByPropertyName(c,l,ZaAccountMemberOfListView.A_name);
if(o>=0){}else{
s.push(d[n])
}}
for(var e=0;
e<c.length;
e++){
var l=c[e].name;
var o=ZaUtil.findValueInObjArrByPropertyName(d,l,ZaAccountMemberOfListView.A_name);
if(o>=0){}else{
r.push(c[e])
}}
if(s.length>0){
ZaAccountMemberOfListView.addNewGroupsBySoap(this,s)
}
if(r.length>0){
ZaAccountMemberOfListView.removeGroupsBySoap(this,r)
}}
catch(h){
ZaApp.getInstance().getCurrentController()._handleException(h,"ZaAccountMemberOfListView.modifyMemberList: add group failed",null,false)
}};
ZaItem.modifyMethods.ZaAccount.push(ZaAccountMemberOfListView.modifyMemberList);
ZaItem.modifyMethods.ZaDistributionList.push(ZaAccountMemberOfListView.modifyMemberList);
ZaAccountMemberOfListView.addNewGroupsBySoap=function(s,c){
var e=c.length;
var t,n,t;
var l=new ZmCsfeCommand();
for(var o=0;
o<e;
++o){
t=AjxSoapDoc.create("AddDistributionListMemberRequest",ZaZimbraAdmin.URN,null);
t.set("id",c[o].id);
t.set("dlm",s.name);
var h=new Object();
h.soapDoc=t;
h.noAuthToken=true;
n=l.invoke(h).Body.AddDistributionListMemberResponse
}};
ZaAccountMemberOfListView.removeGroupsBySoap=function(c,o){
var d=o.length;
var n,e,t;
var h=new ZmCsfeCommand();
for(var l=0;
l<d;
++l){
t=AjxSoapDoc.create("RemoveDistributionListMemberRequest",ZaZimbraAdmin.URN,null);
t.set("id",o[l].id);
accountEl=t.set("account",c.id);
var s=new Object();
s.soapDoc=t;
s.noAuthToken=true;
e=h.invoke(s).Body.RemoveDistributionListMemberResponse
}};
ZaAccountMemberOfListView.prototype.srchButtonHndlr=function(){
var e=this;
ZaAccountMemberOfListView.doSearch(e,0)
};
ZaAccountMemberOfListView.backButtonHndlr=function(n,t){
var e=this.getInstance();
var s=this.getInstanceValue(t+"_offset");
if(s==null){
s=0
}
var o=0;
if(t==ZaAccount.A2_nonMemberList){
o=s-ZaAccountMemberOfListView.SEARCH_LIMIT;
ZaAccountMemberOfListView.doSearch(this,o)
}else{
o=s-ZaAccountMemberOfListView.SEARCH_LIMIT;
this.setInstanceValue(o,t+"_offset");
this.setInstanceValue(1,t+"_more");
var r=e[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
var h=e[ZaAccount.A2_memberOf][ZaAccount.A2_indirectMemberList];
this.setInstanceValue(r,ZaAccount.A2_directMemberList);
this.setInstanceValue(h,ZaAccount.A2_indirectMemberList)
}};
ZaAccountMemberOfListView.fwdButtonHndlr=function(n,t){
var e=this.getInstance();
var s=this.getInstanceValue(t+"_offset");
if(s==null){
s=0
}
var o=0;
if(t==ZaAccount.A2_nonMemberList){
o=s+ZaAccountMemberOfListView.SEARCH_LIMIT;
ZaAccountMemberOfListView.doSearch(this,o)
}else{
o=s+ZaAccountMemberOfListView.SEARCH_LIMIT;
if((o+ZaAccountMemberOfListView.SEARCH_LIMIT)<e[ZaAccount.A2_memberOf][t].length){
this.setInstanceValue(1,t+"_more")
}else{
this.setInstanceValue(0,t+"_more")
}
this.setInstanceValue(o,t+"_offset");
var r=e[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList];
var h=e[ZaAccount.A2_memberOf][ZaAccount.A2_indirectMemberList];
this.setInstanceValue(r,ZaAccount.A2_directMemberList);
this.setInstanceValue(h,ZaAccount.A2_indirectMemberList)
}};
ZaAccountMemberOfListView.makeQueryStringWithoutNonACLGroup=function(e){
if(e==null){
e=""
}
return"(&"+e+"(!(zimbraIsACLGroup=FALSE)))"
};
ZaAccountMemberOfListView.doSearch=function(v,h){
var e=[];
var t=v.getForm();
if(t){
var n=t.getInstance();
if(!h){
h=0
}
var c=n[ZaAccount.A2_memberOf];
try{
var f=ZaAccount.A_name;
var l=(c[ZaAccount.A2_showSameDomain]&&(c[ZaAccount.A2_showSameDomain]=="TRUE"))?true:false;
var u=null;
if(l){
try{
var p=n[ZaAccount.A_name].split("@");
u=p[1]
}
catch(b){}}
var g=[ZaAccount.A_name,ZaItem.A_zimbraId];
var d=n[ZaSearch.A_query];
var s=[ZaSearch.DLS];
var r=ZaSearch.getSearchByNameQuery(d,s);
r=ZaAccountMemberOfListView.makeQueryStringWithoutNonACLGroup(r);
var k={
query:r,sortBy:f,limit:ZaAccountMemberOfListView.SEARCH_LIMIT,offset:h,domain:u,applyCos:0,attrs:g,types:s,controller:ZaApp.getInstance().getCurrentController()};
var m=ZaSearch.searchDirectory(k).Body.SearchDirectoryResponse;
v.setInstanceValue((m.more?1:0),ZaAccount.A2_nonMemberList+"_more");
var w=new ZaItemList(ZaDistributionList,null);
w.loadFromJS(m);
e=w.getArray();
var o=new Array();
for(var y=0;
y<e.length;
y++){
o.push({
name:e[y].name,id:e[y].id}
)
}
v.setInstanceValue(o,ZaAccount.A2_nonMemberList);
v.setInstanceValue(h,ZaAccount.A2_nonMemberList+"_offset")
}
catch(b){
ZaApp.getInstance().getCurrentController()._handleException(b,"ZaAccountMemberOfListView.prototype.srchButtonHndlr")
}}
return true
};
ZaAccountMemberOfListView.join=function(o){
var e=[];
for(var t=0;
t<o.length;
t++){
if(o[t].name){
e.push(o[t].name)
}}
return e.join()
};
ZaAccountMemberOfListView.prototype._createItemHtml=function(c,t,n){
var r=new Array(50);
var e=document.createElement("div");
e[DwtListView._STYLE_CLASS]="Row";
e[DwtListView._SELECTED_STYLE_CLASS]=e[DwtListView._STYLE_CLASS]+"-"+DwtCssStyle.SELECTED;
e.className=e[DwtListView._STYLE_CLASS];
this.associateItemWithElement(c,e,DwtListView.TYPE_LIST_ITEM);
var l=0;
r[l++]="<table width='100%' cellspacing='0' cellpadding='0'>";
r[l++]="<tr>";
if(this._headerList){
var o=this._headerList.length;
for(var s=0;
s<o;
s++){
var h=this._headerList[s]._field;
if(h==ZaAccountMemberOfListView.A_name){
r[l++]="<td width="+this._headerList[s]._width+">";
r[l++]=AjxStringUtil.htmlEncode(c[ZaAccountMemberOfListView.A_name]);
r[l++]="</td>"
}else{
if(h==ZaAccountMemberOfListView.A_via){
r[l++]="<td width="+this._headerList[s]._width+">";
r[l++]=AjxStringUtil.htmlEncode(c[ZaAccountMemberOfListView.A_via]);
r[l++]="</td>"
}}}}else{
r[l++]="<td width=100%><nobr>";
r[l++]=AjxStringUtil.htmlEncode(c[ZaAccountMemberOfListView.A_name]);
r[l++]="</nobr></td>"
}
r[l++]="</tr></table>";
e.innerHTML=r.join("");
return e
};
ZaAccountMemberOfListView.prototype._setNoResultsHtml=function(){
var t=new AjxBuffer();
var n=document.createElement("div");
var o="";
if(this.getCurrentListId().indexOf(ZaAccount.A2_indirectMemberList)>=0){
var e=this.parent&&this.parent.getInstance();
if(e&&e.memberOfLoaded){
o=ZaMsg.Account_Group_NoInDirectMember
}else{
o=ZaMsg.MSG_HomeLoading
}}else{
if(this.getCurrentListId().indexOf(ZaAccount.A2_directMemberList)>=0){
var e=this.parent&&this.parent.getInstance();
if(e&&e.memberOfLoaded){
o=ZaMsg.Account_Group_NoDirectMember
}else{
o=ZaMsg.MSG_HomeLoading
}}}
t.append("<table width='99%' cellspacing='0' cellpadding='1' style='table-layout:fixed'>","<tr>","<td class='NoResults' style='white-space:normal; word-wrap:break-word; word-break:break-all;' >",AjxStringUtil.htmlEncode(o),"</td>","</tr>","</table>");
n.innerHTML=t.toString();
this._addRow(n)
};
ZaAccountMemberOfListView.prototype.setCurrentListId=function(e){
this._currentListId=e
};
ZaAccountMemberOfListView.prototype.getCurrentListId=function(){
return this._currentListId
};
S_Dwt_List_XFormItem=function(){};
XFormItemFactory.createItemType("_S_DWT_LIST_","s_dwt_list",S_Dwt_List_XFormItem,Dwt_List_XFormItem);
S_Dwt_List_XFormItem.prototype.setItems=function(e){
var u=this.widget.getList();
var f=[];
var r=new Array();
if(u){
f=u.getArray()
}
r=new Array();
var y=this.getForm().getInstance();
var o=y[ZaAccount.A2_memberOf]?y[ZaAccount.A2_memberOf]["showGroupOnlyAction"]:false;
var p=y[ZaAccount.A2_memberOf]?y[ZaAccount.A2_memberOf][ZaAccountMemberOfListView.A_isgroup]:false;
this.widget.setCurrentListId(this.id);
if(e&&e.length>0){
var s=0;
var m=0;
var d=e.length;
if(this.id.indexOf(ZaAccount.A2_indirectMemberList)>=0){
s=y[ZaAccount.A2_indirectMemberList+"_offset"];
if(s==null){
s=0
}
m=y[ZaAccount.A2_indirectMemberList+"_more"];
if(m==null){
m=0
}
if(m>0&&s+ZaAccountMemberOfListView.SEARCH_LIMIT<=d){
d=s+ZaAccountMemberOfListView.SEARCH_LIMIT
}}else{
if(this.id.indexOf(ZaAccount.A2_directMemberList)>=0){
s=y[ZaAccount.A2_directMemberList+"_offset"];
if(s==null){
s=0
}
m=y[ZaAccount.A2_directMemberList+"_more"];
if(m==null){
m=0
}
if(m>0&&s+ZaAccountMemberOfListView.SEARCH_LIMIT<=d){
d=s+ZaAccountMemberOfListView.SEARCH_LIMIT
}}}
var c=new Array();
var n=-1;
for(var h=s;
h<d;
h++){
if(this.id.indexOf(ZaAccount.A2_nonMemberList)>=0){
if(y.id==e[h].id){
continue
}
n=ZaUtil.findValueInObjArrByPropertyName(y[ZaAccount.A2_memberOf][ZaAccount.A2_directMemberList],e[h][ZaAccountMemberOfListView.A_name],ZaAccountMemberOfListView.A_name);
if(n>=0){
continue
}}
c.push(e[h])
}
if(ZaAccountMemberOfListView.join(c)!=ZaAccountMemberOfListView.join(f)){
var l=this.getInheritedProperty("preserveSelection");
var g=null;
if(l){
g=this.widget.getSelection()
}
var t=c.length;
for(var h=0;
h<t;
h++){
r.push(c[h])
}
this.widget.set(AjxVector.fromArray(r),this.getInheritedProperty("defaultColumnSortable"));
if(l&&g){
this.widget.setSelectedItems(g)
}}}else{
this.widget.set(AjxVector.fromArray([]))
}};
ZaAccountMemberOfsourceHeaderList=function(e,o){
var t=new Array();
t[0]=new ZaListHeaderItem(ZaAccountMemberOfListView.A_name,ZaMsg.CLV_Name_col,null,null,null,ZaAccountMemberOfListView.A_name,false,true);
if(e==ZaAccountMemberOfsourceHeaderList.INDIRECT){
t[1]=new ZaListHeaderItem(ZaAccountMemberOfListView.A_via,ZaMsg.Group_via,null,null,null,ZaAccountMemberOfListView.A_via,false,true)
}
return t
};
ZaAccountMemberOfsourceHeaderList.DIRECT=1;
ZaAccountMemberOfsourceHeaderList.INDIRECT=2;
ZaAccountMemberOfsourceHeaderList.NON=3
}
if(AjxPackage.define("zimbraAdmin.task.view.ZaTaskHeaderPanel")){
ZaTaskHeaderPanel=function(e){
DwtComposite.call(this,e,"TaskHeaderPanel",Dwt.ABSOLUTE_STYLE);
this._expanded=false;
this.getHtmlElement().innerHTML=this.getImgHtml();
this.getHtmlElement().onclick=AjxCallback.simpleClosure(ZaTaskHeaderPanel.__handleClick,this)
};
ZaTaskHeaderPanel.expandedImg="ImgCollapseRight";
ZaTaskHeaderPanel.collapsedImg="ImgCollapseLeft";
ZaTaskHeaderPanel.prototype=new DwtComposite;
ZaTaskHeaderPanel.prototype.constructor=ZaTaskHeaderPanel;
ZaTaskHeaderPanel.prototype.getImgHtml=function(){
if(this._expanded){
return["<div class='",ZaTaskHeaderPanel.expandedImg,"' ></div>"].join("")
}else{
return["<div class='",ZaTaskHeaderPanel.collapsedImg,"' ></div>"].join("")
}};
ZaTaskHeaderPanel.__handleClick=function(e){
this._expanded=!this._expanded;
this.getHtmlElement().innerHTML=this.getImgHtml();
ZaZimbraAdmin.getInstance().getTaskController().setExpanded(this._expanded)
}
}
if(AjxPackage.define("zimbraAdmin.task.view.ZaTaskContentView")){
ZaTaskContentView=function(e,t){
ZaTabView.call(this,{
parent:e,cssClassName:"ZaTaskTabView DwtTabView",iKeyName:"ZaTaskContentView",contextId:"TabContent"}
);
this.initForm(ZaTask.myXModel,this.getMyXForm(t),null)
};
ZaTaskContentView.prototype=new ZaTabView();
ZaTaskContentView.prototype.constructor=ZaTaskContentView;
ZaTabView.XFormModifiers.ZaTaskContentView=new Array();
ZaTaskContentView._dialogCache=new Array();
ZaTaskContentView._getDialog=function(o){
var e;
if(o.type==1){
var s=o.cacheName;
var n=o.viewForPopup;
var t=o.data;
if(o.cacheDialog&&!ZaTaskContentView._dialogCache[s]){
ZaTaskContentView._dialogCache[s]=ZaApp.getInstance().dialogs[s]
}
if(!o.cacheDialog||!ZaTaskContentView._dialogCache[s]){
ZaTaskContentView._dialogCache[s]=ZaApp.getInstance().dialogs[s]=new n(ZaApp.getInstance().getAppCtxt().getShell(),t);
if(o.finishCallback){
ZaTaskContentView._dialogCache[s].registerCallback(o.finishCallback.id,o.finishCallback.callback)
}}
e=ZaTaskContentView._dialogCache[s];
e.setObject(o.data)
}else{
if(o.type==2){
e=o.viewForPopup
}else{}}
return e
};
ZaTaskContentView.prototype.setObject=function(e){
this._containedObject=e;
this._localXForm.setInstance(this._containedObject);
this.formDirtyLsnr=new AjxListener(ZaApp.getInstance().getCurrentController(),ZaXFormViewController.prototype.handleXFormChange);
this._localXForm.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,this.formDirtyLsnr);
this._localXForm.addListener(DwtEvent.XFORMS_VALUE_ERROR,this.formDirtyLsnr)
};
ZaTaskContentView.taskItemSelectionListener=function(n){
var t=this.widget.getSelection();
if(t&&t.length){
var s=t[0];
var o=ZaTaskContentView._getDialog(s);
o.popup();
var e=s.position;
o.setBounds(e.x,e.y,e.width,e.height);
if(o.handleXFormChange){
o.handleXFormChange()
}}};
ZaTaskContentView.myXFormModifier=function(n,o){
var t=[];
var e={
type:_ZATABCASE_,numCols:1,caseKey:1,paddingStyle:"",width:"100%",getCustomWidth:ZaTaskContentView.prototype.getCustomWidth,getCustomHeight:ZaTaskContentView.prototype.getCustomHeight,items:[{
type:_AJX_IMAGE_,src:"WorkInProgress",label:null,containerCssStyle:"text-align:center;",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isExpanded]}
,{
ref:ZaTask.A_workingInProcess,type:_OUTPUT_,bmolsnr:true,value:0,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isExpanded],containerCssStyle:"padding-bottom:10px;text-align:center;",getDisplayValue:function(s){
return s.length
}}
,{
type:_GROUP_,numCols:1,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,true]],visibilityChangeEventSources:[ZaTask.A2_isExpanded],cssClass:"ZaTaskListGroup",items:[{
type:_COMPOSITE_,numCols:3,tableCssStyle:"width:100%",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isWIPExpanded,true]],visibilityChangeEventSources:[ZaTask.A2_isWIPExpanded],colSizes:["18px","16px","100%"],items:[{
type:_DWT_IMAGE_,value:"ImgNodeExpanded",cssStyle:"position:static;",onClick:function(){
this.setInstanceValue(false,ZaTask.A2_isWIPExpanded)
}}
,{
type:_AJX_IMAGE_,src:"WorkInProgress",label:null}
,{
type:_OUTPUT_,value:ZaMsg.MSG_WorkingTask}
],cssClass:"ZaTaskTitleNameHeader"}
,{
type:_COMPOSITE_,numCols:3,tableCssStyle:"width:100%",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isWIPExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isWIPExpanded],colSizes:["18px","16px","100%"],items:[{
type:_DWT_IMAGE_,value:"ImgNodeCollapsed",cssStyle:"position:static;",onClick:function(){
this.setInstanceValue(true,ZaTask.A2_isWIPExpanded)
}}
,{
type:_AJX_IMAGE_,src:"WorkInProgress",label:null}
,{
type:_OUTPUT_,value:ZaMsg.MSG_WorkingTask}
],cssClass:"ZaTaskTitleNameHeader"}
,{
ref:ZaTask.A_workingInProcess,type:_DWT_LIST_,cssClass:"ZaTaskListContent",forceUpdate:true,preserveSelection:false,multiselect:false,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isWIPExpanded,true]],visibilityChangeEventSources:[ZaTask.A2_isWIPExpanded],onSelection:ZaTaskContentView.taskItemSelectionListener}
]}
,{
type:_AJX_IMAGE_,src:"TaskViewWaiting",label:null,containerCssStyle:"text-align:center;",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isExpanded]}
,{
ref:ZaTask.A_runningTask,type:_OUTPUT_,bmolsnr:true,value:0,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isExpanded],containerCssStyle:"padding-bottom:10px;text-align:center;",getDisplayValue:function(s){
return s.length
}}
,{
type:_GROUP_,numCols:1,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,true]],visibilityChangeEventSources:[ZaTask.A2_isExpanded],cssClass:"ZaTaskListGroup",items:[{
type:_COMPOSITE_,numCols:3,tableCssStyle:"width:100%",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isRTExpanded,true]],visibilityChangeEventSources:[ZaTask.A2_isRTExpanded],colSizes:["18px","16px","100%"],items:[{
type:_DWT_IMAGE_,value:"ImgNodeExpanded",cssStyle:"position:static;",onClick:function(){
this.setInstanceValue(false,ZaTask.A2_isRTExpanded)
}}
,{
type:_AJX_IMAGE_,src:"TaskViewWaiting",label:null}
,{
type:_OUTPUT_,value:ZaMsg.MSG_RunningTask}
],cssClass:"ZaTaskTitleNameHeader"}
,{
type:_COMPOSITE_,numCols:3,tableCssStyle:"width:100%",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isRTExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isRTExpanded],colSizes:["18px","16px","100%"],items:[{
type:_DWT_IMAGE_,value:"ImgNodeCollapsed",cssStyle:"position:static;",onClick:function(){
this.setInstanceValue(true,ZaTask.A2_isRTExpanded)
}}
,{
type:_AJX_IMAGE_,src:"TaskViewWaiting",label:null}
,{
type:_OUTPUT_,value:ZaMsg.MSG_RunningTask}
],cssClass:"ZaTaskTitleNameHeader"}
,{
ref:ZaTask.A_runningTask,type:_DWT_LIST_,cssClass:"ZaTaskListContent",forceUpdate:true,preserveSelection:false,multiselect:false,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isRTExpanded,true]],visibilityChangeEventSources:[ZaTask.A2_isRTExpanded],onSelection:ZaTaskContentView.taskItemSelectionListener}
]}
,{
type:_AJX_IMAGE_,src:"Status",label:null,containerCssStyle:"text-align:center;",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isExpanded]}
,{
ref:ZaTask.A2_notificationCount,type:_OUTPUT_,bmolsnr:true,value:0,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,false]],visibilityChangeEventSources:[ZaTask.A2_isExpanded],containerCssStyle:"padding-bottom:10px;text-align:center;",getDisplayValue:function(s){
if(!s||s<0){
return 0
}
return s
}}
,{
type:_GROUP_,numCols:1,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isExpanded,true]],visibilityChangeEventSources:[ZaTask.A2_isExpanded],cssClass:"ZaTaskListGroup",items:[{
type:_COMPOSITE_,numCols:3,tableCssStyle:"width:100%",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isServerExpaned,true]],visibilityChangeEventSources:[ZaTask.A2_isServerExpaned],colSizes:["18px","16px","100%"],items:[{
type:_DWT_IMAGE_,value:"ImgNodeExpanded",cssStyle:"position:static;",onClick:function(){
this.setInstanceValue(false,ZaTask.A2_isServerExpaned)
}}
,{
type:_AJX_IMAGE_,src:"Status",label:null}
,{
type:_OUTPUT_,value:ZaMsg.MSG_ServerStatus}
],cssClass:"ZaTaskTitleNameHeader"}
,{
type:_COMPOSITE_,numCols:3,tableCssStyle:"width:100%",visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isServerExpaned,false]],visibilityChangeEventSources:[ZaTask.A2_isServerExpaned],colSizes:["18px","16px","100%"],items:[{
type:_DWT_IMAGE_,value:"ImgNodeCollapsed",cssStyle:"position:static;",onClick:function(){
this.setInstanceValue(true,ZaTask.A2_isServerExpaned)
}}
,{
type:_AJX_IMAGE_,src:"Status",label:null}
,{
type:_OUTPUT_,value:ZaMsg.MSG_ServerStatus}
],cssClass:"ZaTaskTitleNameHeader"}
,{
ref:ZaTask.A_serverStatus,type:_GROUP_,numCols:1,width:"100%",cssClass:"ZaTaskListContent",forceUpdate:true,preserveSelection:false,multiselect:false,visibilityChecks:[[XForm.checkInstanceValue,ZaTask.A2_isServerExpaned,true]],visibilityChangeEventSources:[ZaTask.A2_isServerExpaned],onSelection:ZaTaskContentView.taskItemSelectionListener,items:[{
type:_GROUP_,tableCssClass:"NoResults",width:"100%",visibilityChecks:[[ZaTaskContentView.prototype.canShowServerStatusIsHealthy]],visibilityChangeEventSources:[ZaTask.A2_isRTExpanded,ZaTask.A2_notificationCount],items:[{
type:_OUTPUT_,value:"<br><br>"+ZaMsg.ServerStatusHealthy,width:"100%"}
]}
]}
]}
,{
type:_SPACER_,height:"10px"}
]};
t.push(e);
n.tableCssStyle="width:100%;";
n.items=[{
type:_SWITCH_,align:_LEFT_,valign:_TOP_,items:t}
]
};
ZaTaskContentView.prototype.canShowServerStatusIsHealthy=function(){
var t=this.getInstanceValue(ZaTask.A2_isRTExpanded)||false;
var e=this.getInstanceValue(ZaTask.A2_notificationCount)||0;
return t&&(e==0)
};
ZaTaskContentView.prototype.getCustomWidth=function(){
return"100%"
};
ZaTaskContentView.prototype.getCustomHeight=function(){
return"100%"
};
ZaTaskContentView.getImgText=function(o,e){
var t=["<div class='","Img",o,"' style='text-align:center;'>",e,"</div>"].join("");
return t
};
ZaTabView.XFormModifiers.ZaTaskContentView.push(ZaTaskContentView.myXFormModifier);
ZaTaskContentView.getNotificationBoard=function(e){
return e.items[0].items[0].items[8].items[2]
}
}
if(AjxPackage.define("zimbraAdmin.common.EmailAddr_FormItem")){
DynSelectDomainPart_XFormItem=function(){};
XFormItemFactory.createItemType("_DYNSELECT_DOMAIN_PART_","dynselect_domain_part",DynSelectDomainPart_XFormItem,DynSelect_XFormItem);
DynSelectDomainPart_XFormItem.prototype.inputSize=35;
DynSelectDomainPart_XFormItem.prototype.setMenuWidth=false;
DynSelectDomainPart_XFormItem.prototype.handleKeyPressDelay=function(e,t){
if(!this.dataFetcherObject&&this.dataFetcherClass!=null&&this.dataFetcherMethod!=null){
this.dataFetcherObject=new this.dataFetcherClass(this.getForm().getController())
}
if(!this.dataFetcherObject){
return
}
var n=new AjxCallback(this,this.changeDomainChoicesCallback);
this.dataFetcherMethod.call(this.dataFetcherObject,{
value:t,event:e,callback:n,applyConfig:1}
);
var o="";
if(this.getParentItem()._namePart){
o=this.getParentItem()._namePart
}
o+="@";
o+=t;
this.getForm().itemChanged(this,o,e)
};
DynSelectDomainPart_XFormItem.prototype.changeDomainChoicesCallback=function(s,o,n){
var t=[];
AjxEmailAddress.customEmailValidateEegex={};
for(var e=0;
s&&e<s.length;
e++){
if(s[e]&&s[e].attrs[ZaDomain.A_domainType]==ZaDomain.domainTypes.local){
t.push(s[e]);
AjxEmailAddress.customEmailValidateEegex[s[e].name]=s[e].attrs[ZaDomain.A_zimbraMailAddressValidationRegex]
}}
this.changeChoicesCallback(t,o,n)
};
EmailAddr_XFormItem=function(){};
XFormItemFactory.createItemType("_EMAILADDR_","emailaddr",EmailAddr_XFormItem,Composite_XFormItem);
EmailAddr_XFormItem.domainChoices=new XFormChoices([],XFormChoices.OBJECT_LIST,"name","name");
EmailAddr_XFormItem.choicesDirty=false;
EmailAddr_XFormItem.prototype.numCols=4;
EmailAddr_XFormItem.prototype.nowrap=true;
EmailAddr_XFormItem.prototype.visibilityChecks=[ZaItem.hasReadPermission];
EmailAddr_XFormItem.prototype.enableDisableChecks=[ZaItem.hasWritePermission];
EmailAddr_XFormItem.prototype.initializeItems=function(){
this._inputWidth=this.getInheritedProperty("inputWidth");
if(this._inputWidth==null){
this._inputWidth=200
}
this.items[0].width=this._inputWidth;
this.items[0].containerCssStyle=this.getInheritedProperty("nameContainerCss");
this.items[1].containerCssStyle=this.getInheritedProperty("midContainerCss");
this.items[2].inputWidth=this.getInheritedProperty("domainPartWidth");
this.items[2].width=this.getInheritedProperty("domainContainerWidth");
Composite_XFormItem.prototype.initializeItems.call(this);
try{
this._domainPart=ZaSettings.myDomainName
}
catch(e){
this._domainPart=null
}
if(this._domainPart==null){
if(EmailAddr_XFormItem.domainChoices){
if(EmailAddr_XFormItem.domainChoices._choiceObject.length>0){
if(EmailAddr_XFormItem.domainChoices._choiceObject[0]){
this._domainPart=EmailAddr_XFormItem.domainChoices._choiceObject[0].name
}}}}
this._oldDomainPart=this._domainPart;
this._inputDomainPart=""
};
EmailAddr_XFormItem.prototype.items=[{
type:_TEXTFIELD_,forceUpdate:true,ref:".",labelLocation:_NONE_,cssClass:"admin_xform_name_input",visibilityChecks:[],enableDisableChecks:[],errorLocation:_PARENT_,getDisplayValue:function(e){
var o=e;
if(o){
var t=o.split("@");
if(t.length>1){
o=t[0]
}}
if(o===null||o===undefined){
o=""
}
this.getParentItem()._namePart=o;
return o
}
,elementChanged:function(e,o,t){
if(e&&this.getParentItem()._inputDomainPart){
this.getParentItem()._oldDomainPart=this.getParentItem()._domainPart;
this.getParentItem()._domainPart=this.getParentItem()._inputDomainPart;
this.getParentItem()._inputDomainPart=""
}
this.getParentItem()._namePart=e;
var n=e+"@";
if(this.getParentItem()._domainPart){
n+=this.getParentItem()._domainPart
}
this.getForm().itemChanged(this.getParentItem(),n,t)
}}
,{
type:_OUTPUT_,value:"@"}
,{
type:_DYNSELECT_DOMAIN_PART_,ref:".",labelLocation:_NONE_,choices:EmailAddr_XFormItem.domainChoices,editable:true,bmolsnr:true,toolTipContent:ZaMsg.tt_StartTypingDomainName,visibilityChecks:[],enableDisableChecks:[],dataFetcherMethod:ZaSearch.prototype.dynSelectSearchDomains,dataFetcherClass:ZaSearch,errorLocation:_PARENT_,getDisplayValue:function(e){
var o=null;
if(e){
var t=e.split("@");
if(t.length>1){
o=t[1]
}else{
o=e
}}
if(!o){
if(!this.getParentItem()._domainPart){
if(this.getChoices()&&this.getChoices()._choiceObject&&this.getChoices()._choiceObject[0]){
o=this.getChoices()._choiceObject[0].name;
this.getParentItem()._domainPart=o
}}else{}}else{
this.getParentItem()._domainPart=o
}
return o
}
,elementChanged:function(e,s,n){
var h;
var o=this.getParentItem()._domainPart;
if(this.getParentItem()._namePart){
h=this.getParentItem()._namePart+"@"+e
}else{
h="@"+e
}
if(e){
var t=this.getDisplayElement();
if(t){
if(this.getInheritedProperty("editable")){
t.value=e
}else{
t.innerHTML=e
}}}
if(this.getParentItem()._namePart){
this.getParentItem()._domainPart=e;
this.getParentItem()._oldDomainPart=o
}else{
this.getParentItem()._inputDomainPart=e
}
var r=AjxEmailAddress.customEmailValidateEegex[e];
if(r&&r instanceof Array){
AjxEmailAddress.customInvalidEmailPats=r
}else{
if(r){
AjxEmailAddress.customInvalidEmailPats=[r]
}else{
AjxEmailAddress.customInvalidEmailPats=[]
}}
this.getForm().itemChanged(this.getParentItem(),h,n)
}}
];
EmailAddr_XFormItem.prototype.resetEditedState=function(){
this.items[2].edited=false
};
EmailAddr_XFormItem.resetDomainLists=function(e){
if(e||EmailAddr_XFormItem.choicesDirty){
DBG.println(AjxDebug.DBG3,"Reset the domain lists ....");
ZaApp.getInstance().searchDomains();
EmailAddr_XFormItem.choicesDirty=false
}};
EmailAddr_XFormItem.prototype.getOldDomainPart=function(){
return this._oldDomainPart
};
EmailAddr_XFormItem.prototype.getCurrentDomainPart=function(){
return this._domainPart
};
EmailAddr_XFormItem.prototype.clearNameNullError=function(){
if(this._namePart==""){
if(this.hasError()){
this.clearError();
this.setInstanceValue("");
var t=this.getForm();
var e=new DwtXFormsEvent(t,this,"");
t.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,e);
t.setIsDirty(true,this);
return true
}}
return false
}
}}
if(AjxPackage.define("admin.Widgets")){
AjxTemplate.register("admin.Widgets#ZaAppTab",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<table role=\"presentation\" class='ZWidgetTable ZAppTabTable ZAppTabBorder' style='table-layout:auto;'><tr id='";
e[o++]=s.id;
e[o++]="_row'><td id='";
e[o++]=s.id;
e[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
e[o++]=s.id;
e[o++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
e[o++]=s.id;
e[o++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td></tr></table>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaAppTab","class":"ZAppTab"}
,false);
AjxTemplate.register("admin.Widgets",AjxTemplate.getTemplate("admin.Widgets#ZaAppTab"),AjxTemplate.getParams("admin.Widgets#ZaAppTab"));
AjxTemplate.register("admin.Widgets#ZaToolBarLabel",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]='<table role="presentation" id=\'';
e[o++]=s.id;
e[o++]="_label'\t\tclass='ZWidgetTable ZLabelBorder'><tr><td id='";
e[o++]=s.id;
e[o++]="_left_icon'\tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
e[o++]=s.id;
e[o++]="_title'\t\tclass='ZWidgetTitle ZaNowrapTitle'></td><td id='";
e[o++]=s.id;
e[o++]="_right_icon'\tclass='ZRightIcon ZWidgetIcon'></td></tr></table>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaToolBarLabel","class":"ZaToolBarLabel ZWidget"}
,false);
AjxTemplate.register("admin.Widgets#ZaToast",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<div class='ZaToastBG'><div class='ZaToastContent'><div id='";
e[o++]=s.id;
e[o++]="_icon' class='ZaToastIcon'></div><div id='";
e[o++]=s.id;
e[o++]="_text' class='ZaToastText'></div></div></div>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaToast","class":"ZaToastInfo"}
,false);
AjxTemplate.register("admin.Widgets#ZaCurrentAppBar",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<table role=\"presentation\" style='table-layout:fixed;width:100%; height:100%'><tr><td id='";
e[o++]=s.id;
e[o++]="_title'\tclass='ZWidgetTitle'\tstyle='width:100%'></td><td id='";
e[o++]=s.id;
e[o++]="_action'\t\t\t\t\t\t\tstyle='width:0px'><div><table role=\"presentation\" class='ZToolbarTable'><tr id='";
e[o++]=s.id;
e[o++]="_actionitems'></tr></table></div></td><td id='";
e[o++]=s.id;
e[o++]="_settingimg'\t\t\t\t\t\tstyle='width:20px'></td><td id='";
e[o++]=s.id;
e[o++]="_dropdown'\tclass='ZDropDown'\t\tstyle='width:20px'></td></tr></table>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaCurrentAppBar","class":"ZaCurrentAppBar"}
,false);
AjxTemplate.register("admin.Widgets#ZaTreeHeaderButton",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]='<table role="presentation" id=\'';
e[o++]=s.id;
e[o++]="_table' class='DwtLinkButtonTable ";
e[o++]=s.bgImg;
e[o++]="' style='table-layout:fixed;width:100%'><tr><td id='";
e[o++]=s.id;
e[o++]="_doubleArrow' style='width:20px'><div></div></td><td id='";
e[o++]=s.id;
e[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'\tstyle='width:0px'></td><td id='";
e[o++]=s.id;
e[o++]="_title'\t\tclass='ZWidgetTitle'\t\t\tstyle='width:120px'></td><td id='";
e[o++]=s.id;
e[o++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'\tstyle='width:0px'></td><td id='";
e[o++]=s.id;
e[o++]="_dropdown' \tclass='ZDropDown'\t\t\t\tstyle='width:20px'></td><td id='";
e[o++]=s.id;
e[o++]="_fill'\t\t\t\t\t\t\t\t\t\t\tstyle='width:100%;'></td><td id='";
e[o++]=s.id;
e[o++]="_img'\t\t\t\t\t\t\t\t\t\t\tstyle='width:20px'></td></tr></table>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaTreeHeaderButton","class":"ZWidget"}
,false);
AjxTemplate.register("admin.Widgets#ZaTreeItem",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<div class='";
e[o++]=s.divClassName;
e[o++]="' id='";
e[o++]=s.id;
e[o++]="_div'><table role=\"presentation\" id='";
e[o++]=s.id;
e[o++]="_table'><tr>";
if(s.isCheckedStyle){
e[o++]="<td nowrap id='";
e[o++]=s.id;
e[o++]='_checkboxCell\' class="ZTreeItemCheckboxCell"><div class="ZTreeItemCheckbox" id=\'';
e[o++]=s.id;
e[o++]="_checkbox'><div class=\"ZTreeItemCheckboxImg\" id='";
e[o++]=s.id;
e[o++]="_checkboxImg'>";
e[o++]=AjxImg.getImageHtml("MenuCheck");
e[o++]="</div></div></td>"
}
e[o++]="<td width=16 nowrap class='imageCell' id='";
e[o++]=s.id;
e[o++]="_imageCell'></td><td nowrap class='";
e[o++]=s.textClassName;
e[o++]="' id='";
e[o++]=s.id;
e[o++]="_textTDCell'><div class='ZTreeItemTextCell' id='";
e[o++]=s.id;
e[o++]="_textCell'></div></td><td width=16 class='imageCell' id='";
e[o++]=s.id;
e[o++]="_extraCell'></td><td width=1% align=center nowrap id='";
e[o++]=s.id;
e[o++]="_countCell'></td><td align=center nowrap id='";
e[o++]=s.id;
e[o++]="_nodeCell'></td></tr></table></div>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaTreeItem"}
,false);
AjxTemplate.register("admin.Widgets#ZaBaseDialog",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<div class='DwtDialog WindowOuterContainer'><table role=\"presentation\"><tr class='DwtDialogHeader' id='";
e[o++]=s.dragId;
e[o++]="'><td class='minWidth'>";
e[o++]=s.icon;
e[o++]="</td><td id='";
e[o++]=s.id;
e[o++]="_title' class='DwtDialogTitle'>";
e[o++]=s.title;
e[o++]="</td><td class='minWidth'><div class='";
e[o++]=s.closeIcon2;
e[o++]="'></div></td><td class='minWidth'><div class='";
e[o++]=s.closeIcon1;
e[o++]="'></div></td><td width=24 id='";
e[o++]=s.id;
e[o++]="_minimize' class='DwtDialogMinIcon'></td></tr><tr><td colspan='5'><div class='horizSep'></div></td></tr><tr><td class='WindowInnerContainer' colspan='5'><table role=\"presentation\"><tr><td><div id='";
e[o++]=s.id;
e[o++]="_content' class='DwtDialogBody'></div></td></tr></tr><td>";
if(s.controlsTemplateId){
e[o++]=AjxTemplate.expand(s.controlsTemplateId,s)
}
e[o++]="</td></table></td></tr></table></div>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaBaseDialog",height:"32",width:"20"}
,false);
AjxTemplate.register("admin.Widgets#ZaSeachOptionDialog",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<div class='DwtDialog'><table role=\"presentation\"><tr><td class='WindowInnerContainer' colspan='4'><table role=\"presentation\"><tr><td><div id='";
e[o++]=s.id;
e[o++]="_content' class='DwtDialogBody'></div></td></tr></tr><td>";
if(s.controlsTemplateId){
e[o++]=AjxTemplate.expand(s.controlsTemplateId,s)
}
e[o++]="</td></table></td></tr></table></div>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaSeachOptionDialog",height:"32",width:"20"}
,false);
AjxTemplate.register("admin.Widgets#ZaAboutDialog",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<div class='ZaAboutDialog'><table role=\"presentation\" style='table-layout:fixed;width:100%'><tr class='ZaAboutDialogHeader' id='";
e[o++]=s.dragId;
e[o++]="'><td id='";
e[o++]=s.id;
e[o++]="_full' class='ZaAboutDialogTitle' style='width:100%;'>&nbsp</td><td width=24 id='";
e[o++]=s.id;
e[o++]="_close' ><div class=";
e[o++]=s.closeIcon;
e[o++]="></div></td></tr><tr><td class='WindowInnerContainer' colspan='2'><table role=\"presentation\"><tr><td><div id='";
e[o++]=s.id;
e[o++]="_content' class='DwtDialogBody'><div><div class='contentBox'><h1><a id='";
e[o++]=s.id;
e[o++]="_bannerLink' target='_new' href='";
e[o++]=s.logoURL;
e[o++]="'><span class='";
e[o++]=s.aboutBanner;
e[o++]="'></span></a></h1><div id='";
e[o++]=s.id;
e[o++]="_longVersion' class='version'>\n";
e[o++]="                                                ";
e[o++]=s.version;
e[o++]="\n";
e[o++]="                                            </div></div></div><div id='";
e[o++]=s.id;
e[o++]="_footer' class='Footer'><div class='copyright'>\n";
e[o++]="                                            ";
e[o++]=s.copyright;
e[o++]="\n";
e[o++]="                                        </div></div></div></td></tr></table></td></tr></table></div>";
return n?e.length:e.join("")
}
,{
id:"admin.Widgets#ZaAboutDialog",height:"32",width:"20"}
,false)
};
