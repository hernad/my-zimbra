if(AjxPackage.define("TinyMCE")){
if(AjxPackage.define("ajax.3rdparty.tinymce.tinymce_jquery")){
(function(t,s){var i={};
function a(d,u){
var c,h=[];
for(var l=0;
l<d.length;
++l){
c=i[d[l]]||o(d[l]);
if(!c){
throw"module definition dependecy not found: "+d[l]
}
h.push(c)
}
u.apply(null,h)
}
function r(c,l,h){
if(typeof c!=="string"){
throw"invalid module definition, module id must be defined and be a string"
}
if(l===s){
throw"invalid module definition, dependencies must be specified"
}
if(h===s){
throw"invalid module definition, definition function must be specified"
}
a(l,function(){
i[c]=h.apply(null,arguments)
}
)
}
function n(h){
return !!i[h]
}
function o(d){
var l=t;
var h=d.split(/[.\/]/);
for(var c=0;
c<h.length;
++c){
if(!l[h[c]]){
return
}
l=l[h[c]]
}
return l
}
function e(c){
var l,u,f,h,d;
for(l=0;
l<c.length;
l++){
u=t;
f=c[l];
h=f.split(/[.\/]/);
for(var m=0;
m<h.length-1;
++m){
if(u[h[m]]===s){
u[h[m]]={}
}
u=u[h[m]]
}
u[h[h.length-1]]=i[f]
}
if(t.AMDLC_TESTS){
d=t.privateModules||{};
for(f in i){
d[f]=i[f]
}
for(l=0;
l<c.length;
l++){
delete d[c[l]]
}
t.privateModules=d
}}
r("tinymce/dom/EventUtils",[],function(){var f="mce-data-";
var c=/^(?:mouse|contextmenu)|click/;
var l={
keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1};
function d(b,y,w,g){
if(b.addEventListener){
b.addEventListener(y,w,g||false)
}else{
if(b.attachEvent){
b.attachEvent("on"+y,w)
}}}
function m(b,y,w,g){
if(b.removeEventListener){
b.removeEventListener(y,w,g||false)
}else{
if(b.detachEvent){
b.detachEvent("on"+y,w)
}}}
function h(b,x){
var y,g=x||{}
,v;
function w(){
return false
}
function k(){
return true
}
for(y in b){
if(!l[y]){
g[y]=b[y]
}}
if(!g.target){
g.target=g.srcElement||document
}
if(b&&c.test(b.type)&&b.pageX===v&&b.clientX!==v){
var z=g.target.ownerDocument||document;
var j=z.documentElement;
var q=z.body;
g.pageX=b.clientX+(j&&j.scrollLeft||q&&q.scrollLeft||0)-(j&&j.clientLeft||q&&q.clientLeft||0);
g.pageY=b.clientY+(j&&j.scrollTop||q&&q.scrollTop||0)-(j&&j.clientTop||q&&q.clientTop||0)
}
g.preventDefault=function(){
g.isDefaultPrevented=k;
if(b){
if(b.preventDefault){
b.preventDefault()
}else{
b.returnValue=false
}}};
g.stopPropagation=function(){
g.isPropagationStopped=k;
if(b){
if(b.stopPropagation){
b.stopPropagation()
}else{
b.cancelBubble=true
}}};
g.stopImmediatePropagation=function(){
g.isImmediatePropagationStopped=k;
g.stopPropagation()
};
if(!g.isDefaultPrevented){
g.isDefaultPrevented=w;
g.isPropagationStopped=w;
g.isImmediatePropagationStopped=w
}
if(typeof g.metaKey=="undefined"){
g.metaKey=false
}
return g
}
function u(k,q,b){
var v=k.document,w={
type:"ready"};
if(b.domLoaded){
q(w);
return
}
function y(){
if(!b.domLoaded){
b.domLoaded=true;
q(w)
}}
function g(){
if(v.readyState==="complete"||(v.readyState==="interactive"&&v.body)){
m(v,"readystatechange",g);
y()
}}
function x(){
try{
v.documentElement.doScroll("left")
}
catch(j){
setTimeout(x,0);
return
}
y()
}
if(v.addEventListener){
if(v.readyState==="complete"){
y()
}else{
d(k,"DOMContentLoaded",y)
}}else{
d(v,"readystatechange",g);
if(v.documentElement.doScroll&&k.self===k.top){
x()
}}
d(k,"load",y)
}
function p(){
var g=this,b={}
,v,q,y,w,x;
q=f+(+new Date()).toString(32);
w="onmouseenter" in document.documentElement;
y="onfocusin" in document.documentElement;
x={
mouseenter:"mouseover",mouseleave:"mouseout"};
v=1;
g.domLoaded=false;
g.events=b;
function k(O,B){
var T,A,z,W,j=b[B];
T=j&&j[O.type];
if(T){
for(A=0,z=T.length;
A<z;
A++){
W=T[A];
if(W&&W.func.call(W.scope,O)===false){
O.preventDefault()
}
if(O.isImmediatePropagationStopped()){
return
}}}}
g.bind=function(W,D,M,R){
var z,T,O,j,S,C,F,A=window;
function B(H){
k(h(H||A.event),z)
}
if(!W||W.nodeType===3||W.nodeType===8){
return
}
if(!W[q]){
z=v++;
W[q]=z;
b[z]={}
}else{
z=W[q]
}
R=R||W;
D=D.split(" ");
O=D.length;
while(O--){
j=D[O];
C=B;
S=F=false;
if(j==="DOMContentLoaded"){
j="ready"
}
if(g.domLoaded&&j==="ready"&&W.readyState=="complete"){
M.call(R,h({
type:j}
));
continue
}
if(!w){
S=x[j];
if(S){
C=function(H){
var Y,I;
Y=H.currentTarget;
I=H.relatedTarget;
if(I&&Y.contains){
I=Y.contains(I)
}else{
while(I&&I!==Y){
I=I.parentNode
}}
if(!I){
H=h(H||A.event);
H.type=H.type==="mouseout"?"mouseleave":"mouseenter";
H.target=Y;
k(H,z)
}}
}}
if(!y&&(j==="focusin"||j==="focusout")){
F=true;
S=j==="focusin"?"focus":"blur";
C=function(H){
H=h(H||A.event);
H.type=H.type==="focus"?"focusin":"focusout";
k(H,z)
}
}
T=b[z][j];
if(!T){
b[z][j]=T=[{
func:M,scope:R}
];
T.fakeName=S;
T.capture=F;
T.nativeHandler=C;
if(j==="ready"){
u(W,C,g)
}else{
d(W,S||j,C,F)
}}else{
if(j==="ready"&&g.domLoaded){
M({
type:j}
)
}else{
T.push({
func:M,scope:R}
)
}}}
W=T=0;
return M
};
g.unbind=function(W,D,M){
var z,O,A,R,j,T;
if(!W||W.nodeType===3||W.nodeType===8){
return g
}
z=W[q];
if(z){
T=b[z];
if(D){
D=D.split(" ");
A=D.length;
while(A--){
j=D[A];
O=T[j];
if(O){
if(M){
R=O.length;
while(R--){
if(O[R].func===M){
var C=O.nativeHandler;
var S=O.fakeName,F=O.capture;
O=O.slice(0,R).concat(O.slice(R+1));
O.nativeHandler=C;
O.fakeName=S;
O.capture=F;
T[j]=O
}}}
if(!M||O.length===0){
delete T[j];
m(W,O.fakeName||j,O.nativeHandler,O.capture)
}}}}else{
for(j in T){
O=T[j];
m(W,O.fakeName||j,O.nativeHandler,O.capture)
}
T={}
}
for(j in T){
return g
}
delete b[z];
try{
delete W[q]
}
catch(B){
W[q]=null
}}
return g
};
g.fire=function(T,z,j){
var O;
if(!T||T.nodeType===3||T.nodeType===8){
return g
}
j=h(null,j);
j.type=z;
j.target=T;
do{
O=T[q];
if(O){
k(j,O)
}
T=T.parentNode||T.ownerDocument||T.defaultView||T.parentWindow
}
while(T&&!j.isPropagationStopped());
return g
};
g.clean=function(O){
var z,j,T=g.unbind;
if(!O||O.nodeType===3||O.nodeType===8){
return g
}
if(O[q]){
T(O)
}
if(!O.getElementsByTagName){
O=O.document
}
if(O&&O.getElementsByTagName){
T(O);
j=O.getElementsByTagName("*");
z=j.length;
while(z--){
O=j[z];
if(O[q]){
T(O)
}}}
return g
};
g.destroy=function(){
b={}
};
g.cancel=function(j){
if(j){
j.preventDefault();
j.stopImmediatePropagation()
}
return false
}
}
p.Event=new p();
p.Event.bind(window,"ready",function(){}
);
return p
}
);
r("tinymce/dom/Sizzle",[],function(){
if(!window.jQuery){
throw new Error("Load jQuery first")
}
return jQuery.find
}
);
r("tinymce/Env",[],function(){
var h=navigator,v=h.userAgent;
var u,w,l,g,f,d,b,m,c,p;
u=window.opera&&window.opera.buildNumber;
c=/Android/.test(v);
w=/WebKit/.test(v);
l=!w&&!u&&(/MSIE/gi).test(v)&&(/Explorer/gi).test(h.appName);
l=l&&/MSIE (\w+)\./.exec(v)[1];
g=v.indexOf("Trident/")!=-1&&(v.indexOf("rv:")!=-1||h.appName.indexOf("Netscape")!=-1)?11:false;
f=(v.indexOf("Edge/")!=-1&&!l&&!g)?12:false;
l=l||g||f;
d=!w&&!g&&/Gecko/.test(v);
b=v.indexOf("Mac")!=-1;
m=/(iPad|iPhone)/.test(v);
p="FormData" in window&&"FileReader" in window&&"URL" in window&&!!URL.createObjectURL;
if(f){
w=false
}
var y=!m||p||v.match(/AppleWebKit\/(\d*)/)[1]>=534;
return{
opera:u,webkit:w,ie:l,gecko:d,mac:b,iOS:m,android:c,contentEditable:y,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:l!=8,range:window.getSelection&&"Range" in window,documentMode:l&&!f?(document.documentMode||7):10,fileApi:p}
}
);
r("tinymce/util/Arr",[],function(){
var h=Array.isArray||function(p){
return Object.prototype.toString.call(p)==="[object Array]"
};
function l(y){
var b=y,g,p;
if(!h(y)){
b=[];
for(g=0,p=y.length;
g<p;
g++){
b[g]=y[g]
}}
return b
}
function u(b,p,y){
var w,g;
if(!b){
return 0
}
y=y||b;
if(b.length!==s){
for(w=0,g=b.length;
w<g;
w++){
if(p.call(y,b[w],w,b)===false){
return 0
}}}else{
for(w in b){
if(b.hasOwnProperty(w)){
if(p.call(y,b[w],w,b)===false){
return 0
}}}}
return 1
}
function m(y,g){
var p=[];
u(y,function(w,b){
p.push(g(w,b,y))
}
);
return p
}
function d(p,g){
var y=[];
u(p,function(b){
if(!g||g(b)){
y.push(b)
}}
);
return y
}
function c(g,y){
var b,p;
if(g){
for(b=0,p=g.length;
b<p;
b++){
if(g[b]===y){
return b
}}}
return -1
}
function f(w,b,g,p){
var y=0;
if(arguments.length<3){
g=w[0];
y=1
}
for(;
y<w.length;
y++){
g=b.call(p,g,w[y],y)
}
return g
}
return{
isArray:h,toArray:l,each:u,map:m,filter:d,indexOf:c,reduce:f}
}
);
r("tinymce/util/Tools",["tinymce/Env","tinymce/util/Arr"],function(p,f){
var v=/^\s*|\s*$/g;
function l(k){
return(k===null||k===s)?"":(""+k).replace(v,"")
}
function u(x,k){
if(!k){
return x!==s
}
if(k=="array"&&f.isArray(x)){
return true
}
return typeof x==k
}
function c(k,j,q){
var x;
k=k||[];
j=j||",";
if(typeof k=="string"){
k=k.split(j)
}
q=q||{};
x=k.length;
while(x--){
q[k[x]]={}
}
return q
}
function m(B,k,z){
var W=this,x,j,T,O,q,A=0;
B=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(B);
T=B[3].match(/(^|\.)(\w+)$/i)[2];
j=W.createNS(B[3].replace(/\.\w+$/,""),z);
if(j[T]){
return
}
if(B[2]=="static"){
j[T]=k;
if(this.onCreate){
this.onCreate(B[2],B[3],j[T])
}
return
}
if(!k[T]){
k[T]=function(){};
A=1
}
j[T]=k[T];
W.extend(j[T].prototype,k);
if(B[5]){
x=W.resolve(B[5]).prototype;
O=B[5].match(/\.(\w+)$/i)[1];
q=j[T];
if(A){
j[T]=function(){
return x[O].apply(this,arguments)
}
}else{
j[T]=function(){
this.parent=x[O];
return q.apply(this,arguments)
}
}
j[T].prototype[T]=j[T];
W.each(x,function(C,D){
j[T].prototype[D]=x[D]
}
);
W.each(k,function(C,D){
if(x[D]){
j[T].prototype[D]=function(){
this.parent=x[D];
return C.apply(this,arguments)
}
}else{
if(D!=T){
j[T].prototype[D]=C
}}}
)
}
W.each(k["static"],function(C,D){
j[T][D]=C
}
)
}
function g(O,z){
var j,k,q,x=arguments,T;
for(j=1,k=x.length;
j<k;
j++){
z=x[j];
for(q in z){
if(z.hasOwnProperty(q)){
T=z[q];
if(T!==s){
O[q]=T
}}}}
return O
}
function b(q,x,j,k){
k=k||this;
if(q){
if(j){
q=q[j]
}
f.each(q,function(T,z){
if(x.call(k,T,z,j)===false){
return false
}
b(T,x,j,k)
}
)
}}
function d(j,q){
var x,k;
q=q||window;
j=j.split(".");
for(x=0;
x<j.length;
x++){
k=j[x];
if(!q[k]){
q[k]={}
}
q=q[k]
}
return q
}
function w(j,q){
var x,k;
q=q||window;
j=j.split(".");
for(x=0,k=j.length;
x<k;
x++){
q=q[j[x]];
if(!q){
break
}}
return q
}
function y(k,x){
if(!k||u(k,"array")){
return k
}
return f.map(k.split(x||","),l)
}
function h(x){
var k=p.cacheSuffix;
if(k){
x+=(x.indexOf("?")===-1?"?":"&")+k
}
return x
}
return{
trim:l,isArray:f.isArray,is:u,toArray:f.toArray,makeMap:c,each:f.each,map:f.map,grep:f.filter,inArray:f.indexOf,extend:g,create:m,walk:b,createNS:d,resolve:w,explode:y,_addCacheSuffix:h}
}
);
r("tinymce/dom/DomQuery",["tinymce/dom/EventUtils","tinymce/dom/Sizzle","tinymce/util/Tools","tinymce/Env"],function(w,g,m,f){
var L=document,k=Array.prototype.push,C=Array.prototype.slice;
var A=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/;
var G=w.Event,p;
var j=m.makeMap("children,contents,next,prev");
function c(N){
return typeof N!=="undefined"
}
function z(N){
return typeof N==="string"
}
function R(N){
return N&&N==N.window
}
function B(U,P){
var K,J,N;
P=P||L;
N=P.createElement("div");
K=P.createDocumentFragment();
N.innerHTML=U;
while((J=N.firstChild)){
K.appendChild(J)
}
return K
}
function O(N,J,K,P){
var U;
if(z(J)){
J=B(J,T(N[0]))
}else{
if(J.length&&!J.nodeType){
J=y.makeArray(J);
if(P){
for(U=J.length-1;
U>=0;
U--){
O(N,J[U],K,P)
}}else{
for(U=0;
U<J.length;
U++){
O(N,J[U],K,P)
}}
return N
}}
if(J.nodeType){
U=N.length;
while(U--){
K.call(N[U],J)
}}
return N
}
function d(P,N){
return P&&N&&(" "+P.className+" ").indexOf(" "+N+" ")!==-1
}
function q(J,K,P){
var N,U;
K=y(K)[0];
J.each(function(){
var Q=this;
if(!P||N!=Q.parentNode){
N=Q.parentNode;
U=K.cloneNode(false);
Q.parentNode.insertBefore(U,Q);
U.appendChild(Q)
}else{
U.appendChild(Q)
}}
);
return J
}
var l=m.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");
var S=m.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," ");
var H={
"for":"htmlFor","class":"className",readonly:"readOnly"};
var u={
"float":"cssFloat"};
var Y={}
,E={};
function y(N,P){
return new y.fn.init(N,P)
}
function F(P,U){
var N;
if(U.indexOf){
return U.indexOf(P)
}
N=U.length;
while(N--){
if(U[N]===P){
return N
}}
return -1
}
var I=/^\s*|\s*$/g;
function D(N){
return(N===null||N===p)?"":(""+N).replace(I,"")
}
function b(Q,V){
var J,P,N,U,K;
if(Q){
J=Q.length;
if(J===U){
for(P in Q){
if(Q.hasOwnProperty(P)){
K=Q[P];
if(V.call(K,P,K)===false){
break
}}}}else{
for(N=0;
N<J;
N++){
K=Q[N];
if(V.call(K,N,K)===false){
break
}}}}
return Q
}
function x(U,P){
var N=[];
b(U,function(J,K){
if(P(K,J)){
N.push(K)
}}
);
return N
}
function T(N){
if(!N){
return L
}
if(N.nodeType==9){
return N
}
return N.ownerDocument
}
y.fn=y.prototype={
constructor:y,selector:"",context:null,length:0,init:function(N,J){
var P=this,U,K;
if(!N){
return P
}
if(N.nodeType){
P.context=P[0]=N;
P.length=1;
return P
}
if(J&&J.nodeType){
P.context=J
}else{
if(J){
return y(N).attr(J)
}
P.context=J=document
}
if(z(N)){
P.selector=N;
if(N.charAt(0)==="<"&&N.charAt(N.length-1)===">"&&N.length>=3){
U=[null,N,null]
}else{
U=A.exec(N)
}
if(U){
if(U[1]){
K=B(N,T(J)).firstChild;
while(K){
k.call(P,K);
K=K.nextSibling
}}else{
K=T(J).getElementById(U[2]);
if(!K){
return P
}
if(K.id!==U[2]){
return P.find(N)
}
P.length=1;
P[0]=K
}}else{
return y(J).find(N)
}}else{
this.add(N,false)
}
return P
}
,toArray:function(){
return m.toArray(this)
}
,add:function(U,K){
var P=this,N,J;
if(z(U)){
return P.add(y(U))
}
if(K!==false){
N=y.unique(P.toArray().concat(y.makeArray(U)));
P.length=N.length;
for(J=0;
J<N.length;
J++){
P[J]=N[J]
}}else{
k.apply(P,y.makeArray(U))
}
return P
}
,attr:function(P,J){
var N=this,U;
if(typeof P==="object"){
b(P,function(K,Q){
N.attr(K,Q)
}
)
}else{
if(c(J)){
this.each(function(){
var K;
if(this.nodeType===1){
K=Y[P];
if(K&&K.set){
K.set(this,J);
return
}
if(J===null){
this.removeAttribute(P,2)
}else{
this.setAttribute(P,J,2)
}}}
)
}else{
if(N[0]&&N[0].nodeType===1){
U=Y[P];
if(U&&U.get){
return U.get(N[0],P)
}
if(S[P]){
return N.prop(P)?P:p
}
J=N[0].getAttribute(P,2);
if(J===null){
J=p
}}
return J
}}
return N
}
,removeAttr:function(N){
return this.attr(N,null)
}
,prop:function(P,U){
var N=this;
P=H[P]||P;
if(typeof P==="object"){
b(P,function(J,K){
N.prop(J,K)
}
)
}else{
if(c(U)){
this.each(function(){
if(this.nodeType==1){
this[P]=U
}}
)
}else{
if(N[0]&&N[0].nodeType&&P in N[0]){
return N[0][P]
}
return U
}}
return N
}
,css:function(U,V){
var P=this,Z,Q;
function K(X){
return X.replace(/-(\D)/g,function(_t,_e){
return _e.toUpperCase()
}
)
}
function N(X){
return X.replace(/[A-Z]/g,function(_e){
return"-"+_e
}
)
}
if(typeof U==="object"){
b(U,function(X,_e){
P.css(X,_e)
}
)
}else{
if(c(V)){
U=K(U);
if(typeof V==="number"&&!l[U]){
V+="px"
}
P.each(function(){
var _e=this.style;
Q=E[U];
if(Q&&Q.set){
Q.set(this,V);
return
}
try{
this.style[u[U]||U]=V
}
catch(X){}
if(V===null||V===""){
if(_e.removeProperty){
_e.removeProperty(N(U))
}else{
_e.removeAttribute(U)
}}}
)
}else{
Z=P[0];
Q=E[U];
if(Q&&Q.get){
return Q.get(Z)
}
if(Z.ownerDocument.defaultView){
try{
return Z.ownerDocument.defaultView.getComputedStyle(Z,null).getPropertyValue(N(U))
}
catch(J){
return p
}}else{
if(Z.currentStyle){
return Z.currentStyle[K(U)]
}}}}
return P
}
,remove:function(){
var N=this,U,P=this.length;
while(P--){
U=N[P];
G.clean(U);
if(U.parentNode){
U.parentNode.removeChild(U)
}}
return this
}
,empty:function(){
var N=this,U,P=this.length;
while(P--){
U=N[P];
while(U.firstChild){
U.removeChild(U.firstChild)
}}
return this
}
,html:function(J){
var N=this,U;
if(c(J)){
U=N.length;
try{
while(U--){
N[U].innerHTML=J
}}
catch(P){
y(N[U]).empty().append(J)
}
return N
}
return N[0]?N[0].innerHTML:""
}
,text:function(U){
var N=this,P;
if(c(U)){
P=N.length;
while(P--){
if("innerText" in N[P]){
N[P].innerText=U
}else{
N[0].textContent=U
}}
return N
}
return N[0]?(N[0].innerText||N[0].textContent):""
}
,append:function(){
return O(this,arguments,function(N){
if(this.nodeType===1){
this.appendChild(N)
}}
)
}
,prepend:function(){
return O(this,arguments,function(N){
if(this.nodeType===1){
this.insertBefore(N,this.firstChild)
}}
,true)
}
,before:function(){
var N=this;
if(N[0]&&N[0].parentNode){
return O(N,arguments,function(P){
this.parentNode.insertBefore(P,this)
}
)
}
return N
}
,after:function(){
var N=this;
if(N[0]&&N[0].parentNode){
return O(N,arguments,function(P){
this.parentNode.insertBefore(P,this.nextSibling)
}
,true)
}
return N
}
,appendTo:function(N){
y(N).append(this);
return this
}
,prependTo:function(N){
y(N).prepend(this);
return this
}
,replaceWith:function(N){
return this.before(N).remove()
}
,wrap:function(N){
return q(this,N)
}
,wrapAll:function(N){
return q(this,N,true)
}
,wrapInner:function(N){
this.each(function(){
y(this).contents().wrapAll(N)
}
);
return this
}
,unwrap:function(){
return this.parent().each(function(){
y(this).replaceWith(this.childNodes)
}
)
}
,clone:function(){
var N=[];
this.each(function(){
N.push(this.cloneNode(true))
}
);
return y(N)
}
,addClass:function(N){
return this.toggleClass(N,true)
}
,removeClass:function(N){
return this.toggleClass(N,false)
}
,toggleClass:function(P,U){
var N=this;
if(typeof P!="string"){
return N
}
if(P.indexOf(" ")!==-1){
b(P.split(" "),function(){
N.toggleClass(this,U)
}
)
}else{
N.each(function(J,Q){
var K,V;
V=d(Q,P);
if(V!==U){
K=Q.className;
if(V){
Q.className=D((" "+K+" ").replace(" "+P+" "," "))
}else{
Q.className+=K?" "+P:P
}}}
)
}
return N
}
,hasClass:function(N){
return d(this[0],N)
}
,each:function(N){
return b(this,N)
}
,on:function(N,P){
return this.each(function(){
G.bind(this,N,P)
}
)
}
,off:function(N,P){
return this.each(function(){
G.unbind(this,N,P)
}
)
}
,trigger:function(N){
return this.each(function(){
if(typeof N=="object"){
G.fire(this,N.type,N)
}else{
G.fire(this,N)
}}
)
}
,show:function(){
return this.css("display","")
}
,hide:function(){
return this.css("display","none")
}
,slice:function(){
return new y(C.apply(this,arguments))
}
,eq:function(N){
return N===-1?this.slice(N):this.slice(N,+N+1)
}
,first:function(){
return this.eq(0)
}
,last:function(){
return this.eq(-1)
}
,find:function(N){
var J,P,U=[];
for(J=0,P=this.length;
J<P;
J++){
y.find(N,this[J],U)
}
return y(U)
}
,filter:function(N){
if(typeof N=="function"){
return y(x(this.toArray(),function(U,P){
return N(P,U)
}
))
}
return y(y.filter(N,this.toArray()))
}
,closest:function(P){
var N=[];
if(P instanceof y){
P=P[0]
}
this.each(function(U,J){
while(J){
if(typeof P=="string"&&y(J).is(P)){
N.push(J);
break
}else{
if(J==P){
N.push(J);
break
}}
J=J.parentNode
}}
);
return y(N)
}
,offset:function(J){
var V,U,P;
var N=0,Q=0,K;
if(!J){
V=this[0];
if(V){
U=V.ownerDocument;
P=U.documentElement;
if(V.getBoundingClientRect){
K=V.getBoundingClientRect();
N=K.left+(P.scrollLeft||U.body.scrollLeft)-P.clientLeft;
Q=K.top+(P.scrollTop||U.body.scrollTop)-P.clientTop
}}
return{
left:N,top:Q}
}
return this.css(J)
}
,push:k,sort:[].sort,splice:[].splice};
m.extend(y,{
extend:m.extend,makeArray:function(N){
if(R(N)||N.nodeType){
return[N]
}
return m.toArray(N)
}
,inArray:F,isArray:m.isArray,each:b,trim:D,grep:x,find:g,expr:g.selectors,unique:g.uniqueSort,text:g.getText,contains:g.contains,filter:function(J,N,U){
var P=N.length;
if(U){
J=":not("+J+")"
}
while(P--){
if(N[P].nodeType!=1){
N.splice(P,1)
}}
if(N.length===1){
N=y.find.matchesSelector(N[0],J)?[N[0]]:[]
}else{
N=y.find.matches(J,N)
}
return N
}}
);
function W(P,K,J){
var N=[],U=P[K];
if(typeof J!="string"&&J instanceof y){
J=J[0]
}
while(U&&U.nodeType!==9){
if(J!==s){
if(U===J){
break
}
if(typeof J=="string"&&y(U).is(J)){
break
}}
if(U.nodeType===1){
N.push(U)
}
U=U[K]
}
return N
}
function M(J,U,P,K){
var N=[];
if(K instanceof y){
K=K[0]
}
for(;
J;
J=J[U]){
if(P&&J.nodeType!==P){
continue
}
if(K!==s){
if(J===K){
break
}
if(typeof K=="string"&&y(J).is(K)){
break
}}
N.push(J)
}
return N
}
function h(U,P,N){
for(U=U[P];
U;
U=U[P]){
if(U.nodeType==N){
return U
}}
return null
}
b({
parent:function(P){
var N=P.parentNode;
return N&&N.nodeType!==11?N:null
}
,parents:function(N){
return W(N,"parentNode")
}
,next:function(N){
return h(N,"nextSibling",1)
}
,prev:function(N){
return h(N,"previousSibling",1)
}
,children:function(N){
return M(N.firstChild,"nextSibling",1)
}
,contents:function(N){
return m.toArray((N.nodeName==="iframe"?N.contentDocument||N.contentWindow.document:N).childNodes)
}}
,function(N,P){
y.fn[N]=function(J){
var K=this,U=[];
K.each(function(){
var Q=P.call(U,this,J,U);
if(Q){
if(y.isArray(Q)){
U.push.apply(U,Q)
}else{
U.push(Q)
}}}
);
if(this.length>1){
if(!j[N]){
U=y.unique(U)
}
if(N.indexOf("parents")===0){
U=U.reverse()
}}
U=y(U);
if(J){
return U.filter(J)
}
return U
}
}
);
b({
parentsUntil:function(N,P){
return W(N,"parentNode",P)
}
,nextUntil:function(N,P){
return M(N,"nextSibling",1,P).slice(1)
}
,prevUntil:function(N,P){
return M(N,"previousSibling",1,P).slice(1)
}}
,function(N,P){
y.fn[N]=function(J,Q){
var K=this,U=[];
K.each(function(){
var V=P.call(U,this,J,U);
if(V){
if(y.isArray(V)){
U.push.apply(U,V)
}else{
U.push(V)
}}}
);
if(this.length>1){
U=y.unique(U);
if(N.indexOf("parents")===0||N==="prevUntil"){
U=U.reverse()
}}
U=y(U);
if(Q){
return U.filter(Q)
}
return U
}
}
);
y.fn.is=function(N){
return !!N&&this.filter(N).length>0
};
y.fn.init.prototype=y.fn;
y.overrideDefaults=function(U){
var P;
function N(J,K){
P=P||U();
if(arguments.length===0){
J=P.element
}
if(!K){
K=P.context
}
return new N.fn.init(J,K)
}
y.extend(N,this);
return N
};
function v(U,P,N){
b(N,function(J,K){
U[J]=U[J]||{};
U[J][P]=K
}
)
}
if(f.ie&&f.ie<8){
v(Y,"get",{
maxlength:function(P){
var N=P.maxLength;
if(N===2147483647){
return p
}
return N
}
,size:function(P){
var N=P.size;
if(N===20){
return p
}
return N
}
,"class":function(N){
return N.className
}
,style:function(P){
var N=P.style.cssText;
if(N.length===0){
return p
}
return N
}}
);
v(Y,"set",{
"class":function(P,N){
P.className=N
}
,style:function(P,N){
P.style.cssText=N
}}
)
}
if(f.ie&&f.ie<9){
u["float"]="styleFloat";
v(E,"set",{
opacity:function(U,P){
var N=U.style;
if(P===null||P===""){
N.removeAttribute("filter")
}else{
N.zoom=1;
N.filter="alpha(opacity="+(P*100)+")"
}}}
)
}
y.attrHooks=Y;
y.cssHooks=E;
return y
}
);
r("tinymce/html/Styles",[],function(){
return function(m,p){
var w=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,g=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,c=/\s*([^:]+):\s*([^;]+);?/g,k=/\s+$/,f,y,l={}
,b,u,h,v="\uFEFF";
m=m||{};
if(p){
u=p.getValidStyles();
h=p.getInvalidStyles()
}
b=("\\\" \\' \\; \\: ; : "+v).split(" ");
for(y=0;
y<b.length;
y++){
l[b[y]]=v+y;
l[v+y]=b[y]
}
function d(q,T,z,x){
function j(O){
O=parseInt(O,10).toString(16);
return O.length>1?O:"0"+O
}
return"#"+j(T)+j(z)+j(x)
}
return{
toHex:function(x){
return x.replace(w,d)
}
,parse:function(A){
var F={}
,T,q,D,O,C=m.url_converter;
var S=m.url_converter_scope||this;
function z(E,N,H){
var L,I,R,G;
L=F[E+"-top"+N];
if(!L){
return
}
I=F[E+"-right"+N];
if(!I){
return
}
R=F[E+"-bottom"+N];
if(!R){
return
}
G=F[E+"-left"+N];
if(!G){
return
}
var Y=[L,I,R,G];
y=Y.length-1;
while(y--){
if(Y[y]!==Y[y+1]){
break
}}
if(y>-1&&H){
return
}
F[E+N]=y==-1?Y[0]:Y.join(" ");
delete F[E+"-top"+N];
delete F[E+"-right"+N];
delete F[E+"-bottom"+N];
delete F[E+"-left"+N]
}
function B(H){
var I=F[H],R;
if(!I){
return
}
I=I.split(" ");
R=I.length;
while(R--){
if(I[R]!==I[0]){
return false
}}
F[H]=I[0];
return true
}
function M(I,H,R,Y){
if(!B(H)){
return
}
if(!B(R)){
return
}
if(!B(Y)){
return
}
F[I]=F[H]+" "+F[R]+" "+F[Y];
delete F[H];
delete F[R];
delete F[Y]
}
function W(R){
O=true;
return l[R]
}
function x(H,R){
if(O){
H=H.replace(/\uFEFF[0-9]/g,function(I){
return l[I]
}
)
}
if(!R){
H=H.replace(/\\([\'\";:])/g,"$1")
}
return H
}
function j(H,R,E,Y,L,I){
L=L||I;
if(L){
L=x(L);
return"'"+L.replace(/\'/g,"\\'")+"'"
}
R=x(R||E||Y);
if(!m.allow_script_urls){
var G=R.replace(/[\s\r\n]+/,"");
if(/(java|vb)script:/i.test(G)){
return""
}
if(!m.allow_svg_data_urls&&/^data:image\/svg/i.test(G)){
return""
}}
if(C){
R=C.call(S,R,"style")
}
return"url('"+R.replace(/\'/g,"\\'")+"')"
}
if(A){
A=A.replace(/[\u0000-\u001F]/g,"");
A=A.replace(/\\[\"\';:\uFEFF]/g,W).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(R){
return R.replace(/[;:]/g,W)
}
);
while((T=c.exec(A))){
q=T[1].replace(k,"").toLowerCase();
D=T[2].replace(k,"");
D=D.replace(/\\[0-9a-f]+/g,function(R){
return String.fromCharCode(parseInt(R.substr(1),16))
}
);
if(q&&D.length>0){
if(!m.allow_script_urls&&(q=="behavior"||/expression\s*\(|\/\*|\*\//.test(D))){
continue
}
if(q==="font-weight"&&D==="700"){
D="bold"
}else{
if(q==="color"||q==="background-color"){
D=D.toLowerCase()
}}
D=D.replace(w,d);
D=D.replace(g,j);
F[q]=O?x(D,true):D
}
c.lastIndex=T.index+T[0].length
}
z("border","",true);
z("border","-width");
z("border","-color");
z("border","-style");
z("padding","");
z("margin","");
M("border","border-width","border-style","border-color");
if(F.border==="medium none"){
delete F.border
}
if(F["border-image"]==="none"){
delete F["border-image"]
}}
return F
}
,serialize:function(T,x){
var z="",j,O;
function q(B){
var S,C,W,D;
S=u[B];
if(S){
for(C=0,W=S.length;
C<W;
C++){
B=S[C];
D=T[B];
if(D!==f&&D.length>0){
z+=(z.length>0?" ":"")+B+": "+D+";"
}}}}
function A(B,W){
var C;
C=h["*"];
if(C&&C[B]){
return false
}
C=h[W];
if(C&&C[B]){
return false
}
return true
}
if(x&&u){
q("*");
q(x)
}else{
for(j in T){
O=T[j];
if(O!==f&&O.length>0){
if(!h||A(j,x)){
z+=(z.length>0?" ":"")+j+": "+O+";"
}}}}
return z
}}
}
}
);
r("tinymce/dom/TreeWalker",[],function(){
return function(l,h){
var c=l;
function d(g,u,m,y){
var p,f;
if(g){
if(!y&&g[u]){
return g[u]
}
if(g!=h){
p=g[m];
if(p){
return p
}
for(f=g.parentNode;
f&&f!=h;
f=f.parentNode){
p=f[m];
if(p){
return p
}}}}}
this.current=function(){
return c
};
this.next=function(u){
c=d(c,"firstChild","nextSibling",u);
return c
};
this.prev=function(u){
c=d(c,"lastChild","previousSibling",u);
return c
}
}
}
);
r("tinymce/dom/Range",["tinymce/util/Tools"],function(h){
function l(c){
var f=this,u=c.doc,_e=0,I=1,b=2,H=true,Z=false,_a="startOffset",g="startContainer",Q="endContainer",S="endOffset",w=h.extend,x=c.nodeIndex;
function B(){
return u.createDocumentFragment()
}
function z(_o,_i){
M(H,_o,_i)
}
function O(_o,_i){
M(Z,_o,_i)
}
function p(_i){
z(_i.parentNode,x(_i))
}
function L(_i){
z(_i.parentNode,x(_i)+1)
}
function N(_i){
O(_i.parentNode,x(_i))
}
function A(_i){
O(_i.parentNode,x(_i)+1)
}
function F(_i){
if(_i){
f[Q]=f[g];
f[S]=f[_a]
}else{
f[g]=f[Q];
f[_a]=f[S]
}
f.collapsed=H
}
function C(_i){
p(_i);
A(_i)
}
function Y(_i){
z(_i,0);
O(_i,_i.nodeType===1?_i.childNodes.length:_i.nodeValue.length)
}
function W(_r,_i){
var _c=f[g],_n=f[_a],_l=f[Q],_o=f[S],_h=_i.startContainer,_u=_i.startOffset,_s=_i.endContainer,_d=_i.endOffset;
if(_r===0){
return E(_c,_n,_h,_u)
}
if(_r===1){
return E(_l,_o,_h,_u)
}
if(_r===2){
return E(_l,_o,_s,_d)
}
if(_r===3){
return E(_c,_n,_s,_d)
}}
function j(){
v(b)
}
function G(){
return v(_e)
}
function d(){
return v(I)
}
function R(_r){
var _o=this[g],_i=this[_a],_s,_n;
if((_o.nodeType===3||_o.nodeType===4)&&_o.nodeValue){
if(!_i){
_o.parentNode.insertBefore(_r,_o)
}else{
if(_i>=_o.nodeValue.length){
c.insertAfter(_r,_o)
}else{
_s=_o.splitText(_i);
_o.parentNode.insertBefore(_r,_s)
}}}else{
if(_o.childNodes.length>0){
_n=_o.childNodes[_i]
}
if(_n){
_o.insertBefore(_r,_n)
}else{
if(_o.nodeType==3){
c.insertAfter(_r,_o)
}else{
_o.appendChild(_r)
}}}}
function J(_o){
var _i=f.extractContents();
f.insertNode(_o);
_o.appendChild(_i);
f.selectNode(_o)
}
function P(){
return w(new l(c),{
startContainer:f[g],startOffset:f[_a],endContainer:f[Q],endOffset:f[S],collapsed:f.collapsed,commonAncestorContainer:f.commonAncestorContainer}
)
}
function K(_i,_o){
var _n;
if(_i.nodeType==3){
return _i
}
if(_o<0){
return _i
}
_n=_i.firstChild;
while(_n&&_o>0){
--_o;
_n=_n.nextSibling
}
if(_n){
return _n
}
return _i
}
function k(){
return(f[g]==f[Q]&&f[_a]==f[S])
}
function E(_s,_h,_o,_r){
var _l,_n,_i,_c,_u,_d;
if(_s==_o){
if(_h==_r){
return 0
}
if(_h<_r){
return -1
}
return 1
}
_l=_o;
while(_l&&_l.parentNode!=_s){
_l=_l.parentNode
}
if(_l){
_n=0;
_i=_s.firstChild;
while(_i!=_l&&_n<_h){
_n++;
_i=_i.nextSibling
}
if(_h<=_n){
return -1
}
return 1
}
_l=_s;
while(_l&&_l.parentNode!=_o){
_l=_l.parentNode
}
if(_l){
_n=0;
_i=_o.firstChild;
while(_i!=_l&&_n<_r){
_n++;
_i=_i.nextSibling
}
if(_n<_r){
return -1
}
return 1
}
_c=c.findCommonAncestor(_s,_o);
_u=_s;
while(_u&&_u.parentNode!=_c){
_u=_u.parentNode
}
if(!_u){
_u=_c
}
_d=_o;
while(_d&&_d.parentNode!=_c){
_d=_d.parentNode
}
if(!_d){
_d=_c
}
if(_u==_d){
return 0
}
_i=_c.firstChild;
while(_i){
if(_i==_u){
return -1
}
if(_i==_d){
return 1
}
_i=_i.nextSibling
}}
function M(_o,_r,_s){
var _i,_n;
if(_o){
f[g]=_r;
f[_a]=_s
}else{
f[Q]=_r;
f[S]=_s
}
_i=f[Q];
while(_i.parentNode){
_i=_i.parentNode
}
_n=f[g];
while(_n.parentNode){
_n=_n.parentNode
}
if(_n==_i){
if(E(f[g],f[_a],f[Q],f[S])>0){
f.collapse(_o)
}}else{
f.collapse(_o)
}
f.collapsed=k();
f.commonAncestorContainer=c.findCommonAncestor(f[g],f[Q])
}
function v(_c){
var _l,_s=0,_u=0,_o,_h,_n,_r,_i,_d;
if(f[g]==f[Q]){
return m(_c)
}
for(_l=f[Q],_o=_l.parentNode;
_o;
_l=_o,_o=_o.parentNode){
if(_o==f[g]){
return T(_l,_c)
}
++_s
}
for(_l=f[g],_o=_l.parentNode;
_o;
_l=_o,_o=_o.parentNode){
if(_o==f[Q]){
return _t(_l,_c)
}
++_u
}
_h=_u-_s;
_n=f[g];
while(_h>0){
_n=_n.parentNode;
_h--
}
_r=f[Q];
while(_h<0){
_r=_r.parentNode;
_h++
}
for(_i=_n.parentNode,_d=_r.parentNode;
_i!=_d;
_i=_i.parentNode,_d=_d.parentNode){
_n=_i;
_r=_d
}
return q(_n,_r,_c)
}
function m(_l){
var _d,_u,_i,_n,_s,_c,_r,_o,_h;
if(_l!=b){
_d=B()
}
if(f[_a]==f[S]){
return _d
}
if(f[g].nodeType==3){
_u=f[g].nodeValue;
_i=_u.substring(f[_a],f[S]);
if(_l!=I){
_n=f[g];
_o=f[_a];
_h=f[S]-f[_a];
if(_o===0&&_h>=_n.nodeValue.length-1){
_n.parentNode.removeChild(_n)
}else{
_n.deleteData(_o,_h)
}
f.collapse(H)
}
if(_l==b){
return
}
if(_i.length>0){
_d.appendChild(u.createTextNode(_i))
}
return _d
}
_n=K(f[g],f[_a]);
_s=f[S]-f[_a];
while(_n&&_s>0){
_c=_n.nextSibling;
_r=D(_n,_l);
if(_d){
_d.appendChild(_r)
}
--_s;
_n=_c
}
if(_l!=I){
f.collapse(H)
}
return _d
}
function T(_c,_r){
var _l,_h,_o,_i,_s,_n;
if(_r!=b){
_l=B()
}
_h=y(_c,_r);
if(_l){
_l.appendChild(_h)
}
_o=x(_c);
_i=_o-f[_a];
if(_i<=0){
if(_r!=I){
f.setEndBefore(_c);
f.collapse(Z)
}
return _l
}
_h=_c.previousSibling;
while(_i>0){
_s=_h.previousSibling;
_n=D(_h,_r);
if(_l){
_l.insertBefore(_n,_l.firstChild)
}
--_i;
_h=_s
}
if(_r!=I){
f.setEndBefore(_c);
f.collapse(Z)
}
return _l
}
function _t(_h,_r){
var _c,_o,_l,_i,_s,_n;
if(_r!=b){
_c=B()
}
_l=V(_h,_r);
if(_c){
_c.appendChild(_l)
}
_o=x(_h);
++_o;
_i=f[S]-_o;
_l=_h.nextSibling;
while(_l&&_i>0){
_s=_l.nextSibling;
_n=D(_l,_r);
if(_c){
_c.appendChild(_n)
}
--_i;
_l=_s
}
if(_r!=I){
f.setStartAfter(_h);
f.collapse(H)
}
return _c
}
function q(_r,_i,_c){
var _o,_u,_h,_l,_n,_d,_s;
if(_c!=b){
_u=B()
}
_o=V(_r,_c);
if(_u){
_u.appendChild(_o)
}
_h=x(_r);
_l=x(_i);
++_h;
_n=_l-_h;
_d=_r.nextSibling;
while(_n>0){
_s=_d.nextSibling;
_o=D(_d,_c);
if(_u){
_u.appendChild(_o)
}
_d=_s;
--_n
}
_o=y(_i,_c);
if(_u){
_u.appendChild(_o)
}
if(_c!=I){
f.setStartAfter(_r);
f.collapse(H)
}
return _u
}
function y(_l,_c){
var _n=K(f[Q],f[S]-1),_d,_h;
var _r,_i,_o,_s=_n!=f[Q];
if(_n==_l){
return U(_n,_s,Z,_c)
}
_d=_n.parentNode;
_h=U(_d,Z,Z,_c);
while(_d){
while(_n){
_r=_n.previousSibling;
_i=U(_n,_s,Z,_c);
if(_c!=b){
_h.insertBefore(_i,_h.firstChild)
}
_s=H;
_n=_r
}
if(_d==_l){
return _h
}
_n=_d.previousSibling;
_d=_d.parentNode;
_o=U(_d,Z,Z,_c);
if(_c!=b){
_o.appendChild(_h)
}
_h=_o
}}
function V(_l,_c){
var _s=K(f[g],f[_a]),_r=_s!=f[g];
var _d,_h,_n,_i,_o;
if(_s==_l){
return U(_s,_r,H,_c)
}
_d=_s.parentNode;
_h=U(_d,Z,H,_c);
while(_d){
while(_s){
_n=_s.nextSibling;
_i=U(_s,_r,H,_c);
if(_c!=b){
_h.appendChild(_i)
}
_r=H;
_s=_n
}
if(_d==_l){
return _h
}
_s=_d.nextSibling;
_d=_d.parentNode;
_o=U(_d,Z,H,_c);
if(_c!=b){
_o.appendChild(_h)
}
_h=_o
}}
function U(_i,_r,_c,_d){
var _s,_n,_h,_o,_l;
if(_r){
return D(_i,_d)
}
if(_i.nodeType==3){
_s=_i.nodeValue;
if(_c){
_o=f[_a];
_n=_s.substring(_o);
_h=_s.substring(0,_o)
}else{
_o=f[S];
_n=_s.substring(0,_o);
_h=_s.substring(_o)
}
if(_d!=I){
_i.nodeValue=_h
}
if(_d==b){
return
}
_l=c.clone(_i,Z);
_l.nodeValue=_n;
return _l
}
if(_d==b){
return
}
return c.clone(_i,Z)
}
function D(_o,_i){
if(_i!=b){
return _i==I?c.clone(_o,H):_o
}
_o.parentNode.removeChild(_o)
}
function X(){
return c.create("body",null,d()).outerText
}
w(f,{
startContainer:u,startOffset:0,endContainer:u,endOffset:0,collapsed:H,commonAncestorContainer:u,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:z,setEnd:O,setStartBefore:p,setStartAfter:L,setEndBefore:N,setEndAfter:A,collapse:F,selectNode:C,selectNodeContents:Y,compareBoundaryPoints:W,deleteContents:j,extractContents:G,cloneContents:d,insertNode:R,surroundContents:J,cloneRange:P,toStringIE:X}
);
return f
}
l.prototype.toString=function(){
return this.toStringIE()
};
return l
}
);
r("tinymce/html/Entities",["tinymce/util/Tools"],function(d){
var u=d.makeMap;
var h,y,f,v=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,l=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=/[<>&\"\']/g,m=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,w={
128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"};
y={
'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","\u0060":"&#96;"};
f={
"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};
function b(k){
var x;
x=document.createElement("div");
x.innerHTML=k;
return x.textContent||x.innerText||k
}
function p(x,z){
var q,j,k,T={};
if(x){
x=x.split(",");
z=z||10;
for(q=0;
q<x.length;
q+=2){
j=String.fromCharCode(parseInt(x[q],z));
if(!y[j]){
k="&"+x[q+1]+";";
T[j]=k;
T[k]=j
}}
return T
}}
h=p("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);
var c={
encodeRaw:function(x,k){
return x.replace(k?v:l,function(q){
return y[q]||q
}
)
}
,encodeAllRaw:function(k){
return(""+k).replace(g,function(x){
return y[x]||x
}
)
}
,encodeNumeric:function(x,k){
return x.replace(k?v:l,function(q){
if(q.length>1){
return"&#"+(((q.charCodeAt(0)-55296)*1024)+(q.charCodeAt(1)-56320)+65536)+";"
}
return y[q]||"&#"+q.charCodeAt(0)+";"
}
)
}
,encodeNamed:function(q,k,x){
x=x||h;
return q.replace(k?v:l,function(j){
return y[j]||x[j]||j
}
)
}
,getEncodeFunc:function(k,j){
j=p(j)||h;
function x(T,z){
return T.replace(z?v:l,function(O){
return y[O]||j[O]||"&#"+O.charCodeAt(0)+";"||O
}
)
}
function q(T,z){
return c.encodeNamed(T,z,j)
}
k=u(k.replace(/\+/g,","));
if(k.named&&k.numeric){
return x
}
if(k.named){
if(j){
return q
}
return c.encodeNamed
}
if(k.numeric){
return c.encodeNumeric
}
return c.encodeRaw
}
,decode:function(k){
return k.replace(m,function(q,x){
if(x){
if(x.charAt(0).toLowerCase()==="x"){
x=parseInt(x.substr(1),16)
}else{
x=parseInt(x,10)
}
if(x>65535){
x-=65536;
return String.fromCharCode(55296+(x>>10),56320+(x&1023))
}
return w[x]||String.fromCharCode(x)
}
return f[q]||h[q]||b(q)
}
)
}};
return c
}
);
r("tinymce/dom/StyleSheetLoader",["tinymce/util/Tools"],function(h){return function(l,m){
var c=0,u={}
,p;
m=m||{};
p=m.maxLoadTime||5000;
function d(g){
l.getElementsByTagName("head")[0].appendChild(g)
}
function f(b,x,T){
var O,y,w,g;
function q(){
var B=g.passed,W=B.length;
while(W--){
B[W]()
}
g.status=2;
g.passed=[];
g.failed=[]
}
function z(){
var B=g.failed,W=B.length;
while(W--){
B[W]()
}
g.status=3;
g.passed=[];
g.failed=[]
}
function A(){
var W=navigator.userAgent.match(/WebKit\/(\d*)/);
return !!(W&&W[1]<536)
}
function j(W,B){
if(!W()){
if((new Date().getTime())-w<p){
window.setTimeout(B,0)
}else{
z()
}}}
function v(){
j(function(){
var C=l.styleSheets,D,B=C.length,W;
while(B--){
D=C[B];
W=D.ownerNode?D.ownerNode:D.owningElement;
if(W&&W.id===O.id){
q();
return true
}}}
,v)
}
function k(){
j(function(){
try{
var W=y.sheet.cssRules;
q();
return !!W
}
catch(B){}}
,k)
}
b=h._addCacheSuffix(b);
if(!u[b]){
g={
passed:[],failed:[]};
u[b]=g
}else{
g=u[b]
}
if(x){
g.passed.push(x)
}
if(T){
g.failed.push(T)
}
if(g.status==1){
return
}
if(g.status==2){
q();
return
}
if(g.status==3){
z();
return
}
g.status=1;
O=l.createElement("link");
O.rel="stylesheet";
O.type="text/css";
O.id="u"+(c++);
O.async=false;
O.defer=false;
w=new Date().getTime();
if("onload" in O&&!A()){
O.onload=v;
O.onerror=z
}else{
if(navigator.userAgent.indexOf("Firefox")>0){
y=l.createElement("style");
y.textContent='@import "'+b+'"';
k();
d(y);
return
}
v()
}
d(O);
O.href=b
}
this.load=f
}
}
);
r("tinymce/dom/DOMUtils",["tinymce/dom/Sizzle","tinymce/dom/DomQuery","tinymce/html/Styles","tinymce/dom/EventUtils","tinymce/dom/TreeWalker","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools","tinymce/dom/StyleSheetLoader"],function(c,f,y,m,p,T,d,l,h,k){
var u=h.each,g=h.is,w=h.grep,q=h.trim;
var x=l.ie;
var v=/^([a-z0-9],?)+$/i;
var O=/^[ \t\r\n]*$/;
function j(W,C){
var B={}
,A=C.keep_values,D;
D={
set:function(S,M,F){
if(C.url_converter){
M=C.url_converter.call(C.url_converter_scope||W,M,F,S[0])
}
S.attr("data-mce-"+F,M).attr(F,M)
}
,get:function(S,F){
return S.attr("data-mce-"+F)||S.attr(F)
}};
B={
style:{
set:function(S,F){
if(F!==null&&typeof F==="object"){
S.css(F);
return
}
if(A){
S.attr("data-mce-style",F)
}
S.attr("style",F)
}
,get:function(S){
var F=S.attr("data-mce-style")||S.attr("style");
F=W.serializeStyle(W.parseStyle(F),S[0].nodeName);
return F
}}};
if(A){
B.href=B.src=D
}
return B
}
function b(A,W){
var B=W.attr("style");
B=A.serializeStyle(A.parseStyle(B),W[0].nodeName);
if(!B){
B=null
}
W.attr("data-mce-style",B)
}
function z(C,W){
var A=this,B;
A.doc=C;
A.win=window;
A.files={};
A.counter=0;
A.stdMode=!x||C.documentMode>=8;
A.boxModel=!x||C.compatMode=="CSS1Compat"||A.stdMode;
A.styleSheetLoader=new k(C);
A.boundEvents=[];
A.settings=W=W||{};
A.schema=W.schema;
A.styles=new y({
url_converter:W.url_converter,url_converter_scope:W.url_converter_scope}
,W.schema);
A.fixDoc(C);
A.events=W.ownEvents?new m(W.proxy):m.Event;
A.attrHooks=j(A,W);
B=W.schema?W.schema.getBlockElements():{};
A.$=f.overrideDefaults(function(){
return{
context:C,element:A.getRoot()}
}
);
A.isBlock=function(S){
if(!S){
return false
}
var D=S.nodeType;
if(D){
return !!(D===1&&B[S.nodeName])
}
return !!B[S]
}
}
z.prototype={
$$:function(A){
if(typeof A=="string"){
A=this.get(A)
}
return this.$(A)
}
,root:null,fixDoc:function(B){
var W=this.settings,A;
if(x&&W.schema){
("abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video").replace(/\w+/g,function(C){
B.createElement(C)
}
);
for(A in W.schema.getCustomElements()){
B.createElement(A)
}}}
,clone:function(B,A){
var W=this,D,C;
if(!x||B.nodeType!==1||A){
return B.cloneNode(A)
}
C=W.doc;
if(!A){
D=C.createElement(B.nodeName);
u(W.getAttribs(B),function(S){
W.setAttrib(D,S.nodeName,W.getAttrib(B,S.nodeName))
}
);
return D
}
return D.firstChild
}
,getRoot:function(){
var A=this;
return A.settings.root_element||A.doc.body
}
,getViewPort:function(W){
var A,B;
W=!W?this.win:W;
A=W.document;
B=this.boxModel?A.documentElement:A.body;
return{
x:W.pageXOffset||B.scrollLeft,y:W.pageYOffset||B.scrollTop,w:W.innerWidth||B.clientWidth,h:W.innerHeight||B.clientHeight}
}
,getRect:function(C){
var A=this,B,W;
C=A.get(C);
B=A.getPos(C);
W=A.getSize(C);
return{
x:B.x,y:B.y,w:W.w,h:W.h}
}
,getSize:function(C){
var W=this,A,B;
C=W.get(C);
A=W.getStyle(C,"width");
B=W.getStyle(C,"height");
if(A.indexOf("px")===-1){
A=0
}
if(B.indexOf("px")===-1){
B=0
}
return{
w:parseInt(A,10)||C.offsetWidth||C.clientWidth,h:parseInt(B,10)||C.offsetHeight||C.clientHeight}
}
,getParent:function(B,A,W){
return this.getParents(B,A,W,false)
}
,getParents:function(S,W,B,F){
var D=this,C,A=[];
S=D.get(S);
F=F===s;
B=B||(D.getRoot().nodeName!="BODY"?D.getRoot().parentNode:null);
if(g(W,"string")){
C=W;
if(W==="*"){
W=function(M){
return M.nodeType==1
}
}else{
W=function(M){
return D.is(M,C)
}
}}
while(S){
if(S==B||!S.nodeType||S.nodeType===9){
break
}
if(!W||W(S)){
if(F){
A.push(S)
}else{
return S
}}
S=S.parentNode
}
return F?A:null
}
,get:function(W){
var A;
if(W&&this.doc&&typeof W=="string"){
A=W;
W=this.doc.getElementById(W);
if(W&&W.id!==A){
return this.doc.getElementsByName(A)[1]
}}
return W
}
,getNext:function(W,A){
return this._findSib(W,A,"nextSibling")
}
,getPrev:function(W,A){
return this._findSib(W,A,"previousSibling")
}
,select:function(A,B){
var W=this;
return c(A,W.get(B)||W.settings.root_element||W.doc,[])
}
,is:function(C,A){
var W;
if(C.length===s){
if(A==="*"){
return C.nodeType==1
}
if(v.test(A)){
A=A.toLowerCase().split(/,/);
C=C.nodeName.toLowerCase();
for(W=A.length-1;
W>=0;
W--){
if(A[W]==C){
return true
}}
return false
}}
if(C.nodeType&&C.nodeType!=1){
return false
}
var B=C.nodeType?[C]:C;
return c(A,B[0].ownerDocument||B[0],null,B).length>0
}
,add:function(S,B,W,D,C){
var A=this;
return this.run(S,function(M){
var F;
F=g(B,"string")?A.doc.createElement(B):B;
A.setAttribs(F,W);
if(D){
if(D.nodeType){
F.appendChild(D)
}else{
A.setHTML(F,D)
}}
return !C?M.appendChild(F):F
}
)
}
,create:function(W,A,B){
return this.add(this.doc.createElement(W),W,A,B,1)
}
,createHTML:function(W,A,C){
var D="",B;
D+="<"+W;
for(B in A){
if(A.hasOwnProperty(B)&&A[B]!==null&&typeof A[B]!="undefined"){
D+=" "+B+'="'+this.encode(A[B])+'"'
}}
if(typeof C!="undefined"){
return D+">"+C+"</"+W+">"
}
return D+" />"
}
,createFragment:function(W){
var D,B,C=this.doc,A;
A=C.createElement("div");
D=C.createDocumentFragment();
if(W){
A.innerHTML=W
}
while((B=A.firstChild)){
D.appendChild(B)
}
return D
}
,remove:function(A,W){
A=this.$$(A);
if(W){
A.each(function(){
var B;
while((B=this.firstChild)){
if(B.nodeType==3&&B.data.length===0){
this.removeChild(B)
}else{
this.parentNode.insertBefore(B,this)
}}}
).remove()
}else{
A.remove()
}
return A.length>1?A.toArray():A[0]
}
,setStyle:function(B,A,W){
B=this.$$(B).css(A,W);
if(this.settings.update_styles){
b(this,B)
}}
,getStyle:function(B,A,W){
B=this.$$(B);
if(W){
return B.css(A)
}
A=A.replace(/-(\D)/g,function(D,C){
return C.toUpperCase()
}
);
if(A=="float"){
A=l.ie&&l.ie<12?"styleFloat":"cssFloat"
}
return B[0]&&B[0].style?B[0].style[A]:s
}
,setStyles:function(W,A){
W=this.$$(W).css(A);
if(this.settings.update_styles){
b(this,W)
}}
,removeAllAttribs:function(A){
return this.run(A,function(C){
var B,W=C.attributes;
for(B=W.length-1;
B>=0;
B--){
C.removeAttributeNode(W.item(B))
}}
)
}
,setAttrib:function(F,B,S){
var W=this,A,D,C=W.settings;
if(S===""){
S=null
}
F=W.$$(F);
A=F.attr(B);
if(!F.length){
return
}
D=W.attrHooks[B];
if(D&&D.set){
D.set(F,S,B)
}else{
F.attr(B,S)
}
if(A!=S&&C.onSetAttrib){
C.onSetAttrib({
attrElm:F,attrName:B,attrValue:S}
)
}}
,setAttribs:function(B,W){
var A=this;
A.$$(B).each(function(C,D){
u(W,function(F,S){
A.setAttrib(D,S,F)
}
)
}
)
}
,getAttrib:function(S,W,D){
var A=this,C,B;
S=A.$$(S);
if(S.length){
C=A.attrHooks[W];
if(C&&C.get){
B=C.get(S,W)
}else{
B=S.attr(W)
}}
if(typeof B=="undefined"){
B=D||""
}
return B
}
,getPos:function(B,C){
var R=this,F=0,S=0,A,M=R.doc,W=M.body,D;
B=R.get(B);
C=C||W;
if(B){
if(C===W&&B.getBoundingClientRect&&f(W).css("position")==="static"){
D=B.getBoundingClientRect();
C=R.boxModel?M.documentElement:W;
F=D.left+(M.documentElement.scrollLeft||W.scrollLeft)-C.clientLeft;
S=D.top+(M.documentElement.scrollTop||W.scrollTop)-C.clientTop;
return{
x:F,y:S}
}
A=B;
while(A&&A!=C&&A.nodeType){
F+=A.offsetLeft||0;
S+=A.offsetTop||0;
A=A.offsetParent
}
A=B.parentNode;
while(A&&A!=C&&A.nodeType){
F-=A.scrollLeft||0;
S-=A.scrollTop||0;
A=A.parentNode
}}
return{
x:F,y:S}
}
,parseStyle:function(A){
return this.styles.parse(A)
}
,serializeStyle:function(W,A){
return this.styles.serialize(W,A)
}
,addStyle:function(C){
var W=this,D=W.doc,B,S;
if(W!==z.DOM&&D===document){
var A=z.DOM.addedStyles;
A=A||[];
if(A[C]){
return
}
A[C]=true;
z.DOM.addedStyles=A
}
S=D.getElementById("mceDefaultStyles");
if(!S){
S=D.createElement("style");
S.id="mceDefaultStyles";
S.type="text/css";
B=D.getElementsByTagName("head")[0];
if(B.firstChild){
B.insertBefore(S,B.firstChild)
}else{
B.appendChild(S)
}}
if(S.styleSheet){
S.styleSheet.cssText+=C
}else{
S.appendChild(D.createTextNode(C))
}}
,loadCSS:function(W){
var A=this,C=A.doc,B;
if(A!==z.DOM&&C===document){
z.DOM.loadCSS(W);
return
}
if(!W){
W=""
}
B=C.getElementsByTagName("head")[0];
u(W.split(","),function(D){
var S;
D=h._addCacheSuffix(D);
if(A.files[D]){
return
}
A.files[D]=true;
S=A.create("link",{
rel:"stylesheet",href:D}
);
if(x&&C.documentMode&&C.recalc){
S.onload=function(){
if(C.recalc){
C.recalc()
}
S.onload=null
}
}
B.appendChild(S)
}
)
}
,addClass:function(W,A){
this.$$(W).addClass(A)
}
,removeClass:function(W,A){
this.toggleClass(W,A,false)
}
,hasClass:function(W,A){
return this.$$(W).hasClass(A)
}
,toggleClass:function(B,A,W){
this.$$(B).toggleClass(A,W).each(function(){
if(this.className===""){
f(this).attr("class",null)
}}
)
}
,show:function(A){
this.$$(A).show()
}
,hide:function(A){
this.$$(A).hide()
}
,isHidden:function(A){
return this.$$(A).css("display")=="none"
}
,uniqueId:function(A){
return(!A?"mce_":A)+(this.counter++)
}
,setHTML:function(W,A){
W=this.$$(W);
if(x){
W.each(function(C,D){
if(D.canHaveHTML===false){
return
}
while(D.firstChild){
D.removeChild(D.firstChild)
}
try{
D.innerHTML="<br>"+A;
D.removeChild(D.firstChild)
}
catch(B){
f("<div>").html("<br>"+A).contents().slice(1).appendTo(D)
}
return A
}
)
}else{
W.html(A)
}}
,getOuterHTML:function(A){
A=this.get(A);
return A.nodeType==1&&"outerHTML" in A?A.outerHTML:f("<div>").append(f(A).clone()).html()
}
,setOuterHTML:function(B,W){
var A=this;
A.$$(B).each(function(){
try{
if("outerHTML" in this){
this.outerHTML=W;
return
}}
catch(C){}
A.remove(f(this).html(W),true)
}
)
}
,decode:d.decode,encode:d.encodeAllRaw,insertAfter:function(W,A){
A=this.get(A);
return this.run(W,function(C){
var B,D;
B=A.parentNode;
D=A.nextSibling;
if(D){
B.insertBefore(C,D)
}else{
B.appendChild(C)
}
return C
}
)
}
,replace:function(B,W,C){
var A=this;
return A.run(W,function(D){
if(g(D,"array")){
B=B.cloneNode(true)
}
if(C){
u(w(D.childNodes),function(S){
B.appendChild(S)
}
)
}
return D.parentNode.replaceChild(B,D)
}
)
}
,rename:function(C,W){
var A=this,B;
if(C.nodeName!=W.toUpperCase()){
B=A.create(W);
u(A.getAttribs(C),function(D){
A.setAttrib(B,D.nodeName,A.getAttrib(C,D.nodeName))
}
);
A.replace(B,C,1)
}
return B||C
}
,findCommonAncestor:function(B,A){
var C=B,W;
while(C){
W=A;
while(W&&C!=W){
W=W.parentNode
}
if(C==W){
break
}
C=C.parentNode
}
if(!C&&B.ownerDocument){
return B.ownerDocument.documentElement
}
return C
}
,toHex:function(A){
return this.styles.toHex(h.trim(A))
}
,run:function(D,C,B){
var W=this,A;
if(typeof D==="string"){
D=W.get(D)
}
if(!D){
return false
}
B=B||this;
if(!D.nodeType&&(D.length||D.length===0)){
A=[];
u(D,function(F,S){
if(F){
if(typeof F=="string"){
F=W.get(F)
}
A.push(C.call(B,F,S))
}}
);
return A
}
return C.call(B,D)
}
,getAttribs:function(B){
var A;
B=this.get(B);
if(!B){
return[]
}
if(x){
A=[];
if(B.nodeName=="OBJECT"){
return B.attributes
}
if(B.nodeName==="OPTION"&&this.getAttrib(B,"selected")){
A.push({
specified:1,nodeName:"selected"}
)
}
var W=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;
B.cloneNode(false).outerHTML.replace(W,"").replace(/[\w:\-]+/gi,function(C){
A.push({
specified:1,nodeName:C}
)
}
);
return A
}
return B.attributes
}
,isEmpty:function(C,W){
var R=this,S,D,M,A,B,F=0;
C=C.firstChild;
if(C){
A=new p(C,C.parentNode);
W=W||(R.schema?R.schema.getNonEmptyElements():null);
do{
M=C.nodeType;
if(M===1){
if(C.getAttribute("data-mce-bogus")){
continue
}
B=C.nodeName.toLowerCase();
if(W&&W[B]){
if(B==="br"){
F++;
continue
}
return false
}
D=R.getAttribs(C);
S=D.length;
while(S--){
B=D[S].nodeName;
if(B==="name"||B==="data-mce-bookmark"){
return false
}}}
if(M==8){
return false
}
if((M===3&&!O.test(C.nodeValue))){
return false
}}
while((C=A.next()))
}
return F<=1
}
,createRng:function(){
var A=this.doc;
return A.createRange?A.createRange():new T(this)
}
,nodeIndex:function(C,D){
var A=0,B,W;
if(C){
for(B=C.nodeType,C=C.previousSibling;
C;
C=C.previousSibling){
W=C.nodeType;
if(D&&W==3){
if(W==B||!C.nodeValue.length){
continue
}}
A++;
B=W
}}
return A
}
,split:function(D,S,W){
var R=this,A=R.createRng(),F,C,M;
function B(G){
var Y,I=G.childNodes,E=G.nodeType;
function L(U){
var P=U.previousSibling&&U.previousSibling.nodeName=="SPAN";
var N=U.nextSibling&&U.nextSibling.nodeName=="SPAN";
return P&&N
}
if(E==1&&G.getAttribute("data-mce-type")=="bookmark"){
return
}
for(Y=I.length-1;
Y>=0;
Y--){
B(I[Y])
}
if(E!=9){
if(E==3&&G.nodeValue.length>0){
var H=q(G.nodeValue).length;
if(!R.isBlock(G.parentNode)||H>0||H===0&&L(G)){
return
}}else{
if(E==1){
I=G.childNodes;
if(I.length==1&&I[0]&&I[0].nodeType==1&&I[0].getAttribute("data-mce-type")=="bookmark"){
G.parentNode.insertBefore(I[0],G)
}
if(I.length||/^(br|hr|input|img)$/i.test(G.nodeName)){
return
}}}
R.remove(G)
}
return G
}
if(D&&S){
A.setStart(D.parentNode,R.nodeIndex(D));
A.setEnd(S.parentNode,R.nodeIndex(S));
F=A.extractContents();
A=R.createRng();
A.setStart(S.parentNode,R.nodeIndex(S)+1);
A.setEnd(D.parentNode,R.nodeIndex(D)+1);
C=A.extractContents();
M=D.parentNode;
M.insertBefore(B(F),D);
if(W){
M.replaceChild(W,S)
}else{
M.insertBefore(S,D)
}
M.insertBefore(B(C),D);
R.remove(D);
return W||S
}}
,bind:function(S,W,D,C){
var A=this;
if(h.isArray(S)){
var B=S.length;
while(B--){
S[B]=A.bind(S[B],W,D,C)
}
return S
}
if(A.settings.collect&&(S===A.doc||S===A.win)){
A.boundEvents.push([S,W,D,C])
}
return A.events.bind(S,W,D,C||A)
}
,unbind:function(S,W,D){
var A=this,B;
if(h.isArray(S)){
B=S.length;
while(B--){
S[B]=A.unbind(S[B],W,D)
}
return S
}
if(A.boundEvents&&(S===A.doc||S===A.win)){
B=A.boundEvents.length;
while(B--){
var C=A.boundEvents[B];
if(S==C[0]&&(!W||W==C[1])&&(!D||D==C[2])){
this.events.unbind(C[0],C[1],C[2])
}}}
return this.events.unbind(S,W,D)
}
,fire:function(B,W,A){
return this.events.fire(B,W,A)
}
,getContentEditable:function(W){
var A;
if(!W||W.nodeType!=1){
return null
}
A=W.getAttribute("data-mce-contenteditable");
if(A&&A!=="inherit"){
return A
}
return W.contentEditable!=="inherit"?W.contentEditable:null
}
,getContentEditableParent:function(W){
var A=this.getRoot(),B=null;
for(;
W&&W!==A;
W=W.parentNode){
B=this.getContentEditable(W);
if(B!==null){
break
}}
return B
}
,destroy:function(){
var A=this;
if(A.boundEvents){
var W=A.boundEvents.length;
while(W--){
var B=A.boundEvents[W];
this.events.unbind(B[0],B[1],B[2])
}
A.boundEvents=null
}
if(c.setDocument){
c.setDocument()
}
A.win=A.doc=A.root=A.events=A.frag=null
}
,isChildOf:function(W,A){
while(W){
if(A===W){
return true
}
W=W.parentNode
}
return false
}
,dumpRng:function(A){
return("startContainer: "+A.startContainer.nodeName+", startOffset: "+A.startOffset+", endContainer: "+A.endContainer.nodeName+", endOffset: "+A.endOffset)
}
,_findSib:function(D,A,B){
var W=this,C=A;
if(D){
if(typeof C=="string"){
C=function(S){
return W.is(S,A)
}
}
for(D=D[B];
D;
D=D[B]){
if(C(D)){
return D
}}}
return null
}};
z.DOM=new z(document);
return z
}
);
r("tinymce/dom/ScriptLoader",["tinymce/dom/DOMUtils","tinymce/util/Tools"],function(u,h){
var c=u.DOM;
var d=h.each,l=h.grep;
function m(){
var p=0,x=1,v=2,q={}
,k=[],y={}
,g=[],w=0,b;
function f(T,B){
var O=c,W,A;
function j(){
O.remove(A);
if(W){
W.onreadystatechange=W.onload=W=null
}
B()
}
function z(){
if(typeof console!=="undefined"&&console.log){
console.log("Failed to load: "+T)
}}
A=O.uniqueId();
W=document.createElement("script");
W.id=A;
W.type="text/javascript";
W.src=h._addCacheSuffix(T);
if("onreadystatechange" in W){
W.onreadystatechange=function(){
if(/loaded|complete/.test(W.readyState)){
j()
}}
}else{
W.onload=j
}
W.onerror=z;
(document.getElementsByTagName("head")[0]||document.body).appendChild(W)
}
this.isDone=function(j){
return q[j]==v
};
this.markDone=function(j){
q[j]=v
};
this.add=this.load=function(j,O,z){
var T=q[j];
if(T==b){
k.push(j);
q[j]=p
}
if(O){
if(!y[j]){
y[j]=[]
}
y[j].push({
func:O,scope:z||this}
)
}};
this.loadQueue=function(z,j){
this.loadScripts(k,z,j)
};
this.loadScripts=function(j,A,O){
var T;
function z(W){
d(y[W],function(B){
B.func.call(B.scope)
}
);
y[W]=b
}
g.push({
func:A,scope:O||this}
);
T=function(){
var W=l(j);
j.length=0;
d(W,function(B){
if(q[B]==v){
z(B);
return
}
if(q[B]!=x){
q[B]=x;
w++;
f(B,function(){
q[B]=v;
w--;
z(B);
T()
}
)
}}
);
if(!w){
d(g,function(B){
B.func.call(B.scope)
}
);
g.length=0
}};
T()
}
}
m.ScriptLoader=new m();
return m
}
);
r("tinymce/AddOnManager",["tinymce/dom/ScriptLoader","tinymce/util/Tools"],function(d,h){
var c=h.each;
function l(){
var u=this;
u.items=[];
u.urls={};
u.lookup={}
}
l.prototype={
get:function(u){
if(this.lookup[u]){
return this.lookup[u].instance
}
return s
}
,dependencies:function(m){
var u;
if(this.lookup[m]){
u=this.lookup[m].dependencies
}
return u||[]
}
,requireLangPack:function(u,m){
var f=l.language;
if(f&&l.languageLoad!==false){
if(m){
m=","+m+",";
if(m.indexOf(","+f.substr(0,2)+",")!=-1){
f=f.substr(0,2)
}else{
if(m.indexOf(","+f+",")==-1){
return
}}}
d.ScriptLoader.add(this.urls[u]+"/langs/"+f+".js")
}}
,add:function(f,u,m){
this.items.push(u);
this.lookup[f]={
instance:u,dependencies:m};
return u
}
,createUrl:function(u,m){
if(typeof m==="object"){
return m
}
return{
prefix:u.prefix,resource:m,suffix:u.suffix}
}
,addComponents:function(f,u){
var m=this.urls[f];
c(u,function(p){
d.ScriptLoader.add(m+"/"+p)
}
)
}
,load:function(f,g,b,p){
var u=this,m=g;
function y(){
var w=u.dependencies(f);
c(w,function(k){
var v=u.createUrl(g,k);
u.load(v.resource,v,s,s)
}
);
if(b){
if(p){
b.call(p)
}else{
b.call(d)
}}}
if(u.urls[f]){
return
}
if(typeof g==="object"){
m=g.prefix+g.resource+g.suffix
}
if(m.indexOf("/")!==0&&m.indexOf("://")==-1){
m=l.baseURL+"/"+m
}
u.urls[f]=m.substring(0,m.lastIndexOf("/"));
if(u.lookup[f]){
y()
}else{
d.ScriptLoader.add(m,y,p)
}}};
l.PluginManager=new l();
l.ThemeManager=new l();
return l
}
);
r("tinymce/dom/RangeUtils",["tinymce/util/Tools","tinymce/dom/TreeWalker"],function(h,l){
var d=h.each;
function u(m,f){
var p=m.childNodes;
f--;
if(f>p.length-1){
f=p.length-1
}else{
if(f<0){
f=0
}}
return p[f]||m
}
function c(m){
this.walk=function(f,W){
var w=f.startContainer,x=f.startOffset,B=f.endContainer,q=f.endOffset,v,y,z,b,A,O,p;
p=m.select("td.mce-item-selected,th.mce-item-selected");
if(p.length>0){
d(p,function(C){
W([C])
}
);
return
}
function g(C){
var D;
D=C[0];
if(D.nodeType===3&&D===w&&x>=D.nodeValue.length){
C.splice(0,1)
}
D=C[C.length-1];
if(q===0&&C.length>0&&D===B&&D.nodeType===3){
C.splice(C.length-1,1)
}
return C
}
function T(S,D,C){
var F=[];
for(;
S&&S!=C;
S=S[D]){
F.push(S)
}
return F
}
function j(D,C){
do{
if(D.parentNode==C){
return D
}
D=D.parentNode
}
while(D)
}
function k(S,D,F){
var C=F?"nextSibling":"previousSibling";
for(b=S,A=b.parentNode;
b&&b!=D;
b=A){
A=b.parentNode;
O=T(b==S?b:b[C],C);
if(O.length){
if(!F){
O.reverse()
}
W(g(O))
}}}
if(w.nodeType==1&&w.hasChildNodes()){
w=w.childNodes[x]
}
if(B.nodeType==1&&B.hasChildNodes()){
B=u(B,q)
}
if(w==B){
return W(g([w]))
}
v=m.findCommonAncestor(w,B);
for(b=w;
b;
b=b.parentNode){
if(b===B){
return k(w,v,true)
}
if(b===v){
break
}}
for(b=B;
b;
b=b.parentNode){
if(b===w){
return k(B,v)
}
if(b===v){
break
}}
y=j(w,v)||w;
z=j(B,v)||B;
k(w,y,true);
O=T(y==w?y:y.nextSibling,"nextSibling",z==B?z.nextSibling:z);
if(O.length){
W(g(O))
}
k(B,z)
};
this.split=function(p){
var b=p.startContainer,f=p.startOffset,w=p.endContainer,y=p.endOffset;
function g(v,k){
return v.splitText(k)
}
if(b==w&&b.nodeType==3){
if(f>0&&f<b.nodeValue.length){
w=g(b,f);
b=w.previousSibling;
if(y>f){
y=y-f;
b=w=g(w,y).previousSibling;
y=w.nodeValue.length;
f=0
}else{
y=0
}}}else{
if(b.nodeType==3&&f>0&&f<b.nodeValue.length){
b=g(b,f);
f=0
}
if(w.nodeType==3&&y>0&&y<w.nodeValue.length){
w=g(w,y).previousSibling;
y=w.nodeValue.length
}}
return{
startContainer:b,startOffset:f,endContainer:w,endOffset:y}
};
this.normalize=function(f){
var y,g;
function p(v){
var w,q,b,z=m.getRoot(),k,j;
var O,x;
function W(B,C){
var D=new l(B,m.getParent(B.parentNode,m.isBlock)||z);
while((B=D[C?"prev":"next"]())){
if(B.nodeName==="BR"){
return true
}}}
function T(C,B){
return C.previousSibling&&C.previousSibling.nodeName==B
}
function A(S,B){
var F,C,D;
B=B||w;
D=m.getParent(B.parentNode,m.isBlock)||z;
if(S&&B.nodeName=="BR"&&x&&m.isEmpty(D)){
w=B.parentNode;
q=m.nodeIndex(B);
y=true;
return
}
F=new l(B,D);
while((k=F[S?"prev":"next"]())){
if(m.getContentEditableParent(k)==="false"){
return
}
if(k.nodeType===3&&k.nodeValue.length>0){
w=k;
q=S?k.nodeValue.length:0;
y=true;
return
}
if(m.isBlock(k)||j[k.nodeName.toLowerCase()]){
return
}
C=k
}
if(g&&C){
w=C;
y=true;
q=0
}}
w=f[(v?"start":"end")+"Container"];
q=f[(v?"start":"end")+"Offset"];
x=w.nodeType==1&&q===w.childNodes.length;
j=m.schema.getNonEmptyElements();
O=v;
if(w.nodeType==1&&q>w.childNodes.length-1){
O=false
}
if(w.nodeType===9){
w=m.getRoot();
q=0
}
if(w===z){
if(O){
k=w.childNodes[q>0?q-1:0];
if(k){
if(j[k.nodeName]||k.nodeName=="TABLE"){
return
}}}
if(w.hasChildNodes()){
q=Math.min(!O&&q>0?q-1:q,w.childNodes.length-1);
w=w.childNodes[q];
q=0;
if(w.hasChildNodes()&&!/TABLE/.test(w.nodeName)){
k=w;
b=new l(w,z);
do{
if(k.nodeType===3&&k.nodeValue.length>0){
q=O?0:k.nodeValue.length;
w=k;
y=true;
break
}
if(j[k.nodeName.toLowerCase()]){
q=m.nodeIndex(k);
w=k.parentNode;
if(k.nodeName=="IMG"&&!O){
q++
}
y=true;
break
}}
while((k=(O?b.next():b.prev())))
}}}
if(g){
if(w.nodeType===3&&q===0){
A(true)
}
if(w.nodeType===1){
k=w.childNodes[q];
if(!k){
k=w.childNodes[q-1]
}
if(k&&k.nodeName==="BR"&&!T(k,"A")&&!W(k)&&!W(k,true)){
A(true,k)
}}}
if(O&&!g&&w.nodeType===3&&q===w.nodeValue.length){
A(false)
}
if(y){
f["set"+(v?"Start":"End")](w,q)
}}
g=f.collapsed;
p(true);
if(!g){
p()
}
if(y&&g){
f.collapse(true)
}
return y
}
}
c.compareRanges=function(f,m){
if(f&&m){
if(f.item||f.duplicate){
if(f.item&&m.item&&f.item(0)===m.item(0)){
return true
}
if(f.isEqual&&m.isEqual&&m.isEqual(f)){
return true
}}else{
return f.startContainer==m.startContainer&&f.startOffset==m.startOffset
}}
return false
};
c.getCaretRangeFromPoint=function(f,w,b){
var p,m;
if(b.caretPositionFromPoint){
m=b.caretPositionFromPoint(f,w);
p=b.createRange();
p.setStart(m.offsetNode,m.offset);
p.collapse(true)
}else{
if(b.caretRangeFromPoint){
p=b.caretRangeFromPoint(f,w)
}else{
if(b.body.createTextRange){
p=b.body.createTextRange();
try{
p.moveToPoint(f,w);
p.collapse(true)
}
catch(g){
p.collapse(w<b.body.clientHeight)
}}}}
return p
};
c.getNode=function(m,f){
if(m.nodeType==1&&m.hasChildNodes()){
if(f>=m.childNodes.length){
f=m.childNodes.length-1
}
m=m.childNodes[f]
}
return m
};
return c
}
);
r("tinymce/NodeChange",["tinymce/dom/RangeUtils","tinymce/Env"],function(l,h){
return function(c){
var u,d=[];
function m(f){
var p,g;
g=c.$(f).parentsUntil(c.getBody()).add(f);
if(g.length===d.length){
for(p=g.length;
p>=0;
p--){
if(g[p]!==d[p]){
break
}}
if(p===-1){
d=g;
return true
}}
d=g;
return false
}
if(!("onselectionchange" in c.getDoc())){
c.on("NodeChange Click MouseUp KeyUp Focus",function(p){
var g,f;
g=c.selection.getRng();
f={
startContainer:g.startContainer,startOffset:g.startOffset,endContainer:g.endContainer,endOffset:g.endOffset};
if(p.type=="nodechange"||!l.compareRanges(f,u)){
c.fire("SelectionChange")
}
u=f
}
)
}
c.on("contextmenu",function(){
c.fire("SelectionChange")
}
);
c.on("SelectionChange",function(){
var f=c.selection.getStart(true);
if(!h.range&&c.selection.isCollapsed()){
return
}
if(!m(f)&&c.dom.isChildOf(f,c.getBody())){
c.nodeChanged({
selectionChange:true}
)
}}
);
c.on("MouseUp",function(f){
if(!f.isDefaultPrevented()){
if(c.selection.getNode().nodeName=="IMG"){
setTimeout(function(){
c.nodeChanged()
}
,0)
}else{
c.nodeChanged()
}}}
);
this.nodeChanged=function(g){
var y=c.selection,b,p,f;
if(c.initialized&&y&&!c.settings.disable_nodechange&&!c.settings.readonly){
f=c.getBody();
b=y.getStart()||f;
b=b.ownerDocument!=c.getDoc()?c.getBody():b;
if(b.nodeName=="IMG"&&y.isCollapsed()){
b=b.parentNode
}
p=[];
c.dom.getParent(b,function(w){
if(w===f){
return true
}
p.push(w)
}
);
g=g||{};
g.element=b;
g.parents=p;
c.fire("NodeChange",g)
}}
}
}
);
r("tinymce/html/Node",[],function(){
var c=/^[ \t\r\n]*$/,d={
"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};
function h(y,b,g){
var p,f,u=g?"lastChild":"firstChild",m=g?"prev":"next";
if(y[u]){
return y[u]
}
if(y!==b){
p=y[m];
if(p){
return p
}
for(f=y.parent;
f&&f!==b;
f=f.parent){
p=f[m];
if(p){
return p
}}}}
function l(u,m){
this.name=u;
this.type=m;
if(m===1){
this.attributes=[];
this.attributes.map={}
}}
l.prototype={
replace:function(m){
var u=this;
if(m.parent){
m.remove()
}
u.insert(m,u);
u.remove();
return u
}
,attr:function(f,y){
var u=this,m,p,g;
if(typeof f!=="string"){
for(p in f){
u.attr(p,f[p])
}
return u
}
if((m=u.attributes)){
if(y!==g){
if(y===null){
if(f in m.map){
delete m.map[f];
p=m.length;
while(p--){
if(m[p].name===f){
m=m.splice(p,1);
return u
}}}
return u
}
if(f in m.map){
p=m.length;
while(p--){
if(m[p].name===f){
m[p].value=y;
break
}}}else{
m.push({
name:f,value:y}
)
}
m.map[f]=y;
return u
}
return m.map[f]
}}
,clone:function(){
var m=this,b=new l(m.name,m.type),f,u,y,p,g;
if((y=m.attributes)){
g=[];
g.map={};
for(f=0,u=y.length;
f<u;
f++){
p=y[f];
if(p.name!=="id"){
g[g.length]={
name:p.name,value:p.value};
g.map[p.name]=p.value
}}
b.attributes=g
}
b.value=m.value;
b.shortEnded=m.shortEnded;
return b
}
,wrap:function(m){
var u=this;
u.parent.insert(m,u);
m.append(u);
return u
}
,unwrap:function(){
var u=this,f,m;
for(f=u.firstChild;
f;
){
m=f.next;
u.insert(f,u,true);
f=m
}
u.remove()
}
,remove:function(){
var u=this,f=u.parent,m=u.next,p=u.prev;
if(f){
if(f.firstChild===u){
f.firstChild=m;
if(m){
m.prev=null
}}else{
p.next=m
}
if(f.lastChild===u){
f.lastChild=p;
if(p){
p.next=null
}}else{
m.prev=p
}
u.parent=u.next=u.prev=null
}
return u
}
,append:function(f){
var u=this,m;
if(f.parent){
f.remove()
}
m=u.lastChild;
if(m){
m.next=f;
f.prev=m;
u.lastChild=f
}else{
u.lastChild=u.firstChild=f
}
f.parent=u;
return f
}
,insert:function(f,u,p){
var m;
if(f.parent){
f.remove()
}
m=u.parent||this;
if(p){
if(u===m.firstChild){
m.firstChild=f
}else{
u.prev.next=f
}
f.prev=u.prev;
f.next=u;
u.prev=f
}else{
if(u===m.lastChild){
m.lastChild=f
}else{
u.next.prev=f
}
f.next=u.next;
f.prev=u;
u.next=f
}
f.parent=m;
return f
}
,getAll:function(m){
var u=this,f,p=[];
for(f=u.firstChild;
f;
f=h(f,u)){
if(f.name===m){
p.push(f)
}}
return p
}
,empty:function(){
var m=this,u,f,p;
if(m.firstChild){
u=[];
for(p=m.firstChild;
p;
p=h(p,m)){
u.push(p)
}
f=u.length;
while(f--){
p=u[f];
p.parent=p.firstChild=p.lastChild=p.next=p.prev=null
}}
m.firstChild=m.lastChild=null;
return m
}
,isEmpty:function(g){
var u=this,p=u.firstChild,f,m;
if(p){
do{
if(p.type===1){
if(p.attributes.map["data-mce-bogus"]){
continue
}
if(g[p.name]){
return false
}
f=p.attributes.length;
while(f--){
m=p.attributes[f].name;
if(m==="name"||m.indexOf("data-mce-bookmark")===0){
return false
}}}
if(p.type===8){
return false
}
if((p.type===3&&!c.test(p.value))){
return false
}}
while((p=h(p,u)))
}
return true
}
,walk:function(u){
return h(this,null,u)
}};
l.create=function(m,u){
var p,f;
p=new l(m,d[m]||1);
if(u){
for(f in u){
p.attr(f,u[f])
}}
return p
};
return l
}
);
r("tinymce/html/Schema",["tinymce/util/Tools"],function(l){
var c={}
,u={};
var d=l.makeMap,g=l.each,m=l.extend,p=l.explode,b=l.inArray;
function f(w,v){
return w?w.split(v||" "):[]
}
function y(T){
var q={}
,O,v;
var j,z,w,x;
function A(D,W,M){
var F,S,R,C=arguments;
function B(G,E){
var Y={}
,I,H;
for(I=0,H=G.length;
I<H;
I++){
Y[G[I]]=E||{}
}
return Y
}
M=M||[];
W=W||"";
if(typeof M==="string"){
M=f(M)
}
for(S=3;
S<C.length;
S++){
if(typeof C[S]==="string"){
C[S]=f(C[S])
}
M.push.apply(M,C[S])
}
D=f(D);
F=D.length;
while(F--){
R=[].concat(O,f(W));
q[D[F]]={
attributes:B(R),attributesOrder:R,children:B(M,u)}
}}
function k(D,C){
var F,B,S,W;
D=f(D);
F=D.length;
C=f(C);
while(F--){
B=q[D[F]];
for(S=0,W=C.length;
S<W;
S++){
B.attributes[C[S]]={};
B.attributesOrder.push(C[S])
}}}
if(c[T]){
return c[T]
}
O=f("id accesskey class dir lang style tabindex title");
v=f("address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul");
j=f("a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment");
if(T!="html4"){
O.push.apply(O,f("contenteditable contextmenu draggable dropzone hidden spellcheck translate"));
v.push.apply(v,f("article aside details dialog figure header footer hgroup section nav"));
j.push.apply(j,f("audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"))
}
if(T!="html5-strict"){
O.push("xml:lang");
x=f("acronym applet basefont big font strike tt");
j.push.apply(j,x);
g(x,function(W){
A(W,"",j)
}
);
w=f("center dir isindex noframes");
v.push.apply(v,w);
z=[].concat(v,j);
g(w,function(W){
A(W,"",z)
}
)
}
z=z||[].concat(v,j);
A("html","manifest","head body");
A("head","","base command link meta noscript script style title");
A("title hr noscript br");
A("base","href target");
A("link","href rel media hreflang type sizes hreflang");
A("meta","name http-equiv content charset");
A("style","media type scoped");
A("script","src async defer type charset");
A("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",z);
A("address dt dd div caption","",z);
A("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",j);
A("blockquote","cite",z);
A("ol","reversed start type","li");
A("ul","","li");
A("li","value",z);
A("dl","","dt dd");
A("a","href target rel media hreflang type",j);
A("q","cite",j);
A("ins del","cite datetime",z);
A("img","src sizes srcset alt usemap ismap width height");
A("iframe","src name width height",z);
A("embed","src type width height");
A("object","data type typemustmatch name usemap form width height",z,"param");
A("param","name value");
A("map","name",z,"area");
A("area","alt coords shape href target rel media hreflang type");
A("table","border","caption colgroup thead tfoot tbody tr"+(T=="html4"?" col":""));
A("colgroup","span","col");
A("col","span");
A("tbody thead tfoot","","tr");
A("tr","","td th");
A("td","colspan rowspan headers",z);
A("th","colspan rowspan headers scope abbr",z);
A("form","accept-charset action autocomplete enctype method name novalidate target",z);
A("fieldset","disabled form name",z,"legend");
A("label","form for",j);
A("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width");
A("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",T=="html4"?z:j);
A("select","disabled form multiple name required size","option optgroup");
A("optgroup","disabled label","option");
A("option","disabled label selected value");
A("textarea","cols dirname disabled form maxlength name readonly required rows wrap");
A("menu","type label",z,"li");
A("noscript","",z);
if(T!="html4"){
A("wbr");
A("ruby","",j,"rt rp");
A("figcaption","",z);
A("mark rt rp summary bdi","",j);
A("canvas","width height",z);
A("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",z,"track source");
A("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",z,"track source");
A("picture","","img source");
A("source","src srcset type media sizes");
A("track","kind src srclang label default");
A("datalist","",j,"option");
A("article section nav aside header footer","",z);
A("hgroup","","h1 h2 h3 h4 h5 h6");
A("figure","",z,"figcaption");
A("time","datetime",j);
A("dialog","open",z);
A("command","type label icon disabled checked radiogroup command");
A("output","for form name",j);
A("progress","value max",j);
A("meter","value min max low high optimum",j);
A("details","open",z,"summary");
A("keygen","autofocus challenge disabled form keytype name")
}
if(T!="html5-strict"){
k("script","language xml:space");
k("style","xml:space");
k("object","declare classid code codebase codetype archive standby align border hspace vspace");
k("embed","align name hspace vspace");
k("param","valuetype type");
k("a","charset name rev shape coords");
k("br","clear");
k("applet","codebase archive code object alt name width height align hspace vspace");
k("img","name longdesc align border hspace vspace");
k("iframe","longdesc frameborder marginwidth marginheight scrolling align");
k("font basefont","size color face");
k("input","usemap align");
k("select","onchange");
k("textarea");
k("h1 h2 h3 h4 h5 h6 div p legend caption","align");
k("ul","type compact");
k("li","type");
k("ol dl menu dir","compact");
k("pre","width xml:space");
k("hr","align noshade size width");
k("isindex","prompt");
k("table","summary width frame rules cellspacing cellpadding align bgcolor");
k("col","width align char charoff valign");
k("colgroup","width align char charoff valign");
k("thead","align char charoff valign");
k("tr","align char charoff valign bgcolor");
k("th","axis align char charoff valign nowrap bgcolor width height");
k("form","accept");
k("td","abbr axis scope align char charoff valign nowrap bgcolor width height");
k("tfoot","align char charoff valign");
k("tbody","align char charoff valign");
k("area","nohref");
k("body","background bgcolor text link vlink alink")
}
if(T!="html4"){
k("input button select textarea","autofocus");
k("input textarea","placeholder");
k("a","download");
k("link script img","crossorigin");
k("iframe","sandbox seamless allowfullscreen")
}
g(f("a form meter progress dfn"),function(W){
if(q[W]){
delete q[W].children[W]
}}
);
delete q.caption.children.table;
delete q.script;
c[T]=q;
return q
}
function h(v,k){
var w;
if(v){
w={};
if(typeof v=="string"){
v={
"*":v}
}
g(v,function(q,x){
w[x]=w[x.toUpperCase()]=k=="map"?d(q,/[, ]/):p(q,/[, ]/)
}
)
}
return w
}
return function(G){
var R=this,F={}
,q={}
,x=[],U,w,Y;
var W,C,E,D,S;
var H,A,O,v,P;
var B={}
,j={};
function T(Q,J,K){
var V=G[Q];
if(!V){
V=c[Q];
if(!V){
V=d(J," ",d(J.toUpperCase()," "));
V=m(V,K);
c[Q]=V
}}else{
V=d(V,/[, ]/,d(V.toUpperCase(),/[, ]/))
}
return V
}
G=G||{};
Y=y(G.schema);
if(G.verify_html===false){
G.valid_elements="*[*]"
}
U=h(G.valid_styles);
w=h(G.invalid_styles,"map");
S=h(G.valid_classes,"map");
W=T("whitespace_elements","pre script noscript style textarea video audio iframe object");
C=T("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");
E=T("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track");
D=T("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");
A=T("non_empty_elements","td th iframe video audio object script",E);
O=T("move_caret_before_on_enter_elements","table",A);
v=T("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure");
H=T("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup",v);
P=T("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");
g((G.special||"script noscript style textarea").split(" "),function(J){
j[J]=new RegExp("</"+J+"[^>]*>","gi")
}
);
function k(J){
return new RegExp("^"+J.replace(/([?+*])/g,".$1")+"$")
}
function N(_s){
var _e,Q,_f,_c,K,Z,_l,_u,_o,_m,_p,_i,X,_d,J,_r,V,_g,_h,_a=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,_n=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,_t=/[*?+]/;
if(_s){
_s=f(_s,",");
if(F["@"]){
_r=F["@"].attributes;
V=F["@"].attributesOrder
}
for(_e=0,Q=_s.length;
_e<Q;
_e++){
K=_a.exec(_s[_e]);
if(K){
_d=K[1];
_o=K[2];
J=K[3];
_u=K[5];
_i={};
X=[];
Z={
attributes:_i,attributesOrder:X};
if(_d==="#"){
Z.paddEmpty=true
}
if(_d==="-"){
Z.removeEmpty=true
}
if(K[4]==="!"){
Z.removeEmptyAttrs=true
}
if(_r){
for(_g in _r){
_i[_g]=_r[_g]
}
X.push.apply(X,V)
}
if(_u){
_u=f(_u,"|");
for(_f=0,_c=_u.length;
_f<_c;
_f++){
K=_n.exec(_u[_f]);
if(K){
_l={};
_p=K[1];
_m=K[2].replace(/::/g,":");
_d=K[3];
_h=K[4];
if(_p==="!"){
Z.attributesRequired=Z.attributesRequired||[];
Z.attributesRequired.push(_m);
_l.required=true
}
if(_p==="-"){
delete _i[_m];
X.splice(b(X,_m),1);
continue
}
if(_d){
if(_d==="="){
Z.attributesDefault=Z.attributesDefault||[];
Z.attributesDefault.push({
name:_m,value:_h}
);
_l.defaultValue=_h
}
if(_d===":"){
Z.attributesForced=Z.attributesForced||[];
Z.attributesForced.push({
name:_m,value:_h}
);
_l.forcedValue=_h
}
if(_d==="<"){
_l.validValues=d(_h,"?")
}}
if(_t.test(_m)){
Z.attributePatterns=Z.attributePatterns||[];
_l.pattern=k(_m);
Z.attributePatterns.push(_l)
}else{
if(!_i[_m]){
X.push(_m)
}
_i[_m]=_l
}}}}
if(!_r&&_o=="@"){
_r=_i;
V=X
}
if(J){
Z.outputName=_o;
F[J]=Z
}
if(_t.test(_o)){
Z.pattern=k(_o);
x.push(Z)
}else{
F[_o]=Z
}}}}}
function M(J){
F={};
x=[];
N(J);
g(Y,function(Q,K){
q[K]=Q.children
}
)
}
function z(K){
var J=/^(~)?(.+)$/;
if(K){
c.text_block_elements=c.block_elements=null;
g(f(K,","),function(_e){
var Z=J.exec(_e),X=Z[1]==="~",_t=X?"span":"div",V=Z[2];
q[V]=q[_t];
B[V]=_t;
if(!X){
H[V.toUpperCase()]={};
H[V]={}
}
if(!F[V]){
var Q=F[_t];
Q=m({}
,Q);
delete Q.removeEmptyAttrs;
delete Q.removeEmpty;
F[V]=Q
}
g(q,function(_a,_i){
if(_a[_t]){
q[_i]=_a=m({}
,q[_i]);
_a[V]=_a[_t]
}}
)
}
)
}}
function I(J){
var K=/^([+\-]?)(\w+)\[([^\]]+)\]$/;
c[G.schema]=null;
if(J){
g(f(J,","),function(X){
var Z=K.exec(X),Q,V;
if(Z){
V=Z[1];
if(V){
Q=q[Z[2]]
}else{
Q=q[Z[2]]={
"#comment":{}}
}
Q=q[Z[2]];
g(f(Z[3],"|"),function(_e){
if(V==="-"){
delete Q[_e]
}else{
Q[_e]={}
}}
)
}}
)
}}
function L(J){
var Q=F[J],K;
if(Q){
return Q
}
K=x.length;
while(K--){
Q=x[K];
if(Q.pattern.test(J)){
return Q
}}}
if(!G.valid_elements){
g(Y,function(K,J){
F[J]={
attributes:K.attributes,attributesOrder:K.attributesOrder};
q[J]=K.children
}
);
if(G.schema!="html5"){
g(f("strong/b em/i"),function(J){
J=f(J,"/");
F[J[1]].outputName=J[0]
}
)
}
F.img.attributesDefault=[{
name:"alt",value:""}
];
g(f("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(J){
if(F[J]){
F[J].removeEmpty=true
}}
);
g(f("p h1 h2 h3 h4 h5 h6 th td pre div address caption"),function(J){
F[J].paddEmpty=true
}
);
g(f("span"),function(J){
F[J].removeEmptyAttrs=true
}
)
}else{
M(G.valid_elements)
}
z(G.custom_elements);
I(G.valid_children);
N(G.extended_valid_elements);
I("+ol[ul|ol],+ul[ul|ol]");
if(G.invalid_elements){
g(p(G.invalid_elements),function(J){
if(F[J]){
delete F[J]
}}
)
}
if(!L("span")){
N("span[!data-mce-type|*]")
}
R.children=q;
R.getValidStyles=function(){
return U
};
R.getInvalidStyles=function(){
return w
};
R.getValidClasses=function(){
return S
};
R.getBoolAttrs=function(){
return D
};
R.getBlockElements=function(){
return H
};
R.getTextBlockElements=function(){
return v
};
R.getTextInlineElements=function(){
return P
};
R.getShortEndedElements=function(){
return E
};
R.getSelfClosingElements=function(){
return C
};
R.getNonEmptyElements=function(){
return A
};
R.getMoveCaretBeforeOnEnterElements=function(){
return O
};
R.getWhiteSpaceElements=function(){
return W
};
R.getSpecialElements=function(){
return j
};
R.isValidChild=function(J,Q){
var K=q[J];
return !!(K&&K[Q])
};
R.isValid=function(K,J){
var V,Q,Z=L(K);
if(Z){
if(J){
if(Z.attributes[J]){
return true
}
V=Z.attributePatterns;
if(V){
Q=V.length;
while(Q--){
if(V[Q].pattern.test(K)){
return true
}}}}else{
return true
}}
return false
};
R.getElementRule=L;
R.getCustomElements=function(){
return B
};
R.addValidElements=N;
R.setValidElements=M;
R.addCustomElements=z;
R.addValidChildren=I;
R.elements=F
}
}
);
r("tinymce/html/SaxParser",["tinymce/html/Schema","tinymce/html/Entities","tinymce/util/Tools"],function(d,m,c){
var u=c.each;
function l(b,g,k){
var y=1,f,v,w,p;
p=b.getShortEndedElements();
w=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;
w.lastIndex=f=k;
while((v=w.exec(g))){
f=w.lastIndex;
if(v[1]==="/"){
y--
}else{
if(!v[1]){
if(v[2] in p){
continue
}
y++
}}
if(y===0){
break
}}
return f
}
function h(p,y){
var f=this;
function g(){}
p=p||{};
f.schema=y=y||new d();
if(p.fix_self_closing!==false){
p.fix_self_closing=true
}
u("comment cdata text start end pi doctype".split(" "),function(b){
if(b){
f[b]=p[b]||g
}}
);
f.parse=function(G){
var O=this,w,N=0,J,I,H=[],X,_a,Y,W;
var R,B,Z,P,_e;
var S,T,q,C,_o,_t,L;
var _n,V,b;
var _i,K,j,E,Q,v,F=0;
var x=m.decode,M,U=c.makeMap("src,href,data,background,formaction,poster");
var k=/((java|vb)script|mhtml):/i,z=/^data:/i;
function D(_s){
var _h,_r;
_h=H.length;
while(_h--){
if(H[_h].name===_s){
break
}}
if(_h>=0){
for(_r=H.length-1;
_r>=_h;
_r--){
_s=H[_r];
if(_s.valid){
O.end(_s.name)
}}
H.length=_h
}}
function A(_d,_r,_p,_m,_u){
var _l,_c,_s=/[\s\u0000-\u001F]+/g;
_r=_r.toLowerCase();
_p=_r in P?_r:x(_p||_m||_u||"");
if(S&&!R&&_r.indexOf("data-")!==0){
_l=_t[_r];
if(!_l&&L){
_c=L.length;
while(_c--){
_l=L[_c];
if(_l.pattern.test(_r)){
break
}}
if(_c===-1){
_l=null
}}
if(!_l){
return
}
if(_l.validValues&&!(_p in _l.validValues)){
return
}}
if(U[_r]&&!p.allow_script_urls){
var _h=_p.replace(_s,"");
try{
_h=decodeURIComponent(_h)
}
catch(_f){
_h=unescape(_h)
}
if(k.test(_h)){
return
}
if(!p.allow_html_data_urls&&z.test(_h)&&!/^data:image\//i.test(_h)){
return
}}
X.map[_r]=_p;
X.push({
name:_r,value:_p}
)
}
j=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-_\\:\\.]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g");
E=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g;
Z=y.getShortEndedElements();
K=p.self_closing_elements||y.getSelfClosingElements();
P=y.getBoolAttrs();
S=p.validate;
B=p.remove_internals;
M=p.fix_self_closing;
Q=y.getSpecialElements();
while((w=j.exec(G))){
if(N<w.index){
O.text(x(G.substr(N,w.index-N)))
}
if((J=w[6])){
J=J.toLowerCase();
if(J.charAt(0)===":"){
J=J.substr(1)
}
D(J)
}else{
if((J=w[7])){
J=J.toLowerCase();
if(J.charAt(0)===":"){
J=J.substr(1)
}
_e=J in Z;
if(M&&K[J]&&H.length>0&&H[H.length-1].name===J){
D(J)
}
if(!S||(T=y.getElementRule(J))){
q=true;
if(S){
_t=T.attributes;
L=T.attributePatterns
}
if((_o=w[8])){
R=_o.indexOf("data-mce-type")!==-1;
if(R&&B){
q=false
}
X=[];
X.map={};
_o.replace(E,A)
}else{
X=[];
X.map={}
}
if(S&&!R){
_n=T.attributesRequired;
V=T.attributesDefault;
b=T.attributesForced;
_i=T.removeEmptyAttrs;
if(_i&&!X.length){
q=false
}
if(b){
_a=b.length;
while(_a--){
C=b[_a];
W=C.name;
v=C.value;
if(v==="{$uid}"){
v="mce_"+F++
}
X.map[W]=v;
X.push({
name:W,value:v}
)
}}
if(V){
_a=V.length;
while(_a--){
C=V[_a];
W=C.name;
if(!(W in X.map)){
v=C.value;
if(v==="{$uid}"){
v="mce_"+F++
}
X.map[W]=v;
X.push({
name:W,value:v}
)
}}}
if(_n){
_a=_n.length;
while(_a--){
if(_n[_a] in X.map){
break
}}
if(_a===-1){
q=false
}}
if((C=X.map["data-mce-bogus"])){
if(C==="all"){
N=l(y,G,j.lastIndex);
j.lastIndex=N;
continue
}
q=false
}}
if(q){
O.start(J,X,_e)
}}else{
q=false
}
if((I=Q[J])){
I.lastIndex=N=w.index+w[0].length;
if((w=I.exec(G))){
if(q){
Y=G.substr(N,w.index-N)
}
N=w.index+w[0].length
}else{
Y=G.substr(N);
N=G.length
}
if(q){
if(Y.length>0){
O.text(Y,true)
}
O.end(J)
}
j.lastIndex=N;
continue
}
if(!_e){
if(!_o||_o.indexOf("/")!=_o.length-1){
H.push({
name:J,valid:q}
)
}else{
if(q){
O.end(J)
}}}}else{
if((J=w[1])){
if(J.charAt(0)===">"){
J=" "+J
}
if(!p.allow_conditional_comments&&J.substr(0,3)==="[if"){
J=" "+J
}
O.comment(J)
}else{
if((J=w[2])){
O.cdata(J)
}else{
if((J=w[3])){
O.doctype(J)
}else{
if((J=w[4])){
O.pi(J,w[5])
}}}}}}
N=w.index+w[0].length
}
if(N<G.length){
O.text(x(G.substr(N)))
}
for(_a=H.length-1;
_a>=0;
_a--){
J=H[_a];
if(J.valid){
O.end(J.name)
}}}
}
h.findEndTag=l;
return h
}
);
r("tinymce/html/DomParser",["tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/util/Tools"],function(c,u,h,l){
var m=l.makeMap,f=l.each,d=l.explode,p=l.extend;
return function(v,k){
var w=this,b={}
,y=[],x={}
,g={};
v=v||{};
v.validate="validate" in v?v.validate:true;
v.root_name=v.root_name||"body";
w.schema=k=k||new u();
function q(A){
var B,C,H,R,Y,W,D,z,M;
var j,F,O,T,I,S;
F=m("tr,td,th,tbody,thead,tfoot,table");
j=k.getNonEmptyElements();
O=k.getTextBlockElements();
T=k.getSpecialElements();
for(B=0;
B<A.length;
B++){
C=A[B];
if(!C.parent||C.fixed){
continue
}
if(O[C.name]&&C.parent.name=="li"){
I=C.next;
while(I){
if(O[I.name]){
I.name="li";
I.fixed=true;
C.parent.insert(I,C.parent)
}else{
break
}
I=I.next
}
C.unwrap(C);
continue
}
R=[C];
for(H=C.parent;
H&&!k.isValidChild(H.name,C.name)&&!F[H.name];
H=H.parent){
R.push(H)
}
if(H&&R.length>1){
R.reverse();
Y=W=w.filterNode(R[0].clone());
for(M=0;
M<R.length-1;
M++){
if(k.isValidChild(W.name,R[M].name)){
D=w.filterNode(R[M].clone());
W.append(D)
}else{
D=W
}
for(z=R[M].firstChild;
z&&z!=R[M+1];
){
S=z.next;
D.append(z);
z=S
}
W=D
}
if(!Y.isEmpty(j)){
H.insert(Y,R[0],true);
H.insert(C,Y)
}else{
H.insert(C,R[0],true)
}
H=R[0];
if(H.isEmpty(j)||H.firstChild===H.lastChild&&H.firstChild.name==="br"){
H.empty().remove()
}}else{
if(C.parent){
if(C.name==="li"){
I=C.prev;
if(I&&(I.name==="ul"||I.name==="ul")){
I.append(C);
continue
}
I=C.next;
if(I&&(I.name==="ul"||I.name==="ul")){
I.insert(C,I.firstChild,true);
continue
}
C.wrap(w.filterNode(new c("ul",1)));
continue
}
if(k.isValidChild(C.parent.name,"div")&&k.isValidChild("div",C.name)){
C.wrap(w.filterNode(new c("div",1)))
}else{
if(T[C.name]){
C.empty().remove()
}else{
C.unwrap()
}}}}}}
w.filterNode=function(T){
var z,j,O;
if(j in b){
O=x[j];
if(O){
O.push(T)
}else{
x[j]=[T]
}}
z=y.length;
while(z--){
j=y[z].name;
if(j in T.attributes.map){
O=g[j];
if(O){
O.push(T)
}else{
g[j]=[T]
}}}
return T
};
w.addNodeFilter=function(j,z){
f(d(j),function(T){
var O=b[T];
if(!O){
b[T]=O=[]
}
O.push(z)
}
)
};
w.addAttributeFilter=function(j,z){
f(d(j),function(T){
var O;
for(O=0;
O<y.length;
O++){
if(y[O].name===T){
y[O].callbacks.push(z);
return
}}
y.push({
name:T,callbacks:[z]}
)
}
)
};
w.parse=function(F,z){
var T,K,Y,I,G,E,M,B,N,X,H;
var O,L,Z=[],V;
var D,j,R,C;
var A,S,W;
z=z||{};
x={};
g={};
O=p(m("script,style,head,html,body,title,meta,param"),k.getBlockElements());
S=k.getNonEmptyElements();
A=k.children;
H=v.validate;
W="forced_root_block" in z?z.forced_root_block:v.forced_root_block;
C=k.getWhiteSpaceElements();
L=/^[ \t\r\n]+/;
D=/[ \t\r\n]+$/;
j=/[ \t\r\n]+/g;
R=/^[ \t\r\n]+$/;
function P(){
var _a=K.firstChild,_t,_i;
function _e(_o){
if(_o){
_a=_o.firstChild;
if(_a&&_a.type==3){
_a.value=_a.value.replace(L,"")
}
_a=_o.lastChild;
if(_a&&_a.type==3){
_a.value=_a.value.replace(D,"")
}}}
if(!k.isValidChild(K.name,W.toLowerCase())){
return
}
while(_a){
_t=_a.next;
if(_a.type==3||(_a.type==1&&_a.name!=="p"&&!O[_a.name]&&!_a.attr("data-mce-type"))){
if(!_i){
_i=Q(W,1);
_i.attr(v.forced_root_block_attrs);
K.insert(_i,_a);
_i.append(_a)
}else{
_i.append(_a)
}}else{
_e(_i);
_i=null
}
_a=_t
}
_e(_i)
}
function Q(_e,_t){
var _a=new c(_e,_t),_i;
if(_e in b){
_i=x[_e];
if(_i){
_i.push(_a)
}else{
x[_e]=[_a]
}}
return _a
}
function J(_i){
var _o,_n,_e,_t,_a=k.getBlockElements();
for(_o=_i.prev;
_o&&_o.type===3;
){
_e=_o.value.replace(D,"");
if(_e.length>0){
_o.value=_e;
return
}
_n=_o.next;
if(_n){
if(_n.type==3&&_n.value.length){
_o=_o.prev;
continue
}
if(!_a[_n.name]&&_n.name!="script"&&_n.name!="style"){
_o=_o.prev;
continue
}}
_t=_o.prev;
_o.remove();
_o=_t
}}
function U(_t){
var _a,_e={};
for(_a in _t){
if(_a!=="li"&&_a!="p"){
_e[_a]=_t[_a]
}}
return _e
}
T=new h({
validate:H,allow_script_urls:v.allow_script_urls,allow_conditional_comments:v.allow_conditional_comments,self_closing_elements:U(k.getSelfClosingElements()),cdata:function(_e){
Y.append(Q("#cdata",4)).value=_e
}
,text:function(_a,_e){
var _t;
if(!V){
_a=_a.replace(j," ");
if(Y.lastChild&&O[Y.lastChild.name]){
_a=_a.replace(L,"")
}}
if(_a.length!==0){
_t=Q("#text",3);
_t.raw=!!_e;
Y.append(_t).value=_a
}}
,comment:function(_e){
Y.append(Q("#comment",8)).value=_e
}
,pi:function(_e,_t){
Y.append(Q(_e,7)).value=_t;
J(Y)
}
,doctype:function(_t){
var _e;
_e=Y.append(Q("#doctype",10));
_e.value=_t;
J(Y)
}
,start:function(_a,_t,_r){
var _o,_e,_s,_i,_n;
_s=H?k.getElementRule(_a):{};
if(_s){
_o=Q(_s.outputName||_a,1);
_o.attributes=_t;
_o.shortEnded=_r;
Y.append(_o);
_n=A[Y.name];
if(_n&&A[_o.name]&&!_n[_o.name]){
Z.push(_o)
}
_e=y.length;
while(_e--){
_i=y[_e].name;
if(_i in _t.map){
N=g[_i];
if(N){
N.push(_o)
}else{
g[_i]=[_o]
}}}
if(O[_a]){
J(_o)
}
if(!_r){
Y=_o
}
if(!V&&C[_a]){
V=true
}}}
,end:function(_e){
var _n,_a,_o,_t,_i;
_a=H?k.getElementRule(_e):{};
if(_a){
if(O[_e]){
if(!V){
_n=Y.firstChild;
if(_n&&_n.type===3){
_o=_n.value.replace(L,"");
if(_o.length>0){
_n.value=_o;
_n=_n.next
}else{
_t=_n.next;
_n.remove();
_n=_t;
while(_n&&_n.type===3){
_o=_n.value;
_t=_n.next;
if(_o.length===0||R.test(_o)){
_n.remove();
_n=_t
}
_n=_t
}}}
_n=Y.lastChild;
if(_n&&_n.type===3){
_o=_n.value.replace(D,"");
if(_o.length>0){
_n.value=_o;
_n=_n.prev
}else{
_t=_n.prev;
_n.remove();
_n=_t;
while(_n&&_n.type===3){
_o=_n.value;
_t=_n.prev;
if(_o.length===0||R.test(_o)){
_n.remove();
_n=_t
}
_n=_t
}}}}}
if(V&&C[_e]){
V=false
}
if(_a.removeEmpty||_a.paddEmpty){
if(Y.isEmpty(S)){
if(_a.paddEmpty){
Y.empty().append(new c("#text","3")).value="\u00a0"
}else{
if(!Y.attributes.map.name&&!Y.attributes.map.id){
_i=Y.parent;
if(O[Y.name]){
Y.empty().remove()
}else{
Y.unwrap()
}
Y=_i;
return
}}}}
Y=Y.parent
}}}
,k);
K=Y=new c(z.context||v.root_name,11);
T.parse(F);
if(H&&Z.length){
if(!z.context){
q(Z)
}else{
z.invalid=true
}}
if(W&&(K.name=="body"||z.isRootContent)){
P()
}
if(!z.invalid){
for(X in x){
N=b[X];
I=x[X];
M=I.length;
while(M--){
if(!I[M].parent){
I.splice(M,1)
}}
for(G=0,E=N.length;
G<E;
G++){
N[G](I,X,z)
}}
for(G=0,E=y.length;
G<E;
G++){
N=y[G];
if(N.name in g){
I=g[N.name];
M=I.length;
while(M--){
if(!I[M].parent){
I.splice(M,1)
}}
for(M=0,B=N.callbacks.length;
M<B;
M++){
N.callbacks[M](I,N.name,z)
}}}}
return K
};
if(v.remove_trailing_brs){
w.addNodeFilter("br",function(z){
var B,W=z.length,T,M=p({}
,k.getBlockElements());
var j=k.getNonEmptyElements(),S,C,A,F;
var D,O;
M.body=1;
for(B=0;
B<W;
B++){
T=z[B];
S=T.parent;
if(M[T.parent.name]&&T===S.lastChild){
A=T.prev;
while(A){
F=A.name;
if(F!=="span"||A.attr("data-mce-type")!=="bookmark"){
if(F!=="br"){
break
}
if(F==="br"){
T=null;
break
}}
A=A.prev
}
if(T){
T.remove();
if(S.isEmpty(j)){
D=k.getElementRule(S.name);
if(D){
if(D.removeEmpty){
S.remove()
}else{
if(D.paddEmpty){
S.empty().append(new c("#text",3)).value="\u00a0"
}}}}}}else{
C=T;
while(S&&S.firstChild===C&&S.lastChild===C){
C=S;
if(M[S.name]){
break
}
S=S.parent
}
if(C===S){
O=new c("#text",3);
O.value="\u00a0";
T.replace(O)
}}}}
)
}
if(!v.allow_html_in_named_anchor){
w.addAttributeFilter("id,name",function(j){
var T=j.length,A,z,O,W;
while(T--){
W=j[T];
if(W.name==="a"&&W.firstChild&&!W.attr("href")){
O=W.parent;
A=W.lastChild;
do{
z=A.prev;
O.insert(A,W);
A=z
}
while(A)
}}}
)
}
if(v.validate&&k.getValidClasses()){
w.addAttributeFilter("class",function(z){
var W=z.length,A,T,S,C,O;
var D=k.getValidClasses(),B,j;
while(W--){
A=z[W];
T=A.attr("class").split(" ");
O="";
for(S=0;
S<T.length;
S++){
C=T[S];
j=false;
B=D["*"];
if(B&&B[C]){
j=true
}
B=D[A.name];
if(!j&&B&&B[C]){
j=true
}
if(j){
if(O){
O+=" "
}
O+=C
}}
if(!O.length){
O=null
}
A.attr("class",O)
}}
)
}}
}
);
r("tinymce/html/Writer",["tinymce/html/Entities","tinymce/util/Tools"],function(c,h){
var l=h.makeMap;
return function(p){
var m=[],d,u,f,g,y;
p=p||{};
d=p.indent;
u=l(p.indent_before||"");
f=l(p.indent_after||"");
g=c.getEncodeFunc(p.entity_encoding||"raw",p.entities);
y=p.element_format=="html";
return{
start:function(k,v,j){
var x,w,b,q;
if(d&&u[k]&&m.length>0){
q=m[m.length-1];
if(q.length>0&&q!=="\n"){
m.push("\n")
}}
m.push("<",k);
if(v){
for(x=0,w=v.length;
x<w;
x++){
b=v[x];
m.push(" ",b.name,'="',g(b.value,true),'"')
}}
if(!j||y){
m[m.length]=">"
}else{
m[m.length]=" />"
}
if(j&&d&&f[k]&&m.length>0){
q=m[m.length-1];
if(q.length>0&&q!=="\n"){
m.push("\n")
}}}
,end:function(b){
var w;
m.push("</",b,">");
if(d&&f[b]&&m.length>0){
w=m[m.length-1];
if(w.length>0&&w!=="\n"){
m.push("\n")
}}}
,text:function(w,b){
if(w.length>0){
m[m.length]=b?w:g(w)
}}
,cdata:function(b){
m.push("<![CDATA[",b,"]]>")
}
,comment:function(b){
m.push("<!--",b,"-->")
}
,pi:function(b,w){
if(w){
m.push("<?",b," ",g(w),"?>")
}else{
m.push("<?",b,"?>")
}
if(d){
m.push("\n")
}}
,doctype:function(b){
m.push("<!DOCTYPE",b,">",d?"\n":"")
}
,reset:function(){
m.length=0
}
,getContent:function(){
return m.join("").replace(/\n$/,"")
}}
}
}
);
r("tinymce/html/Serializer",["tinymce/html/Writer","tinymce/html/Schema"],function(l,h){
return function(d,u){
var c=this,m=new l(d);
d=d||{};
d.validate="validate" in d?d.validate:true;
c.schema=u=u||new h();
c.writer=m;
c.serialize=function(g){
var p,y;
y=d.validate;
p={
3:function(b){
m.text(b.value,b.raw)
}
,8:function(b){
m.comment(b.value)
}
,7:function(b){
m.pi(b.name,b.value)
}
,10:function(b){
m.doctype(b.value)
}
,4:function(b){
m.cdata(b.value)
}
,11:function(b){
if((b=b.firstChild)){
do{
f(b)
}
while((b=b.next))
}}};
m.reset();
function f(w){
var O=p[w.type],b,x,T,z,q,A,k,v,j;
if(!O){
b=w.name;
x=w.shortEnded;
T=w.attributes;
if(y&&T&&T.length>1){
A=[];
A.map={};
j=u.getElementRule(w.name);
for(k=0,v=j.attributesOrder.length;
k<v;
k++){
z=j.attributesOrder[k];
if(z in T.map){
q=T.map[z];
A.map[z]=q;
A.push({
name:z,value:q}
)
}}
for(k=0,v=T.length;
k<v;
k++){
z=T[k].name;
if(!(z in A.map)){
q=T.map[z];
A.map[z]=q;
A.push({
name:z,value:q}
)
}}
T=A
}
m.start(w.name,T,x);
if(!x){
if((w=w.firstChild)){
do{
f(w)
}
while((w=w.next))
}
m.end(b)
}}else{
O(w)
}}
if(g.type==1&&!d.inner){
f(g)
}else{
p[11](g)
}
return m.getContent()
}
}
}
);
r("tinymce/dom/Serializer",["tinymce/dom/DOMUtils","tinymce/html/DomParser","tinymce/html/Entities","tinymce/html/Serializer","tinymce/html/Node","tinymce/html/Schema","tinymce/Env","tinymce/util/Tools"],function(p,w,l,f,u,d,m,c){
var y=c.each,h=c.trim;
var b=p.DOM;
function g(k){
var q,x;
function v(j){
return j&&j.name==="br"
}
q=k.lastChild;
if(v(q)){
x=q.prev;
if(v(x)){
q.remove();
x.remove()
}}}
return function(x,k){
var j,q,v;
if(k){
j=k.dom;
q=k.schema
}
j=j||b;
q=q||new d(x);
x.entity_encoding=x.entity_encoding||"named";
x.remove_trailing_brs="remove_trailing_brs" in x?x.remove_trailing_brs:true;
v=new w(x,q);
v.addAttributeFilter("data-mce-tabindex",function(z,T){
var O=z.length,A;
while(O--){
A=z[O];
A.attr("tabindex",A.attributes.map["data-mce-tabindex"]);
A.attr(T,null)
}}
);
v.addAttributeFilter("src,href,style",function(T,z){
var B=T.length,O,D,W="data-mce-"+z;
var C=x.url_converter,S=x.url_converter_scope,A;
while(B--){
O=T[B];
D=O.attributes.map[W];
if(D!==A){
O.attr(z,D.length>0?D:null);
O.attr(W,null)
}else{
D=O.attributes.map[z];
if(z==="style"){
D=j.serializeStyle(j.parseStyle(D),O.name)
}else{
if(C){
D=C.call(S,D,z,O.name)
}}
O.attr(z,D.length>0?D:null)
}}}
);
v.addAttributeFilter("class",function(z){
var T=z.length,O,A;
while(T--){
O=z[T];
A=O.attr("class");
if(A){
A=O.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,"");
O.attr("class",A.length>0?A:null)
}}}
);
v.addAttributeFilter("data-mce-type",function(z,O,T){
var A=z.length,W;
while(A--){
W=z[A];
if(W.attributes.map["data-mce-type"]==="bookmark"&&!T.cleanup){
W.remove()
}}}
);
v.addNodeFilter("noscript",function(z){
var T=z.length,O;
while(T--){
O=z[T].firstChild;
if(O){
O.value=l.decode(O.value)
}}}
);
v.addNodeFilter("script,style",function(T,O){
var A=T.length,B,C,W;
function z(D){
return D.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")
}
while(A--){
B=T[A];
C=B.firstChild?B.firstChild.value:"";
if(O==="script"){
W=B.attr("type");
if(W){
B.attr("type",W=="mce-no/type"?null:W.replace(/^mce\-/,""))
}
if(C.length>0){
B.firstChild.value="// <![CDATA[\n"+z(C)+"\n// ]]>"
}}else{
if(C.length>0){
B.firstChild.value="<!--\n"+z(C)+"\n-->"
}}}}
);
v.addNodeFilter("#comment",function(z){
var T=z.length,O;
while(T--){
O=z[T];
if(O.value.indexOf("[CDATA[")===0){
O.name="#cdata";
O.type=4;
O.value=O.value.replace(/^\[CDATA\[|\]\]$/g,"")
}else{
if(O.value.indexOf("mce:protected ")===0){
O.name="#text";
O.type=3;
O.raw=true;
O.value=unescape(O.value).substr(14)
}}}}
);
v.addNodeFilter("xml:namespace,input",function(z,T){
var O=z.length,A;
while(O--){
A=z[O];
if(A.type===7){
A.remove()
}else{
if(A.type===1){
if(T==="input"&&!("type" in A.attributes.map)){
A.attr("type","text")
}}}}}
);
if(x.fix_list_elements){
v.addNodeFilter("ul,ol",function(T){
var O=T.length,A,z;
while(O--){
A=T[O];
z=A.parent;
if(z.name==="ul"||z.name==="ol"){
if(A.prev&&A.prev.name==="li"){
A.prev.append(A)
}}}}
)
}
v.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize",function(z,T){
var O=z.length;
while(O--){
z[O].attr(T,null)
}}
);
return{
schema:q,addNodeFilter:v.addNodeFilter,addAttributeFilter:v.addAttributeFilter,serialize:function(T,B){
var S=this,C,D,A,O,W,z;
if(m.ie&&j.select("script,style,select,map").length>0){
W=T.innerHTML;
T=T.cloneNode(false);
j.setHTML(T,W)
}else{
T=T.cloneNode(true)
}
C=T.ownerDocument.implementation;
if(C.createHTMLDocument){
D=C.createHTMLDocument("");
y(T.nodeName=="BODY"?T.childNodes:[T],function(F){
D.body.appendChild(D.importNode(F,true))
}
);
if(T.nodeName!="BODY"){
T=D.body.firstChild
}else{
T=D.body
}
A=j.doc;
j.doc=D
}
B=B||{};
B.format=B.format||"html";
if(B.selection){
B.forced_root_block=""
}
if(!B.no_events){
B.node=T;
S.onPreProcess(B)
}
z=v.parse(h(B.getInner?T.innerHTML:j.getOuterHTML(T)),B);
g(z);
O=new f(x,q);
B.content=O.serialize(z);
if(!B.cleanup){
B.content=B.content.replace(/\uFEFF/g,"")
}
if(!B.no_events){
S.onPostProcess(B)
}
if(A){
j.doc=A
}
B.node=null;
return B.content
}
,addRules:function(z){
q.addValidElements(z)
}
,setRules:function(z){
q.setValidElements(z)
}
,onPreProcess:function(z){
if(k){
k.fire("PreProcess",z)
}}
,onPostProcess:function(z){
if(k){
k.fire("PostProcess",z)
}}}
}
}
);
r("tinymce/dom/TridentSelection",[],function(){
function h(c){
var l=this,f=c.dom,u=false;
function d(p,g){
var y,T=0,q,v,w,b,k,j,x=-1,z;
y=p.duplicate();
y.collapse(g);
z=y.parentElement();
if(z.ownerDocument!==c.dom.doc){
return
}
while(z.contentEditable==="false"){
z=z.parentNode
}
if(!z.hasChildNodes()){
return{
node:z,inside:1}
}
w=z.children;
q=w.length-1;
while(T<=q){
j=Math.floor((T+q)/2);
b=w[j];
y.moveToElementText(b);
x=y.compareEndPoints(g?"StartToStart":"EndToEnd",p);
if(x>0){
q=j-1
}else{
if(x<0){
T=j+1
}else{
return{
node:b}
}}}
if(x<0){
if(!b){
y.moveToElementText(z);
y.collapse(true);
b=z;
v=true
}else{
y.collapse(false)
}
k=0;
while(y.compareEndPoints(g?"StartToStart":"StartToEnd",p)!==0){
if(y.move("character",1)===0||z!=y.parentElement()){
break
}
k++
}}else{
y.collapse(true);
k=0;
while(y.compareEndPoints(g?"StartToStart":"StartToEnd",p)!==0){
if(y.move("character",-1)===0||z!=y.parentElement()){
break
}
k++
}}
return{
node:b,position:x,offset:k,inside:v}
}
function m(){
var p=c.getRng(),q=f.createRng(),y,g,k,x,b;
y=p.item?p.item(0):p.parentElement();
if(y.ownerDocument!=f.doc){
return q
}
g=c.isCollapsed();
if(p.item){
q.setStart(y.parentNode,f.nodeIndex(y));
q.setEnd(q.startContainer,q.startOffset+1);
return q
}
function v(C){
var T=d(p,C),j,W,B=0,A,O,z;
j=T.node;
W=T.offset;
if(T.inside&&!j.hasChildNodes()){
q[C?"setStart":"setEnd"](j,0);
return
}
if(W===O){
q[C?"setStartBefore":"setEndAfter"](j);
return
}
if(T.position<0){
A=T.inside?j.firstChild:j.nextSibling;
if(!A){
q[C?"setStartAfter":"setEndAfter"](j);
return
}
if(!W){
if(A.nodeType==3){
q[C?"setStart":"setEnd"](A,0)
}else{
q[C?"setStartBefore":"setEndBefore"](A)
}
return
}
while(A){
if(A.nodeType==3){
z=A.nodeValue;
B+=z.length;
if(B>=W){
j=A;
B-=W;
B=z.length-B;
break
}}
A=A.nextSibling
}}else{
A=j.previousSibling;
if(!A){
return q[C?"setStartBefore":"setEndBefore"](j)
}
if(!W){
if(j.nodeType==3){
q[C?"setStart":"setEnd"](A,j.nodeValue.length)
}else{
q[C?"setStartAfter":"setEndAfter"](A)
}
return
}
while(A){
if(A.nodeType==3){
B+=A.nodeValue.length;
if(B>=W){
j=A;
B-=W;
break
}}
A=A.previousSibling
}}
q[C?"setStart":"setEnd"](j,B)
}
try{
v(true);
if(!g){
v()
}}
catch(w){
if(w.number==-2147024809){
b=l.getBookmark(2);
k=p.duplicate();
k.collapse(true);
y=k.parentElement();
if(!g){
k=p.duplicate();
k.collapse(false);
x=k.parentElement();
x.innerHTML=x.innerHTML
}
y.innerHTML=y.innerHTML;
l.moveToBookmark(b);
p=c.getRng();
v(true);
if(!g){
v()
}}else{
throw w
}}
return q
}
this.getBookmark=function(b){
var p=c.getRng(),y={};
function w(z){
var j,v,q,x,k=[];
j=z.parentNode;
v=f.getRoot().parentNode;
while(j!=v&&j.nodeType!==9){
q=j.children;
x=q.length;
while(x--){
if(z===q[x]){
k.push(x);
break
}}
z=j;
j=j.parentNode
}
return k
}
function g(k){
var v;
v=d(p,k);
if(v){
return{
position:v.position,offset:v.offset,indexes:w(v.node),inside:v.inside}
}}
if(b===2){
if(!p.item){
y.start=g(true);
if(!c.isCollapsed()){
y.end=g()
}}else{
y.start={
ctrl:true,indexes:w(p.item(0))}
}}
return y
};
this.moveToBookmark=function(y){
var g,p=f.doc.body;
function w(k){
var j,q,v,x;
j=f.getRoot();
for(q=k.length-1;
q>=0;
q--){
x=j.children;
v=k[q];
if(v<=x.length-1){
j=x[v]
}}
return j
}
function b(z){
var v=y[z?"start":"end"],q,x,k,j;
if(v){
q=v.position>0;
x=p.createTextRange();
x.moveToElementText(w(v.indexes));
j=v.offset;
if(j!==k){
x.collapse(v.inside||q);
x.moveStart("character",q?-j:j)
}else{
x.collapse(z)
}
g.setEndPoint(z?"StartToStart":"EndToStart",x);
if(z){
g.collapse(true)
}}}
if(y.start){
if(y.start.ctrl){
g=p.createControlRange();
g.addElement(w(y.start.indexes));
g.select()
}else{
g=p.createTextRange();
b(true);
b();
g.select()
}}};
this.addRange=function(p){
var v,b,y,x,A,q,T,z=c.dom.doc,w=z.body,j,O;
function g(F){
var B,S,W,D,C;
W=f.create("a");
B=F?y:A;
S=F?x:q;
D=v.duplicate();
if(B==z||B==z.documentElement){
B=w;
S=0
}
if(B.nodeType==3){
B.parentNode.insertBefore(W,B);
D.moveToElementText(W);
D.moveStart("character",S);
f.remove(W);
v.setEndPoint(F?"StartToStart":"EndToEnd",D)
}else{
C=B.childNodes;
if(C.length){
if(S>=C.length){
f.insertAfter(W,C[C.length-1])
}else{
B.insertBefore(W,C[S])
}
D.moveToElementText(W)
}else{
if(B.canHaveHTML){
B.innerHTML="<span>&#xFEFF;</span>";
W=B.firstChild;
D.moveToElementText(W);
D.collapse(u)
}}
v.setEndPoint(F?"StartToStart":"EndToEnd",D);
f.remove(W)
}}
y=p.startContainer;
x=p.startOffset;
A=p.endContainer;
q=p.endOffset;
v=w.createTextRange();
if(y==A&&y.nodeType==1){
if(x==q&&!y.hasChildNodes()){
if(y.canHaveHTML){
T=y.previousSibling;
if(T&&!T.hasChildNodes()&&f.isBlock(T)){
T.innerHTML="&#xFEFF;"
}else{
T=null
}
y.innerHTML="<span>&#xFEFF;</span><span>&#xFEFF;</span>";
v.moveToElementText(y.lastChild);
v.select();
f.doc.selection.clear();
y.innerHTML="";
if(T){
T.innerHTML=""
}
return
}
x=f.nodeIndex(y);
y=y.parentNode
}
if(x==q-1){
try{
O=y.childNodes[x];
b=w.createControlRange();
b.addElement(O);
b.select();
j=c.getRng();
if(j.item&&O===j.item(0)){
return
}}
catch(k){}}}
g(true);
g();
v.select()
};
this.getRangeAt=m
}
return h
}
);
r("tinymce/util/VK",["tinymce/Env"],function(h){
return{
BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(l){
return l.shiftKey||l.ctrlKey||l.altKey||this.metaKeyPressed(l)
}
,metaKeyPressed:function(l){
return(h.mac?l.metaKey:l.ctrlKey&&!l.altKey)
}}
}
);
r("tinymce/dom/ControlSelection",["tinymce/util/VK","tinymce/util/Tools","tinymce/Env"],function(c,l,h){
return function(j,u){
var m=u.dom,U=l.each;
var k,_a,E,L,_e,Z;
var W,O,I,H,B,M,N,y;
var d,f,x=u.getDoc(),X=document,v=h.ie&&h.ie<11;
var F=Math.abs,V=Math.round,T=u.getBody(),C,p;
L={
nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};
var A=".mce-content-body";
u.contentStyles.push(A+" div.mce-resizehandle {position: absolute;border: 1px solid black;background: #FFF;width: 7px;height: 7px;z-index: 10000}"+A+" .mce-resizehandle:hover {background: #000}"+A+" img[data-mce-selected], hr[data-mce-selected] {outline: 1px solid black;resize: none}"+A+" .mce-clonedresizable {position: absolute;"+(h.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}"+A+" .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}");
function J(_o){
var _i=u.settings.object_resizing;
if(_i===false||h.iOS){
return false
}
if(typeof _i!="string"){
_i="table,img,div"
}
if(_o.getAttribute("data-mce-resize")==="false"){
return false
}
return u.dom.is(_o,_i)
}
function g(_s){
var _o,_i,_n;
var _h,_r;
_o=_s.screenX-W;
_i=_s.screenY-O;
d=_o*_e[2]+B;
f=_i*_e[3]+M;
d=d<5?5:d;
f=f<5?5:f;
if(k.nodeName=="IMG"&&u.settings.resize_img_proportional!==false){
_n=!c.modifierPressed(_s)
}else{
_n=c.modifierPressed(_s)||(k.nodeName=="IMG"&&_e[2]*_e[3]!==0)
}
if(_n){
if(F(_o)>F(_i)){
f=V(d*N);
d=V(f/N)
}else{
d=V(f/N);
f=V(d*N)
}}
m.setStyles(_a,{
width:d,height:f}
);
_h=_e.startPos.x+_o;
_r=_e.startPos.y+_i;
_h=_h>0?_h:0;
_r=_r>0?_r:0;
m.setStyles(E,{
left:_h,top:_r,display:"block"}
);
E.innerHTML=d+" &times; "+f;
if(_e[2]<0&&_a.clientWidth<=d){
m.setStyle(_a,"left",I+(B-d))
}
if(_e[3]<0&&_a.clientHeight<=f){
m.setStyle(_a,"top",H+(M-f))
}
_o=T.scrollWidth-C;
_i=T.scrollHeight-p;
if(_o+_i!==0){
m.setStyles(E,{
left:_h-_o,top:_r-_i}
)
}
if(!y){
u.fire("ObjectResizeStart",{
target:k,width:B,height:M}
);
y=true
}}
function G(){
y=false;
function _i(_o,_n){
if(_n){
if(k.style[_o]||!u.schema.isValid(k.nodeName.toLowerCase(),_o)){
m.setStyle(k,_o,_n)
}else{
m.setAttrib(k,_o,_n)
}}}
_i("width",d);
_i("height",f);
m.unbind(x,"mousemove",g);
m.unbind(x,"mouseup",G);
if(X!=x){
m.unbind(X,"mousemove",g);
m.unbind(X,"mouseup",G)
}
m.remove(_a);
m.remove(E);
if(!v||k.nodeName=="TABLE"){
R(k)
}
u.fire("ObjectResized",{
target:k,width:d,height:f}
);
m.setAttrib(k,"style",m.getAttrib(k,"style"));
u.nodeChanged()
}
function R(_l,_r,_n){
var _o,_s,_i,_c,_h;
_t();
_o=m.getPos(_l,T);
I=_o.x;
H=_o.y;
_h=_l.getBoundingClientRect();
_s=_h.width||(_h.right-_h.left);
_i=_h.height||(_h.bottom-_h.top);
if(k!=_l){
K();
k=_l;
d=f=0
}
_c=u.fire("ObjectSelected",{
target:_l}
);
if(J(_l)&&!_c.isDefaultPrevented()){
U(L,function(_f,_u){
var _m;
function _d(_p){
W=_p.screenX;
O=_p.screenY;
B=k.clientWidth;
M=k.clientHeight;
N=M/B;
_e=_f;
_f.startPos={
x:_s*_f[0]+I,y:_i*_f[1]+H};
C=T.scrollWidth;
p=T.scrollHeight;
_a=k.cloneNode(true);
m.addClass(_a,"mce-clonedresizable");
m.setAttrib(_a,"data-mce-bogus","all");
_a.contentEditable=false;
_a.unSelectabe=true;
m.setStyles(_a,{
left:I,top:H,margin:0}
);
_a.removeAttribute("data-mce-selected");
T.appendChild(_a);
m.bind(x,"mousemove",g);
m.bind(x,"mouseup",G);
if(X!=x){
m.bind(X,"mousemove",g);
m.bind(X,"mouseup",G)
}
E=m.add(T,"div",{
"class":"mce-resize-helper","data-mce-bogus":"all"}
,B+" &times; "+M)
}
if(_r){
if(_u==_r){
_d(_n)
}
return
}
_m=m.get("mceResizeHandle"+_u);
if(_m){
m.remove(_m)
}
_m=m.add(T,"div",{
id:"mceResizeHandle"+_u,"data-mce-bogus":"all","class":"mce-resizehandle",unselectable:true,style:"cursor:"+_u+"-resize; margin:0; padding:0"}
);
if(h.ie){
_m.contentEditable=false
}
m.bind(_m,"mousedown",function(_p){
_p.stopImmediatePropagation();
_p.preventDefault();
_d(_p)
}
);
_f.elm=_m;
m.setStyles(_m,{
left:(_s*_f[0]+I)-(_m.offsetWidth/2),top:(_i*_f[1]+H)-(_m.offsetHeight/2)}
)
}
)
}else{
D()
}
k.setAttribute("data-mce-selected","1")
}
function D(){
var _i,_o;
_t();
if(k){
k.removeAttribute("data-mce-selected")
}
for(_i in L){
_o=m.get("mceResizeHandle"+_i);
if(_o){
m.unbind(_o);
m.remove(_o)
}}}
function S(_s){
var _n,_i;
function _o(_h,_r){
if(_h){
do{
if(_h===_r){
return true
}}
while((_h=_h.parentNode))
}}
if(y||u.removed){
return
}
U(m.select("img[data-mce-selected],hr[data-mce-selected]"),function(_r){
_r.removeAttribute("data-mce-selected")
}
);
_i=_s.type=="mousedown"?_s.target:j.getNode();
_i=m.$(_i).closest(v?"table":"table,img,hr")[0];
if(_o(_i,T)){
Y();
_n=j.getStart(true);
if(_o(_n,_i)&&_o(j.getEnd(true),_i)){
if(!v||(_i!=_n&&_n.nodeName!=="IMG")){
R(_i);
return
}}}
D()
}
function b(_n,_i,_o){
if(_n&&_n.attachEvent){
_n.attachEvent("on"+_i,_o)
}}
function z(_n,_i,_o){
if(_n&&_n.detachEvent){
_n.detachEvent("on"+_i,_o)
}}
function q(_n){
var _s=_n.srcElement,_c,_i,_d,_l,_r,_h,_o;
_c=_s.getBoundingClientRect();
_h=Z.clientX-_c.left;
_o=Z.clientY-_c.top;
for(_i in L){
_d=L[_i];
_l=_s.offsetWidth*_d[0];
_r=_s.offsetHeight*_d[1];
if(F(_l-_h)<8&&F(_r-_o)<8){
_e=_d;
break
}}
y=true;
u.fire("ObjectResizeStart",{
target:k,width:k.clientWidth,height:k.clientHeight}
);
u.getDoc().selection.empty();
R(_s,_i,Z)
}
function Q(_o){
var _i=_o.srcElement;
if(_i!=k){
u.fire("ObjectSelected",{
target:_i}
);
K();
if(_i.id.indexOf("mceResizeHandle")===0){
_o.returnValue=false;
return
}
if(_i.nodeName=="IMG"||_i.nodeName=="TABLE"){
D();
k=_i;
b(_i,"resizestart",q)
}}}
function K(){
z(k,"resizestart",q)
}
function _t(){
for(var _i in L){
var _o=L[_i];
if(_o.elm){
m.unbind(_o.elm);
delete _o.elm
}}}
function Y(){
try{
u.getDoc().execCommand("enableObjectResizing",false,false)
}
catch(_i){}}
function w(_n){
var _o;
if(!v){
return
}
_o=x.body.createControlRange();
try{
_o.addElement(_n);
_o.select();
return true
}
catch(_i){}}
u.on("init",function(){
if(v){
u.on("ObjectResized",function(_i){
if(_i.target.nodeName!="TABLE"){
D();
w(_i.target)
}}
);
b(T,"controlselect",Q);
u.on("mousedown",function(_i){
Z=_i
}
)
}else{
Y();
if(h.ie>=11){
u.on("mousedown click",function(_i){
var _o=_i.target.nodeName;
if(!y&&/^(TABLE|IMG|HR)$/.test(_o)){
u.selection.select(_i.target,_o=="TABLE");
if(_i.type=="mousedown"){
u.nodeChanged()
}}}
);
u.dom.bind(T,"mscontrolselect",function(_i){
if(/^(TABLE|IMG|HR)$/.test(_i.target.nodeName)){
_i.preventDefault();
if(_i.target.tagName=="IMG"){
window.setTimeout(function(){
u.selection.select(_i.target)
}
,0)
}}}
)
}}
u.on("nodechange ResizeEditor ResizeWindow drop",function(_i){
if(window.requestAnimationFrame){
window.requestAnimationFrame(function(){
S(_i)
}
)
}else{
S(_i)
}}
);
u.on("keydown keyup",function(_i){
if(k&&k.nodeName=="TABLE"){
S(_i)
}}
);
u.on("hide blur",D)
}
);
u.on("remove",_t);
function P(){
k=_a=null;
if(v){
K();
z(T,"controlselect",Q)
}}
return{
isResizable:J,showResizeRect:R,hideResizeRect:D,updateResizeRect:S,controlSelect:w,destroy:P}
}
}
);
r("tinymce/dom/BookmarkManager",["tinymce/Env","tinymce/util/Tools"],function(h,c){
function l(d){
var u=d.dom;
this.getBookmark=function(q,z){
var f,y,g,v,p,k,w="&#xFEFF;",T;
function m(A,W){
var O=0;
c.each(u.select(A),function(C,B){
if(C==W){
O=B
}}
);
return O
}
function j(O){
function A(S){
var W,D,C,B=S?"start":"end";
W=O[B+"Container"];
D=O[B+"Offset"];
if(W.nodeType==1&&W.nodeName=="TR"){
C=W.childNodes;
W=C[Math.min(S?D:D-1,C.length-1)];
if(W){
D=S?0:W.childNodes.length;
O["set"+(S?"Start":"End")](W,D)
}}}
A(true);
A();
return O
}
function b(){
var A=d.getRng(true),O=u.getRoot(),W={};
function B(S,I){
var D=S[I?"startContainer":"endContainer"],H=S[I?"startOffset":"endOffset"],C=[],F,R,M=0;
if(D.nodeType==3){
if(z){
for(F=D.previousSibling;
F&&F.nodeType==3;
F=F.previousSibling){
H+=F.nodeValue.length
}}
C.push(H)
}else{
R=D.childNodes;
if(H>=R.length&&R.length){
M=1;
H=Math.max(0,R.length-1)
}
C.push(u.nodeIndex(R[H],z)+M)
}
for(;
D&&D!=O;
D=D.parentNode){
C.push(u.nodeIndex(D,z))
}
return C
}
W.start=B(A,true);
if(!d.isCollapsed()){
W.end=B(A)
}
return W
}
if(q==2){
k=d.getNode();
p=k?k.nodeName:null;
if(p=="IMG"){
return{
name:p,index:m(p,k)}
}
if(d.tridentSel){
return d.tridentSel.getBookmark(q)
}
return b()
}
if(q){
return{
rng:d.getRng()}
}
f=d.getRng();
g=u.uniqueId();
v=d.isCollapsed();
T="overflow:hidden;line-height:0px";
if(f.duplicate||f.item){
if(!f.item){
y=f.duplicate();
try{
f.collapse();
f.pasteHTML('<span data-mce-type="bookmark" id="'+g+'_start" style="'+T+'">'+w+"</span>");
if(!v){
y.collapse(false);
f.moveToElementText(y.parentElement());
if(f.compareEndPoints("StartToEnd",y)===0){
y.move("character",-1)
}
y.pasteHTML('<span data-mce-type="bookmark" id="'+g+'_end" style="'+T+'">'+w+"</span>")
}}
catch(x){
return null
}}else{
k=f.item(0);
p=k.nodeName;
return{
name:p,index:m(p,k)}
}}else{
k=d.getNode();
p=k.nodeName;
if(p=="IMG"){
return{
name:p,index:m(p,k)}
}
y=j(f.cloneRange());
if(!v){
y.collapse(false);
y.insertNode(u.create("span",{
"data-mce-type":"bookmark",id:g+"_end",style:T}
,w))
}
f=j(f);
f.collapse(true);
f.insertNode(u.create("span",{
"data-mce-type":"bookmark",id:g+"_start",style:T}
,w))
}
d.moveToBookmark({
id:g,keep:1}
);
return{
id:g}
};
this.moveToBookmark=function(b){
var m,k,p,x,w,v;
function f(A){
var q=b[A?"start":"end"],z,T,O,j;
if(q){
O=q[0];
for(T=k,z=q.length-1;
z>=1;
z--){
j=T.childNodes;
if(q[z]>j.length-1){
return
}
T=j[q[z]]
}
if(T.nodeType===3){
O=Math.min(q[0],T.nodeValue.length)
}
if(T.nodeType===1){
O=Math.min(q[0],T.childNodes.length)
}
if(A){
m.setStart(T,O)
}else{
m.setEnd(T,O)
}}
return true
}
function g(W){
var j=u.get(b.id+"_"+W),A,q,T,O,z=b.keep;
if(j){
A=j.parentNode;
if(W=="start"){
if(!z){
q=u.nodeIndex(j)
}else{
A=j.firstChild;
q=1
}
p=x=A;
w=v=q
}else{
if(!z){
q=u.nodeIndex(j)
}else{
A=j.firstChild;
q=1
}
x=A;
v=q
}
if(!z){
O=j.previousSibling;
T=j.nextSibling;
c.each(c.grep(j.childNodes),function(B){
if(B.nodeType==3){
B.nodeValue=B.nodeValue.replace(/\uFEFF/g,"")
}}
);
while((j=u.get(b.id+"_"+W))){
u.remove(j,1)
}
if(O&&T&&O.nodeType==T.nodeType&&O.nodeType==3&&!h.opera){
q=O.nodeValue.length;
O.appendData(T.nodeValue);
u.remove(T);
if(W=="start"){
p=x=O;
w=v=q
}else{
x=O;
v=q
}}}}}
function y(q){
if(u.isBlock(q)&&!q.innerHTML&&!h.ie){
q.innerHTML='<br data-mce-bogus="1" />'
}
return q
}
if(b){
if(b.start){
m=u.createRng();
k=u.getRoot();
if(d.tridentSel){
return d.tridentSel.moveToBookmark(b)
}
if(f(true)&&f()){
d.setRng(m)
}}else{
if(b.id){
g("start");
g("end");
if(p){
m=u.createRng();
m.setStart(y(p),w);
m.setEnd(y(x),v);
d.setRng(m)
}}else{
if(b.name){
d.select(u.select(b.name)[b.index])
}else{
if(b.rng){
d.setRng(b.rng)
}}}}}}
}
l.isBookmarkNode=function(d){
return d&&d.tagName==="SPAN"&&d.getAttribute("data-mce-type")==="bookmark"
};
return l
}
);
r("tinymce/dom/Selection",["tinymce/dom/TreeWalker","tinymce/dom/TridentSelection","tinymce/dom/ControlSelection","tinymce/dom/RangeUtils","tinymce/dom/BookmarkManager","tinymce/Env","tinymce/util/Tools"],function(g,f,h,u,y,m,d){
var p=d.each,c=d.trim;
var l=m.ie;
function b(q,x,k,v){
var w=this;
w.dom=q;
w.win=x;
w.serializer=k;
w.editor=v;
w.bookmarkManager=new y(w);
w.controlSelection=new h(w,v);
if(!w.win.getSelection){
w.tridentSel=new f(w)
}}
b.prototype={
setCursorLocation:function(k,x){
var v=this,w=v.dom.createRng();
if(!k){
v._moveEndPoint(w,v.editor.getBody(),true);
v.setRng(w)
}else{
w.setStart(k,x);
w.setEnd(k,x);
v.setRng(w);
v.collapse(false)
}}
,getContent:function(q){
var k=this,v=k.getRng(),w=k.dom.create("body");
var T=k.getSel(),z,j,x;
q=q||{};
z=j="";
q.get=true;
q.format=q.format||"html";
q.selection=true;
k.editor.fire("BeforeGetContent",q);
if(q.format=="text"){
return k.isCollapsed()?"":(v.text||(T.toString?T.toString():""))
}
if(v.cloneContents){
x=v.cloneContents();
if(x){
w.appendChild(x)
}}else{
if(v.item!==s||v.htmlText!==s){
w.innerHTML="<br>"+(v.item?v.item(0).outerHTML:v.htmlText);
w.removeChild(w.firstChild)
}else{
w.innerHTML=v.toString()
}}
if(/^\s/.test(w.innerHTML)){
z=" "
}
if(/\s+$/.test(w.innerHTML)){
j=" "
}
q.getInner=true;
q.content=k.isCollapsed()?"":z+k.serializer.serialize(w,q)+j;
k.editor.fire("GetContent",q);
return q.content
}
,setContent:function(v,x){
var O=this,w=O.getRng(),q,j=O.win.document,T,z;
x=x||{
format:"html"};
x.set=true;
x.selection=true;
v=x.content=v;
if(!x.no_events){
O.editor.fire("BeforeSetContent",x)
}
v=x.content;
if(w.insertNode){
v+='<span id="__caret">_</span>';
if(w.startContainer==j&&w.endContainer==j){
j.body.innerHTML=v
}else{
w.deleteContents();
if(j.body.childNodes.length===0){
j.body.innerHTML=v
}else{
if(w.createContextualFragment){
w.insertNode(w.createContextualFragment(v))
}else{
T=j.createDocumentFragment();
z=j.createElement("div");
T.appendChild(z);
z.outerHTML=v;
w.insertNode(T)
}}}
q=O.dom.get("__caret");
w=j.createRange();
w.setStartBefore(q);
w.setEndBefore(q);
O.setRng(w);
O.dom.remove("__caret");
try{
O.setRng(w)
}
catch(k){}}else{
if(w.item){
j.execCommand("Delete",false,null);
w=O.getRng()
}
if(/^\s+/.test(v)){
w.pasteHTML('<span id="__mce_tmp">_</span>'+v);
O.dom.remove("__mce_tmp")
}else{
w.pasteHTML(v)
}}
if(!x.no_events){
O.editor.fire("SetContent",x)
}}
,getStart:function(z){
var k=this,v=k.getRng(),x,w,j,q;
if(v.duplicate||v.item){
if(v.item){
return v.item(0)
}
j=v.duplicate();
j.collapse(1);
x=j.parentElement();
if(x.ownerDocument!==k.dom.doc){
x=k.dom.getRoot()
}
w=q=v.parentElement();
while((q=q.parentNode)){
if(q==x){
x=w;
break
}}
return x
}
x=v.startContainer;
if(x.nodeType==1&&x.hasChildNodes()){
if(!z||!v.collapsed){
x=x.childNodes[Math.min(x.childNodes.length-1,v.startOffset)]
}}
if(x&&x.nodeType==3){
return x.parentNode
}
return x
}
,getEnd:function(q){
var v=this,w=v.getRng(),x,k;
if(w.duplicate||w.item){
if(w.item){
return w.item(0)
}
w=w.duplicate();
w.collapse(0);
x=w.parentElement();
if(x.ownerDocument!==v.dom.doc){
x=v.dom.getRoot()
}
if(x&&x.nodeName=="BODY"){
return x.lastChild||x
}
return x
}
x=w.endContainer;
k=w.endOffset;
if(x.nodeType==1&&x.hasChildNodes()){
if(!q||!w.collapsed){
x=x.childNodes[k>0?k-1:k]
}}
if(x&&x.nodeType==3){
return x.parentNode
}
return x
}
,getBookmark:function(w,v){
return this.bookmarkManager.getBookmark(w,v)
}
,moveToBookmark:function(w){
return this.bookmarkManager.moveToBookmark(w)
}
,select:function(q,x){
var k=this,j=k.dom,v=j.createRng(),w;
k.lastFocusBookmark=null;
if(q){
if(!x&&k.controlSelection.controlSelect(q)){
return
}
w=j.nodeIndex(q);
v.setStart(q.parentNode,w);
v.setEnd(q.parentNode,w+1);
if(x){
k._moveEndPoint(v,q,true);
k._moveEndPoint(v,q)
}
k.setRng(v)
}
return q
}
,isCollapsed:function(){
var v=this,w=v.getRng(),k=v.getSel();
if(!w||w.item){
return false
}
if(w.compareEndPoints){
return w.compareEndPoints("StartToEnd",w)===0
}
return !k||w.collapsed
}
,collapse:function(k){
var v=this,w=v.getRng(),x;
if(w.item){
x=w.item(0);
w=v.win.document.body.createTextRange();
w.moveToElementText(x)
}
w.collapse(!!k);
v.setRng(w)
}
,getSel:function(){
var w=this.win;
return w.getSelection?w.getSelection():w.document.selection
}
,getRng:function(z){
var A=this,O,w,q,T=A.win.document,k;
function j(C,D,W){
try{
return D.compareBoundaryPoints(C,W)
}
catch(B){
return -1
}}
if(!z&&A.lastFocusBookmark){
var v=A.lastFocusBookmark;
if(v.startContainer){
w=T.createRange();
w.setStart(v.startContainer,v.startOffset);
w.setEnd(v.endContainer,v.endOffset)
}else{
w=v
}
return w
}
if(z&&A.tridentSel){
return A.tridentSel.getRangeAt(0)
}
try{
if((O=A.getSel())){
if(O.rangeCount>0){
w=O.getRangeAt(0)
}else{
w=O.createRange?O.createRange():T.createRange()
}}}
catch(x){}
if(l&&w&&w.setStart&&T.selection){
try{
k=T.selection.createRange()
}
catch(x){}
if(k&&k.item){
q=k.item(0);
w=T.createRange();
w.setStartBefore(q);
w.setEndAfter(q)
}}
if(!w){
w=T.createRange?T.createRange():T.body.createTextRange()
}
if(w.setStart&&w.startContainer.nodeType===9&&w.collapsed){
q=A.dom.getRoot();
w.setStart(q,0);
w.setEnd(q,0)
}
if(A.selectedRange&&A.explicitRange){
if(j(w.START_TO_START,w,A.selectedRange)===0&&j(w.END_TO_END,w,A.selectedRange)===0){
w=A.explicitRange
}else{
A.selectedRange=null;
A.explicitRange=null
}}
return w
}
,setRng:function(w,k){
var v=this,j,q;
if(!w){
return
}
if(w.select){
try{
w.select()
}
catch(x){}
return
}
if(!v.tridentSel){
j=v.getSel();
if(j){
v.explicitRange=w;
try{
j.removeAllRanges();
j.addRange(w)
}
catch(x){}
if(k===false&&j.extend){
j.collapse(w.endContainer,w.endOffset);
j.extend(w.startContainer,w.startOffset)
}
v.selectedRange=j.rangeCount>0?j.getRangeAt(0):null
}
if(!w.collapsed&&w.startContainer==w.endContainer&&j.setBaseAndExtent&&!m.ie){
if(w.endOffset-w.startOffset<2){
if(w.startContainer.hasChildNodes()){
q=w.startContainer.childNodes[w.startOffset];
if(q&&q.tagName=="IMG"){
v.getSel().setBaseAndExtent(q,0,q,1)
}}}}}else{
if(w.cloneRange){
try{
v.tridentSel.addRange(w);
return
}
catch(x){}}}}
,setNode:function(v){
var w=this;
w.setContent(w.dom.getOuterHTML(v));
return v
}
,getNode:function(){
var T=this,w=T.getRng(),x;
var v=w.startContainer,O=w.endContainer;
var q=w.startOffset,j=w.endOffset,z=T.dom.getRoot();
function k(W,A){
var B=W;
while(W&&W.nodeType===3&&W.length===0){
W=A?W.nextSibling:W.previousSibling
}
return W||B
}
if(!w){
return z
}
if(w.setStart){
x=w.commonAncestorContainer;
if(!w.collapsed){
if(v==O){
if(j-q<2){
if(v.hasChildNodes()){
x=v.childNodes[q]
}}}
if(v.nodeType===3&&O.nodeType===3){
if(v.length===q){
v=k(v.nextSibling,true)
}else{
v=v.parentNode
}
if(j===0){
O=k(O.previousSibling,false)
}else{
O=O.parentNode
}
if(v&&v===O){
return v
}}}
if(x&&x.nodeType==3){
return x.parentNode
}
return x
}
x=w.item?w.item(0):w.parentElement();
if(x.ownerDocument!==T.win.document){
x=z
}
return x
}
,getSelectedBlocks:function(x,k){
var v=this,T=v.dom,q,w,z=[];
w=T.getRoot();
x=T.getParent(x||v.getStart(),T.isBlock);
k=T.getParent(k||v.getEnd(),T.isBlock);
if(x&&x!=w){
z.push(x)
}
if(x&&k&&x!=k){
q=x;
var j=new g(x,w);
while((q=j.next())&&q!=k){
if(T.isBlock(q)){
z.push(q)
}}}
if(k&&x!=k&&k!=w){
z.push(k)
}
return z
}
,isForward:function(){
var k=this.dom,w=this.getSel(),x,v;
if(!w||!w.anchorNode||!w.focusNode){
return true
}
x=k.createRng();
x.setStart(w.anchorNode,w.anchorOffset);
x.collapse(true);
v=k.createRng();
v.setStart(w.focusNode,w.focusOffset);
v.collapse(true);
return x.compareBoundaryPoints(x.START_TO_START,v)<=0
}
,normalize:function(){
var v=this,w=v.getRng();
if(m.range&&new u(v.dom).normalize(w)){
v.setRng(w,v.isForward())
}
return w
}
,selectorChanged:function(w,x){
var v=this,k;
if(!v.selectorChangedData){
v.selectorChangedData={};
k={};
v.editor.on("NodeChange",function(T){
var z=T.element,O=v.dom,q=O.getParents(z,null,O.getRoot()),j={};
p(v.selectorChangedData,function(W,A){
p(q,function(B){
if(O.is(B,A)){
if(!k[A]){
p(W,function(C){
C(true,{
node:B,selector:A,parents:q}
)
}
);
k[A]=W
}
j[A]=W;
return false
}}
)
}
);
p(k,function(W,A){
if(!j[A]){
delete k[A];
p(W,function(B){
B(false,{
node:z,selector:A,parents:q}
)
}
)
}}
)
}
)
}
if(!v.selectorChangedData[w]){
v.selectorChangedData[w]=[]
}
v.selectorChangedData[w].push(x);
return v
}
,getScrollContainer:function(){
var w,v=this.dom.getRoot();
while(v&&v.nodeName!="BODY"){
if(v.scrollHeight>v.clientHeight){
w=v;
break
}
v=v.parentNode
}
return w
}
,scrollIntoView:function(x){
var j,O,A=this,k=A.dom,z=k.getRoot(),w,T;
function v(D){
var W=0,C=0;
var B=D;
while(B&&B.nodeType){
W+=B.offsetLeft||0;
C+=B.offsetTop||0;
B=B.offsetParent
}
return{
x:W,y:C}
}
if(z.nodeName!="BODY"){
var q=A.getScrollContainer();
if(q){
j=v(x).y-v(q).y;
T=q.clientHeight;
w=q.scrollTop;
if(j<w||j+25>w+T){
q.scrollTop=j<w?j:j-T+25
}
return
}}
O=k.getViewPort(A.editor.getWin());
j=k.getPos(x).y;
w=O.y;
T=O.h;
if(j<O.y||j+25>w+T){
A.editor.getWin().scrollTo(0,j<w?j:j-T+25)
}}
,placeCaretAt:function(q,x){
var j=this.editor.getDoc(),v,w;
if(j.caretPositionFromPoint){
w=j.caretPositionFromPoint(q,x);
v=j.createRange();
v.setStart(w.offsetNode,w.offset);
v.collapse(true)
}else{
if(j.caretRangeFromPoint){
v=j.caretRangeFromPoint(q,x)
}else{
if(j.body.createTextRange){
v=j.body.createTextRange();
try{
v.moveToPoint(q,x);
v.collapse(true)
}
catch(k){
v.collapse(x<j.body.clientHeight)
}}}}
this.setRng(v)
}
,_moveEndPoint:function(v,x,j){
var w=x,q=new g(x,w);
var k=this.dom.schema.getNonEmptyElements();
do{
if(x.nodeType==3&&c(x.nodeValue).length!==0){
if(j){
v.setStart(x,0)
}else{
v.setEnd(x,x.nodeValue.length)
}
return
}
if(k[x.nodeName]&&!/^(TD|TH)$/.test(x.nodeName)){
if(j){
v.setStartBefore(x)
}else{
if(x.nodeName=="BR"){
v.setEndBefore(x)
}else{
v.setEndAfter(x)
}}
return
}
if(m.ie&&m.ie<11&&this.dom.isBlock(x)&&this.dom.isEmpty(x)){
if(j){
v.setStart(x,0)
}else{
v.setEnd(x,0)
}
return
}}
while((x=(j?q.next():q.prev())));
if(w.nodeName=="BODY"){
if(j){
v.setStart(w,0)
}else{
v.setEnd(w,w.childNodes.length)
}}}
,destroy:function(){
this.win=null;
this.controlSelection.destroy()
}};
return b
}
);
r("tinymce/dom/ElementUtils",["tinymce/dom/BookmarkManager","tinymce/util/Tools"],function(h,c){
var d=c.each;
function l(u){
this.compare=function(p,f){
if(p.nodeName!=f.nodeName){
return false
}
function m(y){
var b={};
d(u.getAttribs(y),function(w){
var v=w.nodeName.toLowerCase();
if(v.indexOf("_")!==0&&v!=="style"&&v!=="data-mce-style"){
b[v]=u.getAttrib(y,v)
}}
);
return b
}
function g(v,w){
var b,y;
for(y in v){
if(v.hasOwnProperty(y)){
b=w[y];
if(typeof b=="undefined"){
return false
}
if(v[y]!=b){
return false
}
delete w[y]
}}
for(y in w){
if(w.hasOwnProperty(y)){
return false
}}
return true
}
if(!g(m(p),m(f))){
return false
}
if(!g(u.parseStyle(u.getAttrib(p,"style")),u.parseStyle(u.getAttrib(f,"style")))){
return false
}
return !h.isBookmarkNode(p)&&!h.isBookmarkNode(f)
}
}
return l
}
);
r("tinymce/fmt/Preview",["tinymce/util/Tools"],function(h){
var c=h.each;
function l(g,w){
var u,m,p=g.dom;
var d="",f,b;
b=g.settings.preview_styles;
if(b===false){
return""
}
if(!b){
b="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"
}
function y(v){
return v.replace(/%(\w+)/g,"")
}
if(typeof w=="string"){
w=g.formatter.get(w);
if(!w){
return
}
w=w[0]
}
u=w.block||w.inline||"span";
m=p.create(u);
c(w.styles,function(k,v){
k=y(k);
if(k){
p.setStyle(m,v,k)
}}
);
c(w.attributes,function(k,v){
k=y(k);
if(k){
p.setAttrib(m,v,k)
}}
);
c(w.classes,function(v){
v=y(v);
if(!p.hasClass(m,v)){
p.addClass(m,v)
}}
);
g.fire("PreviewFormats");
p.setStyles(m,{
position:"absolute",left:-65535}
);
g.getBody().appendChild(m);
f=p.getStyle(g.getBody(),"fontSize",true);
f=/px$/.test(f)?parseInt(f,10):0;
c(b.split(" "),function(v){
var k=p.getStyle(m,v,true);
if(v=="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(k)){
k=p.getStyle(g.getBody(),v,true);
if(p.toHex(k).toLowerCase()=="#ffffff"){
return
}}
if(v=="color"){
if(p.toHex(k).toLowerCase()=="#000000"){
return
}}
if(v=="font-size"){
if(/em|%$/.test(k)){
if(f===0){
return
}
k=parseFloat(k,10)/(/%$/.test(k)?100:1);
k=(k*f)+"px"
}}
if(v=="border"&&k){
d+="padding:0 2px;"
}
d+=v+":"+k+";"
}
);
g.fire("AfterPreviewFormats");
p.remove(m);
return d
}
return{
getCssText:l}
}
);
r("tinymce/Formatter",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/dom/BookmarkManager","tinymce/dom/ElementUtils","tinymce/util/Tools","tinymce/fmt/Preview"],function(d,u,h,c,l,m){
return function(_k){
var _r={}
,p=_k.dom,F=_k.selection,_o=new u(p),y=_k.schema.isValidChild,Z=p.isBlock,O=_k.settings.forced_root_block,R=p.nodeIndex,Q="\uFEFF",b=/^(src|href|style)$/,_g=false,P=true,_s,U,Y=p.getContentEditable,V,z,_t=h.isBookmarkNode;
var _c=l.each,_w=l.grep,C=l.walk,D=l.extend;
function X(_x){
if(_x.nodeType){
_x=_x.nodeName
}
return !!_k.schema.getTextBlockElements()[_x.toLowerCase()]
}
function _u(_x){
return/^(TH|TD)$/.test(_x.nodeName)
}
function _m(_x){
return _x&&/^(IMG)$/.test(_x.nodeName)
}
function A(_q,_x){
return p.getParents(_q,_x,p.getRoot())
}
function f(_x){
return _x.nodeType===1&&_x.id==="_mce_caret"
}
function q(){
T({
valigntop:[{
selector:"td,th",styles:{
verticalAlign:"top"}}
],valignmiddle:[{
selector:"td,th",styles:{
verticalAlign:"middle"}}
],valignbottom:[{
selector:"td,th",styles:{
verticalAlign:"bottom"}}
],alignleft:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{
textAlign:"left"}
,defaultBlock:"div"}
,{
selector:"img,table",collapsed:false,styles:{
"float":"left"}}
],aligncenter:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{
textAlign:"center"}
,defaultBlock:"div"}
,{
selector:"img",collapsed:false,styles:{
display:"block",marginLeft:"auto",marginRight:"auto"}}
,{
selector:"table",collapsed:false,styles:{
marginLeft:"auto",marginRight:"auto"}}
],alignright:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{
textAlign:"right"}
,defaultBlock:"div"}
,{
selector:"img,table",collapsed:false,styles:{
"float":"right"}}
],alignjustify:[{
selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{
textAlign:"justify"}
,defaultBlock:"div"}
],bold:[{
inline:"strong",remove:"all"}
,{
inline:"span",styles:{
fontWeight:"bold"}}
,{
inline:"b",remove:"all"}
],italic:[{
inline:"em",remove:"all"}
,{
inline:"span",styles:{
fontStyle:"italic"}}
,{
inline:"i",remove:"all"}
],underline:[{
inline:"span",styles:{
textDecoration:"underline"}
,exact:true}
,{
inline:"u",remove:"all"}
],strikethrough:[{
inline:"span",styles:{
textDecoration:"line-through"}
,exact:true}
,{
inline:"strike",remove:"all"}
],forecolor:{
inline:"span",styles:{
color:"%value"}
,links:true,remove_similar:true}
,hilitecolor:{
inline:"span",styles:{
backgroundColor:"%value"}
,links:true,remove_similar:true}
,fontname:{
inline:"span",styles:{
fontFamily:"%value"}}
,fontsize:{
inline:"span",styles:{
fontSize:"%value"}}
,fontsize_class:{
inline:"span",attributes:{
"class":"%value"}}
,blockquote:{
block:"blockquote",wrapper:1,remove:"all"}
,subscript:{
inline:"sub"}
,superscript:{
inline:"sup"}
,code:{
inline:"code"}
,link:{
inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(){
return true
}
,onformat:function(_j,_x,_q){
_c(_q,function(_T,_z){
p.setAttrib(_j,_z,_T)
}
)
}}
,removeformat:[{
selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:true,expand:false,block_expand:true,deep:true}
,{
selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true}
,{
selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}
]}
);
_c("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(_x){
T(_x,{
block:_x,remove:"all"}
)
}
);
T(_k.settings.formats)
}
function _p(){
_k.addShortcut("meta+b","bold_desc","Bold");
_k.addShortcut("meta+i","italic_desc","Italic");
_k.addShortcut("meta+u","underline_desc","Underline");
for(var _x=1;
_x<=6;
_x++){
_k.addShortcut("access+"+_x,"",["FormatBlock",false,"h"+_x])
}
_k.addShortcut("access+7","",["FormatBlock",false,"p"]);
_k.addShortcut("access+8","",["FormatBlock",false,"div"]);
_k.addShortcut("access+9","",["FormatBlock",false,"address"])
}
function _f(_x){
return _x?_r[_x]:_r
}
function T(_x,_q){
if(_x){
if(typeof _x!=="string"){
_c(_x,function(_z,_j){
T(_j,_z)
}
)
}else{
_q=_q.length?_q:[_q];
_c(_q,function(_j){
if(_j.deep===U){
_j.deep=!_j.selector
}
if(_j.split===U){
_j.split=!_j.selector||_j.inline
}
if(_j.remove===U&&_j.selector&&!_j.inline){
_j.remove="none"
}
if(_j.selector&&_j.inline){
_j.mixed=true;
_j.block_expand=true
}
if(typeof _j.classes==="string"){
_j.classes=_j.classes.split(/\s+/)
}}
);
_r[_x]=_q
}}}
function E(_x){
if(_x&&_r[_x]){
delete _r[_x]
}
return _r
}
function x(_q){
var _x;
_k.dom.getParent(_q,function(_j){
_x=_k.dom.getStyle(_j,"text-decoration");
return _x&&_x!=="none"
}
);
return _x
}
function _a(_x){
var _q;
if(_x.nodeType===1&&_x.parentNode&&_x.parentNode.nodeType===1){
_q=x(_x.parentNode);
if(_k.dom.getStyle(_x,"color")&&_q){
_k.dom.setStyle(_x,"text-decoration",_q)
}else{
if(_k.dom.getStyle(_x,"text-decoration")===_q){
_k.dom.setStyle(_x,"text-decoration",null)
}}}}
function _b(_j,_B,_T){
var _O=_f(_j),_C=_O[0],_W,_q,_A=!_T&&F.isCollapsed();
function _x(_R,_F){
_F=_F||_C;
if(_R){
if(_F.onformat){
_F.onformat(_R,_F,_B,_T)
}
_c(_F.styles,function(_I,_H){
p.setStyle(_R,_H,S(_I,_B))
}
);
if(_F.styles){
var _M=p.getAttrib(_R,"style");
if(_M){
_R.setAttribute("data-mce-style",_M)
}}
_c(_F.attributes,function(_I,_H){
p.setAttrib(_R,_H,S(_I,_B))
}
);
_c(_F.classes,function(_H){
_H=S(_H,_B);
if(!p.hasClass(_R,_H)){
p.addClass(_R,_H)
}}
)
}}
function _z(){
function _R(_L,_E){
var _G=new d(_E);
for(_T=_G.current();
_T;
_T=_G.prev()){
if(_T.childNodes.length>1||_T==_L||_T.tagName=="BR"){
return _T
}}}
var _M=_k.selection.getRng();
var _Y=_M.startContainer;
var _F=_M.endContainer;
if(_Y!=_F&&_M.endOffset===0){
var _I=_R(_Y,_F);
var _H=_I.nodeType==3?_I.length:_I.childNodes.length;
_M.setEnd(_I,_H)
}
return _M
}
function _D(_M,_H,_E){
var _F=[],_Y,_R,_I=true;
_Y=_C.inline||_C.block;
_R=p.create(_Y);
_x(_R);
_o.walk(_M,function(_G){
var _L;
function _N(_P){
var _V,_K,_U,_J,_Q;
_Q=_I;
_V=_P.nodeName.toLowerCase();
_K=_P.parentNode.nodeName.toLowerCase();
if(_P.nodeType===1&&Y(_P)){
_Q=_I;
_I=Y(_P)==="true";
_J=true
}
if(v(_V,"br")){
_L=0;
if(_C.block){
p.remove(_P)
}
return
}
if(_C.wrapper&&G(_P,_j,_B)){
_L=0;
return
}
if(_I&&!_J&&_C.block&&!_C.wrapper&&X(_V)&&y(_K,_Y)){
_P=p.rename(_P,_Y);
_x(_P);
_F.push(_P);
_L=0;
return
}
if(_C.selector){
_c(_O,function(_Z){
if("collapsed" in _Z&&_Z.collapsed!==_A){
return
}
if(p.is(_P,_Z.selector)&&!f(_P)){
_x(_P,_Z);
_U=true
}}
);
if(!_C.inline||_U){
_L=0;
return
}}
if(_I&&!_J&&y(_Y,_V)&&y(_K,_Y)&&!(!_E&&_P.nodeType===3&&_P.nodeValue.length===1&&_P.nodeValue.charCodeAt(0)===65279)&&!f(_P)&&(!_C.inline||!Z(_P))){
if(!_L){
_L=p.clone(_R,_g);
_P.parentNode.insertBefore(_L,_P);
_F.push(_L)
}
_L.appendChild(_P)
}else{
_L=0;
_c(_w(_P.childNodes),_N);
if(_J){
_I=_Q
}
_L=0
}}
_c(_G,_N)
}
);
if(_C.links===true){
_c(_F,function(_G){
function _L(_N){
if(_N.nodeName==="A"){
_x(_N,_C)
}
_c(_w(_N.childNodes),_L)
}
_L(_G)
}
)
}
_c(_F,function(_N){
var _G;
function _P(_J){
var _U=0;
_c(_J.childNodes,function(_K){
if(!w(_K)&&!_t(_K)){
_U++
}}
);
return _U
}
function _L(_U){
var _K,_J;
_c(_U.childNodes,function(_Q){
if(_Q.nodeType==1&&!_t(_Q)&&!f(_Q)){
_K=_Q;
return _g
}}
);
if(_K&&!_t(_K)&&k(_K,_C)){
_J=p.clone(_K,_g);
_x(_J);
p.replace(_J,_U,P);
p.remove(_K,1)
}
return _J||_U
}
_G=_P(_N);
if((_F.length>1||!Z(_N))&&_G===0){
p.remove(_N,1);
return
}
if(_C.inline||_C.wrapper){
if(!_C.exact&&_G===1){
_N=_L(_N)
}
_c(_O,function(_U){
_c(p.select(_U.inline,_N),function(_J){
if(_t(_J)){
return
}
_v(_U,_B,_J,_U.exact?_J:null)
}
)
}
);
if(G(_N.parentNode,_j,_B)){
p.remove(_N,1);
_N=0;
return P
}
if(_C.merge_with_parents){
p.getParent(_N.parentNode,function(_U){
if(G(_U,_j,_B)){
p.remove(_N,1);
_N=0;
return P
}}
)
}
if(_N&&_C.merge_siblings!==false){
_N=H(J(_N),_N);
_N=H(_N,J(_N,P))
}}}
)
}
if(_C){
if(_T){
if(_T.nodeType){
_q=p.createRng();
_q.setStartBefore(_T);
_q.setEndAfter(_T);
_D(B(_q,_O),null,true)
}else{
_D(_T,null,true)
}}else{
if(!_A||!_C.inline||p.select("td.mce-item-selected,th.mce-item-selected").length){
var _S=_k.selection.getNode();
if(!O&&_O[0].defaultBlock&&!p.getParent(_S,p.isBlock)){
_b(_O[0].defaultBlock)
}
_k.selection.setRng(_z());
_W=F.getBookmark();
_D(B(F.getRng(P),_O),_W);
if(_C.styles&&(_C.styles.color||_C.styles.textDecoration)){
C(_S,_a,"childNodes");
_a(_S)
}
F.moveToBookmark(_W);
_h(F.getRng(P));
_k.nodeChanged()
}else{
_d("apply",_j,_B)
}}}}
function N(_j,_S,_T,_W){
var _O=_f(_j),_M=_O[0],_C,_q,_D=true;
function _z(_E){
var _Y,_I,_H,_L,_G;
if(_E.nodeType===1&&Y(_E)){
_L=_D;
_D=Y(_E)==="true";
_G=true
}
_Y=_w(_E.childNodes);
if(_D&&!_G){
for(_I=0,_H=_O.length;
_I<_H;
_I++){
if(_v(_O[_I],_S,_E,_E)){
break
}}}
if(_M.deep){
if(_Y.length){
for(_I=0,_H=_Y.length;
_I<_H;
_I++){
_z(_Y[_I])
}
if(_G){
_D=_L
}}}}
function _A(_H){
var _I;
_c(A(_H.parentNode).reverse(),function(_Y){
var _E;
if(!_I&&_Y.id!="_start"&&_Y.id!="_end"){
_E=G(_Y,_j,_S,_W);
if(_E&&_E.split!==false){
_I=_Y
}}}
);
return _I
}
function _x(_G,_H,_L,_U){
var _J,_P,_N,_Y,_E,_I;
if(_G){
_I=_G.parentNode;
for(_J=_H.parentNode;
_J&&_J!=_I;
_J=_J.parentNode){
_P=p.clone(_J,_g);
for(_E=0;
_E<_O.length;
_E++){
if(_v(_O[_E],_S,_P,_P)){
_P=0;
break
}}
if(_P){
if(_N){
_P.appendChild(_N)
}
if(!_Y){
_Y=_P
}
_N=_P
}}
if(_U&&(!_M.mixed||!Z(_G))){
_H=p.split(_G,_H)
}
if(_N){
_L.parentNode.insertBefore(_N,_L);
_Y.appendChild(_L)
}}
return _H
}
function _F(_H){
return _x(_A(_H),_H,_H,true)
}
function _B(_Y){
var _I=p.get(_Y?"_start":"_end"),_H=_I[_Y?"firstChild":"lastChild"];
if(_t(_H)){
_H=_H[_Y?"firstChild":"lastChild"]
}
if(_H.nodeType==3&&_H.data.length===0){
_H=_Y?_I.previousSibling||_I.nextSibling:_I.nextSibling||_I.previousSibling
}
p.remove(_I,true);
return _H
}
function _R(_H){
var _I,_Y;
var _E=_H.commonAncestorContainer;
_H=B(_H,_O,P);
if(_M.split){
_I=_i(_H,P);
_Y=_i(_H);
if(_I!=_Y){
if(/^(TR|TH|TD)$/.test(_I.nodeName)&&_I.firstChild){
if(_I.nodeName=="TR"){
_I=_I.firstChild.firstChild||_I
}else{
_I=_I.firstChild||_I
}}
if(_E&&/^T(HEAD|BODY|FOOT|R)$/.test(_E.nodeName)&&_u(_Y)&&_Y.firstChild){
_Y=_Y.firstChild||_Y
}
if(p.isChildOf(_I,_Y)&&!Z(_Y)&&!_u(_I)&&!_u(_Y)){
_I=_l(_I,"span",{
id:"_start","data-mce-type":"bookmark"}
);
_F(_I);
_I=_B(P);
return
}
_I=_l(_I,"span",{
id:"_start","data-mce-type":"bookmark"}
);
_Y=_l(_Y,"span",{
id:"_end","data-mce-type":"bookmark"}
);
_F(_I);
_F(_Y);
_I=_B(P);
_Y=_B()
}else{
_I=_Y=_F(_I)
}
_H.startContainer=_I.parentNode?_I.parentNode:_I;
_H.startOffset=R(_I);
_H.endContainer=_Y.parentNode?_Y.parentNode:_Y;
_H.endOffset=R(_Y)+1
}
_o.walk(_H,function(_G){
_c(_G,function(_L){
_z(_L);
if(_L.nodeType===1&&_k.dom.getStyle(_L,"text-decoration")==="underline"&&_L.parentNode&&x(_L.parentNode)==="underline"){
_v({
deep:false,exact:true,inline:"span",styles:{
textDecoration:"underline"}}
,null,_L)
}}
)
}
)
}
if(_T){
if(_T.nodeType){
_q=p.createRng();
_q.setStartBefore(_T);
_q.setEndAfter(_T);
_R(_q)
}else{
_R(_T)
}
return
}
if(!F.isCollapsed()||!_M.inline||p.select("td.mce-item-selected,th.mce-item-selected").length){
_C=F.getBookmark();
_R(F.getRng(P));
F.moveToBookmark(_C);
if(_M.inline&&j(_j,_S,F.getStart())){
_h(F.getRng(true))
}
_k.nodeChanged()
}else{
_d("remove",_j,_S,_W)
}}
function K(_q,_z,_j){
var _x=_f(_q);
if(j(_q,_z,_j)&&(!("toggle" in _x[0])||_x[0].toggle)){
N(_q,_z,_j)
}else{
_b(_q,_z,_j)
}}
function G(_q,_x,_A,_T){
var _j=_f(_x),_W,_O,_z;
function _B(_F,_R,_H){
var _S,_M,_C=_R[_H],_D;
if(_R.onmatch){
return _R.onmatch(_F,_R,_H)
}
if(_C){
if(_C.length===U){
for(_S in _C){
if(_C.hasOwnProperty(_S)){
if(_H==="attributes"){
_M=p.getAttrib(_F,_S)
}else{
_M=_n(_F,_S)
}
if(_T&&!_M&&!_R.exact){
return
}
if((!_T||_R.exact)&&!v(_M,M(S(_C[_S],_A),_S))){
return
}}}}else{
for(_D=0;
_D<_C.length;
_D++){
if(_H==="attributes"?p.getAttrib(_F,_C[_D]):_n(_F,_C[_D])){
return _R
}}}}
return _R
}
if(_j&&_q){
for(_O=0;
_O<_j.length;
_O++){
_W=_j[_O];
if(k(_q,_W)&&_B(_q,_W,"attributes")&&_B(_q,_W,"styles")){
if((_z=_W.classes)){
for(_O=0;
_O<_z.length;
_O++){
if(!p.hasClass(_q,_z[_O])){
return
}}}
return _W
}}}}
function j(_j,_T,_z){
var _q;
function _x(_A){
var _O=p.getRoot();
if(_A===_O){
return false
}
_A=p.getParent(_A,function(_W){
return _W.parentNode===_O||!!G(_W,_j,_T,true)
}
);
return G(_A,_j,_T)
}
if(_z){
return _x(_z)
}
_z=F.getNode();
if(_x(_z)){
return P
}
_q=F.getStart();
if(_q!=_z){
if(_x(_q)){
return P
}}
return _g
}
function I(_T,_z){
var _q,_j=[],_x={};
_q=F.getStart();
p.getParent(_q,function(_W){
var _A,_O;
for(_A=0;
_A<_T.length;
_A++){
_O=_T[_A];
if(!_x[_O]&&G(_W,_O,_z)){
_x[_O]=true;
_j.push(_O)
}}}
,p.getRoot());
return _j
}
function L(_T){
var _A=_f(_T),_z,_j,_O,_q,_x;
if(_A){
_z=F.getStart();
_j=A(_z);
for(_q=_A.length-1;
_q>=0;
_q--){
_x=_A[_q].selector;
if(!_x||_A[_q].defaultBlock){
return P
}
for(_O=_j.length-1;
_O>=0;
_O--){
if(p.is(_j[_O],_x)){
return P
}}}}
return _g
}
function _e(_x,_z,_q){
var _j;
if(!_s){
_s={};
_j={};
_k.on("NodeChange",function(_O){
var _T=A(_O.element),_A={};
_T=l.grep(_T,function(_W){
return _W.nodeType==1&&!_W.getAttribute("data-mce-bogus")
}
);
_c(_s,function(_W,_B){
_c(_T,function(_C){
if(G(_C,_B,{}
,_W.similar)){
if(!_j[_B]){
_c(_W,function(_D){
_D(true,{
node:_C,format:_B,parents:_T}
)
}
);
_j[_B]=_W
}
_A[_B]=_W;
return false
}}
)
}
);
_c(_j,function(_W,_B){
if(!_A[_B]){
delete _j[_B];
_c(_W,function(_C){
_C(false,{
node:_O.element,format:_B,parents:_T}
)
}
)
}}
)
}
)
}
_c(_x.split(","),function(_T){
if(!_s[_T]){
_s[_T]=[];
_s[_T].similar=_q
}
_s[_T].push(_z)
}
);
return this
}
function _y(_x){
return m.getCssText(_k,_x)
}
D(this,{
get:_f,register:T,unregister:E,apply:_b,remove:N,toggle:K,match:j,matchAll:I,matchNode:G,canApply:L,formatChanged:_e,getCssText:_y}
);
q();
_p();
_k.on("BeforeGetContent",function(_x){
if(z&&_x.format!="raw"){
z()
}}
);
_k.on("mouseup keydown",function(_x){
if(V){
V(_x)
}}
);
function k(_x,_q){
if(v(_x,_q.inline)){
return P
}
if(v(_x,_q.block)){
return P
}
if(_q.selector){
return _x.nodeType==1&&p.is(_x,_q.selector)
}}
function v(_q,_x){
_q=_q||"";
_x=_x||"";
_q=""+(_q.nodeName||_q);
_x=""+(_x.nodeName||_x);
return _q.toLowerCase()==_x.toLowerCase()
}
function _n(_q,_x){
return M(p.getStyle(_q,_x),_x)
}
function M(_q,_x){
if(_x=="color"||_x=="backgroundColor"){
_q=p.toHex(_q)
}
if(_x=="fontWeight"&&_q==700){
_q="bold"
}
if(_x=="fontFamily"){
_q=_q.replace(/[\'\"]/g,"").replace(/,\s+/g,",")
}
return""+_q
}
function S(_x,_q){
if(typeof _x!="string"){
_x=_x(_q)
}else{
if(_q){
_x=_x.replace(/%(\w+)/g,function(_z,_j){
return _q[_j]||_z
}
)
}}
return _x
}
function w(_x){
return _x&&_x.nodeType===3&&/^([\t \r\n]+|)$/.test(_x.nodeValue)
}
function _l(_j,_q,_x){
var _z=p.create(_q,_x);
_j.parentNode.insertBefore(_z,_j);
_z.appendChild(_j);
return _z
}
function B(_x,_S,_z){
var _F,_A,_D,_j=_x.startContainer,_W=_x.startOffset,_H=_x.endContainer,_C=_x.endOffset;
function _M(_P){
var _Y,_L,_G,_E,_I;
_Y=_L=_P?_j:_H;
_E=_P?"previousSibling":"nextSibling";
_I=p.getRoot();
function _N(_U){
return _U.nodeName=="BR"&&_U.getAttribute("data-mce-bogus")&&!_U.nextSibling
}
if(_Y.nodeType==3&&!w(_Y)){
if(_P?_W>0:_C<_Y.nodeValue.length){
return _Y
}}
while(true){
if(!_S[0].block_expand&&Z(_L)){
return _L
}
for(_G=_L[_E];
_G;
_G=_G[_E]){
if(!_t(_G)&&!w(_G)&&!_N(_G)){
return _L
}}
if(_L.parentNode==_I){
_Y=_L;
break
}
_L=_L.parentNode
}
return _Y
}
function _O(_I,_Y){
if(_Y===U){
_Y=_I.nodeType===3?_I.length:_I.childNodes.length
}
while(_I&&_I.hasChildNodes()){
_I=_I.childNodes[_Y];
if(_I){
_Y=_I.nodeType===3?_I.length:_I.childNodes.length
}}
return{
node:_I,offset:_Y}
}
if(_j.nodeType==1&&_j.hasChildNodes()){
_F=_j.childNodes.length-1;
_j=_j.childNodes[_W>_F?_F:_W];
if(_j.nodeType==3){
_W=0
}}
if(_H.nodeType==1&&_H.hasChildNodes()){
_F=_H.childNodes.length-1;
_H=_H.childNodes[_C>_F?_F:_C-1];
if(_H.nodeType==3){
_C=_H.nodeValue.length
}}
function _R(_Y){
var _I=_Y;
while(_I){
if(_I.nodeType===1&&Y(_I)){
return Y(_I)==="false"?_I:_Y
}
_I=_I.parentNode
}
return _Y
}
function _B(_Y,_N,_U){
var _L,_E,_P,_I;
function _G(_K,_V){
var _Z,_J,_Q=_K.nodeValue;
if(typeof _V=="undefined"){
_V=_U?_Q.length:0
}
if(_U){
_Z=_Q.lastIndexOf(" ",_V);
_J=_Q.lastIndexOf("\u00a0",_V);
_Z=_Z>_J?_Z:_J;
if(_Z!==-1&&!_z){
_Z++
}}else{
_Z=_Q.indexOf(" ",_V);
_J=_Q.indexOf("\u00a0",_V);
_Z=_Z!==-1&&(_J===-1||_Z<_J)?_Z:_J
}
return _Z
}
if(_Y.nodeType===3){
_P=_G(_Y,_N);
if(_P!==-1){
return{
container:_Y,offset:_P}
}
_I=_Y
}
_L=new d(_Y,p.getParent(_Y,Z)||_k.getBody());
while((_E=_L[_U?"prev":"next"]())){
if(_E.nodeType===3){
_I=_E;
_P=_G(_E);
if(_P!==-1){
return{
container:_E,offset:_P}
}}else{
if(Z(_E)){
break
}}}
if(_I){
if(_U){
_N=0
}else{
_N=_I.length
}
return{
container:_I,offset:_N}
}}
function _T(_Y,_I){
var _E,_G,_N,_L;
if(_Y.nodeType==3&&_Y.nodeValue.length===0&&_Y[_I]){
_Y=_Y[_I]
}
_E=A(_Y);
for(_G=0;
_G<_E.length;
_G++){
for(_N=0;
_N<_S.length;
_N++){
_L=_S[_N];
if("collapsed" in _L&&_L.collapsed!==_x.collapsed){
continue
}
if(p.is(_E[_G],_L.selector)){
return _E[_G]
}}}
return _Y
}
function _q(_E,_I){
var _G,_Y=p.getRoot();
if(!_S[0].wrapper){
_G=p.getParent(_E,_S[0].block,_Y)
}
if(!_G){
_G=p.getParent(_E.nodeType==3?_E.parentNode:_E,function(_L){
return _L!=_Y&&X(_L)
}
)
}
if(_G&&_S[0].wrapper){
_G=A(_G,"ul,ol").reverse()[0]||_G
}
if(!_G){
_G=_E;
while(_G[_I]&&!Z(_G[_I])){
_G=_G[_I];
if(v(_G,"br")){
break
}}}
return _G||_E
}
_j=_R(_j);
_H=_R(_H);
if(_t(_j.parentNode)||_t(_j)){
_j=_t(_j)?_j:_j.parentNode;
_j=_j.nextSibling||_j;
if(_j.nodeType==3){
_W=0
}}
if(_t(_H.parentNode)||_t(_H)){
_H=_t(_H)?_H:_H.parentNode;
_H=_H.previousSibling||_H;
if(_H.nodeType==3){
_C=_H.length
}}
if(_S[0].inline){
if(_x.collapsed){
_D=_B(_j,_W,true);
if(_D){
_j=_D.container;
_W=_D.offset
}
_D=_B(_H,_C);
if(_D){
_H=_D.container;
_C=_D.offset
}}
_A=_O(_H,_C);
if(_A.node){
while(_A.node&&_A.offset===0&&_A.node.previousSibling){
_A=_O(_A.node.previousSibling)
}
if(_A.node&&_A.offset>0&&_A.node.nodeType===3&&_A.node.nodeValue.charAt(_A.offset-1)===" "){
if(_A.offset>1){
_H=_A.node;
_H.splitText(_A.offset-1)
}}}}
if(_S[0].inline||_S[0].block_expand){
if(!_S[0].inline||(_j.nodeType!=3||_W===0)){
_j=_M(true)
}
if(!_S[0].inline||(_H.nodeType!=3||_C===_H.nodeValue.length)){
_H=_M()
}}
if(_S[0].selector&&_S[0].expand!==_g&&!_S[0].inline){
_j=_T(_j,"previousSibling");
_H=_T(_H,"nextSibling")
}
if(_S[0].block||_S[0].selector){
_j=_q(_j,"previousSibling");
_H=_q(_H,"nextSibling");
if(_S[0].block){
if(!Z(_j)){
_j=_M(true)
}
if(!Z(_H)){
_H=_M()
}}}
if(_j.nodeType==1){
_W=R(_j);
_j=_j.parentNode
}
if(_H.nodeType==1){
_C=R(_H)+1;
_H=_H.parentNode
}
return{
startContainer:_j,startOffset:_W,endContainer:_H,endOffset:_C}
}
function g(_x,_q){
return _q.links&&_x.tagName=="A"
}
function _v(_A,_O,_z,_x){
var _j,_q,_T;
if(!k(_z,_A)&&!g(_z,_A)){
return _g
}
if(_A.remove!="all"){
_c(_A.styles,function(_B,_W){
_B=M(S(_B,_O),_W);
if(typeof _W==="number"){
_W=_B;
_x=0
}
if(_A.remove_similar||(!_x||v(_n(_x,_W),_B))){
p.setStyle(_z,_W,"")
}
_T=1
}
);
if(_T&&p.getAttrib(_z,"style")===""){
_z.removeAttribute("style");
_z.removeAttribute("data-mce-style")
}
_c(_A.attributes,function(_C,_W){
var _B;
_C=S(_C,_O);
if(typeof _W==="number"){
_W=_C;
_x=0
}
if(!_x||v(p.getAttrib(_x,_W),_C)){
if(_W=="class"){
_C=p.getAttrib(_z,_W);
if(_C){
_B="";
_c(_C.split(/\s+/),function(_D){
if(/mce\-\w+/.test(_D)){
_B+=(_B?" ":"")+_D
}}
);
if(_B){
p.setAttrib(_z,_W,_B);
return
}}}
if(_W=="class"){
_z.removeAttribute("className")
}
if(b.test(_W)){
_z.removeAttribute("data-mce-"+_W)
}
_z.removeAttribute(_W)
}}
);
_c(_A.classes,function(_W){
_W=S(_W,_O);
if(!_x||p.hasClass(_x,_W)){
p.removeClass(_z,_W)
}}
);
_q=p.getAttribs(_z);
for(_j=0;
_j<_q.length;
_j++){
if(_q[_j].nodeName.indexOf("_")!==0){
return _g
}}}
if(_A.remove!="none"){
W(_z,_A);
return P
}}
function W(_j,_z){
var _x=_j.parentNode,_q;
function _T(_A,_O,_W){
_A=J(_A,_O,_W);
return !_A||(_A.nodeName=="BR"||Z(_A))
}
if(_z.block){
if(!O){
if(Z(_j)&&!Z(_x)){
if(!_T(_j,_g)&&!_T(_j.firstChild,P,1)){
_j.insertBefore(p.create("br"),_j.firstChild)
}
if(!_T(_j,P)&&!_T(_j.lastChild,_g,1)){
_j.appendChild(p.create("br"))
}}}else{
if(_x==p.getRoot()){
if(!_z.list_block||!v(_j,_z.list_block)){
_c(_w(_j.childNodes),function(_O){
if(y(O,_O.nodeName.toLowerCase())){
if(!_q){
_q=_l(_O,O);
p.setAttribs(_q,_k.settings.forced_root_block_attrs)
}else{
_q.appendChild(_O)
}}else{
_q=0
}}
)
}}}}
if(_z.selector&&_z.inline&&!v(_z.inline,_j)){
return
}
p.remove(_j,1)
}
function J(_q,_x,_j){
if(_q){
_x=_x?"nextSibling":"previousSibling";
for(_q=_j?_q:_q[_x];
_q;
_q=_q[_x]){
if(_q.nodeType==1||!w(_q)){
return _q
}}}}
function H(_T,_z){
var _j,_q,_x=new c(p);
function _O(_W,_A){
for(_j=_W;
_j;
_j=_j[_A]){
if(_j.nodeType==3&&_j.nodeValue.length!==0){
return _W
}
if(_j.nodeType==1&&!_t(_j)){
return _j
}}
return _W
}
if(_T&&_z){
_T=_O(_T,"previousSibling");
_z=_O(_z,"nextSibling");
if(_x.compare(_T,_z)){
for(_j=_T.nextSibling;
_j&&_j!=_z;
){
_q=_j;
_j=_j.nextSibling;
_T.appendChild(_q)
}
p.remove(_z);
_c(_w(_z.childNodes),function(_A){
_T.appendChild(_A)
}
);
return _T
}}
return _z
}
function _i(_q,_T){
var _x,_z,_j;
_x=_q[_T?"startContainer":"endContainer"];
_z=_q[_T?"startOffset":"endOffset"];
if(_x.nodeType==1){
_j=_x.childNodes.length-1;
if(!_T&&_z){
_z--
}
_x=_x.childNodes[_z>_j?_j:_z]
}
if(_x.nodeType===3&&_T&&_z>=_x.nodeValue.length){
_x=new d(_x,_k.getBody()).next()||_x
}
if(_x.nodeType===3&&!_T&&_z===0){
_x=new d(_x,_k.getBody()).prev()||_x
}
return _x
}
function _d(_D,_x,_B,_T){
var _S="_mce_caret",_q=_k.settings.caret_debug;
function _j(_H){
var _R=p.create("span",{
id:_S,"data-mce-bogus":true,style:_q?"color:red":""}
);
if(_H){
_R.appendChild(_k.getDoc().createTextNode(Q))
}
return _R
}
function _C(_H,_R){
while(_H){
if((_H.nodeType===3&&_H.nodeValue!==Q)||_H.childNodes.length>1){
return false
}
if(_R&&_H.nodeType===1){
_R.push(_H)
}
_H=_H.firstChild
}
return true
}
function _A(_R){
while(_R){
if(_R.id===_S){
return _R
}
_R=_R.parentNode
}}
function _O(_R){
var _H;
if(_R){
_H=new d(_R,_R);
for(_R=_H.current();
_R;
_R=_H.next()){
if(_R.nodeType===3){
return _R
}}}}
function _z(_I,_H){
var _Y,_R;
if(!_I){
_I=_A(F.getStart());
if(!_I){
while((_I=p.get(_S))){
_z(_I,false)
}}}else{
_R=F.getRng(true);
if(_C(_I)){
if(_H!==false){
_R.setStartBefore(_I);
_R.setEndBefore(_I)
}
p.remove(_I)
}else{
_Y=_O(_I);
if(_Y.nodeValue.charAt(0)===Q){
_Y.deleteData(0,1);
if(_R.startContainer==_Y&&_R.startOffset>0){
_R.setStart(_Y,_R.startOffset-1)
}
if(_R.endContainer==_Y&&_R.endOffset>0){
_R.setEnd(_Y,_R.endOffset-1)
}}
p.remove(_I,1)
}
F.setRng(_R)
}}
function _W(){
var _I,_R,_L,_G,_Y,_H,_E;
_I=F.getRng(true);
_G=_I.startOffset;
_H=_I.startContainer;
_E=_H.nodeValue;
_R=_A(F.getStart());
if(_R){
_L=_O(_R)
}
if(_E&&_G>0&&_G<_E.length&&/\w/.test(_E.charAt(_G))&&/\w/.test(_E.charAt(_G-1))){
_Y=F.getBookmark();
_I.collapse(true);
_I=B(_I,_f(_x));
_I=_o.split(_I);
_b(_x,_B,_I);
F.moveToBookmark(_Y)
}else{
if(!_R||_L.nodeValue!==Q){
_R=_j(true);
_L=_R.firstChild;
_I.insertNode(_R);
_G=1;
_b(_x,_B,_R)
}else{
_b(_x,_B,_R)
}
F.setCursorLocation(_L,_G)
}}
function _F(){
var _R=F.getRng(true),_H,_E,_N,_L,_I,_J,_U=[],_G,_P;
_H=_R.startContainer;
_E=_R.startOffset;
_I=_H;
if(_H.nodeType==3){
if(_E!=_H.nodeValue.length){
_L=true
}
_I=_I.parentNode
}
while(_I){
if(G(_I,_x,_B,_T)){
_J=_I;
break
}
if(_I.nextSibling){
_L=true
}
_U.push(_I);
_I=_I.parentNode
}
if(!_J){
return
}
if(_L){
_N=F.getBookmark();
_R.collapse(true);
_R=B(_R,_f(_x),true);
_R=_o.split(_R);
N(_x,_B,_R);
F.moveToBookmark(_N)
}else{
_P=_j();
_I=_P;
for(_G=_U.length-1;
_G>=0;
_G--){
_I.appendChild(p.clone(_U[_G],false));
_I=_I.firstChild
}
_I.appendChild(p.doc.createTextNode(Q));
_I=_I.firstChild;
var _Y=p.getParent(_J,X);
if(_Y&&p.isEmpty(_Y)){
_J.parentNode.replaceChild(_P,_J)
}else{
p.insertAfter(_P,_J)
}
F.setCursorLocation(_I,1);
if(p.isEmpty(_J)){
p.remove(_J)
}}}
function _M(){
var _R;
_R=_A(F.getStart());
if(_R&&!p.isEmpty(_R)){
C(_R,function(_H){
if(_H.nodeType==1&&_H.id!==_S&&!p.isEmpty(_H)){
p.setAttrib(_H,"data-mce-bogus",null)
}}
,"childNodes")
}}
if(!_k._hasCaretEvents){
z=function(){
var _R=[],_H;
if(_C(_A(F.getStart()),_R)){
_H=_R.length;
while(_H--){
p.setAttrib(_R[_H],"data-mce-bogus","1")
}}};
V=function(_H){
var _R=_H.keyCode;
_z();
if((_R==8&&F.isCollapsed())||_R==37||_R==39){
_z(_A(F.getStart()))
}
_M()
};
_k.on("SetContent",function(_R){
if(_R.selection){
_M()
}}
);
_k._hasCaretEvents=true
}
if(_D=="apply"){
_W()
}else{
_F()
}}
function _h(_q){
var _x=_q.startContainer,_W=_q.startOffset,_z,_A,_O,_j,_T;
if(_q.startContainer==_q.endContainer){
if(_m(_q.startContainer.childNodes[_q.startOffset])){
return
}}
if(_x.nodeType==3&&_W>=_x.nodeValue.length){
_W=R(_x);
_x=_x.parentNode;
_z=true
}
if(_x.nodeType==1){
_j=_x.childNodes;
_x=_j[Math.min(_W,_j.length-1)];
_A=new d(_x,p.getParent(_x,p.isBlock));
if(_W>_j.length-1||_z){
_A.next()
}
for(_O=_A.current();
_O;
_O=_A.next()){
if(_O.nodeType==3&&!w(_O)){
_T=p.create("a",{
"data-mce-bogus":"all"}
,Q);
_O.parentNode.insertBefore(_T,_O);
_q.setStart(_O,0);
F.setRng(_q);
p.remove(_T);
return
}}}}}
}
);
r("tinymce/UndoManager",["tinymce/util/VK","tinymce/Env","tinymce/util/Tools","tinymce/html/SaxParser"],function(m,c,d,l){
var h=d.trim,u;
u=new RegExp(["<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\\/span>",'\\s?data-mce-selected="[^"]+"'].join("|"),"gi");
return function(w){
var q=this,v=0,g=[],y,k,x=0;
function f(){
var W=w.getContent({
format:"raw",no_events:1}
);
var O=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g;
var j,z,C,B,T,A=w.schema;
W=W.replace(u,"");
T=A.getShortEndedElements();
while((B=O.exec(W))){
z=O.lastIndex;
C=B[0].length;
if(T[B[1]]){
j=z
}else{
j=l.findEndTag(A,W,z)
}
W=W.substring(0,z-C)+W.substring(j);
O.lastIndex=z-C
}
return h(W)
}
function b(j){
w.isNotDirty=!j
}
function p(j){
q.typing=false;
q.add({}
,j)
}
w.on("init",function(){
q.add()
}
);
w.on("BeforeExecCommand",function(z){
var j=z.command;
if(j!="Undo"&&j!="Redo"&&j!="mceRepaint"){
q.beforeChange()
}}
);
w.on("ExecCommand",function(z){
var j=z.command;
if(j!="Undo"&&j!="Redo"&&j!="mceRepaint"){
p(z)
}}
);
w.on("ObjectResizeStart Cut",function(){
q.beforeChange()
}
);
w.on("SaveContent ObjectResized blur",p);
w.on("DragEnd",p);
w.on("KeyUp",function(z){
var j=z.keyCode;
if(z.isDefaultPrevented()){
return
}
if((j>=33&&j<=36)||(j>=37&&j<=40)||j==45||j==13||z.ctrlKey){
p();
w.nodeChanged()
}
if(j==46||j==8||(c.mac&&(j==91||j==93))){
w.nodeChanged()
}
if(k&&q.typing){
if(!w.isDirty()){
b(g[0]&&f()!=g[0].content);
if(!w.isNotDirty){
w.fire("change",{
level:g[0],lastLevel:null}
)
}}
w.fire("TypingUndo");
k=false;
w.nodeChanged()
}}
);
w.on("KeyDown",function(T){
var z=T.keyCode;
if(T.isDefaultPrevented()){
return
}
if((z>=33&&z<=36)||(z>=37&&z<=40)||z==45){
if(q.typing){
p(T)
}
return
}
var j=(T.ctrlKey&&!T.altKey)||T.metaKey;
if((z<16||z>20)&&z!=224&&z!=91&&!q.typing&&!j){
q.beforeChange();
q.typing=true;
q.add({}
,T);
k=true
}}
);
w.on("MouseDown",function(j){
if(q.typing){
p(j)
}}
);
w.addShortcut("meta+z","","Undo");
w.addShortcut("meta+y,meta+shift+z","","Redo");
w.on("AddUndo Undo Redo ClearUndos",function(j){
if(!j.isDefaultPrevented()){
w.nodeChanged()
}}
);
q={
data:g,typing:false,beforeChange:function(){
if(!x){
y=w.selection.getBookmark(2,true)
}}
,add:function(W,A){
var z,T=w.settings,O;
W=W||{};
W.content=f();
if(x||w.removed){
return null
}
O=g[v];
if(w.fire("BeforeAddUndo",{
level:W,lastLevel:O,originalEvent:A}
).isDefaultPrevented()){
return null
}
if(O&&O.content==W.content){
return null
}
if(g[v]){
g[v].beforeBookmark=y
}
if(T.custom_undo_redo_levels){
if(g.length>T.custom_undo_redo_levels){
for(z=0;
z<g.length-1;
z++){
g[z]=g[z+1]
}
g.length--;
v=g.length
}}
W.bookmark=w.selection.getBookmark(2,true);
if(v<g.length-1){
g.length=v+1
}
g.push(W);
v=g.length-1;
var j={
level:W,lastLevel:O,originalEvent:A};
w.fire("AddUndo",j);
if(v>0){
b(true);
w.fire("change",j)
}
return W
}
,undo:function(){
var j;
if(q.typing){
q.add();
q.typing=false
}
if(v>0){
j=g[--v];
if(v===0){
b(false)
}
w.setContent(j.content,{
format:"raw"}
);
w.selection.moveToBookmark(j.beforeBookmark);
w.fire("undo",{
level:j}
)
}
return j
}
,redo:function(){
var j;
if(v<g.length-1){
j=g[++v];
w.setContent(j.content,{
format:"raw"}
);
w.selection.moveToBookmark(j.bookmark);
b(true);
w.fire("redo",{
level:j}
)
}
return j
}
,clear:function(){
g=[];
v=0;
q.typing=false;
w.fire("ClearUndos")
}
,hasUndo:function(){
return v>0||(q.typing&&g[0]&&f()!=g[0].content)
}
,hasRedo:function(){
return v<g.length-1&&!this.typing
}
,transact:function(j){
q.beforeChange();
try{
x++;
j()
}
finally{
x--
}
q.add()
}};
return q
}
}
);
r("tinymce/EnterKey",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/Env"],function(l,d,h){
var c=h.ie&&h.ie<11;
return function(y){
var f=y.dom,b=y.selection,u=y.settings;
var v=y.undoManager,m=y.schema,p=m.getNonEmptyElements(),w=m.getMoveCaretBeforeOnEnterElements();
function g(E){
var F,U,k,I,S,A,X,G,T,x,z,D,Q,R,L;
function N(_e){
return _e&&f.isBlock(_e)&&!/^(TD|TH|CAPTION|FORM)$/.test(_e.nodeName)&&!/^(fixed|absolute)/i.test(_e.style.position)&&f.getContentEditable(_e)!=="true"
}
function P(_t){
var _e;
if(f.isBlock(_t)){
_e=b.getRng();
_t.appendChild(f.create("span",null,"\u00a0"));
b.select(_t);
_t.lastChild.outerHTML="";
b.setRng(_e)
}}
function H(_a){
var _t=_a,_i=[],_e;
if(!_t){
return
}
while((_t=_t.firstChild)){
if(f.isBlock(_t)){
return
}
if(_t.nodeType==1&&!p[_t.nodeName.toLowerCase()]){
_i.push(_t)
}}
_e=_i.length;
while(_e--){
_t=_i[_e];
if(!_t.hasChildNodes()||(_t.firstChild==_t.lastChild&&_t.firstChild.nodeValue==="")){
f.remove(_t)
}else{
if(_t.nodeName=="A"&&(_t.innerText||_t.textContent)===" "){
f.remove(_t)
}}}}
function j(_t){
var _r,_o,_e,_i=_t,_a;
function _s(_h){
while(_h){
if(_h.nodeType==1||(_h.nodeType==3&&_h.data&&/[\r\n\s]/.test(_h.data))){
return _h
}
_h=_h.nextSibling
}}
if(!_t){
return
}
if(h.ie&&h.ie<9&&A&&A.firstChild){
if(A.firstChild==A.lastChild&&A.firstChild.tagName=="BR"){
f.remove(A.firstChild)
}}
if(/^(LI|DT|DD)$/.test(_t.nodeName)){
var _n=_s(_t.firstChild);
if(_n&&/^(UL|OL|DL)$/.test(_n.nodeName)){
_t.insertBefore(f.doc.createTextNode("\u00a0"),_t.firstChild)
}}
_e=f.createRng();
if(!h.ie){
_t.normalize()
}
if(_t.hasChildNodes()){
_r=new l(_t,_t);
while((_o=_r.current())){
if(_o.nodeType==3){
_e.setStart(_o,0);
_e.setEnd(_o,0);
break
}
if(w[_o.nodeName.toLowerCase()]){
_e.setStartBefore(_o);
_e.setEndBefore(_o);
break
}
_i=_o;
_o=_r.next()
}
if(!_o){
_e.setStart(_i,0);
_e.setEnd(_i,0)
}}else{
if(_t.nodeName=="BR"){
if(_t.nextSibling&&f.isBlock(_t.nextSibling)){
if(!X||X<9){
_a=f.create("br");
_t.parentNode.insertBefore(_a,_t)
}
_e.setStartBefore(_t);
_e.setEndBefore(_t)
}else{
_e.setStartAfter(_t);
_e.setEndAfter(_t)
}}else{
_e.setStart(_t,0);
_e.setEnd(_t,0)
}}
b.setRng(_e);
f.remove(_a);
b.scrollIntoView(_t)
}
function M(_t){
var _e=u.forced_root_block;
if(_e&&_e.toLowerCase()===_t.tagName.toLowerCase()){
f.setAttribs(_t,u.forced_root_block_attrs)
}}
function O(_e){
_e.innerHTML=!c?'<br data-mce-bogus="1">':""
}
function B(_t){
var _i=I,_n,_o,_e,_a=m.getTextInlineElements();
if(_t||D=="TABLE"){
_n=f.create(_t||R);
M(_n)
}else{
_n=A.cloneNode(false)
}
_e=_n;
if(u.keep_styles!==false){
do{
if(_a[_i.nodeName]){
if(_i.id=="_mce_caret"){
continue
}
_o=_i.cloneNode(false);
f.setAttrib(_o,"id","");
if(_n.hasChildNodes()){
_o.appendChild(_n.firstChild);
_n.appendChild(_o)
}else{
_e=_o;
_n.appendChild(_o)
}}}
while((_i=_i.parentNode))
}
if(!c){
_e.innerHTML='<br data-mce-bogus="1">'
}
return _n
}
function W(_i){
var _a,_t,_e;
if(I.nodeType==3&&(_i?S>0:S<I.nodeValue.length)){
return false
}
if(I.parentNode==A&&L&&!_i){
return true
}
if(_i&&I.nodeType==1&&I==A.firstChild){
return true
}
if(I.nodeName==="TABLE"||(I.previousSibling&&I.previousSibling.nodeName=="TABLE")){
return(L&&!_i)||(!L&&_i)
}
_a=new l(I,A);
if(I.nodeType==3){
if(_i&&S===0){
_a.prev()
}else{
if(!_i&&S==I.nodeValue.length){
_a.next()
}}}
while((_t=_a.current())){
if(_t.nodeType===1){
if(!_t.getAttribute("data-mce-bogus")){
_e=_t.nodeName.toLowerCase();
if(p[_e]&&_e!=="br"){
return false
}}}else{
if(_t.nodeType===3&&!/^[ \t\r\n]*$/.test(_t.nodeValue)){
return false
}}
if(_i){
_a.prev()
}else{
_a.next()
}}
return true
}
function q(_t,_n){
var _r,_a,_i,_o,_s,_e,_h=R||"P";
_a=f.getParent(_t,f.isBlock);
_e=y.getBody().nodeName.toLowerCase();
if(!_a||!N(_a)){
_a=_a||k;
if(!_a.hasChildNodes()){
_r=f.create(_h);
M(_r);
_a.appendChild(_r);
F.setStart(_r,0);
F.setEnd(_r,0);
return _r
}
_o=_t;
while(_o.parentNode!=_a){
_o=_o.parentNode
}
while(_o&&!f.isBlock(_o)){
_i=_o;
_o=_o.previousSibling
}
if(_i&&m.isValidChild(_e,_h.toLowerCase())){
_r=f.create(_h);
M(_r);
_i.parentNode.insertBefore(_r,_i);
_o=_i;
while(_o&&!f.isBlock(_o)){
_s=_o.nextSibling;
_r.appendChild(_o);
_o=_s
}
F.setStart(_t,_n);
F.setEnd(_t,_n)
}}
return _t
}
function J(){
function _t(_o){
var _i=z[_o?"firstChild":"lastChild"];
while(_i){
if(_i.nodeType==1){
break
}
_i=_i[_o?"nextSibling":"previousSibling"]
}
return _i===A
}
function _a(){
var _i=z.parentNode;
if(/^(LI|DT|DD)$/.test(_i.nodeName)){
return _i
}
return z
}
var _e=z.parentNode.nodeName;
if(/^(OL|UL|LI)$/.test(_e)){
R="LI"
}
T=R?B(R):f.create("BR");
if(_t(true)&&_t()){
if(_e=="LI"){
f.insertAfter(T,_a())
}else{
f.replace(T,z)
}}else{
if(_t(true)){
if(_e=="LI"){
f.insertAfter(T,_a());
T.appendChild(f.doc.createTextNode(" "));
T.appendChild(z)
}else{
z.parentNode.insertBefore(T,z)
}}else{
if(_t()){
f.insertAfter(T,_a());
P(T)
}else{
z=_a();
U=F.cloneRange();
U.setStartAfter(A);
U.setEndAfter(z);
x=U.extractContents();
if(R=="LI"&&x.firstChild.nodeName=="LI"){
T=x.firstChild;
f.insertAfter(x,z)
}else{
f.insertAfter(x,z);
f.insertAfter(T,z)
}}}}
f.remove(A);
j(T);
v.add()
}
function Z(){
y.execCommand("InsertLineBreak",false,E)
}
function C(_e){
do{
if(_e.nodeType===3){
_e.nodeValue=_e.nodeValue.replace(/^[\r\n]+/,"")
}
_e=_e.firstChild
}
while(_e)
}
function V(_a){
var _e=f.getRoot(),_t,_i;
_t=_a;
while(_t!==_e&&f.getContentEditable(_t)!=="false"){
if(f.getContentEditable(_t)==="true"){
_i=_t
}
_t=_t.parentNode
}
return _t!==_e?_i:_e
}
function K(_t){
var _e;
if(!c){
_t.normalize();
_e=_t.lastChild;
if(!_e||(/^(left|right)$/gi.test(f.getStyle(_e,"float",true)))){
f.add(_t,"br")
}}}
function Y(){
if(/^(H[1-6]|PRE|FIGURE)$/.test(D)&&Q!="HGROUP"){
T=B(R)
}else{
T=B()
}
if(u.end_container_on_empty_block&&N(z)&&f.isEmpty(A)){
T=f.split(z,A)
}else{
f.insertAfter(T,A)
}
j(T)
}
F=b.getRng(true);
if(E.isDefaultPrevented()){
return
}
if(!F.collapsed){
y.execCommand("Delete");
return
}
new d(f).normalize(F);
I=F.startContainer;
S=F.startOffset;
R=(u.force_p_newlines?"p":"")||u.forced_root_block;
R=R?R.toUpperCase():"";
X=f.doc.documentMode;
G=E.shiftKey;
if(I.nodeType==1&&I.hasChildNodes()){
L=S>I.childNodes.length-1;
I=I.childNodes[Math.min(S,I.childNodes.length-1)]||I;
if(L&&I.nodeType==3){
S=I.nodeValue.length
}else{
S=0
}}
k=V(I);
if(!k){
return
}
v.beforeChange();
if(!f.isBlock(k)&&k!=f.getRoot()){
if(!R||G){
Z()
}
return
}
if((R&&!G)||(!R&&G)){
I=q(I,S)
}
A=f.getParent(I,f.isBlock);
z=A?f.getParent(A.parentNode,f.isBlock):null;
D=A?A.nodeName.toUpperCase():"";
Q=z?z.nodeName.toUpperCase():"";
if(Q=="LI"&&!E.ctrlKey){
A=z;
D=Q
}
if(/^(LI|DT|DD)$/.test(D)){
if(!R&&G){
Z();
return
}
if(f.isEmpty(A)){
J();
return
}}
if(D=="PRE"&&u.br_in_pre!==false){
if(!G){
Z();
return
}}else{
if((!R&&!G&&D!="LI")||(R&&G)){
Z();
return
}}
if(R&&A===y.getBody()){
return
}
R=R||"P";
if(W()){
Y()
}else{
if(W(true)){
T=A.parentNode.insertBefore(B(),A);
P(T);
j(A)
}else{
U=F.cloneRange();
U.setEndAfter(A);
x=U.extractContents();
C(x);
T=x.firstChild;
f.insertAfter(x,A);
H(T);
K(A);
if(f.isEmpty(A)){
O(A)
}
if(f.isEmpty(T)){
f.remove(T);
Y()
}else{
j(T)
}}}
f.setAttrib(T,"id","");
y.fire("NewBlock",{
newBlock:T}
);
v.add()
}
y.on("keydown",function(k){
if(k.keyCode==13){
if(g(k)!==false){
k.preventDefault()
}}}
)
}
}
);
r("tinymce/ForceBlocks",[],function(){
return function(c){
var l=c.settings,m=c.dom,h=c.selection;
var u=c.schema,d=u.getBlockElements();
function f(){
var v=h.getStart(),b=c.getBody(),p;
var k,T,B,A,w;
var x,q=-16777215,O,g;
var W,y,z;
z=l.forced_root_block;
if(!v||v.nodeType!==1||!z){
return
}
while(v&&v!=b){
if(d[v.nodeName]){
return
}
v=v.parentNode
}
p=h.getRng();
if(p.setStart){
k=p.startContainer;
T=p.startOffset;
B=p.endContainer;
A=p.endOffset;
try{
g=c.getDoc().activeElement===b
}
catch(j){}}else{
if(p.item){
v=p.item(0);
p=c.getDoc().body.createTextRange();
p.moveToElementText(v)
}
g=p.parentElement().ownerDocument===c.getDoc();
W=p.duplicate();
W.collapse(true);
T=W.move("character",q)*-1;
if(!W.collapsed){
W=p.duplicate();
W.collapse(false);
A=(W.move("character",q)*-1)-T
}}
v=b.firstChild;
y=b.nodeName.toLowerCase();
while(v){
if(((v.nodeType===3||(v.nodeType==1&&!d[v.nodeName])))&&u.isValidChild(y,z.toLowerCase())){
if(v.nodeType===3&&v.nodeValue.length===0){
x=v;
v=v.nextSibling;
m.remove(x);
continue
}
if(!w){
w=m.create(z,c.settings.forced_root_block_attrs);
v.parentNode.insertBefore(w,v);
O=true
}
x=v;
v=v.nextSibling;
w.appendChild(x)
}else{
w=null;
v=v.nextSibling
}}
if(O&&g){
if(p.setStart){
p.setStart(k,T);
p.setEnd(B,A);
h.setRng(p)
}else{
try{
p=c.getDoc().body.createTextRange();
p.moveToElementText(b);
p.collapse(true);
p.moveStart("character",T);
if(A>0){
p.moveEnd("character",A)
}
p.select()
}
catch(j){}}
c.nodeChanged()
}}
if(l.forced_root_block){
c.on("NodeChange",f)
}}
}
);
r("tinymce/EditorCommands",["tinymce/html/Serializer","tinymce/Env","tinymce/util/Tools","tinymce/dom/ElementUtils","tinymce/dom/RangeUtils","tinymce/dom/TreeWalker"],function(w,y,u,c,p,x){
var k=u.each,b=u.extend;
var l=u.map,q=u.inArray,v=u.explode;
var h=y.gecko,d=y.ie,f=y.ie&&y.ie<11;
var m=true,g=false;
return function(O){
var I,P,H,B={
state:{}
,exec:{}
,value:{}}
,E=O.settings,C;
O.on("PreInit",function(){
I=O.dom;
P=O.selection;
E=O.settings;
H=O.formatter
}
);
function Y(_e,X,Z,U){
var K,V,Q=0;
if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(_e)&&(!U||!U.skip_focus)){
O.focus()
}
U=b({}
,U);
U=O.fire("BeforeExecCommand",{
command:_e,ui:X,value:Z}
);
if(U.isDefaultPrevented()){
return false
}
V=_e.toLowerCase();
if((K=B.exec[V])){
K(V,X,Z);
O.fire("ExecCommand",{
command:_e,ui:X,value:Z}
);
return true
}
k(O.plugins,function(_t){
if(_t.execCommand&&_t.execCommand(_e,X,Z)){
O.fire("ExecCommand",{
command:_e,ui:X,value:Z}
);
Q=true;
return false
}}
);
if(Q){
return Q
}
if(O.theme&&O.theme.execCommand&&O.theme.execCommand(_e,X,Z)){
O.fire("ExecCommand",{
command:_e,ui:X,value:Z}
);
return true
}
try{
Q=O.getDoc().execCommand(_e,X,Z)
}
catch(J){}
if(Q){
O.fire("ExecCommand",{
command:_e,ui:X,value:Z}
);
return true
}
return false
}
function W(K){
var J;
if(O._isHidden()){
return
}
K=K.toLowerCase();
if((J=B.state[K])){
return J(K)
}
try{
return O.getDoc().queryCommandState(K)
}
catch(U){}
return false
}
function R(K){
var J;
if(O._isHidden()){
return
}
K=K.toLowerCase();
if((J=B.value[K])){
return J(K)
}
try{
return O.getDoc().queryCommandValue(K)
}
catch(U){}}
function F(U,J){
J=J||"exec";
k(U,function(Q,K){
k(K.toLowerCase().split(","),function(V){
B[J][V]=Q
}
)
}
)
}
function S(J,K,U){
J=J.toLowerCase();
B.exec[J]=function(X,Z,V,Q){
return K.call(U||O,Z,V,Q)
}
}
function L(J){
J=J.toLowerCase();
if(B.exec[J]){
return true
}
try{
return O.getDoc().queryCommandSupported(J)
}
catch(U){}
return false
}
function j(J,K,U){
J=J.toLowerCase();
B.state[J]=function(){
return K.call(U||O)
}
}
function z(J,K,U){
J=J.toLowerCase();
B.value[J]=function(){
return K.call(U||O)
}
}
function T(U){
U=U.toLowerCase();
return !!B.exec[U]
}
b(this,{
execCommand:Y,queryCommandState:W,queryCommandValue:R,queryCommandSupported:L,addCommands:F,addCommand:S,addQueryStateHandler:j,addQueryValueHandler:z,hasCustomCommand:T}
);
function A(K,J,U){
if(J===s){
J=g
}
if(U===s){
U=null
}
return O.getDoc().execCommand(K,J,U)
}
function G(U){
return H.match(U)
}
function N(U,J){
H.toggle(U,J?{
value:J}
:s);
O.nodeChanged()
}
function M(U){
C=P.getBookmark(U)
}
function D(){
P.moveToBookmark(C)
}
F({
"mceResetDesignMode,mceBeginUndoLevel":function(){}
,"mceEndUndoLevel,mceAddUndoLevel":function(){
O.undoManager.add()
}
,"Cut,Copy,Paste":function(V){
var K=O.getDoc(),U;
try{
A(V)
}
catch(J){
U=m
}
if(U||!K.queryCommandSupported(V)){
var Q=O.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");
if(y.mac){
Q=Q.replace(/Ctrl\+/g,"\u2318+")
}
O.windowManager.alert(Q)
}}
,unlink:function(){
if(P.isCollapsed()){
var U=P.getNode();
if(U.tagName=="A"){
O.dom.remove(U,true)
}
return
}
H.remove("link")
}
,"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(U){
var J=U.substring(7);
if(J=="full"){
J="justify"
}
k("left,center,right,justify".split(","),function(K){
if(J!=K){
H.remove("align"+K)
}}
);
if(J!="none"){
N("align"+J);
Y("mceRepaint")
}}
,"InsertUnorderedList,InsertOrderedList":function(K){
var U,J;
A(K);
U=I.getParent(P.getNode(),"ol,ul");
if(U){
J=U.parentNode;
if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(J.nodeName)){
M();
I.split(J,U);
D()
}}}
,"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(U){
N(U)
}
,"ForeColor,HiliteColor,FontName":function(K,J,U){
N(K,U)
}
,FontSize:function(Q,K,J){
var U,V;
if(J>=1&&J<=7){
V=v(E.font_size_style_values);
U=v(E.font_size_classes);
if(U){
J=U[J-1]||J
}else{
J=V[J-1]||J
}}
N(Q,J)
}
,RemoveFormat:function(U){
H.remove(U)
}
,mceBlockQuote:function(){
N("blockquote")
}
,FormatBlock:function(K,J,U){
return N(U||"p")
}
,mceCleanup:function(){
var U=P.getBookmark();
O.setContent(O.getContent({
cleanup:m}
),{
cleanup:m}
);
P.moveToBookmark(U)
}
,mceRemoveNode:function(Q,K,J){
var U=J||P.getNode();
if(U!=O.getBody()){
M();
O.dom.remove(U,m);
D()
}}
,mceSelectNodeDepth:function(Q,K,J){
var U=0;
I.getParent(P.getNode(),function(V){
if(V.nodeType==1&&U++==J){
P.select(V);
return g
}}
,O.getBody())
}
,mceSelectNode:function(K,J,U){
P.select(U)
}
,mceInsertContent:function(Z,_l,_c){
var V,_m,_a,_f,J,Q;
var _t,_e,_d,U,_o,X,_g;
var _r=O.schema.getTextInlineElements();
function _u(_v){
var _w,_b,_k;
_w=P.getRng(true);
_b=_w.startContainer;
_k=_w.startOffset;
function _y(_x){
return _b[_x]&&_b[_x].nodeType==3
}
if(_b.nodeType==3){
if(_k>0){
_v=_v.replace(/^&nbsp;/," ")
}else{
if(!_y("previousSibling")){
_v=_v.replace(/^ /,"&nbsp;")
}}
if(_k<_b.length){
_v=_v.replace(/&nbsp;(<br>|)$/," ")
}else{
if(!_y("nextSibling")){
_v=_v.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;")
}}}
return _v
}
function K(){
var _b,_y,_w;
_b=P.getRng(true);
_y=_b.startContainer;
_w=_b.startOffset;
if(_y.nodeType==3&&_b.collapsed){
if(_y.data[_w]==="\u00a0"){
_y.deleteData(_w,1);
if(!/[\u00a0| ]$/.test(_c)){
_c+=" "
}}else{
if(_y.data[_w-1]==="\u00a0"){
_y.deleteData(_w-1,1);
if(!/[\u00a0| ]$/.test(_c)){
_c=" "+_c
}}}}}
function _i(_y){
if(X){
for(_d=_y.firstChild;
_d;
_d=_d.walk(true)){
if(_r[_d.name]){
_d.attr("data-mce-new","true")
}}}}
function _p(){
if(X){
var _y=O.getBody(),_b=new c(I);
k(I.select("*[data-mce-new]"),function(_v){
_v.removeAttribute("data-mce-new");
for(var _w=_v.parentNode;
_w&&_w!=_y;
_w=_w.parentNode){
if(_b.compare(_w,_v)){
I.remove(_v,true)
}}}
)
}}
if(typeof _c!="string"){
X=_c.merge;
_g=_c.data;
_c=_c.content
}
if(/^ | $/.test(_c)){
_c=_u(_c)
}
V=O.parser;
_m=new w({}
,O.schema);
_o='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>';
Q={
content:_c,format:"html",selection:true};
O.fire("BeforeSetContent",Q);
_c=Q.content;
if(_c.indexOf("{$caret}")==-1){
_c+="{$caret}"
}
_c=_c.replace(/\{\$caret\}/,_o);
_e=P.getRng();
var _h=_e.startContainer||(_e.parentElement?_e.parentElement():null);
var _n=O.getBody();
if(_h===_n&&P.isCollapsed()){
if(I.isBlock(_n.firstChild)&&I.isEmpty(_n.firstChild)){
_e=I.createRng();
_e.setStart(_n.firstChild,0);
_e.setEnd(_n.firstChild,0);
P.setRng(_e)
}}
if(!P.isCollapsed()){
O.getDoc().execCommand("Delete",false,null);
K()
}
_a=P.getNode();
var _s={
context:_a.nodeName.toLowerCase(),data:_g};
J=V.parse(_c,_s);
_i(J);
_d=J.lastChild;
if(_d.attr("id")=="mce_marker"){
_t=_d;
for(_d=_d.prev;
_d;
_d=_d.walk(true)){
if(_d.type==3||!I.isBlock(_d.name)){
if(O.schema.isValidChild(_d.parent.name,"span")){
_d.parent.insert(_t,_d,_d.name==="br")
}
break
}}}
if(!_s.invalid){
_c=_m.serialize(J);
_d=_a.firstChild;
U=_a.lastChild;
if(!_d||(_d===U&&_d.nodeName==="BR")){
I.setHTML(_a,_c)
}else{
P.setContent(_c)
}}else{
P.setContent(_o);
_a=P.getNode();
_f=O.getBody();
if(_a.nodeType==9){
_a=_d=_f
}else{
_d=_a
}
while(_d!==_f){
_a=_d;
_d=_d.parentNode
}
_c=_a==_f?_f.innerHTML:I.getOuterHTML(_a);
_c=_m.serialize(V.parse(_c.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){
return _m.serialize(J)
}
)));
if(_a==_f){
I.setHTML(_f,_c)
}else{
I.setOuterHTML(_a,_c)
}}
_p();
_t=I.get("mce_marker");
P.scrollIntoView(_t);
_e=I.createRng();
_d=_t.previousSibling;
if(_d&&_d.nodeType==3){
_e.setStart(_d,_d.nodeValue.length);
if(!d){
U=_t.nextSibling;
if(U&&U.nodeType==3){
_d.appendData(U.data);
U.parentNode.removeChild(U)
}}}else{
_e.setStartBefore(_t);
_e.setEndBefore(_t)
}
I.remove(_t);
P.setRng(_e);
O.fire("SetContent",Q);
O.addVisual()
}
,mceInsertRawHTML:function(K,J,U){
P.setContent("tiny_mce_marker");
O.setContent(O.getContent().replace(/tiny_mce_marker/g,function(){
return U
}
))
}
,mceToggleFormat:function(K,J,U){
N(U)
}
,mceSetContent:function(K,J,U){
O.setContent(U)
}
,"Indent,Outdent":function(Q){
var J,U,K;
J=E.indentation;
U=/[a-z%]+$/i.exec(J);
J=parseInt(J,10);
if(!W("InsertUnorderedList")&&!W("InsertOrderedList")){
if(!E.forced_root_block&&!I.getParent(P.getNode(),I.isBlock)){
H.apply("div")
}
k(P.getSelectedBlocks(),function(Z){
if(Z.nodeName!="LI"){
var V=O.getParam("indent_use_margin",false)?"margin":"padding";
V+=I.getStyle(Z,"direction",true)=="rtl"?"Right":"Left";
if(Q=="outdent"){
K=Math.max(0,parseInt(Z.style[V]||0,10)-J);
I.setStyle(Z,V,K?K+U:"")
}else{
K=(parseInt(Z.style[V]||0,10)+J)+U;
I.setStyle(Z,V,K)
}}}
)
}else{
A(Q)
}}
,mceRepaint:function(){
if(h){
try{
M(m);
if(P.getSel()){
P.getSel().selectAllChildren(O.getBody())
}
P.collapse(m);
D()
}
catch(U){}}}
,InsertHorizontalRule:function(){
O.execCommand("mceInsertContent",false,"<hr />")
}
,mceToggleVisualAid:function(){
O.hasVisual=!O.hasVisual;
O.addVisual()
}
,mceReplaceContent:function(K,J,U){
O.execCommand("mceInsertContent",false,U.replace(/\{\$selection\}/g,P.getContent({
format:"text"}
)))
}
,mceInsertLink:function(Q,K,J){
var U;
if(typeof J=="string"){
J={
href:J}
}
U=I.getParent(P.getNode(),"a");
J.href=J.href.replace(" ","%20");
if(!U||!J.href){
H.remove("link")
}
if(J.href){
H.apply("link",J,U)
}}
,selectAll:function(){
var J=I.getRoot(),U;
if(P.getRng().setStart){
U=I.createRng();
U.setStart(J,0);
U.setEnd(J,J.childNodes.length);
P.setRng(U)
}else{
U=P.getRng();
if(!U.item){
U.moveToElementText(J);
U.select()
}}}
,"delete":function(){
A("Delete");
var U=O.getBody();
if(I.isEmpty(U)){
O.setContent("");
if(U.firstChild&&I.isBlock(U.firstChild)){
O.selection.setCursorLocation(U.firstChild,0)
}else{
O.selection.setCursorLocation(U,0)
}}}
,mceNewDocument:function(){
O.setContent("")
}
,InsertLineBreak:function(K,_n,_r){
var _o=_r;
var U,_a,_e;
var X=P.getRng(true);
new p(I).normalize(X);
var Z=X.startOffset;
var _i=X.startContainer;
if(_i.nodeType==1&&_i.hasChildNodes()){
var _h=Z>_i.childNodes.length-1;
_i=_i.childNodes[Math.min(Z,_i.childNodes.length-1)]||_i;
if(_h&&_i.nodeType==3){
Z=_i.nodeValue.length
}else{
Z=0
}}
var Q=I.getParent(_i,I.isBlock);
var V=Q?Q.nodeName.toUpperCase():"";
var J=Q?I.getParent(Q.parentNode,I.isBlock):null;
var _l=J?J.nodeName.toUpperCase():"";
var _s=_o&&_o.ctrlKey;
if(_l=="LI"&&!_s){
Q=J;
V=_l
}
function _t(){
var _m=new x(_i,Q),_u;
var _d=O.schema.getNonEmptyElements();
while((_u=_m.next())){
if(_d[_u.nodeName.toLowerCase()]||_u.length>0){
return true
}}}
if(_i&&_i.nodeType==3&&Z>=_i.nodeValue.length){
if(!f&&!_t()){
U=I.create("br");
X.insertNode(U);
X.setStartAfter(U);
X.setEndAfter(U);
_a=true
}}
U=I.create("br");
X.insertNode(U);
var _c=I.doc.documentMode;
if(f&&V=="PRE"&&(!_c||_c<8)){
U.parentNode.insertBefore(I.doc.createTextNode("\r"),U)
}
_e=I.create("span",{}
,"&nbsp;");
U.parentNode.insertBefore(_e,U);
P.scrollIntoView(_e);
I.remove(_e);
if(!_a){
X.setStartAfter(U);
X.setEndAfter(U)
}else{
X.setStartBefore(U);
X.setEndBefore(U)
}
P.setRng(X);
O.undoManager.add();
return m
}}
);
F({
"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(Q){
var J="align"+Q.substring(7);
var U=P.isCollapsed()?[I.getParent(P.getNode(),I.isBlock)]:P.getSelectedBlocks();
var K=l(U,function(V){
return !!H.matchNode(V,J)
}
);
return q(K,m)!==-1
}
,"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(U){
return G(U)
}
,mceBlockQuote:function(){
return G("blockquote")
}
,Outdent:function(){
var U;
if(E.inline_styles){
if((U=I.getParent(P.getStart(),I.isBlock))&&parseInt(U.style.paddingLeft,10)>0){
return m
}
if((U=I.getParent(P.getEnd(),I.isBlock))&&parseInt(U.style.paddingLeft,10)>0){
return m
}}
return(W("InsertUnorderedList")||W("InsertOrderedList")||(!E.inline_styles&&!!I.getParent(P.getNode(),"BLOCKQUOTE")))
}
,"InsertUnorderedList,InsertOrderedList":function(J){
var U=I.getParent(P.getNode(),"ul,ol");
return U&&(J==="insertunorderedlist"&&U.tagName==="UL"||J==="insertorderedlist"&&U.tagName==="OL")
}}
,"state");
F({
"FontSize,FontName":function(K){
var J=0,U;
if((U=I.getParent(P.getNode(),"span"))){
if(K=="fontsize"){
J=U.style.fontSize
}else{
J=U.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()
}}
return J
}}
,"value");
F({
Undo:function(){
O.undoManager.undo()
}
,Redo:function(){
O.undoManager.redo()
}}
)
}
}
);
r("tinymce/util/URI",["tinymce/util/Tools"],function(c){
var m=c.each,h=c.trim;
var d="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
var u={
ftp:21,http:80,https:443,mailto:25};
function l(g,y){
var p=this,w,b;
g=h(g);
y=p.settings=y||{};
w=y.base_uri;
if(/^([\w\-]+):([^\/]{2})/i.test(g)||/^\s*#/.test(g)){
p.source=g;
return
}
var f=g.indexOf("//")===0;
if(g.indexOf("/")===0&&!f){
g=(w?w.protocol||"http":"http")+"://mce_host"+g
}
if(!/^[\w\-]*:?\/\//.test(g)){
b=y.base_uri?y.base_uri.path:new l(location.href).directory;
if(y.base_uri.protocol===""){
g="//mce_host"+p.toAbsPath(b,g)
}else{
g=/([^#?]*)([#?]?.*)/.exec(g);
g=((w&&w.protocol)||"http")+"://mce_host"+p.toAbsPath(b,g[1])+g[2]
}}
g=g.replace(/@@/g,"(mce_at)");
g=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(g);
m(d,function(k,q){
var x=g[q];
if(x){
x=x.replace(/\(mce_at\)/g,"@@")
}
p[k]=x
}
);
if(w){
if(!p.protocol){
p.protocol=w.protocol
}
if(!p.userInfo){
p.userInfo=w.userInfo
}
if(!p.port&&p.host==="mce_host"){
p.port=w.port
}
if(!p.host||p.host==="mce_host"){
p.host=w.host
}
p.source=""
}
if(f){
p.protocol=""
}}
l.prototype={
setPath:function(p){
var f=this;
p=/^(.*?)\/?(\w+)?$/.exec(p);
f.path=p[0];
f.directory=p[1];
f.file=p[2];
f.source="";
f.getURI()
}
,toRelative:function(b){
var p=this,f;
if(b==="./"){
return b
}
b=new l(b,{
base_uri:p}
);
if((b.host!="mce_host"&&p.host!=b.host&&b.host)||p.port!=b.port||(p.protocol!=b.protocol&&b.protocol!=="")){
return b.getURI()
}
var g=p.getURI(),y=b.getURI();
if(g==y||(g.charAt(g.length-1)=="/"&&g.substr(0,g.length-1)==y)){
return g
}
f=p.toRelPath(p.path,b.path);
if(b.query){
f+="?"+b.query
}
if(b.anchor){
f+="#"+b.anchor
}
return f
}
,toAbsolute:function(p,f){
p=new l(p,{
base_uri:this}
);
return p.getURI(f&&this.isSameOrigin(p))
}
,isSameOrigin:function(f){
if(this.host==f.host&&this.protocol==f.protocol){
if(this.port==f.port){
return true
}
var p=u[this.protocol];
if(p&&((this.port||p)==(f.port||p))){
return true
}}
return false
}
,toRelPath:function(w,v){
var p,b=0,g="",y,f;
w=w.substring(0,w.lastIndexOf("/"));
w=w.split("/");
p=v.split("/");
if(w.length>=p.length){
for(y=0,f=w.length;
y<f;
y++){
if(y>=p.length||w[y]!=p[y]){
b=y+1;
break
}}}
if(w.length<p.length){
for(y=0,f=p.length;
y<f;
y++){
if(y>=w.length||w[y]!=p[y]){
b=y+1;
break
}}}
if(b===1){
return v
}
for(y=0,f=w.length-(b-1);
y<f;
y++){
g+="../"
}
for(y=b-1,f=p.length;
y<f;
y++){
if(y!=b-1){
g+="/"+p[y]
}else{
g+=p[y]
}}
return g
}
,toAbsPath:function(y,b){
var p,f=0,v=[],g,w;
g=/\/$/.test(b)?"/":"";
y=y.split("/");
b=b.split("/");
m(y,function(x){
if(x){
v.push(x)
}}
);
y=v;
for(p=b.length-1,v=[];
p>=0;
p--){
if(b[p].length===0||b[p]==="."){
continue
}
if(b[p]===".."){
f++;
continue
}
if(f>0){
f--;
continue
}
v.push(b[p])
}
p=y.length-f;
if(p<=0){
w=v.reverse().join("/")
}else{
w=y.slice(0,p).join("/")+"/"+v.reverse().join("/")
}
if(w.indexOf("/")!==0){
w="/"+w
}
if(g&&w.lastIndexOf("/")!==w.length-1){
w+=g
}
return w
}
,getURI:function(g){
var p,f=this;
if(!f.source||g){
p="";
if(!g){
if(f.protocol){
p+=f.protocol+"://"
}else{
p+="//"
}
if(f.userInfo){
p+=f.userInfo+"@"
}
if(f.host){
p+=f.host
}
if(f.port){
p+=":"+f.port
}}
if(f.path){
p+=f.path
}
if(f.query){
p+="?"+f.query
}
if(f.anchor){
p+="#"+f.anchor
}
f.source=p
}
return f.source
}};
l.parseDataUri=function(p){
var f,g;
p=decodeURIComponent(p).split(",");
g=/data:([^;]+)/.exec(p[0]);
if(g){
f=g[1]
}
return{
type:f,data:p[1]}
};
return l
}
);
r("tinymce/util/Class",["tinymce/util/Tools"],function(d){
var u=d.each,m=d.extend;
var c,l;
function h(){}
h.extend=c=function(f){
var x=this,k=x.prototype,v,p,w;
function g(){
var T,q,z,j=this;
if(!l){
if(j.init){
j.init.apply(j,arguments)
}
q=j.Mixins;
if(q){
T=q.length;
while(T--){
z=q[T];
if(z.init){
z.init.apply(j,arguments)
}}}}}
function y(){
return this
}
function b(q,j){
return function(){
var z=this,O=z._super,T;
z._super=k[q];
T=j.apply(z,arguments);
z._super=O;
return T
}
}
l=true;
v=new x();
l=false;
if(f.Mixins){
u(f.Mixins,function(q){
q=q;
for(var j in q){
if(j!=="init"){
f[j]=q[j]
}}}
);
if(k.Mixins){
f.Mixins=k.Mixins.concat(f.Mixins)
}}
if(f.Methods){
u(f.Methods.split(","),function(q){
f[q]=y
}
)
}
if(f.Properties){
u(f.Properties.split(","),function(q){
var j="_"+q;
f[q]=function(O){
var z=this,T;
if(O!==T){
z[j]=O;
return z
}
return z[j]
}
}
)
}
if(f.Statics){
u(f.Statics,function(j,q){
g[q]=j
}
)
}
if(f.Defaults&&k.Defaults){
f.Defaults=m({}
,k.Defaults,f.Defaults)
}
for(p in f){
w=f[p];
if(typeof w=="function"&&k[p]){
v[p]=b(p,w)
}else{
v[p]=w
}}
g.prototype=v;
g.constructor=g;
g.extend=c;
return g
};
return h
}
);
r("tinymce/util/EventDispatcher",["tinymce/util/Tools"],function(l){
var c=l.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchend"," ");
function h(g){
var x=this,k,u={}
,w;
function f(){
return false
}
function y(){
return true
}
g=g||{};
k=g.scope||x;
w=g.toggleEvent||f;
function m(T,z){
var j,O,q,A;
T=T.toLowerCase();
z=z||{};
z.type=T;
if(!z.target){
z.target=k
}
if(!z.preventDefault){
z.preventDefault=function(){
z.isDefaultPrevented=y
};
z.stopPropagation=function(){
z.isPropagationStopped=y
};
z.stopImmediatePropagation=function(){
z.isImmediatePropagationStopped=y
};
z.isDefaultPrevented=f;
z.isPropagationStopped=f;
z.isImmediatePropagationStopped=f
}
if(g.beforeFire){
g.beforeFire(z)
}
j=u[T];
if(j){
for(O=0,q=j.length;
O<q;
O++){
A=j[O];
if(A.once){
p(T,A.func)
}
if(z.isImmediatePropagationStopped()){
z.stopPropagation();
return z
}
if(A.func.call(k,z)===false){
z.preventDefault();
return z
}}}
return z
}
function b(T,W,z,q){
var j,A,O;
if(W===false){
W=f
}
if(W){
W={
func:W};
if(q){
l.extend(W,q)
}
A=T.toLowerCase().split(" ");
O=A.length;
while(O--){
T=A[O];
j=u[T];
if(!j){
j=u[T]=[];
w(T,true)
}
if(z){
j.unshift(W)
}else{
j.push(W)
}}}
return x
}
function p(z,W){
var T,q,O,A,j;
if(z){
A=z.toLowerCase().split(" ");
T=A.length;
while(T--){
z=A[T];
q=u[z];
if(!z){
for(O in u){
w(O,false);
delete u[O]
}
return x
}
if(q){
if(!W){
q.length=0
}else{
j=q.length;
while(j--){
if(q[j].func===W){
q=q.slice(0,j).concat(q.slice(j+1));
u[z]=q
}}}
if(!q.length){
w(z,false);
delete u[z]
}}}}else{
for(z in u){
w(z,false)
}
u={}
}
return x
}
function d(j,z,q){
return b(j,z,q,{
once:true}
)
}
function v(q){
q=q.toLowerCase();
return !(!u[q]||u[q].length===0)
}
x.fire=m;
x.on=b;
x.off=p;
x.once=d;
x.has=v
}
h.isNative=function(d){
return !!c[d.toLowerCase()]
};
return h
}
);
r("tinymce/data/Binding",[],function(){
function h(l){
this.create=l.create
}
h.create=function(c,l){
return new h({
create:function(d,m){
var p;
function u(g){
d.set(m,g.value)
}
function f(g){
c.set(l,g.value)
}
d.on("change:"+m,f);
c.on("change:"+l,u);
p=d._bindings;
if(!p){
p=d._bindings=[];
d.on("destroy",function(){
var g=p.length;
while(g--){
p[g]()
}}
)
}
p.push(function(){
c.off("change:"+l,u)
}
);
return c.get(l)
}}
)
};
return h
}
);
r("tinymce/util/Observable",["tinymce/util/EventDispatcher"],function(l){
function h(c){
if(!c._eventDispatcher){
c._eventDispatcher=new l({
scope:c,toggleEvent:function(d,u){
if(l.isNative(d)&&c.toggleNativeEvent){
c.toggleNativeEvent(d,u)
}}}
)
}
return c._eventDispatcher
}
return{
fire:function(m,u,c){
var d=this;
if(d.removed&&m!=="remove"){
return u
}
u=h(d).fire(m,u,c);
if(c!==false&&d.parent){
var f=d.parent();
while(f&&!u.isPropagationStopped()){
f.fire(m,u,false);
f=f.parent()
}}
return u
}
,on:function(d,u,c){
return h(this).on(d,u,c)
}
,off:function(c,d){
return h(this).off(c,d)
}
,once:function(c,d){
return h(this).once(c,d)
}
,hasEventListeners:function(c){
return h(this).has(c)
}}
}
);
r("tinymce/data/ObservableObject",["tinymce/data/Binding","tinymce/util/Observable","tinymce/util/Class","tinymce/util/Tools"],function(m,l,h,c){
function u(f){
return f.nodeType>0
}
function d(p,f){
var g,y;
if(p===f){
return true
}
if(p===null||f===null){
return p===f
}
if(typeof p!=="object"||typeof f!=="object"){
return p===f
}
if(c.isArray(f)){
if(p.length!==f.length){
return false
}
g=p.length;
while(g--){
if(!d(p[g],f[g])){
return false
}}}
if(u(p)||u(f)){
return p===f
}
y={};
for(g in f){
if(!d(p[g],f[g])){
return false
}
y[g]=true
}
for(g in p){
if(!y[g]&&!d(p[g],f[g])){
return false
}}
return true
}
return h.extend({
Mixins:[l],init:function(g){
var f,p;
g=g||{};
for(f in g){
p=g[f];
if(p instanceof m){
g[f]=p.create(this,f)
}}
this.data=g
}
,set:function(g,b){
var y,p,f=this.data[g];
if(b instanceof m){
b=b.create(this,g)
}
if(typeof g==="object"){
for(y in g){
this.set(y,g[y])
}
return this
}
if(!d(f,b)){
this.data[g]=b;
p={
target:this,name:g,value:b,oldValue:f};
this.fire("change:"+g,p);
this.fire("change",p)
}
return this
}
,get:function(f){
return this.data[f]
}
,has:function(f){
return f in this.data
}
,bind:function(f){
return m.create(this,f)
}
,destroy:function(){
this.fire("destroy")
}}
)
}
);
r("tinymce/ui/Selector",["tinymce/util/Class"],function(c){function f(b){
var p=[],g=b.length,y;
while(g--){
y=b[g];
if(!y.__checked){
p.push(y);
y.__checked=1
}}
g=p.length;
while(g--){
delete p[g].__checked
}
return p
}
var m=/^([\w\\*]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i;
var h=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,u=/^\s*|\s*$/g,d;
var l=c.extend({
init:function(g){
var b=this.match;
function y(j){
if(j){
j=j.toLowerCase();
return function(z){
return j==="*"||z.type===j
}
}}
function x(j){
if(j){
return function(z){
return z._name===j
}
}}
function w(j){
if(j){
j=j.split(".");
return function(T){
var z=j.length;
while(z--){
if(!T.classes.contains(j[z])){
return false
}}
return true
}
}}
function p(z,T,j){
if(z){
return function(O){
var A=O[z]?O[z]():"";
return !T?!!j:T==="="?A===j:T==="*="?A.indexOf(j)>=0:T==="~="?(" "+A+" ").indexOf(" "+j+" ")>=0:T==="!="?A!=j:T==="^="?A.indexOf(j)===0:T==="$="?A.substr(A.length-j.length)===j:false
}
}}
function k(j){
var z;
if(j){
j=/(?:not\((.+)\))|(.+)/i.exec(j);
if(!j[1]){
j=j[2];
return function(A,T,O){
return j==="first"?T===0:j==="last"?T===O-1:j==="even"?T%2===0:j==="odd"?T%2===1:A[j]?A[j]():false
}
}
z=v(j[1],[]);
return function(T){
return !b(T,z)
}
}}
function q(j,z,A){
var O;
function T(W){
if(W){
z.push(W)
}}
O=m.exec(j.replace(u,""));
T(y(O[1]));
T(x(O[2]));
T(w(O[3]));
T(p(O[4],O[5],O[6]));
T(k(O[7]));
z.psuedo=!!O[7];
z.direct=A;
return z
}
function v(z,O){
var W=[],j,A,T;
do{
h.exec("");
A=h.exec(z);
if(A){
z=A[3];
W.push(A[1]);
if(A[2]){
j=A[3];
break
}}}
while(A);
if(j){
v(j,O)
}
z=[];
for(T=0;
T<W.length;
T++){
if(W[T]!=">"){
z.push(q(W[T],[],W[T-1]===">"))
}}
O.push(z);
return O
}
this._selectors=v(g,[])
}
,match:function(v,O){
var k,y,x,b,w,W,T,g,j,p,z,q,A;
O=O||this._selectors;
for(k=0,y=O.length;
k<y;
k++){
w=O[k];
b=w.length;
A=v;
q=0;
for(x=b-1;
x>=0;
x--){
g=w[x];
while(A){
if(g.psuedo){
z=A.parent().items();
j=p=z.length;
while(j--){
if(z[j]===A){
break
}}}
for(W=0,T=g.length;
W<T;
W++){
if(!g[W](A,j,p)){
W=T+1;
break
}}
if(W===T){
q++;
break
}else{
if(x===b-1){
break
}}
A=A.parent()
}}
if(q===b){
return true
}}
return false
}
,find:function(g){
var v=[],b,p,y=this._selectors;
function w(T,q,z){
var j,x,A,O,W,k=q[z];
for(j=0,x=T.length;
j<x;
j++){
W=T[j];
for(A=0,O=k.length;
A<O;
A++){
if(!k[A](W,j,x)){
A=O+1;
break
}}
if(A===O){
if(z==q.length-1){
v.push(W)
}else{
if(W.items){
w(W.items(),q,z+1)
}}}else{
if(k.direct){
return
}}
if(W.items){
w(W.items(),q,z)
}}}
if(g.items){
for(b=0,p=y.length;
b<p;
b++){
w(g.items(),y[b],0)
}
if(p>1){
v=f(v)
}}
if(!d){
d=l.Collection
}
return new d(v)
}}
);
return l
}
);
r("tinymce/ui/Collection",["tinymce/util/Tools","tinymce/ui/Selector","tinymce/util/Class"],function(d,h,l){var u,m,c=Array.prototype.push,f=Array.prototype.slice;
m={
length:0,init:function(p){
if(p){
this.add(p)
}}
,add:function(g){
var p=this;
if(!d.isArray(g)){
if(g instanceof u){
p.add(g.toArray())
}else{
c.call(p,g)
}}else{
c.apply(p,g)
}
return p
}
,set:function(y){
var g=this,p=g.length,b;
g.length=0;
g.add(y);
for(b=g.length;
b<p;
b++){
delete g[b]
}
return g
}
,filter:function(p){
var y=this,w,g,k=[],v,b;
if(typeof p==="string"){
p=new h(p);
b=function(x){
return p.match(x)
}
}else{
b=p
}
for(w=0,g=y.length;
w<g;
w++){
v=y[w];
if(b(v)){
k.push(v)
}}
return new u(k)
}
,slice:function(){
return new u(f.apply(this,arguments))
}
,eq:function(p){
return p===-1?this.slice(p):this.slice(p,+p+1)
}
,each:function(p){
d.each(this,p);
return this
}
,toArray:function(){
return d.toArray(this)
}
,indexOf:function(y){
var p=this,g=p.length;
while(g--){
if(p[g]===y){
break
}}
return g
}
,reverse:function(){
return new u(d.toArray(this).reverse())
}
,hasClass:function(p){
return this[0]?this[0].classes.contains(p):false
}
,prop:function(g,w){
var p=this,y,b;
if(w!==y){
p.each(function(v){
if(v[g]){
v[g](w)
}}
);
return p
}
b=p[0];
if(b&&b[g]){
return b[g]()
}}
,exec:function(y){
var p=this,g=d.toArray(arguments).slice(1);
p.each(function(b){
if(b[y]){
b[y].apply(b,g)
}}
);
return p
}
,remove:function(){
var p=this.length;
while(p--){
this[p].remove()
}
return this
}
,addClass:function(p){
return this.each(function(g){
g.classes.add(p)
}
)
}
,removeClass:function(p){
return this.each(function(g){
g.classes.remove(p)
}
)
}};
d.each("fire on off show hide append prepend before after reflow".split(" "),function(p){
m[p]=function(){
var g=d.toArray(arguments);
this.each(function(y){
if(p in y){
y[p].apply(y,g)
}}
);
return this
}
}
);
d.each("text name disabled active selected checked visible parent value data".split(" "),function(p){
m[p]=function(g){
return this.prop(p,g)
}
}
);
u=l.extend(m);
h.Collection=u;
return u
}
);
r("tinymce/ui/DomUtils",["tinymce/util/Tools","tinymce/dom/DOMUtils"],function(h,c){var l=0;
return{
id:function(){
return"mceu_"+(l++)
}
,createFragment:function(d){
return c.DOM.createFragment(d)
}
,getWindowSize:function(){
return c.DOM.getViewPort()
}
,getSize:function(f){
var u,d;
if(f.getBoundingClientRect){
var m=f.getBoundingClientRect();
u=Math.max(m.width||(m.right-m.left),f.offsetWidth);
d=Math.max(m.height||(m.bottom-m.bottom),f.offsetHeight)
}else{
u=f.offsetWidth;
d=f.offsetHeight
}
return{
width:u,height:d}
}
,getPos:function(u,d){
return c.DOM.getPos(u,d)
}
,getViewPort:function(d){
return c.DOM.getViewPort(d)
}
,get:function(d){
return document.getElementById(d)
}
,addClass:function(u,d){
return c.DOM.addClass(u,d)
}
,removeClass:function(u,d){
return c.DOM.removeClass(u,d)
}
,hasClass:function(u,d){
return c.DOM.hasClass(u,d)
}
,toggleClass:function(m,d,u){
return c.DOM.toggleClass(m,d,u)
}
,css:function(m,d,u){
return c.DOM.setStyle(m,d,u)
}
,getRuntimeStyle:function(u,d){
return c.DOM.getStyle(u,d,true)
}
,on:function(m,d,f,u){
return c.DOM.bind(m,d,f,u)
}
,off:function(u,d,m){
return c.DOM.unbind(u,d,m)
}
,fire:function(m,u,d){
return c.DOM.fire(m,u,d)
}
,innerHtml:function(u,d){
c.DOM.setHTML(u,d)
}}
}
);
r("tinymce/ui/BoxUtils",[],function(){return{
parseBox:function(c){
var h,l=10;
if(!c){
return
}
if(typeof c==="number"){
c=c||0;
return{
top:c,left:c,bottom:c,right:c}
}
c=c.split(" ");
h=c.length;
if(h===1){
c[1]=c[2]=c[3]=c[0]
}else{
if(h===2){
c[2]=c[0];
c[3]=c[1]
}else{
if(h===3){
c[3]=c[1]
}}}
return{
top:parseInt(c[0],l)||0,right:parseInt(c[1],l)||0,bottom:parseInt(c[2],l)||0,left:parseInt(c[3],l)||0}
}
,measureBox:function(d,l){
function h(u){
var m=document.defaultView;
if(m){
u=u.replace(/[A-Z]/g,function(f){
return"-"+f
}
);
return m.getComputedStyle(d,null).getPropertyValue(u)
}
return d.currentStyle[u]
}
function c(u){
var m=parseFloat(h(u),10);
return isNaN(m)?0:m
}
return{
top:c(l+"TopWidth"),right:c(l+"RightWidth"),bottom:c(l+"BottomWidth"),left:c(l+"LeftWidth")}
}}
}
);
r("tinymce/ui/ClassList",["tinymce/util/Tools"],function(h){function l(){}
function c(d){
this.cls=[];
this.cls._map={};
this.onchange=d||l;
this.prefix=""
}
h.extend(c.prototype,{
add:function(d){
if(d&&!this.contains(d)){
this.cls._map[d]=true;
this.cls.push(d);
this._change()
}
return this
}
,remove:function(d){
if(this.contains(d)){
for(var u=0;
u<this.cls.length;
u++){
if(this.cls[u]===d){
break
}}
this.cls.splice(u,1);
delete this.cls._map[d];
this._change()
}
return this
}
,toggle:function(d,u){
var m=this.contains(d);
if(m!==u){
if(m){
this.remove(d)
}else{
this.add(d)
}
this._change()
}
return this
}
,contains:function(d){
return !!this.cls._map[d]
}
,_change:function(){
delete this.clsValue;
this.onchange.call(this)
}}
);
c.prototype.toString=function(){
var u;
if(this.clsValue){
return this.clsValue
}
u="";
for(var d=0;
d<this.cls.length;
d++){
if(d>0){
u+=" "
}
u+=this.prefix+this.cls[d]
}
return u
};
return c
}
);
r("tinymce/ui/ReflowQueue",[],function(){
var l={}
,h;
function c(g,f){
var m,u=window.requestAnimationFrame,p=["ms","moz","webkit"];
function d(y){
window.setTimeout(y,0)
}
for(m=0;
m<p.length&&!u;
m++){
u=window[p[m]+"RequestAnimationFrame"]
}
if(!u){
u=d
}
u(g,f)
}
return{
add:function(u){
var d=u.parent();
if(d){
if(!d._layout||d._layout.isNative()){
return
}
if(!l[d._id]){
l[d._id]=d
}
if(!h){
h=true;
c(function(){
var f,m;
h=false;
for(f in l){
m=l[f];
if(m.state.get("rendered")){
m.reflow()
}}
l={}
}
,document.body)
}}}
,remove:function(d){
if(l[d._id]){
delete l[d._id]
}}}
}
);
r("tinymce/ui/Control",["tinymce/util/Class","tinymce/util/Tools","tinymce/util/EventDispatcher","tinymce/data/ObservableObject","tinymce/ui/Collection","tinymce/ui/DomUtils","tinymce/dom/DomQuery","tinymce/ui/BoxUtils","tinymce/ui/ClassList","tinymce/ui/ReflowQueue"],function(v,l,q,d,j,k,u,b,h,w){var g="onmousewheel" in document;
var x=false;
var c="mce-";
var z,m=0;
var p={
Statics:{
classPrefix:c}
,isRtl:function(){
return z.rtl
}
,classPrefix:c,init:function(W){
var O=this,A,T;
function B(D){
var C;
D=D.split(" ");
for(C=0;
C<D.length;
C++){
O.classes.add(D[C])
}}
O.settings=W=l.extend({}
,O.Defaults,W);
O._id=W.id||("mceu_"+(m++));
O._aria={
role:W.role};
O._elmCache={};
O.$=u;
O.state=new d({
visible:true,active:false,disabled:false,value:""}
);
O.data=new d(W.data);
O.classes=new h(function(){
if(O.state.get("rendered")){
O.getEl().className=this.toString()
}}
);
O.classes.prefix=O.classPrefix;
A=W.classes;
if(A){
if(O.Defaults){
T=O.Defaults.classes;
if(T&&A!=T){
B(T)
}}
B(A)
}
l.each("title text name visible disabled active value".split(" "),function(C){
if(C in W){
O[C](W[C])
}}
);
O.on("click",function(){
if(O.disabled()){
return false
}}
);
O.settings=W;
O.borderBox=b.parseBox(W.border);
O.paddingBox=b.parseBox(W.padding);
O.marginBox=b.parseBox(W.margin);
if(W.hidden){
O.hide()
}}
,Properties:"parent,name",getContainerElm:function(){
return document.body
}
,getParentCtrl:function(A){
var T,O=this.getRoot().controlIdLookup;
while(A&&O){
T=O[A.id];
if(T){
break
}
A=A.parentNode
}
return T
}
,initLayoutRect:function(){
var L=this,F=L.settings,W,I;
var R=L.getEl(),S,E,B,Y,D;
var T,A,G;
W=L.borderBox=L.borderBox||b.measureBox(R,"border");
L.paddingBox=L.paddingBox||b.measureBox(R,"padding");
L.marginBox=L.marginBox||b.measureBox(R,"margin");
G=k.getSize(R);
T=F.minWidth;
A=F.minHeight;
B=T||G.width;
Y=A||G.height;
S=F.width;
E=F.height;
D=F.autoResize;
D=typeof D!="undefined"?D:!S&&!E;
S=S||B;
E=E||Y;
var M=W.left+W.right;
var O=W.top+W.bottom;
var C=F.maxWidth||65535;
var H=F.maxHeight||65535;
L._layoutRect=I={
x:F.x||0,y:F.y||0,w:S,h:E,deltaW:M,deltaH:O,contentW:S-M,contentH:E-O,innerW:S-M,innerH:E-O,startMinWidth:T||0,startMinHeight:A||0,minW:Math.min(B,C),minH:Math.min(Y,H),maxW:C,maxH:H,autoResize:D,scrollW:0};
L._lastLayoutRect={};
return I
}
,layoutRect:function(O){
var S=this,W=S._layoutRect,D,F,C,B,T,A;
if(!W){
W=S.initLayoutRect()
}
if(O){
C=W.deltaW;
B=W.deltaH;
if(O.x!==T){
W.x=O.x
}
if(O.y!==T){
W.y=O.y
}
if(O.minW!==T){
W.minW=O.minW
}
if(O.minH!==T){
W.minH=O.minH
}
F=O.w;
if(F!==T){
F=F<W.minW?W.minW:F;
F=F>W.maxW?W.maxW:F;
W.w=F;
W.innerW=F-C
}
F=O.h;
if(F!==T){
F=F<W.minH?W.minH:F;
F=F>W.maxH?W.maxH:F;
W.h=F;
W.innerH=F-B
}
F=O.innerW;
if(F!==T){
F=F<W.minW-C?W.minW-C:F;
F=F>W.maxW-C?W.maxW-C:F;
W.innerW=F;
W.w=F+C
}
F=O.innerH;
if(F!==T){
F=F<W.minH-B?W.minH-B:F;
F=F>W.maxH-B?W.maxH-B:F;
W.innerH=F;
W.h=F+B
}
if(O.contentW!==T){
W.contentW=O.contentW
}
if(O.contentH!==T){
W.contentH=O.contentH
}
D=S._lastLayoutRect;
if(D.x!==W.x||D.y!==W.y||D.w!==W.w||D.h!==W.h){
A=z.repaintControls;
if(A){
if(A.map&&!A.map[S._id]){
A.push(S);
A.map[S._id]=true
}}
D.x=W.x;
D.y=W.y;
D.w=W.w;
D.h=W.h
}
return S
}
return W
}
,repaint:function(){
var R=this,O,W,C,B,T;
var F=0,A=0,S,M,D;
M=!document.createRange?Math.round:function(H){
return H
};
O=R.getEl().style;
B=R._layoutRect;
S=R._lastRepaintRect||{};
T=R.borderBox;
F=T.left+T.right;
A=T.top+T.bottom;
if(B.x!==S.x){
O.left=M(B.x)+"px";
S.x=B.x
}
if(B.y!==S.y){
O.top=M(B.y)+"px";
S.y=B.y
}
if(B.w!==S.w){
D=M(B.w-F);
O.width=(D>=0?D:0)+"px";
S.w=B.w
}
if(B.h!==S.h){
D=M(B.h-A);
O.height=(D>=0?D:0)+"px";
S.h=B.h
}
if(R._hasBody&&B.innerW!==S.innerW){
D=M(B.innerW);
C=R.getEl("body");
if(C){
W=C.style;
W.width=(D>=0?D:0)+"px"
}
S.innerW=B.innerW
}
if(R._hasBody&&B.innerH!==S.innerH){
D=M(B.innerH);
C=C||R.getEl("body");
if(C){
W=W||C.style;
W.height=(D>=0?D:0)+"px"
}
S.innerH=B.innerH
}
R._lastRepaintRect=S;
R.fire("repaint",{}
,false)
}
,on:function(A,W){
var O=this;
function T(B){
var D,C;
if(typeof B!="string"){
return B
}
return function(S){
if(!D){
O.parentsAndSelf().each(function(M){
var F=M.settings.callbacks;
if(F&&(D=F[B])){
C=M;
return false
}}
)
}
if(!D){
S.action=B;
this.fire("execute",S);
return
}
return D.call(C,S)
}
}
y(O).on(A,T(W));
return O
}
,off:function(T,O){
y(this).off(T,O);
return this
}
,fire:function(W,A,T){
var O=this;
A=A||{};
if(!A.control){
A.control=O
}
A=y(O).fire(W,A);
if(T!==false&&O.parent){
var B=O.parent();
while(B&&!A.isPropagationStopped()){
B.fire(W,A,false);
B=B.parent()
}}
return A
}
,hasEventListeners:function(T){
return y(this).has(T)
}
,parents:function(T){
var O=this,W,A=new j();
for(W=O.parent();
W;
W=W.parent()){
A.add(W)
}
if(T){
A=A.filter(T)
}
return A
}
,parentsAndSelf:function(T){
return new j(this).add(this.parents(T))
}
,next:function(){
var T=this.parent().items();
return T[T.indexOf(this)+1]
}
,prev:function(){
var T=this.parent().items();
return T[T.indexOf(this)-1]
}
,innerHtml:function(T){
this.$el.html(T);
return this
}
,getEl:function(T){
var O=T?this._id+"-"+T:this._id;
if(!this._elmCache[O]){
this._elmCache[O]=u("#"+O)[0]
}
return this._elmCache[O]
}
,show:function(){
return this.visible(true)
}
,hide:function(){
return this.visible(false)
}
,focus:function(){
try{
this.getEl().focus()
}
catch(T){}
return this
}
,blur:function(){
this.getEl().blur();
return this
}
,aria:function(O,A){
var T=this,W=T.getEl(T.ariaTarget);
if(typeof A==="undefined"){
return T._aria[O]
}
T._aria[O]=A;
if(T.state.get("rendered")){
W.setAttribute(O=="role"?O:"aria-"+O,A)
}
return T
}
,encode:function(O,T){
if(T!==false){
O=this.translate(O)
}
return(O||"").replace(/[&<>"]/g,function(A){
return"&#"+A.charCodeAt(0)+";"
}
)
}
,translate:function(T){
return z.translate?z.translate(T):T
}
,before:function(O){
var T=this,A=T.parent();
if(A){
A.insert(O,A.items().indexOf(T),true)
}
return T
}
,after:function(O){
var T=this,A=T.parent();
if(A){
A.insert(O,A.items().indexOf(T))
}
return T
}
,remove:function(){
var O=this,D=O.getEl(),B=O.parent(),A,W;
if(O.items){
var T=O.items().toArray();
W=T.length;
while(W--){
T[W].remove()
}}
if(B&&B.items){
A=[];
B.items().each(function(S){
if(S!==O){
A.push(S)
}}
);
B.items().set(A);
B._lastRect=null
}
if(O._eventsRoot&&O._eventsRoot==O){
u(D).off()
}
var C=O.getRoot().controlIdLookup;
if(C){
delete C[O._id]
}
if(D&&D.parentNode){
D.parentNode.removeChild(D)
}
O.state.set("rendered",false);
O.state.destroy();
O.fire("remove");
return O
}
,renderBefore:function(T){
u(T).before(this.renderHtml());
this.postRender();
return this
}
,renderTo:function(T){
u(T||this.getContainerElm()).append(this.renderHtml());
this.postRender();
return this
}
,preRender:function(){}
,render:function(){}
,renderHtml:function(){
return'<div id="'+this._id+'" class="'+this.classes+'"></div>'
}
,postRender:function(){
var F=this,O=F.settings,W,A,D,T,C;
F.$el=u(F.getEl());
F.state.set("rendered",true);
for(T in O){
if(T.indexOf("on")===0){
F.on(T.substr(2),O[T])
}}
if(F._eventsRoot){
for(D=F.parent();
!C&&D;
D=D.parent()){
C=D._eventsRoot
}
if(C){
for(T in C._nativeEvents){
F._nativeEvents[T]=true
}}}
f(F);
if(O.style){
W=F.getEl();
if(W){
W.setAttribute("style",O.style);
W.style.cssText=O.style
}}
if(F.settings.border){
A=F.borderBox;
F.$el.css({
"border-top-width":A.top,"border-right-width":A.right,"border-bottom-width":A.bottom,"border-left-width":A.left}
)
}
var B=F.getRoot();
if(!B.controlIdLookup){
B.controlIdLookup={}
}
B.controlIdLookup[F._id]=F;
for(var S in F._aria){
F.aria(S,F._aria[S])
}
if(F.state.get("visible")===false){
F.getEl().style.display="none"
}
F.bindStates();
F.state.on("change:visible",function(H){
var R=H.value,M;
if(F.state.get("rendered")){
F.getEl().style.display=R===false?"none":"";
F.getEl().getBoundingClientRect()
}
M=F.parent();
if(M){
M._lastRect=null
}
F.fire(R?"show":"hide");
w.add(F)
}
);
F.fire("postrender",{}
,false)
}
,bindStates:function(){}
,scrollIntoView:function(A){
function R(G,Y){
var H,E,I=G;
H=E=0;
while(I&&I!=Y&&I.nodeType){
H+=I.offsetLeft||0;
E+=I.offsetTop||0;
I=I.offsetParent
}
return{
x:H,y:E}
}
var B=this.getEl(),W=B.parentNode;
var S,D,T,M,F,O;
var C=R(B,W);
S=C.x;
D=C.y;
T=B.offsetWidth;
M=B.offsetHeight;
F=W.clientWidth;
O=W.clientHeight;
if(A=="end"){
S-=F-T;
D-=O-M
}else{
if(A=="center"){
S-=(F/2)-(T/2);
D-=(O/2)-(M/2)
}}
W.scrollLeft=S;
W.scrollTop=D;
return this
}
,getRoot:function(){
var W=this,A,T=[];
while(W){
if(W.rootControl){
A=W.rootControl;
break
}
T.push(W);
A=W;
W=W.parent()
}
if(!A){
A=this
}
var O=T.length;
while(O--){
T[O].rootControl=A
}
return A
}
,reflow:function(){
w.remove(this);
var T=this.parent();
if(T._layout&&!T._layout.isNative()){
T.reflow()
}
return this
}};
l.each("text title visible disabled active value".split(" "),function(T){
p[T]=function(O){
if(arguments.length===0){
return this.state.get(T)
}
if(typeof O!="undefined"){
this.state.set(T,O)
}
return this
}
}
);
z=v.extend(p);
function y(T){
if(!T._eventDispatcher){
T._eventDispatcher=new q({
scope:T,toggleEvent:function(O,A){
if(A&&q.isNative(O)){
if(!T._nativeEvents){
T._nativeEvents={}
}
T._nativeEvents[O]=true;
if(T.state.get("rendered")){
f(T)
}}}}
)
}
return T._eventDispatcher
}
function f(D){
var C,W,R,A,F,O;
function M(Y){
var I=D.getParentCtrl(Y.target);
if(I){
I.fire(Y.type,Y)
}}
function B(){
var I=A._lastHoverCtrl;
if(I){
I.fire("mouseleave",{
target:I.getEl()}
);
I.parents().each(function(Y){
Y.fire("mouseleave",{
target:Y.getEl()}
)
}
);
A._lastHoverCtrl=null
}}
function H(N){
var L=D.getParentCtrl(N.target),G=A._lastHoverCtrl,I=0,E,Y,P;
if(L!==G){
A._lastHoverCtrl=L;
Y=L.parents().toArray().reverse();
Y.push(L);
if(G){
P=G.parents().toArray().reverse();
P.push(G);
for(I=0;
I<P.length;
I++){
if(Y[I]!==P[I]){
break
}}
for(E=P.length-1;
E>=I;
E--){
G=P[E];
G.fire("mouseleave",{
target:G.getEl()}
)
}}
for(E=I;
E<Y.length;
E++){
L=Y[E];
L.fire("mouseenter",{
target:L.getEl()}
)
}}}
function T(I){
I.preventDefault();
if(I.type=="mousewheel"){
I.deltaY=-1/40*I.wheelDelta;
if(I.wheelDeltaX){
I.deltaX=-1/40*I.wheelDeltaX
}}else{
I.deltaX=0;
I.deltaY=I.detail
}
I=D.fire("wheel",I)
}
F=D._nativeEvents;
if(F){
R=D.parents().toArray();
R.unshift(D);
for(C=0,W=R.length;
!A&&C<W;
C++){
A=R[C]._eventsRoot
}
if(!A){
A=R[R.length-1]||D
}
D._eventsRoot=A;
for(W=C,C=0;
C<W;
C++){
R[C]._eventsRoot=A
}
var S=A._delegates;
if(!S){
S=A._delegates={}
}
for(O in F){
if(!F){
return false
}
if(O==="wheel"&&!x){
if(g){
u(D.getEl()).on("mousewheel",T)
}else{
u(D.getEl()).on("DOMMouseScroll",T)
}
continue
}
if(O==="mouseenter"||O==="mouseleave"){
if(!A._hasMouseEnter){
u(A.getEl()).on("mouseleave",B).on("mouseover",H);
A._hasMouseEnter=1
}}else{
if(!S[O]){
u(A.getEl()).on(O,M);
S[O]=true
}}
F[O]=false
}}}
return z
}
);
r("tinymce/ui/Factory",[],function(){var h={}
,l;
return{
add:function(c,d){
h[c.toLowerCase()]=d
}
,has:function(c){
return !!h[c.toLowerCase()]
}
,create:function(f,m){
var c,d,u;
if(!l){
u=tinymce.ui;
for(d in u){
h[d.toLowerCase()]=u[d]
}
l=true
}
if(typeof f=="string"){
m=m||{};
m.type=f
}else{
m=f;
f=m.type
}
f=f.toLowerCase();
c=h[f];
if(!c){
throw new Error("Could not find control by type: "+f)
}
c=new c(m);
c.type=f;
return c
}}
}
);
r("tinymce/ui/KeyboardNavigation",[],function(){return function(O){
var q=O.root,h,p;
function x(C){
return C&&C.nodeType===1
}
try{
h=document.activeElement
}
catch(T){
h=document.body
}
p=q.getParentCtrl(h);
function w(C){
C=C||h;
if(x(C)){
return C.getAttribute("role")
}
return null
}
function B(S){
var D,C=S||h;
while((C=C.parentNode)){
if((D=w(C))){
return D
}}}
function k(C){
var D=h;
if(x(D)){
return D.getAttribute("aria-"+C)
}}
function v(D){
var C=D.tagName.toUpperCase();
return C=="INPUT"||C=="TEXTAREA"
}
function l(C){
if(v(C)&&!C.hidden){
return true
}
if(/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell)$/.test(w(C))){
return true
}
return false
}
function f(S){
var D=[];
function C(M){
if(M.nodeType!=1||M.style.display=="none"){
return
}
if(l(M)){
D.push(M)
}
for(var F=0;
F<M.childNodes.length;
F++){
C(M.childNodes[F])
}}
C(S||q.getEl());
return D
}
function m(F){
var D,C;
F=F||p;
C=F.parents().toArray();
C.unshift(F);
for(var S=0;
S<C.length;
S++){
D=C[S];
if(D.settings.ariaRoot){
break
}}
return D
}
function j(S){
var C=m(S);
var D=f(C.getEl());
if(C.settings.ariaRemember&&"lastAriaIndex" in C){
y(C.lastAriaIndex,D)
}else{
y(0,D)
}}
function y(C,D){
if(C<0){
C=D.length-1
}else{
if(C>=D.length){
C=0
}}
if(D[C]){
D[C].focus()
}
return C
}
function W(S,M){
var C=-1,D=m();
M=M||f(D.getEl());
for(var F=0;
F<M.length;
F++){
if(M[F]===h){
C=F
}}
C+=S;
if(!D.settings.wrapFocus&&(C<0||C>=M.length)){
return false
}
D.lastAriaIndex=y(C,M);
return true
}
function u(){
var C=B();
if(C=="tablist"){
W(-1,f(h.parentNode))
}else{
if(p.parent().submenu){
d()
}else{
W(-1)
}}}
function A(){
var D=w(),C=B();
if(C=="tablist"){
W(1,f(h.parentNode))
}else{
if(D=="menuitem"&&C=="menu"&&k("haspopup")){
z()
}else{
W(1)
}}}
function g(){
W(-1)
}
function b(){
var D=w(),C=B();
if(D=="menuitem"&&C=="menubar"){
z()
}else{
if(D=="button"&&k("haspopup")){
z({
key:"down"}
)
}else{
W(1)
}}}
function c(F){
var S=B();
if(S=="tablist"){
var M=f(p.getEl("body"))[0];
if(M){
M.focus()
}
return true
}else{
var D=m(),C=D&&D.settings.ignoreTab;
return !C?W(F.shiftKey?-1:1):false
}}
function d(){
return p.fire("cancel")
}
function z(C){
C=C||{};
p.fire("click",{
target:h,aria:C}
)
}
q.on("keydown",function(S){
function D(M,F){
if(v(h)){
return
}
if(F(M)!==false){
M.preventDefault()
}}
if(S.isDefaultPrevented()){
return
}
switch(S.keyCode){
case 37:D(S,u);
break;
case 39:D(S,A);
break;
case 38:D(S,g);
break;
case 40:D(S,b);
break;
case 27:var C=d();
if(C.isDefaultPrevented()){
S.preventDefault();
S.stopPropagation()
}
if(C.isPropagationStopped()){
S.stopPropagation()
}
break;
case 14:case 13:case 32:D(S,z);
break;
case 9:if(c(S)!==false){
S.preventDefault();
S.stopPropagation()
}
break
}}
);
q.on("focusin",function(C){
h=C.target;
p=C.control
}
);
return{
focusFirst:j}
}
}
);
r("tinymce/ui/Container",["tinymce/ui/Control","tinymce/ui/Collection","tinymce/ui/Selector","tinymce/ui/Factory","tinymce/ui/KeyboardNavigation","tinymce/util/Tools","tinymce/dom/DomQuery","tinymce/ui/ClassList","tinymce/ui/ReflowQueue"],function(l,m,h,c,g,d,p,u,y){var f={};
return l.extend({
init:function(w){
var b=this;
b._super(w);
w=b.settings;
if(w.fixed){
b.state.set("fixed",true)
}
b._items=new m();
if(b.isRtl()){
b.classes.add("rtl")
}
b.bodyClasses=new u(function(){
if(b.state.get("rendered")){
b.getEl("body").className=this.toString()
}}
);
b.bodyClasses.prefix=b.classPrefix;
b.classes.add("container");
b.bodyClasses.add("container-body");
if(w.containerCls){
b.classes.add(w.containerCls)
}
b._layout=c.create((w.layout||"")+"layout");
if(b.settings.items){
b.add(b.settings.items)
}else{
b.add(b.render())
}
b._hasBody=true
}
,items:function(){
return this._items
}
,find:function(b){
b=f[b]=f[b]||new h(b);
return b.find(this)
}
,add:function(w){
var b=this;
b.items().add(b.create(w)).parent(b);
return b
}
,focus:function(b){
var v=this,x,k,w;
if(b){
k=v.keyboardNav||v.parents().eq(-1)[0].keyboardNav;
if(k){
k.focusFirst(v);
return
}}
w=v.find("*");
if(v.statusbar){
w.add(v.statusbar.items())
}
w.each(function(q){
if(q.settings.autofocus){
x=null;
return false
}
if(q.canFocus){
x=x||q
}}
);
if(x){
x.focus()
}
return v
}
,replace:function(x,k){
var v,b=this.items(),w=b.length;
while(w--){
if(b[w]===x){
b[w]=k;
break
}}
if(w>=0){
v=k.getEl();
if(v){
v.parentNode.removeChild(v)
}
v=x.getEl();
if(v){
v.parentNode.removeChild(v)
}}
k.parent(this)
}
,create:function(w){
var b=this,k,v=[];
if(!d.isArray(w)){
w=[w]
}
d.each(w,function(x){
if(x){
if(!(x instanceof l)){
if(typeof x=="string"){
x={
type:x}
}
k=d.extend({}
,b.settings.defaults,x);
x.type=k.type=k.type||x.type||b.settings.defaultType||(k.defaults?k.defaults.type:null);
x=c.create(k)
}
v.push(x)
}}
);
return v
}
,renderNew:function(){
var b=this;
b.items().each(function(v,w){
var k;
v.parent(b);
if(!v.state.get("rendered")){
k=b.getEl("body");
if(k.hasChildNodes()&&w<=k.childNodes.length-1){
p(k.childNodes[w]).before(v.renderHtml())
}else{
p(k).append(v.renderHtml())
}
v.postRender();
y.add(v)
}}
);
b._layout.applyClasses(b.items().filter(":visible"));
b._lastRect=null;
return b
}
,append:function(b){
return this.add(b).renderNew()
}
,prepend:function(w){
var b=this;
b.items().set(b.create(w).concat(b.items().toArray()));
return b.renderNew()
}
,insert:function(v,x,j){
var w=this,k,b,q;
v=w.create(v);
k=w.items();
if(!j&&x<k.length-1){
x+=1
}
if(x>=0&&x<k.length){
b=k.slice(0,x).toArray();
q=k.slice(x).toArray();
k.set(b.concat(v,q))
}
return w.renderNew()
}
,fromJSON:function(v){
var b=this;
for(var w in v){
b.find("#"+w).value(v[w])
}
return b
}
,toJSON:function(){
var b=this,w={};
b.find("*").each(function(x){
var v=x.name(),k=x.value();
if(v&&typeof k!="undefined"){
w[v]=k
}}
);
return w
}
,renderHtml:function(){
var b=this,w=b._layout,v=this.settings.role;
b.preRender();
w.preRender(b);
return('<div id="'+b._id+'" class="'+b.classes+'"'+(v?' role="'+this.settings.role+'"':"")+'><div id="'+b._id+'-body" class="'+b.bodyClasses+'">'+(b.settings.html||"")+w.renderHtml(b)+"</div></div>")
}
,postRender:function(){
var b=this,w;
b.items().exec("postRender");
b._super();
b._layout.postRender(b);
b.state.set("rendered",true);
if(b.settings.style){
b.$el.css(b.settings.style)
}
if(b.settings.border){
w=b.borderBox;
b.$el.css({
"border-top-width":w.top,"border-right-width":w.right,"border-bottom-width":w.bottom,"border-left-width":w.left}
)
}
if(!b.parent()){
b.keyboardNav=new g({
root:b}
)
}
return b
}
,initLayoutRect:function(){
var b=this,w=b._super();
b._layout.recalc(b);
return w
}
,recalc:function(){
var b=this,v=b._layoutRect,w=b._lastRect;
if(!w||w.w!=v.w||w.h!=v.h){
b._layout.recalc(b);
v=b.layoutRect();
b._lastRect={
x:v.x,y:v.y,w:v.w,h:v.h};
return true
}}
,reflow:function(){
var b;
y.remove(this);
if(this.visible()){
l.repaintControls=[];
l.repaintControls.map={};
this.recalc();
b=l.repaintControls.length;
while(b--){
l.repaintControls[b].repaint()
}
if(this.settings.layout!=="flow"&&this.settings.layout!=="stack"){
this.repaint()
}
l.repaintControls=[]
}
return this
}}
)
}
);
r("tinymce/ui/DragHelper",["tinymce/dom/DomQuery"],function(h){function c(b){
var w,f,u,y;
var p,v,m,d,g=Math.max;
w=b.documentElement;
f=b.body;
u=g(w.scrollWidth,f.scrollWidth);
y=g(w.clientWidth,f.clientWidth);
p=g(w.offsetWidth,f.offsetWidth);
v=g(w.scrollHeight,f.scrollHeight);
m=g(w.clientHeight,f.clientHeight);
d=g(w.offsetHeight,f.offsetHeight);
return{
width:u<p?y:u,height:v<d?m:v}
}
function l(m){
var u,d;
if(m.changedTouches){
u="screenX screenY pageX pageY clientX clientY".split(" ");
for(d=0;
d<u.length;
d++){
m[u[d]]=m.changedTouches[0][u[d]]
}}}
return function(u,f){
var w,k=f.document||document,d,m,v,y,g,p;
f=f||{};
function b(){
return k.getElementById(f.handle||u)
}
m=function(q){
var z=c(k),x,j;
l(q);
q.preventDefault();
d=q.button;
x=b();
g=q.screenX;
p=q.screenY;
if(window.getComputedStyle){
j=window.getComputedStyle(x,null).getPropertyValue("cursor")
}else{
j=x.runtimeStyle.cursor
}
w=h("<div>").css({
position:"absolute",top:0,left:0,width:z.width,height:z.height,zIndex:2147483647,opacity:0.0001,cursor:j}
).appendTo(k.body);
h(k).on("mousemove touchmove",y).on("mouseup touchend",v);
f.start(q)
};
y=function(x){
l(x);
if(x.button!==d){
return v(x)
}
x.deltaX=x.screenX-g;
x.deltaY=x.screenY-p;
x.preventDefault();
f.drag(x)
};
v=function(x){
l(x);
h(k).off("mousemove touchmove",y).off("mouseup touchend",v);
w.remove();
if(f.stop){
f.stop(x)
}};
this.destroy=function(){
h(b()).off()
};
h(b()).on("mousedown touchstart",m)
}
}
);
r("tinymce/ui/Scrollable",["tinymce/dom/DomQuery","tinymce/ui/DragHelper"],function(l,h){return{
init:function(){
var c=this;
c.on("repaint",c.renderScroll)
}
,renderScroll:function(){
var d=this,u=2;
function m(){
var y,g,p;
function f(x,k,j,B,W,v){
var q,O,T;
var w,b,z,A;
var C,D;
O=d.getEl("scroll"+x);
if(O){
C=k.toLowerCase();
D=j.toLowerCase();
l(d.getEl("absend")).css(C,d.layoutRect()[B]-1);
if(!W){
l(O).css("display","none");
return
}
l(O).css("display","block");
q=d.getEl("body");
T=d.getEl("scroll"+x+"t");
w=q["client"+j]-(u*2);
w-=y&&g?O["client"+v]:0;
b=q["scroll"+j];
z=w/b;
A={};
A[C]=q["offset"+k]+u;
A[D]=w;
l(O).css(A);
A={};
A[C]=q["scroll"+k]*z;
A[D]=w*z;
l(T).css(A)
}}
p=d.getEl("body");
y=p.scrollWidth>p.clientWidth;
g=p.scrollHeight>p.clientHeight;
f("h","Left","Width","contentW",y,"Height");
f("v","Top","Height","contentH",g,"Width")
}
function c(){
function f(k,y,p,x,w){
var v,g=d._id+"-scroll"+k,b=d.classPrefix;
l(d.getEl()).append('<div id="'+g+'" class="'+b+"scrollbar "+b+"scrollbar-"+k+'"><div id="'+g+'t" class="'+b+'scrollbar-thumb"></div></div>');
d.draghelper=new h(g+"t",{
start:function(){
v=d.getEl("body")["scroll"+y];
l("#"+g).addClass(b+"active")
}
,drag:function(T){
var q,A,z,O,j=d.layoutRect();
A=j.contentW>j.innerW;
z=j.contentH>j.innerH;
O=d.getEl("body")["client"+p]-(u*2);
O-=A&&z?d.getEl("scroll"+k)["client"+w]:0;
q=O/d.getEl("body")["scroll"+p];
d.getEl("body")["scroll"+y]=v+(T["delta"+x]/q)
}
,stop:function(){
l("#"+g).removeClass(b+"active")
}}
)
}
d.classes.add("scroll");
f("v","Top","Height","Y","Width");
f("h","Left","Width","X","Height")
}
if(d.settings.autoScroll){
if(!d._hasScroll){
d._hasScroll=true;
c();
d.on("wheel",function(p){
var f=d.getEl("body");
f.scrollLeft+=(p.deltaX||0)*10;
f.scrollTop+=p.deltaY*10;
m()
}
);
l(d.getEl("body")).on("scroll",m)
}
m()
}}}
}
);
r("tinymce/ui/Panel",["tinymce/ui/Container","tinymce/ui/Scrollable"],function(l,h){return l.extend({
Defaults:{
layout:"fit",containerCls:"panel"}
,Mixins:[h],renderHtml:function(){
var d=this,u=d._layout,c=d.settings.html;
d.preRender();
u.preRender(d);
if(typeof c=="undefined"){
c=('<div id="'+d._id+'-body" class="'+d.bodyClasses+'">'+u.renderHtml(d)+"</div>")
}else{
if(typeof c=="function"){
c=c.call(d)
}
d._hasBody=false
}
return('<div id="'+d._id+'" class="'+d.classes+'" hidefocus="1" tabindex="-1" role="group">'+(d._preBodyHtml||"")+c+"</div>")
}}
)
}
);
r("tinymce/ui/Movable",["tinymce/ui/DomUtils"],function(h){function l(c,w,q){
var k,f,b,p,v,u,g,d,m,j;
m=h.getViewPort();
f=h.getPos(w);
b=f.x;
p=f.y;
if(c.state.get("fixed")&&h.getRuntimeStyle(document.body,"position")=="static"){
b-=m.x;
p-=m.y
}
k=c.getEl();
j=h.getSize(k);
v=j.width;
u=j.height;
j=h.getSize(w);
g=j.width;
d=j.height;
q=(q||"").split("");
if(q[0]==="b"){
p+=d
}
if(q[1]==="r"){
b+=g
}
if(q[0]==="c"){
p+=Math.round(d/2)
}
if(q[1]==="c"){
b+=Math.round(g/2)
}
if(q[3]==="b"){
p-=u
}
if(q[4]==="r"){
b-=v
}
if(q[3]==="c"){
p-=Math.round(u/2)
}
if(q[4]==="c"){
b-=Math.round(v/2)
}
return{
x:b,y:p,w:v,h:u}
}
return{
testMoveRel:function(f,d){
var c=h.getViewPort();
for(var u=0;
u<d.length;
u++){
var m=l(this,f,d[u]);
if(this.state.get("fixed")){
if(m.x>0&&m.x+m.w<c.w&&m.y>0&&m.y+m.h<c.h){
return d[u]
}}else{
if(m.x>c.x&&m.x+m.w<c.w+c.x&&m.y>c.y&&m.y+m.h<c.h+c.y){
return d[u]
}}}
return d[0]
}
,moveRel:function(u,c){
if(typeof c!="string"){
c=this.testMoveRel(u,c)
}
var d=l(this,u,c);
return this.moveTo(d.x,d.y)
}
,moveBy:function(u,c){
var d=this,m=d.layoutRect();
d.moveTo(m.x+u,m.y+c);
return d
}
,moveTo:function(c,p){
var d=this;
function f(b,g,y){
if(b<0){
return 0
}
if(b+y>g){
b=g-y;
return b<0?0:b
}
return b
}
if(d.settings.constrainToViewport){
var u=h.getViewPort(window);
var m=d.layoutRect();
c=f(c,u.w+u.x,m.w);
p=f(p,u.h+u.y,m.h)
}
if(d.state.get("rendered")){
d.layoutRect({
x:c,y:p}
).repaint()
}else{
d.settings.x=c;
d.settings.y=p
}
d.fire("move",{
x:c,y:p}
);
return d
}}
}
);
r("tinymce/ui/Resizable",["tinymce/ui/DomUtils"],function(h){return{
resizeToContent:function(){
this._layoutRect.autoResize=true;
this._lastRect=null;
this.reflow()
}
,resizeTo:function(l,c){
if(l<=1||c<=1){
var d=h.getWindowSize();
l=l<=1?l*d.w:l;
c=c<=1?c*d.h:c
}
this._layoutRect.autoResize=false;
return this.layoutRect({
minW:l,minH:c,w:l,h:c}
).reflow()
}
,resizeBy:function(c,u){
var l=this,d=l.layoutRect();
return l.resizeTo(d.w+c,d.h+u)
}}
}
);
r("tinymce/ui/FloatPanel",["tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/DomUtils","tinymce/dom/DomQuery"],function(j,k,p,T,m){var u,v,g,c=[];
var h=[],f;
function x(W,A){
while(W){
if(W==A){
return true
}
W=W.parent()
}}
function y(C){
var B=c.length;
while(B--){
var W=c[B],A=W.getParentCtrl(C.target);
if(W.settings.autohide){
if(A){
if(x(A,W)||W.parent()===A){
continue
}}
C=W.fire("autohide",{
target:C.target}
);
if(!C.isDefaultPrevented()){
W.hide()
}}}}
function l(){
if(!u){
u=function(A){
if(A.button==2){
return
}
y(A)
};
m(document).on("click touchstart",u)
}}
function d(){
if(!v){
v=function(){
var A;
A=c.length;
while(A--){
b(c[A])
}};
m(window).on("scroll",v)
}}
function z(){
if(!g){
var W=document.documentElement,B=W.clientWidth,A=W.clientHeight;
g=function(){
if(!document.all||B!=W.clientWidth||A!=W.clientHeight){
B=W.clientWidth;
A=W.clientHeight;
q.hideAll()
}};
m(window).on("resize",g)
}}
function b(A){
var W=T.getViewPort().y;
function B(F,C){
var S;
for(var D=0;
D<c.length;
D++){
if(c[D]!=A){
S=c[D].parent();
while(S&&(S=S.parent())){
if(S==A){
c[D].fixed(F).moveBy(0,C).repaint()
}}}}}
if(A.settings.autofix){
if(!A.state.get("fixed")){
A._autoFixY=A.layoutRect().y;
if(A._autoFixY<W){
A.fixed(true).layoutRect({
y:0}
).repaint();
B(true,W-A._autoFixY)
}}else{
if(A._autoFixY>W){
A.fixed(false).layoutRect({
y:A._autoFixY}
).repaint();
B(false,A._autoFixY-W)
}}}}
function w(D,B){
var A,S=q.zIndex||65535,W;
if(D){
h.push(B)
}else{
A=h.length;
while(A--){
if(h[A]===B){
h.splice(A,1)
}}}
if(h.length){
for(A=0;
A<h.length;
A++){
if(h[A].modal){
S++;
W=h[A]
}
h[A].getEl().style.zIndex=S;
h[A].zIndex=S;
S++
}}
var C=document.getElementById(B.classPrefix+"modal-block");
if(W){
m(C).css("z-index",W.zIndex-1)
}else{
if(C){
C.parentNode.removeChild(C);
f=false
}}
q.currentZIndex=S
}
var q=j.extend({
Mixins:[k,p],Defaults:{
wrapFocus:true}
,init:function(W){
var A=this;
A._super(W);
A._eventsRoot=A;
A.classes.add("floatpanel");
if(W.autohide){
l();
z();
c.push(A)
}
if(W.autofix){
d();
A.on("move",function(){
b(this)
}
)
}
A.on("postrender show",function(D){
if(D.control==A){
var C,B=A.classPrefix;
if(A.modal&&!f){
C=m("#"+B+"modal-block");
if(!C[0]){
C=m('<div id="'+B+'modal-block" class="'+B+"reset "+B+'fade"></div>').appendTo(A.getContainerElm())
}
setTimeout(function(){
C.addClass(B+"in");
m(A.getEl()).addClass(B+"in")
}
,0);
f=true
}
w(true,A)
}}
);
A.on("show",function(){
A.parents().each(function(B){
if(B.state.get("fixed")){
A.fixed(true);
return false
}}
)
}
);
if(W.popover){
A._preBodyHtml='<div class="'+A.classPrefix+'arrow"></div>';
A.classes.add("popover").add("bottom").add(A.isRtl()?"end":"start")
}}
,fixed:function(B){
var W=this;
if(W.state.get("fixed")!=B){
if(W.state.get("rendered")){
var A=T.getViewPort();
if(B){
W.layoutRect().y-=A.y
}else{
W.layoutRect().y+=A.y
}}
W.classes.toggle("fixed",B);
W.state.set("fixed",B)
}
return W
}
,show:function(){
var A=this,W,B=A._super();
W=c.length;
while(W--){
if(c[W]===A){
break
}}
if(W===-1){
c.push(A)
}
return B
}
,hide:function(){
O(this);
w(false,this);
return this._super()
}
,hideAll:function(){
q.hideAll()
}
,close:function(){
var A=this;
if(!A.fire("close").isDefaultPrevented()){
A.remove();
w(false,A)
}
return A
}
,remove:function(){
O(this);
this._super()
}
,postRender:function(){
var A=this;
if(A.settings.bodyRole){
this.getEl("body").setAttribute("role",A.settings.bodyRole)
}
return A._super()
}}
);
q.hideAll=function(){
var W=c.length;
while(W--){
var A=c[W];
if(A&&A.settings.autohide){
A.hide();
c.splice(W,1)
}}};
function O(A){
var W;
W=c.length;
while(W--){
if(c[W]===A){
c.splice(W,1)
}}
W=h.length;
while(W--){
if(h[W]===A){
h.splice(W,1)
}}}
return q
}
);
r("tinymce/ui/Window",["tinymce/ui/FloatPanel","tinymce/ui/Panel","tinymce/ui/DomUtils","tinymce/dom/DomQuery","tinymce/ui/DragHelper","tinymce/ui/BoxUtils","tinymce/Env"],function(f,y,h,u,l,v,p){var b=[],m="";
function c(j){
var q="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0",k=u("meta[name=viewport]")[0],x;
if(p.overrideViewPort===false){
return
}
if(!k){
k=document.createElement("meta");
k.setAttribute("name","viewport");
document.getElementsByTagName("head")[0].appendChild(k)
}
x=k.getAttribute("content");
if(x&&typeof m!="undefined"){
m=x
}
k.setAttribute("content",j?q:m)
}
function g(k){
for(var x=0;
x<b.length;
x++){
if(b[x]._fullscreen){
return
}}
u([document.documentElement,document.body]).removeClass(k+"fullscreen")
}
function d(){
var x={
w:window.innerWidth,h:window.innerHeight};
window.setInterval(function(){
var q=window.innerWidth,j=window.innerHeight;
if(x.w!=q||x.h!=j){
x={
w:q,h:j};
u(window).trigger("resize")
}}
,0);
function k(){
var q,z=h.getWindowSize(),j;
for(q=0;
q<b.length;
q++){
j=b[q].layoutRect();
b[q].moveTo(b[q].settings.x||Math.max(0,z.w/2-j.w/2),b[q].settings.y||Math.max(0,z.h/2-j.h/2))
}}
u(window).on("resize",k)
}
var w=f.extend({
modal:true,Defaults:{
border:1,layout:"flex",containerCls:"panel",role:"dialog",ariaRoot:true,callbacks:{
submit:function(){
this.fire("submit",{
data:this.toJSON()}
)
}
,close:function(){
this.close()
}}}
,init:function(x){
var k=this;
k._super(x);
if(k.isRtl()){
k.classes.add("rtl")
}
k.classes.add("window");
k.bodyClasses.add("window-body");
k.state.set("fixed",true);
if(x.buttons){
k.statusbar=new y({
layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:k.isRtl()?"start":"end",defaults:{
type:"button"}
,items:x.buttons}
);
k.statusbar.classes.add("foot");
k.statusbar.parent(k)
}
k.on("click",function(q){
if(q.target.className.indexOf(k.classPrefix+"close")!=-1){
k.close()
}}
);
k.on("cancel",function(q){
q.preventDefault();
q.stopPropagation();
k.close()
}
);
k.aria("describedby",k.describedBy||k._id+"-title");
k.aria("label",x.title);
k._fullscreen=false
}
,recalc:function(){
var q=this,T=q.statusbar,z,j,k,O;
if(q._fullscreen){
q.layoutRect(h.getWindowSize());
q.layoutRect().contentH=q.layoutRect().innerH
}
q._super();
z=q.layoutRect();
if(q.settings.title&&!q._fullscreen){
j=z.headerW;
if(j>z.w){
k=z.x-Math.max(0,j/2);
q.layoutRect({
w:j,x:k}
);
O=true
}}
if(T){
T.layoutRect({
w:q.layoutRect().innerW}
).recalc();
j=T.layoutRect().minW+z.deltaW;
if(j>z.w){
k=z.x-Math.max(0,j-z.w);
q.layoutRect({
w:j,x:k}
);
O=true
}}
if(O){
q.recalc()
}}
,initLayoutRect:function(){
var k=this,z=k._super(),j=0,T;
if(k.settings.title&&!k._fullscreen){
T=k.getEl("head");
var x=h.getSize(T);
z.headerW=x.width;
z.headerH=x.height;
j+=z.headerH
}
if(k.statusbar){
j+=k.statusbar.layoutRect().h
}
z.deltaH+=j;
z.minH+=j;
z.h+=j;
var q=h.getWindowSize();
z.x=k.settings.x||Math.max(0,q.w/2-z.w/2);
z.y=k.settings.y||Math.max(0,q.h/2-z.h/2);
return z
}
,renderHtml:function(){
var x=this,z=x._layout,A=x._id,T=x.classPrefix;
var j=x.settings,k="",O="",q=j.html;
x.preRender();
z.preRender(x);
if(j.title){
k=('<div id="'+A+'-head" class="'+T+'window-head"><div id="'+A+'-title" class="'+T+'title">'+x.encode(j.title)+'</div><button type="button" class="'+T+'close" aria-hidden="true">\u00d7</button><div id="'+A+'-dragh" class="'+T+'dragh"></div></div>')
}
if(j.url){
q='<iframe src="'+j.url+'" tabindex="-1"></iframe>'
}
if(typeof q=="undefined"){
q=z.renderHtml(x)
}
if(x.statusbar){
O=x.statusbar.renderHtml()
}
return('<div id="'+A+'" class="'+x.classes+'" hidefocus="1"><div class="'+x.classPrefix+'reset" role="application">'+k+'<div id="'+A+'-body" class="'+x.bodyClasses+'">'+q+"</div>"+O+"</div></div>")
}
,fullscreen:function(O){
var k=this,T=document.documentElement,x,z=k.classPrefix,j;
if(O!=k._fullscreen){
u(window).on("resize",function(){
var W;
if(k._fullscreen){
if(!x){
W=new Date().getTime();
var A=h.getWindowSize();
k.moveTo(0,0).resizeTo(A.w,A.h);
if((new Date().getTime())-W>50){
x=true
}}else{
if(!k._timer){
k._timer=setTimeout(function(){
var B=h.getWindowSize();
k.moveTo(0,0).resizeTo(B.w,B.h);
k._timer=0
}
,50)
}}}}
);
j=k.layoutRect();
k._fullscreen=O;
if(!O){
k.borderBox=v.parseBox(k.settings.border);
k.getEl("head").style.display="";
j.deltaH+=j.headerH;
u([T,document.body]).removeClass(z+"fullscreen");
k.classes.remove("fullscreen");
k.moveTo(k._initial.x,k._initial.y).resizeTo(k._initial.w,k._initial.h)
}else{
k._initial={
x:j.x,y:j.y,w:j.w,h:j.h};
k.borderBox=v.parseBox("0");
k.getEl("head").style.display="none";
j.deltaH-=j.headerH+2;
u([T,document.body]).addClass(z+"fullscreen");
k.classes.add("fullscreen");
var q=h.getWindowSize();
k.moveTo(0,0).resizeTo(q.w,q.h)
}}
return k.reflow()
}
,postRender:function(){
var k=this,x;
setTimeout(function(){
k.classes.add("in")
}
,0);
k._super();
if(k.statusbar){
k.statusbar.postRender()
}
k.focus();
this.dragHelper=new l(k._id+"-dragh",{
start:function(){
x={
x:k.layoutRect().x,y:k.layoutRect().y}
}
,drag:function(q){
k.moveTo(x.x+q.deltaX,x.y+q.deltaY)
}}
);
k.on("submit",function(q){
if(!q.isDefaultPrevented()){
k.close()
}}
);
b.push(k);
c(true)
}
,submit:function(){
return this.fire("submit",{
data:this.toJSON()}
)
}
,remove:function(){
var k=this,x;
k.dragHelper.destroy();
k._super();
if(k.statusbar){
this.statusbar.remove()
}
x=b.length;
while(x--){
if(b[x]===k){
b.splice(x,1)
}}
c(b.length>0);
g(k.classPrefix)
}
,getContentWindow:function(){
var k=this.getEl().getElementsByTagName("iframe")[0];
return k?k.contentWindow:null
}}
);
if(!p.desktop){
d()
}
return w
}
);
r("tinymce/ui/MessageBox",["tinymce/ui/Window"],function(l){var h=l.extend({
init:function(c){
c={
border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:true,buttons:{
type:"button",text:"Ok",action:"ok"}
,items:{
type:"label",multiline:true,maxWidth:500,maxHeight:200}};
this._super(c)
}
,Statics:{
OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(d){
var u,m=d.callback||function(){};
function c(g,f,p){
return{
type:"button",text:g,subtype:p?"primary":"",onClick:function(y){
y.control.parents()[1].close();
m(f)
}}
}
switch(d.buttons){
case h.OK_CANCEL:u=[c("Ok",true,true),c("Cancel",false)];
break;
case h.YES_NO:case h.YES_NO_CANCEL:u=[c("Yes",1,true),c("No",0)];
if(d.buttons==h.YES_NO_CANCEL){
u.push(c("Cancel",-1))
}
break;
default:u=[c("Ok",true,true)];
break
}
return new l({
padding:20,x:d.x,y:d.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:u,title:d.title,role:"alertdialog",items:{
type:"label",multiline:true,maxWidth:500,maxHeight:200,text:d.text}
,onPostRender:function(){
this.aria("describedby",this.items()[0]._id)
}
,onClose:d.onClose,onCancel:function(){
m(false)
}}
).renderTo(document.body).reflow()
}
,alert:function(c,d){
if(typeof c=="string"){
c={
text:c}
}
c.callback=d;
return h.msgBox(c)
}
,confirm:function(c,d){
if(typeof c=="string"){
c={
text:c}
}
c.callback=d;
c.buttons=h.OK_CANCEL;
return h.msgBox(c)
}}}
);
return h
}
);
r("tinymce/WindowManager",["tinymce/ui/Window","tinymce/ui/MessageBox"],function(l,h){
return function(u){
var d=this,m=[];
function c(){
if(m.length){
return m[m.length-1]
}}
d.windows=m;
u.on("remove",function(){
var f=m.length;
while(f--){
m[f].close()
}}
);
d.open=function(f,g){
var p;
u.editorManager.setActive(u);
f.title=f.title||" ";
f.url=f.url||f.file;
if(f.url){
f.width=parseInt(f.width||320,10);
f.height=parseInt(f.height||240,10)
}
if(f.body){
f.items={
defaults:f.defaults,type:f.bodyType||"form",items:f.body}
}
if(!f.url&&!f.buttons){
f.buttons=[{
text:"Ok",subtype:"primary",onclick:function(){
p.find("form")[0].submit()
}}
,{
text:"Cancel",onclick:function(){
p.close()
}}
]
}
p=new l(f);
m.push(p);
p.on("close",function(){
var y=m.length;
while(y--){
if(m[y]===p){
m.splice(y,1)
}}
if(!m.length){
u.focus()
}}
);
if(f.data){
p.on("postRender",function(){
this.find("*").each(function(b){
var y=b.name();
if(y in f.data){
b.value(f.data[y])
}}
)
}
)
}
p.features=f||{};
p.params=g||{};
if(m.length===1){
u.nodeChanged()
}
return p.renderTo().reflow()
};
d.alert=function(p,g,f){
h.alert(p,function(){
if(g){
g.call(f||this)
}else{
u.focus()
}}
)
};
d.confirm=function(p,g,f){
h.confirm(p,function(y){
g.call(f||this,y)
}
)
};
d.close=function(){
if(c()){
c().close()
}};
d.getParams=function(){
return c()?c().params:null
};
d.setParams=function(f){
if(c()){
c().params=f
}};
d.getWindows=function(){
return m
}
}
}
);
r("tinymce/util/Quirks",["tinymce/util/VK","tinymce/dom/RangeUtils","tinymce/dom/TreeWalker","tinymce/html/Node","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools"],function(m,u,d,c,f,h,l){
return function(p){
var _r=l.each,J=p.$;
var y=m.BACKSPACE,W=m.DELETE,g=p.dom,C=p.selection,_d=p.settings,U=p.parser,M=p.serializer;
var w=h.gecko,O=h.ie,_o=h.webkit;
var X="data:text/mce-internal,";
var b=O?"Text":"URL";
function Z(_y,_g){
try{
p.getDoc().execCommand(_y,false,_g)
}
catch(_p){}}
function S(){
var _p=p.getDoc().documentMode;
return _p?_p:6
}
function V(_p){
return _p.isDefaultPrevented()
}
function E(_g){
var _p,_y;
if(_g.dataTransfer){
if(p.selection.isCollapsed()&&_g.target.tagName=="IMG"){
C.select(_g.target)
}
_p=p.selection.getContent();
if(_p.length>0){
_y=X+escape(p.id)+","+escape(_p);
_g.dataTransfer.setData(b,_y)
}}}
function F(_p){
var _g;
if(_p.dataTransfer){
_g=_p.dataTransfer.getData(b);
if(_g&&_g.indexOf(X)>=0){
_g=_g.substr(X.length).split(",");
return{
id:unescape(_g[0]),html:unescape(_g[1])}
}}
return null
}
function G(_p){
if(p.queryCommandSupported("mceInsertClipboardContent")){
p.execCommand("mceInsertClipboardContent",false,{
content:_p}
)
}else{
p.execCommand("mceInsertContent",false,_p)
}}
function _m(){
var _T=p.getDoc(),_v=p.dom,_O=p.selection;
var _g=window.MutationObserver,_k,_z;
if(!_g){
_k=true;
_g=function(){
var _A=[],_C;
function _B(_S){
var _D=_S.relatedNode||_S.target;
_A.push({
target:_D,addedNodes:[_D]}
)
}
function _W(_S){
var _D=_S.relatedNode||_S.target;
_A.push({
target:_D,attributeName:_S.attrName}
)
}
this.observe=function(_D){
_C=_D;
_C.addEventListener("DOMSubtreeModified",_B,false);
_C.addEventListener("DOMNodeInsertedIntoDocument",_B,false);
_C.addEventListener("DOMNodeInserted",_B,false);
_C.addEventListener("DOMAttrModified",_W,false)
};
this.disconnect=function(){
_C.removeEventListener("DOMSubtreeModified",_B,false);
_C.removeEventListener("DOMNodeInsertedIntoDocument",_B,false);
_C.removeEventListener("DOMNodeInserted",_B,false);
_C.removeEventListener("DOMAttrModified",_W,false)
};
this.takeRecords=function(){
return _A
}
}
}
function _p(_B){
var _W=_v.schema.getBlockElements(),_A=p.getBody();
if(_B.nodeName!="BR"){
return false
}
for(_B=_B;
_B!=_A&&!_W[_B.nodeName];
_B=_B.parentNode){
if(_B.nextSibling){
return false
}}
return true
}
function _y(_W,_A){
var _B;
for(_B=_W.nextSibling;
_B&&_B!=_A;
_B=_B.nextSibling){
if(_B.nodeType==3&&J.trim(_B.data).length===0){
continue
}
if(_B!==_A){
return false
}}
return _B===_A
}
function _x(_C,_B,_W){
var _S,_D,_A;
_A=_v.schema.getNonEmptyElements();
_S=new d(_W||_C,_C);
while((_D=_S[_B?"next":"prev"]())){
if(_A[_D.nodeName]&&!_p(_D)){
return _D
}
if(_D.nodeType==3&&_D.data.length>0){
return _D
}}}
function _j(_W){
var _D,_B,_A,_C,_S;
if(_W.collapsed){
return
}
_D=_v.getParent(u.getNode(_W.startContainer,_W.startOffset),_v.isBlock);
_B=_v.getParent(u.getNode(_W.endContainer,_W.endOffset),_v.isBlock);
_S=p.schema.getTextBlockElements();
if(_D==_B){
return
}
if(!_S[_D.nodeName]||!_S[_B.nodeName]){
return
}
if(_v.getContentEditable(_D)==="false"||_v.getContentEditable(_B)==="false"){
return
}
_W.deleteContents();
_A=_x(_D,false);
_C=_x(_B,true);
if(!_v.isEmpty(_B)){
J(_D).append(_B.childNodes)
}
J(_B).remove();
if(_A){
if(_A.nodeType==1){
if(_A.nodeName=="BR"){
_W.setStartBefore(_A);
_W.setEndBefore(_A)
}else{
_W.setStartAfter(_A);
_W.setEndAfter(_A)
}}else{
_W.setStart(_A,_A.data.length);
_W.setEnd(_A,_A.data.length)
}}else{
if(_C){
if(_C.nodeType==1){
_W.setStartBefore(_C);
_W.setEndBefore(_C)
}else{
_W.setStart(_C,0);
_W.setEnd(_C,0)
}}}
_O.setRng(_W);
return true
}
function _w(_W,_F){
var _C,_S,_B,_D,_A,_M;
if(!_W.collapsed){
return _W
}
_A=_W.startContainer;
_M=_W.startOffset;
if(_A.nodeType==3){
if(_F){
if(_M<_A.data.length){
return _W
}}else{
if(_M>0){
return _W
}}}
_C=u.getNode(_W.startContainer,_W.startOffset);
_B=_v.getParent(_C,_v.isBlock);
_S=_x(p.getBody(),_F,_C);
_D=_v.getParent(_S,_v.isBlock);
if(!_C||!_S){
return _W
}
if(_D&&_B!=_D){
if(!_F){
if(!_y(_D,_B)){
return _W
}
if(_S.nodeType==1){
if(_S.nodeName=="BR"){
_W.setStartBefore(_S)
}else{
_W.setStartAfter(_S)
}}else{
_W.setStart(_S,_S.data.length)
}
if(_C.nodeType==1){
_W.setEnd(_C,0)
}else{
_W.setEndBefore(_C)
}}else{
if(!_y(_B,_D)){
return _W
}
if(_C.nodeType==1){
if(_C.nodeName=="BR"){
_W.setStartBefore(_C)
}else{
_W.setStartAfter(_C)
}}else{
_W.setStart(_C,_C.data.length)
}
if(_S.nodeType==1){
_W.setEnd(_S,0)
}else{
_W.setEndBefore(_S)
}}}
return _W
}
function _b(_W){
var _A=_O.getRng();
_A=_w(_A,_W);
if(_j(_A)){
return true
}}
function _q(_B){
var _W,_A,_C;
if(_b(_B)){
return
}
l.each(p.getBody().getElementsByTagName("*"),function(_D){
if(_D.tagName=="SPAN"){
_D.setAttribute("mce-data-marked",1)
}
if(!_D.hasAttribute("data-mce-style")&&_D.hasAttribute("style")){
p.dom.setAttrib(_D,"style",p.dom.getAttrib(_D,"style"))
}}
);
_W=new _g(function(){}
);
_W.observe(p.getDoc(),{
childList:true,attributes:true,subtree:true,attributeFilter:["style"]}
);
p.getDoc().execCommand(_B?"ForwardDelete":"Delete",false,null);
_A=p.selection.getRng();
_C=_A.startContainer.parentNode;
l.each(_W.takeRecords(),function(_D){
if(!_v.isChildOf(_D.target,p.getBody())){
return
}
if(_D.attributeName=="style"){
var _S=_D.target.getAttribute("data-mce-style");
if(_S){
_D.target.setAttribute("style",_S)
}else{
_D.target.removeAttribute("style")
}}
l.each(_D.addedNodes,function(_M){
if(_M.nodeName=="SPAN"&&!_M.getAttribute("mce-data-marked")){
var _R,_F;
if(_M==_C){
_R=_A.startOffset;
_F=_M.firstChild
}
_v.remove(_M,true);
if(_F){
_A.setStart(_F,_R);
_A.setEnd(_F,_R);
p.selection.setRng(_A)
}}}
)
}
);
_W.disconnect();
l.each(p.dom.select("span[mce-data-marked]"),function(_D){
_D.removeAttribute("mce-data-marked")
}
)
}
p.on("keydown",function(_D){
var _C=_D.keyCode==W,_A=_D.ctrlKey||_D.metaKey;
if(!V(_D)&&(_C||_D.keyCode==y)){
var _B=p.selection.getRng(),_W=_B.startContainer,_S=_B.startOffset;
if(_C&&_D.shiftKey){
return
}
if(!_A&&_B.collapsed&&_W.nodeType==3){
if(_C?_S<_W.data.length:_S>0){
return
}}
_D.preventDefault();
if(_A){
p.selection.getSel().modify("extend",_C?"forward":"backward",_D.metaKey?"lineboundary":"word")
}
_q(_C)
}}
);
p.on("keypress",function(_S){
if(!V(_S)&&!_O.isCollapsed()&&_S.charCode&&!m.metaKeyPressed(_S)){
var _A,_F,_D,_W,_B,_C;
_A=p.selection.getRng();
_C=String.fromCharCode(_S.charCode);
_S.preventDefault();
_F=J(_A.startContainer).parents().filter(function(_M,_R){
return !!p.schema.getTextInlineElements()[_R.nodeName]
}
);
_q(true);
_F=_F.filter(function(_M,_R){
return !J.contains(p.getBody(),_R)
}
);
if(_F.length){
_D=_v.createFragment();
_F.each(function(_M,_R){
_R=_R.cloneNode(false);
if(_D.hasChildNodes()){
_R.appendChild(_D.firstChild);
_D.appendChild(_R)
}else{
_B=_R;
_D.appendChild(_R)
}
_D.appendChild(_R)
}
);
_B.appendChild(p.getDoc().createTextNode(_C));
_W=_v.getParent(_A.startContainer,_v.isBlock);
if(_v.isEmpty(_W)){
J(_W).empty().append(_D)
}else{
_A.insertNode(_D)
}
_A.setStart(_B.firstChild,1);
_A.setEnd(_B.firstChild,1);
p.selection.setRng(_A)
}else{
p.selection.setContent(_C)
}}}
);
p.addCommand("Delete",function(){
_q()
}
);
p.addCommand("ForwardDelete",function(){
_q(true)
}
);
if(_k){
return
}
p.on("dragstart",function(_A){
_z=_O.getRng();
E(_A)
}
);
p.on("drop",function(_A){
if(!V(_A)){
var _W=F(_A);
if(_W){
_A.preventDefault();
window.setTimeout(function(){
var _B=u.getCaretRangeFromPoint(_A.x,_A.y,_T);
if(_z){
_O.setRng(_z);
_z=null
}
_q();
_O.setRng(_B);
G(_W.html)
}
,0)
}}}
);
p.on("cut",function(_A){
if(!V(_A)&&_A.clipboardData&&!p.selection.isCollapsed()){
_A.preventDefault();
_A.clipboardData.clearData();
_A.clipboardData.setData("text/html",p.selection.getContent());
_A.clipboardData.setData("text/plain",p.selection.getContent({
format:"text"}
));
window.setTimeout(function(){
_q(true)
}
,0)
}}
)
}
function Y(){
function _p(_b){
var _y=g.create("body");
var _w=_b.cloneContents();
_y.appendChild(_w);
return C.serializer.serialize(_y,{
format:"html"}
)
}
function _g(_y){
if(!_y.setStart){
if(_y.item){
return false
}
var _k=_y.duplicate();
_k.moveToElementText(p.getBody());
return u.compareRanges(_y,_k)
}
var _w=_p(_y);
var _v=g.createRng();
_v.selectNode(p.getBody());
var _b=_p(_v);
return _w===_b
}
p.on("keydown",function(_v){
var _w=_v.keyCode,_b,_y;
if(!V(_v)&&(_w==W||_w==y)){
_b=p.selection.isCollapsed();
_y=p.getBody();
if(_b&&!g.isEmpty(_y)){
return
}
if(!_b&&!_g(p.selection.getRng())){
return
}
_v.preventDefault();
p.setContent("");
if(_y.firstChild&&g.isBlock(_y.firstChild)){
p.selection.setCursorLocation(_y.firstChild,0)
}else{
p.selection.setCursorLocation(_y,0)
}
p.nodeChanged()
}}
)
}
function _u(){
p.shortcuts.add("meta+a",null,"SelectAll")
}
function _f(){
if(!p.settings.content_editable){
g.bind(p.getDoc(),"focusin",function(){
C.setRng(C.getRng())
}
);
g.bind(p.getDoc(),"mousedown mouseup",function(_p){
if(_p.target==p.getDoc().documentElement){
p.getBody().focus();
if(_p.type=="mousedown"){
C.placeCaretAt(_p.clientX,_p.clientY)
}else{
C.setRng(C.getRng())
}}}
)
}}
function _t(){
p.on("keydown",function(_y){
if(!V(_y)&&_y.keyCode===y){
if(!p.getBody().getElementsByTagName("hr").length){
return
}
if(C.isCollapsed()&&C.getRng(true).startOffset===0){
var _g=C.getNode();
var _p=_g.previousSibling;
if(_g.nodeName=="HR"){
g.remove(_g);
_y.preventDefault();
return
}
if(_p&&_p.nodeName&&_p.nodeName.toLowerCase()==="hr"){
g.remove(_p);
_y.preventDefault()
}}}}
)
}
function Q(){
if(!window.Range.prototype.getClientRects){
p.on("mousedown",function(_g){
if(!V(_g)&&_g.target.nodeName==="HTML"){
var _p=p.getBody();
_p.blur();
setTimeout(function(){
_p.focus()
}
,0)
}}
)
}}
function x(){
p.on("click",function(_g){
var _p=_g.target;
if(/^(IMG|HR)$/.test(_p.nodeName)){
_g.preventDefault();
C.getSel().setBaseAndExtent(_p,0,_p,1);
p.nodeChanged()
}
if(_p.nodeName=="A"&&g.hasClass(_p,"mce-item-anchor")){
_g.preventDefault();
C.select(_p)
}}
)
}
function _h(){
function _g(){
var _y=g.getAttribs(C.getStart().cloneNode(false));
return function(){
var _b=C.getStart();
if(_b!==p.getBody()){
g.setAttrib(_b,"style",null);
_r(_y,function(_w){
_b.setAttributeNode(_w.cloneNode(true))
}
)
}}
}
function _p(){
return !C.isCollapsed()&&g.getParent(C.getStart(),g.isBlock)!=g.getParent(C.getEnd(),g.isBlock)
}
p.on("keypress",function(_b){
var _y;
if(!V(_b)&&(_b.keyCode==8||_b.keyCode==46)&&_p()){
_y=_g();
p.getDoc().execCommand("delete",false,null);
_y();
_b.preventDefault();
return false
}}
);
g.bind(p.getDoc(),"cut",function(_b){
var _y;
if(!V(_b)&&_p()){
_y=_g();
setTimeout(function(){
_y()
}
,0)
}}
)
}
function K(){
document.body.setAttribute("role","application")
}
function P(){
p.on("keydown",function(_g){
if(!V(_g)&&_g.keyCode===y){
if(C.isCollapsed()&&C.getRng(true).startOffset===0){
var _p=C.getNode().previousSibling;
if(_p&&_p.nodeName&&_p.nodeName.toLowerCase()==="table"){
_g.preventDefault();
return false
}}}}
)
}
function _n(){
if(S()>7){
return
}
Z("RespectVisibilityInDesign",true);
p.contentStyles.push(".mceHideBrInPre pre br {display: none}");
g.addClass(p.getBody(),"mceHideBrInPre");
U.addNodeFilter("pre",function(_p){
var _y=_p.length,_w,_g,_v,_b;
while(_y--){
_w=_p[_y].getAll("br");
_g=_w.length;
while(_g--){
_v=_w[_g];
_b=_v.prev;
if(_b&&_b.type===3&&_b.value.charAt(_b.value-1)!="\n"){
_b.value+="\n"
}else{
_v.parent.insert(new c("#text",3),_v,true).value="\n"
}}}}
);
M.addNodeFilter("pre",function(_p){
var _y=_p.length,_w,_g,_v,_b;
while(_y--){
_w=_p[_y].getAll("br");
_g=_w.length;
while(_g--){
_v=_w[_g];
_b=_v.prev;
if(_b&&_b.type==3){
_b.value=_b.value.replace(/\r?\n$/,"")
}}}}
)
}
function k(){
g.bind(p.getBody(),"mouseup",function(){
var _g,_p=C.getNode();
if(_p.nodeName=="IMG"){
if((_g=g.getStyle(_p,"width"))){
g.setAttrib(_p,"width",_g.replace(/[^0-9%]+/g,""));
g.setStyle(_p,"width","")
}
if((_g=g.getStyle(_p,"height"))){
g.setAttrib(_p,"height",_g.replace(/[^0-9%]+/g,""));
g.setStyle(_p,"height","")
}}}
)
}
function _c(){
p.on("keydown",function(_w){
var _y,_g,_v,_p,_b;
if(V(_w)||_w.keyCode!=m.BACKSPACE){
return
}
_y=C.getRng();
_g=_y.startContainer;
_v=_y.startOffset;
_p=g.getRoot();
_b=_g;
if(!_y.collapsed||_v!==0){
return
}
while(_b&&_b.parentNode&&_b.parentNode.firstChild==_b&&_b.parentNode!=_p){
_b=_b.parentNode
}
if(_b.tagName==="BLOCKQUOTE"){
p.formatter.toggle("blockquote",null,_b);
_y=g.createRng();
_y.setStart(_g,0);
_y.setEnd(_g,0);
C.setRng(_y)
}}
)
}
function _l(){
function _p(){
p._refreshContentEditable();
Z("StyleWithCSS",false);
Z("enableInlineTableEditing",false);
if(!_d.object_resizing){
Z("enableObjectResizing",false)
}}
if(!_d.readonly){
p.on("BeforeExecCommand MouseDown",_p)
}}
function N(){
function _p(){
_r(g.select("a"),function(_b){
var _g=_b.parentNode,_y=g.getRoot();
if(_g.lastChild===_b){
while(_g&&!g.isBlock(_g)){
if(_g.parentNode.lastChild!==_g||_g===_y){
return
}
_g=_g.parentNode
}
g.add(_g,"br",{
"data-mce-bogus":1}
)
}}
)
}
p.on("SetContent ExecCommand",function(_g){
if(_g.type=="setcontent"||_g.command==="mceInsertLink"){
_p()
}}
)
}
function D(){
if(_d.forced_root_block){
p.on("init",function(){
Z("DefaultParagraphSeparator",_d.forced_root_block)
}
)
}}
function H(){
p.on("Undo Redo SetContent",function(_p){
if(!_p.initial){
p.execCommand("mceRepaint")
}}
)
}
function q(){
p.on("keydown",function(_g){
var _p;
if(!V(_g)&&_g.keyCode==y){
_p=p.getDoc().selection.createRange();
if(_p&&_p.item){
_g.preventDefault();
p.undoManager.beforeChange();
g.remove(_p.item(0));
p.undoManager.add()
}}}
)
}
function L(){
var _p;
if(S()>=10){
_p="";
_r("p div h1 h2 h3 h4 h5 h6".split(" "),function(_g,_y){
_p+=(_y>0?",":"")+_g+":empty"
}
);
p.contentStyles.push(_p+"{padding-right: 1px !important}")
}}
function _s(){
if(S()<9){
U.addNodeFilter("noscript",function(_p){
var _g=_p.length,_y,_b;
while(_g--){
_y=_p[_g];
_b=_y.firstChild;
if(_b){
_y.attr("data-mce-innertext",_b.value)
}}}
);
M.addNodeFilter("noscript",function(_p){
var _g=_p.length,_y,_w,_b;
while(_g--){
_y=_p[_g];
_w=_p[_g].firstChild;
if(_w){
_w.value=f.decode(_w.value)
}else{
_b=_y.attributes.map["data-mce-innertext"];
if(_b){
_y.attr("data-mce-innertext",null);
_w=new c("#text",3);
_w.value=_b;
_w.raw=true;
_y.append(_w)
}}}}
)
}}
function I(){
var _k=g.doc,_g=_k.body,_b,_w,_x;
function _v(_q,_T){
var _j=_g.createTextRange();
try{
_j.moveToPoint(_q,_T)
}
catch(_z){
_j=null
}
return _j
}
function _y(_j){
var _q;
if(_j.button){
_q=_v(_j.x,_j.y);
if(_q){
if(_q.compareEndPoints("StartToStart",_w)>0){
_q.setEndPoint("StartToStart",_w)
}else{
_q.setEndPoint("EndToEnd",_w)
}
_q.select()
}}else{
_p()
}}
function _p(){
var _q=_k.selection.createRange();
if(_w&&!_q.item&&_q.compareEndPoints("StartToEnd",_q)===0){
_w.select()
}
g.unbind(_k,"mouseup",_p);
g.unbind(_k,"mousemove",_y);
_w=_b=0
}
_k.documentElement.unselectable=true;
g.bind(_k,"mousedown contextmenu",function(_q){
if(_q.target.nodeName==="HTML"){
if(_b){
_p()
}
_x=_k.documentElement;
if(_x.scrollHeight>_x.clientHeight){
return
}
_b=1;
_w=_v(_q.x,_q.y);
if(_w){
g.bind(_k,"mouseup",_p);
g.bind(_k,"mousemove",_y);
g.getRoot().focus();
_w.select()
}}}
)
}
function _i(){
p.on("keyup focusin mouseup",function(_p){
if(_p.keyCode!=65||!m.metaKeyPressed(_p)){
C.normalize()
}}
,true)
}
function z(){
p.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")
}
function T(){
if(!p.inline){
p.on("keydown",function(){
if(document.activeElement==document.body){
p.getWin().focus()
}}
)
}}
function B(){
if(!p.inline){
p.contentStyles.push("body {min-height: 150px}");
p.on("click",function(_g){
var _p;
if(_g.target.nodeName=="HTML"){
if(h.ie>11){
p.getBody().focus();
return
}
_p=p.selection.getRng();
p.getBody().focus();
p.selection.setRng(_p);
p.selection.normalize();
p.nodeChanged()
}}
)
}}
function A(){
if(h.mac){
p.on("keydown",function(_p){
if(m.metaKeyPressed(_p)&&!_p.shiftKey&&(_p.keyCode==37||_p.keyCode==39)){
_p.preventDefault();
p.selection.getSel().modify("move",_p.keyCode==37?"backward":"forward","lineboundary")
}}
)
}}
function _e(){
Z("AutoUrlDetect",false)
}
function j(){
p.on("click",function(_p){
var _g=_p.target;
do{
if(_g.tagName==="A"){
_p.preventDefault();
return
}}
while((_g=_g.parentNode))
}
);
p.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")
}
function R(){
p.on("init",function(){
p.dom.bind(p.getBody(),"submit",function(_p){
_p.preventDefault()
}
)
}
)
}
function _a(){
U.addNodeFilter("br",function(_p){
var _g=_p.length;
while(_g--){
if(_p[_g].attr("class")=="Apple-interchange-newline"){
_p[_g].remove()
}}}
)
}
function v(){
p.on("dragstart",function(_p){
E(_p)
}
);
p.on("drop",function(_g){
if(!V(_g)){
var _y=F(_g);
if(_y&&_y.id!=p.id){
_g.preventDefault();
var _p=u.getCaretRangeFromPoint(_g.x,_g.y,p.getDoc());
C.setRng(_p);
G(_y.html)
}}}
)
}
_c();
Y();
_i();
if(_o){
_m();
_f();
x();
D();
R();
P();
_a();
if(h.iOS){
T();
B();
j()
}else{
_u()
}}
if(O&&h.ie<11){
_t();
K();
_n();
k();
q();
L();
_s();
I()
}
if(h.ie>=11){
B();
P()
}
if(h.ie){
_u();
_e();
v()
}
if(w){
_t();
Q();
_h();
_l();
N();
H();
z();
A();
P()
}}
}
);
r("tinymce/EditorObservable",["tinymce/util/Observable","tinymce/dom/DOMUtils","tinymce/util/Tools"],function(h,m,c){
var d=m.DOM,l;
function f(y,g){
if(g=="selectionchange"){
return y.getDoc()
}
if(!y.inline&&/^mouse|click|contextmenu|drop|dragover|dragend/.test(g)){
return y.getDoc().documentElement
}
if(y.settings.event_root){
if(!y.eventRoot){
y.eventRoot=d.select(y.settings.event_root)[0]
}
return y.eventRoot
}
return y.getBody()
}
function u(b,g){
var w=f(b,g),y;
if(!b.delegates){
b.delegates={}
}
if(b.delegates[g]){
return
}
if(b.settings.event_root){
if(!l){
l={};
b.editorManager.on("removeEditor",function(){
var v;
if(!b.editorManager.activeEditor){
if(l){
for(v in l){
b.dom.unbind(f(b,v))
}
l=null
}}}
)
}
if(l[g]){
return
}
y=function(j){
var q=j.target,x=b.editorManager.editors,k=x.length;
while(k--){
var v=x[k].getBody();
if(v===q||d.isChildOf(q,v)){
if(!x[k].hidden){
x[k].fire(g,j)
}}}};
l[g]=y;
d.bind(w,g,y)
}else{
y=function(v){
if(!b.hidden){
b.fire(g,v)
}};
d.bind(w,g,y);
b.delegates[g]=y
}}
var p={
bindPendingEventDelegates:function(){
var g=this;
c.each(g._pendingNativeEvents,function(y){
u(g,y)
}
)
}
,toggleNativeEvent:function(y,b){
var g=this;
if(g.settings.readonly){
return
}
if(y=="focus"||y=="blur"){
return
}
if(b){
if(g.initialized){
u(g,y)
}else{
if(!g._pendingNativeEvents){
g._pendingNativeEvents=[y]
}else{
g._pendingNativeEvents.push(y)
}}}else{
if(g.initialized){
g.dom.unbind(f(g,y),y,g.delegates[y]);
delete g.delegates[y]
}}}
,unbindAllNativeEvents:function(){
var g=this,y;
if(g.delegates){
for(y in g.delegates){
g.dom.unbind(f(g,y),y,g.delegates[y])
}
delete g.delegates
}
if(!g.inline){
g.getBody().onload=null;
g.dom.unbind(g.getWin());
g.dom.unbind(g.getDoc())
}
g.dom.unbind(g.getBody());
g.dom.unbind(g.getContainer())
}};
p=c.extend({}
,h,p);
return p
}
);
r("tinymce/Shortcuts",["tinymce/util/Tools","tinymce/Env"],function(c,l){
var m=c.each,u=c.explode;
var h={
f9:120,f10:121,f11:122};
var d=c.makeMap("alt,ctrl,shift,meta,access");
return function(y){
var g=this,f={};
function p(x,q,k,v){
var j,w,b;
b={
func:k,scope:v||y,desc:y.translate(q)};
m(u(x,"+"),function(z){
if(z in d){
b[z]=true
}else{
if(/^[0-9]{2,}$/.test(z)){
b.keyCode=parseInt(z,10)
}else{
b.charCode=z.charCodeAt(0);
b.keyCode=h[z]||z.toUpperCase().charCodeAt(0)
}}}
);
j=[b.keyCode];
for(w in d){
if(b[w]){
j.push(w)
}else{
b[w]=false
}}
b.id=j.join(",");
if(b.access){
b.alt=true;
if(l.mac){
b.ctrl=true
}else{
b.shift=true
}}
if(b.meta){
if(l.mac){
b.meta=true
}else{
b.ctrl=true;
b.meta=false
}}
return b
}
y.on("keyup keypress keydown",function(b){
if((b.altKey||b.ctrlKey||b.metaKey)&&!b.isDefaultPrevented()){
m(f,function(w){
if(w.ctrl!=b.ctrlKey||w.meta!=b.metaKey){
return
}
if(w.alt!=b.altKey||w.shift!=b.shiftKey){
return
}
if(b.keyCode==w.keyCode||(b.charCode&&b.charCode==w.charCode)){
b.preventDefault();
if(b.type=="keydown"){
w.func.call(w.scope)
}
return true
}}
)
}}
);
g.add=function(k,x,w,b){
var v;
v=w;
if(typeof w==="string"){
w=function(){
y.execCommand(v,false,null)
}
}else{
if(c.isArray(v)){
w=function(){
y.execCommand(v[0],v[1],v[2])
}
}}
m(u(k.toLowerCase()),function(j){
var q=p(j,x,w,b);
f[q.id]=q
}
);
return true
};
g.remove=function(w){
var b=p(w);
if(f[b.id]){
delete f[b.id];
return true
}
return false
}
}
}
);
r("tinymce/util/Promise",[],function(){
if(window.Promise){
return window.Promise
}
var h=f.immediateFn||(typeof setImmediate==="function"&&setImmediate)||function(b){
setTimeout(b,1)
};
function m(w,b){
return function(){
w.apply(b,arguments)
}
}
var l=Array.isArray||function(b){
return Object.prototype.toString.call(b)==="[object Array]"
};
function f(b){
if(typeof this!=="object"){
throw new TypeError("Promises must be constructed via new")
}
if(typeof b!=="function"){
throw new TypeError("not a function")
}
this._state=null;
this._value=null;
this._deferreds=[];
g(b,m(p,this),m(y,this))
}
function c(b){
var w=this;
if(this._state===null){
this._deferreds.push(b);
return
}
h(function(){
var v=w._state?b.onFulfilled:b.onRejected;
if(v===null){
(w._state?b.resolve:b.reject)(w._value);
return
}
var k;
try{
k=v(w._value)
}
catch(x){
b.reject(x);
return
}
b.resolve(k)
}
)
}
function p(w){
try{
if(w===this){
throw new TypeError("A promise cannot be resolved with itself.")
}
if(w&&(typeof w==="object"||typeof w==="function")){
var v=w.then;
if(typeof v==="function"){
g(m(v,w),m(p,this),m(y,this));
return
}}
this._state=true;
this._value=w;
d.call(this)
}
catch(b){
y.call(this,b)
}}
function y(b){
this._state=false;
this._value=b;
d.call(this)
}
function d(){
for(var w=0,b=this._deferreds.length;
w<b;
w++){
c.call(this,this._deferreds[w])
}
this._deferreds=null
}
function u(k,b,v,w){
this.onFulfilled=typeof k==="function"?k:null;
this.onRejected=typeof b==="function"?b:null;
this.resolve=v;
this.reject=w
}
function g(k,x,w){
var b=false;
try{
k(function(q){
if(b){
return
}
b=true;
x(q)
}
,function(q){
if(b){
return
}
b=true;
w(q)
}
)
}
catch(v){
if(b){
return
}
b=true;
w(v)
}}
f.prototype["catch"]=function(b){
return this.then(null,b)
};
f.prototype.then=function(v,b){
var w=this;
return new f(function(x,k){
c.call(w,new u(v,b,x,k))
}
)
};
f.all=function(){
var b=Array.prototype.slice.call(arguments.length===1&&l(arguments[0])?arguments[0]:arguments);
return new f(function(q,x){
if(b.length===0){
return q([])
}
var k=b.length;
function v(z,O){
try{
if(O&&(typeof O==="object"||typeof O==="function")){
var T=O.then;
if(typeof T==="function"){
T.call(O,function(A){
v(z,A)
}
,x);
return
}}
b[z]=O;
if(--k===0){
q(b)
}}
catch(j){
x(j)
}}
for(var w=0;
w<b.length;
w++){
v(w,b[w])
}}
)
};
f.resolve=function(b){
if(b&&typeof b==="object"&&b.constructor===f){
return b
}
return new f(function(w){
w(b)
}
)
};
f.reject=function(b){
return new f(function(v,w){
w(b)
}
)
};
f.race=function(b){
return new f(function(x,k){
for(var v=0,w=b.length;
v<w;
v++){
b[v].then(x,k)
}}
)
};
return f
}
);
r("tinymce/util/Fun",[],function(){
function h(l){
return function(){
return l
}
}
return{
constant:h}
}
);
r("tinymce/file/Uploader",["tinymce/util/Promise","tinymce/util/Tools","tinymce/util/Fun"],function(l,h,c){
return function(p){
var f={};
function y(b){
var v,w;
w={
"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"};
v=w[b.blob().type.toLowerCase()]||"dat";
return b.id()+"."+v
}
function g(w,b){
if(w){
return w.replace(/\/$/,"")+"/"+b.replace(/^\//,"")
}
return b
}
function d(b){
return{
id:b.id,blob:b.blob,base64:b.base64,filename:c.constant(y(b))}
}
function m(w,x,b){
var k,v;
k=new XMLHttpRequest();
k.open("POST",p.url);
k.withCredentials=p.credentials;
k.onload=function(){
var q;
if(k.status!=200){
b("HTTP Error: "+k.status);
return
}
q=JSON.parse(k.responseText);
if(!q||typeof q.location!="string"){
b("Invalid JSON: "+k.responseText);
return
}
x(g(p.basePath,q.location))
};
v=new FormData();
v.append("file",w.blob(),y(w));
k.send(v)
}
function u(v){
var w;
if(!p.url&&p.handler===m){
return new l(function(k){
k([])
}
)
}
function b(k){
return new l(function(q){
var x=p.handler;
x(d(k),function(j){
q({
url:j,blobInfo:k,status:true}
)
}
,function(j){
q({
url:"",blobInfo:k,status:false,error:j}
)
}
)
}
)
}
w=h.map(v,function(k){
var x,q=k.id();
if(f[q]){
return f[q]
}
x=b(k).then(function(j){
delete f[q];
return j
}
)["catch"](function(j){
delete f[q];
return j
}
);
f[q]=x;
return x
}
);
return l.all(w)
}
p=h.extend({
credentials:false,handler:m}
,p);
return{
upload:u}
}
}
);
r("tinymce/file/Conversions",["tinymce/util/Promise"],function(c){
function m(f){
return new c(function(p){
var g=new XMLHttpRequest();
g.open("GET",f,true);
g.responseType="blob";
g.onload=function(){
if(this.status==200){
p(this.response)
}};
g.send()
}
)
}
function u(p){
var f,g;
p=decodeURIComponent(p).split(",");
g=/data:([^;]+)/.exec(p[0]);
if(g){
f=g[1]
}
return{
type:f,data:p[1]}
}
function l(f){
return new c(function(y){
var w,p,g;
f=u(f);
try{
w=atob(f.data)
}
catch(b){
y(new Blob([]));
return
}
p=new Uint8Array(w.length);
for(g=0;
g<p.length;
g++){
p[g]=w.charCodeAt(g)
}
y(new Blob([p],{
type:f.type}
))
}
)
}
function d(f){
if(f.indexOf("blob:")===0){
return m(f)
}
if(f.indexOf("data:")===0){
return l(f)
}
return null
}
function h(f){
return new c(function(g){
var p=new FileReader();
p.onloadend=function(){
g(p.result)
};
p.readAsDataURL(f)
}
)
}
return{
uriToBlob:d,blobToDataUri:h,parseDataUri:u}
}
);
r("tinymce/file/ImageScanner",["tinymce/util/Promise","tinymce/util/Arr","tinymce/file/Conversions","tinymce/Env"],function(u,d,c,h){
var l=0;
return function(p){
var m={};
function f(w){
var g,b;
function y(k,q){
var v,x;
if(k.src.indexOf("blob:")===0){
x=p.getByUri(k.src);
if(x){
q({
image:k,blobInfo:x}
)
}
return
}
v=c.parseDataUri(k.src).data;
x=p.findFirst(function(j){
return j.base64()===v
}
);
if(x){
q({
image:k,blobInfo:x}
)
}else{
c.uriToBlob(k.src).then(function(j){
var z="blobid"+(l++),T=p.create(z,j,v);
p.add(T);
q({
image:k,blobInfo:T}
)
}
)
}}
g=d.filter(w.getElementsByTagName("img"),function(v){
var k=v.src;
if(!h.fileApi){
return false
}
if(v.hasAttribute("data-mce-bogus")){
return false
}
if(v.hasAttribute("data-mce-placeholder")){
return false
}
if(!k||k==h.transparentSrc){
return false
}
return k.indexOf("data:")===0||k.indexOf("blob:")===0
}
);
b=d.map(g,function(v){
var k;
if(m[v.src]){
return new u(function(x){
m[v.src].then(function(q){
x({
image:v,blobInfo:q.blobInfo}
)
}
)
}
)
}
k=new u(function(x){
y(v,x)
}
).then(function(x){
delete m[x.image.src];
return x
}
)["catch"](function(x){
delete m[v.src];
return x
}
);
m[v.src]=k;
return k
}
);
return u.all(b)
}
return{
findAll:f}
}
}
);
r("tinymce/file/BlobCache",["tinymce/util/Arr","tinymce/util/Fun"],function(h,l){
return function(){
var d=[],p=l.constant;
function f(v,w,b){
return{
id:p(v),blob:p(w),base64:p(b),blobUri:p(URL.createObjectURL(w))}
}
function g(b){
if(!u(b.id())){
d.push(b)
}}
function u(b){
return y(function(w){
return w.id()===b
}
)
}
function y(b){
return h.filter(d,b)[0]
}
function c(b){
return y(function(w){
return w.blobUri()==b
}
)
}
function m(){
h.each(d,function(b){
URL.revokeObjectURL(b.blobUri())
}
);
d=[]
}
return{
create:f,add:g,get:u,getByUri:c,findFirst:y,destroy:m}
}
}
);
r("tinymce/EditorUpload",["tinymce/util/Arr","tinymce/file/Uploader","tinymce/file/ImageScanner","tinymce/file/BlobCache"],function(l,d,h,c){
return function(k){
var f=new c(),w,j;
function m(z){
return function(T){
if(k.selection){
return z(T)
}
return[]
}
}
function x(A,O,T){
var z=0;
do{
z=A.indexOf(O,z);
if(z!==-1){
A=A.substring(0,z)+T+A.substr(z+O.length);
z+=T.length-O.length+1
}}
while(z!==-1);
return A
}
function p(T,O,z){
T=x(T,'src="'+O+'"','src="'+z+'"');
T=x(T,'data-mce-src="'+O+'"','data-mce-src="'+z+'"');
return T
}
function u(T,z){
l.each(k.undoManager.data,function(O){
O.content=p(O.content,T,z)
}
)
}
function b(z){
if(!w){
w=new d({
url:k.settings.images_upload_url,basePath:k.settings.images_upload_base_path,credentials:k.settings.images_upload_credentials,handler:k.settings.images_upload_handler}
)
}
return y().then(m(function(O){
var T;
T=l.map(O,function(A){
return A.blobInfo
}
);
return w.upload(T).then(m(function(A){
A=l.map(A,function(C,W){
var B=O[W].image;
u(B.src,C.url);
k.$(B).attr({
src:C.url,"data-mce-src":k.convertURL(C.url,"src")}
);
return{
element:B,status:C.status}
}
);
if(z){
z(A)
}
return A
}
))
}
))
}
function v(z){
if(k.settings.automatic_uploads!==false){
return b(z)
}}
function y(){
if(!j){
j=new h(f)
}
return j.findAll(k.getBody()).then(m(function(z){
l.each(z,function(T){
u(T.image.src,T.blobInfo.blobUri());
T.image.src=T.blobInfo.blobUri()
}
);
return z
}
))
}
function q(){
f.destroy();
j=w=null
}
function g(z){
return z.replace(/src="(blob:[^"]+)"/g,function(T,A){
var O=f.getByUri(A);
if(!O){
O=l.reduce(k.editorManager.editors,function(W,B){
return W||B.editorUpload.blobCache.getByUri(A)
}
,null)
}
if(O){
return'src="data:'+O.blob().type+";base64,"+O.base64()+'"'
}
return T
}
)
}
k.on("setContent",function(){
if(k.settings.automatic_uploads!==false){
v()
}else{
y()
}}
);
k.on("RawSaveContent",function(z){
z.content=g(z.content)
}
);
k.on("getContent",function(z){
if(z.source_view||z.format=="raw"){
return
}
z.content=g(z.content)
}
);
return{
blobCache:f,uploadImages:b,uploadImagesAuto:v,scanForImages:y,destroy:q}
}
}
);
r("tinymce/Editor",["tinymce/dom/DOMUtils","tinymce/dom/DomQuery","tinymce/AddOnManager","tinymce/NodeChange","tinymce/html/Node","tinymce/dom/Serializer","tinymce/html/Serializer","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/dom/ScriptLoader","tinymce/dom/EventUtils","tinymce/WindowManager","tinymce/html/Schema","tinymce/html/DomParser","tinymce/util/Quirks","tinymce/Env","tinymce/util/Tools","tinymce/EditorObservable","tinymce/Shortcuts","tinymce/EditorUpload"],function(U,O,W,m,j,H,M,C,z,f,R,S,x,B,w,v,Y,p,l,A,E,y,d,L,c){
var T=U.DOM,G=W.ThemeManager,P=W.PluginManager;
var g=y.extend,I=y.each,b=y.explode;
var N=y.inArray,h=y.trim,k=y.resolve;
var F=v.Event;
var u=E.gecko,D=E.ie;
function q(X,Q,Z){
var K=this,J,V;
J=K.documentBaseUrl=Z.documentBaseURL;
V=Z.baseURI;
K.settings=Q=g({
id:X,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:J,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:"<!DOCTYPE html>",visual:true,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:true,padd_empty_editor:true,render_ui:true,indentation:"30px",inline_styles:true,convert_fonts_to_spans:true,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",validate:true,entity_encoding:"named",url_converter:K.convertURL,url_converter_scope:K,ie7_compat:true}
,Q);
W.language=Q.language||"en";
W.languageLoad=Q.language_load;
W.baseURL=Z.baseURL;
K.id=Q.id=X;
K.isNotDirty=true;
K.plugins={};
K.documentBaseURI=new B(Q.document_base_url||J,{
base_uri:V}
);
K.baseURI=V;
K.contentCSS=[];
K.contentStyles=[];
K.shortcuts=new L(K);
K.loadedCSS={};
K.editorCommands=new x(K);
if(Q.target){
K.targetElm=Q.target
}
K.suffix=Z.suffix;
K.editorManager=Z;
K.inline=Q.inline;
if(Q.cache_suffix){
E.cacheSuffix=Q.cache_suffix.replace(/^[\?\&]+/,"")
}
if(Q.override_viewport===false){
E.overrideViewPort=false
}
Z.fire("SetupEditor",K);
K.execCallback("setup",K);
K.$=O.overrideDefaults(function(){
return{
context:K.inline?K.getBody():K.getDoc(),element:K.getBody()}
}
)
}
q.prototype={
render:function(){
var J=this,V=J.settings,_e=J.id,X=J.suffix;
function Q(){
T.unbind(window,"ready",Q);
J.render()
}
if(!F.domLoaded){
T.bind(window,"ready",Q);
return
}
if(!J.getElement()){
return
}
if(!E.contentEditable){
return
}
if(!V.inline){
J.orgVisibility=J.getElement().style.visibility;
J.getElement().style.visibility="hidden"
}else{
J.inline=true
}
var Z=J.getElement().form||T.getParent(_e,"form");
if(Z){
J.formElement=Z;
if(V.hidden_input&&!/TEXTAREA|INPUT/i.test(J.getElement().nodeName)){
T.insertAfter(T.create("input",{
type:"hidden",name:_e}
),_e);
J.hasHiddenInput=true
}
J.formEventDelegate=function(_t){
J.fire(_t.type,_t)
};
T.bind(Z,"submit reset",J.formEventDelegate);
J.on("reset",function(){
J.setContent(J.startContent,{
format:"raw"}
)
}
);
if(V.submit_patch&&!Z.submit.nodeType&&!Z.submit.length&&!Z._mceOldSubmit){
Z._mceOldSubmit=Z.submit;
Z.submit=function(){
J.editorManager.triggerSave();
J.isNotDirty=true;
return Z._mceOldSubmit(Z)
}
}}
J.windowManager=new Y(J);
if(V.encoding=="xml"){
J.on("GetContent",function(_t){
if(_t.save){
_t.content=T.encode(_t.content)
}}
)
}
if(V.add_form_submit_trigger){
J.on("submit",function(){
if(J.initialized){
J.save()
}}
)
}
if(V.add_unload_trigger){
J._beforeUnload=function(){
if(J.initialized&&!J.destroyed&&!J.isHidden()){
J.save({
format:"raw",no_events:true,set_dirty:false}
)
}};
J.editorManager.on("BeforeUnload",J._beforeUnload)
}
function K(){
var _a=w.ScriptLoader;
if(V.language&&V.language!="en"&&!V.language_url){
V.language_url=J.editorManager.baseURL+"/langs/"+V.language+".js"
}
if(V.language_url){
_a.add(V.language_url)
}
if(V.theme&&typeof V.theme!="function"&&V.theme.charAt(0)!="-"&&!G.urls[V.theme]){
var _t=V.theme_url;
if(_t){
_t=J.documentBaseURI.toAbsolute(_t)
}else{
_t="themes/"+V.theme+"/theme"+X+".js"
}
G.load(V.theme,_t)
}
if(y.isArray(V.plugins)){
V.plugins=V.plugins.join(" ")
}
I(V.external_plugins,function(_o,_i){
P.load(_i,_o);
V.plugins+=" "+_i
}
);
I(V.plugins.split(/[ ,]/),function(_i){
_i=h(_i);
if(_i&&!P.urls[_i]){
if(_i.charAt(0)=="-"){
_i=_i.substr(1,_i.length);
var _o=P.dependencies(_i);
I(_o,function(_s){
var _n={
prefix:"plugins/",resource:_s,suffix:"/plugin"+X+".js"};
_s=P.createUrl(_n,_s);
P.load(_s.resource,_s)
}
)
}else{
P.load(_i,{
prefix:"plugins/",resource:_i,suffix:"/plugin"+X+".js"}
)
}}}
);
_a.loadQueue(function(){
if(!J.removed){
J.init()
}}
)
}
K()
}
,init:function(){
var _a=this,_d=_a.settings,Z=_a.getElement();
var _e,_l,V,_n,_i,J,K,_m,_h,_o,_r,Q=[];
this.editorManager.i18n.setCode(_d.language);
_a.rtl=_d.rtl_ui||this.editorManager.i18n.rtl;
_a.editorManager.add(_a);
_d.aria_label=_d.aria_label||T.getAttrib(Z,"aria-label",_a.getLang("aria.rich_text_area"));
if(_d.theme){
if(typeof _d.theme!="function"){
_d.theme=_d.theme.replace(/-/,"");
J=G.get(_d.theme);
_a.theme=new J(_a,G.urls[_d.theme]);
if(_a.theme.init){
_a.theme.init(_a,G.urls[_d.theme]||_a.documentBaseUrl.replace(/\/$/,""),_a.$)
}}else{
_a.theme=_d.theme
}}
function _u(_y){
var _g=P.get(_y),_p,_f;
_p=P.urls[_y]||_a.documentBaseUrl.replace(/\/$/,"");
_y=h(_y);
if(_g&&N(Q,_y)===-1){
I(P.dependencies(_y),function(_b){
_u(_b)
}
);
_f=new _g(_a,_p,_a.$);
_a.plugins[_y]=_f;
if(_f.init){
_f.init(_a,_p);
Q.push(_y)
}}}
I(_d.plugins.replace(/\-/g,"").split(/[ ,]/),_u);
if(_d.render_ui&&_a.theme){
_a.orgDisplay=Z.style.display;
if(typeof _d.theme!="function"){
_e=_d.width||Z.style.width||Z.offsetWidth;
_l=_d.height||Z.style.height||Z.offsetHeight;
V=_d.min_height||100;
_o=/^[0-9\.]+(|px)$/i;
if(_o.test(""+_e)){
_e=Math.max(parseInt(_e,10),100)
}
if(_o.test(""+_l)){
_l=Math.max(parseInt(_l,10),V)
}
_i=_a.theme.renderUI({
targetNode:Z,width:_e,height:_l,deltaWidth:_d.delta_width,deltaHeight:_d.delta_height}
);
if(!_d.content_editable){
_l=(_i.iframeHeight||_l)+(typeof _l=="number"?(_i.deltaHeight||0):"");
if(_l<V){
_l=V
}}}else{
_i=_d.theme(_a,Z);
if(_i.editorContainer.nodeType){
_i.editorContainer=_i.editorContainer.id=_i.editorContainer.id||_a.id+"_parent"
}
if(_i.iframeContainer.nodeType){
_i.iframeContainer=_i.iframeContainer.id=_i.iframeContainer.id||_a.id+"_iframecontainer"
}
_l=_i.iframeHeight||Z.offsetHeight
}
_a.editorContainer=_i.editorContainer
}
if(_d.content_css){
I(b(_d.content_css),function(_f){
_a.contentCSS.push(_a.documentBaseURI.toAbsolute(_f))
}
)
}
if(_d.content_style){
_a.contentStyles.push(_d.content_style)
}
if(_d.content_editable){
Z=_n=_i=null;
return _a.initContentBody()
}
_a.iframeHTML=_d.doctype+"<html><head>";
if(_d.document_base_url!=_a.documentBaseUrl){
_a.iframeHTML+='<base href="'+_a.documentBaseURI.getURI()+'" />'
}
if(!E.caretAfter&&_d.ie7_compat){
_a.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'
}
_a.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';
for(_r=0;
_r<_a.contentCSS.length;
_r++){
var _s=_a.contentCSS[_r];
_a.iframeHTML+=('<link type="text/css" rel="stylesheet" href="'+y._addCacheSuffix(_s)+'" />');
_a.loadedCSS[_s]=true
}
_m=_d.body_id||"tinymce";
if(_m.indexOf("=")!=-1){
_m=_a.getParam("body_id","","hash");
_m=_m[_a.id]||_m
}
_h=_d.body_class||"";
if(_h.indexOf("=")!=-1){
_h=_a.getParam("body_class","","hash");
_h=_h[_a.id]||""
}
if(_d.content_security_policy){
_a.iframeHTML+='<meta http-equiv="Content-Security-Policy" content="'+_d.content_security_policy+'" />'
}
_a.iframeHTML+='</head><body id="'+_m+'" class="mce-content-body '+_h+'" data-id="'+_a.id+'"><br></body></html>';
var _t='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+_a.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody(true);})()';
if(document.domain!=location.hostname){
if(E.ie&&E.ie<12){
K=_t
}}
var X=T.create("iframe",{
id:_a.id+"_ifr",frameBorder:"0",allowTransparency:"true",title:_a.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),style:{
width:"100%",height:_l,display:"block"}}
);
X.onload=function(){
X.onload=null;
_a.fire("load")
};
T.setAttrib(X,"src",K||'javascript:""');
_a.contentAreaContainer=_i.iframeContainer;
_a.iframeElement=X;
_n=T.add(_i.iframeContainer,X);
if(D){
try{
_a.getDoc()
}
catch(_c){
_n.src=K=_t
}}
if(_i.editorContainer){
T.get(_i.editorContainer).style.display=_a.orgDisplay;
_a.hidden=T.isHidden(_i.editorContainer)
}
_a.getElement().style.display="none";
T.setAttrib(_a.id,"aria-hidden",true);
if(!K){
_a.initContentBody()
}
Z=_n=_i=null
}
,initContentBody:function(K){
var Q=this,V=Q.settings,Z=Q.getElement(),X=Q.getDoc(),J,_e;
if(!V.inline){
Q.getElement().style.visibility=Q.orgVisibility
}
if(!K&&!V.content_editable){
X.open();
X.write(Q.iframeHTML);
X.close()
}
if(V.content_editable){
Q.on("remove",function(){
var _t=this.getBody();
T.removeClass(_t,"mce-content-body");
T.removeClass(_t,"mce-edit-focus");
T.setAttrib(_t,"contentEditable",null)
}
);
T.addClass(Z,"mce-content-body");
Q.contentDocument=X=V.content_document||document;
Q.contentWindow=V.content_window||window;
Q.bodyElement=Z;
V.content_document=V.content_window=null;
V.root_name=Z.nodeName.toLowerCase()
}
J=Q.getBody();
J.disabled=true;
if(!V.readonly){
if(Q.inline&&T.getStyle(J,"position",true)=="static"){
J.style.position="relative"
}
J.contentEditable=Q.getParam("content_editable_state",true)
}
J.disabled=false;
Q.editorUpload=new c(Q);
Q.schema=new p(V);
Q.dom=new U(X,{
keep_values:true,url_converter:Q.convertURL,url_converter_scope:Q,hex_colors:V.force_hex_style_colors,class_filter:V.class_filter,update_styles:true,root_element:Q.inline?Q.getBody():null,collect:V.content_editable,schema:Q.schema,onSetAttrib:function(_t){
Q.fire("SetAttrib",_t)
}}
);
Q.parser=new l(V,Q.schema);
Q.parser.addAttributeFilter("src,href,style,tabindex",function(_t,_a){
var _i=_t.length,_n,_r=Q.dom,_s,_o;
while(_i--){
_n=_t[_i];
_s=_n.attr(_a);
_o="data-mce-"+_a;
if(!_n.attributes.map[_o]){
if(_s.indexOf("data:")===0||_s.indexOf("blob:")===0){
continue
}
if(_a==="style"){
_s=_r.serializeStyle(_r.parseStyle(_s),_n.name);
if(!_s.length){
_s=null
}
_n.attr(_o,_s);
_n.attr(_a,_s)
}else{
if(_a==="tabindex"){
_n.attr(_o,_s);
_n.attr(_a,null)
}else{
_n.attr(_o,Q.convertURL(_s,_a,_n.name))
}}}}}
);
Q.parser.addNodeFilter("script",function(_t){
var _a=_t.length,_i;
while(_a--){
_i=_t[_a];
_i.attr("type","mce-"+(_i.attr("type")||"no/type"))
}}
);
Q.parser.addNodeFilter("#cdata",function(_t){
var _a=_t.length,_i;
while(_a--){
_i=_t[_a];
_i.type=8;
_i.name="#comment";
_i.value="[CDATA["+_i.value+"]]"
}}
);
Q.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(_a){
var _i=_a.length,_o,_t=Q.schema.getNonEmptyElements();
while(_i--){
_o=_a[_i];
if(_o.isEmpty(_t)){
_o.append(new j("br",1)).shortEnded=true
}}}
);
Q.serializer=new H(V,Q);
Q.selection=new C(Q.dom,Q.getWin(),Q.serializer,Q);
Q.formatter=new z(Q);
Q.undoManager=new f(Q);
Q.forceBlocks=new S(Q);
Q.enterKey=new R(Q);
Q._nodeChangeDispatcher=new m(Q);
Q.fire("PreInit");
if(!V.browser_spellcheck&&!V.gecko_spellcheck){
X.body.spellcheck=false;
T.setAttrib(J,"spellcheck","false")
}
Q.fire("PostRender");
Q.quirks=new A(Q);
if(V.directionality){
J.dir=V.directionality
}
if(V.nowrap){
J.style.whiteSpace="nowrap"
}
if(V.protect){
Q.on("BeforeSetContent",function(_t){
I(V.protect,function(_a){
_t.content=_t.content.replace(_a,function(_i){
return"<!--mce:protected "+escape(_i)+"-->"
}
)
}
)
}
)
}
Q.on("SetContent",function(){
Q.addVisual(Q.getBody())
}
);
if(V.padd_empty_editor){
Q.on("PostProcess",function(_t){
_t.content=_t.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")
}
)
}
Q.load({
initial:true,format:"html"}
);
Q.startContent=Q.getContent({
format:"raw"}
);
Q.initialized=true;
Q.bindPendingEventDelegates();
Q.fire("init");
Q.focus(true);
Q.nodeChanged({
initial:true}
);
Q.execCallback("init_instance_callback",Q);
if(Q.contentStyles.length>0){
_e="";
I(Q.contentStyles,function(_t){
_e+=_t+"\r\n"
}
);
Q.dom.addStyle(_e)
}
I(Q.contentCSS,function(_t){
if(!Q.loadedCSS[_t]){
Q.dom.loadCSS(_t);
Q.loadedCSS[_t]=true
}}
);
if(V.auto_focus){
setTimeout(function(){
var _t;
if(V.auto_focus===true){
_t=Q
}else{
_t=Q.editorManager.get(V.auto_focus)
}
if(!_t.destroyed){
_t.focus()
}}
,100)
}
Z=X=J=null
}
,focus:function(K){
var _a=this,_t=_a.selection,Z=_a.settings.content_editable,J;
var X,_e=_a.getDoc(),Q;
if(!K){
J=_t.getRng();
if(J.item){
X=J.item(0)
}
_a._refreshContentEditable();
if(!Z){
if(!E.opera){
_a.getBody().focus()
}
_a.getWin().focus()
}
if(u||Z){
Q=_a.getBody();
if(Q.setActive){
try{
Q.setActive()
}
catch(V){
Q.focus()
}}else{
Q.focus()
}
if(Z){
_t.normalize()
}}
if(X&&X.ownerDocument==_e){
J=_e.body.createControlRange();
J.addElement(X);
J.select()
}}
_a.editorManager.setActive(_a)
}
,execCallback:function(K){
var J=this,V=J.settings[K],Q;
if(!V){
return
}
if(J.callbackLookup&&(Q=J.callbackLookup[K])){
V=Q.func;
Q=Q.scope
}
if(typeof V==="string"){
Q=V.replace(/\.\w+$/,"");
Q=Q?k(Q):0;
V=k(V);
J.callbackLookup=J.callbackLookup||{};
J.callbackLookup[K]={
func:V,scope:Q}
}
return V.apply(Q||J,Array.prototype.slice.call(arguments,1))
}
,translate:function(Q){
var K=this.settings.language||"en",J=this.editorManager.i18n;
if(!Q){
return""
}
return J.data[K+"."+Q]||Q.replace(/\{\#([^\}]+)\}/g,function(Z,V){
return J.data[K+"."+V]||"{#"+V+"}"
}
)
}
,getLang:function(J,K){
return(this.editorManager.i18n.data[(this.settings.language||"en")+"."+J]||(K!==s?K:"{#"+J+"}"))
}
,getParam:function(K,Z,Q){
var V=K in this.settings?this.settings[K]:Z,J;
if(Q==="hash"){
J={};
if(typeof V==="string"){
I(V.indexOf("=")>0?V.split(/[;,](?![^=;,]*(?:[;,]|$))/):V.split(","),function(X){
X=X.split("=");
if(X.length>1){
J[h(X[0])]=h(X[1])
}else{
J[h(X[0])]=h(X)
}}
)
}else{
J=V
}
return J
}
return V
}
,nodeChanged:function(J){
this._nodeChangeDispatcher.nodeChanged(J)
}
,addButton:function(K,Q){
var J=this;
if(Q.cmd){
Q.onclick=function(){
J.execCommand(Q.cmd)
}
}
if(!Q.text&&!Q.icon){
Q.icon=K
}
J.buttons=J.buttons||{};
Q.tooltip=Q.tooltip||Q.title;
J.buttons[K]=Q
}
,addMenuItem:function(K,Q){
var J=this;
if(Q.cmd){
Q.onclick=function(){
J.execCommand(Q.cmd)
}
}
J.menuItems=J.menuItems||{};
J.menuItems[K]=Q
}
,addContextToolbar:function(K,V){
var Q=this,J;
Q.contextToolbars=Q.contextToolbars||[];
if(typeof K=="string"){
J=K;
K=function(Z){
return Q.dom.is(Z,J)
}
}
Q.contextToolbars.push({
predicate:K,items:V}
)
}
,addCommand:function(J,Q,K){
this.editorCommands.addCommand(J,Q,K)
}
,addQueryStateHandler:function(J,Q,K){
this.editorCommands.addQueryStateHandler(J,Q,K)
}
,addQueryValueHandler:function(J,Q,K){
this.editorCommands.addQueryValueHandler(J,Q,K)
}
,addShortcut:function(Q,V,K,J){
this.shortcuts.add(Q,V,K,J)
}
,execCommand:function(V,Q,K,J){
return this.editorCommands.execCommand(V,Q,K,J)
}
,queryCommandState:function(J){
return this.editorCommands.queryCommandState(J)
}
,queryCommandValue:function(J){
return this.editorCommands.queryCommandValue(J)
}
,queryCommandSupported:function(J){
return this.editorCommands.queryCommandSupported(J)
}
,show:function(){
var J=this;
if(J.hidden){
J.hidden=false;
if(J.inline){
J.getBody().contentEditable=true
}else{
T.show(J.getContainer());
T.hide(J.id)
}
J.load();
J.fire("show")
}}
,hide:function(){
var J=this,K=J.getDoc();
if(!J.hidden){
if(D&&K&&!J.inline){
K.execCommand("SelectAll")
}
J.save();
if(J.inline){
J.getBody().contentEditable=false;
if(J==J.editorManager.focusedEditor){
J.editorManager.focusedEditor=null
}}else{
T.hide(J.getContainer());
T.setStyle(J.id,"display",J.orgDisplay)
}
J.hidden=true;
J.fire("hide")
}}
,isHidden:function(){
return !!this.hidden
}
,setProgressState:function(J,K){
this.fire("ProgressState",{
state:J,time:K}
)
}
,load:function(K){
var J=this,V=J.getElement(),Q;
if(V){
K=K||{};
K.load=true;
Q=J.setContent(V.value!==s?V.value:V.innerHTML,K);
K.element=V;
if(!K.no_events){
J.fire("LoadContent",K)
}
K.element=V=null;
return Q
}}
,save:function(K){
var J=this,Z=J.getElement(),Q,V;
if(!Z||!J.initialized){
return
}
K=K||{};
K.save=true;
K.element=Z;
Q=K.content=J.getContent(K);
if(!K.no_events){
J.fire("SaveContent",K)
}
if(K.format=="raw"){
J.fire("RawSaveContent",K)
}
Q=K.content;
if(!/TEXTAREA|INPUT/i.test(Z.nodeName)){
if(!J.inline){
Z.innerHTML=Q
}
if((V=T.getParent(J.id,"form"))){
I(V.elements,function(X){
if(X.name==J.id){
X.value=Q;
return false
}}
)
}}else{
Z.value=Q
}
K.element=Z=null;
if(K.set_dirty!==false){
J.isNotDirty=true
}
return Q
}
,setContent:function(Z,Q){
var K=this,J=K.getBody(),V;
Q=Q||{};
Q.format=Q.format||"html";
Q.set=true;
Q.content=Z;
if(!Q.no_events){
K.fire("BeforeSetContent",Q)
}
Z=Q.content;
if(Z.length===0||/^\s+$/.test(Z)){
V=K.settings.forced_root_block;
if(V&&K.schema.isValidChild(J.nodeName.toLowerCase(),V.toLowerCase())){
Z=D&&D<11?"":'<br data-mce-bogus="1">';
Z=K.dom.createHTML(V,K.settings.forced_root_block_attrs,Z)
}else{
if(!D){
Z='<br data-mce-bogus="1">'
}}
K.dom.setHTML(J,Z);
K.fire("SetContent",Q)
}else{
if(Q.format!=="raw"){
Z=new M({}
,K.schema).serialize(K.parser.parse(Z,{
isRootContent:true}
))
}
Q.content=h(Z);
K.dom.setHTML(J,Q.content);
if(!Q.no_events){
K.fire("SetContent",Q)
}}
return Q.content
}
,getContent:function(Q){
var K=this,V,J=K.getBody();
Q=Q||{};
Q.format=Q.format||"html";
Q.get=true;
Q.getInner=true;
if(!Q.no_events){
K.fire("BeforeGetContent",Q)
}
if(Q.format=="raw"){
V=J.innerHTML
}else{
if(Q.format=="text"){
V=J.innerText||J.textContent
}else{
V=K.serializer.serialize(J,Q)
}}
if(Q.format!="text"){
Q.content=h(V)
}else{
Q.content=V
}
if(!Q.no_events){
K.fire("GetContent",Q)
}
return Q.content
}
,insertContent:function(K,J){
if(J){
K=g({
content:K}
,J)
}
this.execCommand("mceInsertContent",false,K)
}
,isDirty:function(){
return !this.isNotDirty
}
,getContainer:function(){
var J=this;
if(!J.container){
J.container=T.get(J.editorContainer||J.id+"_parent")
}
return J.container
}
,getContentAreaContainer:function(){
return this.contentAreaContainer
}
,getElement:function(){
if(!this.targetElm){
this.targetElm=T.get(this.id)
}
return this.targetElm
}
,getWin:function(){
var J=this,K;
if(!J.contentWindow){
K=J.iframeElement;
if(K){
J.contentWindow=K.contentWindow
}}
return J.contentWindow
}
,getDoc:function(){
var J=this,K;
if(!J.contentDocument){
K=J.getWin();
if(K){
J.contentDocument=K.document
}}
return J.contentDocument
}
,getBody:function(){
return this.bodyElement||this.getDoc().body
}
,convertURL:function(Q,K,Z){
var J=this,V=J.settings;
if(V.urlconverter_callback){
return J.execCallback("urlconverter_callback",Q,Z,true,K)
}
if(!V.convert_urls||(Z&&Z.nodeName=="LINK")||Q.indexOf("file:")===0||Q.length===0){
return Q
}
if(V.relative_urls){
return J.documentBaseURI.toRelative(Q)
}
Q=J.documentBaseURI.toAbsolute(Q,V.remove_script_host);
return Q
}
,addVisual:function(Z){
var K=this,Q=K.settings,V=K.dom,J;
Z=Z||K.getBody();
if(K.hasVisual===s){
K.hasVisual=Q.visual
}
I(V.select("table,a",Z),function(_e){
var X;
switch(_e.nodeName){
case"TABLE":J=Q.visual_table_class||"mce-item-table";
X=V.getAttrib(_e,"border");
if((!X||X=="0")&&K.hasVisual){
V.addClass(_e,J)
}else{
V.removeClass(_e,J)
}
return;
case"A":if(!V.getAttrib(_e,"href",false)){
X=V.getAttrib(_e,"name")||_e.id;
J=Q.visual_anchor_class||"mce-item-anchor";
if(X&&K.hasVisual){
V.addClass(_e,J)
}else{
V.removeClass(_e,J)
}}
return
}}
);
K.fire("VisualAid",{
element:Z,hasVisual:K.hasVisual}
)
}
,remove:function(){
var J=this;
if(!J.removed){
J.save();
J.removed=1;
J.unbindAllNativeEvents();
if(J.hasHiddenInput){
T.remove(J.getElement().nextSibling)
}
if(!J.inline){
if(D&&D<10){
J.getDoc().execCommand("SelectAll",false,null)
}
T.setStyle(J.id,"display",J.orgDisplay);
J.getBody().onload=null
}
J.fire("remove");
J.editorManager.remove(J);
T.remove(J.getContainer());
J.editorUpload.destroy();
J.destroy()
}}
,destroy:function(Q){
var J=this,K;
if(J.destroyed){
return
}
if(!Q&&!J.removed){
J.remove();
return
}
if(!Q){
J.editorManager.off("beforeunload",J._beforeUnload);
if(J.theme&&J.theme.destroy){
J.theme.destroy()
}
J.selection.destroy();
J.dom.destroy()
}
K=J.formElement;
if(K){
if(K._mceOldSubmit){
K.submit=K._mceOldSubmit;
K._mceOldSubmit=null
}
T.unbind(K,"submit reset",J.formEventDelegate)
}
J.contentAreaContainer=J.formElement=J.container=J.editorContainer=null;
J.bodyElement=J.contentDocument=J.contentWindow=null;
J.iframeElement=J.targetElm=null;
if(J.selection){
J.selection=J.selection.win=J.selection.dom=J.selection.dom.doc=null
}
J.destroyed=1
}
,uploadImages:function(J){
return this.editorUpload.uploadImages(J)
}
,_scanForImages:function(){
return this.editorUpload.scanForImages()
}
,_refreshContentEditable:function(){
var K=this,J,Q;
if(K._isHidden()){
J=K.getBody();
Q=J.parentNode;
Q.removeChild(J);
Q.appendChild(J);
J.focus()
}}
,_isHidden:function(){
var J;
if(!u){
return 0
}
J=this.selection.getSel();
return(!J||!J.rangeCount||J.rangeCount===0)
}};
g(q.prototype,d);
return q
}
);
r("tinymce/util/I18n",[],function(){var l={}
,h="en";
return{
setCode:function(c){
if(c){
h=c;
this.rtl=this.data[c]?this.data[c]._dir==="rtl":false
}}
,getCode:function(){
return h
}
,rtl:false,add:function(m,d){
var c=l[m];
if(!c){
l[m]=c={}
}
for(var u in d){
c[u]=d[u]
}
this.setCode(m)
}
,translate:function(u){
var c;
c=l[h];
if(!c){
c={}
}
if(typeof u=="undefined"){
return u
}
if(typeof u!="string"&&u.raw){
return u.raw
}
if(u.push){
var d=u.slice(1);
u=(c[u[0]]||u[0]).replace(/\{([0-9]+)\}/g,function(f,m){
return d[m]
}
)
}
return(c[u]||u).replace(/{context:\w+}$/,"")
}
,data:l}
}
);
r("tinymce/FocusManager",["tinymce/dom/DOMUtils","tinymce/Env"],function(f,l){
var c,u,d,m=f.DOM;
function h(k){
function g(){
try{
return document.activeElement
}
catch(x){
return document.body
}}
function v(q,x){
if(x&&x.startContainer){
if(!q.isChildOf(x.startContainer,q.getRoot())||!q.isChildOf(x.endContainer,q.getRoot())){
return
}
return{
startContainer:x.startContainer,startOffset:x.startOffset,endContainer:x.endContainer,endOffset:x.endOffset}
}
return x
}
function p(j,q){
var x;
if(q.startContainer){
x=j.getDoc().createRange();
x.setStart(q.startContainer,q.startOffset);
x.setEnd(q.endContainer,q.endOffset)
}else{
x=q
}
return x
}
function w(x){
return !!m.getParent(x,h.isEditorUIElement)
}
function y(q){
var x=q.editor;
x.on("init",function(){
if(x.inline||l.ie){
if("onbeforedeactivate" in document&&l.ie<9){
x.dom.bind(x.getBody(),"beforedeactivate",function(z){
if(z.target!=x.getBody()){
return
}
try{
x.lastRng=x.selection.getRng()
}
catch(j){}}
)
}else{
x.on("nodechange mouseup keyup",function(z){
var j=g();
if(z.type=="nodechange"&&z.selectionChange){
return
}
if(j&&j.id==x.id+"_ifr"){
j=x.getBody()
}
if(x.dom.isChildOf(j,x.getBody())){
x.lastRng=x.selection.getRng()
}}
)
}
if(l.webkit&&!c){
c=function(){
var z=k.activeEditor;
if(z&&z.selection){
var j=z.selection.getRng();
if(j&&!j.collapsed){
x.lastRng=j
}}};
m.bind(document,"selectionchange",c)
}}}
);
x.on("setcontent",function(){
x.lastRng=null
}
);
x.on("mousedown",function(){
x.selection.lastFocusBookmark=null
}
);
x.on("focusin",function(){
var j=k.focusedEditor;
if(x.selection.lastFocusBookmark){
x.selection.setRng(p(x,x.selection.lastFocusBookmark));
x.selection.lastFocusBookmark=null
}
if(j!=x){
if(j){
j.fire("blur",{
focusedEditor:x}
)
}
k.setActive(x);
k.focusedEditor=x;
x.fire("focus",{
blurredEditor:j}
);
x.focus(true)
}
x.lastRng=null
}
);
x.on("focusout",function(){
window.setTimeout(function(){
var j=k.focusedEditor;
if(!w(g())&&j==x){
x.fire("blur",{
focusedEditor:null}
);
k.focusedEditor=null;
if(x.selection){
x.selection.lastFocusBookmark=null
}}}
,0)
}
);
if(!u){
u=function(z){
var j=k.activeEditor;
if(j&&z.target.ownerDocument==document){
if(j.selection&&z.target!=j.getBody()){
j.selection.lastFocusBookmark=v(j.dom,j.lastRng)
}
if(z.target!=document.body&&!w(z.target)&&k.focusedEditor==j){
j.fire("blur",{
focusedEditor:null}
);
k.focusedEditor=null
}}};
m.bind(document,"focusin",u)
}
if(x.inline&&!d){
d=function(T){
var z=k.activeEditor;
if(z.inline&&!z.dom.isChildOf(T.target,z.getBody())){
var j=z.selection.getRng();
if(!j.collapsed){
z.lastRng=j
}}};
m.bind(document,"mouseup",d)
}}
function b(x){
if(k.focusedEditor==x.editor){
k.focusedEditor=null
}
if(!k.activeEditor){
m.unbind(document,"selectionchange",c);
m.unbind(document,"focusin",u);
m.unbind(document,"mouseup",d);
c=u=d=null
}}
k.on("AddEditor",y);
k.on("RemoveEditor",b)
}
h.isEditorUIElement=function(p){
return p.className.toString().indexOf("mce-")!==-1
};
return h
}
);
r("tinymce/EditorManager",["tinymce/Editor","tinymce/dom/DomQuery","tinymce/dom/DOMUtils","tinymce/util/URI","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/util/I18n","tinymce/FocusManager"],function(k,u,z,p,c,l,y,x,f){
var O=z.DOM;
var q=l.explode,d=l.each,T=l.extend;
var A=0,b,w,m=false;
function v(W){
d(w.editors,function(B){
B.fire("ResizeWindow",W)
}
)
}
function h(W,B){
if(B!==m){
if(B){
u(window).on("resize",v)
}else{
u(window).off("resize",v)
}
m=B
}}
function j(C){
var D=w.editors,B;
delete D[C.id];
for(var W=0;
W<D.length;
W++){
if(D[W]==C){
D.splice(W,1);
B=true;
break
}}
if(w.activeEditor==C){
w.activeEditor=D[0]
}
if(w.focusedEditor==C){
w.focusedEditor=null
}
return B
}
function g(W){
if(W&&!(W.getContainer()||W.getBody()).parentNode){
j(W);
W.unbindAllNativeEvents();
W.destroy(true);
W=null
}
return W
}
w={
$:u,majorVersion:"4",minorVersion:"2.6",releaseDate:"2015-09-28",editors:[],i18n:x,activeEditor:null,setup:function(){
var H=this,B,F,R="",C,W;
F=document.location.href;
if(/^[^:]+:\/\/\/?[^\/]+\//.test(F)){
F=F.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");
if(!/[\/\\]$/.test(F)){
F+="/"
}}
C=window.tinymce||window.tinyMCEPreInit;
if(C){
B=C.base||C.baseURL;
R=C.suffix
}else{
var D=document.getElementsByTagName("script");
for(var S=0;
S<D.length;
S++){
W=D[S].src;
var M=W.substring(W.lastIndexOf("/"));
if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(W)){
if(M.indexOf(".min")!=-1){
R=".min"
}
B=W.substring(0,W.lastIndexOf("/"));
break
}}
if(!B&&document.currentScript){
W=document.currentScript.src;
if(W.indexOf(".min")!=-1){
R=".min"
}
B=W.substring(0,W.lastIndexOf("/"))
}}
H.baseURL=new p(F).toAbsolute(B);
H.documentBaseURL=F;
H.baseURI=new p(H.baseURL);
H.suffix=R;
H.focusManager=new f(H)
}
,init:function(F){
var W=this,M=[];
function S(I){
var H=I.id;
if(!H){
H=I.name;
if(H&&!O.get(H)){
H=I.name
}else{
H=O.uniqueId()
}
I.setAttribute("id",H)
}
return H
}
function C(E,I,Y){
if(!g(W.get(E))){
var H=new k(E,I,W);
H.targetElm=H.targetElm||Y;
M.push(H);
H.render()
}}
function R(H){
var I=F[H];
if(!I){
return
}
return I.apply(W,Array.prototype.slice.call(arguments,2))
}
function D(I,H){
return H.constructor===RegExp?H.test(I.className):O.hasClass(I,H)
}
function B(){
var H,I;
O.unbind(window,"ready",B);
R("onpageload");
if(F.types){
d(F.types,function(Y){
d(O.select(Y.selector),function(E){
C(S(E),T({}
,F,Y),E)
}
)
}
);
return
}else{
if(F.selector){
d(O.select(F.selector),function(Y){
C(S(Y),F,Y)
}
);
return
}else{
if(F.target){
C(S(F.target),F)
}}}
switch(F.mode){
case"exact":H=F.elements||"";
if(H.length>0){
d(q(H),function(E){
var Y;
if((Y=O.get(E))){
C(E,F,Y)
}else{
d(document.forms,function(G){
d(G.elements,function(L){
if(L.name===E){
E="mce_editor_"+A++;
O.setAttrib(L,"id",E);
C(E,F,L)
}}
)
}
)
}}
)
}
break;
case"textareas":case"specific_textareas":d(O.select("textarea"),function(Y){
if(F.editor_deselector&&D(Y,F.editor_deselector)){
return
}
if(!F.editor_selector||D(Y,F.editor_selector)){
C(S(Y),F,Y)
}}
);
break
}
if(F.oninit){
H=I=0;
d(M,function(Y){
I++;
if(!Y.initialized){
Y.on("init",function(){
H++;
if(H==I){
R("oninit")
}}
)
}else{
H++
}
if(H==I){
R("oninit")
}}
)
}}
W.settings=F;
O.bind(window,"ready",B)
}
,get:function(W){
if(!arguments.length){
return this.editors
}
return W in this.editors?this.editors[W]:null
}
,add:function(B){
var W=this,C=W.editors;
C[B.id]=B;
C.push(B);
h(C,true);
W.activeEditor=B;
W.fire("AddEditor",{
editor:B}
);
if(!b){
b=function(){
W.fire("BeforeUnload")
};
O.bind(window,"beforeunload",b)
}
return B
}
,createEditor:function(B,W){
return this.add(new k(B,W,this))
}
,remove:function(W){
var B=this,C,S=B.editors,D;
if(!W){
for(C=S.length-1;
C>=0;
C--){
B.remove(S[C])
}
return
}
if(typeof W=="string"){
W=W.selector||W;
d(O.select(W),function(F){
D=S[F.id];
if(D){
B.remove(D)
}}
);
return
}
D=W;
if(!S[D.id]){
return null
}
if(j(D)){
B.fire("RemoveEditor",{
editor:D}
)
}
if(!S.length){
O.unbind(window,"beforeunload",b)
}
D.remove();
h(S,S.length>0);
return D
}
,execCommand:function(S,D,C){
var W=this,B=W.get(C);
switch(S){
case"mceAddEditor":if(!W.get(C)){
new k(C,W.settings,W).render()
}
return true;
case"mceRemoveEditor":if(B){
B.remove()
}
return true;
case"mceToggleEditor":if(!B){
W.execCommand("mceAddEditor",0,C);
return true
}
if(B.isHidden()){
B.show()
}else{
B.hide()
}
return true
}
if(W.activeEditor){
return W.activeEditor.execCommand(S,D,C)
}
return false
}
,triggerSave:function(){
d(this.editors,function(W){
W.save()
}
)
}
,addI18n:function(B,W){
x.add(B,W)
}
,translate:function(W){
return x.translate(W)
}
,setActive:function(W){
var B=this.activeEditor;
if(this.activeEditor!=W){
if(B){
B.fire("deactivate",{
relatedTarget:W}
)
}
W.fire("activate",{
relatedTarget:B}
)
}
this.activeEditor=W
}};
T(w,y);
w.setup();
window.tinymce=window.tinyMCE=w;
return w
}
);
r("tinymce/LegacyInput",["tinymce/EditorManager","tinymce/util/Tools"],function(l,h){
var d=h.each,c=h.explode;
l.on("AddEditor",function(m){
var u=m.editor;
u.on("preInit",function(){
var g,w,b,p=u.settings;
function f(k,v){
d(v,function(q,x){
if(q){
b.setStyle(k,x,q)
}}
);
b.rename(k,"span")
}
function y(v){
b=u.dom;
if(p.convert_fonts_to_spans){
d(b.select("font,u,strike",v.node),function(k){
g[k.nodeName.toLowerCase()](b,k)
}
)
}}
if(p.inline_styles){
w=c(p.font_size_legacy_values);
g={
font:function(k,v){
f(v,{
backgroundColor:v.style.backgroundColor,color:v.color,fontFamily:v.face,fontSize:w[parseInt(v.size,10)-1]}
)
}
,u:function(k,v){
if(u.settings.schema==="html4"){
f(v,{
textDecoration:"underline"}
)
}}
,strike:function(k,v){
f(v,{
textDecoration:"line-through"}
)
}};
u.on("PreProcess SetContent",y)
}}
)
}
)
}
);
r("tinymce/util/XHR",["tinymce/util/Observable","tinymce/util/Tools"],function(h,l){
var c={
send:function(u){
var f,m=0;
function d(){
if(!u.async||f.readyState==4||m++>10000){
if(u.success&&m<10000&&f.status==200){
u.success.call(u.success_scope,""+f.responseText,f,u)
}else{
if(u.error){
u.error.call(u.error_scope,m>10000?"TIMED_OUT":"GENERAL",f,u)
}}
f=null
}else{
setTimeout(d,10)
}}
u.scope=u.scope||this;
u.success_scope=u.success_scope||u.scope;
u.error_scope=u.error_scope||u.scope;
u.async=u.async===false?false:true;
u.data=u.data||"";
f=new XMLHttpRequest();
if(f){
if(f.overrideMimeType){
f.overrideMimeType(u.content_type)
}
f.open(u.type||(u.data?"POST":"GET"),u.url,u.async);
if(u.crossDomain){
f.withCredentials=true
}
if(u.content_type){
f.setRequestHeader("Content-Type",u.content_type)
}
if(u.requestheaders){
l.each(u.requestheaders,function(p){
f.setRequestHeader(p.key,p.value)
}
)
}
f.setRequestHeader("X-Requested-With","XMLHttpRequest");
f=c.fire("beforeSend",{
xhr:f,settings:u}
).xhr;
f.send(u.data);
if(!u.async){
return d()
}
setTimeout(d,10)
}}};
l.extend(c,h);
return c
}
);
r("tinymce/util/JSON",[],function(){
function h(f,c){
var m,l,u,d;
c=c||'"';
if(f===null){
return"null"
}
u=typeof f;
if(u=="string"){
l="\bb\tt\nn\ff\rr\"\"''\\\\";
return c+f.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(g,p){
if(c==='"'&&g==="'"){
return g
}
m=l.indexOf(p);
if(m+1){
return"\\"+l.charAt(m+1)
}
g=p.charCodeAt().toString(16);
return"\\u"+"0000".substring(g.length)+g
}
)+c
}
if(u=="object"){
if(f.hasOwnProperty&&Object.prototype.toString.call(f)==="[object Array]"){
for(m=0,l="[";
m<f.length;
m++){
l+=(m>0?",":"")+h(f[m],c)
}
return l+"]"
}
l="{";
for(d in f){
if(f.hasOwnProperty(d)){
l+=typeof f[d]!="function"?(l.length>1?","+c:c)+d+c+":"+h(f[d],c):""
}}
return l+"}"
}
return""+f
}
return{
serialize:h,parse:function(c){
try{
return window[String.fromCharCode(101)+"val"]("("+c+")")
}
catch(l){}}}
}
);
r("tinymce/util/JSONRequest",["tinymce/util/JSON","tinymce/util/XHR","tinymce/util/Tools"],function(d,c,l){
var u=l.extend;
function h(m){
this.settings=u({}
,m);
this.count=0
}
h.sendRPC=function(m){
return new h().send(m)
};
h.prototype={
send:function(p){
var f=p.error,m=p.success;
p=u(this.settings,p);
p.success=function(y,g){
y=d.parse(y);
if(typeof y=="undefined"){
y={
error:"JSON Parse error."}
}
if(y.error){
f.call(p.error_scope||p.scope,y.error,g)
}else{
m.call(p.success_scope||p.scope,y.result)
}};
p.error=function(y,g){
if(f){
f.call(p.error_scope||p.scope,y,g)
}};
p.data=d.serialize({
id:p.id||"c"+(this.count++),method:p.method,params:p.params}
);
p.content_type="application/json";
c.send(p)
}};
return h
}
);
r("tinymce/util/JSONP",["tinymce/dom/DOMUtils"],function(h){
return{
callbacks:{}
,count:0,send:function(c){
var l=this,u=h.DOM,d=c.count!==s?c.count:l.count;
var m="tinymce_jsonp_"+d;
l.callbacks[d]=function(f){
u.remove(m);
delete l.callbacks[d];
c.callback(f)
};
u.add(u.doc.body,"script",{
id:m,src:c.url,type:"text/javascript"}
);
l.count++
}}
}
);
r("tinymce/util/LocalStorage",[],function(){
var d,c,f,g,y,l;
try{
if(window.localStorage){
return localStorage
}}
catch(m){}
y="tinymce";
c=document.documentElement;
l=!!c.addBehavior;
if(l){
c.addBehavior("#default#userData")
}
function h(){
g=[];
for(var b in f){
g.push(b)
}
d.length=g.length
}
function p(){
var b,k,v,q=0;
f={};
if(!l){
return
}
function w(j){
var T,z;
z=j!==s?q+j:k.indexOf(",",q);
if(z===-1||z>k.length){
return null
}
T=k.substring(q,z);
q=z+1;
return T
}
c.load(y);
k=c.getAttribute(y)||"";
do{
var x=w();
if(x===null){
break
}
b=w(parseInt(x,32)||0);
if(b!==null){
x=w();
if(x===null){
break
}
v=w(parseInt(x,32)||0);
if(b){
f[b]=v
}}}
while(b!==null);
h()
}
function u(){
var k,v="";
if(!l){
return
}
for(var w in f){
k=f[w];
v+=(v?",":"")+w.length.toString(32)+","+w+","+k.length.toString(32)+","+k
}
c.setAttribute(y,v);
try{
c.save(y)
}
catch(b){}
h()
}
d={
key:function(b){
return g[b]
}
,getItem:function(b){
return b in f?f[b]:null
}
,setItem:function(b,w){
f[b]=""+w;
u()
}
,removeItem:function(b){
delete f[b];
u()
}
,clear:function(){
f={};
u()
}};
p();
return d
}
);
r("tinymce/Compat",["tinymce/dom/DOMUtils","tinymce/dom/EventUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/util/Tools","tinymce/Env"],function(u,f,m,d,l,h){
var c=window.tinymce;
c.DOM=u.DOM;
c.ScriptLoader=m.ScriptLoader;
c.PluginManager=d.PluginManager;
c.ThemeManager=d.ThemeManager;
c.dom=c.dom||{};
c.dom.Event=f.Event;
l.each(l,function(g,p){
c[p]=g
}
);
l.each("isOpera isWebKit isIE isGecko isMac".split(" "),function(p){
c[p]=h[p.substr(2).toLowerCase()]
}
);
return{}
}
);
r("tinymce/ui/Layout",["tinymce/util/Class","tinymce/util/Tools"],function(h,l){return h.extend({
Defaults:{
firstControlClass:"first",lastControlClass:"last"}
,init:function(c){
this.settings=l.extend({}
,this.Defaults,c)
}
,preRender:function(c){
c.bodyClasses.add(this.settings.containerClass)
}
,applyClasses:function(d){
var c=this,f=c.settings,m,u,g,p;
m=f.firstControlClass;
u=f.lastControlClass;
d.each(function(y){
y.classes.remove(m).remove(u).add(f.controlClass);
if(y.visible()){
if(!g){
g=y
}
p=y
}}
);
if(g){
g.classes.add(m)
}
if(p){
p.classes.add(u)
}}
,renderHtml:function(c){
var d=this,u="";
d.applyClasses(c.items());
c.items().each(function(m){
u+=m.renderHtml()
}
);
return u
}
,recalc:function(){}
,postRender:function(){}
,isNative:function(){
return false
}}
)
}
);
r("tinymce/ui/AbsoluteLayout",["tinymce/ui/Layout"],function(h){return h.extend({
Defaults:{
containerClass:"abs-layout",controlClass:"abs-layout-item"}
,recalc:function(l){
l.items().filter(":visible").each(function(d){
var c=d.settings;
d.layoutRect({
x:c.x,y:c.y,w:c.w,h:c.h}
);
if(d.recalc){
d.recalc()
}}
)
}
,renderHtml:function(l){
return'<div id="'+l._id+'-absend" class="'+l.classPrefix+'abs-end"></div>'+this._super(l)
}}
)
}
);
r("tinymce/ui/Tooltip",["tinymce/ui/Control","tinymce/ui/Movable"],function(l,h){
return l.extend({
Mixins:[h],Defaults:{
classes:"widget tooltip tooltip-n"}
,renderHtml:function(){
var c=this,d=c.classPrefix;
return('<div id="'+c._id+'" class="'+c.classes+'" role="presentation"><div class="'+d+'tooltip-arrow"></div><div class="'+d+'tooltip-inner">'+c.encode(c.state.get("text"))+"</div></div>")
}
,bindStates:function(){
var c=this;
c.state.on("change:text",function(d){
c.getEl().lastChild.innerHTML=c.encode(d.value)
}
);
return c._super()
}
,repaint:function(){
var c=this,d,u;
d=c.getEl().style;
u=c._layoutRect;
d.left=u.x+"px";
d.top=u.y+"px";
d.zIndex=65535+65535
}}
)
}
);
r("tinymce/ui/Widget",["tinymce/ui/Control","tinymce/ui/Tooltip"],function(c,h){var d;
var l=c.extend({
init:function(m){
var u=this;
u._super(m);
m=u.settings;
u.canFocus=true;
if(m.tooltip&&l.tooltips!==false){
u.on("mouseenter",function(g){
var p=u.tooltip().moveTo(-65535);
if(g.control==u){
var f=p.text(m.tooltip).show().testMoveRel(u.getEl(),["bc-tc","bc-tl","bc-tr"]);
p.classes.toggle("tooltip-n",f=="bc-tc");
p.classes.toggle("tooltip-nw",f=="bc-tl");
p.classes.toggle("tooltip-ne",f=="bc-tr");
p.moveRel(u.getEl(),f)
}else{
p.hide()
}}
);
u.on("mouseleave mousedown click",function(){
u.tooltip().hide()
}
)
}
u.aria("label",m.ariaLabel||m.tooltip)
}
,tooltip:function(){
if(!d){
d=new h({
type:"tooltip"}
);
d.renderTo()
}
return d
}
,postRender:function(){
var u=this,m=u.settings;
u._super();
if(!u.parent()&&(m.width||m.height)){
u.initLayoutRect();
u.repaint()
}
if(m.autofocus){
u.focus()
}}
,bindStates:function(){
var u=this;
function m(p){
u.aria("disabled",p);
u.classes.toggle("disabled",p)
}
function f(p){
u.aria("pressed",p);
u.classes.toggle("active",p)
}
u.state.on("change:disabled",function(p){
m(p.value)
}
);
u.state.on("change:active",function(p){
f(p.value)
}
);
if(u.state.get("disabled")){
m(true)
}
if(u.state.get("active")){
f(true)
}
return u._super()
}
,remove:function(){
this._super();
if(d){
d.remove();
d=null
}}}
);
return l
}
);
r("tinymce/ui/Button",["tinymce/ui/Widget"],function(h){return h.extend({
Defaults:{
classes:"widget btn",role:"button"}
,init:function(d){
var l=this,c;
l._super(d);
d=l.settings;
c=l.settings.size;
l.on("click mousedown",function(u){
u.preventDefault()
}
);
l.on("touchstart",function(u){
l.fire("click",u);
u.preventDefault()
}
);
if(d.subtype){
l.classes.add(d.subtype)
}
if(c){
l.classes.add("btn-"+c)
}
if(d.icon){
l.icon(d.icon)
}}
,icon:function(l){
if(!arguments.length){
return this.state.get("icon")
}
this.state.set("icon",l);
return this
}
,repaint:function(){
var l=this.getEl().firstChild,c;
if(l){
c=l.style;
c.width=c.height="100%"
}
this._super()
}
,renderHtml:function(){
var l=this,f=l._id,d=l.classPrefix;
var c=l.state.get("icon"),u,m=l.state.get("text");
u=l.settings.image;
if(u){
c="none";
if(typeof u!="string"){
u=window.getSelection?u[0]:u[1]
}
u=" style=\"background-image: url('"+u+"')\""
}else{
u=""
}
if(m){
l.classes.add("btn-has-text")
}
c=l.settings.icon?d+"ico "+d+"i-"+c:"";
return('<div id="'+f+'" class="'+l.classes+'" tabindex="-1"><button role="presentation" type="button" tabindex="-1">'+(c?'<i class="'+c+'"'+u+"></i>":"")+(m?l.encode(m):"")+"</button></div>")
}
,bindStates:function(){
var l=this;
function c(u){
var d=l.getEl().firstChild.firstChild;
for(;
d;
d=d.nextSibling){
if(d.nodeType==3){
d.data=l.translate(u)
}}
l.classes.toggle("btn-has-text",!!u)
}
l.state.on("change:text",function(d){
c(d.value)
}
);
l.state.on("change:icon",function(p){
var m=p.value,f=l.classPrefix;
l.settings.icon=m;
m=m?f+"ico "+f+"i-"+l.settings.icon:"";
var d=l.getEl().firstChild,u=d.getElementsByTagName("i")[0];
if(m){
if(!u||u!=d.firstChild){
u=document.createElement("i");
d.insertBefore(u,d.firstChild)
}
u.className=m
}else{
if(u){
d.removeChild(u)
}}
c(l.state.get("text"))
}
);
return l._super()
}}
)
}
);
r("tinymce/ui/ButtonGroup",["tinymce/ui/Container"],function(h){return h.extend({
Defaults:{
defaultType:"button",role:"group"}
,renderHtml:function(){
var l=this,c=l._layout;
l.classes.add("btn-group");
l.preRender();
c.preRender(l);
return('<div id="'+l._id+'" class="'+l.classes+'"><div id="'+l._id+'-body">'+(l.settings.html||"")+c.renderHtml(l)+"</div></div>")
}}
)
}
);
r("tinymce/ui/Checkbox",["tinymce/ui/Widget"],function(h){return h.extend({
Defaults:{
classes:"checkbox",role:"checkbox",checked:false}
,init:function(c){
var l=this;
l._super(c);
l.on("click mousedown",function(d){
d.preventDefault()
}
);
l.on("click",function(d){
d.preventDefault();
if(!l.disabled()){
l.checked(!l.checked())
}}
);
l.checked(l.settings.checked)
}
,checked:function(l){
if(!arguments.length){
return this.state.get("checked")
}
this.state.set("checked",l);
return this
}
,value:function(l){
if(!arguments.length){
return this.checked()
}
return this.checked(l)
}
,renderHtml:function(){
var l=this,d=l._id,c=l.classPrefix;
return('<div id="'+d+'" class="'+l.classes+'" unselectable="on" aria-labelledby="'+d+'-al" tabindex="-1"><i class="'+c+"ico "+c+'i-checkbox"></i><span id="'+d+'-al" class="'+c+'label">'+l.encode(l.state.get("text"))+"</span></div>")
}
,bindStates:function(){
var l=this;
function c(d){
l.classes.toggle("checked",d);
l.aria("checked",d)
}
l.state.on("change:text",function(d){
l.getEl("al").firstChild.data=l.translate(d.value)
}
);
l.state.on("change:checked change:value",function(d){
l.fire("change");
c(d.value)
}
);
l.state.on("change:icon",function(p){
var m=p.value,f=l.classPrefix;
if(typeof m=="undefined"){
return l.settings.icon
}
l.settings.icon=m;
m=m?f+"ico "+f+"i-"+l.settings.icon:"";
var d=l.getEl().firstChild,u=d.getElementsByTagName("i")[0];
if(m){
if(!u||u!=d.firstChild){
u=document.createElement("i");
d.insertBefore(u,d.firstChild)
}
u.className=m
}else{
if(u){
d.removeChild(u)
}}}
);
if(l.state.get("checked")){
c(true)
}
return l._super()
}}
)
}
);
r("tinymce/ui/ComboBox",["tinymce/ui/Widget","tinymce/ui/Factory","tinymce/ui/DomUtils","tinymce/dom/DomQuery"],function(c,h,l,d){return c.extend({
init:function(m){
var u=this;
u._super(m);
m=u.settings;
u.classes.add("combobox");
u.subinput=true;
u.ariaTarget="inp";
m.menu=m.menu||m.values;
if(m.menu){
m.icon="caret"
}
u.on("click",function(p){
var g=p.target,f=u.getEl();
if(!d.contains(f,g)&&g!=f){
return
}
while(g&&g!=f){
if(g.id&&g.id.indexOf("-open")!=-1){
u.fire("action");
if(m.menu){
u.showMenu();
if(p.aria){
u.menu.items()[0].focus()
}}}
g=g.parentNode
}}
);
u.on("keydown",function(f){
if(f.target.nodeName=="INPUT"&&f.keyCode==13){
u.parents().reverse().each(function(g){
var y=u.state.get("value"),p=u.getEl("inp").value;
f.preventDefault();
u.state.set("value",p);
if(y!=p){
u.fire("change")
}
if(g.hasEventListeners("submit")&&g.toJSON){
g.fire("submit",{
data:g.toJSON()}
);
return false
}}
)
}}
);
u.on("keyup",function(f){
if(f.target.nodeName=="INPUT"){
u.state.set("value",f.target.value)
}}
)
}
,showMenu:function(){
var u=this,m=u.settings,f;
if(!u.menu){
f=m.menu||[];
if(f.length){
f={
type:"menu",items:f}
}else{
f.type=f.type||"menu"
}
u.menu=h.create(f).parent(u).renderTo(u.getContainerElm());
u.fire("createmenu");
u.menu.reflow();
u.menu.on("cancel",function(p){
if(p.control===u.menu){
u.focus()
}}
);
u.menu.on("show hide",function(p){
p.control.items().each(function(g){
g.active(g.value()==u.value())
}
)
}
).fire("show");
u.menu.on("select",function(p){
u.value(p.control.value())
}
);
u.on("focusin",function(p){
if(p.target.tagName.toUpperCase()=="INPUT"){
u.menu.hide()
}}
);
u.aria("expanded",true)
}
u.menu.show();
u.menu.layoutRect({
w:u.layoutRect().w}
);
u.menu.moveRel(u.getEl(),u.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])
}
,focus:function(){
this.getEl("inp").focus()
}
,repaint:function(){
var m=this,b=m.getEl(),u=m.getEl("open"),g=m.layoutRect();
var p,f;
if(u){
p=g.w-l.getSize(u).width-10
}else{
p=g.w-10
}
var y=document;
if(y.all&&(!y.documentMode||y.documentMode<=8)){
f=(m.layoutRect().h-2)+"px"
}
d(b.firstChild).css({
width:p,lineHeight:f}
);
m._super();
return m
}
,postRender:function(){
var u=this;
d(this.getEl("inp")).on("change",function(m){
u.state.set("value",m.target.value);
u.fire("change",m)
}
);
return u._super()
}
,renderHtml:function(){
var v=this,u=v._id,m=v.settings,f=v.classPrefix;
var y=v.state.get("value")||"";
var g,w,p="",b="";
if("spellcheck" in m){
b+=' spellcheck="'+m.spellcheck+'"'
}
if(m.maxLength){
b+=' maxlength="'+m.maxLength+'"'
}
if(m.size){
b+=' size="'+m.size+'"'
}
if(m.subtype){
b+=' type="'+m.subtype+'"'
}
if(v.disabled()){
b+=' disabled="disabled"'
}
g=m.icon;
if(g&&g!="caret"){
g=f+"ico "+f+"i-"+m.icon
}
w=v.state.get("text");
if(g||w){
p=('<div id="'+u+'-open" class="'+f+"btn "+f+'open" tabIndex="-1" role="button"><button id="'+u+'-action" type="button" hidefocus="1" tabindex="-1">'+(g!="caret"?'<i class="'+g+'"></i>':'<i class="'+f+'caret"></i>')+(w?(g?" ":"")+w:"")+"</button></div>");
v.classes.add("has-open")
}
return('<div id="'+u+'" class="'+v.classes+'"><input id="'+u+'-inp" class="'+f+'textbox" value="'+v.encode(y,false)+'" hidefocus="1"'+b+' placeholder="'+v.encode(m.placeholder)+'" />'+p+"</div>")
}
,value:function(u){
if(arguments.length){
this.state.set("value",u);
return this
}
if(this.state.get("rendered")){
this.state.set("value",this.getEl("inp").value)
}
return this.state.get("value")
}
,bindStates:function(){
var u=this;
u.state.on("change:value",function(m){
if(u.getEl("inp").value!=m.value){
u.getEl("inp").value=m.value
}}
);
u.state.on("change:disabled",function(m){
u.getEl("inp").disabled=m.value
}
);
return u._super()
}
,remove:function(){
d(this.getEl("inp")).off();
this._super()
}}
)
}
);
r("tinymce/ui/ColorBox",["tinymce/ui/ComboBox"],function(h){return h.extend({
init:function(c){
var l=this;
c.spellcheck=false;
if(c.onaction){
c.icon="none"
}
l._super(c);
l.classes.add("colorbox");
l.on("change keyup postrender",function(){
l.repaintColor(l.value())
}
)
}
,repaintColor:function(c){
var d=this.getEl().getElementsByTagName("i")[0];
if(d){
try{
d.style.background=c
}
catch(l){}}}
,bindStates:function(){
var l=this;
l.state.on("change:value",function(c){
if(l._rendered){
l.repaintColor(c.value)
}}
);
return l._super()
}}
)
}
);
r("tinymce/ui/PanelButton",["tinymce/ui/Button","tinymce/ui/FloatPanel"],function(h,l){return h.extend({
showPanel:function(){
var c=this,d=c.settings;
c.active(true);
if(!c.panel){
var u=d.panel;
if(u.type){
u={
layout:"grid",items:u}
}
u.role=u.role||"dialog";
u.popover=true;
u.autohide=true;
u.ariaRoot=true;
c.panel=new l(u).on("hide",function(){
c.active(false)
}
).on("cancel",function(m){
m.stopPropagation();
c.focus();
c.hidePanel()
}
).parent(c).renderTo(c.getContainerElm());
c.panel.fire("show");
c.panel.reflow()
}else{
c.panel.show()
}
c.panel.moveRel(c.getEl(),d.popoverAlign||(c.isRtl()?["bc-tr","bc-tc"]:["bc-tl","bc-tc"]))
}
,hidePanel:function(){
var c=this;
if(c.panel){
c.panel.hide()
}}
,postRender:function(){
var c=this;
c.aria("haspopup",true);
c.on("click",function(d){
if(d.control===c){
if(c.panel&&c.panel.visible()){
c.hidePanel()
}else{
c.showPanel();
c.panel.focus(!!d.aria)
}}}
);
return c._super()
}
,remove:function(){
if(this.panel){
this.panel.remove();
this.panel=null
}
return this._super()
}}
)
}
);
r("tinymce/ui/ColorButton",["tinymce/ui/PanelButton","tinymce/dom/DOMUtils"],function(l,h){var c=h.DOM;
return l.extend({
init:function(d){
this._super(d);
this.classes.add("colorbutton")
}
,color:function(d){
if(d){
this._color=d;
this.getEl("preview").style.backgroundColor=d;
return this
}
return this._color
}
,resetColor:function(){
this._color=null;
this.getEl("preview").style.backgroundColor=null;
return this
}
,renderHtml:function(){
var d=this,g=d._id,m=d.classPrefix,p=d.state.get("text");
var u=d.settings.icon?m+"ico "+m+"i-"+d.settings.icon:"";
var f=d.settings.image?" style=\"background-image: url('"+d.settings.image+"')\"":"";
return('<div id="'+g+'" class="'+d.classes+'" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">'+(u?'<i class="'+u+'"'+f+"></i>":"")+'<span id="'+g+'-preview" class="'+m+'preview"></span>'+(p?(u?" ":"")+(p):"")+'</button><button type="button" class="'+m+'open" hidefocus="1" tabindex="-1"> <i class="'+m+'caret"></i></button></div>')
}
,postRender:function(){
var d=this,u=d.settings.onclick;
d.on("click",function(m){
if(m.aria&&m.aria.key=="down"){
return
}
if(m.control==d&&!c.getParent(m.target,"."+d.classPrefix+"open")){
m.stopImmediatePropagation();
u.call(d,m)
}}
);
delete d.settings.onclick;
return d._super()
}}
)
}
);
r("tinymce/util/Color",[],function(){
var c=Math.min,h=Math.max,l=Math.round;
function d(q){
var j=this,u=0,v=0,x=0;
function p(z,O,W){
var T,S,C,A,B,D;
T=0;
S=0;
C=0;
z=z/255;
O=O/255;
W=W/255;
B=c(z,c(O,W));
D=h(z,h(O,W));
if(B==D){
C=B;
return{
h:0,s:0,v:C*100}
}
A=(z==B)?O-W:((W==B)?z-O:W-z);
T=(z==B)?3:((W==B)?1:5);
T=60*(T-A/(D-B));
S=(D-B)/D;
C=D;
return{
h:l(T),s:l(S*100),v:l(C*100)}
}
function y(b,A,W){
var O,T,g,z;
b=(parseInt(b,10)||0)%360;
A=parseInt(A,10)/100;
W=parseInt(W,10)/100;
A=h(0,c(A,1));
W=h(0,c(W,1));
if(A===0){
u=v=x=l(255*W);
return
}
O=b/60;
T=W*A;
g=T*(1-Math.abs(O%2-1));
z=W-T;
switch(Math.floor(O)){
case 0:u=T;
v=g;
x=0;
break;
case 1:u=g;
v=T;
x=0;
break;
case 2:u=0;
v=T;
x=g;
break;
case 3:u=0;
v=g;
x=T;
break;
case 4:u=g;
v=0;
x=T;
break;
case 5:u=T;
v=0;
x=g;
break;
default:u=v=x=0
}
u=l(255*(u+z));
v=l(255*(v+z));
x=l(255*(x+z))
}
function m(){
function g(b){
b=parseInt(b,10).toString(16);
return b.length>1?b:"0"+b
}
return"#"+g(u)+g(v)+g(x)
}
function k(){
return{
r:u,g:v,b:x}
}
function w(){
return p(u,v,x)
}
function f(b){
var g;
if(typeof b=="object"){
if("r" in b){
u=b.r;
v=b.g;
x=b.b
}else{
if("v" in b){
y(b.h,b.s,b.v)
}}}else{
if((g=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(b))){
u=parseInt(g[1],10);
v=parseInt(g[2],10);
x=parseInt(g[3],10)
}else{
if((g=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(b))){
u=parseInt(g[1],16);
v=parseInt(g[2],16);
x=parseInt(g[3],16)
}else{
if((g=/#([0-F])([0-F])([0-F])/gi.exec(b))){
u=parseInt(g[1]+g[1],16);
v=parseInt(g[2]+g[2],16);
x=parseInt(g[3]+g[3],16)
}}}}
u=u<0?0:(u>255?255:u);
v=v<0?0:(v>255?255:v);
x=x<0?0:(x>255?255:x);
return j
}
if(q){
f(q)
}
j.toRgb=k;
j.toHsv=w;
j.toHex=m;
j.parse=f
}
return d
}
);
r("tinymce/ui/ColorPicker",["tinymce/ui/Widget","tinymce/ui/DragHelper","tinymce/ui/DomUtils","tinymce/util/Color"],function(c,l,h,d){return c.extend({
Defaults:{
classes:"widget colorpicker"}
,init:function(u){
this._super(u)
}
,postRender:function(){
var x=this,g=x.color(),y,w,b,k,f;
w=x.getEl("h");
b=x.getEl("hp");
k=x.getEl("sv");
f=x.getEl("svp");
function p(O,j){
var T=h.getPos(O),q,z;
q=j.pageX-T.x;
z=j.pageY-T.y;
q=Math.max(0,Math.min(q/O.clientWidth,1));
z=Math.max(0,Math.min(z/O.clientHeight,1));
return{
x:q,y:z}
}
function m(z,j){
var q=(360-z.h)/360;
h.css(b,{
top:(q*100)+"%"}
);
if(!j){
h.css(f,{
left:z.s+"%",top:(100-z.v)+"%"}
)
}
k.style.background=new d({
s:100,v:100,h:z.h}
).toHex();
x.color().parse({
s:z.s,v:z.v,h:z.h}
)
}
function u(q){
var j;
j=p(k,q);
y.s=j.x*100;
y.v=(1-j.y)*100;
m(y);
x.fire("change")
}
function v(q){
var j;
j=p(w,q);
y=g.toHsv();
y.h=(1-j.y)*360;
m(y,true);
x.fire("change")
}
x._repaint=function(){
y=g.toHsv();
m(y)
};
x._super();
x._svdraghelper=new l(x._id+"-sv",{
start:u,drag:u}
);
x._hdraghelper=new l(x._id+"-h",{
start:v,drag:v}
);
x._repaint()
}
,rgb:function(){
return this.color().toRgb()
}
,value:function(m){
var u=this;
if(arguments.length){
u.color().parse(m);
if(u._rendered){
u._repaint()
}}else{
return u.color().toHex()
}}
,color:function(){
if(!this._color){
this._color=new d()
}
return this._color
}
,renderHtml:function(){
var u=this,b=u._id,g=u.classPrefix,f;
var p="#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000";
function m(){
var x,v,k="",w,q;
w="filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=";
q=p.split(",");
for(x=0,v=q.length-1;
x<v;
x++){
k+=('<div class="'+g+'colorpicker-h-chunk" style="height:'+(100/v)+"%;"+w+q[x]+",endColorstr="+q[x+1]+");-ms-"+w+q[x]+",endColorstr="+q[x+1]+')"></div>')
}
return k
}
var y=("background: -ms-linear-gradient(top,"+p+");background: linear-gradient(to bottom,"+p+");");
f=('<div id="'+b+'-h" class="'+g+'colorpicker-h" style="'+y+'">'+m()+'<div id="'+b+'-hp" class="'+g+'colorpicker-h-marker"></div></div>');
return('<div id="'+b+'" class="'+u.classes+'"><div id="'+b+'-sv" class="'+g+'colorpicker-sv"><div class="'+g+'colorpicker-overlay1"><div class="'+g+'colorpicker-overlay2"><div id="'+b+'-svp" class="'+g+'colorpicker-selector1"><div class="'+g+'colorpicker-selector2"></div></div></div></div></div>'+f+"</div>")
}}
)
}
);
r("tinymce/ui/Path",["tinymce/ui/Widget"],function(h){return h.extend({
init:function(c){
var l=this;
if(!c.delimiter){
c.delimiter="\u00BB"
}
l._super(c);
l.classes.add("path");
l.canFocus=true;
l.on("click",function(m){
var d,u=m.target;
if((d=u.getAttribute("data-index"))){
l.fire("select",{
value:l.row()[d],index:d}
)
}}
);
l.row(l.settings.row)
}
,focus:function(){
var l=this;
l.getEl().firstChild.focus();
return l
}
,row:function(l){
if(!arguments.length){
return this.state.get("row")
}
this.state.set("row",l);
return this
}
,renderHtml:function(){
var l=this;
return('<div id="'+l._id+'" class="'+l.classes+'">'+l._getDataPathHtml(l.state.get("row"))+"</div>")
}
,bindStates:function(){
var l=this;
l.state.on("change:row",function(c){
l.innerHtml(l._getDataPathHtml(c.value))
}
);
return l._super()
}
,_getDataPathHtml:function(p){
var d=this,g=p||[],m,c,u="",f=d.classPrefix;
for(m=0,c=g.length;
m<c;
m++){
u+=((m>0?'<div class="'+f+'divider" aria-hidden="true"> '+d.settings.delimiter+" </div>":"")+'<div role="button" class="'+f+"path-item"+(m==c-1?" "+f+"last":"")+'" data-index="'+m+'" tabindex="-1" id="'+d._id+"-"+m+'" aria-level="'+m+'">'+g[m].name+"</div>")
}
if(!u){
u='<div class="'+f+'path-item">\u00a0</div>'
}
return u
}}
)
}
);
r("tinymce/ui/ElementPath",["tinymce/ui/Path","tinymce/EditorManager"],function(l,h){
return l.extend({
postRender:function(){
var c=this,u=h.activeEditor;
function d(m){
if(m.nodeType===1){
if(m.nodeName=="BR"||!!m.getAttribute("data-mce-bogus")){
return true
}
if(m.getAttribute("data-mce-type")==="bookmark"){
return true
}}
return false
}
if(u.settings.elementpath!==false){
c.on("select",function(m){
u.focus();
u.selection.select(this.row()[m.index].element);
u.nodeChanged()
}
);
u.on("nodeChange",function(y){
var m=[],p=y.parents,g=p.length;
while(g--){
if(p[g].nodeType==1&&!d(p[g])){
var f=u.fire("ResolveName",{
name:p[g].nodeName.toLowerCase(),target:p[g]}
);
if(!f.isDefaultPrevented()){
m.push({
name:f.name,element:p[g]}
)
}
if(f.isPropagationStopped()){
break
}}}
c.row(m)
}
)
}
return c._super()
}}
)
}
);
r("tinymce/ui/FormItem",["tinymce/ui/Container"],function(h){return h.extend({
Defaults:{
layout:"flex",align:"center",defaults:{
flex:1}}
,renderHtml:function(){
var l=this,c=l._layout,d=l.classPrefix;
l.classes.add("formitem");
c.preRender(l);
return('<div id="'+l._id+'" class="'+l.classes+'" hidefocus="1" tabindex="-1">'+(l.settings.title?('<div id="'+l._id+'-title" class="'+d+'title">'+l.settings.title+"</div>"):"")+'<div id="'+l._id+'-body" class="'+l.bodyClasses+'">'+(l.settings.html||"")+c.renderHtml(l)+"</div></div>")
}}
)
}
);
r("tinymce/ui/Form",["tinymce/ui/Container","tinymce/ui/FormItem","tinymce/util/Tools"],function(h,c,l){return h.extend({
Defaults:{
containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:20,labelGap:30,spacing:10,callbacks:{
submit:function(){
this.submit()
}}}
,preRender:function(){
var u=this,d=u.items();
if(!u.settings.formItemDefaults){
u.settings.formItemDefaults={
layout:"flex",autoResize:"overflow",defaults:{
flex:1}}
}
d.each(function(g){
var p,m,f=g.settings.label;
if(f){
m=g._id;
if(g.subinput){
m+="-"+g.ariaTarget
}
p=new c(l.extend({
items:{
type:"label",id:g._id+"-l",text:f,flex:0,forId:m,disabled:g.disabled()}}
,u.settings.formItemDefaults));
p.type="formitem";
g.aria("labelledby",g._id+"-l");
if(typeof g.settings.flex=="undefined"){
g.settings.flex=1
}
u.replace(g,p);
p.add(g)
}}
)
}
,submit:function(){
return this.fire("submit",{
data:this.toJSON()}
)
}
,postRender:function(){
var d=this;
d._super();
d.fromJSON(d.settings.data)
}
,bindStates:function(){
var u=this;
u._super();
function d(){
var g=0,y=[],f,p,m;
if(u.settings.labelGapCalc===false){
return
}
if(u.settings.labelGapCalc=="children"){
m=u.find("formitem")
}else{
m=u.items()
}
m.filter("formitem").each(function(v){
var w=v.items()[0],b=w.getEl().clientWidth;
g=b>g?b:g;
y.push(w)
}
);
p=u.settings.labelGap||0;
f=y.length;
while(f--){
y[f].settings.minWidth=g+p
}}
u.on("show",d);
d()
}}
)
}
);
r("tinymce/ui/FieldSet",["tinymce/ui/Form"],function(h){return h.extend({
Defaults:{
containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1}
,renderHtml:function(){
var l=this,c=l._layout,d=l.classPrefix;
l.preRender();
c.preRender(l);
return('<fieldset id="'+l._id+'" class="'+l.classes+'" hidefocus="1" tabindex="-1">'+(l.settings.title?('<legend id="'+l._id+'-title" class="'+d+'fieldset-title">'+l.settings.title+"</legend>"):"")+'<div id="'+l._id+'-body" class="'+l.bodyClasses+'">'+(l.settings.html||"")+c.renderHtml(l)+"</div></fieldset>")
}}
)
}
);
r("tinymce/ui/FilePicker",["tinymce/ui/ComboBox","tinymce/util/Tools"],function(l,h){return l.extend({
init:function(f){
var u=this,m=tinymce.activeEditor,d=m.settings;
var c,g,p;
f.spellcheck=false;
p=d.file_picker_types||d.file_browser_callback_types;
if(p){
p=h.makeMap(p,/[, ]/)
}
if(!p||p[f.filetype]){
g=d.file_picker_callback;
if(g&&(!p||p[f.filetype])){
c=function(){
var y=u.fire("beforecall").meta;
y=h.extend({
filetype:f.filetype}
,y);
g.call(m,function(b,w){
u.value(b).fire("change",{
meta:w}
)
}
,u.value(),y)
}
}else{
g=d.file_browser_callback;
if(g&&(!p||p[f.filetype])){
c=function(){
g(u.getEl("inp").id,u.value(),f.filetype,window)
}
}}}
if(c){
f.icon="browse";
f.onaction=c
}
u._super(f)
}}
)
}
);
r("tinymce/ui/FitLayout",["tinymce/ui/AbsoluteLayout"],function(h){return h.extend({
recalc:function(c){
var l=c.layoutRect(),d=c.paddingBox;
c.items().filter(":visible").each(function(u){
u.layoutRect({
x:d.left,y:d.top,w:l.innerW-d.right-d.left,h:l.innerH-d.top-d.bottom}
);
if(u.recalc){
u.recalc()
}}
)
}}
)
}
);
r("tinymce/ui/FlexLayout",["tinymce/ui/AbsoluteLayout"],function(h){return h.extend({
recalc:function(H){
var V,P,j,K,w,O,N,x,u,Z,m,v;
var U,d,f,g,b=[],y,B,G,F,M,Q;
var E,W,k,p,_e,I,q,Y;
var C,c,A,L,S,J;
var R,D;
var z=Math.max,X=Math.min;
j=H.items().filter(":visible");
K=H.layoutRect();
w=H.paddingBox;
O=H.settings;
v=H.isRtl()?(O.direction||"row-reversed"):O.direction;
N=O.align;
x=H.isRtl()?(O.pack||"end"):O.pack;
u=O.spacing||0;
if(v=="row-reversed"||v=="column-reverse"){
j=j.set(j.toArray().reverse());
v=v.split("-")[0]
}
if(v=="column"){
k="y";
E="h";
W="minH";
p="maxH";
I="innerH";
_e="top";
q="deltaH";
Y="contentH";
S="left";
A="w";
C="x";
c="innerW";
L="minW";
J="right";
R="deltaW";
D="contentW"
}else{
k="x";
E="w";
W="minW";
p="maxW";
I="innerW";
_e="left";
q="deltaW";
Y="contentW";
S="top";
A="h";
C="y";
c="innerH";
L="minH";
J="bottom";
R="deltaH";
D="contentH"
}
m=K[I]-w[_e]-w[_e];
Q=Z=0;
for(V=0,P=j.length;
V<P;
V++){
U=j[V];
d=U.layoutRect();
f=U.settings;
g=f.flex;
m-=(V<P-1?u:0);
if(g>0){
Z+=g;
if(d[p]){
b.push(U)
}
d.flex=g
}
m-=d[W];
y=w[S]+d[L]+w[J];
if(y>Q){
Q=y
}}
F={};
if(m<0){
F[W]=K[W]-m+K[q]
}else{
F[W]=K[I]-m+K[q]
}
F[L]=Q+K[R];
F[Y]=K[I]-m;
F[D]=Q;
F.minW=X(F.minW,K.maxW);
F.minH=X(F.minH,K.maxH);
F.minW=z(F.minW,K.startMinWidth);
F.minH=z(F.minH,K.startMinHeight);
if(K.autoResize&&(F.minW!=K.minW||F.minH!=K.minH)){
F.w=F.minW;
F.h=F.minH;
H.layoutRect(F);
this.recalc(H);
if(H._lastRect===null){
var T=H.parent();
if(T){
T._lastRect=null;
T.recalc()
}}
return
}
G=m/Z;
for(V=0,P=b.length;
V<P;
V++){
U=b[V];
d=U.layoutRect();
B=d[p];
y=d[W]+d.flex*G;
if(y>B){
m-=(d[p]-d[W]);
Z-=d.flex;
d.flex=0;
d.maxFlexSize=B
}else{
d.maxFlexSize=0
}}
G=m/Z;
M=w[_e];
F={};
if(Z===0){
if(x=="end"){
M=m+w[_e]
}else{
if(x=="center"){
M=Math.round((K[I]/2)-((K[I]-m)/2))+w[_e];
if(M<0){
M=w[_e]
}}else{
if(x=="justify"){
M=w[_e];
u=Math.floor(m/(j.length-1))
}}}}
F[C]=w[S];
for(V=0,P=j.length;
V<P;
V++){
U=j[V];
d=U.layoutRect();
y=d.maxFlexSize||d[W];
if(N==="center"){
F[C]=Math.round((K[c]/2)-(d[A]/2))
}else{
if(N==="stretch"){
F[A]=z(d[L]||0,K[c]-w[S]-w[J]);
F[C]=w[S]
}else{
if(N==="end"){
F[C]=K[c]-d[A]-w.top
}}}
if(d.flex>0){
y+=d.flex*G
}
F[E]=y;
F[k]=M;
U.layoutRect(F);
if(U.recalc){
U.recalc()
}
M+=y+u
}}}
)
}
);
r("tinymce/ui/FlowLayout",["tinymce/ui/Layout"],function(h){
return h.extend({
Defaults:{
containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"}
,recalc:function(l){
l.items().filter(":visible").each(function(c){
if(c.recalc){
c.recalc()
}}
)
}
,isNative:function(){
return true
}}
)
}
);
r("tinymce/ui/FormatControls",["tinymce/ui/Control","tinymce/ui/Widget","tinymce/ui/FloatPanel","tinymce/util/Tools","tinymce/EditorManager","tinymce/Env"],function(m,u,p,l,d,h){
var f=l.each;
d.on("AddEditor",function(g){
if(g.editor.rtl){
m.rtl=true
}
c(g.editor)
}
);
m.translate=function(g){
return d.translate(g)
};
u.tooltips=!h.iOS;
function c(k){
var g;
function x(j,z){
return function(){
var T=this;
k.on("nodeChange",function(W){
var O=k.formatter;
var A=null;
f(W.parents,function(B){
f(j,function(C){
if(z){
if(O.matchNode(B,z,{
value:C.value}
)){
A=C.value
}}else{
if(O.matchNode(B,C.value)){
A=C.value
}}
if(A){
return false
}}
);
if(A){
return false
}}
);
T.value(A)
}
)
}
}
function w(j){
j=j.replace(/;$/,"").split(";");
var z=j.length;
while(z--){
j[z]=j[z].split("=")
}
return j
}
function b(){
var A=0,O=[];
var T=[{
title:"Headings",items:[{
title:"Heading 1",format:"h1"}
,{
title:"Heading 2",format:"h2"}
,{
title:"Heading 3",format:"h3"}
,{
title:"Heading 4",format:"h4"}
,{
title:"Heading 5",format:"h5"}
,{
title:"Heading 6",format:"h6"}
]}
,{
title:"Inline",items:[{
title:"Bold",icon:"bold",format:"bold"}
,{
title:"Italic",icon:"italic",format:"italic"}
,{
title:"Underline",icon:"underline",format:"underline"}
,{
title:"Strikethrough",icon:"strikethrough",format:"strikethrough"}
,{
title:"Superscript",icon:"superscript",format:"superscript"}
,{
title:"Subscript",icon:"subscript",format:"subscript"}
,{
title:"Code",icon:"code",format:"code"}
]}
,{
title:"Blocks",items:[{
title:"Paragraph",format:"p"}
,{
title:"Blockquote",format:"blockquote"}
,{
title:"Div",format:"div"}
,{
title:"Pre",format:"pre"}
]}
,{
title:"Alignment",items:[{
title:"Left",icon:"alignleft",format:"alignleft"}
,{
title:"Center",icon:"aligncenter",format:"aligncenter"}
,{
title:"Right",icon:"alignright",format:"alignright"}
,{
title:"Justify",icon:"alignjustify",format:"alignjustify"}
]}
];
function j(W){
var B=[];
if(!W){
return
}
f(W,function(S){
var D={
text:S.title,icon:S.icon};
if(S.items){
D.menu=j(S.items)
}else{
var C=S.format||"custom"+A++;
if(!S.format){
S.name=C;
O.push(S)
}
D.format=C;
D.cmd=S.cmd
}
B.push(D)
}
);
return B
}
function z(){
var W;
if(k.settings.style_formats_merge){
if(k.settings.style_formats){
W=j(T.concat(k.settings.style_formats))
}else{
W=j(T)
}}else{
W=j(k.settings.style_formats||T)
}
return W
}
k.on("init",function(){
f(O,function(W){
k.formatter.register(W.name,W)
}
)
}
);
return{
type:"menu",items:z(),onPostRender:function(W){
k.fire("renderFormatsMenu",{
control:W.control}
)
}
,itemDefaults:{
preview:true,textStyle:function(){
if(this.settings.format){
return k.formatter.getCssText(this.settings.format)
}}
,onPostRender:function(){
var W=this;
W.parent().on("show",function(){
var B,C;
B=W.settings.format;
if(B){
W.disabled(!k.formatter.canApply(B));
W.active(k.formatter.match(B))
}
C=W.settings.cmd;
if(C){
W.active(k.queryCommandState(C))
}}
)
}
,onclick:function(){
if(this.settings.format){
y(this.settings.format)
}
if(this.settings.cmd){
k.execCommand(this.settings.cmd)
}}}}
}
g=b();
f({
bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"}
,function(z,j){
k.addButton(j,{
tooltip:z,onPostRender:function(){
var T=this;
if(k.formatter){
k.formatter.formatChanged(j,function(O){
T.active(O)
}
)
}else{
k.on("init",function(){
k.formatter.formatChanged(j,function(O){
T.active(O)
}
)
}
)
}}
,onclick:function(){
y(j)
}}
)
}
);
f({
outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],removeformat:["Clear formatting","RemoveFormat"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"]}
,function(z,j){
k.addButton(j,{
tooltip:z[0],cmd:z[1]}
)
}
);
f({
blockquote:["Blockquote","mceBlockQuote"],numlist:["Numbered list","InsertOrderedList"],bullist:["Bullet list","InsertUnorderedList"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"],alignnone:["No alignment","JustifyNone"]}
,function(z,j){
k.addButton(j,{
tooltip:z[0],cmd:z[1],onPostRender:function(){
var T=this;
if(k.formatter){
k.formatter.formatChanged(j,function(O){
T.active(O)
}
)
}else{
k.on("init",function(){
k.formatter.formatChanged(j,function(O){
T.active(O)
}
)
}
)
}}}
)
}
);
function v(j){
return function(){
var z=this;
j=j=="redo"?"hasRedo":"hasUndo";
function T(){
return k.undoManager?k.undoManager[j]():false
}
z.disabled(!T());
k.on("Undo Redo AddUndo TypingUndo ClearUndos",function(){
z.disabled(!T())
}
)
}
}
function q(){
var j=this;
k.on("VisualAid",function(z){
j.active(z.hasVisual)
}
);
j.active(k.hasVisual)
}
k.addButton("undo",{
tooltip:"Undo",onPostRender:v("undo"),cmd:"undo"}
);
k.addButton("redo",{
tooltip:"Redo",onPostRender:v("redo"),cmd:"redo"}
);
k.addMenuItem("newdocument",{
text:"New document",icon:"newdocument",cmd:"mceNewDocument"}
);
k.addMenuItem("undo",{
text:"Undo",icon:"undo",shortcut:"Meta+Z",onPostRender:v("undo"),cmd:"undo"}
);
k.addMenuItem("redo",{
text:"Redo",icon:"redo",shortcut:"Meta+Y",onPostRender:v("redo"),cmd:"redo"}
);
k.addMenuItem("visualaid",{
text:"Visual aids",selectable:true,onPostRender:q,cmd:"mceToggleVisualAid"}
);
k.addButton("remove",{
tooltip:"Remove",icon:"remove",cmd:"Delete"}
);
f({
cut:["Cut","Cut","Meta+X"],copy:["Copy","Copy","Meta+C"],paste:["Paste","Paste","Meta+V"],selectall:["Select all","SelectAll","Meta+A"],bold:["Bold","Bold","Meta+B"],italic:["Italic","Italic","Meta+I"],underline:["Underline","Underline"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"]}
,function(z,j){
k.addMenuItem(j,{
text:z[0],icon:j,shortcut:z[2],cmd:z[1]}
)
}
);
k.on("mousedown",function(){
p.hideAll()
}
);
function y(j){
if(j.control){
j=j.control.value()
}
if(j){
k.execCommand("mceToggleFormat",false,j)
}}
k.addButton("styleselect",{
type:"menubutton",text:"Formats",menu:g}
);
k.addButton("formatselect",function(){
var j=[],z=w(k.settings.block_formats||"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre");
f(z,function(T){
j.push({
text:T[0],value:T[1],textStyle:function(){
return k.formatter.getCssText(T[1])
}}
)
}
);
return{
type:"listbox",text:z[0][0],values:j,fixedWidth:true,onselect:y,onPostRender:x(j)}
}
);
k.addButton("fontselect",function(){
var z="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats";
var j=[],T=w(k.settings.font_formats||z);
f(T,function(O){
j.push({
text:{
raw:O[0]}
,value:O[1],textStyle:O[1].indexOf("dings")==-1?"font-family:"+O[1]:""}
)
}
);
return{
type:"listbox",text:"Font Family",tooltip:"Font Family",values:j,fixedWidth:true,onPostRender:x(j,"fontname"),onselect:function(O){
if(O.control.settings.value){
k.execCommand("FontName",false,O.control.settings.value)
}}}
}
);
k.addButton("fontsizeselect",function(){
var j=[],T="8pt 10pt 12pt 14pt 18pt 24pt 36pt";
var z=k.settings.fontsize_formats||T;
f(z.split(" "),function(A){
var B=A,W=A;
var O=A.split("=");
if(O.length>1){
B=O[0];
W=O[1]
}
j.push({
text:B,value:W}
)
}
);
return{
type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:j,fixedWidth:true,onPostRender:x(j,"fontsize"),onclick:function(O){
if(O.control.settings.value){
k.execCommand("FontSize",false,O.control.settings.value)
}}}
}
);
k.addMenuItem("formats",{
text:"Formats",menu:g}
)
}}
);
r("tinymce/ui/GridLayout",["tinymce/ui/AbsoluteLayout"],function(h){return h.extend({
recalc:function(C){
var U=C.settings,P,q,j,G,c,f,W,m,E,R,M,S,D,g,w,Y,v,p,u,L,T,z,I=[],l=[],O,J,b,k,F,K;
U=C.settings;
j=C.items().filter(":visible");
G=C.layoutRect();
q=U.columns||Math.ceil(Math.sqrt(j.length));
P=Math.ceil(j.length/q);
v=U.spacingH||U.spacing||0;
p=U.spacingV||U.spacing||0;
u=U.alignH||U.align;
L=U.alignV||U.align;
w=C.paddingBox;
F="reverseRows" in U?U.reverseRows:C.isRtl();
if(u&&typeof u=="string"){
u=[u]
}
if(L&&typeof L=="string"){
L=[L]
}
for(R=0;
R<q;
R++){
I.push(0)
}
for(M=0;
M<P;
M++){
l.push(0)
}
for(M=0;
M<P;
M++){
for(R=0;
R<q;
R++){
E=j[M*q+R];
if(!E){
break
}
m=E.layoutRect();
O=m.minW;
J=m.minH;
I[R]=O>I[R]?O:I[R];
l[M]=J>l[M]?J:l[M]
}}
b=G.innerW-w.left-w.right;
for(T=0,R=0;
R<q;
R++){
T+=I[R]+(R>0?v:0);
b-=(R>0?v:0)+I[R]
}
k=G.innerH-w.top-w.bottom;
for(z=0,M=0;
M<P;
M++){
z+=l[M]+(M>0?p:0);
k-=(M>0?p:0)+l[M]
}
T+=w.left+w.right;
z+=w.top+w.bottom;
W={};
W.minW=T+(G.w-G.innerW);
W.minH=z+(G.h-G.innerH);
W.contentW=W.minW-G.deltaW;
W.contentH=W.minH-G.deltaH;
W.minW=Math.min(W.minW,G.maxW);
W.minH=Math.min(W.minH,G.maxH);
W.minW=Math.max(W.minW,G.startMinWidth);
W.minH=Math.max(W.minH,G.startMinHeight);
if(G.autoResize&&(W.minW!=G.minW||W.minH!=G.minH)){
W.w=W.minW;
W.h=W.minH;
C.layoutRect(W);
this.recalc(C);
if(C._lastRect===null){
var A=C.parent();
if(A){
A._lastRect=null;
A.recalc()
}}
return
}
if(G.autoResize){
W=C.layoutRect(W);
W.contentW=W.minW-G.deltaW;
W.contentH=W.minH-G.deltaH
}
var B;
if(U.packV=="start"){
B=0
}else{
B=k>0?Math.floor(k/P):0
}
var N=0;
var d=U.flexWidths;
if(d){
for(R=0;
R<d.length;
R++){
N+=d[R]
}}else{
N=q
}
var H=b/N;
for(R=0;
R<q;
R++){
I[R]+=d?d[R]*H:H
}
D=w.top;
for(M=0;
M<P;
M++){
S=w.left;
f=l[M]+B;
for(R=0;
R<q;
R++){
if(F){
K=M*q+q-1-R
}else{
K=M*q+R
}
E=j[K];
if(!E){
break
}
g=E.settings;
m=E.layoutRect();
c=Math.max(I[R],m.startMinWidth);
m.x=S;
m.y=D;
Y=g.alignH||(u?(u[R]||u[0]):null);
if(Y=="center"){
m.x=S+(c/2)-(m.w/2)
}else{
if(Y=="right"){
m.x=S+c-m.w
}else{
if(Y=="stretch"){
m.w=c
}}}
Y=g.alignV||(L?(L[R]||L[0]):null);
if(Y=="center"){
m.y=D+(f/2)-(m.h/2)
}else{
if(Y=="bottom"){
m.y=D+f-m.h
}else{
if(Y=="stretch"){
m.h=f
}}}
E.layoutRect(m);
S+=c+v;
if(E.recalc){
E.recalc()
}}
D+=f+p
}}}
)
}
);
r("tinymce/ui/Iframe",["tinymce/ui/Widget"],function(h){return h.extend({
renderHtml:function(){
var l=this;
l.classes.add("iframe");
l.canFocus=false;
return('<iframe id="'+l._id+'" class="'+l.classes+'" tabindex="-1" src="'+(l.settings.url||"javascript:''")+'" frameborder="0"></iframe>')
}
,src:function(l){
this.getEl().src=l
}
,html:function(d,u){
var c=this,l=this.getEl().contentWindow.document.body;
if(!l){
setTimeout(function(){
c.html(d)
}
,0)
}else{
l.innerHTML=d;
if(u){
u()
}}
return this
}}
)
}
);
r("tinymce/ui/Label",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(l,h){return l.extend({
init:function(d){
var c=this;
c._super(d);
c.classes.add("widget").add("label");
c.canFocus=false;
if(d.multiline){
c.classes.add("autoscroll")
}
if(d.strong){
c.classes.add("strong")
}}
,initLayoutRect:function(){
var c=this,u=c._super();
if(c.settings.multiline){
var d=h.getSize(c.getEl());
if(d.width>u.maxW){
u.minW=u.maxW;
c.classes.add("multiline")
}
c.getEl().style.width=u.minW+"px";
u.startMinH=u.h=u.minH=Math.min(u.maxH,h.getSize(c.getEl()).height)
}
return u
}
,repaint:function(){
var c=this;
if(!c.settings.multiline){
c.getEl().style.lineHeight=c.layoutRect().h+"px"
}
return c._super()
}
,renderHtml:function(){
var d=this,c=d.settings.forId;
return('<label id="'+d._id+'" class="'+d.classes+'"'+(c?' for="'+c+'"':"")+">"+d.encode(d.state.get("text"))+"</label>")
}
,bindStates:function(){
var c=this;
c.state.on("change:text",function(d){
c.innerHtml(c.encode(d.value))
}
);
return c._super()
}}
)
}
);
r("tinymce/ui/MenuButton",["tinymce/ui/Button","tinymce/ui/Factory"],function(c,l){function h(m,u){
while(m){
if(u===m){
return true
}
m=m.parentNode
}
return false
}
var d=c.extend({
init:function(m){
var u=this;
u._renderOpen=true;
u._super(m);
m=u.settings;
u.classes.add("menubtn");
if(m.fixedWidth){
u.classes.add("fixed-width")
}
u.aria("haspopup",true);
u.state.set("menu",m.menu||u.render())
}
,showMenu:function(){
var u=this,m;
if(u.menu&&u.menu.visible()){
return u.hideMenu()
}
if(!u.menu){
m=u.state.get("menu")||[];
if(m.length){
m={
type:"menu",items:m}
}else{
m.type=m.type||"menu"
}
if(!m.renderTo){
u.menu=l.create(m).parent(u).renderTo()
}else{
u.menu=m.parent(u).show().renderTo()
}
u.fire("createmenu");
u.menu.reflow();
u.menu.on("cancel",function(f){
if(f.control.parent()===u.menu){
f.stopPropagation();
f.preventDefault();
u.focus();
u.hideMenu()
}}
);
u.menu.on("select",function(){
u.focus()
}
);
u.menu.on("show hide",function(f){
if(f.control==u.menu){
u.activeMenu(f.type=="show")
}
u.aria("expanded",f.type=="show")
}
).fire("show")
}
u.menu.show();
u.menu.layoutRect({
w:u.layoutRect().w}
);
u.menu.moveRel(u.getEl(),u.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])
}
,hideMenu:function(){
var u=this;
if(u.menu){
u.menu.items().each(function(m){
if(m.hideMenu){
m.hideMenu()
}}
);
u.menu.hide()
}}
,activeMenu:function(u){
this.classes.toggle("active",u)
}
,renderHtml:function(){
var u=this,b=u._id,p=u.classPrefix;
var m=u.settings.icon,g,y=u.state.get("text");
g=u.settings.image;
if(g){
m="none";
if(typeof g!="string"){
g=window.getSelection?g[0]:g[1]
}
g=" style=\"background-image: url('"+g+"')\""
}else{
g=""
}
m=u.settings.icon?p+"ico "+p+"i-"+m:"";
var f={
buttongroup:"button",toolbar:"button",menubar:"menuitem"};
u.aria("role",f[u.parent().type]||"combobox");
return('<div id="'+b+'" class="'+u.classes+'" tabindex="-1"><button id="'+b+'-open" role="presentation" type="button" tabindex="-1">'+(m?'<i class="'+m+'"'+g+"></i>":"")+(y?(m?"\u00a0":"")+u.encode(y):"")+' <i class="'+p+'caret"></i></button></div>')
}
,postRender:function(){
var u=this;
u.on("click",function(m){
if(m.control===u&&h(m.target,u.getEl())){
u.showMenu();
if(m.aria){
u.menu.items()[0].focus()
}}}
);
u.on("mouseenter",function(g){
var m=g.control,p=u.parent(),f;
if(m&&p&&m instanceof d&&m.parent()==p){
p.items().filter("MenuButton").each(function(y){
if(y.hideMenu&&y!=m){
if(y.menu&&y.menu.visible()){
f=true
}
y.hideMenu()
}}
);
if(f){
m.focus();
m.showMenu()
}}}
);
return u._super()
}
,bindStates:function(){
var u=this;
u.state.on("change:menu",function(){
if(u.menu){
u.menu.remove()
}
u.menu=null
}
);
return u._super()
}
,remove:function(){
this._super();
if(this.menu){
this.menu.remove()
}}}
);
return d
}
);
r("tinymce/ui/MenuItem",["tinymce/ui/Widget","tinymce/ui/Factory","tinymce/Env"],function(c,h,l){return c.extend({
Defaults:{
border:0,role:"menuitem"}
,init:function(u){
var d=this,m;
d._super(u);
u=d.settings;
d.classes.add("menu-item");
if(u.menu){
d.classes.add("menu-item-expand")
}
if(u.preview){
d.classes.add("menu-item-preview")
}
m=d.state.get("text");
if(m==="-"||m==="|"){
d.classes.add("menu-item-sep");
d.aria("role","separator");
d.state.set("text","-")
}
if(u.selectable){
d.aria("role","menuitemcheckbox");
d.classes.add("menu-item-checkbox");
u.icon="selected"
}
if(!u.preview&&!u.selectable){
d.classes.add("menu-item-normal")
}
d.on("mousedown",function(f){
f.preventDefault()
}
);
if(u.menu&&!u.ariaHideMenu){
d.aria("haspopup",true)
}}
,hasMenus:function(){
return !!this.settings.menu
}
,showMenu:function(){
var u=this,f=u.settings,p,m=u.parent();
m.items().each(function(g){
if(g!==u){
g.hideMenu()
}}
);
if(f.menu){
p=u.menu;
if(!p){
p=f.menu;
if(p.length){
p={
type:"menu",items:p}
}else{
p.type=p.type||"menu"
}
if(m.settings.itemDefaults){
p.itemDefaults=m.settings.itemDefaults
}
p=u.menu=h.create(p).parent(u).renderTo();
p.reflow();
p.on("cancel",function(g){
g.stopPropagation();
u.focus();
p.hide()
}
);
p.on("show hide",function(g){
g.control.items().each(function(y){
y.active(y.settings.selected)
}
)
}
).fire("show");
p.on("hide",function(g){
if(g.control===p){
u.classes.remove("selected")
}}
);
p.submenu=true
}else{
p.show()
}
p._parentMenu=m;
p.classes.add("menu-sub");
var d=p.testMoveRel(u.getEl(),u.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);
p.moveRel(u.getEl(),d);
p.rel=d;
d="menu-sub-"+d;
p.classes.remove(p._lastRel).add(d);
p._lastRel=d;
u.classes.add("selected");
u.aria("expanded",true)
}}
,hideMenu:function(){
var d=this;
if(d.menu){
d.menu.items().each(function(u){
if(u.hideMenu){
u.hideMenu()
}}
);
d.menu.hide();
d.aria("expanded",false)
}
return d
}
,renderHtml:function(){
var w=this,d=w._id,f=w.settings,g=w.classPrefix,b=w.encode(w.state.get("text"));
var y=w.settings.icon,m="",p=f.shortcut;
function u(v){
var x,q,k={};
if(l.mac){
k={
alt:"&#x2325;",ctrl:"&#x2318;",shift:"&#x21E7;",meta:"&#x2318;"}
}else{
k={
meta:"Ctrl"}
}
v=v.split("+");
for(x=0;
x<v.length;
x++){
q=k[v[x].toLowerCase()];
if(q){
v[x]=q
}}
return v.join("+")
}
if(y){
w.parent().classes.add("menu-has-icons")
}
if(f.image){
y="none";
m=" style=\"background-image: url('"+f.image+"')\""
}
if(p){
p=u(p)
}
y=g+"ico "+g+"i-"+(w.settings.icon||"none");
return('<div id="'+d+'" class="'+w.classes+'" tabindex="-1">'+(b!=="-"?'<i class="'+y+'"'+m+"></i>\u00a0":"")+(b!=="-"?'<span id="'+d+'-text" class="'+g+'text">'+b+"</span>":"")+(p?'<div id="'+d+'-shortcut" class="'+g+'menu-shortcut">'+p+"</div>":"")+(f.menu?'<div class="'+g+'caret"></div>':"")+"</div>")
}
,postRender:function(){
var u=this,m=u.settings;
var f=m.textStyle;
if(typeof f=="function"){
f=f.call(this)
}
if(f){
var d=u.getEl("text");
if(d){
d.setAttribute("style",f)
}}
u.on("mouseenter click",function(p){
if(p.control===u){
if(!m.menu&&p.type==="click"){
u.fire("select");
u.parent().hideAll()
}else{
u.showMenu();
if(p.aria){
u.menu.focus(true)
}}}}
);
u._super();
return u
}
,active:function(d){
if(typeof d!="undefined"){
this.aria("checked",d)
}
return this._super(d)
}
,remove:function(){
this._super();
if(this.menu){
this.menu.remove()
}}}
)
}
);
r("tinymce/ui/Menu",["tinymce/ui/FloatPanel","tinymce/ui/MenuItem","tinymce/util/Tools"],function(d,c,h){var l=d.extend({
Defaults:{
defaultType:"menuitem",border:1,layout:"stack",role:"application",bodyRole:"menu",ariaRoot:true}
,init:function(p){
var m=this;
p.autohide=true;
p.constrainToViewport=true;
if(p.itemDefaults){
var u=p.items,f=u.length;
while(f--){
u[f]=h.extend({}
,p.itemDefaults,u[f])
}}
m._super(p);
m.classes.add("menu")
}
,repaint:function(){
this.classes.toggle("menu-align",true);
this._super();
this.getEl().style.height="";
this.getEl("body").style.height="";
return this
}
,cancel:function(){
var u=this;
u.hideAll();
u.fire("select")
}
,hideAll:function(){
var u=this;
this.find("menuitem").exec("hideMenu");
return u._super()
}
,preRender:function(){
var u=this;
u.items().each(function(f){
var m=f.settings;
if(m.icon||m.image||m.selectable){
u._hasIcons=true;
return false
}}
);
return u._super()
}}
);
return l
}
);
r("tinymce/ui/ListBox",["tinymce/ui/MenuButton","tinymce/ui/Menu"],function(l,h){return l.extend({
init:function(f){
var u=this,d,m,g,c;
function p(y){
for(var b=0;
b<y.length;
b++){
m=y[b].selected||f.value===y[b].value;
if(m){
g=g||y[b].text;
u.state.set("value",y[b].value);
return true
}
if(y[b].menu){
if(p(y[b].menu)){
return true
}}}}
u._super(f);
f=u.settings;
u._values=d=f.values;
if(d){
if(typeof f.value!="undefined"){
p(d)
}
if(!m&&d.length>0){
g=d[0].text;
u.state.set("value",d[0].value)
}
u.state.set("menu",d)
}
u.state.set("text",f.text||g||d[0].text);
u.classes.add("listbox");
u.on("select",function(b){
var y=b.control;
if(c){
b.lastControl=c
}
if(f.multiple){
y.active(!y.active())
}else{
u.value(b.control.value())
}
c=y
}
)
}
,bindStates:function(){
var c=this;
function u(f,m){
if(f instanceof h){
f.items().each(function(p){
if(!p.hasMenus()){
p.active(p.value()===m)
}}
)
}}
function d(m,g){
var p;
if(!m){
return
}
for(var f=0;
f<m.length;
f++){
if(m[f].value===g){
return m[f]
}
if(m[f].menu){
p=d(m[f].menu,g);
if(p){
return p
}}}}
c.on("show",function(m){
u(m.control,c.value())
}
);
c.state.on("change:value",function(f){
var m=d(c.state.get("menu"),f.value);
if(m){
c.text(m.text)
}else{
c.text(c.settings.text)
}}
);
return c._super()
}}
)
}
);
r("tinymce/ui/Toolbar",["tinymce/ui/Container"],function(h){return h.extend({
Defaults:{
role:"toolbar",layout:"flow"}
,init:function(c){
var l=this;
l._super(c);
l.classes.add("toolbar")
}
,postRender:function(){
var l=this;
l.items().each(function(c){
c.classes.add("toolbar-item")
}
);
return l._super()
}}
)
}
);
r("tinymce/ui/MenuBar",["tinymce/ui/Toolbar"],function(h){return h.extend({
Defaults:{
role:"menubar",containerCls:"menubar",ariaRoot:true,defaults:{
type:"menubutton"}}}
)
}
);
r("tinymce/ui/Radio",["tinymce/ui/Checkbox"],function(h){return h.extend({
Defaults:{
classes:"radio",role:"radio"}}
)
}
);
r("tinymce/ui/Rect",[],function(){var u=Math.min,l=Math.max,d=Math.round;
function c(q,g,O){
var z,k,T,v,j,b;
z=g.x;
k=g.y;
T=q.w;
v=q.h;
j=g.w;
b=g.h;
O=(O||"").split("");
if(O[0]==="b"){
k+=b
}
if(O[1]==="r"){
z+=j
}
if(O[0]==="c"){
k+=d(b/2)
}
if(O[1]==="c"){
z+=d(j/2)
}
if(O[3]==="b"){
k-=v
}
if(O[4]==="r"){
z-=T
}
if(O[3]==="c"){
k-=d(v/2)
}
if(O[4]==="c"){
z-=d(T/2)
}
return{
x:z,y:k,w:T,h:v}
}
function m(w,v,b,g){
var k,y;
for(y=0;
y<g.length;
y++){
k=c(w,v,g[y]);
if(k.x>=b.x&&k.x+k.w<=b.w+b.x&&k.y>=b.y&&k.y+k.h<=b.h+b.y){
return g[y]
}}}
function p(b,g,y){
return{
x:b.x-g,y:b.y-y,w:b.w+g*2,h:b.h+y*2}
}
function h(b,g){
var w,k,y,v;
w=l(b.x,g.x);
k=l(b.y,g.y);
y=u(b.x+b.w,g.x+g.w);
v=u(b.y+b.h,g.y+g.h);
if(y-w<0||v-k<0){
return null
}
return{
x:w,y:k,w:y-w,h:v-k}
}
function f(O,T,g){
var j,k,x,w,b,A,y,z,q,v;
b=O.x;
A=O.y;
y=O.x+O.w;
z=O.y+O.h;
q=T.x+T.w;
v=T.y+T.h;
j=l(0,T.x-b);
k=l(0,T.y-A);
x=l(0,y-q);
w=l(0,z-v);
b+=j;
A+=k;
if(g){
y+=j;
z+=k;
b-=x;
A-=w
}
y-=x;
z-=w;
return{
x:b,y:A,w:y-b,h:z-A}
}
return{
inflate:p,relativePosition:c,findBestRelativePosition:m,intersect:h,clamp:f}
}
);
r("tinymce/ui/ResizeHandle",["tinymce/ui/Widget","tinymce/ui/DragHelper"],function(l,h){return l.extend({
renderHtml:function(){
var c=this,d=c.classPrefix;
c.classes.add("resizehandle");
if(c.settings.direction=="both"){
c.classes.add("resizehandle-both")
}
c.canFocus=false;
return('<div id="'+c._id+'" class="'+c.classes+'"><i class="'+d+"ico "+d+'i-resize"></i></div>')
}
,postRender:function(){
var c=this;
c._super();
c.resizeDragHelper=new h(this._id,{
start:function(){
c.fire("ResizeStart")
}
,drag:function(d){
if(c.settings.direction!="both"){
d.deltaX=0
}
c.fire("Resize",d)
}
,stop:function(){
c.fire("ResizeEnd")
}}
)
}
,remove:function(){
if(this.resizeDragHelper){
this.resizeDragHelper.destroy()
}
return this._super()
}}
)
}
);
r("tinymce/ui/Slider",["tinymce/ui/Widget","tinymce/ui/DragHelper","tinymce/ui/DomUtils"],function(d,c,l){function u(f,m,p){
if(f<m){
f=m
}
if(f>p){
f=p
}
return f
}
function h(w,b){
var y,g,f,p,m;
if(w.settings.orientation=="v"){
p="top";
f="height";
g="h"
}else{
p="left";
f="width";
g="w"
}
y=(w.layoutRect()[g]||100)-l.getSize(w.getEl("handle"))[f];
m=(y*((b-w._minValue)/(w._maxValue-w._minValue)))+"px";
w.getEl("handle").style[p]=m;
w.getEl("handle").style.height=w.layoutRect().h+"px"
}
return d.extend({
init:function(f){
var m=this;
if(!f.previewFilter){
f.previewFilter=function(p){
return Math.round(p*100)/100
}
}
m._super(f);
m.classes.add("slider");
if(f.orientation=="v"){
m.classes.add("vertical")
}
m._minValue=f.minValue||0;
m._maxValue=f.maxValue||100;
m._initValue=m.state.get("value")
}
,renderHtml:function(){
var m=this,p=m._id,f=m.classPrefix;
return('<div id="'+p+'" class="'+m.classes+'"><div id="'+p+'-handle" class="'+f+'slider-handle"></div></div>')
}
,reset:function(){
this.value(this._initValue).repaint()
}
,postRender:function(){
var q=this,w,j,m=0,x,k,y,b;
var f,v,g,p;
k=q._minValue;
y=q._maxValue;
x=q.value();
if(q.settings.orientation=="v"){
f="screenY";
v="top";
g="height";
p="h"
}else{
f="screenX";
v="left";
g="width";
p="w"
}
q._super();
q._dragHelper=new c(q._id,{
handle:q._id+"-handle",start:function(z){
w=z[f];
j=parseInt(q.getEl("handle").style[v],10);
b=(q.layoutRect()[p]||100)-l.getSize(q.getEl("handle"))[g];
q.fire("dragstart",{
value:x}
)
}
,drag:function(T){
var O=T[f]-w,z=q.getEl("handle");
m=u(j+O,0,b);
z.style[v]=m+"px";
x=k+(m/b)*(y-k);
q.value(x);
q.tooltip().text(""+q.settings.previewFilter(x)).show().moveRel(z,"bc tc");
q.fire("drag",{
value:x}
)
}
,stop:function(){
q.tooltip().hide();
q.fire("dragend",{
value:x}
)
}}
)
}
,repaint:function(){
this._super();
h(this,this.value())
}
,bindStates:function(){
var m=this;
m.state.on("change:value",function(f){
h(m,f.value)
}
);
return m._super()
}}
)
}
);
r("tinymce/ui/Spacer",["tinymce/ui/Widget"],function(h){return h.extend({
renderHtml:function(){
var l=this;
l.classes.add("spacer");
l.canFocus=false;
return'<div id="'+l._id+'" class="'+l.classes+'"></div>'
}}
)
}
);
r("tinymce/ui/SplitButton",["tinymce/ui/MenuButton","tinymce/ui/DomUtils","tinymce/dom/DomQuery"],function(c,h,l){
return c.extend({
Defaults:{
classes:"widget btn splitbtn",role:"button"}
,repaint:function(){
var d=this,p=d.getEl(),m=d.layoutRect(),u,f;
d._super();
u=p.firstChild;
f=p.lastChild;
l(u).css({
width:m.w-h.getSize(f).width,height:m.h-2}
);
l(f).css({
height:m.h-2}
);
return d
}
,activeMenu:function(u){
var d=this;
l(d.getEl().lastChild).toggleClass(d.classPrefix+"active",u)
}
,renderHtml:function(){
var d=this,g=d._id,m=d.classPrefix,f;
var u=d.state.get("icon"),p=d.state.get("text");
f=d.settings.image;
if(f){
u="none";
if(typeof f!="string"){
f=window.getSelection?f[0]:f[1]
}
f=" style=\"background-image: url('"+f+"')\""
}else{
f=""
}
u=d.settings.icon?m+"ico "+m+"i-"+u:"";
return('<div id="'+g+'" class="'+d.classes+'" role="button" tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">'+(u?'<i class="'+u+'"'+f+"></i>":"")+(p?(u?" ":"")+p:"")+'</button><button type="button" class="'+m+'open" hidefocus="1" tabindex="-1">'+(d._menuBtnText?(u?"\u00a0":"")+d._menuBtnText:"")+' <i class="'+m+'caret"></i></button></div>')
}
,postRender:function(){
var d=this,u=d.settings.onclick;
d.on("click",function(f){
var m=f.target;
if(f.control==this){
while(m){
if((f.aria&&f.aria.key!="down")||(m.nodeName=="BUTTON"&&m.className.indexOf("open")==-1)){
f.stopImmediatePropagation();
if(u){
u.call(this,f)
}
return
}
m=m.parentNode
}}}
);
delete d.settings.onclick;
return d._super()
}}
)
}
);
r("tinymce/ui/StackLayout",["tinymce/ui/FlowLayout"],function(h){return h.extend({
Defaults:{
containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"}
,isNative:function(){
return true
}}
)
}
);
r("tinymce/ui/TabPanel",["tinymce/ui/Panel","tinymce/dom/DomQuery","tinymce/ui/DomUtils"],function(c,l,h){return c.extend({
Defaults:{
layout:"absolute",defaults:{
type:"panel"}}
,activateTab:function(d){
var u;
if(this.activeTabId){
u=this.getEl(this.activeTabId);
l(u).removeClass(this.classPrefix+"active");
u.setAttribute("aria-selected","false")
}
this.activeTabId="t"+d;
u=this.getEl("t"+d);
u.setAttribute("aria-selected","true");
l(u).addClass(this.classPrefix+"active");
this.items()[d].show().fire("showtab");
this.reflow();
this.items().each(function(f,m){
if(d!=m){
f.hide()
}}
)
}
,renderHtml:function(){
var u=this,m=u._layout,d="",f=u.classPrefix;
u.preRender();
m.preRender(u);
u.items().each(function(g,p){
var y=u._id+"-t"+p;
g.aria("role","tabpanel");
g.aria("labelledby",y);
d+=('<div id="'+y+'" class="'+f+'tab" unselectable="on" role="tab" aria-controls="'+g._id+'" aria-selected="false" tabIndex="-1">'+u.encode(g.settings.title)+"</div>")
}
);
return('<div id="'+u._id+'" class="'+u.classes+'" hidefocus="1" tabindex="-1"><div id="'+u._id+'-head" class="'+f+'tabs" role="tablist">'+d+'</div><div id="'+u._id+'-body" class="'+u.bodyClasses+'">'+m.renderHtml(u)+"</div></div>")
}
,postRender:function(){
var d=this;
d._super();
d.settings.activeTab=d.settings.activeTab||0;
d.activateTab(d.settings.activeTab);
this.on("click",function(f){
var m=f.target.parentNode;
if(f.target.parentNode.id==d._id+"-head"){
var u=m.childNodes.length;
while(u--){
if(m.childNodes[u]==f.target){
d.activateTab(u)
}}}}
)
}
,initLayoutRect:function(){
var u=this,p,d,f;
d=h.getSize(u.getEl("head")).width;
d=d<0?0:d;
f=0;
u.items().each(function(g){
d=Math.max(d,g.layoutRect().minW);
f=Math.max(f,g.layoutRect().minH)
}
);
u.items().each(function(g){
g.settings.x=0;
g.settings.y=0;
g.settings.w=d;
g.settings.h=f;
g.layoutRect({
x:0,y:0,w:d,h:f}
)
}
);
var m=h.getSize(u.getEl("head")).height;
u.settings.minWidth=d;
u.settings.minHeight=f+m;
p=u._super();
p.deltaH+=m;
p.innerH=p.h-p.deltaH;
return p
}}
)
}
);
r("tinymce/ui/TextBox",["tinymce/ui/Widget"],function(h){return h.extend({
init:function(c){
var l=this;
l._super(c);
l.classes.add("textbox");
if(c.multiline){
l.classes.add("multiline")
}else{
l.on("keydown",function(u){
var d;
if(u.keyCode==13){
u.preventDefault();
l.parents().reverse().each(function(m){
if(m.toJSON){
d=m;
return false
}}
);
l.fire("submit",{
data:d.toJSON()}
)
}}
);
l.on("keyup",function(d){
l.state.set("value",d.target.value)
}
)
}}
,repaint:function(){
var c=this,u,m,g,d=0,f=0,l;
u=c.getEl().style;
m=c._layoutRect;
l=c._lastRepaintRect||{};
var p=document;
if(!c.settings.multiline&&p.all&&(!p.documentMode||p.documentMode<=8)){
u.lineHeight=(m.h-f)+"px"
}
g=c.borderBox;
d=g.left+g.right+8;
f=g.top+g.bottom+(c.settings.multiline?8:0);
if(m.x!==l.x){
u.left=m.x+"px";
l.x=m.x
}
if(m.y!==l.y){
u.top=m.y+"px";
l.y=m.y
}
if(m.w!==l.w){
u.width=(m.w-d)+"px";
l.w=m.w
}
if(m.h!==l.h){
u.height=(m.h-f)+"px";
l.h=m.h
}
c._lastRepaintRect=l;
c.fire("repaint",{}
,false);
return c
}
,renderHtml:function(){
var l=this,m=l._id,c=l.settings,u=l.encode(l.state.get("value"),false),d="";
if("spellcheck" in c){
d+=' spellcheck="'+c.spellcheck+'"'
}
if(c.maxLength){
d+=' maxlength="'+c.maxLength+'"'
}
if(c.size){
d+=' size="'+c.size+'"'
}
if(c.subtype){
d+=' type="'+c.subtype+'"'
}
if(l.disabled()){
d+=' disabled="disabled"'
}
if(c.multiline){
return('<textarea id="'+m+'" class="'+l.classes+'" '+(c.rows?' rows="'+c.rows+'"':"")+' hidefocus="1"'+d+">"+u+"</textarea>")
}
return'<input id="'+m+'" class="'+l.classes+'" value="'+u+'" hidefocus="1"'+d+" />"
}
,value:function(l){
if(arguments.length){
this.state.set("value",l);
return this
}
if(this.state.get("rendered")){
this.state.set("value",this.getEl().value)
}
return this.state.get("value")
}
,postRender:function(){
var l=this;
l._super();
l.$el.on("change",function(c){
l.state.set("value",c.target.value);
l.fire("change",c)
}
)
}
,bindStates:function(){
var l=this;
l.state.on("change:value",function(c){
if(l.getEl().value!=c.value){
l.getEl().value=c.value
}}
);
l.state.on("change:disabled",function(c){
l.getEl().disabled=c.value
}
);
return l._super()
}
,remove:function(){
this.$el.off();
this._super()
}}
)
}
);
r("tinymce/ui/Throbber",["tinymce/dom/DomQuery","tinymce/ui/Control"],function(l,h){return function(f,m){
var d=this,u,c=h.classPrefix;
d.show=function(p,g){
d.hide();
u=true;
window.setTimeout(function(){
if(u){
l(f).append('<div class="'+c+"throbber"+(m?" "+c+"throbber-inline":"")+'"></div>');
if(g){
g()
}}}
,p||0);
return d
};
d.hide=function(){
var p=f.lastChild;
if(p&&p.className.indexOf("throbber")!=-1){
p.parentNode.removeChild(p)
}
u=false;
return d
}
}
}
);
e(["tinymce/dom/EventUtils","tinymce/dom/Sizzle","tinymce/Env","tinymce/util/Tools","tinymce/dom/DomQuery","tinymce/html/Styles","tinymce/dom/TreeWalker","tinymce/html/Entities","tinymce/dom/DOMUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/dom/RangeUtils","tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/html/DomParser","tinymce/html/Writer","tinymce/html/Serializer","tinymce/dom/Serializer","tinymce/util/VK","tinymce/dom/ControlSelection","tinymce/dom/BookmarkManager","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EditorCommands","tinymce/util/URI","tinymce/util/Class","tinymce/util/EventDispatcher","tinymce/util/Observable","tinymce/ui/Selector","tinymce/ui/Collection","tinymce/ui/ReflowQueue","tinymce/ui/Control","tinymce/ui/Factory","tinymce/ui/KeyboardNavigation","tinymce/ui/Container","tinymce/ui/DragHelper","tinymce/ui/Scrollable","tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/FloatPanel","tinymce/ui/Window","tinymce/ui/MessageBox","tinymce/WindowManager","tinymce/EditorObservable","tinymce/Shortcuts","tinymce/util/Promise","tinymce/Editor","tinymce/util/I18n","tinymce/FocusManager","tinymce/EditorManager","tinymce/util/XHR","tinymce/util/JSON","tinymce/util/JSONRequest","tinymce/util/JSONP","tinymce/util/LocalStorage","tinymce/Compat","tinymce/ui/Layout","tinymce/ui/AbsoluteLayout","tinymce/ui/Tooltip","tinymce/ui/Widget","tinymce/ui/Button","tinymce/ui/ButtonGroup","tinymce/ui/Checkbox","tinymce/ui/ComboBox","tinymce/ui/ColorBox","tinymce/ui/PanelButton","tinymce/ui/ColorButton","tinymce/util/Color","tinymce/ui/ColorPicker","tinymce/ui/Path","tinymce/ui/ElementPath","tinymce/ui/FormItem","tinymce/ui/Form","tinymce/ui/FieldSet","tinymce/ui/FilePicker","tinymce/ui/FitLayout","tinymce/ui/FlexLayout","tinymce/ui/FlowLayout","tinymce/ui/FormatControls","tinymce/ui/GridLayout","tinymce/ui/Iframe","tinymce/ui/Label","tinymce/ui/MenuButton","tinymce/ui/MenuItem","tinymce/ui/Menu","tinymce/ui/ListBox","tinymce/ui/Toolbar","tinymce/ui/MenuBar","tinymce/ui/Radio","tinymce/ui/Rect","tinymce/ui/ResizeHandle","tinymce/ui/Slider","tinymce/ui/Spacer","tinymce/ui/SplitButton","tinymce/ui/StackLayout","tinymce/ui/TabPanel","tinymce/ui/TextBox","tinymce/ui/Throbber"])
}
)(this)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.locales")){
tinyMCE.locale_list=["en","ar","da","de","en_AU","en_GB","es","eu","fr_CA","fr_FR","hi","hu_HU","id","it","iw","ja","ko_KR","lo","ms","nl","pl","pt_BR","pt_PT","ro","ru","sl_SI","sv_SE","th_TH","tr_TR","uk_UA","zh_CN","zh_HK","zh_TW"]
}
if(AjxPackage.define("ajax.3rdparty.tinymce.localeconv")){
tinyMCE.getlanguage=function(e){
if(tinymce.inArray(tinyMCE.locale_list,e)>=0){
return e
}
var o=e.split("_",1)[0];
if(tinymce.inArray(tinyMCE.locale_list,o)>=0){
return o
}
if(e==="zh_HK"&&tinymce.inArray(tinyMCE.locale_list,"zh_TW")>=0){
return"zh_TW"
}
for(var t=0,a=tinyMCE.locale_list.length;
t<a;
t++){
if(tinyMCE.locale_list[t].substr(0,2)===o){
return tinyMCE.locale_list[t]
}}
return"en"
}
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.zemoticons.data")){
tinyMCE.emoticon_map={
cool:"data:image/gif;base64,R0lGODlhEgASANQVAAsJBZF6DszMy+HJE4aGhFxWFNzSPLOYFe7u7b6pTjo4FvXYFL64ntG/I1tbV+vpWSMhGt7TMb+mLC8vLN3b1fr6+vzoICYKAsm/YvjuQfz5X3pgCqSMC8GoFhcVDQAAACH5BAEAAB8ALAAAAAASABIAAAXf4CeKVWmWY0pSycFxR0JVKokd0aNpT3RgtBRC0tlljpldR4IYVVoYQ6RxnBpuCRoBAlAUFABAoeDpfj0eAgFAcEzeEwWYQXg7AA4BZALxQPoSEX59ex4UFBsecn0BCwMcaHIeBQgUHD0NAwMLjpoDHQMPBwgIBw8Wj5yqCxybGR2kCREZCwEbm44bjRkRCQgVDEUWCxsXxhcbCxYaHQwlCAkNGhYWHQEBHdQaDb40FQISDQ8Z1NQZDw0SAkEfCAIJHbNGER0JAk0pFRQMCURLCQxm1PhQoZKAgwIo/EoRAgA7",cry:"data:image/gif;base64,R0lGODlhEgASANQYAC4TAi6K8rOWC76rUNzQMsGrIbKzk/bxT6W60f7pI9rmct7i57CXIc+7H/rxOPjcFXJYCsrCnp3D86Gxe9jWtbjGsFI+Cox2Efb29sq2auLugsba8sbGxlqi8v36agAAACH5BAEAAB8ALAAAAAASABIAAAXG4CeKWGmWY0pSAyMIzEBhKpkJxOF5ByFktBSGUdgRHA7CrsAIfjCDBq9wQRIdnsaAhqEIPI4r0sHECmZQZXK9PnoI2+HhgLxYkJaqY97EfJENAAAFBYICDw8HAiUCGhsUEwgZiBUVExQbCosYBQESiKChDxIBBSUDEw6iog4TcREdEgmIEIIQiAkSHRElCwENBwkXAg0NFxcJBw0BC1wIBcAOCdMJew0FCEGkEgMFOTs9BQPbI80LBt2E4gbmNb0c8BzNTh8hADs=",embarassed:"data:image/gif;base64,R0lGODlhEgASANQSACoOAsS8naqRFfrTG8CpTPzRVNS/KP7mILmbEfykQfnuVMKrIdra2frvOv35bOLCOnZbF493G/b29lg4D8bGxuHTN5ZkJKx8KPu/Kv7ZPeDYurybJP6OV8KwYv62UQAAACH5BAEAAB8ALAAAAAASABIAAAXI4CeKUmmWY0pqxCYIG6FJKtkhj+I4yoN0tJRks+BVGo2KbrEJfiSEYmMRQQoWDceCQJNoEI4GDIlcCLKIGVSZjECQ7qOiwpUgFIpMBjJBTiZ6eE12DgUeHhcWBwMRFgkJGAoIJQiGHByQAwMYCZcJBZNDlpgYmpyeBYMEDwWPpZqbjwUPdQELeRgCEwAAExcYGQoLASUMBAYKB8rLygoGBAxdDAvIDcwNzgvRIxIMHQtKO3MLHdtCDAFRC+sEAeYqxRTyFNFOHyEAOw==","foot-in-mouth":"data:image/gif;base64,R0lGODlhEgASAPQfALmbHMbGxpZ+D/bZEsq2avrsILicDe/v7sCsTVI6Cfj2WtG9HtzQMW1UC7qiK/nzSPr6+uDYuvz6b8S8neHbT5uKJ8KqF9fX1v76NtPEMDoiAqeKCuvdNiYKAvvuNwAAACH5BAUAAB8ALAAAAAASABIAQAXT4CeKUGmWo3gYEuY2TTHAQ60YxwhdE+JYFgdicoGkIIiFpOLgeJ6OimSBMEImFsWiw+VqBImFwjIxkgiGDEUioWQMBPMHyVC8EneXglE9ABQeNYIGDQYaCQMPADk7DmIYBQsLAg0UCw5FKXMRCAAbGwAIEXIjBz8KCBUcHBUIYw45mywPHBkZT7YcDxIGo34KDy4JeBjDLg8KiystkILONQ84BwgMgRsCGw1chA0efAcQ02LDGxodAhYCD1TgKhcIFgzIwBkWCBexRwcXAf0B+KRCAAA7",frown:"data:image/gif;base64,R0lGODlhEgASANQRAEEnBcbGxqCCCPPVD93PMsq2ar+qTu/v7vPxWM69IvzvN2hUErebDb+jLf79cfzlGVpBCvr6+uDYuvryR8SrFcS8ndfX1v75N/76Wu7aIrmbHPjdFPnpJXhgENLCMAAAACH5BAEAAB8ALAAAAAASABIAAAXR4CeKUWmWY0pKhiYImiFFKlkwHuI4iMcUtNShQUFgJgrFBIOgNA6jiCHhmHg8yevEkTDQIhJGVbGAJMtKB2MmJWAuFwgALodjCN6DBjGBdxZ+gBcTCBoHB2JwFwoZHBsDkBsbGAyHiReOkJqRE5V6CAqSFHIAEBSSDxOGBwYEoQylHR1yDBsKeAcRFRQYGQIbD8EPGwIZGBQVJawJCBzCwhwIXbkfERYNzJjBHBfSDRZBHwcWBhQES0cEFAYWUCnWFQZETgYV4DXV4wH7Ae3hHyEAOw==",innocent:"data:image/gif;base64,R0lGODlhEgASANQSADgqCNzLrejNEqlxBsuxjc7OWsGTVe/t7LOPDvnbE7+lFsrCoP32OHdpFdmrGvPvVNHR0cy1IPr6+v39cb+oTt7GKmFLCop6GvznHbqQML+jLf76Vtq+Qt/WMrJ1IgAAACH5BAEAAB8ALAAAAAASABIAAAXN4CeKUmmW43gQhudlSIxkBhEcYkssFFI9k8mjgqC0DAeDIaBRPDYPBuP5UGgOAc8nMOgqHJWwmIMYZAKSAKIQaTvecAdngJZQOhvGBdDodBp8HQ8dFBIHTlIWFg2Ji1JVBwcIE1J9GBgJFgICCQkbCpEKlAxtnAlfpp+hUZ2trgkYkAd3DK0IigitDIQHEgsKG5gJAoqmGJ8LJbMVwZfOlxsVFL0fEhAaEVHPUxEaEBIqEBQKghtQHQoUEDgp1jxNVhQL3ykjhhD4+dQjIQA7",kiss:"data:image/gif;base64,R0lGODlhEgASANQUAFI9C8bGxu40NIZzHPPwWcq2auinE7WUCt7SMu/v7pQhEL+qTtLAKvfaE/7uKa2ZIrsfGMJtFv79ccCmF/r6+uDYuvnuPtI5KdqaHsS8nf76OdfX1r2lKfvmHP76WQAAACH5BAEAAB8ALAAAAAASABIAAAXP4CeKVGmWY0pWy3Mcz1JRKlkcCCFJBHIUtFSCMyF4EBYLwkOYcBIjyoIhGVis16uEsaBRKgeJ5sF5JMkPjeQwky45AwBAo5EPOMduokivzzVxfU0JCWF9Gg4dDYuMHgeEhogNBouUjY97BA6VCi8Klh0WE4QLSA0RChCqEAoRDUoLCRQZEx4dHREQAgIXEbceExklCVMemxgXFxgNDh5csh8UGxwMBIi3DhoEDBwbQR8JGwsTSB4eShMLG1Ap0hkLRE4LGd410eEB+QHr3x8hADs=",laughing:"data:image/gif;base64,R0lGODlhEgASAPQfAMKmMq6qpuPQHKOGBqGVjPXnLO/v7r+qTnJeSPPwWdK+H8OrGsjHxWpTEsS8nfbYEPryR+DYurebE/r6+v79cf32N4h1WtjV07qfLsq2at7SMnljE9XDMVI9Df77WgAAACH5BAUAAB8ALAAAAAASABIAQAXU4CeKU2mWo2hIVOUW8CMIT+1JxjhdzgEsC8DBcZmkJgcFBcLhuJoQiuJgnDgWHkHjwigxLg2FZ+EwkjISToJCSXAkGfMHqfG4Op17vuLRUFcJCwgWhIWECBgQOHMXAAoJFQsbAwsVCQoARSlzEQcSAwMSBxFyIwYYCwkeEKwQHoEYOZwsEBUNe7cVURKkgLUVGw0uwS4QCTgrFAUcNDXODwsCigYGBxq2BAwBFxcBDATCfgYT1WICGwTc4AIeU+MqFwcLGq6rGgsHF7JHBlwM//pKhQAAOw==","money-mouth":"data:image/gif;base64,R0lGODlhEgASANQUACkYBr62mpiMHMKoIsKsUffaE25YNvn0UoS1auPYMdra2T5eKrSXCvz6bvz0ObKbJEozB4lzE8rCoK6iVvb29k13OVpGPjJCGrHlmZqGNtG+JtnTv3J4JJJ+FcLCwgAAACH5BAEAAB8ALAAAAAASABIAAAW+4CeKVGmWY0puxMMwD7FRKkkw2tE0h8YQtBTlMeAdHI6DbvAIfigEDe+BRD50GuBzw2g4IgAIEixuMGbQxCEBiCQcbHcyARwqkQLA25FXH5oUXUgQbQUFhBGGBwwlgniGhh2QiyUDBwQZGpCbRAcDJQRvBhakpaQGcHUSlg8AFQgVrxUAAp4SJQpRHAsLsK8LFRdZCjQUCgMXvBgICBgLFwIDxCPGE7sY2M4DBNNCCgG84QsB3Sq4HugexE4fIQA7",sealed:"data:image/gif;base64,R0lGODlhEgASAPQfAMCqF764n/bdFKePCYiIiOLavredE+DaUr2qSfrqHvDw7823GbKyspaKSsq2aufbNZiGILenKPb0XPn5+WxVDczMzM7OTuTk5MO7P/33Ovz6b62VIt7WtlI9C9XGLwAAACH5BAUAAB8ALAAAAAASABIAQAXA4CeKU2mWo6gYWuZSVCLAQi0ZyjhdARIBgAgicJmkJoiFZhN5uDIRiGaBME4CwYliy91OfgEjyWHwHDSag8fgEH+QD8mrM3dJHtWVJHLqTwwZOG8VEBeGh4gQFW4kBQgbAwMbCAWMKj8SGBAPDxAYEkE5bxwsGQ8eHi6oThoGHFoGci4ddBm0TzdbLA8RBpG/vwu5Cgi8EwRdWwRfeAo7CIUEFdPUBBcQCEUqDA0QERgWFhhRDQyiRwoX1BUXzikhADs=",smile:"data:image/gif;base64,R0lGODlhEgASAPQfAHlgDsbGxpZ6DOrPEcq2at7SMr+qTu/v7vPwWdC9HlI9DbSYDPzwNmhUEsSrGfvmHvr6+uDYuv79cfryR8S8nbqeLtfX1tXDMf75N7mbHMKmMv77WvjaEiYKAqqKAgAAACH5BAUAAB8ALAAAAAASABIAQAXV4CeKUGmWo3gsEuYyz8MNA2dvyzFCFmVoDofGQLFAUhBDQjK5XBgM50SSMBwhFMcmBuh4O4DYxkE5kgiLC0IiQVwWBPMnWdi4FIp7HrMpWA8ZCAwDHjaGHB4DDxMZOjwaCQgYMA8MGAgJGkYpcxEGGR4eGQYRciMHFQ4IGxNQExsIDhU6nSytDQpQuAxTC6WACBMuAA3DxRgTCI0rLTCHhjUTOQcGBQwcAgAJNgkAAhwMfgcQ1AlbDw4CAg5iVeMqFgYOBa+sBQ4GFrRIBxYB/wH0mQoBADs=",surprised:"data:image/gif;base64,R0lGODlhEgASAPQfAPvkGsbGxp2MKOrND/zrI8q2ar+qTu/v7lI7CfPxWtDAJt3PMqqKAr6lLGtTDMKnF/r6+uDYuv73N/z6b/nbE+7gN8S8ndfX1vnzRj4iAraaEeDaUv77WCgMAsS4RAAAACH5BAUAAB8ALAAAAAASABIAQAXP4CeKUGmWo3hok+Q6DgHAVM1pxwhdltE8j4bBcoGkIAbFRNCouCoNwURhMEIsD44MkOl4AQAC52ExkgqaxWYy2Sw0BfMHueC8EHcXZ1E9PBISNRQPXhqCABgPOTsNCoAKGRkKEgkKDUUpcxEGGgwMGgYRciMHPwkeAhUVAh4JQTmaLBgVC5MStRUYExqiKwkYLgh4EsIuGAk4Ky0SBAPOz4IYyQYLgTUIXgiCtwYHEAdJWjPZYRxU3ioXBg8LGBwcGAsPBhewRwcXAfoB9aMhADs=","tongue-out":"data:image/gif;base64,R0lGODlhEgASANQUACYKAsbGxpd9C/faEqcYGcq2avzrI7+qTu/v7tK+Hfn1WFI9DfIaGrOWCt7SMr+jLtY6Om5YEfvyRv79cfr6+uDYur6iGVoHArYvJ8S8nf31N9fX1tXDMfXgIvpSVAAAACH5BAEAAB8ALAAAAAASABIAAAXF4CeKVGmWY0pWh9U01lFRKlk0nDJNCtcUtBTiYVEoJEiJ0fJAjCiHxETC4Wg0VckkcaBRKo2pJrK4kjXaxgzqUFwXZQ38qnB0EUWJObK/Ki0ICGFXVx0GA4iJCg2BgxqHiZEDEox4bpKSHRKACAcOGgICCZEJoRp2CBQZRR0RAK8XsREdChYZJZ0JCgalGBAQGAYKXKkfFBsPuo8EDAwEww8bQR8IGy0OEgQeHgQxG04pxxkHDxgEBBgZ0jXG1QHvAd/THyEAOw==",undecided:"data:image/gif;base64,R0lGODlhEgASANQRACoWAsbGxop5G/fYEMq2av3sJb+qTu/v7qeJB/PwWda6DmRODN7SMrebDb+jLfryR/79cfr6+uDYukIvB8OqFvvvOcS8nfvjGdfX1v76WVZDDP75N3ZiEbmbHM6/JAAAACH5BAEAAB8ALAAAAAASABIAAAXO4CeKUWmWY0pKRocgnSFFKkk0TAJBCdMQtNTBQUlkHpXKI5OgOA6jiMEDQSavD4jHQItIGlXBRJAUC7KNmZSR2WgWnI1bE88wuIdO4rHhVOR9fxsPCR0HB2ByHh4FBRcUCgMXFxkNh4kbBQObnJwPlnkJmp0IEwsNkg+GBwYMFZOPEwB0CBcVdwcRFhQZjg0cFLAXBRkUFiWsHr3Ck8RbuR8RGA4eCZnNGwkeDhhBHwcYBhQMS0cMFAYYUCnSFgZETgYW3TXR4AH4AereHyEAOw==",wink:"data:image/gif;base64,R0lGODlhEgASAPQfANHCKcbGxp1/CerPEd7RMsq2ar+qTvPwWe/v7sezHlA6DPzwLLSYDL6kLHVcDvryR/zmHf79cfr6+uDYusGoGMS8nf78Nta+EtfX1u7mMv76WfjaEraaHCgNAv3xOgAAACH5BAUAAB8ALAAAAAASABIAQAXb4CeKUmmWo4gwkeVaC7QNw2ZrDDJKWGU0FErDUMFIUhJDIvLwOD0AwCOSMBwlFYoGAnF0vh0HV0OpHEkFBuEQiRwIjML5kyRoAIpvwqJQuDQEVggcBwsDDDaJGwwDEA8cOjwNAAceMRALHgcADUYpdBMGHAICHAYTcyMIQAcaTR4PGgdCOqAsDQQeGQAeDgqwEQyogwcPFhkJGS4ODi4PB5ArLTGKiTUPOQgGuRsCDhc2Fw4CGx6BCBLaABoxCaQJmHcG6CoYBhQEsa4EFAYYtUgQYAhAMMC/VCEAADs=",yell:"data:image/gif;base64,R0lGODlhEgASANQSADIWAsnGxX9lFvTVGZaGe62ICb+qTvn2We7u7dG/KFI0Cv3wNO2rE8q2ar6eK97SM82OD/TAEPr6+m5UPODYuvrbOYdzSv79cfnwSMS8nbWZEdfX1tWqKmxMDMKnFwAAACH5BAEAAB8ALAAAAAASABIAAAXN4CeKUmmWY0pShlYUmkFJKtloz3Fdx6M1tBTC4TkcMJUKxuhxIEYSQ+KCTFoxl4SBJqFosgmrNTHVzKK5haDDSXI6gkVvi9AcFxUFwOEAKCoLSxoIdRcLCXAcDAwQHR0eAweDhQsLAxGMEIsREQMYk0WWAxoTFgQTBZ2eHoQGD5YJBAGEAQSQCw8GCBIZoRoAwMEFch4ZJQhSBwPBwTlaux8SGw4JPaYEFs4OG0EfCBsGHg9LRw8eBhtPKdIZBkRNBhncNdHfAfcB6d0fIQA7"}
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.zemoticons.plugin")){
tinymce.PluginManager.add("zemoticons",function(t,e){
function a(){
var s;
s=['<table role="presentation" class="mce-grid">'];
var h=[];
for(var r in tinyMCE.emoticon_map){
h.push(r)
}
while(h.length){
s.push("<tr>");
var l=h.splice(0,4);
for(var n=0;
n<l.length;
n++){
var r=l[n];
var o=tinyMCE.emoticon_map[r];
s.push('<td><a href="#" data-mce-url="');
s.push(o);
s.push('" tabindex="-1"><img src="');
s.push(o);
s.push('" style="width: 18px; height: 18px" alt="');
s.push(r);
s.push('">');
s.push("</a></td>")
}
s.push("</tr>")
}
s.push("</table>");
return s.join("")
}
t.addButton("zemoticons",{
type:"panelbutton",panel:{
autohide:true,html:a,onclick:function(i){
var o=t.dom.getParent(i.target,"a");
if(o){
var n=t.settings.paste_data_images;
t.settings.paste_data_images=true;
t.insertContent('<img src="'+o.getAttribute("data-mce-url")+'" />');
t.settings.paste_data_images=n;
this.hide()
}}}
,icon:"emoticons",tooltip:"Emoticons"}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.autolink.plugin")){
tinymce.PluginManager.add("autolink",function(i){
var e;
i.on("keydown",function(s){
if(s.keyCode==13){
return a(i)
}}
);
if(tinymce.Env.ie){
i.on("focus",function(){
if(!e){
e=true;
try{
i.execCommand("AutoUrlDetect",false,true)
}
catch(s){}}}
);
return
}
i.on("keypress",function(s){
if(s.keyCode==41){
return o(i)
}}
);
i.on("keyup",function(s){
if(s.keyCode==32){
return t(i)
}}
);
function o(s){
n(s,-1,"(",true)
}
function t(s){
n(s,0,"",true)
}
function a(s){
n(s,-1,"",false)
}
function n(p,c,r){
var s,u,l,k,b,v,m,d,f,w;
function h(q,j){
if(j<0){
j=0
}
if(q.nodeType==3){
var x=q.data.length;
if(j>x){
j=x
}}
return j
}
function y(x,q){
if(x.nodeType!=1||x.hasChildNodes()){
s.setStart(x,h(x,q))
}else{
s.setStartBefore(x)
}}
function g(x,q){
if(x.nodeType!=1||x.hasChildNodes()){
s.setEnd(x,h(x,q))
}else{
s.setEndAfter(x)
}}
if(p.selection.getNode().tagName=="A"){
return
}
s=p.selection.getRng(true).cloneRange();
if(s.startOffset<5){
d=s.endContainer.previousSibling;
if(!d){
if(!s.endContainer.firstChild||!s.endContainer.firstChild.nextSibling){
return
}
d=s.endContainer.firstChild.nextSibling
}
f=d.length;
y(d,f);
g(d,f);
if(s.endOffset<5){
return
}
u=s.endOffset;
k=d
}else{
k=s.endContainer;
if(k.nodeType!=3&&k.firstChild){
while(k.nodeType!=3&&k.firstChild){
k=k.firstChild
}
if(k.nodeType==3){
y(k,0);
g(k,k.nodeValue.length)
}}
if(s.endOffset==1){
u=2
}else{
u=s.endOffset-1-c
}}
l=u;
do{
y(k,u>=2?u-2:0);
g(k,u>=1?u-1:0);
u-=1;
w=s.toString()
}
while(w!=" "&&w!==""&&w.charCodeAt(0)!=160&&(u-2)>=0&&w!=r);
if(s.toString()==r||s.toString().charCodeAt(0)==160){
y(k,u);
g(k,l);
u+=1
}else{
if(s.startOffset===0){
y(k,0);
g(k,l)
}else{
y(k,u);
g(k,l)
}}
v=s.toString();
if(v.charAt(v.length-1)=="."){
g(k,l-1)
}
v=s.toString();
m=v.match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i);
if(m){
if(m[1]=="www."){
m[1]="http://www."
}else{
if(/@$/.test(m[1])&&!/^mailto:/.test(m[1])){
m[1]="mailto:"+m[1]
}}
b=p.selection.getBookmark();
p.selection.setRng(s);
p.execCommand("createlink",false,m[1]+m[2]);
p.selection.moveToBookmark(b);
p.nodeChanged()
}}}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.charmap.plugin")){
tinymce.PluginManager.add("charmap",function(t){
var a=[["160","no-break space"],["173","soft hyphen"],["34","quotation mark"],["162","cent sign"],["8364","euro sign"],["163","pound sign"],["165","yen sign"],["169","copyright sign"],["174","registered sign"],["8482","trade mark sign"],["8240","per mille sign"],["181","micro sign"],["183","middle dot"],["8226","bullet"],["8230","three dot leader"],["8242","minutes / feet"],["8243","seconds / inches"],["167","section sign"],["182","paragraph sign"],["223","sharp s / ess-zed"],["8249","single left-pointing angle quotation mark"],["8250","single right-pointing angle quotation mark"],["171","left pointing guillemet"],["187","right pointing guillemet"],["8216","left single quotation mark"],["8217","right single quotation mark"],["8220","left double quotation mark"],["8221","right double quotation mark"],["8218","single low-9 quotation mark"],["8222","double low-9 quotation mark"],["60","less-than sign"],["62","greater-than sign"],["8804","less-than or equal to"],["8805","greater-than or equal to"],["8211","en dash"],["8212","em dash"],["175","macron"],["8254","overline"],["164","currency sign"],["166","broken bar"],["168","diaeresis"],["161","inverted exclamation mark"],["191","turned question mark"],["710","circumflex accent"],["732","small tilde"],["176","degree sign"],["8722","minus sign"],["177","plus-minus sign"],["247","division sign"],["8260","fraction slash"],["215","multiplication sign"],["185","superscript one"],["178","superscript two"],["179","superscript three"],["188","fraction one quarter"],["189","fraction one half"],["190","fraction three quarters"],["402","function / florin"],["8747","integral"],["8721","n-ary sumation"],["8734","infinity"],["8730","square root"],["8764","similar to"],["8773","approximately equal to"],["8776","almost equal to"],["8800","not equal to"],["8801","identical to"],["8712","element of"],["8713","not an element of"],["8715","contains as member"],["8719","n-ary product"],["8743","logical and"],["8744","logical or"],["172","not sign"],["8745","intersection"],["8746","union"],["8706","partial differential"],["8704","for all"],["8707","there exists"],["8709","diameter"],["8711","backward difference"],["8727","asterisk operator"],["8733","proportional to"],["8736","angle"],["180","acute accent"],["184","cedilla"],["170","feminine ordinal indicator"],["186","masculine ordinal indicator"],["8224","dagger"],["8225","double dagger"],["192","A - grave"],["193","A - acute"],["194","A - circumflex"],["195","A - tilde"],["196","A - diaeresis"],["197","A - ring above"],["198","ligature AE"],["199","C - cedilla"],["200","E - grave"],["201","E - acute"],["202","E - circumflex"],["203","E - diaeresis"],["204","I - grave"],["205","I - acute"],["206","I - circumflex"],["207","I - diaeresis"],["208","ETH"],["209","N - tilde"],["210","O - grave"],["211","O - acute"],["212","O - circumflex"],["213","O - tilde"],["214","O - diaeresis"],["216","O - slash"],["338","ligature OE"],["352","S - caron"],["217","U - grave"],["218","U - acute"],["219","U - circumflex"],["220","U - diaeresis"],["221","Y - acute"],["376","Y - diaeresis"],["222","THORN"],["224","a - grave"],["225","a - acute"],["226","a - circumflex"],["227","a - tilde"],["228","a - diaeresis"],["229","a - ring above"],["230","ligature ae"],["231","c - cedilla"],["232","e - grave"],["233","e - acute"],["234","e - circumflex"],["235","e - diaeresis"],["236","i - grave"],["237","i - acute"],["238","i - circumflex"],["239","i - diaeresis"],["240","eth"],["241","n - tilde"],["242","o - grave"],["243","o - acute"],["244","o - circumflex"],["245","o - tilde"],["246","o - diaeresis"],["248","o slash"],["339","ligature oe"],["353","s - caron"],["249","u - grave"],["250","u - acute"],["251","u - circumflex"],["252","u - diaeresis"],["253","y - acute"],["254","thorn"],["255","y - diaeresis"],["913","Alpha"],["914","Beta"],["915","Gamma"],["916","Delta"],["917","Epsilon"],["918","Zeta"],["919","Eta"],["920","Theta"],["921","Iota"],["922","Kappa"],["923","Lambda"],["924","Mu"],["925","Nu"],["926","Xi"],["927","Omicron"],["928","Pi"],["929","Rho"],["931","Sigma"],["932","Tau"],["933","Upsilon"],["934","Phi"],["935","Chi"],["936","Psi"],["937","Omega"],["945","alpha"],["946","beta"],["947","gamma"],["948","delta"],["949","epsilon"],["950","zeta"],["951","eta"],["952","theta"],["953","iota"],["954","kappa"],["955","lambda"],["956","mu"],["957","nu"],["958","xi"],["959","omicron"],["960","pi"],["961","rho"],["962","final sigma"],["963","sigma"],["964","tau"],["965","upsilon"],["966","phi"],["967","chi"],["968","psi"],["969","omega"],["8501","alef symbol"],["982","pi symbol"],["8476","real part symbol"],["978","upsilon - hook symbol"],["8472","Weierstrass p"],["8465","imaginary part"],["8592","leftwards arrow"],["8593","upwards arrow"],["8594","rightwards arrow"],["8595","downwards arrow"],["8596","left right arrow"],["8629","carriage return"],["8656","leftwards double arrow"],["8657","upwards double arrow"],["8658","rightwards double arrow"],["8659","downwards double arrow"],["8660","left right double arrow"],["8756","therefore"],["8834","subset of"],["8835","superset of"],["8836","not a subset of"],["8838","subset of or equal to"],["8839","superset of or equal to"],["8853","circled plus"],["8855","circled times"],["8869","perpendicular"],["8901","dot operator"],["8968","left ceiling"],["8969","right ceiling"],["8970","left floor"],["8971","right floor"],["9001","left-pointing angle bracket"],["9002","right-pointing angle bracket"],["9674","lozenge"],["9824","black spade suit"],["9827","black club suit"],["9829","black heart suit"],["9830","black diamond suit"],["8194","en space"],["8195","em space"],["8201","thin space"],["8204","zero width non-joiner"],["8205","zero width joiner"],["8206","left-to-right mark"],["8207","right-to-left mark"]];
function e(){
var c,d,l,s;
function i(m){
while(m){
if(m.nodeName=="TD"){
return m
}
m=m.parentNode
}}
c='<table role="presentation" cellspacing="0" class="mce-charmap"><tbody>';
var o=25;
var u=Math.ceil(a.length/o);
for(l=0;
l<u;
l++){
c+="<tr>";
for(d=0;
d<o;
d++){
var r=l*o+d;
if(r<a.length){
var n=a[r];
c+='<td title="'+n[1]+'"><div tabindex="-1" title="'+n[1]+'" role="button">'+(n?String.fromCharCode(parseInt(n[0],10)):"&nbsp;")+"</div></td>"
}else{
c+="<td />"
}}
c+="</tr>"
}
c+="</tbody></table>";
var h={
type:"container",html:c,onclick:function(f){
var m=f.target;
if(/^(TD|DIV)$/.test(m.nodeName)){
if(i(m).firstChild){
t.execCommand("mceInsertContent",false,tinymce.trim(m.innerText||m.textContent));
if(!f.ctrlKey){
s.close()
}}}}
,onmouseover:function(m){
var f=i(m.target);
if(f&&f.firstChild){
s.find("#preview").text(f.firstChild.firstChild.data);
s.find("#previewTitle").text(f.title)
}else{
s.find("#preview").text(" ");
s.find("#previewTitle").text(" ")
}}};
s=t.windowManager.open({
title:"Special character",spacing:10,padding:10,items:[h,{
type:"container",layout:"flex",direction:"column",align:"center",spacing:5,minWidth:160,minHeight:160,items:[{
type:"label",name:"preview",text:" ",style:"font-size: 40px; text-align: center",border:1,minWidth:140,minHeight:80}
,{
type:"label",name:"previewTitle",text:" ",style:"text-align: center",border:1,minWidth:140,minHeight:80}
]}
],buttons:[{
text:"Close",onclick:function(){
s.close()
}}
]}
)
}
t.addCommand("mceShowCharmap",e);
t.addButton("charmap",{
icon:"charmap",tooltip:"Special character",cmd:"mceShowCharmap"}
);
t.addMenuItem("charmap",{
icon:"charmap",text:"Special character",cmd:"mceShowCharmap",context:"insert"}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.contextmenu.plugin")){
tinymce.PluginManager.add("contextmenu",function(t){
var a,e=t.settings.contextmenu_never_use_native;
t.on("contextmenu",function(h){
var s,r=t.getDoc();
if(h.ctrlKey&&!e){
return
}
h.preventDefault();
if(tinymce.Env.mac&&tinymce.Env.webkit){
if(h.button==2&&r.caretRangeFromPoint){
t.selection.setRng(r.caretRangeFromPoint(h.x,h.y))
}}
s=t.settings.contextmenu||"link image inserttable | cell row column deletetable";
if(!a){
var o=[];
tinymce.each(s.split(/[ ,]/),function(i){
var c=t.menuItems[i];
if(i=="|"){
c={
text:i}
}
if(c){
c.shortcut="";
o.push(c)
}}
);
for(var n=0;
n<o.length;
n++){
if(o[n].text=="|"){
if(n===0||n==o.length-1){
o.splice(n,1)
}}}
a=new tinymce.ui.Menu({
items:o,context:"contextmenu",classes:"contextmenu"}
).renderTo();
t.on("remove",function(){
a.remove();
a=null
}
)
}else{
a.show()
}
var l={
x:h.pageX,y:h.pageY};
if(!t.inline){
l=tinymce.DOM.getPos(t.getContentAreaContainer());
l.x+=h.clientX;
l.y+=h.clientY
}
a.moveTo(l.x,l.y)
}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.directionality.plugin")){
tinymce.PluginManager.add("directionality",function(t){
function e(i){
var s=t.dom,n,o=t.selection.getSelectedBlocks();
if(o.length){
n=s.getAttrib(o[0],"dir");
tinymce.each(o,function(r){
if(!s.getParent(r.parentNode,"*[dir='"+i+"']",s.getRoot())){
if(n!=i){
s.setAttrib(r,"dir",i)
}else{
s.setAttrib(r,"dir",null)
}}}
);
t.nodeChanged()
}}
function a(o){
var i=[];
tinymce.each("h1 h2 h3 h4 h5 h6 div p".split(" "),function(n){
i.push(n+"[dir="+o+"]")
}
);
return i.join(",")
}
t.addCommand("mceDirectionLTR",function(){
e("ltr")
}
);
t.addCommand("mceDirectionRTL",function(){
e("rtl")
}
);
t.addButton("ltr",{
title:"Left to right",cmd:"mceDirectionLTR",stateSelector:a("ltr")}
);
t.addButton("rtl",{
title:"Right to left",cmd:"mceDirectionRTL",stateSelector:a("rtl")}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.emoticons.plugin")){
tinymce.PluginManager.add("emoticons",function(a,e){
var t=[["cool","cry","embarassed","foot-in-mouth"],["frown","innocent","kiss","laughing"],["money-mouth","sealed","smile","surprised"],["tongue-out","undecided","wink","yell"]];
function i(){
var o;
o='<table role="list" class="mce-grid">';
tinymce.each(t,function(n){
o+="<tr>";
tinymce.each(n,function(r){
var s=e+"/img/smiley-"+r+".gif";
o+='<td><a href="#" data-mce-url="'+s+'" data-mce-alt="'+r+'" tabindex="-1" role="option" aria-label="'+r+'"><img src="'+s+'" style="width: 18px; height: 18px" role="presentation" /></a></td>'
}
);
o+="</tr>"
}
);
o+="</table>";
return o
}
a.addButton("emoticons",{
type:"panelbutton",panel:{
role:"application",autohide:true,html:i,onclick:function(o){
var n=a.dom.getParent(o.target,"a");
if(n){
a.insertContent('<img src="'+n.getAttribute("data-mce-url")+'" alt="'+n.getAttribute("data-mce-alt")+'" />');
this.hide()
}}}
,tooltip:"Emoticons"}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.image.plugin")){
tinymce.PluginManager.add("image",function(o){
function a(r,l){
var s=document.createElement("img");
function n(d,c){
if(s.parentNode){
s.parentNode.removeChild(s)
}
l({
width:d,height:c}
)
}
s.onload=function(){
n(Math.max(s.width,s.clientWidth),Math.max(s.height,s.clientHeight))
};
s.onerror=function(){
n()
};
var h=s.style;
h.visibility="hidden";
h.position="fixed";
h.bottom=h.left=0;
h.width=h.height="auto";
document.body.appendChild(s);
s.src=r
}
function i(r,n,h){
function s(c,l){
l=l||[];
tinymce.each(c,function(u){
var d={
text:u.text||u.title};
if(u.menu){
d.menu=s(u.menu)
}else{
d.value=u.value;
n(d)
}
l.push(d)
}
);
return l
}
return s(r,h||[])
}
function t(n){
return function(){
var s=o.settings.image_list;
if(typeof s=="string"){
tinymce.util.XHR.send({
url:s,success:function(r){
n(tinymce.util.JSON.parse(r))
}}
)
}else{
if(typeof s=="function"){
s(n)
}else{
n(s)
}}}
}
function e(p){
var l,x={}
,y=o.dom,s=o.selection.getNode();
var f,u,b,h,c=o.settings.image_dimensions!==false;
function n(){
var j,T,z,q;
j=l.find("#width")[0];
T=l.find("#height")[0];
if(!j||!T){
return
}
z=j.value();
q=T.value();
if(l.find("#constrain")[0].checked()&&f&&u&&z&&q){
if(f!=z){
q=Math.round((z/f)*q);
if(!isNaN(q)){
T.value(q)
}}else{
z=Math.round((q/u)*z);
if(!isNaN(z)){
j.value(z)
}}}
f=z;
u=q
}
function d(){
function q(z){
function j(){
z.onload=z.onerror=null;
if(o.selection){
o.selection.select(z);
o.nodeChanged()
}}
z.onload=function(){
if(!x.width&&!x.height&&c){
y.setAttribs(z,{
width:z.clientWidth,height:z.clientHeight}
)
}
j()
};
z.onerror=j
}
m();
n();
x=tinymce.extend(x,l.toJSON());
if(!x.alt){
x.alt=""
}
if(!x.title){
x.title=""
}
if(x.width===""){
x.width=null
}
if(x.height===""){
x.height=null
}
if(!x.style){
x.style=null
}
x={
src:x.src,alt:x.alt,title:x.title,width:x.width,height:x.height,style:x.style,"class":x["class"]};
o.undoManager.transact(function(){
if(!x.src){
if(s){
y.remove(s);
o.focus();
o.nodeChanged()
}
return
}
if(x.title===""){
x.title=null
}
if(!s){
x.id="__mcenew";
o.focus();
o.selection.setContent(y.createHTML("img",x));
s=y.get("__mcenew");
y.setAttrib(s,"id",null)
}else{
y.setAttribs(s,x);
o.editorUpload.uploadImagesAuto()
}
q(s)
}
)
}
function k(q){
if(q){
q=q.replace(/px$/,"")
}
return q
}
function g(T){
var O,j,q,z=T.meta||{};
if(b){
b.value(o.convertURL(this.value(),"src"))
}
tinymce.each(z,function(W,A){
l.find("#"+A).value(W)
}
);
if(!z.width&&!z.height){
O=o.convertURL(this.value(),"src");
j=o.settings.image_prepend_url;
q=new RegExp("^(?:[a-z]+:)?//","i");
if(j&&!q.test(O)&&O.substring(0,j.length)!==j){
O=j+O
}
this.value(O);
a(o.documentBaseURI.toAbsolute(this.value()),function(A){
if(A.width&&A.height&&c){
f=A.width;
u=A.height;
l.find("#width").value(f);
l.find("#height").value(u)
}}
)
}}
f=y.getAttrib(s,"width");
u=y.getAttrib(s,"height");
if(s.nodeName=="IMG"&&!s.getAttribute("data-mce-object")&&!s.getAttribute("data-mce-placeholder")){
x={
src:y.getAttrib(s,"src"),alt:y.getAttrib(s,"alt"),title:y.getAttrib(s,"title"),"class":y.getAttrib(s,"class"),width:f,height:u}
}else{
s=null
}
if(p){
b={
type:"listbox",label:"Image list",values:i(p,function(q){
q.value=o.convertURL(q.value||q.url,"src")
}
,[{
text:"None",value:""}
]),value:x.src&&o.convertURL(x.src,"src"),onselect:function(q){
var j=l.find("#alt");
if(!j.value()||(q.lastControl&&j.value()==q.lastControl.text())){
j.value(q.control.text())
}
l.find("#src").value(q.control.value()).fire("change")
}
,onPostRender:function(){
b=this
}}
}
if(o.settings.image_class_list){
h={
name:"class",type:"listbox",label:"Class",values:i(o.settings.image_class_list,function(q){
if(q.value){
q.textStyle=function(){
return o.formatter.getCssText({
inline:"img",classes:[q.value]}
)
}
}}
)}
}
var v=[{
name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:true,onchange:g}
,b];
if(o.settings.image_description!==false){
v.push({
name:"alt",type:"textbox",label:"Image description"}
)
}
if(o.settings.image_title){
v.push({
name:"title",type:"textbox",label:"Image Title"}
)
}
if(c){
v.push({
type:"container",label:"Dimensions",layout:"flex",direction:"row",align:"center",spacing:5,items:[{
name:"width",type:"textbox",maxLength:5,size:3,onchange:n,ariaLabel:"Width"}
,{
type:"label",text:"x"}
,{
name:"height",type:"textbox",maxLength:5,size:3,onchange:n,ariaLabel:"Height"}
,{
name:"constrain",type:"checkbox",checked:true,text:"Constrain proportions"}
]}
)
}
v.push(h);
function w(j){
if(j.margin){
var q=j.margin.split(" ");
switch(q.length){
case 1:j["margin-top"]=j["margin-top"]||q[0];
j["margin-right"]=j["margin-right"]||q[0];
j["margin-bottom"]=j["margin-bottom"]||q[0];
j["margin-left"]=j["margin-left"]||q[0];
break;
case 2:j["margin-top"]=j["margin-top"]||q[0];
j["margin-right"]=j["margin-right"]||q[1];
j["margin-bottom"]=j["margin-bottom"]||q[0];
j["margin-left"]=j["margin-left"]||q[1];
break;
case 3:j["margin-top"]=j["margin-top"]||q[0];
j["margin-right"]=j["margin-right"]||q[1];
j["margin-bottom"]=j["margin-bottom"]||q[2];
j["margin-left"]=j["margin-left"]||q[1];
break;
case 4:j["margin-top"]=j["margin-top"]||q[0];
j["margin-right"]=j["margin-right"]||q[1];
j["margin-bottom"]=j["margin-bottom"]||q[2];
j["margin-left"]=j["margin-left"]||q[3]
}
delete j.margin
}
return j
}
function m(){
function z(T){
if(T.length>0&&/^[0-9]+$/.test(T)){
T+="px"
}
return T
}
if(!o.settings.image_advtab){
return
}
var j=l.toJSON(),q=y.parseStyle(j.style);
q=w(q);
if(j.vspace){
q["margin-top"]=q["margin-bottom"]=z(j.vspace)
}
if(j.hspace){
q["margin-left"]=q["margin-right"]=z(j.hspace)
}
if(j.border){
q["border-width"]=z(j.border)
}
l.find("#style").value(y.serializeStyle(y.parseStyle(y.serializeStyle(q))))
}
function r(){
if(!o.settings.image_advtab){
return
}
var j=l.toJSON(),q=y.parseStyle(j.style);
l.find("#vspace").value("");
l.find("#hspace").value("");
q=w(q);
if((q["margin-top"]&&q["margin-bottom"])||(q["margin-right"]&&q["margin-left"])){
if(q["margin-top"]===q["margin-bottom"]){
l.find("#vspace").value(k(q["margin-top"]))
}else{
l.find("#vspace").value("")
}
if(q["margin-right"]===q["margin-left"]){
l.find("#hspace").value(k(q["margin-right"]))
}else{
l.find("#hspace").value("")
}}
if(q["border-width"]){
l.find("#border").value(k(q["border-width"]))
}
l.find("#style").value(y.serializeStyle(y.parseStyle(y.serializeStyle(q))))
}
if(o.settings.image_advtab){
if(s){
if(s.style.marginLeft&&s.style.marginRight&&s.style.marginLeft===s.style.marginRight){
x.hspace=k(s.style.marginLeft)
}
if(s.style.marginTop&&s.style.marginBottom&&s.style.marginTop===s.style.marginBottom){
x.vspace=k(s.style.marginTop)
}
if(s.style.borderWidth){
x.border=k(s.style.borderWidth)
}
x.style=o.dom.serializeStyle(o.dom.parseStyle(o.dom.getAttrib(s,"style")))
}
l=o.windowManager.open({
title:"Insert/edit image",data:x,bodyType:"tabpanel",body:[{
title:"General",type:"form",items:v}
,{
title:"Advanced",type:"form",pack:"start",items:[{
label:"Style",name:"style",type:"textbox",onchange:r}
,{
type:"form",layout:"grid",packV:"start",columns:2,padding:0,alignH:["left","right"],defaults:{
type:"textbox",maxWidth:50,onchange:m}
,items:[{
label:"Vertical space",name:"vspace"}
,{
label:"Horizontal space",name:"hspace"}
,{
label:"Border",name:"border"}
]}
]}
],onSubmit:d}
)
}else{
l=o.windowManager.open({
title:"Insert/edit image",data:x,body:v,onSubmit:d}
)
}}
o.addButton("image",{
icon:"image",tooltip:"Insert/edit image",onclick:t(e),stateSelector:"img:not([data-mce-object],[data-mce-placeholder])"}
);
o.addMenuItem("image",{
icon:"image",text:"Insert/edit image",onclick:t(e),context:"insert",prependToContext:true}
);
o.addCommand("mceImage",t(e))
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.hr.plugin")){
tinymce.PluginManager.add("hr",function(e){
e.addCommand("InsertHorizontalRule",function(){
e.execCommand("mceInsertContent",false,"<hr />")
}
);
e.addButton("hr",{
icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"}
);
e.addMenuItem("hr",{
icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.link.plugin")){
tinymce.PluginManager.add("link",function(i){
function t(o){
return function(){
var n=i.settings.link_list;
if(typeof n=="string"){
tinymce.util.XHR.send({
url:n,success:function(s){
o(tinymce.util.JSON.parse(s))
}}
)
}else{
if(typeof n=="function"){
n(o)
}else{
o(n)
}}}
}
function a(s,o,r){
function n(l,h){
h=h||[];
tinymce.each(l,function(d){
var c={
text:d.text||d.title};
if(d.menu){
c.menu=n(d.menu)
}else{
c.value=d.value;
if(o){
o(c)
}}
h.push(c)
}
);
return h
}
return n(s,r||[])
}
function e(l){
var q={}
,j=i.selection,w=i.dom,k,m,f;
var h,d,c,s,p,u,r,g,y;
function v(z){
var T=h.find("#text");
if(!T.value()||(z.lastControl&&T.value()==z.lastControl.text())){
T.value(z.control.text())
}
h.find("#href").value(z.control.value())
}
function n(z){
var T=[];
tinymce.each(i.dom.select("a:not([href])"),function(O){
var A=O.name||O.id;
if(A){
T.push({
text:A,value:"#"+A,selected:z.indexOf("#"+A)!=-1}
)
}}
);
if(T.length){
T.unshift({
text:"None",value:""}
);
return{
name:"anchor",type:"listbox",label:"Anchors",values:T,onselect:v}
}}
function b(){
if(!f&&q.text.length===0&&d){
this.parent().parent().find("#text")[0].value(this.value())
}}
function o(T){
var z=T.meta||{};
if(s){
s.value(i.convertURL(this.value(),"href"))
}
tinymce.each(T.meta,function(A,O){
h.find("#"+O).value(A)
}
);
if(!z.text){
b.call(this)
}}
function x(T){
var A=j.getContent();
if(/</.test(A)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(A)||A.indexOf("href=")==-1)){
return false
}
if(T){
var z=T.childNodes,O;
if(z.length===0){
return false
}
for(O=z.length-1;
O>=0;
O--){
if(z[O].nodeType!=3){
return false
}}}
return true
}
k=j.getNode();
m=w.getParent(k,"a[href]");
d=x();
q.text=f=m?(m.innerText||m.textContent):j.getContent({
format:"text"}
);
q.href=m?w.getAttrib(m,"href"):"";
if(m){
q.target=w.getAttrib(m,"target")
}else{
if(i.settings.default_link_target){
q.target=i.settings.default_link_target
}}
if((y=w.getAttrib(m,"rel"))){
q.rel=y
}
if((y=w.getAttrib(m,"class"))){
q["class"]=y
}
if((y=w.getAttrib(m,"title"))){
q.title=y
}
if(d){
c={
name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){
q.text=this.value()
}}
}
if(l){
s={
type:"listbox",label:"Link list",values:a(l,function(z){
z.value=i.convertURL(z.value||z.url,"href")
}
,[{
text:"None",value:""}
]),onselect:v,value:i.convertURL(q.href,"href"),onPostRender:function(){
s=this
}}
}
if(i.settings.target_list!==false){
if(!i.settings.target_list){
i.settings.target_list=[{
text:"None",value:""}
,{
text:"New window",value:"_blank"}
]
}
u={
name:"target",type:"listbox",label:"Target",values:a(i.settings.target_list)}
}
if(i.settings.rel_list){
p={
name:"rel",type:"listbox",label:"Rel",values:a(i.settings.rel_list)}
}
if(i.settings.link_class_list){
r={
name:"class",type:"listbox",label:"Class",values:a(i.settings.link_class_list,function(z){
if(z.value){
z.textStyle=function(){
return i.formatter.getCssText({
inline:"a",classes:[z.value]}
)
}
}}
)}
}
if(i.settings.link_title!==false){
g={
name:"title",type:"textbox",label:"Title",value:q.title}
}
h=i.windowManager.open({
title:"Insert link",data:q,body:[{
name:"href",type:"filepicker",filetype:"file",size:40,autofocus:true,label:"Url",onchange:o,onkeyup:b}
,c,g,n(q.href),s,p,u,r],onSubmit:function(A){
var z;
q=tinymce.extend(q,A.data);
z=q.href;
function O(B,C){
var W=i.selection.getRng();
window.setTimeout(function(){
i.windowManager.confirm(B,function(D){
i.selection.setRng(W);
C(D)
}
)
}
,0)
}
function T(){
var W={
href:z,target:q.target?q.target:null,rel:q.rel?q.rel:null,"class":q["class"]?q["class"]:null,title:q.title?q.title:null};
if(m){
i.focus();
if(d&&q.text!=f){
if("innerText" in m){
m.innerText=q.text
}else{
m.textContent=q.text
}}
w.setAttribs(m,W);
j.select(m);
i.undoManager.add()
}else{
if(d){
i.insertContent(w.createHTML("a",W,w.encode(q.text)))
}else{
i.execCommand("mceInsertLink",false,W)
}}}
if(!z){
i.execCommand("unlink");
return
}
if(z.indexOf("@")>0&&z.indexOf("//")==-1&&z.indexOf("mailto:")==-1){
O("The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(W){
if(W){
z="mailto:"+z
}
T()
}
);
return
}
if((i.settings.link_assume_external_targets&&!/^\w+:/i.test(z))||(!i.settings.link_assume_external_targets&&/^\s*www[\.|\d\.]/i.test(z))){
O("The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(W){
if(W){
z="http://"+z
}
T()
}
);
return
}
T()
}}
)
}
i.addButton("link",{
icon:"link",tooltip:"Insert/edit link",shortcut:"Meta+K",onclick:t(e),stateSelector:"a[href]"}
);
i.addButton("unlink",{
icon:"unlink",tooltip:"Remove link",cmd:"unlink",stateSelector:"a[href]"}
);
i.addShortcut("Meta+K","",t(e));
i.addCommand("mceLink",t(e));
this.showDialog=e;
i.addMenuItem("link",{
icon:"link",text:"Insert/edit link",shortcut:"Meta+K",onclick:t(e),stateSelector:"a[href]",context:"insert",prependToContext:true}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.paste.plugin")){
(function(t,s){var i={};
function a(d,u){
var c,h=[];
for(var l=0;
l<d.length;
++l){
c=i[d[l]]||o(d[l]);
if(!c){
throw"module definition dependecy not found: "+d[l]
}
h.push(c)
}
u.apply(null,h)
}
function r(c,l,h){
if(typeof c!=="string"){
throw"invalid module definition, module id must be defined and be a string"
}
if(l===s){
throw"invalid module definition, dependencies must be specified"
}
if(h===s){
throw"invalid module definition, definition function must be specified"
}
a(l,function(){
i[c]=h.apply(null,arguments)
}
)
}
function n(h){
return !!i[h]
}
function o(d){
var l=t;
var h=d.split(/[.\/]/);
for(var c=0;
c<h.length;
++c){
if(!l[h[c]]){
return
}
l=l[h[c]]
}
return l
}
function e(c){
var l,u,f,h,d;
for(l=0;
l<c.length;
l++){
u=t;
f=c[l];
h=f.split(/[.\/]/);
for(var m=0;
m<h.length-1;
++m){
if(u[h[m]]===s){
u[h[m]]={}
}
u=u[h[m]]
}
u[h[h.length-1]]=i[f]
}
if(t.AMDLC_TESTS){
d=t.privateModules||{};
for(f in i){
d[f]=i[f]
}
for(l=0;
l<c.length;
l++){
delete d[c[l]]
}
t.privateModules=d
}}
r("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(h,m,d){
function c(p,f){
h.each(f,function(g){
if(g.constructor==RegExp){
p=p.replace(g,"")
}else{
p=p.replace(g[0],g[1])
}}
);
return p
}
function u(y){
var w=new d(),k=new m({}
,w),v="";
var g=w.getShortEndedElements();
var p=h.makeMap("script noscript style textarea video audio iframe object"," ");
var b=w.getBlockElements();
function f(j){
var x=j.name,q=j;
if(x==="br"){
v+="\n";
return
}
if(g[x]){
v+=" "
}
if(p[x]){
v+=" ";
return
}
if(j.type==3){
v+=j.value
}
if(!j.shortEnded){
if((j=j.firstChild)){
do{
f(j)
}
while((j=j.next))
}}
if(b[x]&&q.next){
v+="\n";
if(x=="p"){
v+="\n"
}}}
y=c(y,[/<!\[[^\]]+\]>/g]);
f(k.parse(y));
return v
}
function l(f){
function p(b,y,g){
if(!y&&!g){
return" "
}
return"\u00a0"
}
f=c(f,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,p],/<br>$/i]);
return f
}
return{
filter:c,innerText:u,trimHtml:l}
}
);
r("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(h,l,d,c){
return function(g){
var z=this,f,B,m=0,W=false;
var y="%MCEPASTEBIN%",C;
var b="data:text/mce-internal,";
function O(I){
var H,Y=g.dom;
H=g.fire("BeforePastePreProcess",{
content:I}
);
H=g.fire("PastePreProcess",H);
I=H.content;
if(!H.isDefaultPrevented()){
if(g.hasEventListeners("PastePostProcess")&&!H.isDefaultPrevented()){
var R=Y.add(g.getBody(),"div",{
style:"display:none"}
,I);
H=g.fire("PastePostProcess",{
node:R}
);
Y.remove(R);
I=H.node.innerHTML
}
if(!H.isDefaultPrevented()){
g.insertContent(I,{
merge:g.settings.paste_merge_formats!==false,data:{
paste:true}}
)
}}}
function A(Y){
Y=g.dom.encode(Y).replace(/\r\n/g,"\n");
var H=g.dom.getParent(g.selection.getStart(),g.dom.isBlock);
var R=g.settings.forced_root_block;
var I;
if(R){
I=g.dom.createHTML(R,g.settings.forced_root_block_attrs);
I=I.substr(0,I.length-3)+">"
}
if((H&&/^(PRE|DIV)$/.test(H.nodeName))||!R){
Y=c.filter(Y,[[/\n/g,"<br>"]])
}else{
Y=c.filter(Y,[[/\n\n/g,"</p>"+I],[/^(.*<\/p>)(<p>)$/,I+"$1"],[/\n/g,"<br />"]]);
if(Y.indexOf("<p>")!=-1){
Y=I+Y
}}
O(Y)
}
function w(){
var I=g.dom,Y=g.getBody();
var E=g.dom.getViewPort(g.getWin()),H=E.y,L=20;
var P;
B=g.selection.getRng();
if(g.inline){
P=g.selection.getScrollContainer();
if(P&&P.scrollTop>0){
H=P.scrollTop
}}
function G(J){
var K,V,Q,U=J.startContainer;
K=J.getClientRects();
if(K.length){
return K[0]
}
if(!J.collapsed||U.nodeType!=1){
return
}
Q=U.childNodes[B.startOffset];
while(Q&&Q.nodeType==3&&!Q.data.length){
Q=Q.nextSibling
}
if(!Q){
return
}
if(Q.tagName=="BR"){
V=I.doc.createTextNode("\uFEFF");
Q.parentNode.insertBefore(V,Q);
J=I.createRng();
J.setStartBefore(V);
J.setEndAfter(V);
K=J.getClientRects();
I.remove(V)
}
if(K.length){
return K[0]
}}
if(B.getClientRects){
var N=G(B);
if(N){
L=H+(N.top-I.getPos(Y).y)
}else{
L=H;
var R=B.startContainer;
if(R){
if(R.nodeType==3&&R.parentNode!=Y){
R=R.parentNode
}
if(R.nodeType==1){
L=I.getPos(R,P||Y).y
}}}}
f=I.add(g.getBody(),"div",{
id:"mcepastebin",contentEditable:true,"data-mce-bogus":"all",style:"position: absolute; top: "+L+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"}
,y);
if(h.ie||h.gecko){
I.setStyle(f,"left",I.getStyle(Y,"direction",true)=="rtl"?65535:-65535)
}
I.bind(f,"beforedeactivate focusin focusout",function(U){
U.stopPropagation()
}
);
f.focus();
g.selection.select(f,true)
}
function M(){
if(f){
var R;
while((R=g.dom.get("mcepastebin"))){
g.dom.remove(R);
g.dom.unbind(R)
}
if(B){
g.selection.setRng(B)
}}
f=B=null
}
function F(){
var Y="",H,I,E,R;
H=g.dom.select("div[id=mcepastebin]");
for(I=0;
I<H.length;
I++){
E=H[I];
if(E.firstChild&&E.firstChild.id=="mcepastebin"){
E=E.firstChild
}
R=E.innerHTML;
if(Y!=y){
Y+=R
}}
return Y
}
function v(E){
var I,H,R,Y;
R=[25942,29554,28521,14958];
for(I=0;
I<R.length;
I++){
if(E.charCodeAt(I)!=R[I]){
return E
}}
H="";
for(I=0;
I<E.length;
I++){
Y=E.charCodeAt(I);
H+=String.fromCharCode((Y&255));
H+=String.fromCharCode((Y&65280)>>8)
}
return decodeURIComponent(escape(H))
}
function D(H){
var R,I,Y;
I="<!--StartFragment-->";
R=H.indexOf(I);
if(R!==-1){
H=H.substr(R+I.length)
}
Y="<!--EndFragment-->";
R=H.indexOf(Y);
if(R!==-1){
H=H.substr(0,R)
}
return H
}
function q(Y){
var R={};
if(Y){
if(Y.getData){
var G=Y.getData("Text");
if(G&&G.length>0){
if(G.indexOf(b)==-1){
R["text/plain"]=G
}}}
if(Y.types){
for(var H=0;
H<Y.types.length;
H++){
var E=Y.types[H],I=Y.getData(E);
if(E=="text/html"){
I=D(v(I))
}
R[E]=I
}}}
return R
}
function x(R){
return q(R.clipboardData||g.getDoc().dataTransfer)
}
function k(Y,H){
var I=Y.clipboardData||Y.dataTransfer;
function R(G){
var N,P,E,U=false;
function L(J){
if(H){
g.selection.setRng(H);
H=null
}
O('<img src="'+J.result+'">')
}
if(G){
for(N=0;
N<G.length;
N++){
P=G[N];
if(/^image\/(jpeg|png|gif|bmp)$/.test(P.type)){
E=new FileReader();
E.onload=L.bind(null,E);
E.readAsDataURL(P.getAsFile?P.getAsFile():P);
Y.preventDefault();
U=true
}}}
return U
}
if(g.settings.paste_data_images&&I){
return R(I.items)||R(I.files)
}}
function T(R){
var H=R.clipboardData;
return navigator.userAgent.indexOf("Android")!=-1&&H&&H.items&&H.items.length===0
}
function u(R){
return l.getCaretRangeFromPoint(R.clientX,R.clientY,g.getDoc())
}
function j(R,H){
return H in R&&R[H].length>0
}
function S(R){
return(d.metaKeyPressed(R)&&R.keyCode==86)||(R.shiftKey&&R.keyCode==45)
}
function p(){
g.on("keydown",function(R){
function H(I){
if(S(I)&&!I.isDefaultPrevented()){
M()
}}
if(S(R)&&!R.isDefaultPrevented()){
C=R.shiftKey&&R.keyCode==86;
if(C&&h.webkit&&navigator.userAgent.indexOf("Version/")!=-1){
return
}
R.stopImmediatePropagation();
m=new Date().getTime();
if(h.ie&&C){
R.preventDefault();
g.fire("paste",{
ieFake:true}
);
return
}
M();
w();
g.once("keyup",H);
g.once("paste",function(){
g.off("keyup",H)
}
)
}}
);
g.on("paste",function(E){
var G=new Date().getTime();
var Y=x(E);
var H=new Date().getTime()-G;
var R=(new Date().getTime()-m-H)<1000;
var I=z.pasteFormat=="text"||C;
C=false;
if(E.isDefaultPrevented()||T(E)){
M();
return
}
if(k(E)){
M();
return
}
if(!R&&(h.ie||(Object.keys(Y).length!==0))){
E.preventDefault()
}
if(h.ie&&(!R||E.ieFake)){
w();
g.dom.bind(f,"paste",function(L){
L.stopPropagation()
}
);
g.getDoc().execCommand("Paste",false,null);
Y["text/html"]=F()
}
setTimeout(function(){
var L;
if(j(Y,"text/html")){
L=Y["text/html"]
}else{
L=F();
if(L==y){
I=true
}}
L=c.trimHtml(L);
if(f&&f.firstChild&&f.firstChild.id==="mcepastebin"){
I=true
}
M();
if(!L.length){
I=true
}
if(I){
if(j(Y,"text/plain")&&L.indexOf("</p>")==-1){
L=Y["text/plain"]
}else{
L=c.innerText(L)
}}
if(L==y){
if(!R){
g.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")
}
return
}
if(I){
A(L)
}else{
O(L)
}}
,0)
}
);
g.on("dragstart dragend",function(R){
W=R.type=="dragstart"
}
);
g.on("drop",function(Y){
var R=u(Y);
if(Y.isDefaultPrevented()||W){
return
}
if(k(Y,R)){
return
}
if(R&&g.settings.paste_filter_drop!==false){
var H=q(Y.dataTransfer);
var I=H["mce-internal"]||H["text/html"]||H["text/plain"];
if(I){
Y.preventDefault();
g.undoManager.transact(function(){
if(H["mce-internal"]){
g.execCommand("Delete")
}
g.selection.setRng(R);
I=c.trimHtml(I);
if(!H["text/html"]){
A(I)
}else{
O(I)
}}
)
}}}
);
g.on("dragover dragend",function(R){
if(g.settings.paste_data_images){
R.preventDefault()
}}
)
}
z.pasteHtml=O;
z.pasteText=A;
g.on("preInit",function(){
p();
g.parser.addNodeFilter("img",function(I,H,N){
function P(U){
return U.data&&U.data.paste===true
}
function L(U){
if(!U.attr("data-mce-object")&&R!==h.transparentSrc){
U.remove()
}}
function Y(U){
return U.indexOf("webkit-fake-url")===0
}
function E(U){
return U.indexOf("data:")===0
}
if(!g.settings.paste_data_images&&P(N)){
var G=I.length;
while(G--){
var R=I[G].attributes.map.src;
if(!R){
continue
}
if(Y(R)){
L(I[G])
}else{
if(!g.settings.allow_html_data_urls&&E(R)){
L(I[G])
}}}}}
)
}
)
}
}
);
r("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(h,y,d,m,u,c){
function g(b){
return((/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i).test(b)||(/class="OutlineElement/).test(b)||(/id="?docs\-internal\-guid\-/.test(b)))
}
function l(v){
var w,b;
b=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/];
v=v.replace(/^[\u00a0 ]+/,"");
h.each(b,function(k){
if(k.test(v)){
w=true;
return false
}}
);
return w
}
function f(b){
return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(b)
}
function p(w){
var b=w.settings;
w.on("BeforePastePreProcess",function(T){
var A=T.content,O,q;
A=A.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,"");
A=A.replace(/<br class="?Apple-interchange-newline"?>/gi,"");
O=b.paste_retain_style_properties;
if(O){
q=h.makeMap(O.split(/[, ]/))
}
function z(R){
var S,L,C=1;
function G(U){
var P="";
if(U.type===3){
return U.value
}
if((U=U.firstChild)){
do{
P+=G(U)
}
while((U=U.next))
}
return P
}
function Y(U,P){
if(U.type===3){
if(P.test(U.value)){
U.value=U.value.replace(P,"");
return false
}}
if((U=U.firstChild)){
do{
if(!Y(U,P)){
return false
}}
while((U=U.next))
}
return true
}
function M(P){
if(P._listIgnore){
P.remove();
return
}
if((P=P.firstChild)){
do{
M(P)
}
while((P=P.next))
}}
function N(P,U,K){
var J=P._listLevel||C;
if(J!=C){
if(J<C){
if(S){
S=S.parent.parent
}}else{
L=S;
S=null
}}
if(!S||S.name!=U){
L=L||S;
S=new u(U,1);
if(K>1){
S.attr("start",""+K)
}
P.wrap(S)
}else{
S.append(P)
}
P.name="li";
if(J>C&&L){
L.lastChild.append(S)
}
C=J;
M(P);
Y(P,/^\u00a0+/);
Y(P,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);
Y(P,/^\u00a0+/)
}
var B=[],F=R.firstChild;
while(typeof F!=="undefined"&&F!==null){
B.push(F);
F=F.walk();
if(F!==null){
while(typeof F!=="undefined"&&F.parent!==R){
F=F.walk()
}}}
for(var H=0;
H<B.length;
H++){
R=B[H];
if(R.name=="p"&&R.firstChild){
var E=G(R);
if(f(E)){
N(R,"ul");
continue
}
if(l(E)){
var I=/([0-9]+)\./.exec(E);
var D=1;
if(I){
D=parseInt(I[1],10)
}
N(R,"ol",D);
continue
}
if(R._listLevel){
N(R,"ul",1);
continue
}
S=null
}else{
L=S;
S=null
}}}
function v(D,B){
var F={}
,S,C=w.dom.parseStyle(B);
h.each(C,function(R,M){
switch(M){
case"mso-list":S=/\w+ \w+([0-9]+)/i.exec(B);
if(S){
D._listLevel=parseInt(S[1],10)
}
if(/Ignore/i.test(R)&&D.firstChild){
D._listIgnore=true;
D.firstChild._listIgnore=true
}
break;
case"horiz-align":M="text-align";
break;
case"vert-align":M="vertical-align";
break;
case"font-color":case"mso-foreground":M="color";
break;
case"mso-background":case"mso-highlight":M="background";
break;
case"font-weight":case"font-style":if(R!="normal"){
F[M]=R
}
return;
case"mso-element":if(/^(comment|comment-list)$/i.test(R)){
D.remove();
return
}
break
}
if(M.indexOf("mso-comment")===0){
D.remove();
return
}
if(M.indexOf("mso-")===0){
return
}
if(O=="all"||(q&&q[M])){
F[M]=R
}}
);
if(/(bold)/i.test(F["font-weight"])){
delete F["font-weight"];
D.wrap(new u("b",1))
}
if(/(italic)/i.test(F["font-style"])){
delete F["font-style"];
D.wrap(new u("i",1))
}
F=w.dom.serializeStyle(F,D.name);
if(F){
return F
}
return null
}
if(b.paste_enable_default_filters===false){
return
}
if(g(T.content)){
T.wordContent=true;
A=c.filter(A,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(C,B){
return(B.length>0)?B.replace(/./," ").slice(Math.floor(B.length/2)).split("").join("\u00a0"):""
}
]]);
var k=b.paste_word_valid_elements;
if(!k){
k=("-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")
}
var j=new d({
valid_elements:k,valid_children:"-li[p]"}
);
h.each(j.elements,function(B){
if(!B.attributes["class"]){
B.attributes["class"]={};
B.attributesOrder.push("class")
}
if(!B.attributes.style){
B.attributes.style={};
B.attributesOrder.push("style")
}}
);
var W=new y({}
,j);
W.addAttributeFilter("style",function(B){
var C=B.length,D;
while(C--){
D=B[C];
D.attr("style",v(D,D.attr("style")));
if(D.name=="span"&&D.parent&&!D.attributes.length){
D.unwrap()
}}}
);
W.addAttributeFilter("class",function(B){
var C=B.length,S,D;
while(C--){
S=B[C];
D=S.attr("class");
if(/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(D)){
S.remove()
}
S.attr("class",null)
}}
);
W.addNodeFilter("del",function(B){
var C=B.length;
while(C--){
B[C].remove()
}}
);
W.addNodeFilter("a",function(C){
var S=C.length,F,B,D;
while(S--){
F=C[S];
B=F.attr("href");
D=F.attr("name");
if(B&&B.indexOf("#_msocom_")!=-1){
F.remove();
continue
}
if(B&&B.indexOf("file://")===0){
B=B.split("#")[1];
if(B){
B="#"+B
}}
if(!B&&!D){
F.unwrap()
}else{
if(D&&!/^_?(?:toc|edn|ftn)/i.test(D)){
F.unwrap();
continue
}
F.attr({
href:B,name:D}
)
}}}
);
var x=W.parse(A);
if(b.paste_convert_word_fake_lists!==false){
z(x)
}
T.content=new m({}
,j).serialize(x)
}}
)
}
p.isWordContent=g;
return p
}
);
r("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(h,l,d,c){return function(f){
function p(g){
f.on("BeforePastePreProcess",function(y){
y.content=g(y.content)
}
)
}
function m(g){
if(!d.isWordContent(g)){
return g
}
var y=[];
l.each(f.schema.getBlockElements(),function(v,w){
y.push(w)
}
);
var b=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+y.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");
g=c.filter(g,[[b,"$1"]]);
g=c.filter(g,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]);
return g
}
function u(b){
if(d.isWordContent(b)){
return b
}
var g=f.settings.paste_webkit_styles;
if(f.settings.paste_remove_styles_if_webkit===false||g=="all"){
return b
}
if(g){
g=g.split(/[, ]/)
}
if(g){
var w=f.dom,y=f.selection.getNode();
b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(O,z,T,v){
var k=w.parseStyle(T,"span"),j={};
if(g==="none"){
return z+v
}
for(var q=0;
q<g.length;
q++){
var x=k[g[q]],A=w.getStyle(y,g[q],true);
if(/color/.test(g[q])){
x=w.toHex(x);
A=w.toHex(A)
}
if(A!=x){
j[g[q]]=x
}}
j=w.serializeStyle(j,"span");
if(j){
return z+' style="'+j+'"'+v
}
return z+v
}
)
}else{
b=b.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3")
}
b=b.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(v,x,k,q){
return x+' style="'+k+'"'+q
}
);
return b
}
if(h.webkit){
p(u)
}
if(h.ie){
p(m)
}}
}
);
r("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(h,u,d,l){
var c;
h.add("paste",function(g){
var f=this,y,p=g.settings;
function m(){
if(y.pasteFormat=="text"){
this.active(false);
y.pasteFormat="html"
}else{
y.pasteFormat="text";
this.active(true);
if(!c){
g.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.");
c=true
}}}
f.clipboard=y=new u(g);
f.quirks=new l(g);
f.wordFilter=new d(g);
if(g.settings.paste_as_text){
f.clipboard.pasteFormat="text"
}
if(p.paste_preprocess){
g.on("PastePreProcess",function(b){
p.paste_preprocess.call(f,f,b)
}
)
}
if(p.paste_postprocess){
g.on("PastePostProcess",function(b){
p.paste_postprocess.call(f,f,b)
}
)
}
g.addCommand("mceInsertClipboardContent",function(w,b){
if(b.content){
f.clipboard.pasteHtml(b.content)
}
if(b.text){
f.clipboard.pasteText(b.text)
}}
);
if(g.paste_block_drop){
g.on("dragend dragover draggesture dragdrop drop drag",function(b){
b.preventDefault();
b.stopPropagation()
}
)
}
if(!g.settings.paste_data_images){
g.on("drop",function(w){
var b=w.dataTransfer;
if(b&&b.files&&b.files.length>0){
w.preventDefault()
}}
)
}
g.addButton("pastetext",{
icon:"pastetext",tooltip:"Paste as text",onclick:m,active:f.clipboard.pasteFormat=="text"}
);
g.addMenuItem("pastetext",{
text:"Paste as text",selectable:true,active:y.pasteFormat,onclick:m}
)
}
)
}
);
e(["tinymce/pasteplugin/Utils"])
}
)(this)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.table.plugin")){
(function(t,s){var i={};
function a(d,u){
var c,h=[];
for(var l=0;
l<d.length;
++l){
c=i[d[l]]||o(d[l]);
if(!c){
throw"module definition dependecy not found: "+d[l]
}
h.push(c)
}
u.apply(null,h)
}
function r(c,l,h){
if(typeof c!=="string"){
throw"invalid module definition, module id must be defined and be a string"
}
if(l===s){
throw"invalid module definition, dependencies must be specified"
}
if(h===s){
throw"invalid module definition, definition function must be specified"
}
a(l,function(){
i[c]=h.apply(null,arguments)
}
)
}
function n(h){
return !!i[h]
}
function o(d){
var l=t;
var h=d.split(/[.\/]/);
for(var c=0;
c<h.length;
++c){
if(!l[h[c]]){
return
}
l=l[h[c]]
}
return l
}
function e(c){
var l,u,f,h,d;
for(l=0;
l<c.length;
l++){
u=t;
f=c[l];
h=f.split(/[.\/]/);
for(var m=0;
m<h.length-1;
++m){
if(u[h[m]]===s){
u[h[m]]={}
}
u=u[h[m]]
}
u[h[h.length-1]]=i[f]
}
if(t.AMDLC_TESTS){
d=t.privateModules||{};
for(f in i){
d[f]=i[f]
}
for(l=0;
l<c.length;
l++){
delete d[c[l]]
}
t.privateModules=d
}}
r("tinymce/tableplugin/Utils",["tinymce/Env"],function(l){
function h(u,d){
return parseInt(u.getAttribute(d)||1,10)
}
function c(d){
if(!l.ie||l.ie>10){
d.innerHTML='<br data-mce-bogus="1" />'
}}
return{
getSpanVal:h,paddCell:c}
}
);
r("tinymce/tableplugin/TableGrid",["tinymce/util/Tools","tinymce/Env","tinymce/tableplugin/Utils"],function(c,l,u){
var d=c.each,h=u.getSpanVal;
return function(x,G){
var f,E,U,R,q,P=x.selection,Y=P.dom;
function A(){
var J=0;
f=[];
E=0;
d(["thead","tbody","tfoot"],function(K){
var Q=Y.select("> "+K+" tr",G);
d(Q,function(V,Z){
Z+=J;
d(Y.select("> td, > th",V),function(_o,X){
var _e,_t,_a,_i;
if(f[Z]){
while(f[Z][X]){
X++
}}
_a=h(_o,"rowspan");
_i=h(_o,"colspan");
for(_t=Z;
_t<Z+_a;
_t++){
if(!f[_t]){
f[_t]=[]
}
for(_e=X;
_e<X+_i;
_e++){
f[_t][_e]={
part:K,real:_t==Z&&_e==X,elm:_o,rowspan:_a,colspan:_i}
}}
E=Math.max(E,X+1)
}
)
}
);
J+=Q.length
}
)
}
function S(K,J){
K=K.cloneNode(J);
K.removeAttribute("id");
return K
}
function D(J,Q){
var K;
K=f[Q];
if(K){
return K[J]
}}
function O(Q,J,K){
if(Q){
K=parseInt(K,10);
if(K===1){
Q.removeAttribute(J,1)
}else{
Q.setAttribute(J,K,1)
}}}
function g(J){
return J&&(Y.hasClass(J.elm,"mce-item-selected")||J==q)
}
function b(){
var J=[];
d(G.rows,function(K){
d(K.cells,function(Q){
if(Y.hasClass(Q,"mce-item-selected")||(q&&Q==q.elm)){
J.push(K);
return false
}}
)
}
);
return J
}
function T(){
var J=Y.createRng();
J.setStartAfter(G);
J.setEndAfter(G);
P.setRng(J);
Y.remove(G)
}
function m(J){
var Q,K={};
if(x.settings.table_clone_elements!==false){
K=c.makeMap((x.settings.table_clone_elements||"strong em b i span font h1 h2 h3 h4 h5 h6 p div").toUpperCase(),/[ ,]/)
}
c.walk(J,function(Z){
var V;
if(Z.nodeType==3){
d(Y.getParents(Z.parentNode,null,J).reverse(),function(X){
if(!K[X.nodeName]){
return
}
X=S(X,false);
if(!Q){
Q=V=X
}else{
if(V){
V.appendChild(X)
}}
V=X
}
);
if(V){
V.innerHTML=l.ie?"&nbsp;":'<br data-mce-bogus="1" />'
}
return false
}}
,"childNodes");
J=S(J,false);
O(J,"rowSpan",1);
O(J,"colSpan",1);
if(Q){
J.appendChild(Q)
}else{
u.paddCell(J)
}
return J
}
function z(){
var J=Y.createRng(),K;
d(Y.select("tr",G),function(Q){
if(Q.cells.length===0){
Y.remove(Q)
}}
);
if(Y.select("tr",G).length===0){
J.setStartBefore(G);
J.setEndBefore(G);
P.setRng(J);
Y.remove(G);
return
}
d(Y.select("thead,tbody,tfoot",G),function(Q){
if(Q.rows.length===0){
Y.remove(Q)
}}
);
A();
if(U){
K=f[Math.min(f.length-1,U.y)];
if(K){
P.select(K[Math.min(K.length-1,U.x)].elm,true);
P.collapse(true)
}}}
function W(_e,Z,_a,X){
var V,K,J,Q,_t;
V=f[Z][_e].elm.parentNode;
for(J=1;
J<=_a;
J++){
V=Y.getNext(V,"tr");
if(V){
for(K=_e;
K>=0;
K--){
_t=f[Z+J][K].elm;
if(_t.parentNode==V){
for(Q=1;
Q<=X;
Q++){
Y.insertAfter(m(_t),_t)
}
break
}}
if(K==-1){
for(Q=1;
Q<=X;
Q++){
V.insertBefore(m(V.cells[0]),V.cells[0])
}}}}}
function M(){
d(f,function(J,K){
d(J,function(V,Q){
var _e,X,Z;
if(g(V)){
V=V.elm;
_e=h(V,"colspan");
X=h(V,"rowspan");
if(_e>1||X>1){
O(V,"rowSpan",1);
O(V,"colSpan",1);
for(Z=0;
Z<_e-1;
Z++){
Y.insertAfter(m(V),V)
}
W(Q,K,X-1,_e)
}}}
)
}
)
}
function j(_o,_t,_r){
var _e,V,Q,_s,_n,_i,X,_a,J,K,Z;
if(_o){
_e=I(_o);
V=_e.x;
Q=_e.y;
_s=V+(_t-1);
_n=Q+(_r-1)
}else{
U=R=null;
d(f,function(_h,_l){
d(_h,function(_d,_c){
if(g(_d)){
if(!U){
U={
x:_c,y:_l}
}
R={
x:_c,y:_l}
}}
)
}
);
if(U){
V=U.x;
Q=U.y;
_s=R.x;
_n=R.y
}}
_a=D(V,Q);
J=D(_s,_n);
if(_a&&J&&_a.part==J.part){
M();
A();
_a=D(V,Q).elm;
O(_a,"colSpan",(_s-V)+1);
O(_a,"rowSpan",(_n-Q)+1);
for(X=Q;
X<=_n;
X++){
for(_i=V;
_i<=_s;
_i++){
if(!f[X]||!f[X][_i]){
continue
}
_o=f[X][_i].elm;
if(_o!=_a){
K=c.grep(_o.childNodes);
d(K,function(_h){
_a.appendChild(_h)
}
);
if(K.length){
K=c.grep(_a.childNodes);
Z=0;
d(K,function(_h){
if(_h.nodeName=="BR"&&Y.getAttrib(_h,"data-mce-bogus")&&Z++<K.length-1){
_a.removeChild(_h)
}}
)
}
Y.remove(_o)
}}}
z()
}}
function w(Z){
var J,_e,V,X,_t,_a,K,_i,Q;
d(f,function(_o,_n){
d(_o,function(_s){
if(g(_s)){
_s=_s.elm;
_t=_s.parentNode;
_a=S(_t,false);
J=_n;
if(Z){
return false
}}}
);
if(Z){
return !J
}}
);
if(J===s){
return
}
for(X=0;
X<f[0].length;
X++){
if(!f[J][X]){
continue
}
_e=f[J][X].elm;
if(_e!=V){
if(!Z){
Q=h(_e,"rowspan");
if(Q>1){
O(_e,"rowSpan",Q+1);
continue
}}else{
if(J>0&&f[J-1][X]){
_i=f[J-1][X].elm;
Q=h(_i,"rowSpan");
if(Q>1){
O(_i,"rowSpan",Q+1);
continue
}}}
K=m(_e);
O(K,"colSpan",_e.colSpan);
_a.appendChild(K);
V=_e
}}
if(_a.hasChildNodes()){
if(!Z){
Y.insertAfter(_a,_t)
}else{
_t.parentNode.insertBefore(_a,_t)
}}}
function p(K){
var Q,J;
d(f,function(V){
d(V,function(X,Z){
if(g(X)){
Q=Z;
if(K){
return false
}}}
);
if(K){
return !Q
}}
);
d(f,function(_e,_t){
var V,Z,X;
if(!_e[Q]){
return
}
V=_e[Q].elm;
if(V!=J){
X=h(V,"colspan");
Z=h(V,"rowspan");
if(X==1){
if(!K){
Y.insertAfter(m(V),V);
W(Q,_t,Z-1,X)
}else{
V.parentNode.insertBefore(m(V),V);
W(Q,_t,Z-1,X)
}}else{
O(V,"colSpan",V.colSpan+1)
}
J=V
}}
)
}
function k(){
var J=[];
d(f,function(K){
d(K,function(V,Q){
if(g(V)&&c.inArray(J,Q)===-1){
d(f,function(_e){
var Z=_e[Q].elm,X;
X=h(Z,"colSpan");
if(X>1){
O(Z,"colSpan",X-1)
}else{
Y.remove(Z)
}}
);
J.push(Q)
}}
)
}
);
z()
}
function v(){
var K;
function J(V){
var Z,Q;
d(V.cells,function(X){
var _e=h(X,"rowSpan");
if(_e>1){
O(X,"rowSpan",_e-1);
Z=I(X);
W(Z.x,Z.y,1,1)
}}
);
Z=I(V.cells[0]);
d(f[Z.y],function(X){
var _e;
X=X.elm;
if(X!=Q){
_e=h(X,"rowSpan");
if(_e<=1){
Y.remove(X)
}else{
O(X,"rowSpan",_e-1)
}
Q=X
}}
)
}
K=b();
d(K.reverse(),function(Q){
J(Q)
}
);
z()
}
function H(){
var J=b();
Y.remove(J);
z();
return J
}
function N(){
var J=b();
d(J,function(Q,K){
J[K]=S(Q,true)
}
);
return J
}
function F(Q,K){
var V=b(),J=V[K?0:V.length-1],Z=J.cells.length;
if(!Q){
return
}
d(f,function(_e){
var X;
Z=0;
d(_e,function(_t){
if(_t.real){
Z+=_t.colspan
}
if(_t.elm.parentNode==J){
X=1
}}
);
if(X){
return false
}}
);
if(!K){
Q.reverse()
}
d(Q,function(_a){
var _e,_t=_a.cells.length,X;
for(_e=0;
_e<_t;
_e++){
X=_a.cells[_e];
O(X,"colSpan",1);
O(X,"rowSpan",1)
}
for(_e=_t;
_e<Z;
_e++){
_a.appendChild(m(_a.cells[_t-1]))
}
for(_e=Z;
_e<_t;
_e++){
Y.remove(_a.cells[_e])
}
if(K){
J.parentNode.insertBefore(_a,J)
}else{
Y.insertAfter(_a,J)
}}
);
Y.removeClass(Y.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected")
}
function I(J){
var K;
d(f,function(Q,V){
d(Q,function(X,Z){
if(X.elm==J){
K={
x:Z,y:V};
return false
}}
);
return !K
}
);
return K
}
function C(J){
U=I(J)
}
function L(){
var K,J;
K=J=0;
d(f,function(Q,V){
d(Q,function(X,Z){
var _t,_e;
if(g(X)){
X=f[V][Z];
if(Z>K){
K=Z
}
if(V>J){
J=V
}
if(X.real){
_t=X.colspan-1;
_e=X.rowspan-1;
if(_t){
if(Z+_t>K){
K=Z+_t
}}
if(_e){
if(V+_e>J){
J=V+_e
}}}}}
)
}
);
return{
x:K,y:J}
}
function B(_a){
var V,Q,_o,_i,K,J,Z,X,_t,_e;
R=I(_a);
if(U&&R){
V=Math.min(U.x,R.x);
Q=Math.min(U.y,R.y);
_o=Math.max(U.x,R.x);
_i=Math.max(U.y,R.y);
K=_o;
J=_i;
for(_e=Q;
_e<=J;
_e++){
_a=f[_e][V];
if(!_a.real){
if(V-(_a.colspan-1)<V){
V-=_a.colspan-1
}}}
for(_t=V;
_t<=K;
_t++){
_a=f[Q][_t];
if(!_a.real){
if(Q-(_a.rowspan-1)<Q){
Q-=_a.rowspan-1
}}}
for(_e=Q;
_e<=_i;
_e++){
for(_t=V;
_t<=_o;
_t++){
_a=f[_e][_t];
if(_a.real){
Z=_a.colspan-1;
X=_a.rowspan-1;
if(Z){
if(_t+Z>K){
K=_t+Z
}}
if(X){
if(_e+X>J){
J=_e+X
}}}}}
Y.removeClass(Y.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected");
for(_e=Q;
_e<=J;
_e++){
for(_t=V;
_t<=K;
_t++){
if(f[_e][_t]){
Y.addClass(f[_e][_t].elm,"mce-item-selected")
}}}}}
function y(Q,Z){
var V,K,J;
V=I(Q);
K=V.y*E+V.x;
do{
K+=Z;
J=D(K%E,Math.floor(K/E));
if(!J){
break
}
if(J.elm!=Q){
P.select(J.elm,true);
if(Y.isEmpty(J.elm)){
P.collapse(true)
}
return true
}}
while(J.elm==Q);
return false
}
G=G||Y.getParent(P.getStart(true),"table");
A();
q=Y.getParent(P.getStart(true),"th,td");
if(q){
U=I(q);
R=L();
q=D(U.x,U.y)
}
c.extend(this,{
deleteTable:T,split:M,merge:j,insertRow:w,insertCol:p,deleteCols:k,deleteRows:v,cutRows:H,copyRows:N,pasteRows:F,getPos:I,setStartCell:C,setEndCell:B,moveRelIdx:y,refresh:A}
)
}
}
);
r("tinymce/tableplugin/Quirks",["tinymce/util/VK","tinymce/Env","tinymce/util/Tools","tinymce/tableplugin/Utils"],function(m,l,c,u){
var d=c.each,h=u.getSpanVal;
return function(b){
function w(){
function v(W){
var M=W.keyCode;
function O(P,E){
var Y=P?"previousSibling":"nextSibling";
var U=b.dom.getParent(E,"tr");
var N=U[Y];
if(N){
C(b,E,N,P);
W.preventDefault();
return true
}
var J=b.dom.getParent(U,"table");
var L=U.parentNode;
var I=L.nodeName.toLowerCase();
if(I==="tbody"||I===(P?"tfoot":"thead")){
var G=x(P,J,L,"tbody");
if(G!==null){
return j(P,G,E)
}}
return F(P,U,Y,J)
}
function x(L,E,G,P){
var Y=b.dom.select(">"+P,E);
var I=Y.indexOf(G);
if(L&&I===0||!L&&I===Y.length-1){
return z(L,E)
}else{
if(I===-1){
var N=G.tagName.toLowerCase()==="thead"?0:Y.length-1;
return Y[N]
}}
return Y[I+(L?-1:1)]
}
function z(G,E){
var Y=G?"thead":"tfoot";
var I=b.dom.select(">"+Y,E);
return I.length!==0?I[0]:null
}
function j(G,E,Y){
var I=k(E,G);
if(I){
C(b,Y,I,G)
}
W.preventDefault();
return true
}
function F(P,G,I,N){
var Y=N[I];
if(Y){
S(Y);
return true
}
var L=b.dom.getParent(N,"td,th");
if(L){
return O(P,L,W)
}
var E=k(G,!P);
S(E);
W.preventDefault();
return false
}
function k(Y,I){
var E=Y&&Y[I?"lastChild":"firstChild"];
return E&&E.nodeName==="BR"?b.dom.getParent(E,"td,th"):E
}
function S(I){
b.selection.setCursorLocation(I,0)
}
function B(){
return M==m.UP||M==m.DOWN
}
function D(Y){
var E=Y.selection.getNode();
var I=Y.dom.getParent(E,"tr");
return I!==null
}
function A(Y){
var I=0;
var E=Y;
while(E.previousSibling){
E=E.previousSibling;
I=I+h(E,"colspan")
}
return I
}
function q(E,I){
var G=0,Y=0;
d(E.children,function(L,N){
G=G+h(L,"colspan");
Y=N;
if(G>I){
return false
}}
);
return Y
}
function C(E,N,U,L){
var P=A(b.dom.getParent(N,"td,th"));
var Y=q(U,P);
var I=U.childNodes[Y];
var G=k(I,L);
S(G||I)
}
function H(I){
var E=b.selection.getNode();
var G=b.dom.getParent(E,"td,th");
var Y=b.dom.getParent(I,"td,th");
return G&&G!==Y&&T(G,Y)
}
function T(Y,I){
return b.dom.getParent(Y,"TABLE")===b.dom.getParent(I,"TABLE")
}
if(B()&&D(b)){
var R=b.selection.getNode();
setTimeout(function(){
if(H(R)){
O(!W.shiftKey&&M===m.UP,R,W)
}}
,0)
}}
b.on("KeyDown",function(k){
v(k)
}
)
}
function f(){
function v(x,q){
var j=q.ownerDocument,k=j.createRange(),z;
k.setStartBefore(q);
k.setEnd(x.endContainer,x.endOffset);
z=j.createElement("body");
z.appendChild(k.cloneContents());
return z.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,"").length===0
}
b.on("KeyDown",function(q){
var k,x,j=b.dom;
if(q.keyCode==37||q.keyCode==38){
k=b.selection.getRng();
x=j.getParent(k.startContainer,"table");
if(x&&b.getBody().firstChild==x){
if(v(k,x)){
k=j.createRng();
k.setStartBefore(x);
k.setEndBefore(x);
b.selection.setRng(k);
q.preventDefault()
}}}}
)
}
function g(){
b.on("KeyDown SetContent VisualAid",function(){
var v;
for(v=b.getBody().lastChild;
v;
v=v.previousSibling){
if(v.nodeType==3){
if(v.nodeValue.length>0){
break
}}else{
if(v.nodeType==1&&(v.tagName=="BR"||!v.getAttribute("data-mce-bogus"))){
break
}}}
if(v&&v.nodeName=="TABLE"){
if(b.settings.forced_root_block){
b.dom.add(b.getBody(),b.settings.forced_root_block,b.settings.forced_root_block_attrs,l.ie&&l.ie<11?"&nbsp;":'<br data-mce-bogus="1" />')
}else{
b.dom.add(b.getBody(),"br",{
"data-mce-bogus":"1"}
)
}}}
);
b.on("PreProcess",function(k){
var v=k.node.lastChild;
if(v&&(v.nodeName=="BR"||(v.childNodes.length==1&&(v.firstChild.nodeName=="BR"||v.firstChild.nodeValue=="\u00a0")))&&v.previousSibling&&v.previousSibling.nodeName=="TABLE"){
b.dom.remove(v)
}}
)
}
function p(){
function v(O,q,j,W){
var z=3,B=O.dom.getParent(q.startContainer,"TABLE");
var T,x,A;
if(B){
T=B.parentNode
}
x=q.startContainer.nodeType==z&&q.startOffset===0&&q.endOffset===0&&W&&(j.nodeName=="TR"||j==T);
A=(j.nodeName=="TD"||j.nodeName=="TH")&&!W;
return x||A
}
function k(){
var q=b.selection.getRng();
var z=b.selection.getNode();
var j=b.dom.getParent(q.startContainer,"TD,TH");
if(!v(b,q,z,j)){
return
}
if(!j){
j=z
}
var x=j.lastChild;
while(x.lastChild){
x=x.lastChild
}
if(x.nodeType==3){
q.setEnd(x,x.data.length);
b.selection.setRng(q)
}}
b.on("KeyDown",function(){
k()
}
);
b.on("MouseDown",function(x){
if(x.button!=2){
k()
}}
)
}
function y(){
function k(x){
b.selection.select(x,true);
b.selection.collapse(true)
}
function v(x){
b.$(x).empty();
u.paddCell(x)
}
b.on("keydown",function(j){
if((j.keyCode==m.DELETE||j.keyCode==m.BACKSPACE)&&!j.isDefaultPrevented()){
var q,T,z,x;
q=b.dom.getParent(b.selection.getStart(),"table");
if(q){
T=b.dom.select("td,th",q);
z=c.grep(T,function(O){
return b.dom.hasClass(O,"mce-item-selected")
}
);
if(z.length===0){
x=b.dom.getParent(b.selection.getStart(),"td,th");
if(b.selection.isCollapsed()&&x&&b.dom.isEmpty(x)){
j.preventDefault();
v(x);
k(x)
}
return
}
j.preventDefault();
if(T.length==z.length){
b.execCommand("mceTableDelete")
}else{
c.each(z,v);
k(z[0])
}}}}
)
}
y();
if(l.webkit){
w();
p()
}
if(l.gecko){
f();
g()
}
if(l.ie>10){
f();
g()
}}
}
);
r("tinymce/tableplugin/CellSelection",["tinymce/tableplugin/TableGrid","tinymce/dom/TreeWalker","tinymce/util/Tools"],function(l,c,h){
return function(p){
var m=p.dom,b,y,u,w=true,g;
function f(v){
p.getBody().style.webkitUserSelect="";
if(v||w){
p.dom.removeClass(p.dom.select("td.mce-item-selected,th.mce-item-selected"),"mce-item-selected");
w=false
}}
function d(j){
var x,k,q=j.target;
if(g){
return
}
if(y&&(b||q!=y)&&(q.nodeName=="TD"||q.nodeName=="TH")){
k=m.getParent(q,"table");
if(k==u){
if(!b){
b=new l(p,k);
b.setStartCell(y);
p.getBody().style.webkitUserSelect="none"
}
b.setEndCell(q);
w=true
}
x=p.selection.getSel();
try{
if(x.removeAllRanges){
x.removeAllRanges()
}else{
x.empty()
}}
catch(v){}
j.preventDefault()
}}
p.on("MouseDown",function(v){
if(v.button!=2&&!g){
f();
y=m.getParent(v.target,"td,th");
u=m.getParent(y,"table")
}}
);
p.on("mouseover",d);
p.on("remove",function(){
m.unbind(p.getDoc(),"mouseover",d)
}
);
p.on("MouseUp",function(){
var k,z=p.selection,v,T,j,q;
function x(O,W){
var A=new c(O,O);
do{
if(O.nodeType==3&&h.trim(O.nodeValue).length!==0){
if(W){
k.setStart(O,0)
}else{
k.setEnd(O,O.nodeValue.length)
}
return
}
if(O.nodeName=="BR"){
if(W){
k.setStartBefore(O)
}else{
k.setEndBefore(O)
}
return
}}
while((O=(W?A.next():A.prev())))
}
if(y){
if(b){
p.getBody().style.webkitUserSelect=""
}
v=m.select("td.mce-item-selected,th.mce-item-selected");
if(v.length>0){
k=m.createRng();
j=v[0];
k.setStartBefore(j);
k.setEndAfter(j);
x(j,1);
T=new c(j,m.getParent(v[0],"table"));
do{
if(j.nodeName=="TD"||j.nodeName=="TH"){
if(!m.hasClass(j,"mce-item-selected")){
break
}
q=j
}}
while((j=T.next()));
x(q);
z.setRng(k)
}
p.nodeChanged();
y=b=u=null
}}
);
p.on("KeyUp Drop SetContent",function(v){
f(v.type=="setcontent");
y=b=u=null;
g=false
}
);
p.on("ObjectResizeStart ObjectResized",function(v){
g=v.type!="objectresized"
}
);
return{
clear:f}
}
}
);
r("tinymce/tableplugin/Dialogs",["tinymce/util/Tools","tinymce/Env"],function(l,h){
var c=l.each;
return function(m){
var x=this;
function g(){
var q=m.settings.color_picker_callback;
if(q){
return function(){
var j=this;
q.call(m,function(z){
j.value(z).fire("change")
}
,j.value())
}
}}
function w(q){
return{
title:"Advanced",type:"form",defaults:{
onchange:function(){
k(q,this.parents().reverse()[0],this.name()=="style")
}}
,items:[{
label:"Style",name:"style",type:"textbox"}
,{
type:"form",padding:0,formItemDefaults:{
layout:"grid",alignH:["start","right"]}
,defaults:{
size:7}
,items:[{
label:"Border color",type:"colorbox",name:"borderColor",onaction:g()}
,{
label:"Background color",type:"colorbox",name:"backgroundColor",onaction:g()}
]}
]}
}
function u(q){
return q?q.replace(/px$/,""):""
}
function v(q){
if(/^[0-9]+$/.test(q)){
q+="px"
}
return q
}
function b(q){
c("left center right".split(" "),function(j){
m.formatter.remove("align"+j,{}
,q)
}
)
}
function f(q){
c("top middle bottom".split(" "),function(j){
m.formatter.remove("valign"+j,{}
,q)
}
)
}
function p(z,q,T){
function j(A,O){
O=O||[];
l.each(A,function(B){
var W={
text:B.text||B.title};
if(B.menu){
W.menu=j(B.menu)
}else{
W.value=B.value;
if(q){
q(W)
}}
O.push(W)
}
);
return O
}
return j(z,T||[])
}
function k(O,T,q){
var z=T.toJSON();
var j=O.parseStyle(z.style);
if(q){
T.find("#borderColor").value(j["border-color"]||"")[0].fire("change");
T.find("#backgroundColor").value(j["background-color"]||"")[0].fire("change")
}else{
j["border-color"]=z.borderColor;
j["background-color"]=z.backgroundColor
}
T.find("#style").value(O.serializeStyle(O.parseStyle(O.serializeStyle(j))))
}
function d(z,j,T){
var q=z.parseStyle(z.getAttrib(T,"style"));
if(q["border-color"]){
j.borderColor=q["border-color"]
}
if(q["background-color"]){
j.backgroundColor=q["background-color"]
}
j.style=z.serializeStyle(q)
}
function y(z,T,j){
var q=z.parseStyle(z.getAttrib(T,"style"));
c(j,function(O){
q[O.name]=O.value
}
);
z.setAttrib(T,"style",z.serializeStyle(z.parseStyle(z.serializeStyle(q))))
}
x.tableProps=function(){
x.table(true)
};
x.table=function(O){
var j=m.dom,W,C,A,q,T={}
,D,z;
function S(){
function M(Y,R,I){
if(Y.tagName==="TD"||Y.tagName==="TH"){
j.setStyle(Y,R,I)
}else{
if(Y.children){
for(var H=0;
H<Y.children.length;
H++){
M(Y.children[H],R,I)
}}}}
var F;
k(j,this);
T=l.extend(T,this.toJSON());
if(T["class"]===false){
delete T["class"]
}
m.undoManager.transact(function(){
if(!W){
W=m.plugins.table.insertTable(T.cols||1,T.rows||1)
}
m.dom.setAttribs(W,{
style:T.style,"class":T["class"]}
);
if(m.settings.table_style_by_css){
z=[];
z.push({
name:"border",value:T.border}
);
z.push({
name:"border-spacing",value:v(T.cellspacing)}
);
y(j,W,z);
j.setAttribs(W,{
"data-mce-border-color":T.borderColor,"data-mce-cell-padding":T.cellpadding,"data-mce-border":T.border}
);
if(W.children){
for(var R=0;
R<W.children.length;
R++){
M(W.children[R],"border",T.border);
M(W.children[R],"padding",v(T.cellpadding))
}}}else{
m.dom.setAttribs(W,{
border:T.border,cellpadding:T.cellpadding,cellspacing:T.cellspacing}
)
}
if(j.getAttrib(W,"width")&&!m.settings.table_style_by_css){
j.setAttrib(W,"width",u(T.width))
}else{
j.setStyle(W,"width",v(T.width))
}
j.setStyle(W,"height",v(T.height));
F=j.select("caption",W)[0];
if(F&&!T.caption){
j.remove(F)
}
if(!F&&T.caption){
F=j.create("caption");
F.innerHTML=!h.ie?'<br data-mce-bogus="1"/>':"\u00a0";
W.insertBefore(F,W.firstChild)
}
b(W);
if(T.align){
m.formatter.apply("align"+T.align,{}
,W)
}
m.focus();
m.addVisual()
}
)
}
function B(I,R){
var M=m.dom.select("td,th",I),H;
function F(L,G){
for(var E=0;
E<G.length;
E++){
var Y=j.getStyle(G[E],R);
if(typeof L==="undefined"){
L=Y
}
if(L!=Y){
return""
}}
return L
}
H=F(H,M);
return H
}
if(O===true){
W=j.getParent(m.selection.getStart(),"table");
if(W){
T={
width:u(j.getStyle(W,"width")||j.getAttrib(W,"width")),height:u(j.getStyle(W,"height")||j.getAttrib(W,"height")),cellspacing:u(j.getStyle(W,"border-spacing")||j.getAttrib(W,"cellspacing")),cellpadding:j.getAttrib(W,"data-mce-cell-padding")||j.getAttrib(W,"cellpadding")||B(W,"padding"),border:j.getAttrib(W,"data-mce-border")||j.getAttrib(W,"border")||B(W,"border"),borderColor:j.getAttrib(W,"data-mce-border-color"),caption:!!j.select("caption",W)[0],"class":j.getAttrib(W,"class")};
c("left center right".split(" "),function(F){
if(m.formatter.matchNode(W,"align"+F)){
T.align=F
}}
)
}}else{
C={
label:"Cols",name:"cols"};
A={
label:"Rows",name:"rows"}
}
if(m.settings.table_class_list){
if(T["class"]){
T["class"]=T["class"].replace(/\s*mce\-item\-table\s*/g,"")
}
q={
name:"class",type:"listbox",label:"Class",values:p(m.settings.table_class_list,function(F){
if(F.value){
F.textStyle=function(){
return m.formatter.getCssText({
block:"table",classes:[F.value]}
)
}
}}
)}
}
D={
type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{
type:"form",labelGapCalc:false,padding:0,layout:"grid",columns:2,defaults:{
type:"textbox",maxWidth:50}
,items:(m.settings.table_appearance_options!==false)?[C,A,{
label:"Width",name:"width"}
,{
label:"Height",name:"height"}
,{
label:"Cell spacing",name:"cellspacing"}
,{
label:"Cell padding",name:"cellpadding"}
,{
label:"Border",name:"border"}
,{
label:"Caption",name:"caption",type:"checkbox"}
]:[C,A,{
label:"Width",name:"width"}
,{
label:"Height",name:"height"}
]}
,{
label:"Alignment",name:"align",type:"listbox",text:"None",values:[{
text:"None",value:""}
,{
text:"Left",value:"left"}
,{
text:"Center",value:"center"}
,{
text:"Right",value:"right"}
]}
,q]};
if(m.settings.table_advtab!==false){
d(j,T,W);
m.windowManager.open({
title:"Table properties",data:T,bodyType:"tabpanel",body:[{
title:"General",type:"form",items:D}
,w(j)],onsubmit:S}
)
}else{
m.windowManager.open({
title:"Table properties",data:T,body:D,onsubmit:S}
)
}};
x.merge=function(j,q){
m.windowManager.open({
title:"Merge cells",body:[{
label:"Cols",name:"cols",type:"textbox",value:"1",size:10}
,{
label:"Rows",name:"rows",type:"textbox",value:"1",size:10}
],onsubmit:function(){
var z=this.toJSON();
m.undoManager.transact(function(){
j.merge(q,z.cols,z.rows)
}
)
}}
)
};
x.cell=function(){
var W=m.dom,z,A,T,q=[];
function O(){
k(W,this);
A=l.extend(A,this.toJSON());
m.undoManager.transact(function(){
c(q,function(B){
m.dom.setAttribs(B,{
scope:A.scope,style:A.style,"class":A["class"]}
);
m.dom.setStyles(B,{
width:v(A.width),height:v(A.height)}
);
if(A.type&&B.nodeName.toLowerCase()!=A.type){
B=W.rename(B,A.type)
}
b(B);
if(A.align){
m.formatter.apply("align"+A.align,{}
,B)
}
f(B);
if(A.valign){
m.formatter.apply("valign"+A.valign,{}
,B)
}}
);
m.focus()
}
)
}
q=m.dom.select("td.mce-item-selected,th.mce-item-selected");
z=m.dom.getParent(m.selection.getStart(),"td,th");
if(!q.length&&z){
q.push(z)
}
z=z||q[0];
if(!z){
return
}
A={
width:u(W.getStyle(z,"width")||W.getAttrib(z,"width")),height:u(W.getStyle(z,"height")||W.getAttrib(z,"height")),scope:W.getAttrib(z,"scope"),"class":W.getAttrib(z,"class")};
A.type=z.nodeName.toLowerCase();
c("left center right".split(" "),function(B){
if(m.formatter.matchNode(z,"align"+B)){
A.align=B
}}
);
c("top middle bottom".split(" "),function(B){
if(m.formatter.matchNode(z,"valign"+B)){
A.valign=B
}}
);
if(m.settings.table_cell_class_list){
T={
name:"class",type:"listbox",label:"Class",values:p(m.settings.table_cell_class_list,function(B){
if(B.value){
B.textStyle=function(){
return m.formatter.getCssText({
block:"td",classes:[B.value]}
)
}
}}
)}
}
var j={
type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{
type:"form",layout:"grid",columns:2,labelGapCalc:false,padding:0,defaults:{
type:"textbox",maxWidth:50}
,items:[{
label:"Width",name:"width"}
,{
label:"Height",name:"height"}
,{
label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{
text:"Cell",value:"td"}
,{
text:"Header cell",value:"th"}
]}
,{
label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{
text:"None",value:""}
,{
text:"Row",value:"row"}
,{
text:"Column",value:"col"}
,{
text:"Row group",value:"rowgroup"}
,{
text:"Column group",value:"colgroup"}
]}
,{
label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{
text:"None",value:""}
,{
text:"Left",value:"left"}
,{
text:"Center",value:"center"}
,{
text:"Right",value:"right"}
]}
,{
label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{
text:"None",value:""}
,{
text:"Top",value:"top"}
,{
text:"Middle",value:"middle"}
,{
text:"Bottom",value:"bottom"}
]}
]}
,T]};
if(m.settings.table_cell_advtab!==false){
d(W,A,z);
m.windowManager.open({
title:"Cell properties",bodyType:"tabpanel",data:A,body:[{
title:"General",type:"form",items:j}
,w(W)],onsubmit:O}
)
}else{
m.windowManager.open({
title:"Cell properties",data:A,body:j,onsubmit:O}
)
}};
x.row=function(){
var z=m.dom,A,W,B,q,T,C=[],j;
function O(){
var D,S,F;
k(z,this);
T=l.extend(T,this.toJSON());
m.undoManager.transact(function(){
var M=T.type;
c(C,function(R){
m.dom.setAttribs(R,{
scope:T.scope,style:T.style,"class":T["class"]}
);
m.dom.setStyles(R,{
height:v(T.height)}
);
if(M!=R.parentNode.nodeName.toLowerCase()){
D=z.getParent(R,"table");
S=R.parentNode;
F=z.select(M,D)[0];
if(!F){
F=z.create(M);
if(D.firstChild){
D.insertBefore(F,D.firstChild)
}else{
D.appendChild(F)
}}
F.appendChild(R);
if(!S.hasChildNodes()){
z.remove(S)
}}
b(R);
if(T.align){
m.formatter.apply("align"+T.align,{}
,R)
}}
);
m.focus()
}
)
}
A=m.dom.getParent(m.selection.getStart(),"table");
W=m.dom.getParent(m.selection.getStart(),"td,th");
c(A.rows,function(D){
c(D.cells,function(S){
if(z.hasClass(S,"mce-item-selected")||S==W){
C.push(D);
return false
}}
)
}
);
B=C[0];
if(!B){
return
}
T={
height:u(z.getStyle(B,"height")||z.getAttrib(B,"height")),scope:z.getAttrib(B,"scope"),"class":z.getAttrib(B,"class")};
T.type=B.parentNode.nodeName.toLowerCase();
c("left center right".split(" "),function(D){
if(m.formatter.matchNode(B,"align"+D)){
T.align=D
}}
);
if(m.settings.table_row_class_list){
q={
name:"class",type:"listbox",label:"Class",values:p(m.settings.table_row_class_list,function(D){
if(D.value){
D.textStyle=function(){
return m.formatter.getCssText({
block:"tr",classes:[D.value]}
)
}
}}
)}
}
j={
type:"form",columns:2,padding:0,defaults:{
type:"textbox"}
,items:[{
type:"listbox",name:"type",label:"Row type",text:"None",maxWidth:null,values:[{
text:"Header",value:"thead"}
,{
text:"Body",value:"tbody"}
,{
text:"Footer",value:"tfoot"}
]}
,{
type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{
text:"None",value:""}
,{
text:"Left",value:"left"}
,{
text:"Center",value:"center"}
,{
text:"Right",value:"right"}
]}
,{
label:"Height",name:"height"}
,q]};
if(m.settings.table_row_advtab!==false){
d(z,T,B);
m.windowManager.open({
title:"Row properties",data:T,bodyType:"tabpanel",body:[{
title:"General",type:"form",items:j}
,w(z)],onsubmit:O}
)
}else{
m.windowManager.open({
title:"Row properties",data:T,body:j,onsubmit:O}
)
}}
}
}
);
r("tinymce/tableplugin/Plugin",["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/tableplugin/Dialogs","tinymce/util/Tools","tinymce/dom/TreeWalker","tinymce/Env","tinymce/PluginManager"],function(g,p,y,m,h,f,c,l){
var u=h.each;
function d(T){
var O,W=this,v=new m(T);
function x(B){
return function(){
T.execCommand(B)
}
}
function q(F,S){
var M,B,D,C;
D='<table id="__mce"><tbody>';
for(M=0;
M<S;
M++){
D+="<tr>";
for(B=0;
B<F;
B++){
D+="<td>"+(c.ie?" ":"<br>")+"</td>"
}
D+="</tr>"
}
D+="</tbody></table>";
T.undoManager.transact(function(){
T.insertContent(D);
C=T.dom.get("__mce");
T.dom.setAttrib(C,"id",null);
T.dom.setAttribs(C,T.settings.table_default_attributes||{}
);
T.dom.setStyles(C,T.settings.table_default_styles||{}
)
}
);
return C
}
function k(C,B){
function D(){
C.disabled(!T.dom.getParent(T.selection.getStart(),B));
T.selection.selectorChanged(B,function(S){
C.disabled(!S)
}
)
}
if(T.initialized){
D()
}else{
T.on("init",D)
}}
function z(){
k(this,"table")
}
function j(){
k(this,"td,th")
}
function A(){
var C="";
C='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';
for(var D=0;
D<10;
D++){
C+="<tr>";
for(var B=0;
B<10;
B++){
C+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(D*10+B)+'" href="#" data-mce-x="'+B+'" data-mce-y="'+D+'"></a></td>'
}
C+="</tr>"
}
C+="</table>";
C+='<div class="mce-text-center" role="presentation">1 x 1</div>';
return C
}
function w(S,C,D){
var I=D.getEl().getElementsByTagName("table")[0];
var R,M,Y,H,B;
var F=D.isRtl()||D.parent().rel=="tl-tr";
I.nextSibling.innerHTML=(S+1)+" x "+(C+1);
if(F){
S=9-S
}
for(M=0;
M<10;
M++){
for(R=0;
R<10;
R++){
H=I.rows[M].childNodes[R].firstChild;
B=(F?R>=S:R<=S)&&M<=C;
T.dom.toggleClass(H,"mce-active",B);
if(B){
Y=H
}}}
return Y.parentNode
}
if(T.settings.table_grid===false){
T.addMenuItem("inserttable",{
text:"Insert table",icon:"table",context:"table",onclick:v.table}
)
}else{
T.addMenuItem("inserttable",{
text:"Insert table",icon:"table",context:"table",ariaHideMenu:true,onclick:function(B){
if(B.aria){
this.parent().hideAll();
B.stopImmediatePropagation();
v.table()
}}
,onshow:function(){
w(0,0,this.menu.items()[0])
}
,onhide:function(){
var B=this.menu.items()[0].getEl().getElementsByTagName("a");
T.dom.removeClass(B,"mce-active");
T.dom.addClass(B[0],"mce-active")
}
,menu:[{
type:"container",html:A(),onPostRender:function(){
this.lastX=this.lastY=0
}
,onmousemove:function(D){
var C=D.target,B,S;
if(C.tagName.toUpperCase()=="A"){
B=parseInt(C.getAttribute("data-mce-x"),10);
S=parseInt(C.getAttribute("data-mce-y"),10);
if(this.isRtl()||this.parent().rel=="tl-tr"){
B=9-B
}
if(B!==this.lastX||S!==this.lastY){
w(B,S,D.control);
this.lastX=B;
this.lastY=S
}}}
,onclick:function(C){
var B=this;
if(C.target.tagName.toUpperCase()=="A"){
C.preventDefault();
C.stopPropagation();
B.parent().cancel();
T.undoManager.transact(function(){
q(B.lastX+1,B.lastY+1)
}
);
T.addVisual()
}}}
]}
)
}
T.addMenuItem("tableprops",{
text:"Table properties",context:"table",onPostRender:z,onclick:v.tableProps}
);
T.addMenuItem("deletetable",{
text:"Delete table",context:"table",onPostRender:z,cmd:"mceTableDelete"}
);
T.addMenuItem("cell",{
separator:"before",text:"Cell",context:"table",menu:[{
text:"Cell properties",onclick:x("mceTableCellProps"),onPostRender:j}
,{
text:"Merge cells",onclick:x("mceTableMergeCells"),onPostRender:j}
,{
text:"Split cell",onclick:x("mceTableSplitCells"),onPostRender:j}
]}
);
T.addMenuItem("row",{
text:"Row",context:"table",menu:[{
text:"Insert row before",onclick:x("mceTableInsertRowBefore"),onPostRender:j}
,{
text:"Insert row after",onclick:x("mceTableInsertRowAfter"),onPostRender:j}
,{
text:"Delete row",onclick:x("mceTableDeleteRow"),onPostRender:j}
,{
text:"Row properties",onclick:x("mceTableRowProps"),onPostRender:j}
,{
text:"-"}
,{
text:"Cut row",onclick:x("mceTableCutRow"),onPostRender:j}
,{
text:"Copy row",onclick:x("mceTableCopyRow"),onPostRender:j}
,{
text:"Paste row before",onclick:x("mceTablePasteRowBefore"),onPostRender:j}
,{
text:"Paste row after",onclick:x("mceTablePasteRowAfter"),onPostRender:j}
]}
);
T.addMenuItem("column",{
text:"Column",context:"table",menu:[{
text:"Insert column before",onclick:x("mceTableInsertColBefore"),onPostRender:j}
,{
text:"Insert column after",onclick:x("mceTableInsertColAfter"),onPostRender:j}
,{
text:"Delete column",onclick:x("mceTableDeleteCol"),onPostRender:j}
]}
);
var b=[];
u("inserttable tableprops deletetable | cell row column".split(" "),function(B){
if(B=="|"){
b.push({
text:"-"}
)
}else{
b.push(T.menuItems[B])
}}
);
T.addButton("table",{
type:"menubutton",title:"Table",menu:b}
);
if(!c.isIE){
T.on("click",function(B){
B=B.target;
if(B.nodeName==="TABLE"){
T.selection.select(B);
T.nodeChanged()
}}
)
}
W.quirks=new p(T);
T.on("Init",function(){
W.cellSelection=new y(T)
}
);
T.on("PreInit",function(){
T.serializer.addAttributeFilter("data-mce-cell-padding,data-mce-border,data-mce-border-color",function(B,C){
var D=B.length;
while(D--){
B[D].attr(C,null)
}}
)
}
);
u({
mceTableSplitCells:function(B){
B.split()
}
,mceTableMergeCells:function(C){
var B;
B=T.dom.getParent(T.selection.getStart(),"th,td");
if(!T.dom.select("td.mce-item-selected,th.mce-item-selected").length){
v.merge(C,B)
}else{
C.merge()
}}
,mceTableInsertRowBefore:function(B){
B.insertRow(true)
}
,mceTableInsertRowAfter:function(B){
B.insertRow()
}
,mceTableInsertColBefore:function(B){
B.insertCol(true)
}
,mceTableInsertColAfter:function(B){
B.insertCol()
}
,mceTableDeleteCol:function(B){
B.deleteCols()
}
,mceTableDeleteRow:function(B){
B.deleteRows()
}
,mceTableCutRow:function(B){
O=B.cutRows()
}
,mceTableCopyRow:function(B){
O=B.copyRows()
}
,mceTablePasteRowBefore:function(B){
B.pasteRows(O,true)
}
,mceTablePasteRowAfter:function(B){
B.pasteRows(O)
}
,mceTableDelete:function(B){
B.deleteTable()
}}
,function(C,B){
T.addCommand(B,function(){
var D=new g(T);
if(D){
C(D);
T.execCommand("mceRepaint");
W.cellSelection.clear()
}}
)
}
);
u({
mceInsertTable:v.table,mceTableProps:function(){
v.table(true)
}
,mceTableRowProps:v.row,mceTableCellProps:v.cell}
,function(C,B){
T.addCommand(B,function(D,S){
C(S)
}
)
}
);
if(T.settings.table_tab_navigation!==false){
T.on("keydown",function(D){
var C,B,S;
if(D.keyCode==9){
C=T.dom.getParent(T.selection.getStart(),"th,td");
if(C){
D.preventDefault();
B=new g(T);
S=D.shiftKey?-1:1;
T.undoManager.transact(function(){
if(!B.moveRelIdx(C,S)&&S>0){
B.insertRow();
B.refresh();
B.moveRelIdx(C,S)
}}
)
}}}
)
}
W.insertTable=q
}
l.add("table",d)
}
)
}
)(this)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.textcolor.plugin")){
tinymce.PluginManager.add("textcolor",function(n){
var s,l;
l=n.settings.textcolor_rows||5;
s=n.settings.textcolor_cols||8;
function e(d){
var c;
n.dom.getParents(n.selection.getStart(),function(m){
var u;
if((u=m.style[d=="forecolor"?"color":"background-color"])){
c=u
}}
);
return c
}
function r(){
var u,c=[],d;
d=n.settings.textcolor_map||["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"];
for(u=0;
u<d.length;
u+=2){
c.push({
text:d[u+1],color:"#"+d[u]}
)
}
return c
}
function t(){
var c=this,d,m,p,k,v,w,f,u=c._id,g=0;
function b(y,q){
var x=y=="transparent";
return('<td class="mce-grid-cell'+(x?" mce-colorbtn-trans":"")+'"><div id="'+u+"-"+(g++)+'" data-mce-color="'+(y?y:"")+'" role="option" tabIndex="-1" style="'+(y?"background-color: "+y:"")+'" title="'+tinymce.translate(q)+'">'+(x?"&#215;":"")+"</div></td>")
}
d=r();
d.push({
text:tinymce.translate("No color"),color:"transparent"}
);
p='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>';
k=d.length-1;
for(w=0;
w<l;
w++){
p+="<tr>";
for(v=0;
v<s;
v++){
f=w*s+v;
if(f>k){
p+="<td></td>"
}else{
m=d[f];
p+=b(m.color,m.text)
}}
p+="</tr>"
}
if(n.settings.color_picker_callback){
p+=('<tr><td colspan="'+s+'" class="mce-custom-color-btn"><div id="'+u+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+u+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+tinymce.translate("Custom...")+"</button></div></td></tr>");
p+="<tr>";
for(v=0;
v<s;
v++){
p+=b("","Custom color")
}
p+="</tr>"
}
p+="</tbody></table>";
return p
}
function a(d,c){
n.undoManager.transact(function(){
n.focus();
n.formatter.apply(d,{
value:c}
);
n.nodeChanged()
}
)
}
function h(c){
n.undoManager.transact(function(){
n.focus();
n.formatter.remove(c,{
value:null}
,null,true);
n.nodeChanged()
}
)
}
function i(p){
var u=this.parent(),f;
function d(g){
u.hidePanel();
u.color(g);
a(u.settings.format,g)
}
function m(){
u.hidePanel();
u.resetColor();
h(u.settings.format)
}
function c(y,g){
y.style.background=g;
y.setAttribute("data-mce-color",g)
}
if(tinymce.DOM.getParent(p.target,".mce-custom-color-btn")){
u.hidePanel();
n.settings.color_picker_callback.call(n,function(w){
var g=u.panel.getEl().getElementsByTagName("table")[0];
var b,v,y;
b=tinymce.map(g.rows[g.rows.length-1].childNodes,function(k){
return k.firstChild
}
);
for(y=0;
y<b.length;
y++){
v=b[y];
if(!v.getAttribute("data-mce-color")){
break
}}
if(y==s){
for(y=0;
y<s-1;
y++){
c(b[y],b[y+1].getAttribute("data-mce-color"))
}}
c(v,w);
d(w)
}
,e(u.settings.format))
}
f=p.target.getAttribute("data-mce-color");
if(f){
if(this.lastId){
document.getElementById(this.lastId).setAttribute("aria-selected",false)
}
p.target.setAttribute("aria-selected",true);
this.lastId=p.target.id;
if(f=="transparent"){
m()
}else{
d(f)
}}else{
if(f!==null){
u.hidePanel()
}}}
function o(){
var c=this;
if(c._color){
a(c.settings.format,c._color)
}else{
h(c.settings.format)
}}
n.addButton("forecolor",{
type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{
role:"application",ariaRemember:true,html:t,onclick:i}
,onclick:o}
);
n.addButton("backcolor",{
type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{
role:"application",ariaRemember:true,html:t,onclick:i}
,onclick:o}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.lists.plugin")){
tinymce.PluginManager.add("lists",function(i){
var e=this;
function t(s){
return s&&(/^(OL|UL|DL)$/).test(s.nodeName)
}
function a(s){
return s.parentNode.firstChild==s
}
function n(s){
return s.parentNode.lastChild==s
}
function o(s){
return s&&!!i.schema.getTextBlockElements()[s.nodeName]
}
i.on("init",function(){
var b=i.dom,q=i.selection;
function p(T,z){
var j=b.isEmpty(T);
if(z&&b.select("span[data-mce-type=bookmark]").length>0){
return false
}
return j
}
function u(j){
var z={};
function T(B){
var A,O,W;
O=j[B?"startContainer":"endContainer"];
W=j[B?"startOffset":"endOffset"];
if(O.nodeType==1){
A=b.create("span",{
"data-mce-type":"bookmark"}
);
if(O.hasChildNodes()){
W=Math.min(W,O.childNodes.length-1);
if(B){
O.insertBefore(A,O.childNodes[W])
}else{
b.insertAfter(A,O.childNodes[W])
}}else{
O.appendChild(A)
}
O=A;
W=0
}
z[B?"startContainer":"endContainer"]=O;
z[B?"startOffset":"endOffset"]=W
}
T(true);
if(!j.collapsed){
T()
}
return z
}
function h(z){
function T(C){
var O,W,A;
function B(S){
var F=S.parentNode.firstChild,D=0;
while(F){
if(F==S){
return D
}
if(F.nodeType!=1||F.getAttribute("data-mce-type")!="bookmark"){
D++
}
F=F.nextSibling
}
return -1
}
O=A=z[C?"startContainer":"endContainer"];
W=z[C?"startOffset":"endOffset"];
if(!O){
return
}
if(O.nodeType==1){
W=B(O);
O=O.parentNode;
b.remove(A)
}
z[C?"startContainer":"endContainer"]=O;
z[C?"startOffset":"endOffset"]=W
}
T(true);
T();
var j=b.createRng();
j.setStart(z.startContainer,z.startOffset);
if(z.endContainer){
j.setEnd(z.endContainer,z.endOffset)
}
q.setRng(j)
}
function s(j,A){
var B,z,O=b.createFragment(),T;
var W=i.schema.getBlockElements();
if(i.settings.forced_root_block){
A=A||i.settings.forced_root_block
}
if(A){
z=b.create(A);
if(z.tagName===i.settings.forced_root_block){
b.setAttribs(z,i.settings.forced_root_block_attrs)
}
O.appendChild(z)
}
if(j){
while((B=j.firstChild)){
var C=B.nodeName;
if(!T&&(C!="SPAN"||B.getAttribute("data-mce-type")!="bookmark")){
T=true
}
if(W[C]){
O.appendChild(B);
z=null
}else{
if(A){
if(!z){
z=b.create(A);
O.appendChild(z)
}
z.appendChild(B)
}else{
O.appendChild(B)
}}}}
if(!i.settings.forced_root_block){
O.appendChild(b.create("br"))
}else{
if(!T&&(!tinymce.Env.ie||tinymce.Env.ie>10)){
z.appendChild(b.create("br",{
"data-mce-bogus":"1"}
))
}}
return O
}
function k(){
return tinymce.grep(q.getSelectedBlocks(),function(j){
return/^(LI|DT|DD)$/.test(j.nodeName)
}
)
}
function y(O,j,C){
var T,z,A,W;
function B(D){
tinymce.each(A,function(S){
D.parentNode.insertBefore(S,j.parentNode)
}
);
b.remove(D)
}
A=b.select('span[data-mce-type="bookmark"]',O);
C=C||s(j);
T=b.createRng();
T.setStartAfter(j);
T.setEndAfter(O);
z=T.extractContents();
for(W=z.firstChild;
W;
W=W.firstChild){
if(W.nodeName=="LI"&&b.isEmpty(W)){
b.remove(W);
break
}}
if(!b.isEmpty(z)){
b.insertAfter(z,O)
}
b.insertAfter(C,O);
if(p(j.parentNode)){
B(j.parentNode)
}
b.remove(j);
if(p(O)){
b.remove(O)
}}
function x(j){
var z,T;
z=j.nextSibling;
if(z&&t(z)&&z.nodeName==j.nodeName){
while((T=z.firstChild)){
j.appendChild(T)
}
b.remove(z)
}
z=j.previousSibling;
if(z&&t(z)&&z.nodeName==j.nodeName){
while((T=z.firstChild)){
j.insertBefore(T,j.firstChild)
}
b.remove(z)
}}
function l(j){
tinymce.each(tinymce.grep(b.select("ol,ul",j)),function(T){
var O,z=T.parentNode;
if(z.nodeName=="LI"&&z.firstChild==T){
O=z.previousSibling;
if(O&&O.nodeName=="LI"){
O.appendChild(T);
if(p(z)){
b.remove(z)
}}}
if(t(z)){
O=z.previousSibling;
if(O&&O.nodeName=="LI"){
O.appendChild(T)
}}}
)
}
function f(z){
var T=z.parentNode,j=T.parentNode,A;
function O(W){
if(p(W)){
b.remove(W)
}}
if(z.nodeName=="DD"){
b.rename(z,"DT");
return true
}
if(a(z)&&n(z)){
if(j.nodeName=="LI"){
b.insertAfter(z,j);
O(j);
b.remove(T)
}else{
if(t(j)){
b.remove(T,true)
}else{
j.insertBefore(s(z),T);
b.remove(T)
}}
return true
}else{
if(a(z)){
if(j.nodeName=="LI"){
b.insertAfter(z,j);
z.appendChild(T);
O(j)
}else{
if(t(j)){
j.insertBefore(z,T)
}else{
j.insertBefore(s(z),T);
b.remove(z)
}}
return true
}else{
if(n(z)){
if(j.nodeName=="LI"){
b.insertAfter(z,j)
}else{
if(t(j)){
b.insertAfter(z,T)
}else{
b.insertAfter(s(z),T);
b.remove(z)
}}
return true
}}}
if(j.nodeName=="LI"){
T=j;
A=s(z,"LI")
}else{
if(t(j)){
A=s(z,"LI")
}else{
A=s(z)
}}
y(T,z,A);
l(T.parentNode);
return true
}
function m(j){
var T,z;
function O(B,W){
var A;
if(t(B)){
while((A=j.lastChild.firstChild)){
W.appendChild(A)
}
b.remove(B)
}}
if(j.nodeName=="DT"){
b.rename(j,"DD");
return true
}
T=j.previousSibling;
if(T&&t(T)){
T.appendChild(j);
return true
}
if(T&&T.nodeName=="LI"&&t(T.lastChild)){
T.lastChild.appendChild(j);
O(j.lastChild,T.lastChild);
return true
}
T=j.nextSibling;
if(T&&t(T)){
T.insertBefore(j,T.firstChild);
return true
}
if(T&&T.nodeName=="LI"&&t(j.lastChild)){
return false
}
T=j.previousSibling;
if(T&&T.nodeName=="LI"){
z=b.create(j.parentNode.nodeName);
T.appendChild(z);
z.appendChild(j);
O(j.lastChild,z);
return true
}
return false
}
function g(){
var z=k();
if(z.length){
var T=u(q.getRng(true));
for(var j=0;
j<z.length;
j++){
if(!m(z[j])&&j===0){
break
}}
h(T);
i.nodeChanged();
return true
}}
function d(){
var T=k();
if(T.length){
var O=u(q.getRng(true));
var z,W,j=i.getBody();
z=T.length;
while(z--){
var A=T[z].parentNode;
while(A&&A!=j){
W=T.length;
while(W--){
if(T[W]===A){
T.splice(z,1);
break
}}
A=A.parentNode
}}
for(z=0;
z<T.length;
z++){
if(!f(T[z])&&z===0){
break
}}
h(O);
i.nodeChanged();
return true
}}
function w(T){
var z=q.getRng(true),A=u(z),O="LI";
T=T.toUpperCase();
if(T=="DL"){
O="DT"
}
function j(){
var F=[],B=i.getBody();
function D(Y){
var H,I;
H=z[Y?"startContainer":"endContainer"];
I=z[Y?"startOffset":"endOffset"];
if(H.nodeType==1){
H=H.childNodes[Math.min(I,H.childNodes.length-1)]||H
}
while(H.parentNode!=B){
if(o(H)){
return H
}
if(/^(TD|TH)$/.test(H.parentNode.nodeName)){
return H
}
H=H.parentNode
}
return H
}
var C=D(true);
var W=D();
var R,M=[];
for(var S=C;
S;
S=S.nextSibling){
M.push(S);
if(S==W){
break
}}
tinymce.each(M,function(H){
if(o(H)){
F.push(H);
R=null;
return
}
if(b.isBlock(H)||H.nodeName=="BR"){
if(H.nodeName=="BR"){
b.remove(H)
}
R=null;
return
}
var I=H.nextSibling;
if(tinymce.dom.BookmarkManager.isBookmarkNode(H)){
if(o(I)||(!I&&H.parentNode==B)){
R=null;
return
}}
if(!R){
R=b.create("p");
H.parentNode.insertBefore(R,H);
F.push(R)
}
R.appendChild(H)
}
);
return F
}
tinymce.each(j(),function(C){
var W,B;
B=C.previousSibling;
if(B&&t(B)&&B.nodeName==T){
W=B;
C=b.rename(C,O);
B.appendChild(C)
}else{
W=b.create(T);
C.parentNode.insertBefore(W,C);
W.appendChild(C);
C=b.rename(C,O)
}
x(W)
}
);
h(A)
}
function v(){
var z=u(q.getRng(true)),j=i.getBody();
tinymce.each(k(),function(T){
var A,O;
if(p(T)){
f(T);
return
}
for(A=T;
A&&A!=j;
A=A.parentNode){
if(t(A)){
O=A
}}
y(O,T)
}
);
h(z)
}
function c(z){
var j=b.getParent(q.getStart(),"OL,UL,DL");
if(j){
if(j.nodeName==z){
v(z)
}else{
var T=u(q.getRng(true));
x(b.rename(j,z));
h(T)
}}else{
w(z)
}}
function r(j){
return function(){
var z=b.getParent(i.selection.getStart(),"UL,OL,DL");
return z&&z.nodeName==j
}
}
e.backspaceDelete=function(A){
function W(D,F){
var S=D.startContainer,R=D.startOffset;
var C,M;
if(S.nodeType==3&&(F?R<S.data.length:R>0)){
return S
}
C=i.schema.getNonEmptyElements();
M=new tinymce.dom.TreeWalker(D.startContainer);
while((S=M[F?"next":"prev"]())){
if(S.nodeName=="LI"&&!S.hasChildNodes()){
return S
}
if(C[S.nodeName]){
return S
}
if(S.nodeType==3&&S.data.length>0){
return S
}}}
function B(D,M){
var F,S,C=D.parentNode;
if(t(M.lastChild)){
S=M.lastChild
}
F=M.lastChild;
if(F&&F.nodeName=="BR"&&D.hasChildNodes()){
b.remove(F)
}
if(p(M,true)){
b.$(M).empty()
}
if(!p(D,true)){
while((F=D.firstChild)){
M.appendChild(F)
}}
if(S){
M.appendChild(S)
}
b.remove(D);
if(p(C)){
b.remove(C)
}}
if(q.isCollapsed()){
var j=b.getParent(q.getStart(),"LI");
if(j){
var T=q.getRng(true);
var z=b.getParent(W(T,A),"LI");
if(z&&z!=j){
var O=u(T);
if(A){
B(z,j)
}else{
B(j,z)
}
h(O);
return true
}else{
if(!z){
if(!A&&v(j.parentNode.nodeName)){
return true
}}}}}};
i.on("BeforeExecCommand",function(T){
var z=T.command.toLowerCase(),j;
if(z=="indent"){
if(g()){
j=true
}}else{
if(z=="outdent"){
if(d()){
j=true
}}}
if(j){
i.fire("ExecCommand",{
command:T.command}
);
T.preventDefault();
return true
}}
);
i.addCommand("InsertUnorderedList",function(){
c("UL")
}
);
i.addCommand("InsertOrderedList",function(){
c("OL")
}
);
i.addCommand("InsertDefinitionList",function(){
c("DL")
}
);
i.addQueryStateHandler("InsertUnorderedList",r("UL"));
i.addQueryStateHandler("InsertOrderedList",r("OL"));
i.addQueryStateHandler("InsertDefinitionList",r("DL"));
i.on("keydown",function(j){
if(j.keyCode!=9||tinymce.util.VK.metaKeyPressed(j)){
return
}
if(i.dom.getParent(i.selection.getStart(),"LI,DT,DD")){
j.preventDefault();
if(j.shiftKey){
d()
}else{
g()
}}}
)
}
);
i.addButton("indent",{
icon:"indent",title:"Increase indent",cmd:"Indent",onPostRender:function(){
var s=this;
i.on("nodechange",function(){
var u=i.selection.getSelectedBlocks();
var c=false;
for(var d=0,h=u.length;
!c&&d<h;
d++){
var r=u[d].nodeName;
c=(r=="LI"&&a(u[d])||r=="UL"||r=="OL"||r=="DD")
}
s.disabled(c)
}
)
}}
);
i.on("keydown",function(s){
if(s.keyCode==tinymce.util.VK.BACKSPACE){
if(e.backspaceDelete()){
s.preventDefault()
}}else{
if(s.keyCode==tinymce.util.VK.DELETE){
if(e.backspaceDelete(true)){
s.preventDefault()
}}}}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.advlist.plugin")){
tinymce.PluginManager.add("advlist",function(i){
var s,n,t={};
function e(l,r){
var h=[];
tinymce.each(r.split(/[ ,]/),function(c){
h.push({
text:c.replace(/\-/g," ").replace(/\b\w/g,function(d){
return d.toUpperCase()
}
),data:c=="default"?"":c}
)
}
);
return h
}
s=e("OL",i.getParam("advlist_number_styles","default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman"));
n=e("UL",i.getParam("advlist_bullet_styles","default,circle,disc,square"));
function o(h,r){
i.undoManager.transact(function(){
var c,d=i.dom,l=i.selection;
c=d.getParent(l.getNode(),"ol,ul");
if(!c||c.nodeName!=h||r===false){
i.execCommand(h=="UL"?"InsertUnorderedList":"InsertOrderedList")
}
r=r===false?t[h]:r;
t[h]=r;
c=d.getParent(l.getNode(),"ol,ul");
if(c){
d.setStyle(c,"listStyleType",r?r:null);
c.removeAttribute("data-mce-style")
}
i.focus()
}
)
}
function a(h){
var r=i.dom.getStyle(i.dom.getParent(i.selection.getNode(),"ol,ul"),"listStyleType")||"";
h.control.items().each(function(l){
l.active(l.settings.data===r)
}
)
}
i.addButton("numlist",{
type:"splitbutton",tooltip:"Numbered list",menu:s,onshow:a,onselect:function(r){
o("OL",r.control.settings.data)
}
,onclick:function(){
o("OL",false)
}}
);
i.addButton("bullist",{
type:"splitbutton",tooltip:"Bullet list",menu:n,onshow:a,onselect:function(r){
o("UL",r.control.settings.data)
}
,onclick:function(){
o("UL",false)
}}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.plugins.code.plugin")){
tinymce.PluginManager.add("code",function(t){
function e(){
var a=t.windowManager.open({
title:"Source code",body:{
type:"textbox",name:"code",multiline:true,minWidth:t.getParam("code_dialog_width",600),minHeight:t.getParam("code_dialog_height",Math.min(tinymce.DOM.getViewPort().h-200,500)),spellcheck:false,style:"direction: ltr; text-align: left"}
,onSubmit:function(i){
t.focus();
t.undoManager.transact(function(){
t.setContent(i.data.code)
}
);
t.selection.setCursorLocation();
t.nodeChanged()
}}
);
a.find("#code").value(t.getContent({
source_view:true}
))
}
t.addCommand("mceCodeEditor",e);
t.addButton("code",{
icon:"code",tooltip:"Source code",onclick:e}
);
t.addMenuItem("code",{
icon:"code",text:"Source code",context:"tools",onclick:e}
)
}
)
}
if(AjxPackage.define("ajax.3rdparty.tinymce.themes.modern.theme")){
tinymce.ThemeManager.add("modern",function(o){
var d=this,g=o.settings,f=tinymce.ui.Factory,a=tinymce.each,y=tinymce.DOM,r=tinymce.ui.Rect,m=tinymce.ui.FloatPanel;
var c={
file:{
title:"File",items:"newdocument"}
,edit:{
title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"}
,insert:{
title:"Insert",items:"|"}
,view:{
title:"View",items:"visualaid |"}
,format:{
title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"}
,table:{
title:"Table"}
,tools:{
title:"Tools"}};
var i="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";
function e(v,k){
var x=[],w;
if(!v){
return
}
a(v.split(/[ ,]/),function(j){
var z;
function q(){
var T=o.selection;
if(z=="bullist"){
T.selectorChanged("ul > li",function(W,O){
var B,A=O.parents.length;
while(A--){
B=O.parents[A].nodeName;
if(B=="OL"||B=="UL"){
break
}}
j.active(W&&B=="UL")
}
)
}
if(z=="numlist"){
T.selectorChanged("ol > li",function(W,O){
var B,A=O.parents.length;
while(A--){
B=O.parents[A].nodeName;
if(B=="OL"||B=="UL"){
break
}}
j.active(W&&B=="OL")
}
)
}
if(j.settings.stateSelector){
T.selectorChanged(j.settings.stateSelector,function(O){
j.active(O)
}
,true)
}
if(j.settings.disabledStateSelector){
T.selectorChanged(j.settings.disabledStateSelector,function(O){
j.disabled(O)
}
)
}}
if(j=="|"){
w=null
}else{
if(f.has(j)){
j={
type:j,size:k};
x.push(j);
w=null
}else{
if(!w){
w={
type:"buttongroup",items:[]};
x.push(w)
}
if(o.buttons[j]){
z=j;
j=o.buttons[z];
if(typeof j=="function"){
j=j()
}
j.type=j.type||"button";
j.size=k;
j=f.create(j);
w.items.push(j);
if(o.initialized){
q()
}else{
o.on("init",q)
}}}}}
);
return{
type:"toolbar",layout:"flow",items:x}
}
function n(v){
var k=[];
function x(q){
if(q){
k.push(e(q,v));
return true
}}
if(tinymce.isArray(g.toolbar)){
if(g.toolbar.length===0){
return
}
tinymce.each(g.toolbar,function(j,q){
g["toolbar"+(q+1)]=j
}
);
delete g.toolbar
}
for(var w=1;
w<10;
w++){
if(!x(g["toolbar"+w])){
break
}}
if(!k.length&&g.toolbar!==false){
x(g.toolbar||i)
}
if(k.length){
return{
type:"panel",layout:"stack",classes:"toolbar-grp",ariaRoot:true,ariaRemember:true,items:k,ignoreTab:true}
}}
function b(){
var k,T=[];
function j(O){
var A;
if(O=="|"){
return{
text:"|"}
}
A=o.menuItems[O];
return A
}
function w(C){
var O,D,B,S,W;
W=tinymce.makeMap((g.removed_menuitems||"").split(/[ ,]/));
if(g.menu){
D=g.menu[C];
S=true
}else{
D=c[C]
}
if(D){
O={
text:D.title};
B=[];
a((D.items||"").split(/[ ,]/),function(M){
var F=j(M);
if(F&&!W[M]){
B.push(j(M))
}}
);
if(!S){
a(o.menuItems,function(F){
if(F.context==C){
if(F.separator=="before"){
B.push({
text:"|"}
)
}
if(F.prependToContext){
B.unshift(F)
}else{
B.push(F)
}
if(F.separator=="after"){
B.push({
text:"|"}
)
}}}
)
}
for(var A=0;
A<B.length;
A++){
if(B[A].text=="|"){
if(A===0||A==B.length-1){
B.splice(A,1)
}}}
O.menu=B;
if(!O.menu.length){
return null
}}
return O
}
var v=[];
if(g.menu){
for(k in g.menu){
v.push(k)
}}else{
for(k in c){
v.push(k)
}}
var q=typeof g.menubar=="string"?g.menubar.split(/[ ,]/):v;
for(var x=0;
x<q.length;
x++){
var z=q[x];
z=w(z);
if(z){
T.push(z)
}}
return T
}
function l(v){
function w(k){
var x=v.find(k)[0];
if(x){
x.focus(true)
}}
o.shortcuts.add("Alt+F9","",function(){
w("menubar")
}
);
o.shortcuts.add("Alt+F10","",function(){
w("toolbar")
}
);
o.shortcuts.add("Alt+F11","",function(){
w("elementpath")
}
);
v.on("cancel",function(){
o.focus()
}
)
}
function u(k,v){
var z,w,q,j;
function x(T){
return{
width:T.clientWidth,height:T.clientHeight}
}
z=o.getContainer();
w=o.getContentAreaContainer().firstChild;
q=x(z);
j=x(w);
if(k!==null){
k=Math.max(g.min_width||100,k);
k=Math.min(g.max_width||65535,k);
y.setStyle(z,"width",k+(q.width-j.width));
y.setStyle(w,"width",k)
}
v=Math.max(g.min_height||100,v);
v=Math.min(g.max_height||65535,v);
y.setStyle(w,"height",v);
o.fire("ResizeEditor")
}
function s(w,v){
var k=o.getContentAreaContainer();
d.resizeTo(k.clientWidth+w,k.clientHeight+v)
}
function p(){
var z;
function q(){
return o.contextToolbars||[]
}
function O(D){
var C,B,W;
C=tinymce.DOM.getPos(o.getContentAreaContainer());
B=o.dom.getRect(D);
W=o.dom.getRoot();
if(W.nodeName=="BODY"){
B.x-=W.ownerDocument.documentElement.scrollLeft||W.scrollLeft;
B.y-=W.ownerDocument.documentElement.scrollTop||W.scrollTop
}
B.x+=C.x;
B.y+=C.y;
return B
}
function j(){
a(o.contextToolbars,function(W){
if(W.panel){
W.panel.hide()
}}
)
}
function A(S){
var W,C,D,M,B,R,F;
if(o.removed){
return
}
if(!S||!S.toolbar.panel){
j();
return
}
F=["tc-bc","bc-tc","tl-bl","bl-tl","tr-br","br-tr"];
B=S.toolbar.panel;
B.show();
D=O(S.element);
C=tinymce.DOM.getRect(B.getEl());
M=tinymce.DOM.getRect(o.getContentAreaContainer()||o.getBody());
if(!o.inline){
M.w=o.getDoc().documentElement.offsetWidth
}
if(o.selection.controlSelection.isResizable(S.element)){
D=r.inflate(D,0,7)
}
W=r.findBestRelativePosition(C,D,M,F);
if(W){
a(F.concat("inside"),function(H){
B.classes.toggle("tinymce-inline-"+H,H==W)
}
);
R=r.relativePosition(C,D,W);
B.moveTo(R.x,R.y)
}else{
a(F,function(H){
B.classes.toggle("tinymce-inline-"+H,false)
}
);
B.classes.toggle("tinymce-inline-inside",true);
D=r.intersect(M,D);
if(D){
W=r.findBestRelativePosition(C,D,M,["tc-tc","tl-tl","tr-tr"]);
if(W){
R=r.relativePosition(C,D,W);
B.moveTo(R.x,R.y)
}else{
B.moveTo(D.x,D.y)
}}else{
B.hide()
}}}
function v(){
function W(){
if(o.selection){
A(w(o.selection.getNode()))
}}
if(window.requestAnimationFrame){
window.requestAnimationFrame(W)
}else{
W()
}}
function T(){
if(!z){
z=o.selection.getScrollContainer()||o.getWin();
tinymce.$(z).on("scroll",v);
o.on("remove",function(){
tinymce.$(z).off("scroll")
}
)
}}
function x(B){
var W;
if(B.toolbar.panel){
B.toolbar.panel.show();
A(B);
return
}
T();
W=f.create({
type:"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:false,autofix:true,fixed:true,border:1,items:e(B.toolbar.items)}
);
B.toolbar.panel=W;
W.renderTo(document.body).reflow();
A(B)
}
function k(){
tinymce.each(q(),function(W){
if(W.panel){
W.panel.hide()
}}
)
}
function w(C){
var B,S,W,D=q();
W=o.$(C).parents().add(C);
for(B=W.length-1;
B>=0;
B--){
for(S=D.length-1;
S>=0;
S--){
if(D[S].predicate(W[B])){
return{
toolbar:D[S],element:W[B]}
}}}
return null
}
o.on("click keyup",function(){
window.setTimeout(function(){
var W;
if(o.removed){
return
}
W=w(o.selection.getNode());
if(W){
x(W)
}else{
k()
}}
,0)
}
);
o.on("blur hide",k);
o.on("ObjectResizeStart",function(){
var W=w(o.selection.getNode());
if(W&&W.toolbar.panel){
W.toolbar.panel.hide()
}}
);
o.on("nodeChange ResizeEditor ResizeWindow",v);
o.on("remove",function(){
tinymce.each(q(),function(W){
if(W.panel){
W.panel.remove()
}}
);
o.contextToolbars={}
}
)
}
function h(x){
var k,z;
if(g.fixed_toolbar_container){
z=y.select(g.fixed_toolbar_container)[0]
}
function v(){
if(k&&k.moveRel&&k.visible()&&!k._fixed){
var B=o.selection.getScrollContainer(),O=o.getBody();
var A=0,T=0;
if(B){
var C=y.getPos(O),W=y.getPos(B);
A=Math.max(0,W.x-C.x);
T=Math.max(0,W.y-C.y)
}
k.fixed(false).moveRel(O,o.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl","tr-br"]).moveBy(A,T)
}}
function w(){
if(k){
k.show();
v();
y.addClass(o.getBody(),"mce-edit-focus")
}}
function q(){
if(k){
k.hide();
m.hideAll();
y.removeClass(o.getBody(),"mce-edit-focus")
}}
function j(){
if(k){
if(!k.visible()){
w()
}
return
}
k=d.panel=f.create({
type:z?"panel":"floatpanel",role:"application",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:false,autofix:true,fixed:!!z,border:1,items:[g.menubar===false?null:{
type:"menubar",border:"0 0 1 0",items:b()}
,n(g.toolbar_items_size)]}
);
o.fire("BeforeRenderUI");
k.renderTo(z||document.body).reflow();
l(k);
w();
p();
o.on("nodeChange",v);
o.on("activate",w);
o.on("deactivate",q);
o.nodeChanged()
}
g.content_editable=true;
o.on("focus",function(){
if(x.skinUiCss){
tinymce.DOM.styleSheetLoader.load(x.skinUiCss,j,j)
}else{
j()
}}
);
o.on("blur hide",q);
o.on("remove",function(){
if(k){
k.remove();
k=null
}}
);
if(x.skinUiCss){
tinymce.DOM.styleSheetLoader.load(x.skinUiCss)
}
return{}
}
function t(k){
var v,x,w;
if(k.skinUiCss){
tinymce.DOM.loadCSS(k.skinUiCss)
}
v=d.panel=f.create({
type:"panel",role:"application",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:[g.menubar===false?null:{
type:"menubar",border:"0 0 1 0",items:b()}
,n(g.toolbar_items_size),{
type:"panel",name:"iframe",layout:"stack",classes:"edit-area",html:"",border:"1 0 0 0"}
]}
);
if(g.resize!==false){
x={
type:"resizehandle",direction:g.resize,onResizeStart:function(){
var q=o.getContentAreaContainer().firstChild;
w={
width:q.clientWidth,height:q.clientHeight}
}
,onResize:function(q){
if(g.resize=="both"){
u(w.width+q.deltaX,w.height+q.deltaY)
}else{
u(null,w.height+q.deltaY)
}}}
}
if(g.statusbar!==false){
v.add({
type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",ariaRoot:true,items:[{
type:"elementpath"}
,x]}
)
}
if(g.readonly){
v.find("*").disabled(true)
}
o.fire("BeforeRenderUI");
v.renderBefore(k.targetNode).reflow();
if(g.width){
tinymce.DOM.setStyle(v.getEl(),"width",g.width)
}
o.on("remove",function(){
v.remove();
v=null
}
);
l(v);
p();
return{
iframeContainer:v.find("#iframe")[0].getEl(),editorContainer:v.getEl()}
}
d.renderUI=function(v){
var k=g.skin!==false?g.skin||"lightgray":false;
if(k){
var w=g.skin_url;
if(w){
w=o.documentBaseURI.toAbsolute(w)
}else{
w=tinymce.baseURL+"/skins/"+k
}
if(tinymce.Env.documentMode<=7){
v.skinUiCss=w+"/skin.ie7.min.css"
}else{
v.skinUiCss=w+"/skin.min.css"
}
o.contentCSS.push(w+"/content"+(o.inline?".inline":"")+".min.css")
}
o.on("ProgressState",function(x){
d.throbber=d.throbber||new tinymce.ui.Throbber(d.panel.getEl("body"));
if(x.state){
d.throbber.show(x.time)
}else{
d.throbber.hide()
}}
);
if(g.inline){
return h(v)
}
return t(v)
};
d.resizeTo=u;
d.resizeBy=s
}
)
}};