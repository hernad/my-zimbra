if(AjxPackage.define("XForms")){
if(AjxPackage.define("ajax.dwt.events.DwtXFormsEvent")){
DwtXFormsEvent=function(t,a,e){
if(arguments.length==0){
return
}
this.form=t;
this.formItem=a;
this.details=e
};
DwtEvent.prototype.toString=function(){
return"DwtXFormsEvent"
}
}
if(AjxPackage.define("ajax.dwt.events.DwtXModelEvent")){
DwtXModelEvent=function(e,o,a,t){
if(arguments.length==0){
return
}
this.instance=e;
this.modelItem=o;
this.refPath=a;
this.details=t
};
DwtEvent.prototype.toString=function(){
return"DwtXModelEvent"
}
}
if(AjxPackage.define("ajax.dwt.events.DwtIdleTimer")){
DwtIdleTimer=function(t,e){
DwtIdleTimer._initEvents();
this.timeout=t;
this.handler=e;
this.idle=false;
this._onIdle=AjxCallback.simpleClosure(this.setIdle,this);
this._startTimer();
DwtIdleTimer.getHandlers().add(this)
};
DwtIdleTimer.idleHandlers=0;
DwtIdleTimer.prototype.toString=function(){
return"DwtIdleTimer"
};
DwtIdleTimer.prototype.kill=function(){
this._stopTimer();
this.idle=false;
DwtIdleTimer.getHandlers().remove(this)
};
DwtIdleTimer.prototype.resurrect=function(e){
this.idle=false;
DwtIdleTimer.getHandlers().add(this,null,true);
if(e!=null){
this.timeout=e
}
this._startTimer()
};
DwtIdleTimer.prototype.setIdle=function(){
if(!this.idle){
DwtIdleTimer.idleHandlers++;
this.idle=true;
this.handler.run(true)
}};
DwtIdleTimer.prototype.resume=function(){
if(this.idle){
this.idle=false;
this.handler.run(false);
DwtIdleTimer.idleHandlers--
}};
DwtIdleTimer.prototype._startTimer=function(){
this._stopTimer();
this._timer=setTimeout(this._onIdle,this.timeout)
};
DwtIdleTimer.prototype._stopTimer=function(){
if(this._timer){
clearTimeout(this._timer);
this._timer=null
}};
DwtIdleTimer._initEvents=function(){
if(!DwtIdleTimer._initialized){
if(window.addEventListener){
window.addEventListener("keydown",DwtIdleTimer.resetIdle,true);
window.addEventListener("mousemove",DwtIdleTimer.resetIdle,true);
window.addEventListener("mousedown",DwtIdleTimer.resetIdle,true);
window.addEventListener("focus",DwtIdleTimer.resetIdle,true)
}else{
if(window.attachEvent){
document.body.attachEvent("onkeydown",DwtIdleTimer.resetIdle);
document.body.attachEvent("onkeyup",DwtIdleTimer.resetIdle);
document.body.attachEvent("onmousedown",DwtIdleTimer.resetIdle);
document.body.attachEvent("onmousemove",DwtIdleTimer.resetIdle);
document.body.attachEvent("onmouseover",DwtIdleTimer.resetIdle);
document.body.attachEvent("onmouseout",DwtIdleTimer.resetIdle);
window.attachEvent("onfocus",DwtIdleTimer.resetIdle)
}}
DwtIdleTimer._initialized=true
}};
DwtIdleTimer.getHandlers=function(){
var e=DwtIdleTimer.HANDLERS;
if(!e){
e=DwtIdleTimer.HANDLERS=new AjxVector()
}
return e
};
DwtIdleTimer.resetIdle=function(){
var e=DwtIdleTimer.getHandlers();
e.foreach("_startTimer");
if(DwtIdleTimer.idleHandlers>0){
e.foreach("resume")
}}
}
if(AjxPackage.define("ajax.dwt.xforms.XFormGlobal")){
XFG=function(){};
XFG.prefixList={};
XFG.objectCache={};
XFG.getUniqueId=function(t){
if(t==null){
t="__id__"
}
var e=XFG.prefixList;
if(e[t]==null){
e[t]=1;
return t
}else{
e[t]++;
return t+"_"+e[t]
}};
XFG.assignUniqueId=function(e,t){
var a=XFG.getUniqueId(t);
e.__id=a;
XFG.objectCache[a]=e
};
XFG.cacheGet=function(e){
return XFG.objectCache[e]
};
XFG.createEl=function(n,a,e,o){
if(e==null){
e="div"
}
var t=window.document.createElement(e);
t.id=n;
if(o!=null){
t.innerHTML=o
}
if(a==null){
a=document.body
}
a.appendChild(t);
return t
};
XFG.getEl=function(o,a){
if(typeof o!="string"){
return o
}
var t=(t==null?document:a.document);
var e=t.getElementById(o);
if(e==null){
e=null
}
return e
};
XFG.hideEl=function(a,e){
var t=(typeof a=="string"?XFG.getEl(a):a);
if(t){
if(!e){
t.style.display="none"
}
t.style.visibility="hidden"
}else{}};
XFG.showEl=function(t){
var e=(typeof t=="string"?XFG.getEl(t):t);
if(e){
if(e.tagName=="TD"){
e.style.display="table-cell"
}else{
e.style.display="block"
}
e.style.visibility="visible"
}else{}};
XFG.getClassName=function(e){
if(typeof e=="string"){
e=XFG.getEl(e)
}
if(e){
return e.className
}
return""
};
XFG.showSelected=function(e){
XFG.setClassName(e,XFG.addSuffix(XFG.getClassName(e),"_selected"))
};
XFG.hideSelected=function(e){
XFG.setClassName(e,XFG.removeSuffix(XFG.getClassName(e),"_selected"))
};
XFG.setClassName=function(e,t){
if(typeof e=="string"){
e=XFG.getEl(e)
}
if(e){
e.className=t
}};
XFG.addSuffix=function(t,e){
if(t.indexOf(e)>-1){
return t
}
return t+e
};
XFG.removeSuffix=function(t,e){
if(t.indexOf(e)<0){
return t
}
return t.substring(0,t.indexOf(e))
};
XFG.showOver=function(e){
XFG.setClassName(e,XFG.addSuffix(XFG.getClassName(e),"_over"))
};
XFG.hideOver=function(e){
XFG.setClassName(e,XFG.removeSuffix(XFG.getClassName(e),"_over"))
};
XFG.showDisabled=function(e){
XFG.setClassName(e,XFG.addSuffix(XFG.getClassName(e),"_disabled"))
};
XFG.hideDisabled=function(e){
XFG.setClassName(e,XFG.removeSuffix(XFG.getClassName(e),"_disabled"))
};
XFG.getCookie=function(e){
var t=new RegExp(e+"=([^;]+)").exec(document.cookie);
return(t!=null)?unescape(t[1]):null
};
XFG.setCookie=function(e,t){
document.cookie=e+"="+escape(t)
};
XFG.valueToString=function(n,s,a,t){
if(n==null){
return"null"
}
if(typeof n=="string"){
return'"'+n+'"'
}
if(n instanceof Array){
var e=new AjxBuffer();
for(var o=0;
o<n.length;
o++){
e.append("        ",XFG.valueToString(n[o],"    ",s,a,t))
}
return"[\n"+e.join(",\n")+"\n    ]"
}
if(n instanceof Date){
return" new Date("+[n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()].join(",")+")"
}
if(typeof n=="function"){
return"(function)"
}
if(typeof n=="object"){
return XFG.objectToString(n,"    ",s,a,t)
}
return n
};
XFG.objectToString=function(a,r,d,t){
var c="    ";
var n=[];
var o=false;
var l=0;
var s=a.constructor.prototype;
if(s==null){
s={}
}
for(var e in a){
var h=a[e];
if(t&&(a[e]==s[e])){
continue
}
if(d&&h instanceof Function){
continue
}
if((e.indexOf("__")==0||e.indexOf("$")==0)&&h instanceof Object){
n.push(AjxBuffer.concat(e,": ",h.toString()))
}else{
o=o||(typeof h=="object");
n.push(AjxBuffer.concat(e,": ",XFG.valueToString(h,r,d,t)))
}
l++
}
n.sort(XFG.sortSpecialLast);
if(o||l>5){
return"{\n"+c+n.join(",\n"+c)+"\n}"
}else{
return"{"+c+n.join(", ")+c+"}"
}};
XFG.sortSpecialLast=function(o,e){
var t=o.charAt(0);
var n=e.charAt(0);
var s=t=="_"||t=="$";
var r=n=="_"||n=="$";
if(!s&&!r){
return(o>e?1:-1)
}else{
if(s&&r){
return(o>e?1:-1)
}else{
if(s){
return 1
}else{
return -1
}}}};
StringBuffer=function(){
this.clear();
if(arguments.length>0){
arguments.join=this.buffer.join;
this.buffer[this.buffer.length]=arguments.join("")
}};
StringBuffer.prototype.toString=function(){
return this.buffer.join("")
};
StringBuffer.prototype.join=function(e){
if(e==null){
e=""
}
return this.buffer.join(e)
};
StringBuffer.prototype.append=function(){
arguments.join=this.buffer.join;
this.buffer[this.buffer.length]=arguments.join("")
};
StringBuffer.prototype.join=function(e){
return this.buffer.join(e)
};
StringBuffer.prototype.set=function(e){
this.buffer=[e]
};
StringBuffer.prototype.clear=function(){
this.buffer=[]
};
StringBuffer.concat=function(){
arguments.join=Array.prototype.join;
return arguments.join("")
};
XFG.ARROW_DOWN=40;
XFG.ARROW_LEFT=37;
XFG.ARROW_RIGHT=39;
XFG.ARROW_UP=38
}
if(AjxPackage.define("ajax.dwt.xforms.XModel")){
var _MODEL_="model";
var _INSTANCE_="instance";
var _INHERIT_="inherit";
var _MODELITEM_="modelitem";
XModel=function(e){
XFG.assignUniqueId(this,"_Model_");
if(e){
for(var t in e){
this[t]=e[t]
}}
if(this.items==null){
this.items=[]
}
this._pathIndex={};
this._pathGetters={};
this._parentGetters={};
this._itemsAreInitialized=false;
this._errorMessages={};
if(this.getDeferInit()==false){
this.initializeItems()
}};
XModel.toString=function(){
return"[Class XModel]"
};
XModel.prototype.toString=function(){
return"[XModel "+this.__id+"]"
};
XModel.prototype.pathDelimiter="/";
XModel.prototype.getterScope=_INSTANCE_;
XModel.prototype.setterScope=_INSTANCE_;
XModel.prototype.deferInit=true;
XModel.prototype.getDeferInit=function(){
return this.deferInit
};
XModel.prototype.initializeItems=function(){
if(this._itemsAreInitialized){
return
}
var t=new Date().getTime();
this.__nestedItemCount=0;
this.items=this.initItemList(this.items,null);
this._itemsAreInitialized=true;
var e=new Date().getTime()
};
XModel.prototype.initItemList=function(o,e){
var t=[];
for(var a=0;
a<o.length;
a++){
t[a]=this.initItem(o[a],e)
}
this.__nestedItemCount+=o.length;
return t
};
XModel.prototype.initItem=function(t,e){
if(t.__isXModelItem){
return t
}
var a=XModelItemFactory.createItem(t,e,this);
a.initializeItems();
return a
};
XModel.prototype.addItem=function(t,e){
if(!t.__isXModelItem){
t=this.initItem(t,e)
}
if(e==null){
this.items.push(t)
}else{
e.addItem(t)
}};
XModel.prototype.indexItem=function(e,t){
this._pathIndex[t]=e
};
XModel.prototype.getItem=function(h,o){
var s=this._pathIndex[h];
if(s!=null){
return this._pathIndex[h]
}
var t=this.normalizePath(h);
for(var n=0;
n<t.length;
n++){
if(t[n].charAt(0)=="#"){
t[n]="#"
}}
s=this._pathIndex[t.join(this.pathDelimiter)];
if(s!=null){
this._pathIndex[h]=s;
return s
}
if(o!=true){
return null
}
var e=null;
for(var r=0;
r<t.length;
r++){
var a=t.slice(0,r+1).join(this.pathDelimiter);
var s=this.getItem(a,false);
if(s==null){
s=XModelItemFactory.createItem({
id:t[r]}
,e,this)
}
e=s
}
return s
};
XModel.prototype.normalizePath=function(o){
if(o.indexOf("[")>-1){
o=o.split("[").join("/#");
o=o.split("]").join("")
}
if(o.indexOf(".")>-1){
o=o.split(/[\/\.]+/);
var e=[];
for(var t=0;
t<o.length;
t++){
var a=o[t];
if(a==".."){
e.pop()
}else{
if(a!="."){
e.push(a)
}}}
return e
}
return o.split(this.pathDelimiter)
};
XModel.prototype.getParentPath=function(e){
e=this.normalizePath(e);
return e.slice(0,e.length-1)
};
XModel.prototype.getLeafPath=function(e){
e=this.normalizePath(e);
return e[e.length-1]
};
XModel.prototype.getInstanceValue=function(t,a){
var e=this._getPathGetter(a);
return e.call(this,t)
};
XModel.prototype.getParentInstanceValue=function(t,a){
var e=this._getParentPathGetter(a);
return e.call(this,t)
};
XModel.prototype.setInstanceValue=function(d,m,c){
var l=this.getParentInstanceValue(d,m);
if(l==null){
l=this.setParentInstanceValues(d,m)
}
var r=this.getItem(m,true);
var h=this.getLeafPath(m);
var o=r.ref;
if(h.charAt(0)=="#"){
o=parseInt(h.substr(1))
}
if(r.setter){
if(o.indexOf(this.pathDelimiter)>-1){
o=o.split(this.pathDelimiter).join(".")
}
var n=r.setter;
var u=r.setterScope;
if(u==_INHERIT_){
u=this.setterScope
}
if(u==_INSTANCE_){
d[n](c,l,o)
}else{
if(u==_MODEL_){
this[n](c,d,l,o)
}else{
r[n](c,d,l,o)
}}}else{
if(typeof o=="string"&&o.indexOf(this.pathDelimiter)>-1){
o=o.split(this.pathDelimiter);
for(var s=0;
s<o.length-1;
s++){
l=l[o[s]]
}
o=o.pop()
}
l[o]=c;
var t=r.getParentItem();
if(t){
var a=this.getParentPath(m).join(this.pathDelimiter);
if(t.setter){
XModel.prototype.setInstanceValue.call(this,d,a,l)
}else{
var e=new DwtXModelEvent(d,t,a,l);
t.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,e)
}}}
var e=new DwtXModelEvent(d,r,m,c);
r.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,e);
return c
};
XModel.prototype.setParentInstanceValues=function(e,s){
var h=this.getParentPath(s);
for(var n=0;
n<h.length;
n++){
var a=h.slice(0,n+1).join(this.pathDelimiter);
var r=this.getInstanceValue(e,a);
if(r==null){
var o=this.getItem(a,true);
var t=o.getDefaultValue();
r=this.setInstanceValue(e,a,t)
}}
return r
};
XModel.prototype.getInstanceCount=function(e,a){
var t=this.getParentInstanceValue(e,a);
if(t!=null&&t.length){
return t.length
}
return 0
};
XModel.prototype.addRowAfter=function(t,s,e){
var o=null;
var a=this.getItem(s);
if(a){
o=this.getNewListItemInstance(a)
}else{
o=""
}
var n=this.getInstanceValue(t,s);
if(n==null){
n=[]
}
n.splice(e+1,0,o);
this.setInstanceValue(t,s,n)
};
XModel.prototype.getNewListItemInstance=function(e){
var t=e.listItem;
if(t==null){
return""
}
return this.getNewInstance(t)
};
XModel.prototype.getNewInstance=function(a){
if(a.defaultValue!=null){
return a.defaultValue
}
var o=a.type;
switch(o){
case _STRING_:return"";
case _NUMBER_:return 0;
case _OBJECT_:var e={};
if(a.items){
for(var t=0;
t<a.items.length;
t++){
var n=a.items[t];
if(n.ref){
e[n.ref]=this.getNewInstance(n)
}else{
if(n.id){
e[n.id]=this.getNewInstance(n)
}}}}
return e;
case _LIST_:return[];
case _DATE_:case _TIME_:case _DATETIME_:return new Date();
default:return""
}};
XModel.prototype.removeRow=function(h,l,r){
var n=this.getInstanceValue(h,l);
if(n==null){
return
}
var e=false;
if(n instanceof String||typeof(n)=="string"){
e=true
}
var s=e?n.split(","):n;
var t=[];
var a=s.length;
for(var o=0;
o<a;
o++){
if(o!=r){
t.push(s[o])
}}
this.setInstanceValue(h,l,t)
};
XModel.prototype._getPathGetter=function(t){
var e=this._pathGetters[t];
if(e!=null){
return e
}
e=this._makePathGetter(t);
this._pathGetters[t]=e;
return e
};
XModel.prototype._getParentPathGetter=function(a){
var e=this._parentGetters[a];
if(e!=null){
return e
}
var t=this.getParentPath(a).join(this.pathDelimiter);
e=this._getPathGetter(t);
this._parentGetters[a]=e;
this._pathGetters[t]=e;
return e
};
XModel.prototype._makePathGetter=function(u){
if(u==null){
return new Function("return null")
}
var d=this.normalizePath(u);
if(d[0]==""){
d=d.slice(1)
}
var l=[];
var o="";
for(var n=0;
n<d.length;
n++){
var r=d[0,n];
if(r.charAt(0)=="#"){
r=r.substr(1);
o=o+"#"
}else{
o=o+r
}
var s=this.getItem(o,true);
var t=s.ref;
if(t.indexOf(this.pathDelimiter)>-1){
t=t.split(this.pathDelimiter).join(".")
}
if(s.getter){
var h=s.getter;
var c=s.getterScope;
if(c==_INHERIT_){
c=this.getterScope
}
if(c==_INSTANCE_){
l.push("if(instance) {");
l.push("	current = instance."+h+"(current, '"+t+"');");
l.push("}")
}else{
if(c==_MODEL_){
l.push("current = this."+h+"(instance, current, '"+t+"');")
}else{
l.push('current = this.getItem("'+o+'").'+h+"(instance, current, '"+t+"');")
}}}else{
if(t=="#"){
l.push("if(current) {");
l.push("	current = current["+r+"];");
l.push("}")
}else{
l.push("if(current) {");
l.push("	current = current."+t+";");
l.push("}")
}}
o+=this.pathDelimiter
}
var a=AjxBuffer.concat("try {\r","var current = instance;\r","\t",l.join("\r\t"),"\r","} catch (e) {\r ","	DBG.println('Error in getting path for \"",u,"\": ' + e);\r","	current = null;\r","}\r","return current;\r");
var e=new Function("instance",a);
return e
};
XModel._errorMessages={};
XModel.registerErrorMessage=XModel.prototype.registerErrorMessage=function(t,e){
this._errorMessages[t]=e
};
XModel.registerErrorMessage("unknownError","Unknown error.");
XModel.prototype.defaultErrorMessage="unknownError";
XModel.prototype.getDefaultErrorMessage=function(e){
if(e&&e.errorMessage){
return e.getDefaultErrorMessage()
}
return this.defaultErrorMessage
};
XModel.prototype.getErrorMessage=function(r,n,o,a,t,e){
var s=this._errorMessages[r];
if(s==null){
s=XModel._errorMessages[r]
}
if(s==null){
return r
}
if(n!==null){
s=s.split("{0}").join(n)
}
if(o!==null){
s=s.split("{1}").join(o)
}
if(a!==null){
s=s.split("{2}").join(a)
}
if(t!==null){
s=s.split("{3}").join(t)
}
if(e!==null){
s=s.split("{4}").join(e)
}
return s
}
}
if(AjxPackage.define("ajax.dwt.xforms.XModelItem")){
XModelItemFactory=function(){};
XModelItemFactory.createItem=function(t,e,s){
var o=t.type;
var a=this.getItemTypeConstructor(o||_UNTYPED_);
var n=new a();
n._setAttributes(t);
if(n.id!=null&&n.ref==null){
n.ref=n.id
}
var r=this.getIdPath(t,e);
n.__idPath=r;
n.__xmodel=s;
n.__parentItem=e;
n.initModelItem();
s.indexItem(n,r);
return n
};
XModelItemFactory.getIdPath=function(t,e){
if(t.path){
return t.path
}
return this.getFullPath(t.id,(e?e.getIdPath():""))
};
XModelItemFactory.getFullPath=function(e,t){
if(e==null){
return null
}
if(t==null){
t=""
}
var a=e;
if(e=="."){
a=t
}else{
if(e==".."){
t=t.split("/");
a=t.slice(0,t.length-1).join("/")
}else{
if(t==""){
a=e
}else{
a=t+"/"+e
}}}
return a
};
XModelItemFactory.typeConstructorMap={};
XModelItemFactory.createItemType=function(o,e,a,t){
if(a==null){
a=new Function()
}
if(typeof t=="string"){
t=this.getItemTypeConstructor(t)
}
if(t==null){
t=XModelItem
}
a.prototype=new t();
a.prototype.type=e;
a.prototype.constructor=a;
a.prototype.toString=new Function("return '[XModelItem:"+e+" path=\"' + this.getIdPath() + '\"]'");
a.toString=new Function("return '[Class XModelItem:"+e+"]'");
this.registerItemType(o,e,a);
return a
};
XModelItemFactory.registerItemType=function(a,e,t){
window[a]=e;
this.typeConstructorMap[e]=t
};
XModelItemFactory.getItemTypeConstructor=function(e){
var t=this.typeConstructorMap[e];
if(t==null){
t=this.typeConstructorMap.string
}
return t
};
XModelItem=function(){};
XModelItemFactory.createItemType("_UNTYPED_","untyped",XModelItem,Object);
XModelItemFactory.registerItemType("_OBJECT_","object",XModelItem);
XModelItem.prototype.__isXModelItem=true;
XModelItem.prototype.getterScope=_INHERIT_;
XModelItem.prototype.setterScope=_INHERIT_;
XModelItem.prototype._setAttributes=function(e){
this._attributes=e;
for(var t in e){
this[t]=e[t]
}};
XModelItem.prototype.initModelItem=function(){
this._eventMgr=new AjxEventMgr()
};
XModelItem.prototype.initializeItems=function(){
var e=this.getItems();
if(e!=null){
this.items=this.getModel().initItemList(e,this)
}};
XModelItem.prototype.getModel=function(){
return this.__xmodel
};
XModelItem.prototype.getParentItem=function(){
return this.__parentItem
};
XModelItem.prototype.getIdPath=function(){
return this.__idPath
};
XModelItem.prototype.getItems=function(){
return this.items
};
XModelItem.prototype.addItem=function(e){
if(!e.__isXModelItem){
e=this.xmodel.initItem(e,this)
}
if(this.items==null){
this.items=[]
}
this.items.push(e)
};
XModelItem.prototype.getConstraints=function(){
return this.constraints
};
XModelItem.prototype.getRequired=function(){
return this.required
};
XModelItem.prototype.getReadonly=function(){
return this.readonly
};
XModelItem.prototype.getReadOnly=XModelItem.prototype.getReadonly;
XModelItem.prototype.getDefaultValue=function(){
return new Object()
};
XModel.registerErrorMessage("valueIsRequired",AjxMsg.valueIsRequired);
XModelItem.prototype.validate=function(n,a,o,e){
if(n==null||n===""){
if(this.getRequired()){
throw this.getModel().getErrorMessage("valueIsRequired",n)
}}else{
n=this.validateType(n)
}
var r=this.getConstraints();
if(r==null){
return n
}
if(!(AjxUtil.isInstance(r,Array))){
r=[r]
}
for(var t=0;
t<r.length;
t++){
var s=r[t];
if(s.type=="method"){
n=s.value.call(this,n,a,o,e)
}}
return n
};
XModelItem.prototype.getDefaultErrorMessage=function(){
return this.errorMessage
};
XModelItem.prototype.validateType=function(e){
return e
};
XModelItem.prototype.length=null;
XModelItem.prototype.minLength=null;
XModelItem.prototype.maxLength=null;
XModelItem.prototype.pattern=null;
XModelItem.prototype.enumeration=null;
XModelItem.prototype.whiteSpace=null;
XModelItem.prototype.getLength=function(){
return this.length
};
XModelItem.prototype.getMinLength=function(){
return this.minLength
};
XModelItem.prototype.getMaxLength=function(){
return this.maxLength
};
XModelItem.prototype.getPattern=function(){
if(this.pattern!=null&&this.pattern.checked==null){
if(AjxUtil.isString(this.pattern)){
this.pattern=[new RegExp(this.pattern)]
}else{
if(AjxUtil.isInstance(this.pattern,RegExp)){
this.pattern=[this.pattern]
}else{
if(AjxUtil.isArray(this.pattern)){
for(var e=0;
e<this.pattern.length;
e++){
var t=this.pattern[e];
if(AjxUtil.isString(t)){
this.pattern[e]=new RegExp(this.pattern[e])
}}}else{}}}
this.pattern.checked=true
}
return this.pattern
};
XModelItem.prototype.getEnumeration=function(){
return this.enumeration
};
XModelItem.prototype.getWhiteSpace=function(){
return this.whiteSpace
};
XModel.registerErrorMessage("notAString",AjxMsg.notAString);
XModel.registerErrorMessage("stringLenWrong",AjxMsg.stringLenWrong);
XModel.registerErrorMessage("stringTooShort",AjxMsg.stringTooShort);
XModel.registerErrorMessage("stringTooLong",AjxMsg.stringTooLong);
XModel.registerErrorMessage("stringMismatch",AjxMsg.stringMismatch);
XModelItem.prototype.validateString=function(o){
if(o==null){
return
}
if(!AjxUtil.isString(o)){
throw this.getModel().getErrorMessage("notAString",o)
}
o=this._normalizeAndValidate(o);
var a=this.getLength();
if(a!==null){
if(o.length!==a){
throw this.getModel().getErrorMessage("stringLenWrong",a)
}}else{
var e=this.getMaxLength();
if(e!==null&&o.length>e){
throw this.getModel().getErrorMessage("stringTooLong",e)
}
var t=this.getMinLength();
if(t!==null&&o.length<t){
throw this.getModel().getErrorMessage("stringTooShort",t)
}}
return o
};
XModel.registerErrorMessage("invalidEmailAddr",AjxMsg.invalidEmailAddr);
XModelItem.prototype.validateEmailAddress=function(o){
if(o==null){
return
}
if(!AjxUtil.isString(o)){
throw this.getModel().getErrorMessage("notAString",o)
}
o=this._normalizeAndValidate(o);
var a=this.getLength();
if(a!==null){
if(o.length!==a){
throw this.getModel().getErrorMessage("stringLenWrong",a)
}}else{
var e=this.getMaxLength();
if(e!==null&&o.length>e){
throw this.getModel().getErrorMessage("stringTooLong",e)
}
var t=this.getMinLength();
if(t!==null&&o.length<t){
throw this.getModel().getErrorMessage("stringTooShort",t)
}
var n=o.split("@");
if(!n||n[0]==null||n[0]==""){
throw this.getModel().getErrorMessage("invalidEmailAddr")
}else{
if(!AjxUtil.isValidEmailNonReg(o)){
throw this.getModel().getErrorMessage("invalidEmailAddr")
}}}
return o
};
XModelItem.prototype._normalizeAndValidate=function(n){
var s=this.getWhiteSpace();
if(s!==null){
if(s==="replace"||s==="collapse"){
n=n.replace(/[\t\r\n]/g," ")
}
if(s==="collapse"){
n=n.replace(/^\s+/,"").replace(/\s+$/,"").replace(/[ ]+/," ")
}}
var o=this.getPattern();
if(o!=null){
var e=false;
for(var t=0;
t<o.length;
t++){
if(o[t].test(n)){
e=true;
break
}}
if(!e){
throw this.getModel().getErrorMessage("stringMismatch",n)
}}
var a=this.getEnumeration();
if(a!==null){
var e=false;
for(var t=0;
t<a.length;
t++){
if(a[t]===n){
e=true;
break
}}
if(!e){
throw this.getModel().getErrorMessage("stringMismatch",n)
}}
return n
};
XModelItem.prototype.totalDigits=null;
XModelItem.prototype.fractionDigits=null;
XModelItem.prototype.maxInclusive=null;
XModelItem.prototype.maxExclusive=null;
XModelItem.prototype.minInclusive=null;
XModelItem.prototype.minExclusive=null;
XModelItem.prototype.getTotalDigits=function(){
return this.totalDigits
};
XModelItem.prototype.getFractionDigits=function(){
return this.fractionDigits
};
XModelItem.prototype.getMinInclusive=function(){
return this.minInclusive
};
XModelItem.prototype.getMinExclusive=function(){
return this.minExclusive
};
XModelItem.prototype.getMaxInclusive=function(){
return this.maxInclusive
};
XModelItem.prototype.getMaxExclusive=function(){
return this.maxExclusive
};
XModelItem.prototype.addListener=function(t,a,e){
return this._eventMgr.addListener(t,a,e)
};
XModelItem.prototype.removeListener=function(e,t){
return this._eventMgr.removeListener(e,t)
};
XModelItem.prototype.removeAllListeners=function(e){
return this._eventMgr.removeAll(e)
};
XModelItem.prototype.isListenerRegistered=function(e){
return this._eventMgr.isListenerRegistered(e)
};
XModelItem.prototype.notifyListeners=function(e,t){
return this._eventMgr.notifyListeners(e,t)
};
XModel.registerErrorMessage("notANumber",AjxMsg.notANumber);
XModel.registerErrorMessage("numberTotalExceeded",AjxMsg.numberTotalExceeded);
XModel.registerErrorMessage("numberFractionExceeded",AjxMsg.numberFractionExceeded);
XModel.registerErrorMessage("numberMoreThanMax",AjxMsg.numberMoreThanMax);
XModel.registerErrorMessage("numberMoreThanEqualMax",AjxMsg.numberMoreThanEqualMax);
XModel.registerErrorMessage("numberLessThanMin",AjxMsg.numberLessThanMin);
XModel.registerErrorMessage("numberLessThanEqualMin",AjxMsg.numberLessThanEqualMin);
XModelItem.prototype.validateNumber=function(n){
n=this._normalizeAndValidate(n);
var a=parseFloat(n);
if(isNaN(a)||!AjxUtil.FLOAT_RE.test(n)){
throw this.getModel().getErrorMessage("notANumber",n)
}
var h=this.getTotalDigits();
if(this.totalDigits!==null){
var s=Math.floor(a);
if(s.toString().length>h){
throw this.getModel().getErrorMessage("numberTotalExceeded",n,h)
}}
var c=this.getFractionDigits();
if(this.fractionDigits!==null){
var e=String(a-Math.floor(a));
if(e.indexOf(".")!=-1&&e.replace(/^\d*\./,"").length>c){
throw this.getModel().getErrorMessage("numberFractionExceeded",n,c)
}}
var t=this.getMaxInclusive();
if(t!==null&&a>t){
throw this.getModel().getErrorMessage("numberMoreThanMax",t)
}
var r=this.getMaxExclusive();
if(r!==null&&a>=r){
throw this.getModel().getErrorMessage("numberMoreThanEqualMax",r)
}
var l=this.getMinInclusive();
if(l!==null&&a<l){
throw this.getModel().getErrorMessage("numberLessThanMin",l)
}
var o=this.getMinExclusive();
if(o!==null&&a<=o){
throw this.getModel().getErrorMessage("numberLessThanEqualMin",o)
}
return a
};
XModel.registerErrorMessage("notAnInteger",AjxMsg.notAnInteger);
XModelItem.prototype.validateInt=function(t){
var e=this.validateNumber(t);
var a=parseInt(t);
if(a!=e){
throw this.getModel().getErrorMessage("notAnInteger",t)
}
return a
};
XModelItem.prototype.msecInOneDay=(1000*60*60*24);
XModel.registerErrorMessage("invalidDateString",AjxMsg.invalidDateString);
XModelItem.prototype.validateDate=function(n){
if(AjxUtil.isInstance(n,Date)){
return n
}
if(AjxUtil.isString(n)){
n=n.toLowerCase();
var t=new Date();
if(n.indexOf("/")>-1){
var o=n.split("/");
if(o.length==3){
var s=o[0];
var e=o[1];
var a=o[2];
if(s.length<=2&&e.length<=2&&a.length==4){
s=parseInt(XModel.removePreceedingZero(s));
e=parseInt(XModel.removePreceedingZero(e));
a=parseInt(XModel.removePreceedingZero(a));
if(!isNaN(s)&&!isNaN(e)&&!isNaN(a)){
s-=1;
t.setFullYear(a,s,e);
t.setHours(0,0,0,0);
return t
}}}}else{
t.setHours(0,0,0,0);
if(n==AjxMsg.today){
return t
}else{
if(n==AjxMsg.yesterday){
t.setTime(t.getTime()-this.msecInOneDay);
return t
}else{
if(n==AjxMsg.tomorrow){
t.setTime(t.getTime()+this.msecInOneDay);
return t
}}}}}
throw this.getModel().getErrorMessage("invalidDateString",n);
return n
};
XModel.removePreceedingZero=function(t){
var a=/^[0]*(.*)$/;
var e=t.match(a);
if(e!=null){
return e[1]
}else{
return t
}};
XModel.registerErrorMessage("invalidTimeString",AjxMsg.invalidTimeString);
XModelItem.prototype.validateTime=function(s){
if(AjxUtil.isNumber(s)){
return s
}
if(AjxUtil.isInstance(s,Date)){
return((s.getHours()*360)+(s.getMinutes()*60)+s.getSeconds())*1000
}
if(AjxUtil.isString(s)){
s=s.toLowerCase();
if(s.indexOf(":")>-1){
s=s.split(":");
var e=false;
var a=s[s.length-1];
e=(a.indexOf(I18nMsg.periodPm.toLowerCase())>-1);
var t=parseInt(s[0]);
var o=parseInt(s[1]);
var n=(s.length==3?parseInt(s[2]):0);
if(!isNaN(t)&&!isNaN(o)&&!isNaN(n)){
t-=1;
if(e&&t>11){
t+=12
}
return((t*360)+(o*60)+n)*1000
}}}
throw this.getModel().getErrorMessage("invalidTimeString",s)
};
XModel.registerErrorMessage("invalidDatetimeString",AjxMsg.invalidDatetimeString);
XModelItem.prototype.validateDateTime=function(t){
if(AjxUtil.isInstance(t,Date)){
return t
}
if(AjxUtil.isNumber(t)){
return t
}
if(AjxUtil.isString(t)){
var e=this.validateDate(t);
if(t.indexOf(":")>-1){
var a=t.split(" ")[1];
a=this.validateTimeString(a);
e.setTime(e.getTime()+a)
}
return e
}
throw this.getModel().getErrorMessage("invalidDatetimeString",t)
};
String_XModelItem=function(){};
XModelItemFactory.createItemType("_STRING_","string",String_XModelItem);
String_XModelItem.prototype.validateType=XModelItem.prototype.validateString;
String_XModelItem.prototype.getDefaultValue=function(){
return""
};
Number_XModelItem=function(){};
XModelItemFactory.createItemType("_NUMBER_","number",Number_XModelItem);
Number_XModelItem.prototype.validateType=XModelItem.prototype.validateNumber;
Number_XModelItem.prototype.getDefaultValue=function(){
return 0
};
Integer_XModelItem=function(){};
XModelItemFactory.createItemType("_INT_","int",Integer_XModelItem);
Integer_XModelItem.prototype.validateType=XModelItem.prototype.validateInt;
Integer_XModelItem.prototype.getDefaultValue=function(){
return 0
};
Date_XModelItem=function(){};
XModelItemFactory.createItemType("_DATE_","date",Date_XModelItem);
Date_XModelItem.prototype.validateType=XModelItem.prototype.validateDate;
Date_XModelItem.prototype.getDefaultValue=function(){
return new Date()
};
Time_XModelItem=function(){};
XModelItemFactory.createItemType("_TIME_","time",Time_XModelItem);
Time_XModelItem.prototype.validateType=XModelItem.prototype.validateTime;
Time_XModelItem.prototype.getDefaultValue=function(){
return new Date()
};
Datetime_XModelItem=function(){};
XModelItemFactory.createItemType("_DATETIME_","datetime",Datetime_XModelItem);
Datetime_XModelItem.prototype.validateType=XModelItem.prototype.validateDateTime;
Datetime_XModelItem.prototype.getDefaultValue=function(){
return new Date()
};
List_XModelItem=function(){};
XModelItemFactory.createItemType("_LIST_","list",List_XModelItem);
List_XModelItem.prototype.getDefaultValue=function(){
return new Array()
};
List_XModelItem.prototype.outputType=_LIST_;
List_XModelItem.prototype.itemDelimiter=",";
List_XModelItem.prototype.inputDelimiter=/[\s,\r\n]+/;
List_XModelItem.prototype.listItem={
type:_UNTYPED_};
List_XModelItem.prototype.getOutputType=function(){
return this.outputType
};
List_XModelItem.prototype.getItemDelimiter=function(){
return this.itemDelimiter
};
List_XModelItem.prototype.getInputDelimiter=function(){
return this.inputDelimiter
};
List_XModelItem.prototype.getListItem=function(){
return this.listItem
};
List_XModelItem.prototype.getterScope=_MODELITEM_;
List_XModelItem.prototype.setterScope=_MODELITEM_;
List_XModelItem.prototype.getter="getValue";
List_XModelItem.prototype.setter="setValue";
List_XModelItem.prototype.getValue=function(ins,current,ref){
var value=eval("ins."+ref);
if(value&&this.getOutputType()==_STRING_&&value instanceof Array){
return value.join(this.getItemDelimiter())
}else{
return value
}};
List_XModelItem.prototype.setValue=function(val,ins,current,ref){
if(val&&this.getOutputType()==_STRING_&&!(val instanceof Array)){
var value=val.split(this.getInputDelimiter());
eval("ins."+ref+" = value");
return value
}else{
var value=eval("ins."+ref+" = val");
return value
}};
List_XModelItem.prototype.initializeItems=function(){
var e=this.listItem;
e.ref=e.id="#";
this.listItem=XModelItemFactory.createItem(e,this,this.getModel());
this.listItem.initializeItems()
};
List_XModelItem.prototype.validateType=function(e){
return e
};
Enum_XModelItem=function(){
XModel.registerErrorMessage("didNotMatchChoice",AjxMsg.didNotMatchChoice)
};
XModelItemFactory.createItemType("_ENUM_","enum",Enum_XModelItem);
Enum_XModelItem.prototype.getDefaultValue=function(){
return this.getChoices()[0]
};
Enum_XModelItem.prototype.getChoices=function(){
if(typeof this.choices=="function"){
this.choices=this.choices.call(this)
}
return this.choices
};
Enum_XModelItem.prototype.getSelection=function(){
return this.selection
};
Enum_XModelItem.prototype.validateType=function(a){
var o=this.getSelection()==_OPEN_;
if(o){
return a
}
var n=this.getChoices();
for(var t=0;
t<n.length;
t++){
var e=n[t];
if(AjxUtil.isInstance(e,Object)){
if(e.value==a){
return a
}}else{
if(e==a){
return a
}}}
throw this.getModel().getErrorMessage("didNotMatchChoice",a)
};
Bool_XModelItem=function(){};
XModelItemFactory.createItemType("_BOOL_","bool",Bool_XModelItem);
Bool_XModelItem.prototype=new Enum_XModelItem();
Bool_XModelItem.prototype.choices=["FALSE","TRUE",null];
FileSize_XModelItem=function(){};
XModelItemFactory.createItemType("_FILE_SIZE_","file_size",FileSize_XModelItem);
FileSize_XModelItem.prototype.validateType=XModelItem.prototype.validateNumber;
FileSize_XModelItem.prototype.getterScope=_MODELITEM_;
FileSize_XModelItem.prototype.setterScope=_MODELITEM_;
FileSize_XModelItem.prototype.getter="getValue";
FileSize_XModelItem.prototype.setter="setValue";
FileSize_XModelItem.prototype.units=AjxUtil.SIZE_MEGABYTES;
FileSize_XModelItem.prototype.minInclusive=0;
FileSize_XModelItem.prototype.maxInclusive=922337203685477;
FileSize_XModelItem.prototype.maxLength=15;
FileSize_XModelItem.prototype.getValue=function(ins,current,ref){
var value=eval("ins."+ref);
return value?AjxUtil.formatSizeForUnits(value,AjxUtil.SIZE_KILOBYTES,false,2):1
};
FileSize_XModelItem.prototype.setValue=function(val,ins,current,ref){
var value=eval("ins."+ref+" = AjxUtil.parseSize(val, this.units)");
return isNaN(value)?1:value
};
HostNameOrIp_XModelItem=function(){};
XModelItemFactory.createItemType("_HOSTNAME_OR_IP_","hostname_or_ip",HostNameOrIp_XModelItem);
HostNameOrIp_XModelItem.prototype.validateType=XModelItem.prototype.validateString;
HostNameOrIp_XModelItem.prototype.maxLength=256;
HostNameOrIp_XModelItem.prototype.pattern=[AjxUtil.HOST_NAME_RE,AjxUtil.IPv4_ADDRESS_RE,AjxUtil.IPv6_ADDRESS_RE,AjxUtil.HOST_NAME_WITH_PORT_RE,AjxUtil.IPv4_ADDRESS_WITH_PORT_RE,AjxUtil.IPv6_ADDRESS_WITH_PORT_RE];
ShortURL_XModelItem=function(){};
XModelItemFactory.createItemType("_SHORT_URL_","short_url",ShortURL_XModelItem);
ShortURL_XModelItem.prototype.validateType=XModelItem.prototype.validateString;
ShortURL_XModelItem.prototype.maxLength=256;
ShortURL_XModelItem.prototype.pattern=[AjxUtil.SHORT_URL_RE,AjxUtil.IP_SHORT_URL_RE];
Port_XModelItem=function(){};
XModelItemFactory.createItemType("_PORT_","port",Port_XModelItem);
Port_XModelItem.prototype.validateType=XModelItem.prototype.validateNumber;
Port_XModelItem.prototype.minInclusive=0;
Port_XModelItem.prototype.maxInclusive=65535;
Percent_XModelItem=function(){};
XModelItemFactory.createItemType("_PERCENT_","percent",Percent_XModelItem);
Percent_XModelItem.prototype.validateType=XModelItem.prototype.validateNumber;
Percent_XModelItem.prototype.minInclusive=0;
Percent_XModelItem.prototype.maxInclusive=100;
EmailAddress_XModelItem=function(){};
XModelItemFactory.createItemType("_EMAIL_ADDRESS_","email_address",EmailAddress_XModelItem);
EmailAddress_XModelItem.prototype.validateType=XModelItem.prototype.validateEmailAddress;
EmailAddress_XModelItem.prototype.maxLength=256;
FullUrl_XModelItem=function(){};
XModelItemFactory.createItemType("_FULL_URL_","full_url",FullUrl_XModelItem);
FullUrl_XModelItem.prototype.validateType=XModelItem.prototype.validateString;
FullUrl_XModelItem.prototype.maxLength=1024;
FullUrl_XModelItem.prototype.pattern=[AjxUtil.FULL_URL_RE,AjxUtil.IP_FULL_URL_RE]
}
if(AjxPackage.define("ajax.dwt.xforms.XForm")){
XForm=function(o,n,e,a,t){
if(o){
for(var s in o){
this[s]=o[s]
}}
this.assignGlobalId(this,this.id||t||"_XForm");
DwtComposite.call(this,a,"DWTXForm");
if(this.itemDefaults){
XFormItemFactory.initItemDefaults(this,this.itemDefaults)
}
if(n){
this.setModel(n)
}else{
this.xmodel=new XModel()
}
if(e){
this.setInstance(e)
}
this.__idIndex={};
this.__externalIdIndex={};
this.__itemsAreInitialized=false;
this.tabIdOrder=[];
this.tabGroupIDs=[]
};
XForm.prototype=new DwtComposite;
XForm.prototype.constructor=XForm;
XForm.FONT_WIDTH1=7;
XForm.FONT_WIDTH2=8;
XForm.toString=function(){
return"[Class XForm]"
};
XForm.prototype.toString=function(){
return"[XForm "+this.__id+"]"
};
XForm.prototype.getId=function(){
return this.__id
};
XForm.keyPressDelayHdlr=null;
XForm.prototype.numCols=2;
XForm.prototype.defaultItemType="output";
XForm.prototype._isDirty=false;
XForm._showBorder=false;
var _IGNORE_CACHE_="IGNORE_CACHE";
var _UNDEFINED_;
var _UNDEFINED_;
var _ALL_="all";
var _NONE_="none";
var _LEFT_="left";
var _TOP_="top";
var _RIGHT_="right";
var _BOTTOM_="bottom";
var _CENTER_="center";
var _MIDDLE_="middle";
var _INLINE_="inline";
var _HIDE_="hide";
var _BLOCK_HIDE_="block_hide";
var _DISABLE_="disable";
var _SHOW_DISABLED_="show_disabled";
var _PARENT_="parent";
var _SELF_="self";
var _OPEN_="open";
var _CLOSED_="closed";
var _HIDDEN_="hidden";
var _SCROLL_="scroll";
var _AUTO_="auto";
var _VISIBLE_="visible";
XForm.prototype.refresh=function(){
if(this.__drawn){
this.updateElementStates()
}};
XForm.prototype.getGlobalRefString=function(){
return"XFG.cacheGet('"+this.__id+"')"
};
XForm.prototype.assignGlobalId=function(e,t){
return XFG.assignUniqueId(e,t)
};
XForm.prototype.getUniqueId=function(e){
return XFG.getUniqueId(e)
};
XForm.prototype.getElement=function(t){
if(t==null){
t=this.getId()
}
var e=XFG.getEl(t);
if(e==null){}
return e
};
XForm.prototype.showElement=function(e){
if(e==null){
e=this.getId()
}
return XFG.showEl(e)
};
XForm.prototype.hideElement=function(t,e){
if(t==null){
t=this.getId()
}
return XFG.hideEl(t,e)
};
XForm.prototype.createElement=function(o,t,e,a){
if(o==null){
o=this.getId()
}
return XFG.createEl(o,t,e,a)
};
XForm.prototype.focusElement=function(a){
var t=this.getElement(a);
if(t!=null){
var e=t.tagName;
if(e!="DIV"&&e!="TD"&&e!="TABLE"){
t.focus();
this.onFocus(a)
}}
return t
};
XForm.prototype.focusFirst=function(o){
var r=null;
if(o!=null){
r=this.tabIdOrder[o]
}else{
for(var t in this.tabIdOrder){
if(this.getItemById(t).getIsVisible()&&this.getItemById(t).getIsEnabled()&&this.tabIdOrder[t]&&this.tabIdOrder[t].length>0){
r=this.tabIdOrder[t];
break
}}}
if(r){
var s=r.length;
for(var n=0;
n<s;
n++){
var e=this.getItemById(r[n]);
if(e&&e.focusable&&e.getIsVisible()&&e.getIsEnabled()){
return this.focusElement(r[n])
}}}
return null
};
XForm.prototype.addTabGroup=function(a,e){
e=e?e:"tabGroupKey";
var t=a.getInheritedProperty(e)?a.getInheritedProperty(e):a.getId();
this.tabGroupIDs[t]=a.getId()
};
XForm.prototype.focusNext=function(h,t){
var s=h?h:null;
var r=null;
if(t!=null){
r=this.tabIdOrder[t]
}else{
r=this.tabIdOrder
}
if(r&&r.length>0){
var n=r.length;
if(s!=null){
for(var o=0;
o<n;
o++){
if(r[o]==s){
var a=((o+1)%n);
if(r[a]){
var e=this.getItemById(r[a]);
if(e.focusable&&e.getIsVisible()&&e.getIsEnabled()){
return this.focusElement(r[a])
}else{
s=r[a]
}}}}}
return this.focusFirst(t)
}
return null
};
XForm.prototype.focusPrevious=function(h,t){
var s=h?h:null;
var r=null;
if(t!=null){
r=this.tabIdOrder[t]
}else{
r=this.tabIdOrder
}
if(r&&r.length>0){
var n=r.length-1;
if(s!=null){
for(var o=n;
o>=0;
o--){
if(r[o]==s){
var a=((o-1)%n);
if(r[a]){
var e=this.getItemById(r[a]);
if(e.focusable&&e.getIsVisible()&&e.getIsEnabled()){
return this.focusElement(r[a])
}else{
s=r[a]
}}}}}
return this.focusFirst(t)
}
return null
};
XForm.prototype.getModel=function(){
return this.xmodel
};
XForm.prototype.setModel=function(e){
this.xmodel=e
};
XForm.prototype.getInstance=function(){
return this.instance
};
XForm.prototype.updateElementStates=function(){
if(!this.__drawn){
return
}
this.items[0].updateVisibility();
this.items[0].updateEnabledDisabled();
this.items[0].updateElement()
};
XForm.prototype.setInstance=function(e){
this.setIsDirty(false);
this.clearErrors();
this.instance=e;
if(this.__drawn){
this.updateElementStates()
}else{
this.__updateStatesDelayed=true
}
if(this.__drawn){
this.notifyListeners(DwtEvent.XFORMS_INSTANCE_CHANGED,new DwtXFormsEvent(this))
}};
XForm.prototype.getInstance=function(){
return this.instance
};
XForm.prototype.setInstanceValue=function(t,e){
this.xmodel.setInstanceValue(this.instance,e,t)
};
XForm.prototype.getInstanceValue=function(e){
return this.xmodel.getInstanceValue(this.instance,e)
};
XForm.checkInstanceValue=function(e,t){
return(this.getInstanceValue(e)==t)
};
XForm.checkInstanceValueNot=function(e,t){
return(this.getInstanceValue(e)!=t)
};
XForm.checkInstanceValueEmty=function(e){
return AjxUtil.isEmpty(this.getInstanceValue(e))
};
XForm.checkInstanceValueNotEmty=function(e){
return !AjxUtil.isEmpty(this.getInstanceValue(e))
};
XForm.prototype.getController=function(){
return this.controller
};
XForm.prototype.setController=function(e){
this.controller=e
};
XForm.prototype.getIsDirty=function(){
return this._isDirty
};
XForm.prototype.setIsDirty=function(e,t){
this._isDirty=(e==true);
if(typeof t=="undefined"){
t=null
}
this.notifyListeners(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new DwtXFormsEvent(this,t,this._isDirty))
};
XForm.prototype.initializeItems=function(){
this.xmodel.initializeItems();
if(this.__itemsAreInitialized){
return
}
var e={
id:"__outer_group__",type:_GROUP_,useParentTable:false,numCols:this.numCols,colSizes:this.colSizes,items:this.items,tableCssClass:this.tableCssClass,tableCssStyle:this.tableCssStyle};
this.items=this.initItemList([e]);
this.__itemsAreInitialized=true
};
XForm.prototype.initItemList=function(n,t){
var a=[];
for(var o=0;
o<n.length;
o++){
var e=n[o];
if(e!=null){
a.push(this.initItem(e,t))
}}
this.__nestedItemCount+=n.length;
return a
};
XForm.prototype.initItem=function(t,e){
if(t._isXFormItem){
return t
}
var a=XFormItemFactory.createItem(t,e,this);
a.initializeItems();
return a
};
XForm.prototype.indexItem=function(t,o){
this.__idIndex[o]=t;
var a=t.getExternalId();
if(a==null||a==""){
return
}
var e=this.__externalIdIndex[a];
if(e!=null){
e.push(t)
}else{
e=[t]
}
this.__externalIdIndex[a]=e
};
XForm.prototype.getItemById=function(e){
if(e._isXFormItem){
return e
}
return this.__idIndex[e]
};
XForm.prototype.getItemsById=function(e){
return this.__externalIdIndex[e]
};
XForm.prototype.get=function(e){
if(e==null){
return null
}
if(e._isXFormItem){
e=e.getRefPath()
}
return this.xmodel.getInstanceValue(this.instance,e)
};
XForm.prototype.isDrawn=function(){
return(this.__drawn==true)
};
XForm.prototype._replaceDwtContainer=function(){
var e=document.getElementById(this.__id);
var t=this.getHtmlElement();
if(t.parentNode){
t.parentNode.replaceChild(e,t)
}
this._htmlElId=this.__id
};
XForm.prototype.draw=function(e){
this.initializeItems();
var t=this.outputForm();
if(e==null){
e=this.getHtmlElement()
}
if(e){
e.innerHTML=t
}
this.notifyListeners(DwtEvent.XFORMS_READY,new DwtXFormsEvent(this));
this.__drawn=true;
if(this.__updateStatesDelayed&&this.instance){
this.updateElementStates();
this.__updateStatesDelayed=false
}};
XForm.prototype.getItems=function(){
return this.items
};
XForm.prototype.outputForm=function(){
var a=new Date().getTime();
var t=new AjxBuffer();
var e=this.getItems();
t.append('<div id="',this.__id,'"','style="height: 100%;"',(this.cssClass!=null&&this.cssClass!=""?' class="'+this.cssClass+'"':""),(this.cssStyle!=null&&this.cssStyle!=""?' style="'+this.cssStyle+';"':""),">");
this._itemsToInsert={};
this._itemsToCleanup=[];
this.outputItemList(e[0].items,e[0],t,this.numCols);
t.append('</div id="',this.__id,'">');
this.__HTMLOutput=t.toString();
return this.__HTMLOutput
};
XForm.prototype.getOutstandingRowSpanCols=function(t){
if(t==null){
return 0
}
var o=0;
var e=t.__rowSpanItems;
if(e){
for(var n=e.length-1;
n>=0;
n--){
var a=e[n];
a.__numOutstandingRows-=1;
if(a.__numOutstandingRows==0){
if(e.length==1){
delete t.__rowSpanItems
}else{
t.__rowSpanItems.pop()
}}else{
o+=a.__numDrawnCols
}}}
return o
};
XForm.prototype.outputItemList=function(w,y,f,r,z,d,g){
if(y.outputHTMLStart){
y.outputHTMLStart(f,z)
}
var T=(y.getUseParentTable()==false&&d!=true);
var o=null;
if(!g){
o=y.getCssString();
if(o!=null&&o!=""){
y.outputElementDivStart(f)
}}
if(T){
var c=y.getColSizes();
var t=y.getInheritedProperty("cellspacing");
var q=y.getInheritedProperty("cellpadding");
var v=y.getInheritedProperty("border");
if(v==0&&XForm._showBorder){
v=1
}
f.append("<table cellspacing=",t," cellpadding=",q,"  border=",v,' id="',y.getId(),'_table" ',y.getTableCssString(),">");
if(c!=null){
f.append(" <colgroup>");
for(var k=0;
k<c.length;
k++){
var b=c[k];
if(!isNaN(b)){
if(b<1){
b=b*100+"%"
}}
f.append("<col width='",b,"'>")
}
f.append("</colgroup>")
}
f.append("<tbody>")
}
r=Math.max(1,r);
if(z==null){
z=0
}
for(var s=0;
s<w.length;
s++){
var j=w[s];
var e=(j.getItems()!=null);
var O=(j.getUseParentTable()!=false);
j.__numDrawnCols=0;
var m=j.getLabel();
var a=j.getLabelLocation();
var x=(m!=null&&(a==_LEFT_||a==_RIGHT_));
var u=j.getColSpan();
if(u=="*"){
u=Math.max(1,(r-z))
}
var n=j.getRowSpan();
var h=j.__numDrawnCols=parseInt(u)+(x?1:0);
if(n>1&&y){
if(y.__rowSpanItems==null){
y.__rowSpanItems=[]
}
y.__rowSpanItems.push(j);
j.__numOutstandingRows=n
}
if(z==0){
f.append("<tr>")
}
if(m!=null&&a==_LEFT_){
j.outputLabelCellHTML(f,n,a)
}
var p=j.getWriteElementDiv();
var l=j.getOutputHTMLMethod();
if(e&&O){
if(l){
l.call(j,f,z)
}}else{
j.outputContainerTDStartHTML(f,u,n);
if(p){
j.outputElementDivStart(f)
}
if(l){
l.call(j,f,0)
}
if(p){
j.outputElementDivEnd(f)
}
j.outputContainerTDEndHTML(f)
}
z+=h;
if(m!=null&&a==_RIGHT_){
j.outputLabelCellHTML(f,n)
}
if(z>=r){
f.append("</tr>");
z=this.getOutstandingRowSpanCols(y)
}
while(z>=r){
f.append("</tr id='numCols'>");
z=this.getOutstandingRowSpanCols(y)
}
if(y){
y.registerActiveChild(j)
}
j.signUpForEvents()
}
if(T){
f.append("</tbody></table>")
}
if(o!=null&&o!=""){
y.outputElementDivEnd(f)
}
if(y.outputHTMLEnd){
y.outputHTMLEnd(f,z)
}};
XForm.prototype.onFocus=function(e){
this.__focusObject=e
};
XForm.prototype.onBlur=function(e){
this.__focusObject=null
};
XForm.prototype.subItemChanged=function(t,r,e,n){
var h=this.getItemById(t);
if(h==null){
return alert("Couldn't get item for "+t)
}
h.dirtyDisplay();
var a=h.getSubModelItem();
var c=false;
if(a!=null){
try{
r=a.validate(r,this,h,this.getInstance());
if(h.hasError()){
c=true
}
h.clearError()
}
catch(l){
h.setError(l);
var e=new DwtXFormsEvent(this,h,r);
this.notifyListeners(DwtEvent.XFORMS_VALUE_ERROR,e);
return
}}
var o=h.cacheInheritedMethod("onSubChange","$onSubChange","value,event,form");
if(typeof o=="function"){
r=o.call(h,r,e,this)
}else{
var s=h.getInstanceValue(h.getInheritedProperty("subRef"));
if(s==r){
if(c&&!n){
this.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,e)
}
return
}
h.setInstanceValue(r,h.getSubRefPath())
}
var e=new DwtXFormsEvent(this,h,r);
if(!n){
this.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,e)
}
this.setIsDirty(true,h)
};
XForm.prototype.itemChanged=function(t,r,e,n){
var h=this.getItemById(t);
if(h==null){
return alert("Couldn't get item for "+t)
}
h.dirtyDisplay();
var a=h.getModelItem();
var c=false;
if(a!=null){
try{
r=a.validate(r,this,h,this.getInstance());
if(h.hasError()){
c=true
}
h.clearError()
}
catch(l){
h.setError(l);
var e=new DwtXFormsEvent(this,h,r);
this.notifyListeners(DwtEvent.XFORMS_VALUE_ERROR,e);
return
}}
var o=h.getOnChangeMethod();
if(typeof o=="function"){
r=o.call(h,r,e,this)
}else{
var s=h.getInstanceValue();
if(s==r){
if(c&&!n){
this.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,e)
}
return
}
h.setInstanceValue(r)
}
var e=new DwtXFormsEvent(this,h,r);
if(!n){
this.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,e)
}
this.setIsDirty(true,h)
};
XForm.prototype.getItemsInErrorState=function(){
if(this.__itemsInErrorState==null){
this.__itemsInErrorState=new Object();
this.__itemsInErrorState.size=0
}
return this.__itemsInErrorState
};
XForm.prototype.addErrorItem=function(t){
var e=this.getItemsInErrorState();
var a=e[t.getId()];
e[t.getId()]=t;
if(a==null){
e.size++
}};
XForm.prototype.removeErrorItem=function(t){
if(t!=null){
var e=this.getItemsInErrorState();
var o=t.getId();
var a=e[o];
if(a!=null){
delete e[o];
e.size--
}}};
XForm.prototype.hasErrors=function(){
var e=this.getItemsInErrorState();
return(e!=null&&e.size>0)
};
XForm.prototype.clearErrors=function(){
var t=this.getItemsInErrorState();
if(t.size>0){
var e;
for(e in t){
if(e=="size"){
continue
}
t[e].clearError();
delete t[e]
}
t.size=0
}};
XForm.prototype.onCloseForm=function(){
if(this.__focusObject!=null){
var t=this.getItemById(this.__focusObject);
var e=t.getElement();
if(e&&e.blur){
e.blur()
}
this.__focusObject=null
}};
XForm.prototype.releaseFocus=function(){
if(this.__focusObject!=null){
var t=this.getItemById(this.__focusObject);
var e=t.getElement();
if(e&&e.blur){
e.blur()
}
this.__focusObject=null
}};
XForm.prototype._reparentDwtObject=function(a,t){
var e=a.getHtmlElement();
if(e.parentNode){
e.parentNode.removeChild(e)
}
t.appendChild(e)
};
XForm.prototype.shouldInsertItem=function(e){
return(this._itemsToInsert[e.getId()]!=null)
};
XForm.prototype.insertExternalWidget=function(t){
var e=t.getInsertMethod();
var a=t.getWidget();
if(a&&a.insertIntoXForm instanceof Function){
a.insertIntoXForm(this,t,t.getElement())
}else{
if(typeof this[e]=="function"){
this[e](t,t.getElement())
}else{}}
delete this._itemsToInsert[t.getId()]
}
}
if(AjxPackage.define("ajax.dwt.xforms.XFormItem")){
XFormItemFactory=function(){};
XFormItemFactory.createItem=function(r,o,c){
var s=this.getRefPath(r,o);
var a=this.getSubRefPath(r,o);
var h,t;
if(s!=null){
h=this.getModelItem(c.xmodel,r,s)
}
if(a!=null){
t=this.getModelItem(c.xmodel,r,a)
}
var l=this.getItemType(r,h);
var n=this.getItemTypeConstructor(l,c);
var d=new n();
d._setAttributes(r);
var e=(r.id?c.getId()+"_"+r.id:s?c.getId()+"_"+s:d.__parentItem?d.__parentItem.getId():c.getId()+"_"+d.type);
d.id=c.getUniqueId(e);
d.refPath=s;
d.subRefPath=a;
d.__modelItem=h;
d.__subModelItem=t;
d.__xform=c;
d.__parentItem=o;
c.indexItem(d,d.id);
d.initFormItem();
return d
};
XFormItemFactory.getRefPath=function(a,e){
if(a.refPath){
return a.refPath
}
var o=a.ref;
if(o==null){
return null
}
if(e){
var t=e.getRefPath();
if(t==null){
t=""
}}else{
var t=""
}
var n=o;
if(o=="."){
n=t
}else{
if(o==".."){
t=t.split("/");
n=t.slice(0,t.length-1).join("/")
}else{
if(t==""){
n=o
}else{
n=t+"/"+o
}}}
return n
};
XFormItemFactory.getSubRefPath=function(a,e){
if(a.subRefPath){
return a.subRefPath
}
var n=a.subRef;
if(n==null){
return null
}
if(e){
var t=e.getSubRefPath();
if(t==null){
t=""
}}else{
var t=""
}
var o=n;
if(n=="."){
o=t
}else{
if(n==".."){
t=t.split("/");
o=t.slice(0,t.length-1).join("/")
}else{
if(t==""){
o=n
}else{
o=t+"/"+n
}}}
return o
};
XFormItemFactory.getModelItem=function(a,e,t){
if(t==null||t==""){
return null
}
return a.getItem(t,true)
};
XFormItemFactory.getItemType=function(t,o){
var n=t.type;
if(n==null){
n=t.type=_OUTPUT_
}
var a=(o&&o.type?o.type:_STRING_);
if(n==_INPUT_){
if(t.value!==_UNDEFINED_){
n=_CHECKBOX_
}else{
switch(a){
case _STRING_:case _NUMBER_:n=_INPUT_;
break;
case _DATE_:case _DATETIME_:case _TIME_:n=a;
break;
default:n=_INPUT_
}}}else{
if(n==_SELECT_){
var e=t.appearance;
if(e==_RADIO_){
n=_RADIO_
}else{
n=_SELECT_
}}}
return n
};
XFormItemFactory.typeConstructorMap={};
XFormItemFactory.createItemType=function(o,e,a,t){
if(a==null){
a=new Function()
}
if(typeof t=="string"){
t=this.getItemTypeConstructor(t)
}
if(t==null){
t=XFormItem
}
a.prototype=new t();
a.prototype.type=e;
a.prototype.constructor=a;
a.prototype.toString=new Function("return '[XFormItem:"+e+" ' + this.getId() + ']'");
a.toString=new Function("return '[Class XFormItem:"+e+"]'");
this.registerItemType(o,e,a);
return a
};
XFormItemFactory.registerItemType=function(a,e,t){
window[a]=e;
this.typeConstructorMap[e]=t
};
XFormItemFactory.defaultItemType="output";
XFormItemFactory.getItemTypeConstructor=function(e,t){
var a=(t&&t.typeConstructorMap?t.typeConstructorMap:this.typeConstructorMap);
var n=a[e];
if(n==null){
var o=(t?t.defaultItemType:this.defaultItemType);
a[o]
}
return n
};
XFormItemFactory.quickClone=function(e){
this.cloner.prototype=e;
return new this.cloner()
};
XFormItemFactory.cloner=function(){};
XFormItemFactory.initItemDefaults=function(o,r){
o.typeConstructorMap=this.quickClone(this.typeConstructorMap);
if(r==null){
r=o.itemDefaults
}
if(r!=null){
for(var a in r){
var t=this.typeConstructorMap[a];
var n=r[a];
if(t==null){
a=window[a];
t=this.typeConstructorMap[a]
}
if(t==null){
continue
}
var e=o.typeConstructorMap[a]=new Function();
e.prototype=new t();
e.prototype.constructor=e;
for(var s in n){
e.prototype[s]=n[s]
}}}};
XFormItem=function(){};
XFormItem.prototype.constructor=XFormItem;
XFormItemFactory.registerItemType("_FORM_ITEM_","form_item",XFormItem);
XFormItem.ERROR_STATE_ERROR=0;
XFormItem.ERROR_STATE_VALID=1;
XFormItem.prototype._isXFormItem=true;
XFormItem.prototype.writeElementDiv=false;
XFormItem.prototype.labelLocation=_LEFT_;
XFormItem.prototype.tableCssClass="xform_table";
XFormItem.prototype.tableCssStyle=null;
XFormItem.prototype.containerCssClass="xform_container";
XFormItem.prototype.containerCssStyle=null;
XFormItem.prototype.cssClass=null;
XFormItem.prototype.labelCssClass="xform_label";
XFormItem.prototype.errorCssClass="xform_error";
XFormItem.prototype.nowrap=false;
XFormItem.prototype.labelWrap=false;
XFormItem.prototype.align=_UNDEFINED_;
XFormItem.prototype.valign=_UNDEFINED_;
XFormItem.prototype.focusable=false;
XFormItem.prototype.bmolsnr=false;
XFormItem.prototype.forceUpdate=false;
XFormItem.prototype.isBlockElement=false;
XFormItem.prototype.visibilityChecks=[];
XFormItem.prototype.enableDisableChecks=[];
XFormItem.prototype.visibilityChangeEventSources=[];
XFormItem.prototype.enableDisableChangeEventSources=[];
XFormItem.prototype.valueChangeEventSources=[];
XFormItem.prototype.visibilityUpdaters=[];
XFormItem.prototype.enabledDisabledUpdaters=[];
XFormItem.prototype.elementChangeHandler="onchange";
XFormItem.prototype.selection=_CLOSED_;
XFormItem.prototype.openSelectionLabel="";
XFormItem.prototype.errorLocation=_SELF_;
XFormItem.prototype.helpTooltip=false;
XFormItem.prototype._setAttributes=function(e){
this.__attributes=e
};
XFormItem.prototype.initFormItem=function(){
if(this.focusable){
var e=XFormItem.getParentTabGroupId(this);
if(e){
var t=this.getForm().getItemById(e);
t.tabIdOrder.push(this.getId())
}}};
XFormItem.prototype.initializeItems=function(){
var e=this.getItems();
if(e!=null){
this.items=this.getForm().initItemList(e,this)
}};
XFormItem.prototype.registerActiveChild=function(e){
if(!this.activeChildren){
this.activeChildren={}
}
this.activeChildren[e.getId()]=true
};
XFormItem.prototype.signUpForEvents=function(){
var s;
s=this.getModelItem();
var o=this.getInheritedProperty("visibilityChangeEventSources");
if(!AjxUtil.isEmpty(o)){
var r=this.getModel();
var t=o.length;
if(r&&t>0){
for(var n=0;
n<t;
n++){
var e=r.getItem(o[n],false);
if(e){
var h=new AjxListener(this,XFormItem.prototype.updateVisibilityLsnr);
e.addListener(DwtEvent.XFORMS_VALUE_CHANGED,h)
}}}}
var a=this.getInheritedProperty("enableDisableChangeEventSources");
if(!AjxUtil.isEmpty(a)){
var r=this.getModel();
var t=a.length;
if(r&&t>0){
for(var n=0;
n<t;
n++){
var e=r.getItem(a[n],false);
if(e){
var h=new AjxListener(this,XFormItem.prototype.updateEnabledDisabledLsnr);
e.addListener(DwtEvent.XFORMS_VALUE_CHANGED,h)
}}}}
var c=this.getInheritedProperty("valueChangeEventSources");
if(!AjxUtil.isEmpty(c)){
var r=this.getModel();
var t=c.length;
if(r&&t>0){
for(var n=0;
n<t;
n++){
var e=r.getItem(c[n],false);
if(e){
var h=new AjxListener(this,XFormItem.prototype.valueChangeLsnr);
e.addListener(DwtEvent.XFORMS_VALUE_CHANGED,h)
}}}}
var l=this.getInheritedProperty("bmolsnr");
if(s&&l){
var h=new AjxListener(this,XFormItem.prototype.valueChangeLsnr);
s.addListener(DwtEvent.XFORMS_VALUE_CHANGED,h)
}};
XFormItem.prototype.valueChangeLsnr=function(t){
var o=this.getUpdateElementMethod();
if(!o){
return
}
var a=this.getInstanceValue();
var e=this.getDisplayValueMethod();
if(e){
a=e.call(this,a)
}
o.call(this,a)
};
XFormItem.prototype.updateElement=function(){
if(!this.activeChildren){
return
}
for(var s in this.activeChildren){
if(this.activeChildren[s]===true){
var a=this.getForm().getItemById(s);
if(a&&this.getInstance()){
var n=a.getUpdateElementMethod();
var t=a.getDisplayValueMethod();
if(n){
var e=this.getModel();
var o=a.getRefPath()?e.getInstanceValue(this.getInstance(),a.getRefPath()):a.getValue();
if(t){
o=t.call(a,o)
}
n.call(a,o)
}}}}};
XFormItem.prototype.hasReadPermission=function(t){
var e=this.getInstance();
if(!e.getAttrs){
return false
}
var a=null;
if(t){
a=t
}else{
if(!this.refPath){
return true
}else{
a=this.refPath
}}
return((e.getAttrs.all===true)||(e.getAttrs[a]===true))
};
XFormItem.prototype.hasWritePermission=function(t){
var e=this.getInstance();
if(!e.setAttrs){
return false
}
var a=null;
if(t){
a=t
}else{
if(!this.refPath){
return true
}else{
a=this.refPath
}}
return((e.setAttrs.all===true)||(e.setAttrs[a]===true))
};
XFormItem.prototype.hasRight=function(t){
var e=this.getInstance();
if(!e.rights){
return false
}
if(!t){
return true
}
return(e.rights[t]===true)
};
XFormItem.prototype.updateVisibilityLsnr=function(e){
var t=this.getUpdateVisibilityMethod();
t.call(this)
};
XFormItem.prototype.updateVisibility=function(){
var isVisible=true;
var parentItem=this.getParentItem();
if(parentItem){
isVisible=this.getParentItem().getIsVisible()
}
if(isVisible){
var myVisibilityChecks=this.getInheritedProperty("visibilityChecks");
if(myVisibilityChecks&&myVisibilityChecks instanceof Array){
var cnt=myVisibilityChecks.length;
for(var i=0;
i<cnt;
i++){
if(myVisibilityChecks[i]!=null){
if(typeof(myVisibilityChecks[i])=="function"){
isVisible=myVisibilityChecks[i].call(this);
if(!isVisible){
break
}}else{
if(myVisibilityChecks[i] instanceof Array){
var func=myVisibilityChecks[i].shift();
isVisible=func.apply(this,myVisibilityChecks[i]);
myVisibilityChecks[i].unshift(func);
if(!isVisible){
break
}}else{
if(typeof(myVisibilityChecks[i])=="string"){
var instance=this.getInstance();
isVisible=eval(myVisibilityChecks[i]);
if(!isVisible){
break
}}}}}}}}
var reRunRefresh=false;
if(isVisible){
if(this.deferred){
reRunRefresh=true
}
this.show()
}else{
this.hide()
}
for(var itemId in this.activeChildren){
if(this.activeChildren[itemId]===true){
var item=this.getForm().getItemById(itemId);
if(item&&this.getInstance()){
var updateMethod=item.getUpdateVisibilityMethod();
if(updateMethod){
updateMethod.call(item)
}}}}
if(reRunRefresh){
this.updateEnabledDisabled();
this.updateElement()
}};
XFormItem.prototype.updateEnabledDisabledLsnr=function(e){
var t=this.getUpdateEnabledDisabledtMethod();
t.call(this)
};
XFormItem.prototype.updateEnabledDisabled=function(r){
var l=true;
var e=this.getParentItem();
if(e){
l=this.getParentItem().getIsEnabled()
}
if(l){
var o=this.getInheritedProperty("enableDisableChecks");
if(o&&o instanceof Array){
var t=o.length;
for(var n=0;
n<t;
n++){
if(o[n]!=null){
if(typeof(o[n])=="function"){
l=o[n].call(this);
if(!l){
break
}}else{
if(o[n] instanceof Array){
var a=o[n].shift();
if(!a||!a.apply){
continue
}
l=a.apply(this,o[n]);
o[n].unshift(a);
if(!l){
break
}}}}}}else{
if(o==false){
l=false
}}}
if(l){
this.enableElement()
}else{
this.disableElement()
}
for(var h in this.activeChildren){
if(this.activeChildren[h]===true){
var c=this.getForm().getItemById(h);
if(c&&this.getInstance()){
var s=c.getUpdateEnabledDisabledtMethod();
if(s){
s.call(c)
}}}}};
XFormItem.prototype.setError=function(a,o){
var t=this.getErrorLocation();
if(t==_PARENT_||t==_INHERIT_){
this.getParentItem().setError(a,true);
return
}
this.getForm().addErrorItem(this);
this.__errorState=XFormItem.ERROR_STATE_ERROR;
var e=this.getErrorContainer(true);
if(e){
e.innerHTML=a
}};
XFormItem.prototype.clearError=function(){
var e=this.getErrorLocation();
if(e==_PARENT_||e==_INHERIT_){
this.getParentItem().clearError();
return
}
this.getForm().removeErrorItem(this);
this.__errorState=XFormItem.ERROR_STATE_VALID;
this.removeErrorContainer()
};
XFormItem.prototype.hasError=function(){
return(this.__errorState==XFormItem.ERROR_STATE_ERROR)
};
XFormItem.prototype.getErrorContainer=function(t){
var e=this.getElement(this.getId()+"___error_container");
if(e!=null){
return e
}
if(t==true&&this.getContainer()){
return this.createErrorContainer()
}
return null
};
XFormItem.prototype.createErrorContainer=function(){
var t=document.createElement("div");
t.id=this.getId()+"___error_container";
t.className=this.getErrorCssClass();
var e=this.getContainer();
if(e.hasChildNodes()){
e.insertBefore(t,e.firstChild)
}else{
e.appendChild(t)
}
return t
};
XFormItem.prototype.removeErrorContainer=function(){
var e=this.getErrorContainer();
if(e!=null){
e.parentNode.removeChild(e)
}};
XFormItem.prototype.getType=function(){
return this.type
};
XFormItem.prototype.getParentItem=function(){
return this.__parentItem
};
XFormItem.prototype.getForm=function(){
return this.__xform
};
XFormItem.prototype.getGlobalRef=function(){
return this.getForm().getGlobalRefString()+".getItemById('"+this.getId()+"')"
};
XFormItem.prototype.getFormGlobalRef=function(){
return this.getForm().getGlobalRefString()
};
XFormItem.prototype.getInstance=function(){
return this.getForm().instance
};
XFormItem.prototype.getModel=function(){
return this.getForm().getModel()
};
XFormItem.prototype.getController=function(){
return this.getForm().getController()
};
XFormItem.prototype.getFormController=function(){
return this.getForm().getController()
};
XFormItem.prototype.getModelItem=function(){
return this.__modelItem
};
XFormItem.prototype.getSubModelItem=function(){
return this.__subModelItem
};
XFormItem.prototype.getRef=function(){
if(this.ref!==_UNDEFINED_){
return this.ref
}
return this.__attributes.ref
};
XFormItem.prototype.getRefPath=function(){
return this.refPath
};
XFormItem.prototype.getSubRefPath=function(){
return this.subRefPath
};
XFormItem.prototype.getId=function(){
return this.id
};
XFormItem.prototype.getExternalId=function(){
var e=null;
if(this.__attributes.id!==_UNDEFINED_){
e=this.__attributes.id
}else{
if((e=this.getRef())!==_UNDEFINED_){}else{
e=null
}}
return e
};
XFormItem.prototype.getOnChangeMethod=function(){
return this.cacheInheritedMethod("onChange","$onChange","value,event,form")
};
XFormItem.prototype.getOnActivateMethod=function(){
return this.cacheInheritedMethod("onActivate","$onActivate","event")
};
XFormItem.prototype.getOnClickMethod=function(){
return this.cacheInheritedMethod("onClick","$onClick","event")
};
XFormItem.prototype.getExternalChangeHandler=function(){
return"var item = "+this.getGlobalRef()+"; var elementChangedMethod = item.getElementChangedMethod(); elementChangedMethod.call(item, value, item.getInstanceValue(), event||window.event);"
};
XFormItem.prototype.getElementValueGetterHTML=function(){
return"var value = this.value;"
};
XFormItem.prototype.getChangeHandlerHTML=function(){
var e=this.getElementChangeHandler();
if(e!="onkeypress"){
return AjxBuffer.concat(" ",e,'="',this.getChangehandlerJSCode()+'"',this.getKeyPressHandlerHTML())
}else{
return this.getKeyPressHandlerHTML()
}};
XFormItem.prototype.getChangehandlerJSCode=function(){
return AjxBuffer.concat(this.getElementValueGetterHTML(),this.getExternalChangeHandler())
};
XFormItem.prototype.getFocusHandlerHTML=function(){
var o=this.getFormGlobalRef(),a=this.getId();
var t=this.getInheritedProperty("inputHelp");
var n="";
if(t!=null){
n="if (this.value == '"+t+"') this.value=''; "
}
var e=null;
if(this.getInheritedProperty("onFocus")!=null){
e=AjxBuffer.concat(' onfocus="',o,".onFocus('",a,"'); ",n,this.getInheritedProperty("onFocus"),".call(",this.getGlobalRef(),', event )"')
}else{
e=AjxBuffer.concat(' onfocus="',o,".onFocus('",a,"');",n,'"')
}
return AjxBuffer.concat(e,' onblur="',o,".onBlur('",a,"')\"")
};
XFormItem.prototype.getOnActivateHandlerHTML=function(){
var e=this.getOnActivateMethod();
if(e==null){
return""
}
return AjxBuffer.concat(" ",this.getElementChangeHandler(),'="',this.getGlobalRef(),'.$onActivate(event||window.event)"')
};
XFormItem.prototype.getClickHandlerHTML=function(){
var e=this.getOnClickMethod();
if(e==null){
return""
}
return AjxBuffer.concat(' onclick="',this.getGlobalRef(),'.$onClick(event||window.event)"');
return AjxBuffer.concat(onClickAction)
};
XFormItem.prototype.handleKeyUp=function(n,a){
var t=DwtKeyEvent.getCharCode(n);
if(!AjxUtil.isEmpty(this.keyPressDelayHdlr)&&t!=DwtKeyEvent.KEY_ENTER){
AjxTimedAction.cancelAction(this.keyPressDelayHdlr);
this.keyPressDelayHdlr=null
}
var o=this.getForm();
var e=new DwtKeyEvent();
e.setFromDhtmlEvent(n);
if(t==DwtKeyEvent.KEY_TAB){
DwtUiEvent.setBehaviour(n,true,false);
return false
}else{
var s=new AjxTimedAction(this,this.handleKeyPressDelay,[e,a]);
this.keyPressDelayHdlr=AjxTimedAction.scheduleAction(s,250)
}};
XFormItem.prototype.handleKeyDown=function(o,a){
o=(o!=null)?o:window.event;
var t=DwtKeyEvent.getCharCode(o);
if(t==DwtKeyEvent.KEY_ENTER){
DwtUiEvent.setBehaviour(o,true,true);
return false
}else{
if(t==DwtKeyEvent.KEY_TAB){
DwtUiEvent.setBehaviour(o,true,false);
var e=XFormItem.getParentTabGroupId(this);
if(o.shiftKey){
this.getForm().focusPrevious(this.getId(),e)
}else{
this.getForm().focusNext(this.getId(),e)
}
return false
}}
return true
};
XFormItem.prototype.handleKeyPressDelay=function(a,t){
this.keyPressDelayHdlr=null;
if(this.$changeHandlerFunc==null){
var e=this.getChangehandlerJSCode();
this.$changeHandlerFunc=new Function("event",e)
}
if(this.$changeHandlerFunc){
this.$changeHandlerFunc.call(t,a)
}};
XFormItem.prototype.getKeyPressHandlerHTML=function(){
var e="onkeydown";
if(AjxEnv.isNav){
e="onkeypress"
}
return AjxBuffer.concat(" ",e,'="',this.getGlobalRef(),'.handleKeyDown(event, this)"',' onkeyup="',this.getGlobalRef(),'.handleKeyUp(event, this)"')
};
XFormItem.prototype.outputContainerTDStartHTML=function(e,o,a){
var t=this.getAlign();
e.append('<td id="',this.getId(),'___container"',(o>1?" colspan="+o:""),(a>1?" rowspan="+a:""),this.getContainerCssString(),(t!=_UNDEFINED_?" align='"+t+"'":""),">")
};
XFormItem.prototype.outputContainerTDEndHTML=function(e){
e.append('</td id="',this.getId(),'___container">')
};
XFormItem.prototype.outputElementDivStart=function(e){
e.append("<div id=",this.getId(),this.getCssString()," xform_type='elementDiv'>")
};
XFormItem.prototype.outputElementDivEnd=function(e){
e.append('</div id="',this.getId(),'">')
};
XFormItem.prototype.outputLabelCellHTML=function(o,s,e){
var a=this.getLabel();
if(a==null){
return
}
if(a==""){
a="&nbsp;"
}
if(e==_INLINE_){
var n=this.getLabelCssStyle();
if(n==null){
n=""
}
n="position:relative;left:10px;top:5px;text-align:left;background-color:#eeeeee;margin-left:5px;margin-right:5px;"+n;
o.append('<div id="',this.getId(),'___label"',this.getLabelCssString(null,n),">",a,"</div>")
}else{
var t=this.getInheritedProperty("enableLabelFor");
if(t){
o.append('<td id="',this.getId(),'___label"',this.getLabelCssString(),(s>1?" rowspan="+s:""),">","<label for='",this.getId(),"'>",a,"</label>")
}else{
if(!this.getInheritedProperty("helpTooltip")||!this.getInheritedProperty("showHelpTooltip")||!this.getInheritedProperty("hideHelpTooltip")){
o.append('<td id="',this.getId(),'___label"',this.getLabelCssString(),(s>1?" rowspan="+s:""),">",a)
}else{
o.append('<td id="',this.getId(),'___label"',this.getLabelCssString(),' onclick="',"XFormItem.prototype.showHelpTooltip",".call(",this.getGlobalRef(),', event );" ',' onmouseout="',"XFormItem.prototype.hideHelpTooltip",".call(",this.getGlobalRef(),', event );" ',(s>1?" rowspan="+s:""),">",a)
}}
if(this.getRequired()){
o.append("<span class='redAsteric'>*</span>")
}
o.append("</td>")
}};
XFormItem.getParentTabGroupId=function(e){
while(e!=null){
var t=e.getParentItem();
if(t==null||(!t instanceof XFormItem)){
return null
}else{
if(t instanceof Group_XFormItem&&t.getInheritedProperty("isTabGroup")==true){
return t.getId()
}}
e=t
}};
XFormItem.prototype.elementChanged=function(a,t,e){
this.getForm().itemChanged(this.getId(),a,e)
};
XFormItem.prototype.getInstanceValue=function(e){
if(e==null){
e=this.getRefPath()
}
if(e==null){
return null
}
return this.getModel().getInstanceValue(this.getInstance(),e)
};
XFormItem.prototype.getInstanceCount=function(){
if(this.getRefPath()==null){
return 0
}
return this.getModel().getInstanceCount(this.getInstance(),this.getRefPath())
};
XFormItem.prototype.setInstanceValue=function(e,t){
if(t==null){
t=this.getRefPath()
}
if(t==null){
return null
}
return this.getModel().setInstanceValue(this.getInstance(),t,e)
};
XFormItem.prototype.set=XFormItem.prototype.setInstancevalue;
XFormItem.getValueFromHTMLSelect=function(a){
var e=[];
for(var t=0;
t<a.options.length;
t++){
if(a.options[t].selected){
e[e.length]=a.options[t].value
}}
return e.join(",")
};
XFormItem.prototype.getValueFromHTMLSelect=function(e){
if(e==null){
e=this.getElement()
}
return XFormItem.getValueFromHTMLSelect(e)
};
XFormItem.updateValueInHTMLSelect1=function(n,a,o){
if(a==null){
return null
}
if(o==null){
o=false
}
var t=a.options;
for(i=0;
i<t.length;
i++){
var e=t[i];
if(e.value==n){
a.selectedIndex=i;
return a.value
}}
if(t.length>0){
a.selectedIndex=0;
return t[0].value
}
return null
};
XFormItem.prototype.updateValueInHTMLSelect1=function(a,e,t){
if(e==null){
e=this.getElement()
}
if(t==null){
t=this.getSelectionIsOpen()
}
return XFormItem.updateValueInHTMLSelect1(a,e,t)
};
XFormItem.updateValueInHTMLSelect=function(e,o,a){
if(o==null){
return null
}
if(e==null){
e=""
}
if(a==null){
a=false
}
if(typeof e=="string"){
e=e.split(",")
}
var s="{|[",r="]|}";
e=s+e.join(r+s)+r;
var l=o.options;
var t=false;
for(var n=0;
n<l.length;
n++){
var h=(e.indexOf(s+l[n].value+r)>-1);
l[n].selected=h;
t=t||h
}
if(!t&&!a){
l[0].selected=true
}};
XFormItem.prototype.updateValueInHTMLSelect=function(a,e,t){
if(a==null){
a=""
}
if(e==null){
e=this.getElement()
}
if(t==null){
t=this.getSelectionIsOpen()
}
return XFormItem.updateValueInHTMLSelect(a,e,t)
};
XFormItem.prototype.getChoicesHTML=function(){
var r=this.getNormalizedChoices();
if(r==null){
return""
}
var a=new AjxBuffer();
this.outputChoicesHTMLStart(a);
var e=r.values;
var s=r.labels;
var o=r.visible;
var n=this.getChoiceCssClass();
for(var t=0;
t<e.length;
t++){
if(o&&(o[t]==false)){}else{
a.append("",this.getChoiceHTML(t,e[t],s[t],n,""))
}}
this.outputChoicesHTMLEnd(a);
return a.toString()
};
XFormItem.prototype.outputChoicesHTMLStart=function(e){
return
};
XFormItem.prototype.outputChoicesHTMLEnd=function(e){
return
};
XFormItem.prototype.getChoiceCssClass=function(){
return""
};
XFormItem.prototype.getChoiceHTML=function(o,a,t,e){
return AjxBuffer.concat('<option value="',a,'">',t,"</option>")
};
XFormItem.prototype.updateChoicesHTML=function(){
this.cleanChoiceDisplay();
var e=new AjxBuffer();
this.outputHTML(e,new AjxBuffer());
if(this.getContainer()){
this.getContainer().innerHTML=e.toString()
}
return
};
XFormItem.prototype.getInheritedProperty=function(t){
if(this.__attributes[t]!==_UNDEFINED_){
return this.__attributes[t]
}
if(this[t]!==_UNDEFINED_){
return this[t]
}
var e=this.__modelItem;
if(e&&e[t]!==_UNDEFINED_){
return e[t]
}
return null
};
XFormItem.prototype.cacheInheritedProperty=function(t,e){
if(this[e]!==_UNDEFINED_){
return this[e]
}
return(this[e]=this.getInheritedProperty(t))
};
XFormItem.prototype.cacheInheritedMethod=function(e,t,o){
if(this[t]!==_UNDEFINED_){
return this[t]
}
var a=this.getInheritedProperty(e);
if(a!=null){
a=this.convertToFunction(a,o)
}
this[t]=a;
return a
};
XFormItem.prototype.getElement=XForm.prototype.getElement;
XFormItem.prototype.showElement=function(e){
XForm.prototype.showElement.call(this,e)
};
XFormItem.prototype.getIsVisible=function(){
return this.__isVisible
};
XFormItem.prototype.getIsEnabled=function(){
return this.__isEnabled
};
XFormItem.prototype.hideElement=function(t,e){
XForm.prototype.hideElement.call(this,t,e)
};
XFormItem.prototype.createElement=XForm.prototype.createElement;
XFormItem.estimateMyWidth=function(e,a,n,o){
var t=(String(e).length/2)*XForm.FONT_WIDTH1+(String(e).length/2)*XForm.FONT_WIDTH2+14;
if(a){
t=t+24
}
if(n>0){
t=t+n
}
t=(t>=o)?t:o;
return[t,"px"].join("")
};
XFormItem.prototype.getWidget=function(){
return this.widget
};
XFormItem.prototype.setWidget=function(e){
this.widget=e
};
XFormItem.prototype.getContainer=function(){
return this.getElement(this.getId()+"___container")
};
XFormItem.prototype.getLabelContainer=function(){
return this.getElement(this.getId()+"___label")
};
XFormItem.prototype.show=function(){
if(this.deferred){
this._outputHTML()
}
var e=this.getLabelContainer();
if(e){
this.showElement(e)
}
e=this.getContainer();
if(e!=null){
this.showElement(e)
}
this.__isVisible=true
};
XFormItem.prototype.hide=function(e){
e=this.getInheritedProperty("isBlockElement")||e;
var t=this.getLabelContainer();
if(t){
this.hideElement(t,e)
}
t=this.getContainer();
if(t!=null){
this.hideElement(t,e)
}else{
var a=this.getItems();
if(a!=null){
for(var o=0;
o<a.length;
o++){
a[o].hide(e)
}}}
this.__isVisible=false
};
XFormItem.prototype.focus=function(){
this.getForm().focusElement(this.getId())
};
XFormItem.prototype.getRequired=function(){
return this.getInheritedProperty("required")
};
XFormItem.prototype.getValue=function(){
return this.getInheritedProperty("value")
};
XFormItem.prototype.getItems=function(){
if(this.items){
return this.items
}
return this.__attributes.items
};
XFormItem.prototype.getChoices=function(){
return this.getInheritedProperty("choices")
};
XFormItem.prototype.getNormalizedChoices=function(){
if(this.$normalizedChoices){
return this.$normalizedChoices
}
var t=this.getChoices();
if(t==null){
return null
}
if(typeof t=="function"){
t=t.call(this)
}
var e;
if(typeof t.getChoices=="function"){
e=t.getChoices()
}else{
if(AjxUtil.isArray(t)){
if(typeof t[0]=="object"){
e=XFormChoices.normalizeChoices(t,XFormChoices.OBJECT_LIST)
}else{
e=XFormChoices.normalizeChoices(t,XFormChoices.SIMPLE_LIST)
}}else{
e=XFormChoices.normalizeChoices(t,XFormChoices.HASH)
}}
this.$normalizedChoices=e;
return this.$normalizedChoices
};
XFormItem.prototype.getNormalizedValues=function(){
var e=this.getNormalizedChoices();
if(e){
return e.values
}
return null
};
XFormItem.prototype.getNormalizedLabels=function(){
var e=this.getNormalizedChoices();
if(e){
return e.labels
}
return null
};
XFormItem.prototype.getAppearance=function(){
return this.getInheritedProperty("appearance")
};
XFormItem.prototype.getCssClass=function(){
return this.getInheritedProperty("cssClass")
};
XFormItem.prototype.getCssStyle=function(){
return this.getInheritedProperty("cssStyle")
};
XFormItem.prototype.getLabel=function(e){
return this.getInheritedProperty("label")
};
XFormItem.prototype.getErrorCssClass=function(){
return this.getInheritedProperty("errorCssClass")
};
XFormItem.prototype.getLabelCssClass=function(e){
if(e!=null){
return e
}
return this.getInheritedProperty("labelCssClass")
};
XFormItem.prototype.getLabelCssStyle=function(e){
if(e!=null){
return e
}
return this.getInheritedProperty("labelCssStyle")
};
XFormItem.prototype.getLabelWrap=function(){
return this.getInheritedProperty("labelWrap")
};
XFormItem.prototype.getLabelLocation=function(){
return this.getInheritedProperty("labelLocation")
};
XFormItem.prototype.getContainerCssClass=function(){
return this.getInheritedProperty("containerCssClass")
};
XFormItem.prototype.getContainerCssStyle=function(){
return this.getInheritedProperty("containerCssStyle")
};
XFormItem.prototype.getTableCssClass=function(){
return this.getInheritedProperty("tableCssClass")
};
XFormItem.prototype.getTableCssStyle=function(){
return this.getInheritedProperty("tableCssStyle")
};
XFormItem.prototype.getNowrap=function(){
return this.getInheritedProperty("nowrap")
};
XFormItem.prototype.getWidth=function(){
return this.cacheInheritedProperty("width","_width")
};
XFormItem.prototype.getHeight=function(){
return this.getInheritedProperty("height")
};
XFormItem.prototype.getOverflow=function(){
return this.getInheritedProperty("overflow")
};
XFormItem.prototype.getNumCols=function(){
return this.getInheritedProperty("numCols")
};
XFormItem.prototype.getAlign=function(){
return this.getInheritedProperty("align")
};
XFormItem.prototype.getValign=function(){
return this.getInheritedProperty("valign")
};
XFormItem.prototype.getName=function(){
return this.getInheritedProperty("name")
};
XFormItem.prototype.useParentTable=true;
XFormItem.prototype.getUseParentTable=function(){
return this.getInheritedProperty("useParentTable")
};
XFormItem.prototype.colSizes=_UNDEFINED_;
XFormItem.prototype.getColSizes=function(){
return this.getInheritedProperty("colSizes")
};
XFormItem.prototype.colSpan=1;
XFormItem.prototype.getColSpan=function(){
return this.getInheritedProperty("colSpan")
};
XFormItem.prototype.rowSpan=1;
XFormItem.prototype.getRowSpan=function(){
return this.getInheritedProperty("rowSpan")
};
XFormItem.prototype.getErrorLocation=function(){
return this.getInheritedProperty("errorLocation")
};
XFormItem.prototype.getChoiceLabel=function(a){
var o=this.getNormalizedChoices();
if(o==null){
return a
}
if(a==null){
a=""
}
var e=o.values;
for(var t=0;
t<e.length;
t++){
if(e[t]==a){
return o.labels[t]
}}
return a
};
XFormItem.prototype.getChoiceValue=function(t){
function o(h,r){
return String(h).toLowerCase()<String(r).toLowerCase()?-1:(String(h).toLowerCase()>String(r).toLowerCase()?1:0)
}
var s=this.getNormalizedChoices();
if(s==null){
return t
}
var n=s.labels;
var e=-1;
for(var a=0;
a<n.length;
a++){
if(o(t,n[a])==0){
e=a;
break
}}
if(e>=0){
return s.values[e]
}else{
return t
}};
XFormItem.prototype.getChoiceNum=function(a){
var o=this.getNormalizedChoices();
if(o==null){
return -1
}
var e=o.values;
for(var t=0;
t<e.length;
t++){
if(e[t]==a){
return t
}}
return -1
};
XFormItem.prototype.getCssString=function(){
var a=(this.getCssClass()||"");
if(a!=""&&a!=null){
a=' class="'+a+'"'
}
var n=(this.getCssStyle()||"");
var o=this.getWidth();
if(o!=null&&o!="auto"){
if(n.length){
n+=";"
}
if(!isNaN(Number(o))){
o+="px"
}
n+="width:"+o
}
var e=this.getHeight();
if(e!=null){
if(n.length){
n+=";"
}
if(!isNaN(Number(e))){
e+="px"
}
n+="height:"+e
}
var s=this.getOverflow();
if(s!=null){
if(n.length){
n+=";"
}
n+="overflow:"+s
}
if(this.getNowrap()){
if(n.length){
n+=";"
}
n+="white-space:nowrap"
}
var t=this.getValign();
if(t){
if(n.length){
n+=";"
}
n+="vertical-align:"+t
}
if(n!=""){
a+=' style="'+n+';"'
}
return a
};
XFormItem.prototype.getLabelCssString=function(a,t){
var e=(this.getLabelCssClass(a)||"");
if(e!=""&&e!=null){
e=' class="'+e+'"'
}
var t=(this.getLabelCssStyle(t)||"");
if(this.getLabelWrap()==false){
if(t.length){
t+=";"
}
t+="white-space:nowrap"
}
if(t!=""){
e+=' style="'+t+';"'
}
return e
};
XFormItem.prototype.getTableCssString=function(){
var e=(this.getTableCssClass()||"");
if(e!=""&&e!=null){
e=' class="'+e+'"'
}
var a=this.getTableCssStyle();
if(a==null){
a=""
}
var o=this.getColSizes();
if(o!=null){
if(a.length){
a+=";"
}
a+="table-layout:fixed"
}
var t=this.getWidth();
if(t!=null){
a+=";width:"+t
}
var n=this.getOverflow();
if(n!=null){
if(a.length){
a+=";"
}
a+="overflow:"+n
}
return e+(a!=null?' style="'+a+';"':"")
};
XFormItem.prototype.getContainerCssString=function(){
var t=(this.getContainerCssClass()||"");
if(t!=""&&t!=null){
t=' class="'+t+'"'
}
var a=this.getContainerCssStyle();
if(a==null){
a=""
}
var o=this.getAlign();
if(o!=_LEFT_){
if(o==_CENTER_||o==_MIDDLE_){
if(a.length){
a+=";"
}
a+="text-align:center"
}else{
if(o==_RIGHT_){
if(a.length){
a+=";"
}
a+="text-align:right"
}}}
var e=this.getValign();
if(e==_TOP_){
if(a.length){
a+=";"
}
a+="vertical-align:top"
}else{
if(e==_BOTTOM_){
if(a.length){
a+=";"
}
a+="vertical-align:bottom"
}else{
if(e==_CENTER_||e==_MIDDLE_){
if(a.length){
a+=";"
}
a+="vertical-align:middle"
}}}
if(a!=""){
t+=' style="'+a+';"'
}
return t
};
XFormItem.prototype.getElementChangeHandler=function(){
return this.getInheritedProperty("elementChangeHandler")
};
XFormItem.prototype.getForceUpdate=function(){
return this.getInheritedProperty("forceUpdate")
};
XFormItem.prototype.getOutputHTMLMethod=function(){
return this.convertToFunction(this.getInheritedProperty("outputHTML"),"html,currentCol")
};
XFormItem.prototype.getElementChangedMethod=function(){
return this.cacheInheritedMethod("elementChanged","$elementChanged","elementValue, instanceValue, event")
};
XFormItem.prototype.getUpdateElementMethod=function(){
return this.cacheInheritedMethod("updateElement","$updateElement","newValue")
};
XFormItem.prototype.getDisplayValueMethod=function(){
return this.cacheInheritedMethod("getDisplayValue","$getDisplayValue","newValue")
};
XFormItem.prototype.getUpdateVisibilityMethod=function(){
return this.cacheInheritedMethod("updateVisibility","$updateVisibility")
};
XFormItem.prototype.getUpdateEnabledDisabledtMethod=function(){
return this.cacheInheritedMethod("updateEnabledDisabled","$updateEnabledDisabled")
};
XFormItem.prototype.convertToFunction=function(e,t){
if((e==null)||(typeof(e)=="function")){
return e
}
if(typeof(this[e])=="function"){
return this[e]
}
return new Function(t,e)
};
XFormItem.prototype.dirtyDisplay=function(){
delete this.$lastDisplayValue
};
XFormItem.prototype.setElementEnabled=function(e){};
XFormItem.prototype.disableElement=function(){
this.setElementEnabled(false);
this.__isEnabled=false
};
XFormItem.prototype.enableElement=function(){
this.setElementEnabled(true);
this.__isEnabled=true
};
XFormItem.prototype.setElementDisabledProperty=function(e){
this.getElement().disabled=(e!=true)
};
XFormItem.prototype.setElementEnabledCssClass=function(e){
var t=this.getElement();
if(!t){
return
}
if(e){
t.className=this.getCssClass()
}else{
t.className=(this.getCssClass()+"_disabled")
}};
XFormItem.prototype.getSelection=function(){
return this.getInheritedProperty("selection")
};
XFormItem.prototype.getSelectionIsOpen=function(){
return this.getInheritedProperty("selection")
};
XFormItem.prototype.getOpenSelectionLabel=function(){
return this.getInheritedProperty("openSelectionLabel")
};
XFormItem.prototype.getNumberToShow=function(){
return this.getInheritedProperty("number")
};
XFormItem.prototype.getShowAddButton=function(){
return this.getInheritedProperty("showAddButton")
};
XFormItem.prototype.getShowRemoveButton=function(){
return this.getInheritedProperty("showRemoveButton")
};
XFormItem.prototype.getShowMoveUpButton=function(){
return this.getInheritedProperty("showMoveUpButton")
};
XFormItem.prototype.getShowMoveDownButton=function(){
return this.getInheritedProperty("showMoveDownButton")
};
XFormItem.prototype.getAddButton=function(){
return this.getInheritedProperty("addButton")
};
XFormItem.prototype.getRemoveButton=function(){
return this.getInheritedProperty("removeButton")
};
XFormItem.prototype.getMoveUpButton=function(){
return this.getInheritedProperty("moveUpButton")
};
XFormItem.prototype.getMoveDownButton=function(){
return this.getInheritedProperty("moveDownButton")
};
XFormItem.prototype.getAlwaysShowAddButton=function(){
return this.getInheritedProperty("alwaysShowAddButton")
};
XFormItem.prototype.getRepeatInstance=function(){
return this.getInheritedProperty("repeatInstance")
};
XFormItem.prototype.getSrc=function(){
return this.getInheritedProperty("src")
};
XFormItem.prototype.getSrcPath=function(){
return this.getInheritedProperty("srcPath")
};
XFormItem.prototype.getShowInNewWindow=function(){
return this.getInheritedProperty("showInNewWindow")
};
XFormItem.prototype.getWriteElementDiv=function(){
return this.getInheritedProperty("writeElementDiv")
};
XFormItem.prototype.getMultiple=function(){
return this.getInheritedProperty("multiple")
};
XFormItem.prototype.getAlwaysUpdateChoices=function(){
return this.getInheritedProperty("alwaysUpdateChoices")
};
XFormItem.prototype.choicesAreDirty=function(){
return(this._choiceDisplayIsDirty==true||this.getAlwaysUpdateChoices())
};
XFormItem.prototype.cleanChoiceDisplay=function(){
this._choiceDisplayIsDirty=false
};
XFormItem.prototype.showInputTooltip=function(t){
var o=new DwtUiEvent(true);
o.setFromDhtmlEvent(t);
var e=DwtShell.getShell(window);
var a=e.getToolTip();
a.setContent(this.getInheritedProperty("toolTipContent"));
a.popup(o.docX,o.docY)
};
XFormItem.prototype.hideInputTooltip=function(t){
var e=DwtShell.getShell(window);
var a=e.getToolTip();
a.popdown()
};
Output_XFormItem=function(){};
XFormItemFactory.createItemType("_OUTPUT_","output",Output_XFormItem,XFormItem);
Output_XFormItem.prototype.writeElementDiv=true;
Output_XFormItem.prototype.labelWrap=true;
Output_XFormItem.prototype.cssClass="xform_output";
Output_XFormItem.prototype.containerCssClass="xform_output_container";
Output_XFormItem.prototype.outputHTML=function(t){
var a=this.getValue();
var n=this.getDisplayValueMethod();
if(n){
a=n.call(this,a)
}
var e=this.getClickHandlerHTML();
var o=null;
if(e!=null&&e!=""){
o="<div "+this.getClickHandlerHTML()+">"+a+"</div>"
}
t.append(o||a)
};
Output_XFormItem.prototype.getDisplayValue=function(e){
e=this.getChoiceLabel(e);
if(e==null){
e=""
}else{
e=""+e
}
return e
};
Output_XFormItem.prototype.updateElement=function(o){
var t=this.getElement();
if(t){
var e=this.getClickHandlerHTML();
var a=null;
if(e!=null&&e!=""){
a="<div "+this.getClickHandlerHTML()+">"+o+"</div>"
}
o=a||o;
this.getElement().innerHTML=o
}};
Output_XFormItem.prototype.initFormItem=function(){
XFormItem.prototype.initFormItem.call(this);
var t=this.getChoices();
if(t==null||t.constructor!=XFormChoices){
return
}
var e=new AjxListener(this,this.dirtyDisplay);
t.addListener(DwtEvent.XFORMS_CHOICES_CHANGED,e);
this.signUpForEvents()
};
Output_XFormItem.prototype.dirtyDisplay=function(){
XFormItem.prototype.dirtyDisplay.call(this);
this._choiceDisplayIsDirty=true;
delete this.$normalizedChoices
};
Output_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementEnabledCssClass;
Textfield_XFormItem=function(){};
XFormItemFactory.createItemType("_TEXTFIELD_","textfield",Textfield_XFormItem,XFormItem);
XFormItemFactory.registerItemType("_INPUT_","input",Textfield_XFormItem);
Textfield_XFormItem.prototype._inputType="text";
Textfield_XFormItem.prototype.cssClass="xform_field";
Textfield_XFormItem.prototype.elementChangeHandler="onchange";
Textfield_XFormItem.prototype.focusable=true;
Textfield_XFormItem.prototype.nowrap=false;
Textfield_XFormItem.prototype.labelWrap=true;
Textfield_XFormItem.prototype.containerCssClass="xform_field_container";
Textfield_XFormItem.prototype.visibilityChecks=[XFormItem.prototype.hasReadPermission];
Textfield_XFormItem.prototype.enableDisableChecks=[XFormItem.prototype.hasWritePermission];
Textfield_XFormItem.prototype.outputHTML=function(a,s){
var o=this._inputType;
var n=this.getValue();
var t=this.getModelItem();
var e=this.getInheritedProperty("inputHelp");
a.append("<input autocomplete='off' id=\"",this.getId(),'" type="',o,'"',this.getCssString(),this.getChangeHandlerHTML(),this.getFocusHandlerHTML(),this.getClickHandlerHTML(),this.getMouseoutHandlerHTML(),(n!=null?' value="'+n+'"':""),">")
};
Textfield_XFormItem.prototype.getClickHandlerHTML=function(){
var o=this.getFormGlobalRef(),a=this.getId();
var e="";
var t=this.getInheritedProperty("onClick");
e=AjxBuffer.concat(' onclick="',t||"XFormItem.prototype.showInputTooltip",".call(",this.getGlobalRef(),', event );" ');
return AjxBuffer.concat(e)
};
Textfield_XFormItem.prototype.getMouseoutHandlerHTML=function(){
var o=this.getFormGlobalRef(),a=this.getId();
var e="";
var t=this.getInheritedProperty("onMouseout");
e=AjxBuffer.concat(' onmouseout="',t||"XFormItem.prototype.hideInputTooltip",".call(",this.getGlobalRef(),', event );" ');
return AjxBuffer.concat(e)
};
Textfield_XFormItem.prototype.updateElement=function(t){
if(t==null){
t=this.getValue()
}
var e=this.getInheritedProperty("inputHelp");
if((t==null)&&(e!=null)){
t=e
}else{
if(t==null){
t=""
}}
if(this.getElement()&&this.getElement().value!=t){
this.getElement().value=t
}};
Textfield_XFormItem.prototype.setElementEnabled=function(e){
if(this.getElement()){
this.setElementDisabledProperty(e);
this.setElementEnabledCssClass(e)
}};
Textfield_XFormItem.prototype.createDataList=function(r){
if(!AjxEnv.supported.input.list){
return
}
r=r||[];
var o=this.getId()+"_datalist";
var h=Dwt.getElement(o);
if(h){
h.parentNode.removeChild(h)
}
var a=this.getElement();
a.setAttribute("list",o);
var t=document.createElement("datalist");
t.id=o;
for(var e=0;
e<r.length;
e++){
var n=document.createElement("option");
n.value=r[e];
t.appendChild(n)
}
a.parentNode.appendChild(t);
var s=this.getOnChangeMethod();
if(typeof s==="function"){
Dwt.setHandler(a,DwtEvent.ONINPUT,function(){
s.call(this,this.getElement().value,false,this.getForm())
}
.bind(this))
}};
Secret_XFormItem=function(){};
XFormItemFactory.createItemType("_SECRET_","secret",Secret_XFormItem,Textfield_XFormItem);
XFormItemFactory.registerItemType("_PASSWORD_","password",Secret_XFormItem);
Secret_XFormItem.prototype._inputType="password";
Secret_XFormItem.prototype.focusable=true;
File_XFormItem=function(){};
XFormItemFactory.createItemType("_FILE_","file",File_XFormItem,Textfield_XFormItem);
File_XFormItem.prototype._inputType="file";
File_XFormItem.prototype.forceUpdate=false;
File_XFormItem.prototype.focusable=true;
Textarea_XFormItem=function(){};
XFormItemFactory.createItemType("_TEXTAREA_","textarea",Textarea_XFormItem,Textfield_XFormItem);
Textarea_XFormItem.prototype.width="100%";
Textarea_XFormItem.prototype.height=100;
Textarea_XFormItem.prototype.focusable=true;
Textarea_XFormItem.prototype.outputHTML=function(e,a){
var t=this.getInheritedProperty("textWrapping");
if(!t){
t="off"
}
e.append('<textarea id="',this.getId(),'"',this.getCssString(),this.getChangeHandlerHTML(),this.getFocusHandlerHTML(),"wrap='",t,"'","></textarea>")
};
Textarea_XFormItem.prototype.setElementDisabledProperty=function(e){
this.getElement().disabled=(e!=true);
this.getElement().readOnly=(e!=true)
};
Textarea_XFormItem.prototype.getKeyPressHandlerHTML=function(){
var e="onkeydown";
if(AjxEnv.isNav||AjxEnv.isChrome||AjxEnv.isSafari){
e="onkeypress"
}
return AjxBuffer.concat(" ",e,'="',this.getGlobalRef(),'.handleKeyDown(event, this)"',' onkeyup="',this.getGlobalRef(),'.handleKeyUp(event, this)"')
};
Checkbox_XFormItem=function(){};
XFormItemFactory.createItemType("_CHECKBOX_","checkbox",Checkbox_XFormItem,XFormItem);
Wiz_Checkbox_XFormItem=function(){};
XFormItemFactory.createItemType("_WIZ_CHECKBOX_","wiz_checkbox",Wiz_Checkbox_XFormItem,Checkbox_XFormItem);
if(appNewUI){
Wiz_Checkbox_XFormItem.prototype.labelLocation=_RIGHT_;
Wiz_Checkbox_XFormItem.prototype.align=_RIGHT_;
Wiz_Checkbox_XFormItem.prototype.subLabel=""
}
Checkbox_XFormItem.prototype._inputType="checkbox";
Checkbox_XFormItem.prototype.elementChangeHandler="onclick";
Checkbox_XFormItem.prototype.labelLocation=(appNewUI?_LEFT_:_RIGHT_);
Checkbox_XFormItem.prototype.cssClass="xform_checkbox";
Checkbox_XFormItem.prototype.labelCssClass="xform_checkbox";
Checkbox_XFormItem.prototype.align=(appNewUI?_LEFT_:_RIGHT_);
Checkbox_XFormItem.prototype.trueValue=_UNDEFINED_;
Checkbox_XFormItem.prototype.falseValue=_UNDEFINED_;
Checkbox_XFormItem.prototype.focusable=true;
Checkbox_XFormItem.prototype.visibilityChecks=[XFormItem.prototype.hasReadPermission];
Checkbox_XFormItem.prototype.enableDisableChecks=[XFormItem.prototype.hasWritePermission];
Checkbox_XFormItem.prototype.nowrap=false;
Checkbox_XFormItem.prototype.labelWrap=true;
Checkbox_XFormItem.prototype.outputHTML=function(e,a){
var t="";
if(this.getInstanceValue()==this.getTrueValue()){
t=" CHECKED"
}
e.append("<input autocomplete='off' id=\"",this.getId(),'" type="',this._inputType,'"',this.getChangeHandlerHTML(),this.getFocusHandlerHTML(),t,">")
};
Checkbox_XFormItem.prototype.getTrueValue=function(){
var e=this.getInheritedProperty("trueValue");
if(e==null){
e=true
}
return e
};
Checkbox_XFormItem.prototype.getFalseValue=function(){
var e=this.getInheritedProperty("falseValue");
if(e==null){
e=false
}
return e
};
Checkbox_XFormItem.prototype.updateElement=function(e){
e=(e==this.getTrueValue());
this.getElement().checked=e
};
Checkbox_XFormItem.prototype.getElementValueGetterHTML=function(){
var e=this.getTrueValue();
if(e!==_UNDEFINED_){
if(typeof e=="string"){
e="'"+e+"'"
}
var t=this.getFalseValue();
if(typeof t=="string"){
t="'"+t+"'"
}
if(e==null){
e=true
}
if(t==null){
t=false
}
return AjxBuffer.concat("var value = (this.checked ? ",e," : ",t,");")
}else{
return"var value = '"+this.getValue()+"';"
}};
if(appNewUI){
Checkbox_XFormItem.prototype.outputContainerTDEndHTML=function(e){
var t=this.getInheritedProperty("subLabel");
if(AjxUtil.isEmpty(t)){
t=""
}else{
t=" "+t
}
e.append(t+'</td id="',this.getId(),'___container">')
}
}
Checkbox_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementDisabledProperty;
Radio_XFormItem=function(){};
XFormItemFactory.createItemType("_RADIO_","radio",Radio_XFormItem,Checkbox_XFormItem);
Radio_XFormItem.prototype._inputType="radio";
Radio_XFormItem.prototype.focusable=true;
Radio_XFormItem.prototype.groupname=null;
Radio_XFormItem.prototype.subLabel=(appNewUI?"":null);
Radio_XFormItem.prototype.align=_RIGHT_;
Radio_XFormItem.prototype.labelLocation=_RIGHT_;
Radio_XFormItem.prototype.updateElement=function(e){
this.getElement().checked=(this.getValue()==e)
};
Radio_XFormItem.prototype.outputHTML=function(t,o){
var a="";
if(this.getInstanceValue()==this.getTrueValue()){
a=" CHECKED"
}
t.append("<input autocomplete='off' id=\"",this.getId(),'" type="',this._inputType,'"',this.getChangeHandlerHTML(),this.getFocusHandlerHTML(),a);
var e=this.getInheritedProperty("groupname");
if(e){
t.append(" name='",e,"'")
}
t.append(">")
};
Radio_Label_XFormItem=function(){};
XFormItemFactory.createItemType("_RADIO_LABEL_","radio_label",Radio_Label_XFormItem,Radio_XFormItem);
Radio_Label_XFormItem.prototype._inputType="radio";
Radio_Label_XFormItem.prototype.focusable=true;
Radio_Label_XFormItem.prototype.groupname=null;
Radio_XFormItem.prototype.elementChanged=function(a,t,e){
if(a==true){
this.getForm().itemChanged(this.getId(),this.getValue(),e)
}};
Radio_XFormItem.prototype.updateElement=function(o){
this.getElement().checked=(this.getValue()==o);
var t=XFG.getEl((this.getId()+"___labelValue"));
if(t){
var a=this.getInheritedProperty("labelRef");
if(a==null){
return
}
var e=this.getInstanceValue(a);
t.innerHTML=e
}};
Radio_Label_XFormItem.prototype.outputHTML=function(t,o){
var a="";
if(this.getInstanceValue()==this.getTrueValue()){
a=" CHECKED"
}
t.append("<input autocomplete='off' id=\"",this.getId(),'" type="',this._inputType,'"',this.getChangeHandlerHTML(),this.getFocusHandlerHTML(),a);
var e=this.getInheritedProperty("groupname");
if(e){
t.append(" name='",e,"'")
}
t.append(">")
};
Radio_Label_XFormItem.prototype.outputLabelCellHTML=function(o,r,e){
var a=this.getInheritedProperty("labelRef");
if(a==null){
return
}
var t=this.getInstanceValue(a);
if(t==null){
return
}
if(t==""){
t="&nbsp;"
}
var s=this.getInheritedProperty("labelValue");
if(e==_INLINE_){
var n=this.getLabelCssStyle();
if(n==null){
n=""
}
n="position:relative;left:10;top:5;text-align:left;background-color:#eeeeee;margin-left:5px;margin-right:5px;"+n;
o.append('<label id="',this.getId(),'___labelValue"',this.getLabelCssString(null,n),' FOR="',this.getId(),'">',t,"</label>")
}else{
o.append("<td ",this.getLabelCssString(),(r>1?" rowspan="+r:""),">",'<label id="',this.getId(),'___labelValue"',' FOR="',this.getId(),'">',t,"</label>");
o.append("</td>")
}};
Button_XFormItem=function(){};
XFormItemFactory.createItemType("_BUTTON_","button",Button_XFormItem,XFormItem);
XFormItemFactory.registerItemType("_TRIGGER_","trigger",Button_XFormItem);
Button_XFormItem.prototype.forceUpdate=false;
Button_XFormItem.prototype.elementChangeHandler="onclick";
Button_XFormItem.prototype.labelLocation=_NONE_;
Button_XFormItem.prototype.relevantBehavior=_DISABLE_;
Button_XFormItem.prototype.cssClass="xform_button";
Button_XFormItem.prototype.focusable=true;
Button_XFormItem.prototype.outputHTML=function(e,t){
e.append('<button id="',this.getId(),'"',this.getCssString(),"\r  ",this.getOnActivateHandlerHTML(),"\r  ",this.getFocusHandlerHTML(),"\r",">",this.getLabel(),"</button>")
};
Button_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementDisabledProperty;
Submit_XFormItem=function(){};
XFormItemFactory.createItemType("_SUBMIT_","submit",Submit_XFormItem,Button_XFormItem);
Submit_XFormItem.prototype.outputHTML=function(e,t){
e.append('<input id="',this.getId(),'" type="submit"',this.getCssString(),this.getChangeHandlerHTML(),this.getFocusHandlerHTML(),' value="',this.getLabel(),">")
};
Anchor_XFormItem=function(){};
XFormItemFactory.createItemType("_ANCHOR_","anchor",Anchor_XFormItem,XFormItem);
Anchor_XFormItem.prototype.writeElementDiv=true;
Anchor_XFormItem.prototype.forceUpdate=true;
Anchor_XFormItem.prototype.cssClass="xform_anchor";
Anchor_XFormItem.prototype.elementChangeHandler="onclick";
Anchor_XFormItem.prototype.href="javascript:;";
Anchor_XFormItem.prototype.showInNewWindow=true;
Anchor_XFormItem.prototype.focusable=true;
Anchor_XFormItem.prototype.getHref=function(){
return this.getInheritedProperty("href")
};
Anchor_XFormItem.prototype.getAnchorTag=function(e,t){
if(e==null){
e=this.getHref()
}
if(t==null){
t=this.getLabel()
}
var a=this.getShowInNewWindow();
return AjxBuffer.concat("<a href=",e,this.getOnActivateHandlerHTML(),(a?' target="_blank"':""),">",t,"</a>")
};
Anchor_XFormItem.prototype.outputHTML=function(e){
e.append(this.getAnchorTag())
};
Anchor_XFormItem.prototype.updateElement=function(e){
this.getElement().innerHTML=this.getAnchorTag(e)
};
Anchor_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementEnabledCssClass;
Data_Anchor_XFormItem=function(){};
XFormItemFactory.createItemType("_DATA_ANCHOR_","data_anchor",Data_Anchor_XFormItem,Anchor_XFormItem);
Data_Anchor_XFormItem.prototype.updateElement=function(e){
this.getElement().innerHTML=this.getAnchorTag(null,e)
};
Url_XFormItem=function(){};
XFormItemFactory.createItemType("_URL_","url",Url_XFormItem,Anchor_XFormItem);
Url_XFormItem.prototype.updateElement=function(e){
this.getElement().innerHTML=this.getAnchorTag(e,e)
};
DataUrl_XFormItem=function(){};
XFormItemFactory.createItemType("_DATA_URL_","rata_url",DataUrl_XFormItem,Anchor_XFormItem);
Url_XFormItem.prototype.updateElement=function(e){
this.getElement().innerHTML=this.getAnchorTag(e,null)
};
Mailto_XFormItem=function(){};
XFormItemFactory.createItemType("_MAILTO_","mailto",Mailto_XFormItem,Anchor_XFormItem);
Mailto_XFormItem.prototype.updateElement=function(e){
this.getElement().innerHTML=this.getAnchorTag("mailto:"+e,e)
};
Image_XFormItem=function(){};
XFormItemFactory.createItemType("_IMAGE_","image",Image_XFormItem,XFormItem);
Image_XFormItem.prototype.forceUpdate=true;
Image_XFormItem.prototype.src=_UNDEFINED_;
Image_XFormItem.prototype.srcPath=_UNDEFINED_;
Image_XFormItem.prototype.writeElementDiv=true;
Image_XFormItem.prototype.updateElement=function(a){
if(a==null){
a=this.getSrc()
}
a=this.getChoiceLabel(a);
if(a==null||a==""){
var e=""
}else{
var t=this.getSrcPath();
if(t!=null){
a=t+a
}
var e=AjxBuffer.concat('<img id="',this.getId(),'" border=0 ',this.getCssString(),' src="',a,'"',">")
}
this.getElement().innerHTML=e
};
Image_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementEnabledCssClass;
Ajx_Image_XFormItem=function(){};
XFormItemFactory.createItemType("_AJX_IMAGE_","ajx_image",Ajx_Image_XFormItem,XFormItem);
Ajx_Image_XFormItem.prototype.forceUpdate=true;
Ajx_Image_XFormItem.prototype.src=_UNDEFINED_;
Ajx_Image_XFormItem.prototype.srcPath=_UNDEFINED_;
Ajx_Image_XFormItem.prototype.writeElementDiv=false;
Ajx_Image_XFormItem.prototype.updateElement=function(o){
if(o==null){
o=this.getSrc()
}
o=this.getChoiceLabel(o);
var e;
if(o==null||o==""){
e=""
}else{
var a=this.getSrcPath();
if(a!=null){
o=a+o
}
var t=this.getCssStyle();
e=AjxImg.getImageHtml(o,"position:relative;"+(t?t:""))
}
if(this.getContainer()){
this.getContainer().innerHTML=e
}};
Dwt_Image_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_IMAGE_","dwt_image",Dwt_Image_XFormItem,XFormItem);
Dwt_Image_XFormItem.prototype.forceUpdate=true;
Dwt_Image_XFormItem.prototype.src=_UNDEFINED_;
Dwt_Image_XFormItem.prototype.srcPath=_UNDEFINED_;
Dwt_Image_XFormItem.prototype.writeElementDiv=false;
Dwt_Image_XFormItem.prototype.updateElement=function(n){
if(n==null){
n=this.getSrc()
}
n=this.getChoiceLabel(n);
var e;
if(n==null||n==""){
e=""
}else{
var a=this.getSrcPath();
if(a!=null){
n=a+n
}
var t=this.getCssStyle();
t=t||"";
var o="style='position:relative;"+t+"'";
if(n){
e=["<div class='",n,"' ",o,this.getClickHandlerHTML()," ></div>"].join("")
}else{
e=["<div ",o,this.getClickHandlerHTML()," ></div>"].join("")
}}
this.getContainer().innerHTML=e
};
Select1_XFormItem=function(){};
XFormItemFactory.createItemType("_SELECT1_","select1",Select1_XFormItem,XFormItem);
Select1_XFormItem.prototype.multiple=false;
Select1_XFormItem.prototype.alwaysUpdateChoices=false;
Select1_XFormItem.prototype.focusable=true;
Select1_XFormItem.prototype.cssClass="xform_select1";
Select1_XFormItem.prototype.containerCssClass="xform_select_container";
Select1_XFormItem.prototype.visibilityChecks=[XFormItem.prototype.hasReadPermission];
Select1_XFormItem.prototype.enableDisableChecks=[XFormItem.prototype.hasWritePermission];
Select1_XFormItem.prototype.initFormItem=function(){
var t=this.getChoices();
if(t==null||t.constructor!=XFormChoices){
return
}
var e=new AjxListener(this,this.dirtyDisplay);
t.addListener(DwtEvent.XFORMS_CHOICES_CHANGED,e)
};
Select1_XFormItem.prototype.outputHTML=function(e,t){
e.append('<select id="',this.getId(),'" ',this.getCssString(),(this.getMultiple()?"multiple ":""),this.getChangeHandlerHTML(),this.getFocusHandlerHTML(),">",this.getChoicesHTML(),"</select>");
this.cleanChoiceDisplay()
};
Select1_XFormItem.prototype.getElementValueGetterHTML=function(){
return"var value = XFormItem.getValueFromHTMLSelect(this);"
};
Select1_XFormItem.prototype.setChoices=function(e){
this.choices=e;
this.dirtyDisplay();
this.updateChoicesHTML()
};
Select1_XFormItem.prototype.dirtyDisplay=function(){
XFormItem.prototype.dirtyDisplay.call(this);
this._choiceDisplayIsDirty=true;
delete this.$normalizedChoices
};
Select1_XFormItem.prototype.updateElement=function(e){
if(this.choicesAreDirty()){
this.updateChoicesHTML()
}
this.updateValueInHTMLSelect1(e,this.getElement(),this.getSelectionIsOpen())
};
Select1_XFormItem.prototype.cleanChoiceDisplay=function(){
this._choiceDisplayIsDirty=false
};
Select1_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementDisabledProperty;
Select_XFormItem=function(){};
XFormItemFactory.createItemType("_SELECT_","select",Select_XFormItem,Select1_XFormItem);
Select_XFormItem.prototype.multiple=true;
Select_XFormItem.prototype.selection=_OPEN_;
Select_XFormItem.prototype.focusable=true;
Select_XFormItem.prototype.containerCssClass="xform_select_container";
Select_XFormItem.prototype.updateElement=function(e){
if(this.choicesAreDirty()){
this.updateChoicesHTML()
}
this.updateValueInHTMLSelect(e,this.getElement(),this.getSelectionIsOpen())
};
Spacer_XFormItem=function(){};
XFormItemFactory.createItemType("_SPACER_","spacer",Spacer_XFormItem,XFormItem);
Spacer_XFormItem.prototype.forceUpdate=false;
Spacer_XFormItem.prototype.labelLocation=_NONE_;
Spacer_XFormItem.prototype.width=1;
Spacer_XFormItem.prototype.height=10;
Spacer_XFormItem.prototype.cssStyle="font-size:1px;overflow:hidden;";
Spacer_XFormItem.prototype.colSpan="*";
Spacer_XFormItem.prototype.focusable=false;
Spacer_XFormItem.prototype.outputHTML=function(e,t){
e.append("<div id=",this.getId(),this.getCssString(),"></div>")
};
Spacer_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementEnabledCssClass;
Cell_Spacer_XFormItem=function(){};
XFormItemFactory.createItemType("_CELL_SPACER_","cell_spacer",Cell_Spacer_XFormItem,Spacer_XFormItem);
XFormItemFactory.registerItemType("_CELLSPACER_","cell_spacer",Cell_Spacer_XFormItem);
Cell_Spacer_XFormItem.prototype.width=10;
Cell_Spacer_XFormItem.prototype.height=10;
Cell_Spacer_XFormItem.prototype.colSpan=1;
Cell_Spacer_XFormItem.prototype.focusable=false;
Separator_XFormItem=function(){};
XFormItemFactory.createItemType("_SEPARATOR_","separator",Separator_XFormItem,XFormItem);
Separator_XFormItem.prototype.cssClass="xform_separator";
Separator_XFormItem.prototype.colSpan="*";
Separator_XFormItem.prototype.align=_CENTER_;
Separator_XFormItem.prototype.valign=_CENTER_;
Separator_XFormItem.prototype.height=10;
Separator_XFormItem.prototype.focusable=false;
Separator_XFormItem.prototype.outputHTML=function(t,a){
var e=(this.getCssClass()||"");
if(e!=""&&e!=null){
e=' class="'+e+'"'
}
t.append("<table width=100% cellspacing=0 cellpadding=0>","<tr><td height=",this.getHeight(),">","<div ",e,"></div>","</td></tr></table>")
};
Separator_XFormItem.prototype.setElementEnabled=XFormItem.prototype.setElementEnabledCssClass;
Group_XFormItem=function(){
this.tabIdOrder=[]
};
XFormItemFactory.createItemType("_GROUP_","group",Group_XFormItem,XFormItem);
Group_XFormItem.prototype.forceUpdate=false;
Group_XFormItem.prototype.numCols=2;
Group_XFormItem.prototype.useParentTable=false;
Group_XFormItem.prototype.focusable=false;
Group_XFormItem.prototype.cellspacing=0;
Group_XFormItem.prototype.border=0;
Group_XFormItem.prototype.cellpadding=0;
if(appNewUI){
Group_XFormItem.prototype.tableCssClass="grid_xform_table"
}
Group_XFormItem.prototype.initFormItem=function(){
XFormItem.prototype.initFormItem.call(this);
if(this.getInheritedProperty("isTabGroup")){
var e=this.getForm();
e.tabIdOrder[this.getId()]=this.tabIdOrder;
e.addTabGroup(this)
}};
Group_XFormItem.prototype.outputHTML=function(e,t){
this.getForm().outputItemList(this.getItems(),this,e,this.getNumCols(),t)
};
Group_XFormItem.prototype.clearError=function(){
var a=this.getErrorLocation();
if(a==_PARENT_||a==_INHERIT_){
this.getParentItem().clearError();
return
}
this.getForm().removeErrorItem(this);
if(this.items){
var t=this.items.length;
for(var e=0;
e<t;
e++){
if(this.items[e].getErrorLocation()!=_PARENT_&&this.items[e].getErrorLocation()!=_INHERIT_){
this.items[e].clearError()
}}}
this.__errorState=XFormItem.ERROR_STATE_VALID;
this.removeErrorContainer()
};
Group_XFormItem.prototype.setElementEnabled=function(e){};
Group_XFormItem.prototype.updateVisibility=function(){
var isVisible=true;
var parentItem=this.getParentItem();
if(parentItem){
isVisible=this.getParentItem().getIsVisible()
}
if(isVisible){
var myVisibilityChecks=this.getInheritedProperty("visibilityChecks");
if(myVisibilityChecks&&myVisibilityChecks instanceof Array){
var cnt=myVisibilityChecks.length;
for(var i=0;
i<cnt;
i++){
if(myVisibilityChecks[i]!=null){
if(typeof(myVisibilityChecks[i])=="function"){
isVisible=myVisibilityChecks[i].call(this);
if(!isVisible){
break
}}else{
if(myVisibilityChecks[i] instanceof Array){
var func=myVisibilityChecks[i].shift();
isVisible=func.apply(this,myVisibilityChecks[i]);
myVisibilityChecks[i].unshift(func);
if(!isVisible){
break
}}else{
if(typeof(myVisibilityChecks[i])=="string"){
var instance=this.getInstance();
isVisible=eval(myVisibilityChecks[i]);
if(!isVisible){
break
}}}}}}}}
var reRunRefresh=false;
if(isVisible){
if(this.deferred){
reRunRefresh=true
}
this.show()
}else{
this.hide()
}
if(isVisible){
for(var itemId in this.activeChildren){
if(this.activeChildren[itemId]===true){
var item=this.getForm().getItemById(itemId);
if(item&&this.getInstance()){
var updateMethod=item.getUpdateVisibilityMethod();
if(updateMethod){
updateMethod.call(item)
}}}}}
if(reRunRefresh){
this.updateEnabledDisabled();
this.updateElement()
}};
Step_Choices_XFormItem=function(){};
XFormItemFactory.createItemType("_STEPCHOICE_","stepchoices",Step_Choices_XFormItem,Group_XFormItem);
Step_Choices_XFormItem.prototype.numCols=1;
Step_Choices_XFormItem.prototype.labelVisibility=_UNDEFINED_;
Step_Choices_XFormItem.prototype.labelUpdateMethod=function(a){
var t=this.getElement();
var e=this.getInheritedProperty("sourceValue");
if(e<a){
t.className="AdminOutputTabClick"
}else{
if(e==a){
t.className="AdminOutputTabSelect"
}else{
t.className="AdminOutputTab"
}}};
Step_Choices_XFormItem.prototype.getLabelUpdateMethod=function(){
return this.cacheInheritedMethod("labelUpdateMethod","$labelUpdateMethod","newValue")
};
Step_Choices_XFormItem.prototype.labelClickMethod=function(t){
var e=this.getInheritedProperty("sourceValue");
var a=this.getInstanceValue();
if(e<a){
this.setInstanceValue(e)
}};
Step_Choices_XFormItem.prototype.getLabelClickMethod=function(){
return this.cacheInheritedMethod("labelClickMethod","$labelClickMethod","event")
};
Step_Choices_XFormItem.prototype.initFormItem=function(){
var h=this.getNormalizedChoices();
if(!h){
return
}
XFormItem.prototype.initFormItem.call(this);
this.signUpForEvents();
var r=h.labels;
var e=h.values;
this.items=[];
var o;
var a=this.getLabelUpdateMethod();
var s=this.getInheritedProperty("labelVisibility");
var n=this.getLabelClickMethod();
for(var t=0;
t<r.length;
t++){
if(s&&s[e[t]]){
o={
ref:".",type:_OUTPUT_,value:r[t],sourceValue:e[t],updateElement:a,visibilityChecks:s[e[t]].checks,visibilityChangeEventSources:s[e[t]].sources}
}else{
o={
ref:".",type:_OUTPUT_,value:r[t],sourceValue:e[t],updateElement:a}
}
if(n){
o.onClick=n
}
this.items.push(o)
}};
HomeGroup_XFormItem=function(){
this.expanded=true
};
XFormItemFactory.createItemType("_HOMEGROUP_","homegroup",HomeGroup_XFormItem,Group_XFormItem);
HomeGroup_XFormItem.prototype.headCss="homeGroupHeader";
HomeGroup_XFormItem.prototype.bodyCss="homeGroupBody";
HomeGroup_XFormItem.prototype.numCols=1;
HomeGroup_XFormItem.prototype.width="90%";
HomeGroup_XFormItem.prototype.cssStyle="margin-left:5%; margin-top: 10px;";
HomeGroup_XFormItem.prototype.headerLabel="Home Group";
HomeGroup_XFormItem.prototype.expandedImg="ImgNodeExpanded";
HomeGroup_XFormItem.prototype.collapsedImg="ImgNodeCollapsed";
HomeGroup_XFormItem.prototype.initializeItems=function(){
this.items=[];
this.items[0]=this.getHeaderItems();
this.items[1]=this.getContentItems();
var a=this.items[1].items;
var o=this.getInheritedProperty("contentChoices");
if(!o[0].label){
this.items[1].numCols=1
}
for(var t=0;
t<o.length;
t++){
var e={
type:_OUTPUT_,label:o[t].label,value:o[t].value,containerCssStyle:"color:blue;cursor:pointer"};
if(o[t].onClick){
e.onClick=o[t].onClick
}
a.push(e)
}
Group_XFormItem.prototype.initializeItems.call(this)
};
HomeGroup_XFormItem.prototype.onClick=function(a){
var t=this.getParentItem().getParentItem();
var e=t.items[1];
if(t.expanded){
t.expanded=false;
this.updateElement(t.collapsedImg);
e.hide()
}else{
t.expanded=true;
this.updateElement(t.expandedImg);
e.show()
}};
HomeGroup_XFormItem.prototype.getHeaderItems=function(){
var a=this.getInheritedProperty("headerLabel");
var t=this.getInheritedProperty("headCss");
var e={
type:_COMPOSITE_,numCols:3,width:"100%",colSizes:["20px","100%","20px"],items:[{
type:_DWT_IMAGE_,value:this.expandedImg,cssStyle:"position:static;",onClick:this.onClick}
,{
type:_OUTPUT_,value:a}
,{
type:_AJX_IMAGE_,value:"BorderNone"}
],cssClass:t};
return e
};
HomeGroup_XFormItem.prototype.getContentItems=function(){
var t=this.getInheritedProperty("bodyCss");
var e={
type:_GROUP_,items:[],cssClass:t};
e.items=[];
return e
};
CollapsedGroup_XFormItem=function(){
this.expanded=true
};
XFormItemFactory.createItemType("_COLLAPSED_GROUP_","collapsedgroup",CollapsedGroup_XFormItem,Group_XFormItem);
CollapsedGroup_XFormItem.prototype.headCss="gridGroupHeader";
CollapsedGroup_XFormItem.prototype.contentCss="gridGroupContent";
CollapsedGroup_XFormItem.prototype.gridLabelCss="gridGroupBodyLabel";
CollapsedGroup_XFormItem.prototype.colSizes="100%";
CollapsedGroup_XFormItem.prototype.numCols=1;
CollapsedGroup_XFormItem.prototype.width="100%";
CollapsedGroup_XFormItem.prototype.defaultDisplay=true;
CollapsedGroup_XFormItem.prototype.displayLabelItem=false;
CollapsedGroup_XFormItem.prototype.cssClass="grid_group_container";
CollapsedGroup_XFormItem.prototype.cssStyle="margin-top: 10px;";
CollapsedGroup_XFormItem.prototype.headerLabel=AjxMsg.collapsedGroup;
CollapsedGroup_XFormItem.prototype.expandedImg="ImgNodeExpanded";
CollapsedGroup_XFormItem.prototype.collapsedImg="ImgNodeCollapsed";
CollapsedGroup_XFormItem.prototype.contentTableCssClass="grid_table";
CollapsedGroup_XFormItem.prototype.containerCssClass="grid_table_cell_sheet";
CollapsedGroup_XFormItem.prototype.initializeItems=function(){
var n=this.getInheritedProperty("gridLabelCss");
var o=this.getItems();
this.items=[];
if(this.__attributes.label){
this.headerLabel=this.__attributes.label
}
this.items[0]=this.getHeaderItems();
this.items[1]=this.getContentItems();
if(!this.items[1]||this.items[1].items.length==0){
if(o){
for(var e=0;
e<o.length;
e++){
if(o[e].type=="radio"){
continue
}
if(o[e].label||o[e].txtBoxLabel){
if(o[e].type){
var a=this.getForm();
var t=XFormItemFactory.getItemTypeConstructor(o[e].type,a);
if(t.prototype.labelCssClass){
o[e].labelCssClass=t.prototype.labelCssClass+" "+n
}else{
o[e].labelCssClass=n
}}else{
o[e].labelCssClass=n
}}}
this.items[1].items=o
}}
Group_XFormItem.prototype.initializeItems.call(this)
};
CollapsedGroup_XFormItem.prototype.onClick=function(n){
var e=this.getParentItem();
var t=e.getParentItem();
var o=e.items[2];
var a=t.items[1];
var s=t.getInheritedProperty("displayLabelItem");
if(t.expanded){
t.expanded=false;
this.updateElement(t.collapsedImg);
a.hide();
if(s){
o.show()
}}else{
t.expanded=true;
this.updateElement(t.expandedImg);
a.show();
o.hide()
}};
CollapsedGroup_XFormItem.prototype.getHeaderItems=function(){
var a=this.getInheritedProperty("headerLabel");
var n=this.getInheritedProperty("headerLabelWidth");
var t=this.getInheritedProperty("headCss");
var o=this.getInheritedProperty("headerItems")||[];
var e={
type:_COMPOSITE_,numCols:3,width:"100%",colSizes:["20px",n||"100%","100%"],colSpan:"*",items:[{
type:_DWT_IMAGE_,value:this.expandedImg,cssStyle:"position:static;",onClick:this.onClick}
,{
type:_OUTPUT_,value:a}
,{
type:_GROUP_,items:o}
],cssClass:t};
return e
};
CollapsedGroup_XFormItem.prototype.getContentItems=function(){
var s=this.getInheritedProperty("colSizes");
var e=this.getInheritedProperty("numCols");
var r=this.getInheritedProperty("contentCss");
var n=this.getInheritedProperty("contentTableCssClass");
var o={
type:_GROUP_,items:[],colSpan:"*",colSizes:s,numCols:e,width:"100%",cssClass:r,tableCssClass:n};
var a=this.getInheritedProperty("ref");
if(a){
o.ref=a
}
var t=this.getInheritedProperty("contentItems");
if(t){
o.items=t
}
return o
};
CollapsedGroup_XFormItem.prototype.updateVisibility=function(){
XFormItem.prototype.updateVisibility.call(this);
var e=this.getInheritedProperty("defaultDisplay");
var t=this.getInheritedProperty("displayLabelItem");
if(e){
this.items[0].items[2].hide();
this.items[1].show();
this.items[0].items[0].value=this.expandedImg;
this.expanded=true
}else{
if(t){
this.items[0].items[2].show()
}else{
this.items[0].items[2].hide()
}
this.items[1].hide();
this.items[0].items[0].__attributes.value=this.collapsedImg;
this.expanded=false
}};
CollapsedGroup_XFormItem.prototype.getLabel=function(){
return null
};
Grouper_XFormItem=function(){};
XFormItemFactory.createItemType("_GROUPER_","grouper",Grouper_XFormItem,Group_XFormItem);
Grouper_XFormItem.prototype.labelCssClass="GrouperLabel";
Grouper_XFormItem.prototype.labelLocation=_INLINE_;
Grouper_XFormItem.prototype.borderCssClass="GrouperBorder";
Grouper_XFormItem.prototype.insetCssClass="GrouperInset";
Grouper_XFormItem.prototype.getBorderCssClass=function(){
return this.getInheritedProperty("borderCssClass")
};
Grouper_XFormItem.prototype.getInsetCssClass=function(){
return this.getInheritedProperty("insetCssClass")
};
Grouper_XFormItem.prototype.outputHTMLStart=function(e,t){
e.append("<div class=",this.getBorderCssClass(),">","<span ",this.getLabelCssString(),">",this.getLabel(),"</span>","<div class=",this.getInsetCssClass(),">")
};
Grouper_XFormItem.prototype.outputHTMLEnd=function(e,t){
e.append("</div></div>")
};
RadioGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_RADIO_GROUPER_","radiogrouper",RadioGrouper_XFormItem,Grouper_XFormItem);
RadioGrouper_XFormItem.prototype.labelCssClass="xform_radio_grouper_label";
RadioGrouper_XFormItem.prototype.borderCssClass="xform_radio_grouper_border";
RadioGrouper_XFormItem.prototype.insetCssClass="xform_radio_grouper_inset";
RadioGrouper_XFormItem.prototype.width="100%";
CollapsableRadioGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_COLLAPSABLE_RADIO_GROUPER_","collapsableradiogrouper",CollapsableRadioGrouper_XFormItem,RadioGrouper_XFormItem);
CollapsableRadioGrouper_XFormItem.prototype.getLabel=function(){
var e=XFormItem.prototype.getLabel.apply(this);
return"<nobr><span class=xform_button style='font-size:9px;color:black;'>&nbsp;&ndash;&nbsp;</span>&nbsp;"+e+"</nobr>"
};
Case_XFormItem=function(){
Group_XFormItem.call(this)
};
XFormItemFactory.createItemType("_CASE_","case",Case_XFormItem,Group_XFormItem);
Case_XFormItem.prototype.labelLocation=_NONE_;
Case_XFormItem.prototype.useParentTable=false;
Case_XFormItem.prototype.width="100%";
Case_XFormItem.prototype.focusable=false;
Case_XFormItem.prototype.deferred=true;
Case_XFormItem.prototype.cellspacing=0;
Case_XFormItem.prototype.cellpadding=0;
Case_XFormItem.prototype.cssClass="XFormCase";
Case_XFormItem.prototype.isTabGroup=true;
Case_XFormItem.prototype.caseVarRef="currentStep";
Case_XFormItem.prototype.visibilityChangeEventSources=[Case_XFormItem.prototype.caseVarRef];
Case_XFormItem.prototype.initFormItem=function(){
XFormItem.prototype.initFormItem.call(this);
if(this.getInheritedProperty("isTabGroup")){
var e=this.getForm();
e.tabIdOrder[this.getId()]=this.tabIdOrder;
e.addTabGroup(this,"caseKey")
}};
Case_XFormItem.prototype.outputHTML=function(e,t){
this.deferred=this.getInheritedProperty("deferred");
if(this.deferred){
this.getForm().outputItemList([],this,e,this.getNumCols(),0,true,false)
}else{
this.getForm().outputItemList(this.getItems(),this,e,this.getNumCols(),t)
}};
Case_XFormItem.prototype._outputHTML=function(){
var a=this.getForm();
var l=this.getElement();
if(!l){
return
}
var e=this.getId();
if(this.cacheInheritedMethod("getCustomHeight","$getCustomHeight")){
var f=this.cacheInheritedMethod("getCustomHeight","$getCustomHeight").call(this);
var o=this.cacheInheritedMethod("getCustomWidth","$getCustomWidth").call(this);
Dwt.setSize(l,o,f);
var t=(a.parent instanceof DwtControl)?a.parent:DwtControl.fromElementId(window._dwtShellId);
if(t){
if(this.cacheInheritedMethod("resizeHdlr","$resizeHdlr")){
t.addControlListener(new AjxListener(this,this.cacheInheritedMethod("resizeHdlr","$resizeHdlr")))
}}}
if(this.cacheInheritedMethod("getCustomPaddingStyle","$getCustomPaddingStyle")){
var c=this.cacheInheritedMethod("getCustomPaddingStyle","$getCustomPaddingStyle").call(this);
if(c){
l.style.cssText+=";"+c
}}
if(AjxEnv.isIE){
var s=this.createElement("temp",null,"div","");
s.display="none"
}
var d=new AjxBuffer();
if(this.outputHTMLStart){
this.outputHTMLStart(d,0)
}
var m=(this.getUseParentTable()==false);
if(m){
var n=this.getColSizes();
var h=this.getInheritedProperty("cellspacing");
var u=this.getInheritedProperty("cellpadding");
d.append("<table cellspacing=",h," cellpadding=",u," ",(XForm._showBorder?"border=1":"border=0"),' id="',this.getId(),'_table" ',this.getTableCssString(),">");
if(n!=null){
d.append(" <colgroup>");
for(var r=0;
r<n.length;
r++){
var p=n[r];
if(p<1){
p=p*100+"%"
}
d.append("<col width=",p,">")
}
d.append("</colgroup>")
}
d.append("<tbody>")
}
a.outputItemList(this.getItems(),this,d,this.getNumCols(),0,true,true);
d.append("</table>");
l.innerHTML=d.toString();
this.deferred=false
};
Case_XFormItem.prototype.hide=function(e){
XFormItem.prototype.hide.call(this,e);
this.hideElement(this.getElement(),e)
};
Case_XFormItem.prototype.show=function(e){
XFormItem.prototype.show.call(this,e);
this.showElement(this.getElement(),e)
};
Case_XFormItem.prototype.isCurrentTab=function(){
var t=false;
var e=this.getInheritedProperty("caseKey");
if(!AjxUtil.isEmpty(e)){
var a=this.getInheritedProperty("caseVarRef");
var o=this.getInstanceValue(a);
t=(o==e)
}
return t
};
Case_XFormItem.prototype.visibilityChecks=[Case_XFormItem.prototype.isCurrentTab];
TopGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_TOP_GROUPER_","top_grouper",TopGrouper_XFormItem,RadioGrouper_XFormItem);
TopGrouper_XFormItem.prototype.borderCssClass="TopGrouperBorder";
TopGrouper_XFormItem.prototype.labelCssClass="GrouperLabel";
TopGrouper_XFormItem.prototype.labelLocation=_INLINE_;
TopGrouper_XFormItem.prototype.insetCssClass="GrouperInset";
TopGrouper_XFormItem.prototype.outputHTMLStart=function(e,t){
e.append("<div class=",this.getBorderCssClass(),">","<div ",this.getLabelCssString(),">",this.getLabel(),"</div>","<div class=",this.getInsetCssClass(),">")
};
TopGrouper_XFormItem.prototype.outputHTMLEnd=function(e,t){
e.append("</div></div>")
};
if(appNewUI){
XFormItemFactory.createItemType("_TOP_GROUPER_","top_grouper",TopGrouper_XFormItem,CollapsedGroup_XFormItem)
}
BaseTopGrouper_XFormItem=function(){};
XFormItemFactory.createItemType("_BASE_TOP_GROUPER_","base_top_grouper",BaseTopGrouper_XFormItem,RadioGrouper_XFormItem);
BaseTopGrouper_XFormItem.prototype.borderCssClass="TopGrouperBorder";
BaseTopGrouper_XFormItem.prototype.labelCssClass="GrouperLabel";
BaseTopGrouper_XFormItem.prototype.labelLocation=_INLINE_;
BaseTopGrouper_XFormItem.prototype.insetCssClass="GrouperInset";
BaseTopGrouper_XFormItem.prototype.outputHTMLStart=function(e,t){
e.append("<div class=",this.getBorderCssClass(),">","<div ",this.getLabelCssString(),">",this.getLabel(),"</div>","<div class=",this.getInsetCssClass(),">")
};
BaseTopGrouper_XFormItem.prototype.outputHTMLEnd=function(e,t){
e.append("</div></div>")
};
Switch_XFormItem=function(){};
XFormItemFactory.createItemType("_SWITCH_","switch",Switch_XFormItem,Group_XFormItem);
Switch_XFormItem.prototype.labelLocation=_NONE_;
Switch_XFormItem.prototype.colSpan="*";
Switch_XFormItem.prototype.width="100%";
Switch_XFormItem.prototype.numCols=1;
Switch_XFormItem.prototype.outputHTML=function(e){
Switch_XFormItem.outputItemList.call(this.getForm(),this.getItems(),this,e)
};
Switch_XFormItem.prototype.setElementEnabled=function(e){};
Switch_XFormItem.outputItemList=function(l,t,n,a,e,s,r){
if(t.outputHTMLStart){
t.outputHTMLStart(n,e)
}
var y=null;
if(!r){
y=t.getCssString();
if(y!=null&&y!=""){
t.outputElementDivStart(n)
}}
for(var c=0;
c<l.length;
c++){
var g=l[c];
var o=(g.getItems()!=null);
var h=(g.getUseParentTable()!=false);
var f=g.getWriteElementDiv();
var d=g.getOutputHTMLMethod();
if(o&&h){
if(d){
d.call(g,n,e)
}}else{
if(f){
g.outputElementDivStart(n)
}
if(d){
d.call(g,n,0)
}
if(f){
g.outputElementDivEnd(n)
}}
if(t){
t.registerActiveChild(g)
}
g.signUpForEvents();
var m=g.getUpdateElementMethod();
if(m){
var p=g.getRefPath();
if(p){
var u=this.getInstance();
if(u){
m.call(g,g.getInstanceValue())
}}}}
if(y!=null&&y!=""){
t.outputElementDivEnd(n)
}
if(t.outputHTMLEnd){
t.outputHTMLEnd(n,e)
}};
Repeat_XFormItem=function(){
Group_XFormItem.call(this)
};
XFormItemFactory.createItemType("_REPEAT_","repeat",Repeat_XFormItem,Group_XFormItem);
Repeat_XFormItem.prototype.useParentTable=false;
Repeat_XFormItem.prototype.writeElementDiv=true;
Repeat_XFormItem.prototype.numCols=1;
Repeat_XFormItem.prototype.number=1;
Repeat_XFormItem.prototype.showRemoveButton=true;
Repeat_XFormItem.prototype.showAddButton=true;
Repeat_XFormItem.prototype.alwaysShowAddButton=false;
Repeat_XFormItem.prototype.showMoveUpButton=false;
Repeat_XFormItem.prototype.showMoveDownButton=false;
Repeat_XFormItem.prototype.bmolsnr=true;
Repeat_XFormItem.prototype.enableDisableChecks=[XFormItem.prototype.hasWritePermission];
Repeat_XFormItem.prototype.visibilityChecks=[XFormItem.prototype.hasReadPermission];
Repeat_XFormItem.haveAnyRows=function(){
return(this.getParentItem().getInstanceCount()!=0)
};
Repeat_XFormItem.isLastRow=function(){
return((this.getParentItem().getInstanceCount()-1)==this.getParentItem().instanceNum)
};
Repeat_XFormItem.isAddButtonVisible=function(){
return(this.getParentItem().getParentItem().getAlwaysShowAddButton()||Repeat_XFormItem.isLastRow.call(this)||!(Repeat_XFormItem.haveAnyRows.call(this)))
};
Repeat_XFormItem.prototype.getRemoveButton=function(){
if(!this.removeButton){
this.removeButton={
type:_BUTTON_,label:AjxMsg.xformRepeatRemove,cssStyle:"margin-left:20px;",onActivate:function(n){
var o=this.getParentItem().getParentItem();
o.removeRowButtonClicked(this.getParentItem().instanceNum)
}
,visibilityChecks:[Repeat_XFormItem.haveAnyRows],visibilityChangeEventSources:[this.getRef()]};
var e=this.getInheritedProperty("removeButtonLabel");
if(e){
this.removeButton.label=e
}
var t=this.getInheritedProperty("removeButtonWidth");
if(t){
this.removeButton.width=t
}
var a=this.getInheritedProperty("removeButtonCSSStyle");
if(a){
this.removeButton.cssStyle=a
}}
return this.removeButton
};
Repeat_XFormItem.prototype.getAddButton=function(){
if(!this.addButton){
var e=this.getInheritedProperty("showAddOnNextRow");
this.addButton={
ref:".",type:_BUTTON_,label:AjxMsg.xformRepeatAdd,onActivate:function(s){
var n=this.getParentItem().getParentItem();
n.addRowButtonClicked(this.getParentItem().instanceNum)
}
,visibilityChecks:[Repeat_XFormItem.isAddButtonVisible],visibilityChangeEventSources:[this.getRefPath()],forceUpdate:true};
var t=this.getInheritedProperty("addButtonLabel");
if(t){
this.addButton.label=t
}
var a=this.getInheritedProperty("addButtonWidth");
if(a){
this.addButton.width=a
}
var o=this.getInheritedProperty("addButtonCSSStyle");
if(o){
this.addButton.cssStyle=o
}
if(e){
this.addButton.colSpan="*"
}}
return this.addButton
};
Repeat_XFormItem.prototype.moveUpButton={
type:_BUTTON_,label:"^",width:20,cssStyle:"margin-left:20px;",onActivate:function(t){
var e=this.getParentItem().getParentItem();
e.moveUpButtonClicked(this.getParentItem().instanceNum)
}};
Repeat_XFormItem.prototype.moveDownButton={
ref:".",type:_BUTTON_,label:"v",width:20,onActivate:function(t){
var e=this.getParentItem().getParentItem();
e.moveDownButtonClicked(this.getParentItem().instanceNum)
}
,forceUpdate:true};
Repeat_XFormItem.groupVisibilityCheck=function(){
return((this.instanceNum<this.getNumberToShow())||(this.instanceNum<this.getInstanceCount())||(this.instanceNum==0))
};
Repeat_XFormItem.prototype.initializeItems=function(){
var t=this.getItems();
if(t.length==1&&t[0].items){
var o=t[0]
}else{
var o={
ref:this.getRef(),fromRepeat:true,type:_GROUP_,numCols:t.length,items:[].concat(t),visibilityChangeEventSources:[this.getRefPath()],visibilityChecks:[function(){
return(this.instanceNum==0||(this.instanceNum<this.getNumberToShow())||(this.instanceNum<this.getInstanceCount()))
}
]}
}
o.colSpan=1;
if(this.getShowRemoveButton()){
var a=this.getRemoveButton();
o.items[o.items.length]=a;
o.numCols++
}
if(this.getShowAddButton()){
var a=this.getAddButton();
var e=this.getInheritedProperty("showAddOnNextRow");
o.items[o.items.length]=a;
if(e){
o.items[o.items.length]={
type:_SPACER_,colSpan:(o.numCols-1),visibilityChecks:[Repeat_XFormItem.isLastRow],visibilityChangeEventSources:[this.getRefPath()]}
}else{
o.numCols++
}}
if(this.getShowMoveUpButton()){
o.items[o.items.length]=this.getMoveUpButton();
o.numCols++
}
if(this.getShowMoveDownButton()){
o.items[o.items.length]=this.getMoveDownButton();
o.numCols++
}
this.__originalItems=o;
this.items=[]
};
Repeat_XFormItem.prototype.makeRepeatInstance=function(){
var e=this.__originalItems;
var n=this.getNumCols();
var t=[];
for(var o=0;
o<n;
o++){
var a=this.items.length;
e.refPath=this.getRefPath()+"["+a+"]";
groupItem=this.getForm().initItem(e,this);
groupItem.instanceNum=a;
t.push(groupItem);
this.items.push(groupItem)
}
return t
};
Repeat_XFormItem.prototype.outputHTML=function(e,t){
this.makeRepeatInstance();
this.getForm().outputItemList(this.items,this,e,this.getNumCols(),0)
};
Repeat_XFormItem.prototype.updateElement=function(f){
var t=this.getForm();
var a=this.getElement();
if(f==null||f===""){
f=[]
}
var d=Math.max(f.length,this.getNumberToShow());
var g=this.items.length;
var p=this.getId();
if(d>g){
var n=(d-g);
var w=a.getElementsByTagName("table")[0];
var e=a.getElementsByTagName("tbody")[0];
var m;
if(AjxEnv.isIE){
m=this.createElement("temp",null,"div","");
m.display="none"
}
while(this.items.length<d){
var s=this.makeRepeatInstance(this);
var l=new AjxBuffer();
t.outputItemList(s,this,l,this.getNumCols(),0,true);
if(AjxEnv.isIE){
m.innerHTML="<table>"+l.toString()+"</table>";
var h=m.getElementsByTagName("table")[0].rows;
for(var u=0;
u<h.length;
u++){
e.appendChild(h[u])
}}else{
var o=w.insertRow(-1);
o.innerHTML=l
}
var y=s.length;
for(var b=0;
b<y;
b++){
var c=s[b].getUpdateVisibilityMethod();
if(c){
c.call(s[b])
}
c=s[b].getUpdateEnabledDisabledtMethod();
if(c){
c.call(s[b])
}}}}
XFormItem.prototype.updateElement.call(this,f)
};
Repeat_XFormItem.prototype.addRowButtonClicked=function(e){
var t=this.getRefPath();
this.getModel().addRowAfter(this.getInstance(),t,e)
};
Repeat_XFormItem.prototype.removeRowButtonClicked=function(e){
var a=this.getForm();
if(this.getOnRemoveMethod()){
this.getOnRemoveMethod().call(this,e,a)
}else{
var o=this.getRefPath();
this.getModel().removeRow(this.getInstance(),o,e)
}
this.items[e].clearError();
var t=new DwtXFormsEvent(a,this,this.getInstanceValue());
a.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,t)
};
Repeat_XFormItem.prototype.getOnRemoveMethod=function(){
return this.cacheInheritedMethod("onRemove","$onRemove","index,form")
};
Repeat_Grid_XFormItem=function(){};
XFormItemFactory.createItemType("_REPEAT_GRID_","repeat_grid",Repeat_Grid_XFormItem,Repeat_XFormItem);
Repeat_Grid_XFormItem.prototype.showRemoveButton=false;
Repeat_Grid_XFormItem.prototype.showAddButton=false;
Repeat_Grid_XFormItem.numCols=2;
Composite_XFormItem=function(){
Group_XFormItem.call(this)
};
XFormItemFactory.createItemType("_COMPOSITE_","composite",Composite_XFormItem,Group_XFormItem);
Composite_XFormItem.prototype.useParentTable=false;
Composite_XFormItem.prototype.tableCssClass="xform_composite_table";
Composite_XFormItem.prototype.focusable=false;
Composite_XFormItem.prototype.initializeItems=function(){
var e=this.getItems();
if(e==null){
return
}
if(this.numCols==null){
this.numCols=e.length
}
this.items=this.getForm().initItemList(e,this)
};
Composite_XFormItem.onFieldChange=function(a,t,e){
if(this.getParentItem()&&this.getParentItem().getOnChangeMethod()){
return this.getParentItem().getOnChangeMethod().call(this,a,t,e)
}else{
return this.setInstanceValue(a)
}};
SetupGroup_XFormItem=function(){};
SetupGroup_XFormItem.prototype.width="100%";
XFormItemFactory.createItemType("_SETUPGROUP_","setupgroup",SetupGroup_XFormItem,Composite_XFormItem);
SetupGroup_XFormItem.prototype.initializeItems=function(){
var e=this.getInheritedProperty("headerLabels");
var r=this.getInheritedProperty("contentItems");
this.items=[];
this.width="100%";
if(e.length!=0&&e.length==r.length){
var s=1;
var o;
for(var n=0;
n<e.length;
n++){
if(n!=e.length-1){
o=false
}else{
o=true
}
var l=this.constructSingleGroup(e[n],r[n],s,o);
if(l!=undefined){
this.items.push(l);
s++
}}}
this.numCols=this.items.length;
if(this.numCols>1){
var h=Math.floor(100/(this.numCols));
var a=100-h*(this.numCols-1);
var t=[];
for(var n=0;
n<this.numCols-1;
n++){
t.push(h+"%")
}
t.push(a+"%");
this.colSizes=t
}
Composite_XFormItem.prototype.initializeItems.call(this)
};
SetupGroup_XFormItem.prototype.constructSingleGroup=function(h,e,r,a){
var u={
type:_GROUP_,numCols:2,width:"100%",valign:_TOP_,items:[]};
var n=(r)+"  "+h;
var s;
if(a){
s={
type:_OUTPUT_,colSpan:"*",value:n,cssClass:"ZaHomeSetupHeader ZaHomeSetupTitle"}
}else{
s={
type:_GROUP_,colSpan:"*",numCols:3,cssClass:"ZaHomeSetupHeader",items:[{
type:_OUTPUT_,value:n,cssClass:"ZaHomeSetupTitle"}
,{
type:_SPACER_,width:"5px",colSpan:1}
,{
type:_AJX_IMAGE_,src:"SetupArrow"}
]}
}
u.items.push(s);
var o;
var d=false;
var c=1;
var l;
for(var t=0;
t<e.length;
t++){
if(e[t]&&e[t].value){
d=true;
l=c+".";
c++;
o={
type:_OUTPUT_,label:l,value:e[t].value,onClick:e[t].onClick,labelCssClass:"ZaHomeLinkItemLabel",containerCssClass:"ZaLinkedItem"};
u.items.push(o)
}}
if(!d){
return undefined
}else{
return u
}};
Date_XFormItem=function(){};
XFormItemFactory.createItemType("_DATE_","date",Date_XFormItem,Composite_XFormItem);
Date_XFormItem.prototype.DATE_MONTH_CHOICES=[{
value:1,label:I18nMsg.monthJanMedium}
,{
value:2,label:I18nMsg.monthFebMedium}
,{
value:3,label:I18nMsg.monthMarMedium}
,{
value:4,label:I18nMsg.monthAprMedium}
,{
value:5,label:I18nMsg.monthMayMedium}
,{
value:6,label:I18nMsg.monthJunMedium}
,{
value:7,label:I18nMsg.monthJulMedium}
,{
value:8,label:I18nMsg.monthAugMedium}
,{
value:9,label:I18nMsg.monthSepMedium}
,{
value:10,label:I18nMsg.monthOctMedium}
,{
value:11,label:I18nMsg.monthNovMedium}
,{
value:12,label:I18nMsg.monthDecMedium}
];
Date_XFormItem.prototype.DATE_DAY_CHOICES=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"];
Date_XFormItem.prototype.numCols=3;
Date_XFormItem.prototype.items=[{
type:_SELECT1_,ref:".",width:50,valign:_MIDDLE_,relevantBehavior:_PARENT_,choices:Date_XFormItem.prototype.DATE_MONTH_CHOICES,labelLocation:_NONE_,getDisplayValue:function(e){
if(!(e instanceof Date)){
e=new Date()
}
return""+(e.getMonth()+1)
}
,elementChanged:function(t,e,a){
if(e==null){
e=new Date()
}
var o=parseInt(t);
if(!isNaN(o)){
o-=1;
e.setMonth(o)
}
this.getForm().itemChanged(this.getParentItem(),e,a)
}}
,{
type:_SELECT1_,ref:".",width:50,valign:_MIDDLE_,relevantBehavior:_PARENT_,labelLocation:_NONE_,choices:Date_XFormItem.prototype.DATE_DAY_CHOICES,getDisplayValue:function(e){
if(!(e instanceof Date)){
e=new Date()
}
return""+e.getDate()
}
,elementChanged:function(t,e,o){
if(e==null){
e=new Date()
}
var a=parseInt(t);
if(!isNaN(a)){
e.setDate(a)
}
this.getForm().itemChanged(this.getParentItem(),e,o)
}}
,{
type:_TEXTFIELD_,ref:".",relevantBehavior:_PARENT_,width:45,labelLocation:_NONE_,getDisplayValue:function(e){
if(!(e instanceof Date)){
e=new Date()
}
return""+e.getFullYear()
}
,elementChanged:function(t,e,o){
if(e==null){
e=new Date()
}
var a=parseInt(t);
if(!isNaN(a)){
e.setYear(a)
}
this.getForm().itemChanged(this.getParentItem(),e,o)
}}
];
Time_XFormItem=function(){};
XFormItemFactory.createItemType("_TIME_","time",Time_XFormItem,Composite_XFormItem);
Time_XFormItem.prototype.numCols=3;
Time_XFormItem.prototype.TIME_HOUR_CHOICES=["1","2","3","4","5","6","7","8","9","10","11","12"];
Time_XFormItem.prototype.TIME_MINUTE_CHOICES=["00","05","10","15","20","25","30","35","40","45","50","55"];
Time_XFormItem.prototype.TIME_AMPM_CHOICES=[I18nMsg.periodAm,I18nMsg.periodPm];
Time_XFormItem.prototype.items=[{
type:_SELECT1_,ref:".",width:50,valign:_MIDDLE_,choices:Time_XFormItem.prototype.TIME_HOUR_CHOICES,labelLocation:_NONE_,getDisplayValue:function(t){
if(!(t instanceof Date)){
t=new Date()
}
var e=""+(t.getHours()%12);
if(e=="0"){
e="12"
}
return e
}
,elementChanged:function(r,n,s){
if(n==null){
n=new Date()
}
if(this.__dummyDate==null){
this.__dummyDate=new Date()
}
this.__dummyDate.setTime(n.getTime());
var o=parseInt(r);
if(!isNaN(o)){
if(o==12){
o=0
}
var a=(n.getHours()>11);
if(a){
o+=12
}
this.__dummyDate.setHours(o)
}
var t=this.getParentItem();
var e=t.getElementChangedMethod();
if(e!=null){
e.call(this.getParentItem(),this.__dummyDate,n,s)
}else{
this.getForm().itemChanged(this.getParentItem(),this.__dummyDate,s)
}}}
,{
type:_SELECT1_,ref:".",width:50,valign:_MIDDLE_,choices:Time_XFormItem.prototype.TIME_MINUTE_CHOICES,labelLocation:_NONE_,getDisplayValue:function(t){
if(!(t instanceof Date)){
t=new Date()
}
var e=t.getMinutes();
e=Math.round(e/5)*5;
e=(e<10?"0"+e:""+e);
return e
}
,elementChanged:function(s,a,n){
if(a==null){
a=new Date()
}
if(this.__dummyDate==null){
this.__dummyDate=new Date()
}
this.__dummyDate.setTime(a.getTime());
var o=parseInt(s);
if(!isNaN(o)){
this.__dummyDate.setMinutes(o)
}
var t=this.getParentItem();
var e=t.getElementChangedMethod();
if(e!=null){
e.call(this.getParentItem(),this.__dummyDate,a,n)
}else{
this.getForm().itemChanged(this.getParentItem(),this.__dummyDate,n)
}}}
,{
type:_SELECT1_,ref:".",choices:Time_XFormItem.prototype.TIME_AMPM_CHOICES,width:50,valign:_MIDDLE_,labelLocation:_NONE_,getDisplayValue:function(t){
if(!(t instanceof Date)){
t=new Date()
}
var e=t.getHours();
if(e>11){
return I18nMsg.periodPm
}
return I18nMsg.periodAm
}
,elementChanged:function(o,s,r){
if(s==null){
s=new Date()
}
if(this.__dummyDate==null){
this.__dummyDate=new Date()
}
this.__dummyDate.setTime(s.getTime());
var a=(o==I18nMsg.periodPm);
var n=s.getHours()%12;
this.__dummyDate.setHours(n+(a?12:0));
var t=this.getParentItem();
var e=t.getElementChangedMethod();
if(e!=null){
e.call(this.getParentItem(),this.__dummyDate,s,r)
}else{
this.getForm().itemChanged(this.getParentItem(),this.__dummyDate,r)
}}}
];
Datetime_XFormItem=function(){};
XFormItemFactory.createItemType("_DATETIME_","datetime",Datetime_XFormItem,Composite_XFormItem);
Datetime_XFormItem._datetimeFormatToItems=function(h,o,r){
var t=[];
var s=/{(\d+),\s*(date|time)}/;
var a=0;
while((a=h.search(s))!=-1){
if(a>0){
var n={
type:_OUTPUT_,value:h.substring(0,a),valign:_CENTER_};
t.push(n);
h=h.substring(a)
}
var e=s.exec(h);
t.push(e[2]=="date"?o:r);
h=h.substring(e[0].length)
}
if(h.length>0){
var n={
type:_OUTPUT_,value:h};
t.push(n)
}
return t
};
Datetime_XFormItem.prototype.numCols=3;
Datetime_XFormItem.prototype.items=Datetime_XFormItem._datetimeFormatToItems(AjxMsg.xformDateTimeFormat,{
type:_DATE_,ref:".",labelLocation:_NONE_}
,{
type:_TIME_,ref:".",labelLocation:_NONE_}
);
WidgetAdaptor_XFormItem=function(){};
XFormItemFactory.createItemType("_WIDGET_ADAPTOR_","widget_adaptor",WidgetAdaptor_XFormItem,XFormItem);
WidgetAdaptor_XFormItem.prototype.writeElementDiv=true;
WidgetAdaptor_XFormItem.prototype.focusable=false;
WidgetAdaptor_XFormItem.prototype.constructWidget=function(){};
WidgetAdaptor_XFormItem.prototype.insertElement=function(){
if(!this.__alreadyInserted){
this.__alreadyInserted=true;
var e=this.constructWidget();
if(e==null){
return
}
this.widget=e;
this.insertWidget(this.getForm(),this.widget,this.getElement())
}};
WidgetAdaptor_XFormItem.prototype.showElement=function(e){
this.insertElement();
XForm.prototype.showElement.call(this,e)
};
WidgetAdaptor_XFormItem.prototype.insertWidget=function(t,a,e){
this.widget.insertIntoXForm(t,this,e)
};
WidgetAdaptor_XFormItem.prototype.updateElement=function(e){
if(this.__alreadyInserted){
this.updateWidget(e)
}};
WidgetAdaptor_XFormItem.prototype.updateWidget=function(e){
this.widget.updateInXForm(this.getForm(),this,e,this.getElement())
};
Dwt_Adaptor_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_ADAPTOR_","dwt_adaptor",Dwt_Adaptor_XFormItem,WidgetAdaptor_XFormItem);
Dwt_Adaptor_XFormItem.prototype.focusable=false;
Dwt_Adaptor_XFormItem.prototype.setElementEnabled=function(e){
WidgetAdaptor_XFormItem.prototype.setElementEnabled.call(this,e);
if(this.widget){
this.widget.setEnabled(e)
}
this._enabled=e
};
Dwt_Adaptor_XFormItem.prototype.constructWidget=function(){};
Dwt_Adaptor_XFormItem.prototype.insertWidget=function(t,a,e){
this.getForm()._reparentDwtObject(a,e)
};
Dwt_Adaptor_XFormItem.prototype.updateWidget=function(e){};
Dwt_Adaptor_XFormItem.prototype.getDwtSelectItemChoices=function(){
if(this.__selOption!=null){
return this.__selOptions
}
var t=null;
var s=this.getChoices();
if(s!=null){
var t=new Array(s.length);
for(var o=0;
o<s.length;
o++){
var e=s[o];
var n=(e instanceof Object?e.value:e);
var a=(e instanceof Object?e.label:e);
t[o]=new DwtSelectOptionData(n,a)
}}
this.__selOptions=t;
return this.__selOptions
};
Dwt_Adaptor_XFormItem.prototype._addCssStylesToDwtWidget=function(){
var s=this.getCssStyle();
if(s!=null){
var e=s.split(";");
var n=this.widget.getHtmlElement();
var t;
for(var o=0;
o<e.length;
++o){
t=e[o].split(":");
if(t.length>0){
var a=t[0];
if(a!=null){
a=a.replace(/^(\s)*/,"")
}
if(a=="float"){
a=(AjxEnv.isIE)?"styleFloat":"cssFloat"
}
var r=t[1];
if(r!=null){
n.style[a]=r.replace(/^(\s)*/,"")
}}}}};
Dwt_Button_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_BUTTON_","dwt_button",Dwt_Button_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_Button_XFormItem.estimateMyWidth=function(e,a,o){
var t;
if(ZaZimbraAdmin.LOCALE=="ja"||ZaZimbraAdmin.LOCALE=="ko"||ZaZimbraAdmin.LOCALE=="zh_CN"||ZaZimbraAdmin.LOCALE=="zh_HK"){
t=(String(e).length)*XForm.FONT_WIDTH1+(String(e).length)*XForm.FONT_WIDTH2+14
}else{
t=(String(e).length/2)*XForm.FONT_WIDTH1+(String(e).length/2)*XForm.FONT_WIDTH2+14
}
if(a){
t=t+24
}
if(o>0){
t=t+o
}
return[t,"px"].join("")
};
Dwt_Button_XFormItem.prototype.labelLocation=DwtLabel.IMAGE_LEFT|DwtLabel.ALIGN_CENTER;
Dwt_Button_XFormItem.prototype.writeElementDiv=false;
Dwt_Button_XFormItem.prototype.autoPadding=true;
Dwt_Button_XFormItem.prototype.insertWidget=function(t,a,e){
this.getForm()._reparentDwtObject(a,this.getContainer())
};
Dwt_Button_XFormItem.prototype.constructWidget=function(){
var o=this.widget=new DwtButton(this.getForm(),this.getLabelLocation(),this.getCssClass());
var c=this.getHeight();
var u=this.getWidth();
var t=null;
if(u!=null||c!=null){
t=o.getHtmlElement();
if(u!=null){
t.style.width=u
}
if(c!=null){
t.style.height=c
}}
this._addCssStylesToDwtWidget();
var p=this.getInheritedProperty("icon");
if(p!=null){
o.setImage(p)
}
var h=false;
var m=this.getInheritedProperty("toolTipContent");
if(m!=null){
o.setToolTipContent(m);
h=true
}
var a=this.getLabel();
try{
var l=Dwt.getSize(this.getContainer());
if(a){
var b=AjxStringUtil.getWidth(a);
var d;
if(p){
d=l.x-42
}else{
d=l.x-22
}
if((d>0)&&(b>d)){
if(!h){
o.setToolTipContent(a)
}
var s=a.length;
var d=d-AjxStringUtil.getWidth("...");
var r=Math.floor(d*s/b);
if(d>0){
a=a.substring(0,r)+"..."
}}
t=o.getHtmlElement();
var y=t.firstChild;
var g=this.getInheritedProperty("autoPadding");
if(!y.style.width&&g){
y.style.width="100%"
}}}
catch(f){}
o.setText(a);
var e=this.getOnActivateMethod();
if(e!=null){
var n=new AjxListener(this,e);
o.addSelectionListener(n)
}
if(this._enabled!==void 0){
this.setElementEnabled(this._enabled)
}
return o
};
Dwt_Button_XFormItem.prototype.getWidget=function(){
return this.widget
};
Dwt_Select_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_SELECT_","dwt_select",Dwt_Select_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_Select_XFormItem.prototype.writeElementDiv=false;
Dwt_Select_XFormItem.prototype.insertWidget=function(t,a,e){
this.getForm()._reparentDwtObject(a,this.getContainer())
};
Dwt_Select_XFormItem.prototype.constructWidget=function(){
var r=this.getDwtSelectItemChoices(this.getChoices());
var s=this.widget=new DwtSelect(this.getForm(),r);
var e=this.getHeight();
var n=this.getWidth();
if(n!=null||e!=null){
var o=s.getHtmlElement();
if(n!=null){
o.style.width=n
}
if(e!=null){
o.style.height=e
}}
this._addCssStylesToDwtWidget();
var a=new Function("event","var widget = event._args.selectObj;\rvalue = event._args.newValue; "+this.getExternalChangeHandler());
var t=new AjxListener(this.getForm(),a);
s.addChangeListener(t);
if(this._enabled!==void 0){
this.setElementEnabled(this._enabled)
}
return s
};
Dwt_Select_XFormItem.prototype.updateWidget=function(e){
this.widget.setSelectedValue(e)
};
Dwt_Select_XFormItem.prototype.setElementEnabled=function(e){
this._enabled=e;
if(this.widget==null){
return
}
if(e){
this.widget.enable()
}else{
this.widget.disable()
}};
Dwt_ColorPicker_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_COLORPICKER_","dwt_colorpicker",Dwt_ColorPicker_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_ColorPicker_XFormItem.prototype.cssStyle="width:80px;";
Dwt_ColorPicker_XFormItem.prototype.nowrap=false;
Dwt_ColorPicker_XFormItem.prototype.labelWrap=true;
Dwt_ColorPicker_XFormItem.prototype.constructWidget=function(){
var a={
parent:this.getForm(),allowColorInput:true,noFillLabel:ZaMsg.bt_reset};
var t=new DwtButtonColorPicker(a);
t.setActionTiming(DwtButton.ACTION_MOUSEDOWN);
var e=this.getInheritedProperty("buttonImage")||"FontColor";
t.setImage(e);
t.showColorDisplay(true);
t.setToolTipContent(ZMsg.xformFontColor);
if(this.getInstanceValue()!=null){
t.setColor(this.getInstanceValue())
}
t.__colorPicker.addSelectionListener(new AjxListener(this,this._colorOnChange));
return t
};
Dwt_ColorPicker_XFormItem.prototype.updateWidget=function(e){
if(!this.widget){
return
}
if(e!=null){
this.widget.setColor(e)
}else{
this.widget.setColor("")
}};
Dwt_ColorPicker_XFormItem.prototype._colorOnChange=function(t){
var a=t.detail;
var o=this.getElementChangedMethod();
if(o){
o.call(this,a,this.getInstanceValue(),t)
}
var e=this.getOnChangeMethod();
if(e){
e.call(this,a,t,this.getForm())
}};
Dwt_Date_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_DATE_","dwt_date",Dwt_Date_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_Date_XFormItem.prototype.cssClass="xform_dwt_date";
Dwt_Date_XFormItem.prototype.constructWidget=function(){
var e=this.getInheritedProperty("firstDayOfWeek");
var t=new DwtButton(this.getForm());
t.setActionTiming(DwtButton.ACTION_MOUSEDOWN);
var o=this.menu=new DwtMenu(t,DwtMenu.CALENDAR_PICKER_STYLE,null,null,this.getForm());
o.setSize("150");
o._table.width="100%";
t.setMenu(o,true);
o.setAssociatedObj(t);
var a=new DwtCalendar({
parent:o,firstDayOfWeek:(!AjxUtil.isEmpty(e)?e:0)}
);
a._invokingForm=this.getForm();
a._invokingFormItemId=this.getId();
a.setDate(new Date(),true);
a.addSelectionListener(new AjxListener(this,this._calOnChange));
t.__cal=a;
return t
};
Dwt_Date_XFormItem.prototype.updateWidget=function(e){
if(e==null){
e=new Date()
}
this.widget.setText(this.getButtonLabel(e));
this.widget._date=e;
this.widget.__cal.setDate(e,true)
};
Dwt_Date_XFormItem.prototype._calOnChange=function(t){
var a=t.detail;
var o=t.item;
var e=this.getElementChangedMethod();
e.call(this,a,this.getInstanceValue(),t)
};
Dwt_Date_XFormItem.prototype.getButtonLabel=function(t){
if(t==null||!(t instanceof Date)){
return""
}
var e=AjxDateFormat.getDateInstance(AjxDateFormat.NUMBER);
return e.format(t)
};
Dwt_Time_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_TIME_","dwt_time",Dwt_Time_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_Time_XFormItem.prototype.cssClass="xform_dwt_time";
Dwt_Time_XFormItem.prototype.constructWidget=function(){
var e=new DwtTimeSelect(this.getForm());
e.addChangeListener(this._onChange.bind(this));
return e
};
Dwt_Time_XFormItem.prototype.updateWidget=function(e){
if(e==null){
e=new Date();
e.setHours(0,0,0,0)
}
this.widget.set(e)
};
Dwt_Time_XFormItem.prototype._onChange=function(t){
var a=this.widget.getValue();
var e=this.getElementChangedMethod();
e.call(this,a,this.getInstanceValue(),t)
};
Dwt_Datetime_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_DATETIME_","dwt_datetime",Dwt_Datetime_XFormItem,Composite_XFormItem);
Dwt_Datetime_XFormItem.prototype.numCols=3;
Dwt_Datetime_XFormItem.prototype.useParentTable=false;
Dwt_Datetime_XFormItem.prototype.cssClass="xform_dwt_datetime";
Dwt_Datetime_XFormItem.initialize=function(){
Dwt_Datetime_XFormItem.prototype.items=Datetime_XFormItem._datetimeFormatToItems(AjxMsg.xformDateTimeFormat,{
type:_DWT_DATE_,ref:".",labelLocation:_NONE_,errorLocation:_PARENT_,elementChanged:function(a,t,o){
t=t?t:new Date();
a.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),0);
var e=this.getParentItem().getElementChangedMethod();
if(e){
e.call(this.getParentItem(),a,t,o)
}}}
,{
type:_DWT_TIME_,ref:".",labelLocation:_NONE_,errorLocation:_PARENT_,elementChanged:function(a,t,o){
t=t?t:new Date();
a.setFullYear(t.getFullYear(),t.getMonth(),t.getDate());
var e=this.getParentItem().getElementChangedMethod();
if(e){
e.call(this.getParentItem(),a,t,o)
}}}
)
};
Dwt_Datetime_XFormItem.initialize();
Dwt_List_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_LIST_","dwt_list",Dwt_List_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_List_XFormItem.prototype.writeElementDiv=false;
Dwt_List_XFormItem.prototype.widgetClass=DwtListView;
Dwt_List_XFormItem.prototype.bmolsnr=true;
Dwt_List_XFormItem.prototype.getOnSelectionMethod=function(){
return this.cacheInheritedMethod("onSelection","$onSelection","event")
};
Dwt_List_XFormItem.prototype.constructWidget=function(){
var n=this.getInheritedProperty("headerList");
var m=this.getInheritedProperty("widgetClass");
var c=this.getInheritedProperty("hideHeader");
var l=new m(this.getForm(),this.getCssClass(),null,((c!=undefined&&c==true)?null:n));
var s=this.getInheritedProperty("emptyText");
if(s!=null||s===""){
l.emptyText=s
}
if(c!=undefined){
l.hideHeader=c;
if(c&&n){
l._headerList=n
}}
var r=this.getInheritedProperty("multiselect");
if(r!=undefined){
l.setMultiSelect(r)
}
if(this.cacheInheritedMethod("getCustomHeight","$getCustomHeight")&&this.cacheInheritedMethod("getCustomWidth","$getCustomWidth")){
var u=this.cacheInheritedMethod("getCustomHeight","$getCustomHeight").call(this);
var o=this.cacheInheritedMethod("getCustomWidth","$getCustomWidth").call(this);
if(o&&u){
l.setSize(o,u)
}}else{
var o=this.getWidth();
var u=this.getHeight();
if(o&&u){
l.setSize(o,u)
}
if(u&&u!=Dwt.DEFAULT){
l.setListDivHeight(u)
}}
var h=this.getOnSelectionMethod();
if(h){
l.addSelectionListener(new AjxListener(this,h))
}else{
var d=new AjxListener(this,this._handleSelection);
l.addSelectionListener(d)
}
var a=this.cacheInheritedMethod("createPopupMenu","$createPopupMenu","parent");
if(a!=null){
a.call(this,l)
}
var t=this.getForm();
var e=(t.parent instanceof DwtControl)?t.parent:DwtControl.fromElementId(window._dwtShellId);
if(e){
if(this.cacheInheritedMethod("resizeHdlr","$resizeHdlr")&&this.cacheInheritedMethod("getCustomHeight","$getCustomHeight")&&this.cacheInheritedMethod("getCustomWidth","$getCustomWidth")){
e.addControlListener(new AjxListener(this,this.cacheInheritedMethod("resizeHdlr","$resizeHdlr")))
}}
return l
};
Dwt_List_XFormItem.prototype.resizeHdlr=function(){
try{
var e=this.cacheInheritedMethod("getCustomHeight","$getCustomHeight").call(this);
var a=this.cacheInheritedMethod("getCustomWidth","$getCustomWidth").call(this);
this.widget.setSize(a,e)
}
catch(t){
alert(t)
}};
Dwt_List_XFormItem.prototype.getSelection=function(){
return this.widget.getSelection()
};
Dwt_List_XFormItem.prototype._handleSelection=function(t){
var e=this.getModelItem();
var t=new DwtXModelEvent(this.getInstance(),e,null,null);
e.notifyListeners(DwtEvent.XFORMS_VALUE_CHANGED,t)
};
Dwt_List_XFormItem.prototype.insertWidget=function(t,a,e){
this.getForm()._reparentDwtObject(a,this.getContainer())
};
Dwt_List_XFormItem.prototype.updateWidget=function(e){
if(typeof(e)!="undefined"){
this.setItems(e)
}};
Dwt_List_XFormItem.isItemsChanged=function(e,h){
var t=false;
if((e._version!=null&&h._version!=null&&(e._version!=h._version))||(e.length!=h.length)){
t=true
}else{
var n=[];
var o=[];
for(var a=0;
a<e.length;
a++){
if(e[a] instanceof Object){
for(var s in e[a]){
n.push(e[a][s])
}}else{
n.push(e[a])
}
if(h[a] instanceof Object){
for(var r in h[a]){
o.push(h[a][r])
}}else{
o.push(h[a])
}
if(n.join()!=o.join()){
t=true;
break
}else{
n=[];
o=[]
}}}
return t
};
Dwt_List_XFormItem.prototype.setItems=function(e){
var s=this.widget.getList();
var r=new Array();
var a=new Array();
if(s){
r=s.getArray()
}
a=new Array();
var h=this.getInheritedProperty("defaultColumnSortable");
if(e&&e.length>0){
if(this.getForceUpdate()||Dwt_List_XFormItem.isItemsChanged(e,r)){
var n=this.getInheritedProperty("preserveSelection");
var l=null;
if(n){
l=this.widget.getSelection()
}
var t=e.length;
for(var o=0;
o<t;
o++){
a.push(e[o])
}
this.widget.set(AjxVector.fromArray(a),h);
if(e._version!=undefined&&e._version!=null){
this.widget.getList().getArray()._version=e._version
}
if(n&&l){
this.widget.setSelectedItems(l)
}}}else{
this.widget.set(AjxVector.fromArray([]),h)
}};
Dwt_List_XFormItem.prototype.appendItems=function(e){
this.widget.addItems(e)
};
Button_Grid_XFormItem=function(){};
XFormItemFactory.createItemType("_BUTTON_GRID_","button_grid",Button_Grid_XFormItem,WidgetAdaptor_XFormItem);
Button_Grid_XFormItem.prototype.numCols=5;
Button_Grid_XFormItem.prototype.cssClass="xform_button_grid_medium";
Button_Grid_XFormItem.prototype.forceUpdate=true;
Button_Grid_XFormItem.prototype.constructWidget=function(){
var a=this.getExternalChangeHandler();
var t={
numCols:this.getNumCols(),choices:choices.getChoiceObject(),cssClass:this.getCssClass(),onChange:a,addBracketingCells:(this.getAlign()==_CENTER_)};
var e=this.getMultiple();
if(e!==null){
t.multiple=e
}
return new ButtonGrid(t)
};
Dwt_Chooser_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_CHOOSER_","chooser",Dwt_Chooser_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_Chooser_XFormItem.prototype.widgetClass=DwtChooser;
Dwt_Chooser_XFormItem.prototype.listSize=100;
Dwt_Chooser_XFormItem.prototype.getSorted=function(){
return this.getInheritedProperty("sorted")
};
Dwt_Chooser_XFormItem.prototype.getListCssClass=function(){
return this.getInheritedProperty("listCssClass")
};
Dwt_Chooser_XFormItem.prototype.getTargetListCssClass=function(){
return this.getInheritedProperty("targetListCssClass")
};
Dwt_Chooser_XFormItem.prototype.getSourceInstanceValue=function(){
var e=this.getModel().getInstanceValue(this.getInstance(),this.getInheritedProperty("sourceRef"));
if(!e){
e=new AjxVector()
}else{
if(typeof e=="string"){
e=new Array(e)
}}
return e
};
Dwt_Chooser_XFormItem.prototype.getTargetInstanceValue=function(){
var e=this.getInstanceValue();
if(!e){
e=new AjxVector()
}else{
if(typeof e=="string"){
e=new Array(e)
}}
return e
};
Dwt_Chooser_XFormItem.prototype._handleStateChange=function(t){
var e=this.getForm();
var n=this.getId();
var o=this.getWidget();
var a=o.getItems();
this._skipUpdate=true;
e.itemChanged(n,a);
this._skipUpdate=false
};
Dwt_Chooser_XFormItem.prototype.constructWidget=function(){
var o=this.getForm();
var e=this.getCssClass();
var r=this.getListCssClass();
var t=this.getTargetListCssClass();
var s=this.getInheritedProperty("widgetClass");
if(r&&!t){
t=r
}
var a=this.getInheritedProperty("listSize");
var n={
parent:o,className:e,slvClassName:r,tlvClassName:t,layoutStyle:(this.getInheritedProperty("layoutStyle")?this.getInheritedProperty("layoutStyle"):DwtChooser.HORIZ_STYLE),listSize:a,sourceEmptyOk:true,allButtons:true,listWidth:(this.getInheritedProperty("listWidth")?this.getInheritedProperty("listWidth"):null),listHeight:(this.getInheritedProperty("listHeight")?this.getInheritedProperty("listHeight"):null),tableWidth:(this.getInheritedProperty("tableWidth")?this.getInheritedProperty("tableWidth"):null),labelWidth:(this.getInheritedProperty("labelWidth")?this.getInheritedProperty("labelWidth"):null),splitButtons:this.getInheritedProperty("splitButtons")};
return new s(n)
};
Dwt_Chooser_XFormItem.prototype.updateWidget=function(s,t,e){
if(this._skipUpdate){
return
}
if(this._stateChangeListener){
this.widget.removeStateChangeListener(this._stateChangeListener)
}else{
this._stateChangeListener=new AjxListener(this,Dwt_Chooser_XFormItem.prototype._handleStateChange)
}
var l=this.getSourceInstanceValue();
var c;
if(l instanceof Array){
var d=[];
var a=l.length;
for(var r=0;
r<a;
r++){
d.push(l[r])
}
c=AjxVector.fromArray(d)
}else{
c=l.clone()
}
var n=this.getTargetInstanceValue();
if(n instanceof Array){
n=AjxVector.fromArray(n)
}
if(t){
var a=n.size();
for(var r=0;
r<a;
r++){
if(e){
var o=c.indexOfLike(n.get(r),e);
if(o>-1){
c.removeAt(o)
}}else{
var o=c.indexOf(n.get(r));
if(o>-1){
c.removeAt(o)
}}}}
var h=this.getSorted();
if(h){
c.sort();
n.sort()
}
this.widget.setItems(c);
this.widget.setItems(n,DwtChooserListView.TARGET);
this.widget.addStateChangeListener(this._stateChangeListener)
};
Dwt_Alert_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_ALERT_","alert",Dwt_Alert_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_Alert_XFormItem.prototype.colSpan="*";
Dwt_Alert_XFormItem.prototype.labelLocation=_NONE_;
Dwt_Alert_XFormItem.prototype.getStyle=function(){
return this.getInheritedProperty("style")
};
Dwt_Alert_XFormItem.prototype.getIconVisible=function(){
return this.getInheritedProperty("iconVisible")
};
Dwt_Alert_XFormItem.prototype.getTitle=function(){
return this.getInheritedProperty("title")
};
Dwt_Alert_XFormItem.prototype.getContent=function(){
return this.getInheritedProperty("content")
};
Dwt_Alert_XFormItem.prototype.getAlertCssClass=function(){
return this.getInheritedProperty("alertCssClass")
};
Dwt_Alert_XFormItem.prototype.constructWidget=function(){
var u=this.getStyle();
var d=this.getIconVisible();
var b=this.getTitle();
var c=this.getContent();
var n=this.getAlertCssClass();
var t=this.getForm();
var a=new DwtAlert(t,n);
a.setStyle(u);
a.setIconVisible(d);
a.setTitle(b);
a.setContent(c);
if(AjxEnv.isIE){
try{
var w=a.getHtmlElement();
var s=Dwt.getSize(w);
var o=this.getContainer();
var l=Dwt.getSize(o);
var u=DwtCssStyle.getComputedStyleObject(w);
var e=parseInt(u.borderLeftWidth)||1;
var y=parseInt(u.borderRightWidth)||1;
var p=parseInt(u.paddingLeft)||5;
var h=parseInt(u.paddingRight)||5;
var m=parseInt(u.marginLeft)||5;
var r=parseInt(u.marginRight)||5;
var g=e+y+p+h+m+r;
if(l.x>g){
s.x=l.x-g;
Dwt.setSize(w,s.x,s.y)
}}
catch(f){}}
return a
};
Dwt_Alert_XFormItem.prototype.updateWidget=function(e){
var t=this.getContent();
if(!t&&e){
this.getWidget().setContent(e)
}};
Dwt_TabBar_XFormItem=function(){};
XFormItemFactory.createItemType("_TAB_BAR_","tab_bar",Dwt_TabBar_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_TabBar_XFormItem.prototype.colSpan="*";
Dwt_TabBar_XFormItem.prototype.labelLocation=_NONE_;
Dwt_TabBar_XFormItem.prototype.cssStyle="margin-right: 5px";
Dwt_TabBar_XFormItem.prototype._value2tabkey;
Dwt_TabBar_XFormItem.prototype._tabkey2value;
Dwt_TabBar_XFormItem.prototype._stateChangeListener;
Dwt_TabBar_XFormItem.prototype.getChoices=function(){
return this.getInheritedProperty("choices")
};
Dwt_TabBar_XFormItem.prototype._handleStateChange=function(a){
var t=this.getForm();
var o=this.getWidget();
var n=o.getCurrentTab();
var e=this._tabkey2value[n];
var s=this.getId();
t.releaseFocus();
t.itemChanged(s,e,a,true)
};
Dwt_TabBar_XFormItem.prototype.constructWidget=function(){
var e=this.getForm();
var d=this.getCssClass();
var n=this.getInheritedProperty("buttonCssClass");
var r=new DwtTabBarFloat(e,d,n);
this._value2tabkey={};
this._tabkey2value={};
var c=this.getChoices();
if(c.constructor==XFormChoices){
this.choices=c;
var a=new AjxListener(this,this.dirtyDisplay);
c.addListener(DwtEvent.XFORMS_CHOICES_CHANGED,a);
var l=this.getNormalizedValues();
var h=this.getNormalizedLabels();
var t=l.length;
for(var s=0;
s<t;
s++){
this._value2tabkey[l[s]]=s+1;
this._tabkey2value[s+1]=l[s];
r.addButton(s+1,h[s]);
r.getButton(s+1).getHtmlElement().style.paddingRight="2px"
}}else{
var t=c.length;
for(var s=0;
s<t;
s++){
var o=c[s];
this._value2tabkey[o.value]=s+1;
this._tabkey2value[s+1]=o.value;
r.addButton(s+1,o.label);
r.getButton(s+1).getHtmlElement().style.paddingRight="2px"
}}
return r
};
Dwt_TabBar_XFormItem.prototype.updateWidget=function(e){
if(this.widget.isUpdating){
this.widget.isUpdating=false;
return
}
if(this._stateChangeListener){
this.widget.removeStateChangeListener(this._stateChangeListener)
}else{
this._stateChangeListener=new AjxListener(this,Dwt_TabBar_XFormItem.prototype._handleStateChange)
}
var t=this._value2tabkey[e];
if(t!=this.widget.getCurrentTab()){
this.widget.openTab(t)
}
this.widget.addStateChangeListener(this._stateChangeListener)
};
Dwt_TabBar_XFormItem.prototype.dirtyDisplay=function(){
this.$normalizedChoices=null;
if(this.choices&&this.choices.constructor==XFormChoices){
var s=this.getNormalizedLabels();
var e=this.getNormalizedValues();
var o=s.length;
for(var a=0;
a<o;
a++){
var n=this._value2tabkey[e[a]];
if(n){
var t=this.widget.getButton(n);
if(t){
t.setText(s[a])
}}}}
this._choiceDisplayIsDirty=true;
delete this.$normalizedChoices
};
Dwt_ProgressBar_XFormItem=function(){};
XFormItemFactory.createItemType("_DWT_PROGRESS_BAR_","dwt_progress_bar",Dwt_ProgressBar_XFormItem,Dwt_Adaptor_XFormItem);
Dwt_ProgressBar_XFormItem.prototype.constructWidget=function(){
var a=this.getForm();
var o=new DwtProgressBar(a,null);
var t=this.getInheritedProperty("maxValue");
if(!t){
this.maxValueRef=this.getInheritedProperty("maxValueRef");
t=this.getModel().getInstanceValue(this.getInstance(),this.maxValueRef)
}
o.setMaxValue(t);
var n=this.getInheritedProperty("progressCssClass");
if(n){
o.setProgressCssClass(n)
}
var e=this.getInheritedProperty("wholeCssClass");
if(e){
o.setWholeCssClass(e)
}
return o
};
Dwt_ProgressBar_XFormItem.prototype.updateWidget=function(e){
if(!e){
e=0
}
if(this.maxValueRef){
maxvalue=this.getModel().getInstanceValue(this.getInstance(),this.maxValueRef);
this.getWidget().setMaxValue(maxvalue)
}
this.getWidget().setValue(e)
}
}
if(AjxPackage.define("ajax.dwt.xforms.XFormChoices")){
XFormChoices=function(o,t,e,a){
if(arguments.length==0){
return
}
if(o!=null){
this._choiceObject=o
}
if(t!=null){
this._type=t
}
if(e!=null){
this._valueProperty=e
}
if(a!=null){
this._labelProperty=a
}
this._choiceChangeTime=new Date().getTime();
this._lastNormalizeTime=0;
if(this._type==XFormChoices.AUTO){
this.autoDetermineType()
}
this._eventMgr=new AjxEventMgr()
};
XFormChoices.prototype=new Object();
XFormChoices.prototype.constructor=XFormChoices;
XFormChoices.normalizeChoices=function(d,r,o,l){
var c;
var s;
var a;
var h=0;
switch(r){
case XFormChoices.SIMPLE_LIST:c=[].concat(d);
s=[].concat(d);
break;
case XFormChoices.OBJECT_LIST:c=[];
s=[];
a=[];
if(o==null){
o="value"
}
if(l==null){
l="label"
}
var t=d.length;
for(var n=0;
n<t;
n++){
if(d[n]){
c.push(d[n][o]);
s.push(d[n][l]);
if(d[n]["visible"]==false){
a.push(false);
h++
}else{
a.push(true)
}}}
break;
case XFormChoices.OBJECT_REFERENCE_LIST:c=[];
s=[];
if(l==null){
l="label"
}
var t=d.length;
for(var n=0;
n<t;
n++){
if(d[n]){
c.push(d[n]);
s.push(d[n][l])
}}
break;
case XFormChoices.HASH:c=[];
s=[];
for(var e in d){
c.push(e);
s.push(d[e])
}
break
}
return{
values:c,labels:s,visible:a,totalInvisibleChoices:h}
};
XFormChoices.AUTO="auto";
XFormChoices.SIMPLE_LIST="list";
XFormChoices.HASH="hash";
XFormChoices.OBJECT_LIST="object";
XFormChoices.OBJECT_REFERENCE_LIST="object_reference_list";
XFormChoices.prototype._type=XFormChoices.AUTO;
XFormChoices.prototype._valueProperty="value";
XFormChoices.prototype._labelProperty="label";
XFormChoices.prototype._visibleProperty="visible";
XFormChoices.prototype.getChoiceObject=function(){
return this._choiceObject
};
XFormChoices.prototype.autoDetermineType=function(){
var t;
var a=this._choiceObject;
if(a){
if(AjxUtil.isArray(a)){
var e=a[0];
if(AjxUtil.isObject(e)){
t=XFormChoices.OBJECT_LIST
}else{
t=XFormChoices.SIMPLE_LIST
}}else{
if(AjxUtil.isObject(a)){
t=XFormChoices.HASH
}}}
if(t==null){
t=XFormChoices.SIMPLE_LIST
}
this._type=t
};
XFormChoices.prototype.setChoices=function(e){
this._choiceObject=e
};
XFormChoices.prototype.getChoices=function(){
if(this._lastNormalizeTime==this._choiceChangeTime&&this.$normalizedChoices){
return this.$normalizedChoices
}
this._lastNormalizeTime=this._choiceChangeTime;
this.$normalizedChoices=XFormChoices.normalizeChoices(this._choiceObject,this._type,this._valueProperty,this._labelProperty);
return this.$normalizedChoices
};
XFormChoices.prototype.getChoiceByValue=function(a){
switch(this._type){
case XFormChoices.SIMPLE_LIST:return a;
break;
case XFormChoices.OBJECT_LIST:var t=this._valueProperty||"value";
for(var e=0;
e<this._choiceObject.length;
e++){
if(this._choiceObject[e][t]==a){
return this._choiceObject[e]
}}
break;
case XFormChoices.OBJECT_REFERENCE_LIST:for(var e=0;
e<this._choiceObject.length;
e++){
if(this._choiceObject[e]==a){
return this._choiceObject[e]
}}
break;
case XFormChoices.HASH:return this._choiceObject[a];
break
}
return null
};
XFormChoices.prototype.dirtyChoices=function(){
this._choiceChangeTime=new Date().getTime();
this.notifyListeners(DwtEvent.XFORMS_CHOICES_CHANGED,{}
)
};
XFormChoices.prototype.addListener=function(e,t){
return this._eventMgr.addListener(e,t)
};
XFormChoices.prototype.notifyListeners=function(e,t){
return this._eventMgr.notifyListeners(e,t)
};
XFormChoices.prototype.isListenerRegistered=function(e){
return this._eventMgr.isListenerRegistered(e)
};
XFormChoices.prototype.removeListener=function(e,t){
return this._eventMgr.removeListener(e,t)
}
}
if(AjxPackage.define("ajax.dwt.xforms.OSelect_XFormItem")){
OSelect1_XFormItem=function(){
this._enabled=true
};
XFormItemFactory.createItemType("_OSELECT1_","oselect1",OSelect1_XFormItem,Select1_XFormItem);
OSelect1_XFormItem._mouseWheelEventAttached=false;
OSelect1_XFormItem._mouseWheelCurrentSelect;
OSelect1_XFormItem._mouseWheelHideMenu=function(){
OSelect1_XFormItem._mouseWheelCurrentSelect.hideMenu()
};
OSelect1_XFormItem.prototype.focusable=false;
OSelect1_XFormItem.prototype.cssClass="oselect";
OSelect1_XFormItem.prototype.multiple=false;
OSelect1_XFormItem.prototype.writeElementDiv=false;
OSelect1_XFormItem.prototype.width="auto";
OSelect1_XFormItem.prototype.editable=false;
OSelect1_XFormItem.prototype.menuUp=false;
OSelect1_XFormItem.prototype.noteUp=false;
OSelect1_XFormItem.prototype.inputSize=25;
OSelect1_XFormItem.prototype.bmolsnr=true;
OSelect1_XFormItem.prototype.nowrap=false;
OSelect1_XFormItem.prototype.labelWrap=true;
OSelect1_XFormItem.prototype.setMenuWidth=true;
OSelect1_XFormItem.prototype.showCheck=false;
OSelect1_XFormItem.prototype.checkHTML="&radic;";
OSelect1_XFormItem.MENU_DIR_DOWN=1;
OSelect1_XFormItem.MENU_DIR_UP=2;
OSelect1_XFormItem.MENU_DIR_UNKNOWN=0;
OSelect1_XFormItem.NOTE_HEIGHT=22;
OSelect1_XFormItem.prototype.menuDirection=OSelect1_XFormItem.MENU_DIR_UNKNOWN;
OSelect1_XFormItem.prototype.visibilityChecks=[XFormItem.prototype.hasReadPermission];
OSelect1_XFormItem.prototype.enableDisableChecks=[XFormItem.prototype.hasWritePermission];
OSelect1_XFormItem.prototype.initFormItem=function(){
var t=this.getChoices();
if(t==null||t.constructor!=XFormChoices){
return
}
var e=new AjxListener(this,this.choicesChangeLsnr);
t.addListener(DwtEvent.XFORMS_CHOICES_CHANGED,e)
};
OSelect1_XFormItem.prototype.updateElement=function(a){
if(this.choicesAreDirty()){
this.updateChoicesHTML()
}
if(this.getMultiple()&&a!=null&&a.indexOf(",")>-1){
a=a.split(",");
for(var e=0;
e<a.length;
e++){
a[e]=this.getChoiceLabel(a[e])
}}else{
a=this.getChoiceLabel(a)
}
if(a==null){
a=""
}
var t=this.getDisplayElement();
if(t){
if(this.getInheritedProperty("editable")){
if((!a||a=="")&&t.value!=a){
var e=0
}
t.value=a;
if(this.getElement()&&t.offsetWidth&&this.getElement().style){
this.getElement().style.width=t.offsetWidth+20+"px"
}}else{
t.innerHTML=a
}}};
OSelect1_XFormItem.prototype.getShowCheck=function(){
return this.cacheInheritedProperty("showCheck","$showCheck")
};
OSelect1_XFormItem.prototype.getCheckHTML=function(){
return this.cacheInheritedProperty("checkHTML","$checkHTML")
};
OSelect1_XFormItem.prototype.getMenuElementId=function(){
return"___OSELECT_MENU___"
};
OSelect1_XFormItem.prototype.getMenuElement=function(){
var t=this.getMenuElementId();
var e=this.getElement(t);
if(e==null){
e=this.createElement(t,null,"div","MENU CONTENTS")
}
return e
};
OSelect1_XFormItem.prototype.getNoteElementId=function(){
return"___OSELECT_NOTE___"
};
OSelect1_XFormItem.prototype.getNoteElement=function(){
var t=this.getNoteElementId();
var e=this.getElement(t);
if(e==null){
e=this.createElement(t,null,"div","NOTE CONTENTS")
}
return e
};
OSelect1_XFormItem.prototype.showMenu=function(){
if(!this._enabled){
return
}
if(window.console&&window.console.log){
console.log("Showing menu")
}
this.hideInputTooltip();
if(AjxEnv.isIE&&!OSelect1_XFormItem._mouseWheelEventAttached){
var o=this.getForm();
var c=o.getHtmlElement();
if(c.attachEvent){
c.attachEvent("onmousewheel",OSelect1_XFormItem._mouseWheelHideMenu);
OSelect1_XFormItem._mouseWheelCurrentSelect=this;
OSelect1_XFormItem._mouseWheelEventAttached=true
}}
var s=this.getMenuElement();
if(s==null){
return
}
s.className=this.getMenuCssClass();
s.innerHTML=this.getChoicesHTML();
var t;
if(this.getInheritedProperty("editable")){
t=this.getBounds(this.getDisplayElement())
}else{
t=this.getBounds(this.getElement())
}
var m=DwtShell.getShell(window).getSize();
var a=m.y;
var f=8;
s.style.left=parseInt(t.left)+"px";
s.style.top=parseInt(t.top)+parseInt(t.height)-1+"px";
var p=this.getNormalizedChoices();
if(p&&p.values){
s.style.overflow="auto";
var h=p.values.length-p.totalInvisibleChoices;
s.style.height="auto"
}
var u=this.getInstanceValue();
var l=this.getDisplayValueMethod();
if(l){
u=l.call(this,u)
}
var e=this.getChoiceNum(u);
this.__currentHiliteItem=e;
this.hiliteChoice(e);
s.style.zIndex=Dwt.Z_HIDDEN;
s.style.display="block";
var n=this.getBounds(s);
var r=n.height;
var d=n.top;
if(this.getInheritedProperty("setMenuWidth")==true){
if(AjxEnv.isIE){
if(this.getInheritedProperty("editable")){
s.style.width=parseInt(t.width)+4+"px";
s.getElementsByTagName("table")[0].style.width=parseInt(t.width)-1+"px"
}else{
s.style.width=parseInt(t.width)+2+"px";
s.getElementsByTagName("table")[0].style.width=parseInt(t.width)-1+"px"
}}else{
if(this.getInheritedProperty("editable")){
s.style.width=parseInt(t.width)-5+"px";
s.getElementsByTagName("table")[0].style.width=parseInt(t.width)-6+"px"
}else{
s.style.width=parseInt(t.width)-3+"px";
s.getElementsByTagName("table")[0].style.width=parseInt(t.width)-4+"px"
}}}
if(r+d>a-f){
if((t.top-r)>f){
s.style.top=t.top-r+"px";
s.getElementsByTagName("table")[0].className=this.getChoiceTableCssClass()
}else{
if(t.top>((a-f*2)/2)){
s.style.height=parseInt(t.top)-f+"px";
s.style.top=f+"px";
this.menuDirection=OSelect1_XFormItem.MENU_DIR_UP
}else{
s.style.top=parseInt(s.style.top)+2+"px";
s.style.height=a-f-parseInt(s.style.top)+"px";
this.menuDirection=OSelect1_XFormItem.MENU_DIR_DOWN
}
if(!AjxEnv.isIE){
s.style.height=parseInt(s.style.height)-11
}
s.style.overflow="auto";
s.getElementsByTagName("table")[0].className=this.getChoiceScrollTableCssClass();
s.getElementsByTagName("table")[0].width="100%"
}}else{
s.getElementsByTagName("table")[0].className=this.getChoiceTableCssClass()
}
if(!AjxEnv.isIE&&s.clientWidth&&s.scrollWidth&&(s.scrollWidth>s.clientWidth)){
s.style.overflow="auto"
}
s.style.zIndex=1000000;
if(this.$hideListener==null){
this.$hideListener=new AjxListener(this,this.oMouseUp)
}
if(this.$outsideMouseDownListener==null){
this.$outsideMouseDownListener=new AjxListener(this,this.onOutsideMouseDown)
}
AjxCore.addListener(window,DwtEvent.ONMOUSEUP,this.$hideListener);
AjxCore.addListener(document.body,DwtEvent.ONMOUSEDOWN,this.$outsideMouseDownListener);
Dwt.setHandler(this.getForm().getHtmlElement(),DwtEvent.ONMOUSEWHEEL,this.$outsideMouseDownListener);
DwtEventManager.addListener(DwtEvent.ONMOUSEDOWN,this.$outsideMouseDownListener);
this.menuUp=true
};
OSelect1_XFormItem.prototype.choicesChangeLsnr=function(){
this._choiceDisplayIsDirty=true;
delete this.$normalizedChoices;
if(this.menuUp){
this.showMenu()
}};
OSelect1_XFormItem.prototype.redrawChoices=function(){
var e=this.getMenuElement();
if(e==null){
return
}
e.innerHTML=this.getChoicesHTML()
};
OSelect1_XFormItem.prototype.hideMenu=function(){
if(!this.menuUp){
return
}
if(window.console&&window.console.log){
console.log("Hiding menu")
}
setTimeout(this.getFormGlobalRef()+".getElement('"+this.getMenuElementId()+"').style.display = 'none'",10);
AjxCore.removeListener(window,DwtEvent.ONMOUSEUP,this.$hideListener);
AjxCore.removeListener(document.body,DwtEvent.ONMOUSEDOWN,this.$outsideMouseDownListener);
Dwt.clearHandler(this.getForm().getHtmlElement(),DwtEvent.ONMOUSEWHEEL);
DwtEventManager.removeListener(DwtEvent.ONMOUSEDOWN,this.$outsideMouseDownListener);
if(AjxEnv.isIE&&OSelect1_XFormItem._mouseWheelEventAttached){
var t=this.getForm();
var e=t.getHtmlElement();
if(e.detachEvent){
if(window.event!=null){
window.event.cancelBubble=true
}
e.detachEvent("onmousewheel",OSelect1_XFormItem._mouseWheelHideMenu);
OSelect1_XFormItem._mouseWheelEventAttached=false;
OSelect1_XFormItem._mouseWheelCurrentSelect=null
}}
this.menuUp=false;
this.hideNote()
};
OSelect1_XFormItem.prototype.moveMenuY=function(h,e,s){
var a=this.getMenuElement();
if(a==null){
return
}
var o=this.getBounds(a);
var n=o.height;
var l=o.top;
var r=parseInt(l)+parseInt(h);
var t=parseInt(r)+parseInt(n);
a.style.top=r+"px";
if(e){
a.style.height=parseInt(a.style.height)-Math.abs(parseInt(h))+"px"
}else{
if(s){
a.style.height=parseInt(a.style.height)+Math.abs(parseInt(h))+"px"
}}};
OSelect1_XFormItem.prototype.showNote=function(e,t){
var a=this.getNoteElement();
if(!a==null){
return
}
a.className=t?t:this.getNoteCssClass();
a.innerHTML=e;
a.style.display="block";
var o;
if(this.getInheritedProperty("editable")){
o=this.getBounds(this.getDisplayElement())
}else{
o=this.getBounds(this.getElement())
}
a.style.left=o.left+"px";
if(this.menuDirection==OSelect1_XFormItem.MENU_DIR_UP){
a.style.top=o.top+o.height+"px"
}else{
a.style.top=o.top-OSelect1_XFormItem.NOTE_HEIGHT+"px"
}
a.style.zIndex=1000000;
this.noteUp=true
};
OSelect1_XFormItem.prototype.hideNote=function(){
if(!this.noteUp){
return
}
var e=this.getNoteElement();
if(!e==null){
return
}
e.innerHTML="";
e.style.display="none";
e.style.zIndex=Dwt.Z_HIDDEN;
this.noteUp=false
};
OSelect1_XFormItem.prototype.oMouseUp=function(a){
a=a||window.event;
var n=false;
if(a){
var o=DwtUiEvent.getTarget(a);
var e=this.getId()+"_display";
var t=this.getId()+"_arrow_button";
if(o.localName=="scrollbar"&&((o.parentNode&&o.parentNode.id=="___OSELECT_MENU___")||(o.id&&o.id=="___OSELECT_MENU___"))){
n=true
}else{
if(o.id&&o.id=="___OSELECT_MENU___"){
n=true
}else{
if(o.id&&o.id==e){
n=true
}else{
if(o.id&&o.id==t){
n=true
}}}}}
if(!n){
this.hideMenu()
}
return true
};
OSelect1_XFormItem.prototype.onOutsideMouseDown=function(n){
n=n||window.event;
var r=false;
var s;
if(n){
s=DwtUiEvent.getTarget(n);
var e=this.getId()+"_display";
var o=this.getId()+"_arrow_button";
if(s&&s.attributes&&s.attributes.length){
var a=s.attributes.length;
for(var t=0;
t<a;
t++){
if(s.attributes[t].name=="itemnum"){
this.onChoiceClick(s.attributes[t].value,n);
r=true;
break
}}}
if(!r){
if(s.localName=="scrollbar"&&((s.parentNode&&s.parentNode.id=="___OSELECT_MENU___")||(s.id&&s.id=="___OSELECT_MENU___"))){
r=true
}else{
if(s.id&&s.id=="___OSELECT_MENU___"){
r=true
}else{
if(s.id&&s.id==e){
r=true
}else{
if(s.id&&s.id==o){
r=true
}}}}}}
if(!r){
this.hideMenu()
}
return true
};
OSelect1_XFormItem.prototype.getBounds=function(t,s){
var n=new Object();
n.left=0;
n.top=0;
n.width=t.clientWidth?t.clientWidth:t.offsetWidth;
n.height=t.offsetHeight;
if(!s){
s=AjxEnv.isIE?t.document.body:t.ownerDocument.body
}
var a=(t.scrollLeft!==void 0);
var o=t;
while(o!=null&&o!=s){
n.left+=o.offsetLeft;
n.top+=o.offsetTop;
var e=o.offsetParent;
while(a&&(o!=e)){
n.left-=o.scrollLeft;
n.top-=o.scrollTop;
o=AjxEnv.isIE?e:o.parentNode
}
o=e
}
return n
};
OSelect1_XFormItem.prototype.onChoiceOver=function(t,e){
if(this.__currentHiliteItem!=null){
this.dehiliteChoice(this.__currentHiliteItem)
}
this.hiliteChoice(t);
this.__currentHiliteItem=t
};
OSelect1_XFormItem.prototype.onChoiceOut=function(t,e){
if(this.__currentHiliteItem!=null){
this.dehiliteChoice(this.__currentHiliteItem)
}
this.__currentHiliteItem=null
};
OSelect1_XFormItem.prototype.onChoiceClick=function(t,e){
this.choiceSelected(t,false,e)
};
OSelect1_XFormItem.prototype.onChoiceDoubleClick=function(t,e){
this.choiceSelected(t,true,e)
};
OSelect1_XFormItem.prototype.onValueTyped=function(e,t){
var a=this.getChoiceValue(e);
if(window.console&&window.console.log){
console.log("onValueTyped called value: "+a)
}
this.setValue(a,false,t)
};
OSelect1_XFormItem.prototype.onKeyUp=function(t,e){
if(e.keyCode==XFG.ARROW_UP){
if(!this.menuUp){
this.showMenu()
}
this.hilitePreviousChoice(e);
this.isSelecting=true;
return
}
if(e.keyCode==XFG.ARROW_DOWN){
if(!this.menuUp){
this.showMenu()
}
this.hiliteNextChoice(e);
this.isSelecting=true;
return
}
if(this.isSelecting&&this.menuUp&&e.keyCode==DwtKeyEvent.KEY_ENTER&&this.__currentHiliteItem!=null&&this.__currentHiliteItem!=undefined){
var t=this.getNormalizedValues()[this.__currentHiliteItem];
if(t!=null&&t!=undefined){
this.setValue(t,true,e);
this.hideMenu();
return
}}
this.isSelecting=false;
var a=this.getKeyUpMethod();
if(a){
a.call(this,t,e)
}};
OSelect1_XFormItem.prototype.getKeyUpMethod=function(){
return this.cacheInheritedMethod("keyUp","$keyUp","elementValue, event")
};
OSelect1_XFormItem.prototype.choiceSelected=function(n,o,t){
this.onChoiceOut();
this.hideMenu();
var a=this.getNormalizedValues()[n];
var e=this.getInheritedProperty("editable");
if(e){
this.getDisplayElement().value=this.getNormalizedLabels()[n]
}
this.setValue(a,o,t)
};
OSelect1_XFormItem.prototype.hiliteNextChoice=function(){
var e=this.getNormalizedChoices();
if(!(e&&e.values&&e.values.length>0)){
return
}
if(this.__currentHiliteItem==null||this.__currentHiliteItem==undefined){
this.hiliteChoice(0)
}else{
this.dehiliteChoice(this.__currentHiliteItem);
if((this.__currentHiliteItem+1)<e.values.length){
this.__currentHiliteItem++
}else{
this.__currentHiliteItem=0
}
this.hiliteChoice(this.__currentHiliteItem)
}};
OSelect1_XFormItem.prototype.hilitePreviousChoice=function(){
var e=this.getNormalizedChoices();
if(!(e&&e.values&&e.values.length>0)){
return
}
if(this.__currentHiliteItem==null||this.__currentHiliteItem==undefined){
this.hiliteChoice(0)
}else{
this.dehiliteChoice(this.__currentHiliteItem);
if((this.__currentHiliteItem-1)>-1){
this.__currentHiliteItem--
}else{
this.__currentHiliteItem=e.values.length-1
}
this.hiliteChoice(this.__currentHiliteItem)
}};
OSelect1_XFormItem.prototype.setValue=function(a,t,e){
if(window.console&&window.console.log){
console.log("setValue called + "+a)
}
var o=this.getElementChangedMethod();
o.call(this,a,this.getInstanceValue(),e)
};
OSelect1_XFormItem.prototype.hiliteChoice=function(t){
this.setChoiceCssClass(t,this.getChoiceSelectedCssClass());
if(this.getShowCheck()==true){
var e=this.getChoiceElements(t);
if(e){
e[0].innerHTML=this.getCheckHTML()
}}};
OSelect1_XFormItem.prototype.displayMouseOver=function(){
if(!this._enabled){
return
}};
OSelect1_XFormItem.prototype.displayMouseOut=function(){
if(!this._enabled){
return
}};
OSelect1_XFormItem.prototype.displayMouseDown=function(){
if(!this._enabled){
return
}};
OSelect1_XFormItem.prototype.dehiliteChoice=function(t){
this.setChoiceCssClass(t,this.getChoiceCssClass());
if(this.getShowCheck()==true){
var e=this.getChoiceElements(t);
if(e){
e[0].innerHTML="&nbsp;"
}}};
OSelect1_XFormItem.prototype.clearAllHilites=function(){
for(var e=0;
e<this._normalizedValues.length;
e++){
this.dehiliteChoice(e)
}};
OSelect1_XFormItem.prototype.setChoiceCssClass=function(a,e){
var t=this.getChoiceElements(a);
if(t){
t.className=e
}};
OSelect1_XFormItem.prototype.getArrowElement=function(){
return this.getForm().getElement(this.getId()+"_arrow_button")
};
OSelect1_XFormItem.prototype.getDisplayElement=function(){
return this.getElement(this.getId()+"_display")
};
OSelect1_XFormItem.prototype.getItemNumFromEvent=function(e){
var t=e.target||e.src;
while(t){
if(t.id){
var a=parseInt(t.id);
if(isNaN(a)){
return -1
}
return a
}
t=t.parentNode
}
return -1
};
OSelect1_XFormItem.prototype.getChoiceElements=function(a){
if(a==null||a==-1){
return null
}
try{
return this.getForm().getElement([this.getId(),"_choice_",a].join(""))
}
catch(t){
return null
}};
OSelect1_XFormItem.prototype.outputHTML=function(e){
var r=this.getId();
var s=this.getFormGlobalRef()+".getItemById('"+r+"')";
var n;
var o=this.getInheritedProperty("editable");
if(o){
var a=this.getInheritedProperty("inputSize");
n=["<input type=text id=",r,"_display class=",this.getDisplayCssClass()," value='VALUE' ",' onchange="',s,'.onValueTyped(this.value, event||window.event)"',' onmouseup="',s,'.showMenu(this)"',' onkeyup="',s,'.onKeyUp(this.value, event||window.event)"',"size=",a,">"].join("")
}
if(this.getWidth()=="auto"&&!o){
var t=this.getElement("tempDiv");
if(!t){
t=this.createElement("tempDiv",null,"div","MENU CONTENTS")
}
t.style.left="-1000px";
t.style.top="-1000px";
t.className=this.getMenuCssClass();
t.innerHTML=this.getChoicesHTML();
this._width=t.offsetWidth+20;
t.innerHTML=""
}
if(o){
e.append("<div id=",r,this.getCssString(),' onclick="',this.getFormGlobalRef(),".getItemById('",this.getId(),"').showMenu(this)\"",' onselectstart="return false"',">","<table ",this.getTableCssString(),">","<tr><td width=100%>",n,"</td>","<td>",this.getArrowButtonHTML(),"</td>","</tr>","</table>","</div>")
}else{
e.append("<div id=",r,this.getCssString(),' onclick="',this.getFormGlobalRef(),".getItemById('",this.getId(),"').showMenu(this)\"",' onselectstart="return false"',"><table ",this.getTableCssString(),">","<tr><td width=100%><div id=",r,"_display class=",this.getDisplayCssClass(),">VALUE</div></td>","<td>",this.getArrowButtonHTML(),"</td>","</tr>","</table>","</div>")
}};
OSelect1_XFormItem.prototype.getArrowButtonHTML=function(){
var e=this.getFormGlobalRef()+".getItemById('"+this.getId()+"')";
return AjxBuffer.concat("<div id=",this.getId(),"_arrow_button",' onmouseover="',e,'.displayMouseOver();"',' onmouseout="',e,'.displayMouseOut();"',' onmousedown="',e,'.displayMouseDown();"',">",AjxImg.getImageHtml("SelectPullDownArrow"),"</div>")
};
OSelect1_XFormItem.prototype.getTableCssClass=function(){
return this.cssClass+"_table"
};
OSelect1_XFormItem.prototype.getDisplayCssClass=function(){
return this.cssClass+"_display"
};
OSelect1_XFormItem.prototype.getMenuCssClass=function(){
return this.cssClass+"_menu"
};
OSelect1_XFormItem.prototype.getChoiceTableCssClass=function(){
return this.cssClass+"_choice_table"
};
OSelect1_XFormItem.prototype.getChoiceScrollTableCssClass=function(){
return this.cssClass+"_choice_table_scrolled"
};
OSelect1_XFormItem.prototype.getChoiceCssClass=function(){
return this.cssClass+"_choice"
};
OSelect1_XFormItem.prototype.getChoiceSelectedCssClass=function(){
return this.cssClass+"_choice_selected"
};
OSelect1_XFormItem.prototype.getNoteCssClass=function(){
return this.cssClass+"_note"
};
OSelect1_XFormItem.prototype.getErrorNoteCssClass=function(){
return this.cssClass+"_error_note"
};
OSelect1_XFormItem.prototype.outputChoicesHTMLStart=function(e){
e.append("<table cellspacing=0 cellpadding=0 id=",this.getId(),"_menu_table class=",this.getChoiceTableCssClass(),">")
};
OSelect1_XFormItem.prototype.outputChoicesHTMLEnd=function(e){
e.append("</table>")
};
OSelect1_XFormItem.prototype.getChoiceHTML=function(n,o,t,e){
var a=this.getFormGlobalRef()+".getItemById('"+this.getId()+"')";
return AjxBuffer.concat('<tr><td><div id="',this.getId(),"_choice_",n,'" ',"class=",e,' onmouseover="',a,".onChoiceOver(",n,', event||window.event)"',' onmouseout="',a,".onChoiceOut(",n,', event||window.event)"',' onclick="',a,".onChoiceClick(",n,', event||window.event)"'," itemnum = '",n,"'",">",t,"</div></td></tr>")
};
OSelect1_XFormItem.prototype.setElementEnabled=function(e){
this._enabled=e;
var a=this.getForm().getElement(this.getId()).getElementsByTagName("table")[0];
if(e){
this.getDisplayElement().className=this.getDisplayCssClass();
var t=this.getArrowElement();
if(t){
AjxImg.setImage(t,"SelectPullDownArrow")
}
this.getForm().getElement(this.getId()).className=this.cssClass;
a.className=this.getTableCssClass();
if(this.getInheritedProperty("editable")){
this.getDisplayElement().disabled=false
}}else{
this.getDisplayElement().className=this.getDisplayCssClass()+"_disabled";
var t=this.getArrowElement();
this.getForm().getElement(this.getId()).className=this.cssClass+"_disabled";
a.className=this.getTableCssClass()+"_disabled";
if(this.getInheritedProperty("editable")){
this.getDisplayElement().disabled=true
}}};
OSelect_XFormItem=function(){};
XFormItemFactory.createItemType("_OSELECT_","oselect",OSelect_XFormItem,OSelect1_XFormItem);
OSelect_XFormItem.prototype.focusable=false;
OSelect_XFormItem.prototype.multiple=true;
OSelect_XFormItem.prototype.writeElementDiv=true;
OSelect_XFormItem.prototype.overflow="auto";
OSelect_XFormItem.prototype.cssStyle="border:2px inset gray;";
OSelect_XFormItem.prototype.showCheck=false;
OSelect_XFormItem.prototype.outputHTML=function(e){
var t=this.getChoicesHTML();
e.append(t)
};
OSelect_XFormItem.prototype.choicesChangeLsnr=function(){
this._choiceDisplayIsDirty=true;
delete this.$normalizedChoices;
var e=this.getElement();
if(e){
e.innerHTML=this.getChoicesHTML()
}};
OSelect_XFormItem.prototype.outputChoicesHTMLStart=function(e){
e.append("<table id=",this.getId(),"_menu_table width=100% cellspacing=2 cellpadding=0>")
};
OSelect_XFormItem.prototype.outputChoicesHTMLEnd=function(e){
e.append("</table>")
};
OSelect_XFormItem.prototype.getMenuElementId=function(){
return this.getId()
};
OSelect_XFormItem.prototype.updateElement=function(e){
var a=this.getElement();
a.innerHTML=this.getChoicesHTML();
if(e==null){
return
}
if(this.getMultiple()){
if(typeof e=="string"){
e=e.split(",")
}
for(var t=0;
t<e.length;
t++){
var o=this.getChoiceNum(e[t]);
if(o!=-1){
this.hiliteChoice(o)
}}}else{
var o=this.getChoiceNum(e);
if(o!=-1){
this.hiliteChoice(o)
}}
this.updateEnabledDisabled()
};
OSelect_XFormItem.prototype.onChoiceOver=function(e){};
OSelect_XFormItem.prototype.onChoiceOut=function(e){};
OSelect_XFormItem.prototype.onChoiceClick=function(o,a){
a=a||window.event;
var e=true;
var t=false;
if(this.getMultiple()){
e=false;
if(a.shiftKey){
t=true
}}
this.choiceSelected(o,e,t,a)
};
OSelect_XFormItem.prototype.choiceSelected=function(n,o,e,t){
if(e){
this._selectionCursor=n;
if(this._selectionAnchor==null){
this._selectionAnchor=n
}}else{
this._selectionAnchor=n;
this._selectionCursor=n
}
var a=this.getNormalizedValues()[n];
this.setValue(a,o,e,t)
};
OSelect_XFormItem.prototype.setValue=function(o,n,s,e){
var f;
if(n){
if(this.getMultiple()){
if(o instanceof Array){
f=o
}else{
f=[o]
}}else{
f=o
}}else{
if(s){
f=[];
var c=this.getNormalizedValues();
var t=this._selectionCursor;
var l=this._selectionAnchor-this._selectionCursor;
if(l<0){
l=this._selectionCursor-this._selectionAnchor;
t=this._selectionAnchor
}
for(var r=t;
r<=t+l;
++r){
f.push(c[r])
}}else{
var u=this.getInstanceValue();
if(typeof u=="string"){
f=u
}else{
if(typeof u=="object"||u instanceof Array){
f=[];
for(var d in u){
f[d]=u[d]
}}}
if(f){
if(typeof f=="string"){
if(f==""){
f=[]
}else{
f=f.split(",")
}}}else{
f=new Array()
}
var m=false;
var r;
for(r=0;
r<f.length;
r++){
if(f[r]==o){
m=true;
break
}}
if(m){
f.splice(r,1)
}else{
f.push(o)
}}
if(!f||(f.length==1&&f[0]=="")){
f=[]
}
var h=this.getModelItem();
if(h&&h.getOutputType){
if(h.getOutputType()==_STRING_){
f=f.join(h.getItemDelimiter())
}}else{
f=f.join(",")
}}
this.getForm().itemChanged(this,f,e)
};
OSelect_XFormItem.prototype.setElementEnabled=function(t){
var s=this.getNormalizedChoices();
if(!s){
return
}
var e=s.values;
if(!e){
return
}
var o=e.length;
for(var a=0;
a<o;
a++){
var n=this.getElement(this.getId()+"_choiceitem_"+a);
if(n){
if(t){
n.className=this.getChoiceCssClass();
n.disabled=false
}else{
n.className=this.getChoiceCssClass()+"_disabled";
n.disabled=true
}}}};
OSelect_Check_XFormItem=function(){};
XFormItemFactory.createItemType("_OSELECT_CHECK_","oselect_check",OSelect_Check_XFormItem,OSelect_XFormItem);
OSelect_Check_XFormItem.prototype.cssClass="oselect_check";
OSelect_Check_XFormItem.prototype.getChoiceHTML=function(n,o,t,e){
var a=this.getFormGlobalRef()+".getItemById('"+this.getId()+"')";
var s=this.getId();
return AjxBuffer.concat("<tr><td class=",e,(this.getIsEnabled())?(' onmouseover="'+a+".onChoiceOver("+n+', event||window.event)"'):"",(this.getIsEnabled())?(' onmouseout="'+a+".onChoiceOut("+n+', event||window.event)"'):"",(this.getIsEnabled())?(' onclick="'+a+".onChoiceClick("+n+', event||window.event)"'):"",(this.getIsEnabled())?(' ondblclick="'+a+".onChoiceDoubleClick("+n+', event||window.event)"'):"",">","<table cellspacing=0 cellpadding=0><tr><td><input type=checkbox id='",s,"_choiceitem_",n,"'></td><td>",(!this.getIsEnabled())?('<font color="#808080">'):"",t,(!this.getIsEnabled())?("</font>"):"","</td></tr></table></td></tr>")
};
OSelect_Check_XFormItem.prototype.hiliteChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[0];
t.className=this.getChoiceSelectedCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=true
}}};
OSelect_Check_XFormItem.prototype.dehiliteChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[0];
t.className=this.getChoiceCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=false
}}};
OSelect_Check_XFormItem.prototype.getChoiceElements=function(a){
if(a==null||a==-1){
return null
}
try{
return this.getForm().getElement(this.getId()+"_menu_table").rows[a].getElementsByTagName("td")
}
catch(t){
return null
}};
OSelect_Check_XFormItem.prototype.selectAll=function(o){
var e=[];
if(this.$normalizedChoices&&this.$normalizedChoices.values){
var n=this.$normalizedChoices.values;
var a=n.length;
for(var t=0;
t<a;
t++){
e.push(n[t])
}}
this.setValue(e,true,false,o)
};
OSelect_Check_XFormItem.prototype.deselectAll=function(e){
this.getForm().itemChanged(this,[],e)
};
OSelect_Check_XFormItem.prototype.updateElement=function(e){
var a=this.getElement();
a.innerHTML=this.getChoicesHTML();
this.clearAllHilites();
if(e){
if(this.getMultiple()){
if(typeof e=="string"){
e=e.split(",")
}
for(var t=0;
t<e.length;
t++){
var o=this.getChoiceNum(e[t]);
if(o!=-1){
this.hiliteChoice(o)
}}}else{
var o=this.getChoiceNum(e);
if(o!=-1){
this.hiliteChoice(o)
}}}
this.updateEnabledDisabled()
};
OSelect_Check_XFormItem.prototype.clearAllHilites=function(){
var a=this.getNormalizedChoices();
var t;
if(a.values){
t=a.values.length;
for(var e=0;
e<t;
e++){
this.dehiliteChoice(e)
}}};
OSelect_DblCheck_XFormItem=function(){};
XFormItemFactory.createItemType("_OSELECT_DBL_CHECK_","oselect_dbl_check",OSelect_DblCheck_XFormItem,OSelect_Check_XFormItem);
OSelect_DblCheck_XFormItem.prototype.onSubChoiceOver=function(e){};
OSelect_DblCheck_XFormItem.prototype.onSubChoiceOut=function(e){};
OSelect_DblCheck_XFormItem.prototype.onSubChoiceClick=function(o,a){
a=a||window.event;
var e=true;
var t=false;
if(this.getMultiple()){
e=false;
if(a.shiftKey){
t=true
}}
this.subChoiceSelected(o,e,t,a)
};
OSelect_DblCheck_XFormItem.prototype.subChoiceSelected=function(n,o,e,t){
if(e){
this._subSelectionCursor=n;
if(this._subSelectionAnchor==null){
this._subSselectionAnchor=n
}}else{
this._subSelectionAnchor=n;
this._subSelectionCursor=n
}
var a=this.getNormalizedValues()[n];
this.setSubValue(a,o,e,t)
};
OSelect_DblCheck_XFormItem.prototype.setSubValue=function(o,n,s,e){
var f;
if(n){
if(this.getMultiple()){
if(o instanceof Array){
f=o
}else{
f=[o]
}}else{
f=o
}}else{
if(s){
f=[];
var c=this.getNormalizedValues();
var t=this._subSelectionCursor;
var l=this._subSelectionAnchor-this._subSelectionCursor;
if(l<0){
l=this._subSelectionCursor-this._subSelectionAnchor;
t=this._subSelectionAnchor
}
for(var r=t;
r<=t+l;
++r){
f.push(c[r])
}}else{
var u=this.getInstanceValue(this.getInheritedProperty("subRef"));
if(typeof u=="string"){
f=new String(u)
}else{
if(typeof u=="object"||u instanceof Array){
f=[];
for(var d in u){
f[d]=u[d]
}}}
if(f){
if(typeof f=="string"){
if(f==""){
f=[]
}else{
f=f.split(",")
}}}else{
f=new Array()
}
var m=false;
for(var r=0;
r<f.length;
r++){
if(f[r]==o){
m=true;
break
}}
if(m){
f.splice(r,1)
}else{
f.push(o)
}}
if(!f||(f.length==1&&f[0]=="")){
f=[]
}
var h=this.getSubModelItem();
if(h&&h.getOutputType){
if(h.getOutputType()==_STRING_){
f=f.join(h.getItemDelimiter())
}}else{
f=f.join(",")
}}
this.getForm().subItemChanged(this,f,e)
};
OSelect_DblCheck_XFormItem.prototype.getSubLabel=function(){
return this.getInheritedProperty("subLabel")
};
OSelect_DblCheck_XFormItem.prototype.getChoiceHTML=function(s,n,a,e){
var o=this.getFormGlobalRef()+".getItemById('"+this.getId()+"')";
var r=this.getId();
var t=this.getSubLabel();
return AjxBuffer.concat("<tr><td class=",e,' onmouseover="',o,".onChoiceOver(",s,', event||window.event)"',' onmouseout="',o,".onChoiceOut(",s,', event||window.event)"',' onclick="',o,".onChoiceClick(",s,', event||window.event)"',' ondblclick="',o,".onChoiceDoubleClick(",s,', event||window.event)">',"<table cellspacing=0 cellpadding=0><tr><td><input type=checkbox id='",r,"_choiceitem_",s,"'></td><td>",a,"</td></tr></table>","</td><td class=",e,' onmouseover="',o,".onSubChoiceOver(",s,', event||window.event)"',' onmouseout="',o,".onSubChoiceOut(",s,', event||window.event)"',' onclick="',o,".onSubChoiceClick(",s,', event||window.event)"',' ondblclick="',o,".onSubChoiceDoubleClick(",s,'.event||window.event)">',"<table cellspacing=0 cellpadding=0><tr><td><input type=checkbox id='",r,"_subchoiceitem_",s,"'></td><td>",t,"</td></tr></table>","</td></tr>")
};
OSelect_DblCheck_XFormItem.prototype.hiliteChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[0];
t.className=this.getChoiceSelectedCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=true;
this.enableSubChoice(o)
}}};
OSelect_DblCheck_XFormItem.prototype.dehiliteChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[0];
t.className=this.getChoiceCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=false;
this.dehiliteSubChoice(o);
this.disableSubChoice(o)
}}};
OSelect_DblCheck_XFormItem.prototype.hiliteSubChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[3];
t.className=this.getChoiceSelectedCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=true
}}};
OSelect_DblCheck_XFormItem.prototype.dehiliteSubChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[3];
t.className=this.getChoiceCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].checked=false
}}};
OSelect_DblCheck_XFormItem.prototype.disableSubChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[3];
t.className=this.getChoiceCssClass()+"_disabled";
var e=t.getElementsByTagName("input");
if(e){
e[0].disabled=true
}}};
OSelect_DblCheck_XFormItem.prototype.enableSubChoice=function(o){
var a=this.getChoiceElements(o);
if(a){
var t=a[3];
t.className=this.getChoiceCssClass();
var e=t.getElementsByTagName("input");
if(e){
e[0].disabled=false
}}};
OSelect_DblCheck_XFormItem.prototype.updateElement=function(){
var o=this.getElement();
o.innerHTML=this.getChoicesHTML();
var t=this.getInstanceValue();
this.clearAllHilites();
if(t){
if(this.getMultiple()){
if(typeof t=="string"){
t=t.split(",")
}
for(var a=0;
a<t.length;
a++){
var n=this.getChoiceNum(t[a]);
if(n!=-1){
this.hiliteChoice(n)
}}}else{
var n=this.getChoiceNum(t);
if(n!=-1){
this.hiliteChoice(n)
}}}
var e=this.getInstanceValue(this.getInheritedProperty("subRef"));
if(e){
if(this.getMultiple()){
if(typeof e=="string"){
e=e.split(",")
}
for(var a=0;
a<e.length;
a++){
var n=this.getChoiceNum(e[a]);
if(n!=-1){
this.hiliteSubChoice(n)
}}}else{
var n=this.getChoiceNum(t);
if(n!=-1){
this.hiliteSubChoice(n)
}}}
this.updateEnabledDisabled()
};
OSelect_DblCheck_XFormItem.prototype.onSubChoiceDoubleClick=function(t,e){
this.subChoiceSelected(t,true,e)
};
OSelect_DblCheck_XFormItem.prototype.setElementEnabled=function(t){
var r=this.getNormalizedChoices();
if(!r){
return
}
var e=r.values;
if(!e){
return
}
var o=e.length;
for(var a=0;
a<o;
a++){
var s=this.getElement(this.getId()+"_choiceitem_"+a);
var n=this.getElement(this.getId()+"_subchoiceitem_"+a);
if(s&&n){
if(t){
s.className=this.getChoiceCssClass();
s.disabled=false
}else{
s.className=this.getChoiceCssClass()+"_disabled";
s.disabled=true;
n.className=this.getChoiceCssClass()+"_disabled";
n.disabled=true
}}}};
OSelect_DblCheck_XFormItem.prototype.deselectAll=function(e){
this.getForm().subItemChanged(this,[],e);
this.getForm().itemChanged(this,[],e)
}
}
if(AjxPackage.define("ajax.dwt.xforms.ButtonGrid")){
ButtonGrid=function(e){
XFG.assignUniqueId(this,"__BUTTON_GRID__");
for(var t in e){
this[t]=e[t]
}
if(this.onChange){
this.setOnChange(this.onChange)
}
this.value=[]
};
var BGP=ButtonGrid.prototype;
BGP.choices=null;
BGP.numCols=4;
BGP.cssClass="xform_button_grid_medium";
BGP.onChange=null;
BGP.multiple=true;
BGP.addBracketingCells=false;
BGP.setOnChange=function(e){
if(e&&typeof e=="string"){
e=new Function("value, event",e)
}
this.onChange=e
};
BGP.getValue=function(){
return this.value
};
BGP.setValue=function(e){
if(e==null){
e=[]
}
if(typeof e=="string"){
e=e.split(",")
}
this.value=e;
this.showValue()
};
BGP.showValue=function(){
var n=this.value;
if(n==null){
n=""
}
if(typeof n=="string"){
n=n.split(",")
}
var o="{|[",s="]|}";
n=o+n.join(s+o)+s;
var r=this.choices;
for(var a=0;
a<r.length;
a++){
var t=XFG.getEl(this.getButtonId(a));
var e=(n.indexOf(o+r[a].value+s)>-1);
if(e){
XFG.showSelected(t)
}else{
XFG.hideSelected(t)
}}};
BGP.toggleValue=function(t,e){
if(this.multiple){
if(this.valueIsSelected(t)){
this.deselectValue(t,e)
}else{
this.selectValue(t,e)
}}else{
this.value=t
}
return this.value
};
BGP.valueIsSelected=function(t){
for(var e=0;
e<this.value.length;
e++){
if(this.value[e]==t){
return true
}}};
BGP.selectValue=function(t,e){
if(!this.valueIsSelected(t)){
this.value.push(t)
}
if(e){
XFG.showSelected(e)
}};
BGP.deselectValue=function(a,t){
if(this.valueIsSelected(a)){
for(var e=0;
e<this.value.length;
e++){
if(this.value[e]==a){
this.value=this.value.slice(0,e).concat(this.value.slice(e+1,this.value.length))
}}}
if(t){
XFG.hideSelected(t)
}};
BGP.getButtonId=function(e){
return this.__id+"_button_"+e
};
BGP.onButtonClick=function(o,e,t){
var a=this.toggleValue(o,e);
if(this.onChange){
this.onChange(a,t)
}};
BGP.getHTML=function(){
if(this.choices==null){
return(this.__HTMLOutput=null)
}
var e=new AjxBuffer();
var o=this.cssClass+"_button";
e.append('<table class="',this.cssClass,'_table">');
var a=0;
var s=Math.ceil(this.choices.length/this.numCols);
for(var n=0;
n<s;
n++){
e.append("<tr>\r");
if(this.addBracketingCells){
e.append("\t<td width=50%><div class=",this.cssClass+"_start></div></td>")
}
for(var h=0;
h<this.numCols;
h++){
var t=this.choices[a];
if(typeof t=="string"){
t=this.choices[a]={
value:t,label:t}
}
e.append("<td class=",this.cssClass+"_td ><div id=",this.getButtonId(a)," class=",o," onclick=\"XFG.cacheGet('",this.__id,"').onButtonClick('",t.value,"',this,event);\">",t.label,"</div></td>");
a++;
if(a>=this.choices.length){
break
}}
if(this.addBracketingCells){
e.append("<td width=50%><div class=",this.cssClass+"_end></div></td>")
}
e.append("</tr>")
}
e.append("</table>");
this.__HTMLOutput=e.toString();
return this.__HTMLOutput
};
BGP.insertIntoXForm=function(a,t,e){
e.innerHTML=this.getHTML()
};
BGP.updateChoicesHTML=function(n){
var t=0;
for(var a=0;
a<numRows;
a++){
for(var o=0;
o<this.numCols;
o++){
var e=document.getElementById(this.getButtonId(t));
if(e){
e.innerHTML=n[t].label
}
t++;
if(t>=n.length){
break
}}}};
BGP.updateInXForm=function(o,a,n,t){
var e=(n instanceof Array?n.join(","):n);
if(!o.forceUpdate&&this.__lastDisplayValue==e){
return
}
this.setValue(n);
this.__lastDisplayValue=e
}
}
if(AjxPackage.define("ajax.dwt.xforms.DwtXFormDialog")){
DwtXFormDialog=function(c,t,l,n,h,e,r,s,a,o){
if(arguments.length==0){
return
}
n=n||"DwtXFormDialog";
DwtDialog.call(this,l,n,h,e,r,s,a,o);
this._xform=new XForm(c,new XModel(t),null,this);
this._xform.addListener(DwtEvent.XFORMS_FORM_DIRTY_CHANGE,new AjxListener(this,this._handleXFormDirty));
this.setView(this._xform);
if(this._button[DwtDialog.OK_BUTTON]){
this.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,this._handleOkButton))
}
if(this._button[DwtDialog.CANCEL_BUTTON]){
this.setButtonListener(DwtDialog.CANCEL_BUTTON,new AjxListener(this,this._handleCancelButton))
}
if(this._button[DwtDialog.YES_BUTTON]){
this.setButtonListener(DwtDialog.YES_BUTTON,new AjxListener(this,this._handleYesButton))
}
if(this._button[DwtDialog.NO_BUTTON]){
this.setButtonListener(DwtDialog.NO_BUTTON,new AjxListener(this,this._handleNoButton))
}};
DwtXFormDialog.prototype=new DwtDialog;
DwtXFormDialog.prototype.constructor=DwtXFormDialog;
DwtXFormDialog.prototype._xform;
DwtXFormDialog.prototype._xformInitialized=false;
DwtXFormDialog.prototype.setInstance=function(e){
this._xform.setInstance(e)
};
DwtXFormDialog.prototype.getInstance=function(){
return this._xform.getInstance()
};
DwtXFormDialog.prototype.popup=function(e){
this._initDialog();
this._xform.setIsDirty(true);
this._xform.refresh();
if(this._button[DwtDialog.OK_BUTTON]){
this.setButtonEnabled(DwtDialog.OK_BUTTON,false)
}
if(this._button[DwtDialog.YES_BUTTON]){
this.setButtonEnabled(DwtDialog.YES_BUTTON,false)
}
DwtDialog.prototype.popup.call(this,e)
};
DwtXFormDialog.prototype._initDialog=function(){
if(!this._xformInitialized){
this._xform.draw();
this._xformInitialized=true
}};
DwtXFormDialog.prototype._handleXFormDirty=function(e){
if(this._button[DwtDialog.OK_BUTTON]){
this.setButtonEnabled(DwtDialog.OK_BUTTON,true)
}
if(this._button[DwtDialog.YES_BUTTON]){
this.setButtonEnabled(DwtDialog.YES_BUTTON,true)
}};
DwtXFormDialog.prototype._handleOkButton=function(e){
this.popdown();
this.setInstance(null)
};
DwtXFormDialog.prototype._handleCancelButton=DwtXFormDialog.prototype._handleOkButton;
DwtXFormDialog.prototype._handleYesButton=DwtXFormDialog.prototype._handleOkButton;
DwtXFormDialog.prototype._handleNoButton=DwtXFormDialog.prototype._handleOkButton
}
if(AjxPackage.define("ajax.dwt.xforms.DynSelect_XFormItem")){
DynSelect_XFormItem=function(){};
XFormItemFactory.createItemType("_DYNSELECT_","dynselect",DynSelect_XFormItem,OSelect1_XFormItem);
DynSelect_XFormItem.prototype.autoCompleteEnabled=false;
DynSelect_XFormItem.prototype.dataFetcherClass=null;
DynSelect_XFormItem.prototype.dataFetcherMethod=null;
DynSelect_XFormItem.prototype.dataFetcherObject=null;
DynSelect_XFormItem.prototype.dataFetcherTypes=null;
DynSelect_XFormItem.prototype.dataFetcherAttrs=null;
DynSelect_XFormItem.prototype.dataFetcherDomain=null;
DynSelect_XFormItem.prototype.entryKeyMethod=null;
DynSelect_XFormItem.prototype.bmolsnr=true;
DynSelect_XFormItem.prototype.emptyText="";
DynSelect_XFormItem.prototype.cssClass="dynselect";
DynSelect_XFormItem.prototype.edited=false;
DynSelect_XFormItem.prototype.focusable=true;
DynSelect_XFormItem.LOAD_PAUSE=750;
DynSelect_XFormItem.prototype.initFormItem=function(){
var o=this.getChoices();
if(o instanceof Array){
o=new XFormChoices(o,XFormChoices.SIMPLE_LIST)
}
if(!o){
o=new XFormChoices([],XFormChoices.OBJECT_LIST,"name","name")
}
this.setChoices(o);
var a=new AjxListener(this,this.choicesChangeLsnr);
this.choices.addListener(DwtEvent.XFORMS_CHOICES_CHANGED,a);
this.dataFetcherClass=this.getInheritedProperty("dataFetcherClass");
this.dataFetcherMethod=this.getInheritedProperty("dataFetcherMethod");
this.dataFetcherTypes=this.getInheritedProperty("dataFetcherTypes");
this.dataFetcherAttrs=this.getInheritedProperty("dataFetcherAttrs");
this.dataFetcherDomain=this.getInheritedProperty("dataFetcherDomain");
this.autoCompleteEnabled=this.getInheritedProperty("autoCompleteEnabled");
this.dataFetcherObject=null;
if(!this.dataFetcherMethod){
this.dataFetcherMethod=DynSelect_XFormItem.fetchDataDefault;
this.dataFetcherObject=this
}
var e=XFormItem.getParentTabGroupId(this);
this.getForm().indexItem(this,this.getId()+"_display");
if(e){
var t=this.getForm().getItemById(e);
if(t){
t.tabIdOrder.push(this.getId()+"_display")
}}};
DynSelect_XFormItem.prototype.changeChoicesCallback=function(a,e,t){
var o=this.choices?this.choices:this.getChoices();
if(!o){
return
}
o.setChoices(a);
o.dirtyChoices();
if(AjxUtil.isEmpty(a)){
this.hideMenu()
}else{
if(!this.menuUp){
this.showMenu()
}}};
DynSelect_XFormItem.fetchDataDefault=function(e){
var t=e.callback;
t.run(this.choices.getChoiceObject(),false,null)
};
DynSelect_XFormItem.prototype.onKeyUp=function(s,o){
var r=new Date().getTime();
this._lastTypeTime=r;
if(window.console&&window.console.log){
window.console.log("onKeyUp "+s+" @ "+r)
}
this.edited=true;
this.hideNote();
if(o.keyCode==XFG.ARROW_UP){
if(!this.menuUp){
this.showMenu()
}
this.hilitePreviousChoice(o);
this.isSelecting=true;
return
}
if(o.keyCode==XFG.ARROW_DOWN){
if(!this.menuUp){
this.showMenu()
}
this.hiliteNextChoice(o);
this.isSelecting=true;
return
}
if(this.isSelecting&&this.menuUp&&o.keyCode==DwtKeyEvent.KEY_ENTER&&this.__currentHiliteItem!=null&&this.__currentHiliteItem!=undefined){
var s=this.getNormalizedValues()[this.__currentHiliteItem];
if(s!=null&&s!=undefined){
this.setValue(s,true,o);
this.hideMenu();
this.processEntryKey();
return
}}else{
if(this.menuUp&&o.keyCode==DwtKeyEvent.KEY_ENTER){
this.hideMenu();
this.processEntryKey();
return
}}
this.isSelecting=false;
var h=this.getKeyUpMethod();
if(h){
h.call(this,s,o)
}else{
var t=DwtKeyEvent.getCharCode(o);
if(!AjxUtil.isEmpty(this.keyPressDelayHdlr)){
AjxTimedAction.cancelAction(this.keyPressDelayHdlr);
this.keyPressDelayHdlr=null
}
var a=this.getForm();
var e=new DwtKeyEvent();
e.setFromDhtmlEvent(o);
if(t==DwtKeyEvent.KEY_TAB){
DwtUiEvent.setBehaviour(o,true,false);
return false
}else{
if(!(o.keyCode==XFG.ARROW_RIGHT||o.keyCode==XFG.ARROW_LEFT||o.keyCode==DwtKeyEvent.KEY_ESCAPE)){
var n=new AjxTimedAction(this,this.handleKeyPressDelay,[e,s,r]);
this.keyPressDelayHdlr=AjxTimedAction.scheduleAction(n,DynSelect_XFormItem.LOAD_PAUSE)
}}}};
DynSelect_XFormItem.prototype.onKeyDown=function(o,a){
var t=DwtKeyEvent.getCharCode(a);
if(t==DwtKeyEvent.KEY_ENTER){
DwtUiEvent.setBehaviour(a,true,true);
return false
}else{
if(t==DwtKeyEvent.KEY_TAB){
DwtUiEvent.setBehaviour(a,true,false);
if(this.menuUp){
this.hideMenu()
}
var e=XFormItem.getParentTabGroupId(this);
if(a.shiftKey){
this.getForm().focusPrevious(this.getId()+"_display",e)
}else{
this.getForm().focusNext(this.getId()+"_display",e)
}
return true
}}
return true
};
DynSelect_XFormItem.prototype.resetChoices=function(){
var e=this.getChoices();
e.setChoices([]);
e.dirtyChoices();
if(!this.dataFetcherObject&&this.dataFetcherClass!=null&&this.dataFetcherMethod!=null){
this.dataFetcherObject=new this.dataFetcherClass(this.getForm().getController())
}else{
if(this.getInheritedProperty("dataFetcherInstance")){
this.dataFetcherObject=this.getInstance()
}}};
DynSelect_XFormItem.prototype.handleKeyPressDelay=function(a,o,r){
if(a.keyCode==DwtKeyEvent.KEY_ENTER){
this.processEntryKey();
return
}
if(this.autoCompleteEnabled){
var e=new Date().getTime();
if(window.console&&window.console.log){
window.console.log("handleKeyPressDelay "+o+" @ "+e)
}
this.keyPressDelayHdlr=null;
var s=this.preProcessInput(o);
if(r==this._lastTypeTime){
this.getForm().itemChanged(this,s,a)
}else{
if(window.console&&window.console.log){
window.console.log("typing faster than retreiving data")
}
return
}
if(!this.dataFetcherObject&&this.dataFetcherClass!=null&&this.dataFetcherMethod!=null){
this.dataFetcherObject=new this.dataFetcherClass(this.getForm().getController())
}else{
if(this.getInheritedProperty("dataFetcherInstance")){
this.dataFetcherObject=this.getInstance()
}}
if(!this.dataFetcherObject){
return
}
var h=new AjxCallback(this,this.changeChoicesCallback);
var t=this.getInheritedProperty("searchByProcessedValue");
var n={
event:a,callback:h,extraLdapQuery:null,form:this.getForm(),types:(this.dataFetcherTypes?this.dataFetcherTypes:null),attrs:(this.dataFetcherAttrs?this.dataFetcherAttrs:null),domain:(this.dataFetcherDomain?this.dataFetcherDomain:null)};
if(t&&!AjxUtil.isEmpty(s)){
n.value=s;
this.dataFetcherMethod.call(this.dataFetcherObject,n)
}else{
if(!AjxUtil.isEmpty(o)){
n.value=o;
this.dataFetcherMethod.call(this.dataFetcherObject,n)
}}}};
DynSelect_XFormItem.prototype.outputHTML=function(e){
var h=this.getId();
var o=this.getFormGlobalRef()+".getItemById('"+h+"')";
var a;
var t=this.getInheritedProperty("inputSize");
var s=this.getInheritedProperty("inputWidth");
var n=" onkeypress";
if(!AjxEnv.isFirefox){
n=" onkeydown"
}
var r=s?"style='width:"+s+"'":(t?"size="+t:"");
a=["<input type=text id=",h,"_display class=",this.getDisplayCssClass()," value='VALUE' ",' onchange="',o,'.onValueTyped(this.value, event||window.event)"',n+'="',o,'.onKeyDown(this.value, event||window.event)"',' onkeyup="',o,'.onKeyUp(this.value, event||window.event)"',r,this.getMouseoutHandlerHTML(),">"].join("");
e.append("<div id=",h,this.getCssString(),' onclick="',this.getFormGlobalRef(),".getItemById('",this.getId(),"').onClick(event)\"",' onselectstart="return false"',">","<table ",this.getTableCssString()," cellspacing='0'>","<tr><td width=100%>",a,"</td>","</tr>","</table>","</div>");
this.edited=false
};
DynSelect_XFormItem.prototype.getMouseoutHandlerHTML=function(){
var o=this.getFormGlobalRef(),a=this.getId();
var e="";
var t=this.getInheritedProperty("onMouseout");
e=AjxBuffer.concat(' onmouseout="',t||"XFormItem.prototype.hideInputTooltip",".call(",this.getGlobalRef(),', event );" ');
return AjxBuffer.concat(e)
};
DynSelect_XFormItem.prototype.onClick=function(t){
var a=this.getNormalizedChoices();
if(!this.edited&&this.getInheritedProperty("editable")){
this.showInputTooltip(t)
}else{
if(a&&a.values&&a.values.length&&!(a.values[0] instanceof XFormChoices)){
this.showMenu()
}}
if(AjxUtil.isEmpty(this.getInstanceValue())&&this._enabled){
var e=this.getDisplayElement();
e.value="";
e.className=this.getDisplayCssClass()
}};
DynSelect_XFormItem.prototype.getArrowElement=function(){
return null
};
DynSelect_XFormItem.prototype.preProcessInput=function(t){
var e=this.getPreProcessMethod();
var a=t;
if(e){
a=e.call(this,t,this.getForm())
}
return a
};
DynSelect_XFormItem.prototype.getPreProcessMethod=function(){
return this.cacheInheritedMethod("inputPreProcessor","inputPreProcessor","value, form")
};
DynSelect_XFormItem.prototype.updateElement=function(o){
if(this.getMultiple()&&o!=null&&o.indexOf(",")>-1){
o=o.split(",");
for(var t=0;
t<o.length;
t++){
o[t]=this.getChoiceLabel(o[t])
}}else{
o=this.getChoiceLabel(o)
}
var a=this.getDisplayElement();
if(a){
if(AjxUtil.isEmpty(o)&&this._enabled&&!this.edited){
var e=this.getInheritedProperty("emptyText");
if(!AjxUtil.isEmpty(e)){
o=e;
a.className=this.getDisplayCssClass()+"_empty"
}}else{
if(this._enabled){
a.className=this.getDisplayCssClass()
}}
if(window.console&&window.console.log){
console.log("updating element with value: "+o+" over "+a.value)
}
a.value=o
}
if(this.autoCompleteEnabled){
if(AjxUtil.isEmpty(o)){
if(!this.dataFetcherObject&&this.dataFetcherClass!=null&&this.dataFetcherMethod!=null){
this.dataFetcherObject=new this.dataFetcherClass(this.getForm().getController())
}
if(!this.dataFetcherObject){
return
}}}};
DynSelect_XFormItem.prototype.setElementEnabled=function(e){
this._enabled=e;
var t=this.getForm().getElement(this.getId());
if(!t||!t.getElementsByTagName||!t.getElementsByTagName("table")[0]){
return
}
var a=t.getElementsByTagName("table")[0];
if(e){
if(AjxUtil.isEmpty(this.getInstanceValue())&&!AjxUtil.isEmpty(this.getInheritedProperty("emptyText"))){
this.getDisplayElement().className=this.getDisplayCssClass()+"_empty";
this.getDisplayElement().value=this.getInheritedProperty("emptyText")
}else{
this.getDisplayElement().className=this.getDisplayCssClass()
}
this.getForm().getElement(this.getId()).className=this.cssClass;
a.className=this.getTableCssClass();
this.getDisplayElement().disabled=false
}else{
this.getDisplayElement().className=this.getDisplayCssClass()+"_disabled";
var t=this.getArrowElement();
if(t){
AjxImg.setImage(t,"SelectPullDownArrowDis")
}
this.getForm().getElement(this.getId()).className=this.cssClass+"_disabled";
a.className=this.getTableCssClass()+"_disabled";
this.getDisplayElement().disabled=true
}};
DynSelect_XFormItem.prototype.processEntryKey=function(){
var t=this.getInstanceValue();
var e=this.getInheritedProperty("entryKeyMethod");
if(e instanceof AjxCallback){
e.run(this,t)
}}
}};